var Kre=Object.defineProperty;var Qre=(i,e,t)=>e in i?Kre(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var Z=(i,e,t)=>Qre(i,typeof e!="symbol"?e+"":e,t);function ene(i,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const n in r)if(n!=="default"&&!(n in i)){const a=Object.getOwnPropertyDescriptor(r,n);a&&Object.defineProperty(i,n,a.get?a:{enumerable:!0,get:()=>r[n]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();function oL(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var sL={exports:{}},dx={},lL={exports:{}},si={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tg=Symbol.for("react.element"),tne=Symbol.for("react.portal"),ine=Symbol.for("react.fragment"),rne=Symbol.for("react.strict_mode"),nne=Symbol.for("react.profiler"),ane=Symbol.for("react.provider"),one=Symbol.for("react.context"),sne=Symbol.for("react.forward_ref"),lne=Symbol.for("react.suspense"),une=Symbol.for("react.memo"),hne=Symbol.for("react.lazy"),yP=Symbol.iterator;function cne(i){return i===null||typeof i!="object"?null:(i=yP&&i[yP]||i["@@iterator"],typeof i=="function"?i:null)}var uL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hL=Object.assign,cL={};function cd(i,e,t){this.props=i,this.context=e,this.refs=cL,this.updater=t||uL}cd.prototype.isReactComponent={};cd.prototype.setState=function(i,e){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,e,"setState")};cd.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function pL(){}pL.prototype=cd.prototype;function kC(i,e,t){this.props=i,this.context=e,this.refs=cL,this.updater=t||uL}var RC=kC.prototype=new pL;RC.constructor=kC;hL(RC,cd.prototype);RC.isPureReactComponent=!0;var vP=Array.isArray,dL=Object.prototype.hasOwnProperty,FC={current:null},fL={key:!0,ref:!0,__self:!0,__source:!0};function mL(i,e,t){var r,n={},a=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)dL.call(e,r)&&!fL.hasOwnProperty(r)&&(n[r]=e[r]);var s=arguments.length-2;if(s===1)n.children=t;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];n.children=l}if(i&&i.defaultProps)for(r in s=i.defaultProps,s)n[r]===void 0&&(n[r]=s[r]);return{$$typeof:tg,type:i,key:a,ref:o,props:n,_owner:FC.current}}function pne(i,e){return{$$typeof:tg,type:i.type,key:e,ref:i.ref,props:i.props,_owner:i._owner}}function OC(i){return typeof i=="object"&&i!==null&&i.$$typeof===tg}function dne(i){var e={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(t){return e[t]})}var xP=/\/+/g;function Z_(i,e){return typeof i=="object"&&i!==null&&i.key!=null?dne(""+i.key):e.toString(36)}function sy(i,e,t,r,n){var a=typeof i;(a==="undefined"||a==="boolean")&&(i=null);var o=!1;if(i===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(i.$$typeof){case tg:case tne:o=!0}}if(o)return o=i,n=n(o),i=r===""?"."+Z_(o,0):r,vP(n)?(t="",i!=null&&(t=i.replace(xP,"$&/")+"/"),sy(n,e,t,"",function(u){return u})):n!=null&&(OC(n)&&(n=pne(n,t+(!n.key||o&&o.key===n.key?"":(""+n.key).replace(xP,"$&/")+"/")+i)),e.push(n)),1;if(o=0,r=r===""?".":r+":",vP(i))for(var s=0;s<i.length;s++){a=i[s];var l=r+Z_(a,s);o+=sy(a,e,t,l,n)}else if(l=cne(i),typeof l=="function")for(i=l.call(i),s=0;!(a=i.next()).done;)a=a.value,l=r+Z_(a,s++),o+=sy(a,e,t,l,n);else if(a==="object")throw e=String(i),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function $g(i,e,t){if(i==null)return i;var r=[],n=0;return sy(i,r,"","",function(a){return e.call(t,a,n++)}),r}function fne(i){if(i._status===-1){var e=i._result;e=e(),e.then(function(t){(i._status===0||i._status===-1)&&(i._status=1,i._result=t)},function(t){(i._status===0||i._status===-1)&&(i._status=2,i._result=t)}),i._status===-1&&(i._status=0,i._result=e)}if(i._status===1)return i._result.default;throw i._result}var An={current:null},ly={transition:null},mne={ReactCurrentDispatcher:An,ReactCurrentBatchConfig:ly,ReactCurrentOwner:FC};function gL(){throw Error("act(...) is not supported in production builds of React.")}si.Children={map:$g,forEach:function(i,e,t){$g(i,function(){e.apply(this,arguments)},t)},count:function(i){var e=0;return $g(i,function(){e++}),e},toArray:function(i){return $g(i,function(e){return e})||[]},only:function(i){if(!OC(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};si.Component=cd;si.Fragment=ine;si.Profiler=nne;si.PureComponent=kC;si.StrictMode=rne;si.Suspense=lne;si.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mne;si.act=gL;si.cloneElement=function(i,e,t){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var r=hL({},i.props),n=i.key,a=i.ref,o=i._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=FC.current),e.key!==void 0&&(n=""+e.key),i.type&&i.type.defaultProps)var s=i.type.defaultProps;for(l in e)dL.call(e,l)&&!fL.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&s!==void 0?s[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];r.children=s}return{$$typeof:tg,type:i.type,key:n,ref:a,props:r,_owner:o}};si.createContext=function(i){return i={$$typeof:one,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:ane,_context:i},i.Consumer=i};si.createElement=mL;si.createFactory=function(i){var e=mL.bind(null,i);return e.type=i,e};si.createRef=function(){return{current:null}};si.forwardRef=function(i){return{$$typeof:sne,render:i}};si.isValidElement=OC;si.lazy=function(i){return{$$typeof:hne,_payload:{_status:-1,_result:i},_init:fne}};si.memo=function(i,e){return{$$typeof:une,type:i,compare:e===void 0?null:e}};si.startTransition=function(i){var e=ly.transition;ly.transition={};try{i()}finally{ly.transition=e}};si.unstable_act=gL;si.useCallback=function(i,e){return An.current.useCallback(i,e)};si.useContext=function(i){return An.current.useContext(i)};si.useDebugValue=function(){};si.useDeferredValue=function(i){return An.current.useDeferredValue(i)};si.useEffect=function(i,e){return An.current.useEffect(i,e)};si.useId=function(){return An.current.useId()};si.useImperativeHandle=function(i,e,t){return An.current.useImperativeHandle(i,e,t)};si.useInsertionEffect=function(i,e){return An.current.useInsertionEffect(i,e)};si.useLayoutEffect=function(i,e){return An.current.useLayoutEffect(i,e)};si.useMemo=function(i,e){return An.current.useMemo(i,e)};si.useReducer=function(i,e,t){return An.current.useReducer(i,e,t)};si.useRef=function(i){return An.current.useRef(i)};si.useState=function(i){return An.current.useState(i)};si.useSyncExternalStore=function(i,e,t){return An.current.useSyncExternalStore(i,e,t)};si.useTransition=function(){return An.current.useTransition()};si.version="18.3.1";lL.exports=si;var $e=lL.exports;const rf=oL($e),gne=ene({__proto__:null,default:rf},[$e]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yne=$e,vne=Symbol.for("react.element"),xne=Symbol.for("react.fragment"),_ne=Object.prototype.hasOwnProperty,bne=yne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wne={key:!0,ref:!0,__self:!0,__source:!0};function yL(i,e,t){var r,n={},a=null,o=null;t!==void 0&&(a=""+t),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)_ne.call(e,r)&&!wne.hasOwnProperty(r)&&(n[r]=e[r]);if(i&&i.defaultProps)for(r in e=i.defaultProps,e)n[r]===void 0&&(n[r]=e[r]);return{$$typeof:vne,type:i,key:a,ref:o,props:n,_owner:bne.current}}dx.Fragment=xne;dx.jsx=yL;dx.jsxs=yL;sL.exports=dx;var At=sL.exports,vL={exports:{}},ba={},xL={exports:{}},_L={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(i){function e(O,V){var j=O.length;O.push(V);e:for(;0<j;){var q=j-1>>>1,ee=O[q];if(0<n(ee,V))O[q]=V,O[j]=ee,j=q;else break e}}function t(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var V=O[0],j=O.pop();if(j!==V){O[0]=j;e:for(var q=0,ee=O.length,ae=ee>>>1;q<ae;){var N=2*(q+1)-1,J=O[N],Y=N+1,oe=O[Y];if(0>n(J,j))Y<ee&&0>n(oe,J)?(O[q]=oe,O[Y]=j,q=Y):(O[q]=J,O[N]=j,q=N);else if(Y<ee&&0>n(oe,j))O[q]=oe,O[Y]=j,q=Y;else break e}}return V}function n(O,V){var j=O.sortIndex-V.sortIndex;return j!==0?j:O.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;i.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();i.unstable_now=function(){return o.now()-s}}var l=[],u=[],c=1,p=null,d=3,m=!1,g=!1,_=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var V=t(u);V!==null;){if(V.callback===null)r(u);else if(V.startTime<=O)r(u),V.sortIndex=V.expirationTime,e(l,V);else break;V=t(u)}}function C(O){if(_=!1,b(O),!g)if(t(l)!==null)g=!0,G(E);else{var V=t(u);V!==null&&K(C,V.startTime-O)}}function E(O,V){g=!1,_&&(_=!1,x(D),D=-1),m=!0;var j=d;try{for(b(V),p=t(l);p!==null&&(!(p.expirationTime>V)||O&&!k());){var q=p.callback;if(typeof q=="function"){p.callback=null,d=p.priorityLevel;var ee=q(p.expirationTime<=V);V=i.unstable_now(),typeof ee=="function"?p.callback=ee:p===t(l)&&r(l),b(V)}else r(l);p=t(l)}if(p!==null)var ae=!0;else{var N=t(u);N!==null&&K(C,N.startTime-V),ae=!1}return ae}finally{p=null,d=j,m=!1}}var T=!1,L=null,D=-1,B=5,A=-1;function k(){return!(i.unstable_now()-A<B)}function $(){if(L!==null){var O=i.unstable_now();A=O;var V=!0;try{V=L(!0,O)}finally{V?z():(T=!1,L=null)}}else T=!1}var z;if(typeof w=="function")z=function(){w($)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,U=P.port2;P.port1.onmessage=$,z=function(){U.postMessage(null)}}else z=function(){y($,0)};function G(O){L=O,T||(T=!0,z())}function K(O,V){D=y(function(){O(i.unstable_now())},V)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(O){O.callback=null},i.unstable_continueExecution=function(){g||m||(g=!0,G(E))},i.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<O?Math.floor(1e3/O):5},i.unstable_getCurrentPriorityLevel=function(){return d},i.unstable_getFirstCallbackNode=function(){return t(l)},i.unstable_next=function(O){switch(d){case 1:case 2:case 3:var V=3;break;default:V=d}var j=d;d=V;try{return O()}finally{d=j}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(O,V){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var j=d;d=O;try{return V()}finally{d=j}},i.unstable_scheduleCallback=function(O,V,j){var q=i.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?q+j:q):j=q,O){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=j+ee,O={id:c++,callback:V,priorityLevel:O,startTime:j,expirationTime:ee,sortIndex:-1},j>q?(O.sortIndex=j,e(u,O),t(l)===null&&O===t(u)&&(_?(x(D),D=-1):_=!0,K(C,j-q))):(O.sortIndex=ee,e(l,O),g||m||(g=!0,G(E))),O},i.unstable_shouldYield=k,i.unstable_wrapCallback=function(O){var V=d;return function(){var j=d;d=V;try{return O.apply(this,arguments)}finally{d=j}}}})(_L);xL.exports=_L;var Sne=xL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mne=$e,_a=Sne;function et(i){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+i,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+i+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bL=new Set,gm={};function vh(i,e){Bp(i,e),Bp(i+"Capture",e)}function Bp(i,e){for(gm[i]=e,i=0;i<e.length;i++)bL.add(e[i])}var Fs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ub=Object.prototype.hasOwnProperty,Cne=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_P={},bP={};function Ene(i){return Ub.call(bP,i)?!0:Ub.call(_P,i)?!1:Cne.test(i)?bP[i]=!0:(_P[i]=!0,!1)}function Tne(i,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function Pne(i,e,t,r){if(e===null||typeof e>"u"||Tne(i,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function In(i,e,t,r,n,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=n,this.mustUseProperty=t,this.propertyName=i,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){rn[i]=new In(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var e=i[0];rn[e]=new In(e,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){rn[i]=new In(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){rn[i]=new In(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){rn[i]=new In(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){rn[i]=new In(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){rn[i]=new In(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){rn[i]=new In(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){rn[i]=new In(i,5,!1,i.toLowerCase(),null,!1,!1)});var BC=/[\-:]([a-z])/g;function zC(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var e=i.replace(BC,zC);rn[e]=new In(e,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var e=i.replace(BC,zC);rn[e]=new In(e,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var e=i.replace(BC,zC);rn[e]=new In(e,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){rn[i]=new In(i,1,!1,i.toLowerCase(),null,!1,!1)});rn.xlinkHref=new In("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){rn[i]=new In(i,1,!1,i.toLowerCase(),null,!0,!0)});function NC(i,e,t,r){var n=rn.hasOwnProperty(e)?rn[e]:null;(n!==null?n.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Pne(e,t,n,r)&&(t=null),r||n===null?Ene(e)&&(t===null?i.removeAttribute(e):i.setAttribute(e,""+t)):n.mustUseProperty?i[n.propertyName]=t===null?n.type===3?!1:"":t:(e=n.attributeName,r=n.attributeNamespace,t===null?i.removeAttribute(e):(n=n.type,t=n===3||n===4&&t===!0?"":""+t,r?i.setAttributeNS(r,e,t):i.setAttribute(e,t))))}var Vs=Mne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ug=Symbol.for("react.element"),Hc=Symbol.for("react.portal"),Gc=Symbol.for("react.fragment"),$C=Symbol.for("react.strict_mode"),Vb=Symbol.for("react.profiler"),wL=Symbol.for("react.provider"),SL=Symbol.for("react.context"),UC=Symbol.for("react.forward_ref"),jb=Symbol.for("react.suspense"),Hb=Symbol.for("react.suspense_list"),VC=Symbol.for("react.memo"),yl=Symbol.for("react.lazy"),ML=Symbol.for("react.offscreen"),wP=Symbol.iterator;function Id(i){return i===null||typeof i!="object"?null:(i=wP&&i[wP]||i["@@iterator"],typeof i=="function"?i:null)}var ar=Object.assign,Y_;function nf(i){if(Y_===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Y_=e&&e[1]||""}return`
`+Y_+i}var J_=!1;function K_(i,e){if(!i||J_)return"";J_=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(i,[],e)}else{try{e.call()}catch(u){r=u}i.call(e.prototype)}else{try{throw Error()}catch(u){r=u}i()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var n=u.stack.split(`
`),a=r.stack.split(`
`),o=n.length-1,s=a.length-1;1<=o&&0<=s&&n[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(n[o]!==a[s]){if(o!==1||s!==1)do if(o--,s--,0>s||n[o]!==a[s]){var l=`
`+n[o].replace(" at new "," at ");return i.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",i.displayName)),l}while(1<=o&&0<=s);break}}}finally{J_=!1,Error.prepareStackTrace=t}return(i=i?i.displayName||i.name:"")?nf(i):""}function Ane(i){switch(i.tag){case 5:return nf(i.type);case 16:return nf("Lazy");case 13:return nf("Suspense");case 19:return nf("SuspenseList");case 0:case 2:case 15:return i=K_(i.type,!1),i;case 11:return i=K_(i.type.render,!1),i;case 1:return i=K_(i.type,!0),i;default:return""}}function Gb(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case Gc:return"Fragment";case Hc:return"Portal";case Vb:return"Profiler";case $C:return"StrictMode";case jb:return"Suspense";case Hb:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case SL:return(i.displayName||"Context")+".Consumer";case wL:return(i._context.displayName||"Context")+".Provider";case UC:var e=i.render;return i=i.displayName,i||(i=e.displayName||e.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case VC:return e=i.displayName||null,e!==null?e:Gb(i.type)||"Memo";case yl:e=i._payload,i=i._init;try{return Gb(i(e))}catch{}}return null}function Ine(i){var e=i.type;switch(i.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=e.render,i=i.displayName||i.name||"",e.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Gb(e);case 8:return e===$C?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vl(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function CL(i){var e=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Lne(i){var e=CL(i)?"checked":"value",t=Object.getOwnPropertyDescriptor(i.constructor.prototype,e),r=""+i[e];if(!i.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var n=t.get,a=t.set;return Object.defineProperty(i,e,{configurable:!0,get:function(){return n.call(this)},set:function(o){r=""+o,a.call(this,o)}}),Object.defineProperty(i,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){i._valueTracker=null,delete i[e]}}}}function Vg(i){i._valueTracker||(i._valueTracker=Lne(i))}function EL(i){if(!i)return!1;var e=i._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return i&&(r=CL(i)?i.checked?"true":"false":i.value),i=r,i!==t?(e.setValue(i),!0):!1}function tv(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Wb(i,e){var t=e.checked;return ar({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??i._wrapperState.initialChecked})}function SP(i,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Vl(e.value!=null?e.value:t),i._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function TL(i,e){e=e.checked,e!=null&&NC(i,"checked",e,!1)}function Xb(i,e){TL(i,e);var t=Vl(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&i.value===""||i.value!=t)&&(i.value=""+t):i.value!==""+t&&(i.value=""+t);else if(r==="submit"||r==="reset"){i.removeAttribute("value");return}e.hasOwnProperty("value")?qb(i,e.type,t):e.hasOwnProperty("defaultValue")&&qb(i,e.type,Vl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(i.defaultChecked=!!e.defaultChecked)}function MP(i,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+i._wrapperState.initialValue,t||e===i.value||(i.value=e),i.defaultValue=e}t=i.name,t!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,t!==""&&(i.name=t)}function qb(i,e,t){(e!=="number"||tv(i.ownerDocument)!==i)&&(t==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+t&&(i.defaultValue=""+t))}var af=Array.isArray;function cp(i,e,t,r){if(i=i.options,e){e={};for(var n=0;n<t.length;n++)e["$"+t[n]]=!0;for(t=0;t<i.length;t++)n=e.hasOwnProperty("$"+i[t].value),i[t].selected!==n&&(i[t].selected=n),n&&r&&(i[t].defaultSelected=!0)}else{for(t=""+Vl(t),e=null,n=0;n<i.length;n++){if(i[n].value===t){i[n].selected=!0,r&&(i[n].defaultSelected=!0);return}e!==null||i[n].disabled||(e=i[n])}e!==null&&(e.selected=!0)}}function Zb(i,e){if(e.dangerouslySetInnerHTML!=null)throw Error(et(91));return ar({},e,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function CP(i,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(et(92));if(af(t)){if(1<t.length)throw Error(et(93));t=t[0]}e=t}e==null&&(e=""),t=e}i._wrapperState={initialValue:Vl(t)}}function PL(i,e){var t=Vl(e.value),r=Vl(e.defaultValue);t!=null&&(t=""+t,t!==i.value&&(i.value=t),e.defaultValue==null&&i.defaultValue!==t&&(i.defaultValue=t)),r!=null&&(i.defaultValue=""+r)}function EP(i){var e=i.textContent;e===i._wrapperState.initialValue&&e!==""&&e!==null&&(i.value=e)}function AL(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Yb(i,e){return i==null||i==="http://www.w3.org/1999/xhtml"?AL(e):i==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var jg,IL=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return i(e,t,r,n)})}:i}(function(i,e){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=e;else{for(jg=jg||document.createElement("div"),jg.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=jg.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;e.firstChild;)i.appendChild(e.firstChild)}});function ym(i,e){if(e){var t=i.firstChild;if(t&&t===i.lastChild&&t.nodeType===3){t.nodeValue=e;return}}i.textContent=e}var im={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dne=["Webkit","ms","Moz","O"];Object.keys(im).forEach(function(i){Dne.forEach(function(e){e=e+i.charAt(0).toUpperCase()+i.substring(1),im[e]=im[i]})});function LL(i,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||im.hasOwnProperty(i)&&im[i]?(""+e).trim():e+"px"}function DL(i,e){i=i.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,n=LL(t,e[t],r);t==="float"&&(t="cssFloat"),r?i.setProperty(t,n):i[t]=n}}var kne=ar({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Jb(i,e){if(e){if(kne[i]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(et(137,i));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(et(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(et(61))}if(e.style!=null&&typeof e.style!="object")throw Error(et(62))}}function Kb(i,e){if(i.indexOf("-")===-1)return typeof e.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qb=null;function jC(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ew=null,pp=null,dp=null;function TP(i){if(i=ng(i)){if(typeof ew!="function")throw Error(et(280));var e=i.stateNode;e&&(e=vx(e),ew(i.stateNode,i.type,e))}}function kL(i){pp?dp?dp.push(i):dp=[i]:pp=i}function RL(){if(pp){var i=pp,e=dp;if(dp=pp=null,TP(i),e)for(i=0;i<e.length;i++)TP(e[i])}}function FL(i,e){return i(e)}function OL(){}var Q_=!1;function BL(i,e,t){if(Q_)return i(e,t);Q_=!0;try{return FL(i,e,t)}finally{Q_=!1,(pp!==null||dp!==null)&&(OL(),RL())}}function vm(i,e){var t=i.stateNode;if(t===null)return null;var r=vx(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(i=i.type,r=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!r;break e;default:i=!1}if(i)return null;if(t&&typeof t!="function")throw Error(et(231,e,typeof t));return t}var tw=!1;if(Fs)try{var Ld={};Object.defineProperty(Ld,"passive",{get:function(){tw=!0}}),window.addEventListener("test",Ld,Ld),window.removeEventListener("test",Ld,Ld)}catch{tw=!1}function Rne(i,e,t,r,n,a,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var rm=!1,iv=null,rv=!1,iw=null,Fne={onError:function(i){rm=!0,iv=i}};function One(i,e,t,r,n,a,o,s,l){rm=!1,iv=null,Rne.apply(Fne,arguments)}function Bne(i,e,t,r,n,a,o,s,l){if(One.apply(this,arguments),rm){if(rm){var u=iv;rm=!1,iv=null}else throw Error(et(198));rv||(rv=!0,iw=u)}}function xh(i){var e=i,t=i;if(i.alternate)for(;e.return;)e=e.return;else{i=e;do e=i,e.flags&4098&&(t=e.return),i=e.return;while(i)}return e.tag===3?t:null}function zL(i){if(i.tag===13){var e=i.memoizedState;if(e===null&&(i=i.alternate,i!==null&&(e=i.memoizedState)),e!==null)return e.dehydrated}return null}function PP(i){if(xh(i)!==i)throw Error(et(188))}function zne(i){var e=i.alternate;if(!e){if(e=xh(i),e===null)throw Error(et(188));return e!==i?null:i}for(var t=i,r=e;;){var n=t.return;if(n===null)break;var a=n.alternate;if(a===null){if(r=n.return,r!==null){t=r;continue}break}if(n.child===a.child){for(a=n.child;a;){if(a===t)return PP(n),i;if(a===r)return PP(n),e;a=a.sibling}throw Error(et(188))}if(t.return!==r.return)t=n,r=a;else{for(var o=!1,s=n.child;s;){if(s===t){o=!0,t=n,r=a;break}if(s===r){o=!0,r=n,t=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===t){o=!0,t=a,r=n;break}if(s===r){o=!0,r=a,t=n;break}s=s.sibling}if(!o)throw Error(et(189))}}if(t.alternate!==r)throw Error(et(190))}if(t.tag!==3)throw Error(et(188));return t.stateNode.current===t?i:e}function NL(i){return i=zne(i),i!==null?$L(i):null}function $L(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var e=$L(i);if(e!==null)return e;i=i.sibling}return null}var UL=_a.unstable_scheduleCallback,AP=_a.unstable_cancelCallback,Nne=_a.unstable_shouldYield,$ne=_a.unstable_requestPaint,xr=_a.unstable_now,Une=_a.unstable_getCurrentPriorityLevel,HC=_a.unstable_ImmediatePriority,VL=_a.unstable_UserBlockingPriority,nv=_a.unstable_NormalPriority,Vne=_a.unstable_LowPriority,jL=_a.unstable_IdlePriority,fx=null,Wo=null;function jne(i){if(Wo&&typeof Wo.onCommitFiberRoot=="function")try{Wo.onCommitFiberRoot(fx,i,void 0,(i.current.flags&128)===128)}catch{}}var bo=Math.clz32?Math.clz32:Wne,Hne=Math.log,Gne=Math.LN2;function Wne(i){return i>>>=0,i===0?32:31-(Hne(i)/Gne|0)|0}var Hg=64,Gg=4194304;function of(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function av(i,e){var t=i.pendingLanes;if(t===0)return 0;var r=0,n=i.suspendedLanes,a=i.pingedLanes,o=t&268435455;if(o!==0){var s=o&~n;s!==0?r=of(s):(a&=o,a!==0&&(r=of(a)))}else o=t&~n,o!==0?r=of(o):a!==0&&(r=of(a));if(r===0)return 0;if(e!==0&&e!==r&&!(e&n)&&(n=r&-r,a=e&-e,n>=a||n===16&&(a&4194240)!==0))return e;if(r&4&&(r|=t&16),e=i.entangledLanes,e!==0)for(i=i.entanglements,e&=r;0<e;)t=31-bo(e),n=1<<t,r|=i[t],e&=~n;return r}function Xne(i,e){switch(i){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qne(i,e){for(var t=i.suspendedLanes,r=i.pingedLanes,n=i.expirationTimes,a=i.pendingLanes;0<a;){var o=31-bo(a),s=1<<o,l=n[o];l===-1?(!(s&t)||s&r)&&(n[o]=Xne(s,e)):l<=e&&(i.expiredLanes|=s),a&=~s}}function rw(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function HL(){var i=Hg;return Hg<<=1,!(Hg&4194240)&&(Hg=64),i}function e2(i){for(var e=[],t=0;31>t;t++)e.push(i);return e}function ig(i,e,t){i.pendingLanes|=e,e!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,e=31-bo(e),i[e]=t}function Zne(i,e){var t=i.pendingLanes&~e;i.pendingLanes=e,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=e,i.mutableReadLanes&=e,i.entangledLanes&=e,e=i.entanglements;var r=i.eventTimes;for(i=i.expirationTimes;0<t;){var n=31-bo(t),a=1<<n;e[n]=0,r[n]=-1,i[n]=-1,t&=~a}}function GC(i,e){var t=i.entangledLanes|=e;for(i=i.entanglements;t;){var r=31-bo(t),n=1<<r;n&e|i[r]&e&&(i[r]|=e),t&=~n}}var Si=0;function GL(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var WL,WC,XL,qL,ZL,nw=!1,Wg=[],Al=null,Il=null,Ll=null,xm=new Map,_m=new Map,xl=[],Yne="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function IP(i,e){switch(i){case"focusin":case"focusout":Al=null;break;case"dragenter":case"dragleave":Il=null;break;case"mouseover":case"mouseout":Ll=null;break;case"pointerover":case"pointerout":xm.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_m.delete(e.pointerId)}}function Dd(i,e,t,r,n,a){return i===null||i.nativeEvent!==a?(i={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:a,targetContainers:[n]},e!==null&&(e=ng(e),e!==null&&WC(e)),i):(i.eventSystemFlags|=r,e=i.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),i)}function Jne(i,e,t,r,n){switch(e){case"focusin":return Al=Dd(Al,i,e,t,r,n),!0;case"dragenter":return Il=Dd(Il,i,e,t,r,n),!0;case"mouseover":return Ll=Dd(Ll,i,e,t,r,n),!0;case"pointerover":var a=n.pointerId;return xm.set(a,Dd(xm.get(a)||null,i,e,t,r,n)),!0;case"gotpointercapture":return a=n.pointerId,_m.set(a,Dd(_m.get(a)||null,i,e,t,r,n)),!0}return!1}function YL(i){var e=ku(i.target);if(e!==null){var t=xh(e);if(t!==null){if(e=t.tag,e===13){if(e=zL(t),e!==null){i.blockedOn=e,ZL(i.priority,function(){XL(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){i.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}i.blockedOn=null}function uy(i){if(i.blockedOn!==null)return!1;for(var e=i.targetContainers;0<e.length;){var t=aw(i.domEventName,i.eventSystemFlags,e[0],i.nativeEvent);if(t===null){t=i.nativeEvent;var r=new t.constructor(t.type,t);Qb=r,t.target.dispatchEvent(r),Qb=null}else return e=ng(t),e!==null&&WC(e),i.blockedOn=t,!1;e.shift()}return!0}function LP(i,e,t){uy(i)&&t.delete(e)}function Kne(){nw=!1,Al!==null&&uy(Al)&&(Al=null),Il!==null&&uy(Il)&&(Il=null),Ll!==null&&uy(Ll)&&(Ll=null),xm.forEach(LP),_m.forEach(LP)}function kd(i,e){i.blockedOn===e&&(i.blockedOn=null,nw||(nw=!0,_a.unstable_scheduleCallback(_a.unstable_NormalPriority,Kne)))}function bm(i){function e(n){return kd(n,i)}if(0<Wg.length){kd(Wg[0],i);for(var t=1;t<Wg.length;t++){var r=Wg[t];r.blockedOn===i&&(r.blockedOn=null)}}for(Al!==null&&kd(Al,i),Il!==null&&kd(Il,i),Ll!==null&&kd(Ll,i),xm.forEach(e),_m.forEach(e),t=0;t<xl.length;t++)r=xl[t],r.blockedOn===i&&(r.blockedOn=null);for(;0<xl.length&&(t=xl[0],t.blockedOn===null);)YL(t),t.blockedOn===null&&xl.shift()}var fp=Vs.ReactCurrentBatchConfig,ov=!0;function Qne(i,e,t,r){var n=Si,a=fp.transition;fp.transition=null;try{Si=1,XC(i,e,t,r)}finally{Si=n,fp.transition=a}}function eae(i,e,t,r){var n=Si,a=fp.transition;fp.transition=null;try{Si=4,XC(i,e,t,r)}finally{Si=n,fp.transition=a}}function XC(i,e,t,r){if(ov){var n=aw(i,e,t,r);if(n===null)h2(i,e,r,sv,t),IP(i,r);else if(Jne(n,i,e,t,r))r.stopPropagation();else if(IP(i,r),e&4&&-1<Yne.indexOf(i)){for(;n!==null;){var a=ng(n);if(a!==null&&WL(a),a=aw(i,e,t,r),a===null&&h2(i,e,r,sv,t),a===n)break;n=a}n!==null&&r.stopPropagation()}else h2(i,e,r,null,t)}}var sv=null;function aw(i,e,t,r){if(sv=null,i=jC(r),i=ku(i),i!==null)if(e=xh(i),e===null)i=null;else if(t=e.tag,t===13){if(i=zL(e),i!==null)return i;i=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;i=null}else e!==i&&(i=null);return sv=i,null}function JL(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Une()){case HC:return 1;case VL:return 4;case nv:case Vne:return 16;case jL:return 536870912;default:return 16}default:return 16}}var wl=null,qC=null,hy=null;function KL(){if(hy)return hy;var i,e=qC,t=e.length,r,n="value"in wl?wl.value:wl.textContent,a=n.length;for(i=0;i<t&&e[i]===n[i];i++);var o=t-i;for(r=1;r<=o&&e[t-r]===n[a-r];r++);return hy=n.slice(i,1<r?1-r:void 0)}function cy(i){var e=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&e===13&&(i=13)):i=e,i===10&&(i=13),32<=i||i===13?i:0}function Xg(){return!0}function DP(){return!1}function wa(i){function e(t,r,n,a,o){this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var s in i)i.hasOwnProperty(s)&&(t=i[s],this[s]=t?t(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Xg:DP,this.isPropagationStopped=DP,this}return ar(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Xg)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Xg)},persist:function(){},isPersistent:Xg}),e}var pd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ZC=wa(pd),rg=ar({},pd,{view:0,detail:0}),tae=wa(rg),t2,i2,Rd,mx=ar({},rg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:YC,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Rd&&(Rd&&i.type==="mousemove"?(t2=i.screenX-Rd.screenX,i2=i.screenY-Rd.screenY):i2=t2=0,Rd=i),t2)},movementY:function(i){return"movementY"in i?i.movementY:i2}}),kP=wa(mx),iae=ar({},mx,{dataTransfer:0}),rae=wa(iae),nae=ar({},rg,{relatedTarget:0}),r2=wa(nae),aae=ar({},pd,{animationName:0,elapsedTime:0,pseudoElement:0}),oae=wa(aae),sae=ar({},pd,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),lae=wa(sae),uae=ar({},pd,{data:0}),RP=wa(uae),hae={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cae={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pae={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dae(i){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(i):(i=pae[i])?!!e[i]:!1}function YC(){return dae}var fae=ar({},rg,{key:function(i){if(i.key){var e=hae[i.key]||i.key;if(e!=="Unidentified")return e}return i.type==="keypress"?(i=cy(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?cae[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:YC,charCode:function(i){return i.type==="keypress"?cy(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?cy(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),mae=wa(fae),gae=ar({},mx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),FP=wa(gae),yae=ar({},rg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:YC}),vae=wa(yae),xae=ar({},pd,{propertyName:0,elapsedTime:0,pseudoElement:0}),_ae=wa(xae),bae=ar({},mx,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),wae=wa(bae),Sae=[9,13,27,32],JC=Fs&&"CompositionEvent"in window,nm=null;Fs&&"documentMode"in document&&(nm=document.documentMode);var Mae=Fs&&"TextEvent"in window&&!nm,QL=Fs&&(!JC||nm&&8<nm&&11>=nm),OP=" ",BP=!1;function e7(i,e){switch(i){case"keyup":return Sae.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function t7(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Wc=!1;function Cae(i,e){switch(i){case"compositionend":return t7(e);case"keypress":return e.which!==32?null:(BP=!0,OP);case"textInput":return i=e.data,i===OP&&BP?null:i;default:return null}}function Eae(i,e){if(Wc)return i==="compositionend"||!JC&&e7(i,e)?(i=KL(),hy=qC=wl=null,Wc=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return QL&&e.locale!=="ko"?null:e.data;default:return null}}var Tae={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zP(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e==="input"?!!Tae[i.type]:e==="textarea"}function i7(i,e,t,r){kL(r),e=lv(e,"onChange"),0<e.length&&(t=new ZC("onChange","change",null,t,r),i.push({event:t,listeners:e}))}var am=null,wm=null;function Pae(i){d7(i,0)}function gx(i){var e=Zc(i);if(EL(e))return i}function Aae(i,e){if(i==="change")return e}var r7=!1;if(Fs){var n2;if(Fs){var a2="oninput"in document;if(!a2){var NP=document.createElement("div");NP.setAttribute("oninput","return;"),a2=typeof NP.oninput=="function"}n2=a2}else n2=!1;r7=n2&&(!document.documentMode||9<document.documentMode)}function $P(){am&&(am.detachEvent("onpropertychange",n7),wm=am=null)}function n7(i){if(i.propertyName==="value"&&gx(wm)){var e=[];i7(e,wm,i,jC(i)),BL(Pae,e)}}function Iae(i,e,t){i==="focusin"?($P(),am=e,wm=t,am.attachEvent("onpropertychange",n7)):i==="focusout"&&$P()}function Lae(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return gx(wm)}function Dae(i,e){if(i==="click")return gx(e)}function kae(i,e){if(i==="input"||i==="change")return gx(e)}function Rae(i,e){return i===e&&(i!==0||1/i===1/e)||i!==i&&e!==e}var Mo=typeof Object.is=="function"?Object.is:Rae;function Sm(i,e){if(Mo(i,e))return!0;if(typeof i!="object"||i===null||typeof e!="object"||e===null)return!1;var t=Object.keys(i),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var n=t[r];if(!Ub.call(e,n)||!Mo(i[n],e[n]))return!1}return!0}function UP(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function VP(i,e){var t=UP(i);i=0;for(var r;t;){if(t.nodeType===3){if(r=i+t.textContent.length,i<=e&&r>=e)return{node:t,offset:e-i};i=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=UP(t)}}function a7(i,e){return i&&e?i===e?!0:i&&i.nodeType===3?!1:e&&e.nodeType===3?a7(i,e.parentNode):"contains"in i?i.contains(e):i.compareDocumentPosition?!!(i.compareDocumentPosition(e)&16):!1:!1}function o7(){for(var i=window,e=tv();e instanceof i.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)i=e.contentWindow;else break;e=tv(i.document)}return e}function KC(i){var e=i&&i.nodeName&&i.nodeName.toLowerCase();return e&&(e==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||e==="textarea"||i.contentEditable==="true")}function Fae(i){var e=o7(),t=i.focusedElem,r=i.selectionRange;if(e!==t&&t&&t.ownerDocument&&a7(t.ownerDocument.documentElement,t)){if(r!==null&&KC(t)){if(e=r.start,i=r.end,i===void 0&&(i=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(i,t.value.length);else if(i=(e=t.ownerDocument||document)&&e.defaultView||window,i.getSelection){i=i.getSelection();var n=t.textContent.length,a=Math.min(r.start,n);r=r.end===void 0?a:Math.min(r.end,n),!i.extend&&a>r&&(n=r,r=a,a=n),n=VP(t,a);var o=VP(t,r);n&&o&&(i.rangeCount!==1||i.anchorNode!==n.node||i.anchorOffset!==n.offset||i.focusNode!==o.node||i.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),i.removeAllRanges(),a>r?(i.addRange(e),i.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),i.addRange(e)))}}for(e=[],i=t;i=i.parentNode;)i.nodeType===1&&e.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)i=e[t],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Oae=Fs&&"documentMode"in document&&11>=document.documentMode,Xc=null,ow=null,om=null,sw=!1;function jP(i,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;sw||Xc==null||Xc!==tv(r)||(r=Xc,"selectionStart"in r&&KC(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),om&&Sm(om,r)||(om=r,r=lv(ow,"onSelect"),0<r.length&&(e=new ZC("onSelect","select",null,e,t),i.push({event:e,listeners:r}),e.target=Xc)))}function qg(i,e){var t={};return t[i.toLowerCase()]=e.toLowerCase(),t["Webkit"+i]="webkit"+e,t["Moz"+i]="moz"+e,t}var qc={animationend:qg("Animation","AnimationEnd"),animationiteration:qg("Animation","AnimationIteration"),animationstart:qg("Animation","AnimationStart"),transitionend:qg("Transition","TransitionEnd")},o2={},s7={};Fs&&(s7=document.createElement("div").style,"AnimationEvent"in window||(delete qc.animationend.animation,delete qc.animationiteration.animation,delete qc.animationstart.animation),"TransitionEvent"in window||delete qc.transitionend.transition);function yx(i){if(o2[i])return o2[i];if(!qc[i])return i;var e=qc[i],t;for(t in e)if(e.hasOwnProperty(t)&&t in s7)return o2[i]=e[t];return i}var l7=yx("animationend"),u7=yx("animationiteration"),h7=yx("animationstart"),c7=yx("transitionend"),p7=new Map,HP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yl(i,e){p7.set(i,e),vh(e,[i])}for(var s2=0;s2<HP.length;s2++){var l2=HP[s2],Bae=l2.toLowerCase(),zae=l2[0].toUpperCase()+l2.slice(1);Yl(Bae,"on"+zae)}Yl(l7,"onAnimationEnd");Yl(u7,"onAnimationIteration");Yl(h7,"onAnimationStart");Yl("dblclick","onDoubleClick");Yl("focusin","onFocus");Yl("focusout","onBlur");Yl(c7,"onTransitionEnd");Bp("onMouseEnter",["mouseout","mouseover"]);Bp("onMouseLeave",["mouseout","mouseover"]);Bp("onPointerEnter",["pointerout","pointerover"]);Bp("onPointerLeave",["pointerout","pointerover"]);vh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vh("onBeforeInput",["compositionend","keypress","textInput","paste"]);vh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nae=new Set("cancel close invalid load scroll toggle".split(" ").concat(sf));function GP(i,e,t){var r=i.type||"unknown-event";i.currentTarget=t,Bne(r,e,void 0,i),i.currentTarget=null}function d7(i,e){e=(e&4)!==0;for(var t=0;t<i.length;t++){var r=i[t],n=r.event;r=r.listeners;e:{var a=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==a&&n.isPropagationStopped())break e;GP(n,s,u),a=l}else for(o=0;o<r.length;o++){if(s=r[o],l=s.instance,u=s.currentTarget,s=s.listener,l!==a&&n.isPropagationStopped())break e;GP(n,s,u),a=l}}}if(rv)throw i=iw,rv=!1,iw=null,i}function Ri(i,e){var t=e[pw];t===void 0&&(t=e[pw]=new Set);var r=i+"__bubble";t.has(r)||(f7(e,i,2,!1),t.add(r))}function u2(i,e,t){var r=0;e&&(r|=4),f7(t,i,r,e)}var Zg="_reactListening"+Math.random().toString(36).slice(2);function Mm(i){if(!i[Zg]){i[Zg]=!0,bL.forEach(function(t){t!=="selectionchange"&&(Nae.has(t)||u2(t,!1,i),u2(t,!0,i))});var e=i.nodeType===9?i:i.ownerDocument;e===null||e[Zg]||(e[Zg]=!0,u2("selectionchange",!1,e))}}function f7(i,e,t,r){switch(JL(e)){case 1:var n=Qne;break;case 4:n=eae;break;default:n=XC}t=n.bind(null,e,t,i),n=void 0,!tw||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),r?n!==void 0?i.addEventListener(e,t,{capture:!0,passive:n}):i.addEventListener(e,t,!0):n!==void 0?i.addEventListener(e,t,{passive:n}):i.addEventListener(e,t,!1)}function h2(i,e,t,r,n){var a=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var s=r.stateNode.containerInfo;if(s===n||s.nodeType===8&&s.parentNode===n)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;o=o.return}for(;s!==null;){if(o=ku(s),o===null)return;if(l=o.tag,l===5||l===6){r=a=o;continue e}s=s.parentNode}}r=r.return}BL(function(){var u=a,c=jC(t),p=[];e:{var d=p7.get(i);if(d!==void 0){var m=ZC,g=i;switch(i){case"keypress":if(cy(t)===0)break e;case"keydown":case"keyup":m=mae;break;case"focusin":g="focus",m=r2;break;case"focusout":g="blur",m=r2;break;case"beforeblur":case"afterblur":m=r2;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=kP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=rae;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=vae;break;case l7:case u7:case h7:m=oae;break;case c7:m=_ae;break;case"scroll":m=tae;break;case"wheel":m=wae;break;case"copy":case"cut":case"paste":m=lae;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=FP}var _=(e&4)!==0,y=!_&&i==="scroll",x=_?d!==null?d+"Capture":null:d;_=[];for(var w=u,b;w!==null;){b=w;var C=b.stateNode;if(b.tag===5&&C!==null&&(b=C,x!==null&&(C=vm(w,x),C!=null&&_.push(Cm(w,C,b)))),y)break;w=w.return}0<_.length&&(d=new m(d,g,null,t,c),p.push({event:d,listeners:_}))}}if(!(e&7)){e:{if(d=i==="mouseover"||i==="pointerover",m=i==="mouseout"||i==="pointerout",d&&t!==Qb&&(g=t.relatedTarget||t.fromElement)&&(ku(g)||g[Os]))break e;if((m||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,m?(g=t.relatedTarget||t.toElement,m=u,g=g?ku(g):null,g!==null&&(y=xh(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(_=kP,C="onMouseLeave",x="onMouseEnter",w="mouse",(i==="pointerout"||i==="pointerover")&&(_=FP,C="onPointerLeave",x="onPointerEnter",w="pointer"),y=m==null?d:Zc(m),b=g==null?d:Zc(g),d=new _(C,w+"leave",m,t,c),d.target=y,d.relatedTarget=b,C=null,ku(c)===u&&(_=new _(x,w+"enter",g,t,c),_.target=b,_.relatedTarget=y,C=_),y=C,m&&g)t:{for(_=m,x=g,w=0,b=_;b;b=Fh(b))w++;for(b=0,C=x;C;C=Fh(C))b++;for(;0<w-b;)_=Fh(_),w--;for(;0<b-w;)x=Fh(x),b--;for(;w--;){if(_===x||x!==null&&_===x.alternate)break t;_=Fh(_),x=Fh(x)}_=null}else _=null;m!==null&&WP(p,d,m,_,!1),g!==null&&y!==null&&WP(p,y,g,_,!0)}}e:{if(d=u?Zc(u):window,m=d.nodeName&&d.nodeName.toLowerCase(),m==="select"||m==="input"&&d.type==="file")var E=Aae;else if(zP(d))if(r7)E=kae;else{E=Lae;var T=Iae}else(m=d.nodeName)&&m.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(E=Dae);if(E&&(E=E(i,u))){i7(p,E,t,c);break e}T&&T(i,d,u),i==="focusout"&&(T=d._wrapperState)&&T.controlled&&d.type==="number"&&qb(d,"number",d.value)}switch(T=u?Zc(u):window,i){case"focusin":(zP(T)||T.contentEditable==="true")&&(Xc=T,ow=u,om=null);break;case"focusout":om=ow=Xc=null;break;case"mousedown":sw=!0;break;case"contextmenu":case"mouseup":case"dragend":sw=!1,jP(p,t,c);break;case"selectionchange":if(Oae)break;case"keydown":case"keyup":jP(p,t,c)}var L;if(JC)e:{switch(i){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Wc?e7(i,t)&&(D="onCompositionEnd"):i==="keydown"&&t.keyCode===229&&(D="onCompositionStart");D&&(QL&&t.locale!=="ko"&&(Wc||D!=="onCompositionStart"?D==="onCompositionEnd"&&Wc&&(L=KL()):(wl=c,qC="value"in wl?wl.value:wl.textContent,Wc=!0)),T=lv(u,D),0<T.length&&(D=new RP(D,i,null,t,c),p.push({event:D,listeners:T}),L?D.data=L:(L=t7(t),L!==null&&(D.data=L)))),(L=Mae?Cae(i,t):Eae(i,t))&&(u=lv(u,"onBeforeInput"),0<u.length&&(c=new RP("onBeforeInput","beforeinput",null,t,c),p.push({event:c,listeners:u}),c.data=L))}d7(p,e)})}function Cm(i,e,t){return{instance:i,listener:e,currentTarget:t}}function lv(i,e){for(var t=e+"Capture",r=[];i!==null;){var n=i,a=n.stateNode;n.tag===5&&a!==null&&(n=a,a=vm(i,t),a!=null&&r.unshift(Cm(i,a,n)),a=vm(i,e),a!=null&&r.push(Cm(i,a,n))),i=i.return}return r}function Fh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function WP(i,e,t,r,n){for(var a=e._reactName,o=[];t!==null&&t!==r;){var s=t,l=s.alternate,u=s.stateNode;if(l!==null&&l===r)break;s.tag===5&&u!==null&&(s=u,n?(l=vm(t,a),l!=null&&o.unshift(Cm(t,l,s))):n||(l=vm(t,a),l!=null&&o.push(Cm(t,l,s)))),t=t.return}o.length!==0&&i.push({event:e,listeners:o})}var $ae=/\r\n?/g,Uae=/\u0000|\uFFFD/g;function XP(i){return(typeof i=="string"?i:""+i).replace($ae,`
`).replace(Uae,"")}function Yg(i,e,t){if(e=XP(e),XP(i)!==e&&t)throw Error(et(425))}function uv(){}var lw=null,uw=null;function hw(i,e){return i==="textarea"||i==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cw=typeof setTimeout=="function"?setTimeout:void 0,Vae=typeof clearTimeout=="function"?clearTimeout:void 0,qP=typeof Promise=="function"?Promise:void 0,jae=typeof queueMicrotask=="function"?queueMicrotask:typeof qP<"u"?function(i){return qP.resolve(null).then(i).catch(Hae)}:cw;function Hae(i){setTimeout(function(){throw i})}function c2(i,e){var t=e,r=0;do{var n=t.nextSibling;if(i.removeChild(t),n&&n.nodeType===8)if(t=n.data,t==="/$"){if(r===0){i.removeChild(n),bm(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=n}while(t);bm(e)}function Dl(i){for(;i!=null;i=i.nextSibling){var e=i.nodeType;if(e===1||e===3)break;if(e===8){if(e=i.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return i}function ZP(i){i=i.previousSibling;for(var e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return i;e--}else t==="/$"&&e++}i=i.previousSibling}return null}var dd=Math.random().toString(36).slice(2),Ho="__reactFiber$"+dd,Em="__reactProps$"+dd,Os="__reactContainer$"+dd,pw="__reactEvents$"+dd,Gae="__reactListeners$"+dd,Wae="__reactHandles$"+dd;function ku(i){var e=i[Ho];if(e)return e;for(var t=i.parentNode;t;){if(e=t[Os]||t[Ho]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(i=ZP(i);i!==null;){if(t=i[Ho])return t;i=ZP(i)}return e}i=t,t=i.parentNode}return null}function ng(i){return i=i[Ho]||i[Os],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Zc(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(et(33))}function vx(i){return i[Em]||null}var dw=[],Yc=-1;function Jl(i){return{current:i}}function zi(i){0>Yc||(i.current=dw[Yc],dw[Yc]=null,Yc--)}function Ii(i,e){Yc++,dw[Yc]=i.current,i.current=e}var jl={},fn=Jl(jl),qn=Jl(!1),th=jl;function zp(i,e){var t=i.type.contextTypes;if(!t)return jl;var r=i.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var n={},a;for(a in t)n[a]=e[a];return r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=e,i.__reactInternalMemoizedMaskedChildContext=n),n}function Zn(i){return i=i.childContextTypes,i!=null}function hv(){zi(qn),zi(fn)}function YP(i,e,t){if(fn.current!==jl)throw Error(et(168));Ii(fn,e),Ii(qn,t)}function m7(i,e,t){var r=i.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var n in r)if(!(n in e))throw Error(et(108,Ine(i)||"Unknown",n));return ar({},t,r)}function cv(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||jl,th=fn.current,Ii(fn,i),Ii(qn,qn.current),!0}function JP(i,e,t){var r=i.stateNode;if(!r)throw Error(et(169));t?(i=m7(i,e,th),r.__reactInternalMemoizedMergedChildContext=i,zi(qn),zi(fn),Ii(fn,i)):zi(qn),Ii(qn,t)}var Ms=null,xx=!1,p2=!1;function g7(i){Ms===null?Ms=[i]:Ms.push(i)}function Xae(i){xx=!0,g7(i)}function Kl(){if(!p2&&Ms!==null){p2=!0;var i=0,e=Si;try{var t=Ms;for(Si=1;i<t.length;i++){var r=t[i];do r=r(!0);while(r!==null)}Ms=null,xx=!1}catch(n){throw Ms!==null&&(Ms=Ms.slice(i+1)),UL(HC,Kl),n}finally{Si=e,p2=!1}}return null}var Jc=[],Kc=0,pv=null,dv=0,Ra=[],Fa=0,ih=null,As=1,Is="";function fu(i,e){Jc[Kc++]=dv,Jc[Kc++]=pv,pv=i,dv=e}function y7(i,e,t){Ra[Fa++]=As,Ra[Fa++]=Is,Ra[Fa++]=ih,ih=i;var r=As;i=Is;var n=32-bo(r)-1;r&=~(1<<n),t+=1;var a=32-bo(e)+n;if(30<a){var o=n-n%5;a=(r&(1<<o)-1).toString(32),r>>=o,n-=o,As=1<<32-bo(e)+n|t<<n|r,Is=a+i}else As=1<<a|t<<n|r,Is=i}function QC(i){i.return!==null&&(fu(i,1),y7(i,1,0))}function eE(i){for(;i===pv;)pv=Jc[--Kc],Jc[Kc]=null,dv=Jc[--Kc],Jc[Kc]=null;for(;i===ih;)ih=Ra[--Fa],Ra[Fa]=null,Is=Ra[--Fa],Ra[Fa]=null,As=Ra[--Fa],Ra[Fa]=null}var ga=null,pa=null,Gi=!1,go=null;function v7(i,e){var t=Ua(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=i,e=i.deletions,e===null?(i.deletions=[t],i.flags|=16):e.push(t)}function KP(i,e){switch(i.tag){case 5:var t=i.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(i.stateNode=e,ga=i,pa=Dl(e.firstChild),!0):!1;case 6:return e=i.pendingProps===""||e.nodeType!==3?null:e,e!==null?(i.stateNode=e,ga=i,pa=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ih!==null?{id:As,overflow:Is}:null,i.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Ua(18,null,null,0),t.stateNode=e,t.return=i,i.child=t,ga=i,pa=null,!0):!1;default:return!1}}function fw(i){return(i.mode&1)!==0&&(i.flags&128)===0}function mw(i){if(Gi){var e=pa;if(e){var t=e;if(!KP(i,e)){if(fw(i))throw Error(et(418));e=Dl(t.nextSibling);var r=ga;e&&KP(i,e)?v7(r,t):(i.flags=i.flags&-4097|2,Gi=!1,ga=i)}}else{if(fw(i))throw Error(et(418));i.flags=i.flags&-4097|2,Gi=!1,ga=i}}}function QP(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;ga=i}function Jg(i){if(i!==ga)return!1;if(!Gi)return QP(i),Gi=!0,!1;var e;if((e=i.tag!==3)&&!(e=i.tag!==5)&&(e=i.type,e=e!=="head"&&e!=="body"&&!hw(i.type,i.memoizedProps)),e&&(e=pa)){if(fw(i))throw x7(),Error(et(418));for(;e;)v7(i,e),e=Dl(e.nextSibling)}if(QP(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(et(317));e:{for(i=i.nextSibling,e=0;i;){if(i.nodeType===8){var t=i.data;if(t==="/$"){if(e===0){pa=Dl(i.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}i=i.nextSibling}pa=null}}else pa=ga?Dl(i.stateNode.nextSibling):null;return!0}function x7(){for(var i=pa;i;)i=Dl(i.nextSibling)}function Np(){pa=ga=null,Gi=!1}function tE(i){go===null?go=[i]:go.push(i)}var qae=Vs.ReactCurrentBatchConfig;function Fd(i,e,t){if(i=t.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(et(309));var r=t.stateNode}if(!r)throw Error(et(147,i));var n=r,a=""+i;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var s=n.refs;o===null?delete s[a]:s[a]=o},e._stringRef=a,e)}if(typeof i!="string")throw Error(et(284));if(!t._owner)throw Error(et(290,i))}return i}function Kg(i,e){throw i=Object.prototype.toString.call(e),Error(et(31,i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i))}function eA(i){var e=i._init;return e(i._payload)}function _7(i){function e(x,w){if(i){var b=x.deletions;b===null?(x.deletions=[w],x.flags|=16):b.push(w)}}function t(x,w){if(!i)return null;for(;w!==null;)e(x,w),w=w.sibling;return null}function r(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function n(x,w){return x=Ol(x,w),x.index=0,x.sibling=null,x}function a(x,w,b){return x.index=b,i?(b=x.alternate,b!==null?(b=b.index,b<w?(x.flags|=2,w):b):(x.flags|=2,w)):(x.flags|=1048576,w)}function o(x){return i&&x.alternate===null&&(x.flags|=2),x}function s(x,w,b,C){return w===null||w.tag!==6?(w=x2(b,x.mode,C),w.return=x,w):(w=n(w,b),w.return=x,w)}function l(x,w,b,C){var E=b.type;return E===Gc?c(x,w,b.props.children,C,b.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===yl&&eA(E)===w.type)?(C=n(w,b.props),C.ref=Fd(x,w,b),C.return=x,C):(C=vy(b.type,b.key,b.props,null,x.mode,C),C.ref=Fd(x,w,b),C.return=x,C)}function u(x,w,b,C){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=_2(b,x.mode,C),w.return=x,w):(w=n(w,b.children||[]),w.return=x,w)}function c(x,w,b,C,E){return w===null||w.tag!==7?(w=ju(b,x.mode,C,E),w.return=x,w):(w=n(w,b),w.return=x,w)}function p(x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=x2(""+w,x.mode,b),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ug:return b=vy(w.type,w.key,w.props,null,x.mode,b),b.ref=Fd(x,null,w),b.return=x,b;case Hc:return w=_2(w,x.mode,b),w.return=x,w;case yl:var C=w._init;return p(x,C(w._payload),b)}if(af(w)||Id(w))return w=ju(w,x.mode,b,null),w.return=x,w;Kg(x,w)}return null}function d(x,w,b,C){var E=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return E!==null?null:s(x,w,""+b,C);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ug:return b.key===E?l(x,w,b,C):null;case Hc:return b.key===E?u(x,w,b,C):null;case yl:return E=b._init,d(x,w,E(b._payload),C)}if(af(b)||Id(b))return E!==null?null:c(x,w,b,C,null);Kg(x,b)}return null}function m(x,w,b,C,E){if(typeof C=="string"&&C!==""||typeof C=="number")return x=x.get(b)||null,s(w,x,""+C,E);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case Ug:return x=x.get(C.key===null?b:C.key)||null,l(w,x,C,E);case Hc:return x=x.get(C.key===null?b:C.key)||null,u(w,x,C,E);case yl:var T=C._init;return m(x,w,b,T(C._payload),E)}if(af(C)||Id(C))return x=x.get(b)||null,c(w,x,C,E,null);Kg(w,C)}return null}function g(x,w,b,C){for(var E=null,T=null,L=w,D=w=0,B=null;L!==null&&D<b.length;D++){L.index>D?(B=L,L=null):B=L.sibling;var A=d(x,L,b[D],C);if(A===null){L===null&&(L=B);break}i&&L&&A.alternate===null&&e(x,L),w=a(A,w,D),T===null?E=A:T.sibling=A,T=A,L=B}if(D===b.length)return t(x,L),Gi&&fu(x,D),E;if(L===null){for(;D<b.length;D++)L=p(x,b[D],C),L!==null&&(w=a(L,w,D),T===null?E=L:T.sibling=L,T=L);return Gi&&fu(x,D),E}for(L=r(x,L);D<b.length;D++)B=m(L,x,D,b[D],C),B!==null&&(i&&B.alternate!==null&&L.delete(B.key===null?D:B.key),w=a(B,w,D),T===null?E=B:T.sibling=B,T=B);return i&&L.forEach(function(k){return e(x,k)}),Gi&&fu(x,D),E}function _(x,w,b,C){var E=Id(b);if(typeof E!="function")throw Error(et(150));if(b=E.call(b),b==null)throw Error(et(151));for(var T=E=null,L=w,D=w=0,B=null,A=b.next();L!==null&&!A.done;D++,A=b.next()){L.index>D?(B=L,L=null):B=L.sibling;var k=d(x,L,A.value,C);if(k===null){L===null&&(L=B);break}i&&L&&k.alternate===null&&e(x,L),w=a(k,w,D),T===null?E=k:T.sibling=k,T=k,L=B}if(A.done)return t(x,L),Gi&&fu(x,D),E;if(L===null){for(;!A.done;D++,A=b.next())A=p(x,A.value,C),A!==null&&(w=a(A,w,D),T===null?E=A:T.sibling=A,T=A);return Gi&&fu(x,D),E}for(L=r(x,L);!A.done;D++,A=b.next())A=m(L,x,D,A.value,C),A!==null&&(i&&A.alternate!==null&&L.delete(A.key===null?D:A.key),w=a(A,w,D),T===null?E=A:T.sibling=A,T=A);return i&&L.forEach(function($){return e(x,$)}),Gi&&fu(x,D),E}function y(x,w,b,C){if(typeof b=="object"&&b!==null&&b.type===Gc&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Ug:e:{for(var E=b.key,T=w;T!==null;){if(T.key===E){if(E=b.type,E===Gc){if(T.tag===7){t(x,T.sibling),w=n(T,b.props.children),w.return=x,x=w;break e}}else if(T.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===yl&&eA(E)===T.type){t(x,T.sibling),w=n(T,b.props),w.ref=Fd(x,T,b),w.return=x,x=w;break e}t(x,T);break}else e(x,T);T=T.sibling}b.type===Gc?(w=ju(b.props.children,x.mode,C,b.key),w.return=x,x=w):(C=vy(b.type,b.key,b.props,null,x.mode,C),C.ref=Fd(x,w,b),C.return=x,x=C)}return o(x);case Hc:e:{for(T=b.key;w!==null;){if(w.key===T)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){t(x,w.sibling),w=n(w,b.children||[]),w.return=x,x=w;break e}else{t(x,w);break}else e(x,w);w=w.sibling}w=_2(b,x.mode,C),w.return=x,x=w}return o(x);case yl:return T=b._init,y(x,w,T(b._payload),C)}if(af(b))return g(x,w,b,C);if(Id(b))return _(x,w,b,C);Kg(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(t(x,w.sibling),w=n(w,b),w.return=x,x=w):(t(x,w),w=x2(b,x.mode,C),w.return=x,x=w),o(x)):t(x,w)}return y}var $p=_7(!0),b7=_7(!1),fv=Jl(null),mv=null,Qc=null,iE=null;function rE(){iE=Qc=mv=null}function nE(i){var e=fv.current;zi(fv),i._currentValue=e}function gw(i,e,t){for(;i!==null;){var r=i.alternate;if((i.childLanes&e)!==e?(i.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),i===t)break;i=i.return}}function mp(i,e){mv=i,iE=Qc=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&e&&(Wn=!0),i.firstContext=null)}function Ga(i){var e=i._currentValue;if(iE!==i)if(i={context:i,memoizedValue:e,next:null},Qc===null){if(mv===null)throw Error(et(308));Qc=i,mv.dependencies={lanes:0,firstContext:i}}else Qc=Qc.next=i;return e}var Ru=null;function aE(i){Ru===null?Ru=[i]:Ru.push(i)}function w7(i,e,t,r){var n=e.interleaved;return n===null?(t.next=t,aE(e)):(t.next=n.next,n.next=t),e.interleaved=t,Bs(i,r)}function Bs(i,e){i.lanes|=e;var t=i.alternate;for(t!==null&&(t.lanes|=e),t=i,i=i.return;i!==null;)i.childLanes|=e,t=i.alternate,t!==null&&(t.childLanes|=e),t=i,i=i.return;return t.tag===3?t.stateNode:null}var vl=!1;function oE(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function S7(i,e){i=i.updateQueue,e.updateQueue===i&&(e.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ks(i,e){return{eventTime:i,lane:e,tag:0,payload:null,callback:null,next:null}}function kl(i,e,t){var r=i.updateQueue;if(r===null)return null;if(r=r.shared,mi&2){var n=r.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),r.pending=e,Bs(i,t)}return n=r.interleaved,n===null?(e.next=e,aE(r)):(e.next=n.next,n.next=e),r.interleaved=e,Bs(i,t)}function py(i,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,GC(i,t)}}function tA(i,e){var t=i.updateQueue,r=i.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var n=null,a=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};a===null?n=a=o:a=a.next=o,t=t.next}while(t!==null);a===null?n=a=e:a=a.next=e}else n=a=e;t={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:r.shared,effects:r.effects},i.updateQueue=t;return}i=t.lastBaseUpdate,i===null?t.firstBaseUpdate=e:i.next=e,t.lastBaseUpdate=e}function gv(i,e,t,r){var n=i.updateQueue;vl=!1;var a=n.firstBaseUpdate,o=n.lastBaseUpdate,s=n.shared.pending;if(s!==null){n.shared.pending=null;var l=s,u=l.next;l.next=null,o===null?a=u:o.next=u,o=l;var c=i.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==o&&(s===null?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(a!==null){var p=n.baseState;o=0,c=u=l=null,s=a;do{var d=s.lane,m=s.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:m,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=i,_=s;switch(d=e,m=t,_.tag){case 1:if(g=_.payload,typeof g=="function"){p=g.call(m,p,d);break e}p=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=_.payload,d=typeof g=="function"?g.call(m,p,d):g,d==null)break e;p=ar({},p,d);break e;case 2:vl=!0}}s.callback!==null&&s.lane!==0&&(i.flags|=64,d=n.effects,d===null?n.effects=[s]:d.push(s))}else m={eventTime:m,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(u=c=m,l=p):c=c.next=m,o|=d;if(s=s.next,s===null){if(s=n.shared.pending,s===null)break;d=s,s=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(!0);if(c===null&&(l=p),n.baseState=l,n.firstBaseUpdate=u,n.lastBaseUpdate=c,e=n.shared.interleaved,e!==null){n=e;do o|=n.lane,n=n.next;while(n!==e)}else a===null&&(n.shared.lanes=0);nh|=o,i.lanes=o,i.memoizedState=p}}function iA(i,e,t){if(i=e.effects,e.effects=null,i!==null)for(e=0;e<i.length;e++){var r=i[e],n=r.callback;if(n!==null){if(r.callback=null,r=t,typeof n!="function")throw Error(et(191,n));n.call(r)}}}var ag={},Xo=Jl(ag),Tm=Jl(ag),Pm=Jl(ag);function Fu(i){if(i===ag)throw Error(et(174));return i}function sE(i,e){switch(Ii(Pm,e),Ii(Tm,i),Ii(Xo,ag),i=e.nodeType,i){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Yb(null,"");break;default:i=i===8?e.parentNode:e,e=i.namespaceURI||null,i=i.tagName,e=Yb(e,i)}zi(Xo),Ii(Xo,e)}function Up(){zi(Xo),zi(Tm),zi(Pm)}function M7(i){Fu(Pm.current);var e=Fu(Xo.current),t=Yb(e,i.type);e!==t&&(Ii(Tm,i),Ii(Xo,t))}function lE(i){Tm.current===i&&(zi(Xo),zi(Tm))}var er=Jl(0);function yv(i){for(var e=i;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var d2=[];function uE(){for(var i=0;i<d2.length;i++)d2[i]._workInProgressVersionPrimary=null;d2.length=0}var dy=Vs.ReactCurrentDispatcher,f2=Vs.ReactCurrentBatchConfig,rh=0,nr=null,Br=null,Wr=null,vv=!1,sm=!1,Am=0,Zae=0;function nn(){throw Error(et(321))}function hE(i,e){if(e===null)return!1;for(var t=0;t<e.length&&t<i.length;t++)if(!Mo(i[t],e[t]))return!1;return!0}function cE(i,e,t,r,n,a){if(rh=a,nr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,dy.current=i===null||i.memoizedState===null?Qae:eoe,i=t(r,n),sm){a=0;do{if(sm=!1,Am=0,25<=a)throw Error(et(301));a+=1,Wr=Br=null,e.updateQueue=null,dy.current=toe,i=t(r,n)}while(sm)}if(dy.current=xv,e=Br!==null&&Br.next!==null,rh=0,Wr=Br=nr=null,vv=!1,e)throw Error(et(300));return i}function pE(){var i=Am!==0;return Am=0,i}function Uo(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wr===null?nr.memoizedState=Wr=i:Wr=Wr.next=i,Wr}function Wa(){if(Br===null){var i=nr.alternate;i=i!==null?i.memoizedState:null}else i=Br.next;var e=Wr===null?nr.memoizedState:Wr.next;if(e!==null)Wr=e,Br=i;else{if(i===null)throw Error(et(310));Br=i,i={memoizedState:Br.memoizedState,baseState:Br.baseState,baseQueue:Br.baseQueue,queue:Br.queue,next:null},Wr===null?nr.memoizedState=Wr=i:Wr=Wr.next=i}return Wr}function Im(i,e){return typeof e=="function"?e(i):e}function m2(i){var e=Wa(),t=e.queue;if(t===null)throw Error(et(311));t.lastRenderedReducer=i;var r=Br,n=r.baseQueue,a=t.pending;if(a!==null){if(n!==null){var o=n.next;n.next=a.next,a.next=o}r.baseQueue=n=a,t.pending=null}if(n!==null){a=n.next,r=r.baseState;var s=o=null,l=null,u=a;do{var c=u.lane;if((rh&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:i(r,u.action);else{var p={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=p,o=r):l=l.next=p,nr.lanes|=c,nh|=c}u=u.next}while(u!==null&&u!==a);l===null?o=r:l.next=s,Mo(r,e.memoizedState)||(Wn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,t.lastRenderedState=r}if(i=t.interleaved,i!==null){n=i;do a=n.lane,nr.lanes|=a,nh|=a,n=n.next;while(n!==i)}else n===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function g2(i){var e=Wa(),t=e.queue;if(t===null)throw Error(et(311));t.lastRenderedReducer=i;var r=t.dispatch,n=t.pending,a=e.memoizedState;if(n!==null){t.pending=null;var o=n=n.next;do a=i(a,o.action),o=o.next;while(o!==n);Mo(a,e.memoizedState)||(Wn=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),t.lastRenderedState=a}return[a,r]}function C7(){}function E7(i,e){var t=nr,r=Wa(),n=e(),a=!Mo(r.memoizedState,n);if(a&&(r.memoizedState=n,Wn=!0),r=r.queue,dE(A7.bind(null,t,r,i),[i]),r.getSnapshot!==e||a||Wr!==null&&Wr.memoizedState.tag&1){if(t.flags|=2048,Lm(9,P7.bind(null,t,r,n,e),void 0,null),Xr===null)throw Error(et(349));rh&30||T7(t,e,n)}return n}function T7(i,e,t){i.flags|=16384,i={getSnapshot:e,value:t},e=nr.updateQueue,e===null?(e={lastEffect:null,stores:null},nr.updateQueue=e,e.stores=[i]):(t=e.stores,t===null?e.stores=[i]:t.push(i))}function P7(i,e,t,r){e.value=t,e.getSnapshot=r,I7(e)&&L7(i)}function A7(i,e,t){return t(function(){I7(e)&&L7(i)})}function I7(i){var e=i.getSnapshot;i=i.value;try{var t=e();return!Mo(i,t)}catch{return!0}}function L7(i){var e=Bs(i,1);e!==null&&wo(e,i,1,-1)}function rA(i){var e=Uo();return typeof i=="function"&&(i=i()),e.memoizedState=e.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Im,lastRenderedState:i},e.queue=i,i=i.dispatch=Kae.bind(null,nr,i),[e.memoizedState,i]}function Lm(i,e,t,r){return i={tag:i,create:e,destroy:t,deps:r,next:null},e=nr.updateQueue,e===null?(e={lastEffect:null,stores:null},nr.updateQueue=e,e.lastEffect=i.next=i):(t=e.lastEffect,t===null?e.lastEffect=i.next=i:(r=t.next,t.next=i,i.next=r,e.lastEffect=i)),i}function D7(){return Wa().memoizedState}function fy(i,e,t,r){var n=Uo();nr.flags|=i,n.memoizedState=Lm(1|e,t,void 0,r===void 0?null:r)}function _x(i,e,t,r){var n=Wa();r=r===void 0?null:r;var a=void 0;if(Br!==null){var o=Br.memoizedState;if(a=o.destroy,r!==null&&hE(r,o.deps)){n.memoizedState=Lm(e,t,a,r);return}}nr.flags|=i,n.memoizedState=Lm(1|e,t,a,r)}function nA(i,e){return fy(8390656,8,i,e)}function dE(i,e){return _x(2048,8,i,e)}function k7(i,e){return _x(4,2,i,e)}function R7(i,e){return _x(4,4,i,e)}function F7(i,e){if(typeof e=="function")return i=i(),e(i),function(){e(null)};if(e!=null)return i=i(),e.current=i,function(){e.current=null}}function O7(i,e,t){return t=t!=null?t.concat([i]):null,_x(4,4,F7.bind(null,e,i),t)}function fE(){}function B7(i,e){var t=Wa();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&hE(e,r[1])?r[0]:(t.memoizedState=[i,e],i)}function z7(i,e){var t=Wa();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&hE(e,r[1])?r[0]:(i=i(),t.memoizedState=[i,e],i)}function N7(i,e,t){return rh&21?(Mo(t,e)||(t=HL(),nr.lanes|=t,nh|=t,i.baseState=!0),e):(i.baseState&&(i.baseState=!1,Wn=!0),i.memoizedState=t)}function Yae(i,e){var t=Si;Si=t!==0&&4>t?t:4,i(!0);var r=f2.transition;f2.transition={};try{i(!1),e()}finally{Si=t,f2.transition=r}}function $7(){return Wa().memoizedState}function Jae(i,e,t){var r=Fl(i);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},U7(i))V7(e,t);else if(t=w7(i,e,t,r),t!==null){var n=Pn();wo(t,i,r,n),j7(t,e,r)}}function Kae(i,e,t){var r=Fl(i),n={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(U7(i))V7(e,n);else{var a=i.alternate;if(i.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,s=a(o,t);if(n.hasEagerState=!0,n.eagerState=s,Mo(s,o)){var l=e.interleaved;l===null?(n.next=n,aE(e)):(n.next=l.next,l.next=n),e.interleaved=n;return}}catch{}finally{}t=w7(i,e,n,r),t!==null&&(n=Pn(),wo(t,i,r,n),j7(t,e,r))}}function U7(i){var e=i.alternate;return i===nr||e!==null&&e===nr}function V7(i,e){sm=vv=!0;var t=i.pending;t===null?e.next=e:(e.next=t.next,t.next=e),i.pending=e}function j7(i,e,t){if(t&4194240){var r=e.lanes;r&=i.pendingLanes,t|=r,e.lanes=t,GC(i,t)}}var xv={readContext:Ga,useCallback:nn,useContext:nn,useEffect:nn,useImperativeHandle:nn,useInsertionEffect:nn,useLayoutEffect:nn,useMemo:nn,useReducer:nn,useRef:nn,useState:nn,useDebugValue:nn,useDeferredValue:nn,useTransition:nn,useMutableSource:nn,useSyncExternalStore:nn,useId:nn,unstable_isNewReconciler:!1},Qae={readContext:Ga,useCallback:function(i,e){return Uo().memoizedState=[i,e===void 0?null:e],i},useContext:Ga,useEffect:nA,useImperativeHandle:function(i,e,t){return t=t!=null?t.concat([i]):null,fy(4194308,4,F7.bind(null,e,i),t)},useLayoutEffect:function(i,e){return fy(4194308,4,i,e)},useInsertionEffect:function(i,e){return fy(4,2,i,e)},useMemo:function(i,e){var t=Uo();return e=e===void 0?null:e,i=i(),t.memoizedState=[i,e],i},useReducer:function(i,e,t){var r=Uo();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:e},r.queue=i,i=i.dispatch=Jae.bind(null,nr,i),[r.memoizedState,i]},useRef:function(i){var e=Uo();return i={current:i},e.memoizedState=i},useState:rA,useDebugValue:fE,useDeferredValue:function(i){return Uo().memoizedState=i},useTransition:function(){var i=rA(!1),e=i[0];return i=Yae.bind(null,i[1]),Uo().memoizedState=i,[e,i]},useMutableSource:function(){},useSyncExternalStore:function(i,e,t){var r=nr,n=Uo();if(Gi){if(t===void 0)throw Error(et(407));t=t()}else{if(t=e(),Xr===null)throw Error(et(349));rh&30||T7(r,e,t)}n.memoizedState=t;var a={value:t,getSnapshot:e};return n.queue=a,nA(A7.bind(null,r,a,i),[i]),r.flags|=2048,Lm(9,P7.bind(null,r,a,t,e),void 0,null),t},useId:function(){var i=Uo(),e=Xr.identifierPrefix;if(Gi){var t=Is,r=As;t=(r&~(1<<32-bo(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Am++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Zae++,e=":"+e+"r"+t.toString(32)+":";return i.memoizedState=e},unstable_isNewReconciler:!1},eoe={readContext:Ga,useCallback:B7,useContext:Ga,useEffect:dE,useImperativeHandle:O7,useInsertionEffect:k7,useLayoutEffect:R7,useMemo:z7,useReducer:m2,useRef:D7,useState:function(){return m2(Im)},useDebugValue:fE,useDeferredValue:function(i){var e=Wa();return N7(e,Br.memoizedState,i)},useTransition:function(){var i=m2(Im)[0],e=Wa().memoizedState;return[i,e]},useMutableSource:C7,useSyncExternalStore:E7,useId:$7,unstable_isNewReconciler:!1},toe={readContext:Ga,useCallback:B7,useContext:Ga,useEffect:dE,useImperativeHandle:O7,useInsertionEffect:k7,useLayoutEffect:R7,useMemo:z7,useReducer:g2,useRef:D7,useState:function(){return g2(Im)},useDebugValue:fE,useDeferredValue:function(i){var e=Wa();return Br===null?e.memoizedState=i:N7(e,Br.memoizedState,i)},useTransition:function(){var i=g2(Im)[0],e=Wa().memoizedState;return[i,e]},useMutableSource:C7,useSyncExternalStore:E7,useId:$7,unstable_isNewReconciler:!1};function po(i,e){if(i&&i.defaultProps){e=ar({},e),i=i.defaultProps;for(var t in i)e[t]===void 0&&(e[t]=i[t]);return e}return e}function yw(i,e,t,r){e=i.memoizedState,t=t(r,e),t=t==null?e:ar({},e,t),i.memoizedState=t,i.lanes===0&&(i.updateQueue.baseState=t)}var bx={isMounted:function(i){return(i=i._reactInternals)?xh(i)===i:!1},enqueueSetState:function(i,e,t){i=i._reactInternals;var r=Pn(),n=Fl(i),a=ks(r,n);a.payload=e,t!=null&&(a.callback=t),e=kl(i,a,n),e!==null&&(wo(e,i,n,r),py(e,i,n))},enqueueReplaceState:function(i,e,t){i=i._reactInternals;var r=Pn(),n=Fl(i),a=ks(r,n);a.tag=1,a.payload=e,t!=null&&(a.callback=t),e=kl(i,a,n),e!==null&&(wo(e,i,n,r),py(e,i,n))},enqueueForceUpdate:function(i,e){i=i._reactInternals;var t=Pn(),r=Fl(i),n=ks(t,r);n.tag=2,e!=null&&(n.callback=e),e=kl(i,n,r),e!==null&&(wo(e,i,r,t),py(e,i,r))}};function aA(i,e,t,r,n,a,o){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(r,a,o):e.prototype&&e.prototype.isPureReactComponent?!Sm(t,r)||!Sm(n,a):!0}function H7(i,e,t){var r=!1,n=jl,a=e.contextType;return typeof a=="object"&&a!==null?a=Ga(a):(n=Zn(e)?th:fn.current,r=e.contextTypes,a=(r=r!=null)?zp(i,n):jl),e=new e(t,a),i.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bx,i.stateNode=e,e._reactInternals=i,r&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=n,i.__reactInternalMemoizedMaskedChildContext=a),e}function oA(i,e,t,r){i=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==i&&bx.enqueueReplaceState(e,e.state,null)}function vw(i,e,t,r){var n=i.stateNode;n.props=t,n.state=i.memoizedState,n.refs={},oE(i);var a=e.contextType;typeof a=="object"&&a!==null?n.context=Ga(a):(a=Zn(e)?th:fn.current,n.context=zp(i,a)),n.state=i.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(yw(i,e,a,t),n.state=i.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&bx.enqueueReplaceState(n,n.state,null),gv(i,t,n,r),n.state=i.memoizedState),typeof n.componentDidMount=="function"&&(i.flags|=4194308)}function Vp(i,e){try{var t="",r=e;do t+=Ane(r),r=r.return;while(r);var n=t}catch(a){n=`
Error generating stack: `+a.message+`
`+a.stack}return{value:i,source:e,stack:n,digest:null}}function y2(i,e,t){return{value:i,source:null,stack:t??null,digest:e??null}}function xw(i,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var ioe=typeof WeakMap=="function"?WeakMap:Map;function G7(i,e,t){t=ks(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){bv||(bv=!0,Aw=r),xw(i,e)},t}function W7(i,e,t){t=ks(-1,t),t.tag=3;var r=i.type.getDerivedStateFromError;if(typeof r=="function"){var n=e.value;t.payload=function(){return r(n)},t.callback=function(){xw(i,e)}}var a=i.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){xw(i,e),typeof r!="function"&&(Rl===null?Rl=new Set([this]):Rl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function sA(i,e,t){var r=i.pingCache;if(r===null){r=i.pingCache=new ioe;var n=new Set;r.set(e,n)}else n=r.get(e),n===void 0&&(n=new Set,r.set(e,n));n.has(t)||(n.add(t),i=goe.bind(null,i,e,t),e.then(i,i))}function lA(i){do{var e;if((e=i.tag===13)&&(e=i.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return i;i=i.return}while(i!==null);return null}function uA(i,e,t,r,n){return i.mode&1?(i.flags|=65536,i.lanes=n,i):(i===e?i.flags|=65536:(i.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=ks(-1,1),e.tag=2,kl(t,e,1))),t.lanes|=1),i)}var roe=Vs.ReactCurrentOwner,Wn=!1;function En(i,e,t,r){e.child=i===null?b7(e,null,t,r):$p(e,i.child,t,r)}function hA(i,e,t,r,n){t=t.render;var a=e.ref;return mp(e,n),r=cE(i,e,t,r,a,n),t=pE(),i!==null&&!Wn?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,zs(i,e,n)):(Gi&&t&&QC(e),e.flags|=1,En(i,e,r,n),e.child)}function cA(i,e,t,r,n){if(i===null){var a=t.type;return typeof a=="function"&&!wE(a)&&a.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=a,X7(i,e,a,r,n)):(i=vy(t.type,null,r,e,e.mode,n),i.ref=e.ref,i.return=e,e.child=i)}if(a=i.child,!(i.lanes&n)){var o=a.memoizedProps;if(t=t.compare,t=t!==null?t:Sm,t(o,r)&&i.ref===e.ref)return zs(i,e,n)}return e.flags|=1,i=Ol(a,r),i.ref=e.ref,i.return=e,e.child=i}function X7(i,e,t,r,n){if(i!==null){var a=i.memoizedProps;if(Sm(a,r)&&i.ref===e.ref)if(Wn=!1,e.pendingProps=r=a,(i.lanes&n)!==0)i.flags&131072&&(Wn=!0);else return e.lanes=i.lanes,zs(i,e,n)}return _w(i,e,t,r,n)}function q7(i,e,t){var r=e.pendingProps,n=r.children,a=i!==null?i.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ii(tp,ua),ua|=t;else{if(!(t&1073741824))return i=a!==null?a.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:i,cachePool:null,transitions:null},e.updateQueue=null,Ii(tp,ua),ua|=i,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:t,Ii(tp,ua),ua|=r}else a!==null?(r=a.baseLanes|t,e.memoizedState=null):r=t,Ii(tp,ua),ua|=r;return En(i,e,n,t),e.child}function Z7(i,e){var t=e.ref;(i===null&&t!==null||i!==null&&i.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function _w(i,e,t,r,n){var a=Zn(t)?th:fn.current;return a=zp(e,a),mp(e,n),t=cE(i,e,t,r,a,n),r=pE(),i!==null&&!Wn?(e.updateQueue=i.updateQueue,e.flags&=-2053,i.lanes&=~n,zs(i,e,n)):(Gi&&r&&QC(e),e.flags|=1,En(i,e,t,n),e.child)}function pA(i,e,t,r,n){if(Zn(t)){var a=!0;cv(e)}else a=!1;if(mp(e,n),e.stateNode===null)my(i,e),H7(e,t,r),vw(e,t,r,n),r=!0;else if(i===null){var o=e.stateNode,s=e.memoizedProps;o.props=s;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Ga(u):(u=Zn(t)?th:fn.current,u=zp(e,u));var c=t.getDerivedStateFromProps,p=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==r||l!==u)&&oA(e,o,r,u),vl=!1;var d=e.memoizedState;o.state=d,gv(e,r,o,n),l=e.memoizedState,s!==r||d!==l||qn.current||vl?(typeof c=="function"&&(yw(e,t,c,r),l=e.memoizedState),(s=vl||aA(e,t,s,r,d,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=s):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,S7(i,e),s=e.memoizedProps,u=e.type===e.elementType?s:po(e.type,s),o.props=u,p=e.pendingProps,d=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Ga(l):(l=Zn(t)?th:fn.current,l=zp(e,l));var m=t.getDerivedStateFromProps;(c=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==p||d!==l)&&oA(e,o,r,l),vl=!1,d=e.memoizedState,o.state=d,gv(e,r,o,n);var g=e.memoizedState;s!==p||d!==g||qn.current||vl?(typeof m=="function"&&(yw(e,t,m,r),g=e.memoizedState),(u=vl||aA(e,t,u,r,d,g,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===i.memoizedProps&&d===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===i.memoizedProps&&d===i.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||s===i.memoizedProps&&d===i.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===i.memoizedProps&&d===i.memoizedState||(e.flags|=1024),r=!1)}return bw(i,e,t,r,a,n)}function bw(i,e,t,r,n,a){Z7(i,e);var o=(e.flags&128)!==0;if(!r&&!o)return n&&JP(e,t,!1),zs(i,e,a);r=e.stateNode,roe.current=e;var s=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,i!==null&&o?(e.child=$p(e,i.child,null,a),e.child=$p(e,null,s,a)):En(i,e,s,a),e.memoizedState=r.state,n&&JP(e,t,!0),e.child}function Y7(i){var e=i.stateNode;e.pendingContext?YP(i,e.pendingContext,e.pendingContext!==e.context):e.context&&YP(i,e.context,!1),sE(i,e.containerInfo)}function dA(i,e,t,r,n){return Np(),tE(n),e.flags|=256,En(i,e,t,r),e.child}var ww={dehydrated:null,treeContext:null,retryLane:0};function Sw(i){return{baseLanes:i,cachePool:null,transitions:null}}function J7(i,e,t){var r=e.pendingProps,n=er.current,a=!1,o=(e.flags&128)!==0,s;if((s=o)||(s=i!==null&&i.memoizedState===null?!1:(n&2)!==0),s?(a=!0,e.flags&=-129):(i===null||i.memoizedState!==null)&&(n|=1),Ii(er,n&1),i===null)return mw(e),i=e.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(e.mode&1?i.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,i=r.fallback,a?(r=e.mode,a=e.child,o={mode:"hidden",children:o},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=Mx(o,r,0,null),i=ju(i,r,t,null),a.return=e,i.return=e,a.sibling=i,e.child=a,e.child.memoizedState=Sw(t),e.memoizedState=ww,i):mE(e,o));if(n=i.memoizedState,n!==null&&(s=n.dehydrated,s!==null))return noe(i,e,o,r,s,n,t);if(a){a=r.fallback,o=e.mode,n=i.child,s=n.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==n?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Ol(n,l),r.subtreeFlags=n.subtreeFlags&14680064),s!==null?a=Ol(s,a):(a=ju(a,o,t,null),a.flags|=2),a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,o=i.child.memoizedState,o=o===null?Sw(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=i.childLanes&~t,e.memoizedState=ww,r}return a=i.child,i=a.sibling,r=Ol(a,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,i!==null&&(t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)),e.child=r,e.memoizedState=null,r}function mE(i,e){return e=Mx({mode:"visible",children:e},i.mode,0,null),e.return=i,i.child=e}function Qg(i,e,t,r){return r!==null&&tE(r),$p(e,i.child,null,t),i=mE(e,e.pendingProps.children),i.flags|=2,e.memoizedState=null,i}function noe(i,e,t,r,n,a,o){if(t)return e.flags&256?(e.flags&=-257,r=y2(Error(et(422))),Qg(i,e,o,r)):e.memoizedState!==null?(e.child=i.child,e.flags|=128,null):(a=r.fallback,n=e.mode,r=Mx({mode:"visible",children:r.children},n,0,null),a=ju(a,n,o,null),a.flags|=2,r.return=e,a.return=e,r.sibling=a,e.child=r,e.mode&1&&$p(e,i.child,null,o),e.child.memoizedState=Sw(o),e.memoizedState=ww,a);if(!(e.mode&1))return Qg(i,e,o,null);if(n.data==="$!"){if(r=n.nextSibling&&n.nextSibling.dataset,r)var s=r.dgst;return r=s,a=Error(et(419)),r=y2(a,r,void 0),Qg(i,e,o,r)}if(s=(o&i.childLanes)!==0,Wn||s){if(r=Xr,r!==null){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(r.suspendedLanes|o)?0:n,n!==0&&n!==a.retryLane&&(a.retryLane=n,Bs(i,n),wo(r,i,n,-1))}return bE(),r=y2(Error(et(421))),Qg(i,e,o,r)}return n.data==="$?"?(e.flags|=128,e.child=i.child,e=yoe.bind(null,i),n._reactRetry=e,null):(i=a.treeContext,pa=Dl(n.nextSibling),ga=e,Gi=!0,go=null,i!==null&&(Ra[Fa++]=As,Ra[Fa++]=Is,Ra[Fa++]=ih,As=i.id,Is=i.overflow,ih=e),e=mE(e,r.children),e.flags|=4096,e)}function fA(i,e,t){i.lanes|=e;var r=i.alternate;r!==null&&(r.lanes|=e),gw(i.return,e,t)}function v2(i,e,t,r,n){var a=i.memoizedState;a===null?i.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:n}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=t,a.tailMode=n)}function K7(i,e,t){var r=e.pendingProps,n=r.revealOrder,a=r.tail;if(En(i,e,r.children,t),r=er.current,r&2)r=r&1|2,e.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=e.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&fA(i,t,e);else if(i.tag===19)fA(i,t,e);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break e;for(;i.sibling===null;){if(i.return===null||i.return===e)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}r&=1}if(Ii(er,r),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(t=e.child,n=null;t!==null;)i=t.alternate,i!==null&&yv(i)===null&&(n=t),t=t.sibling;t=n,t===null?(n=e.child,e.child=null):(n=t.sibling,t.sibling=null),v2(e,!1,n,t,a);break;case"backwards":for(t=null,n=e.child,e.child=null;n!==null;){if(i=n.alternate,i!==null&&yv(i)===null){e.child=n;break}i=n.sibling,n.sibling=t,t=n,n=i}v2(e,!0,t,null,a);break;case"together":v2(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function my(i,e){!(e.mode&1)&&i!==null&&(i.alternate=null,e.alternate=null,e.flags|=2)}function zs(i,e,t){if(i!==null&&(e.dependencies=i.dependencies),nh|=e.lanes,!(t&e.childLanes))return null;if(i!==null&&e.child!==i.child)throw Error(et(153));if(e.child!==null){for(i=e.child,t=Ol(i,i.pendingProps),e.child=t,t.return=e;i.sibling!==null;)i=i.sibling,t=t.sibling=Ol(i,i.pendingProps),t.return=e;t.sibling=null}return e.child}function aoe(i,e,t){switch(e.tag){case 3:Y7(e),Np();break;case 5:M7(e);break;case 1:Zn(e.type)&&cv(e);break;case 4:sE(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,n=e.memoizedProps.value;Ii(fv,r._currentValue),r._currentValue=n;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ii(er,er.current&1),e.flags|=128,null):t&e.child.childLanes?J7(i,e,t):(Ii(er,er.current&1),i=zs(i,e,t),i!==null?i.sibling:null);Ii(er,er.current&1);break;case 19:if(r=(t&e.childLanes)!==0,i.flags&128){if(r)return K7(i,e,t);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),Ii(er,er.current),r)break;return null;case 22:case 23:return e.lanes=0,q7(i,e,t)}return zs(i,e,t)}var Q7,Mw,e9,t9;Q7=function(i,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)i.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Mw=function(){};e9=function(i,e,t,r){var n=i.memoizedProps;if(n!==r){i=e.stateNode,Fu(Xo.current);var a=null;switch(t){case"input":n=Wb(i,n),r=Wb(i,r),a=[];break;case"select":n=ar({},n,{value:void 0}),r=ar({},r,{value:void 0}),a=[];break;case"textarea":n=Zb(i,n),r=Zb(i,r),a=[];break;default:typeof n.onClick!="function"&&typeof r.onClick=="function"&&(i.onclick=uv)}Jb(t,r);var o;t=null;for(u in n)if(!r.hasOwnProperty(u)&&n.hasOwnProperty(u)&&n[u]!=null)if(u==="style"){var s=n[u];for(o in s)s.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(gm.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var l=r[u];if(s=n!=null?n[u]:void 0,r.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(a||(a=[]),a.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(gm.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ri("scroll",i),a||s===l||(a=[])):(a=a||[]).push(u,l))}t&&(a=a||[]).push("style",t);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};t9=function(i,e,t,r){t!==r&&(e.flags|=4)};function Od(i,e){if(!Gi)switch(i.tailMode){case"hidden":e=i.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?i.tail=null:t.sibling=null;break;case"collapsed":t=i.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||i.tail===null?i.tail=null:i.tail.sibling=null:r.sibling=null}}function an(i){var e=i.alternate!==null&&i.alternate.child===i.child,t=0,r=0;if(e)for(var n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags&14680064,r|=n.flags&14680064,n.return=i,n=n.sibling;else for(n=i.child;n!==null;)t|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=i,n=n.sibling;return i.subtreeFlags|=r,i.childLanes=t,e}function ooe(i,e,t){var r=e.pendingProps;switch(eE(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return an(e),null;case 1:return Zn(e.type)&&hv(),an(e),null;case 3:return r=e.stateNode,Up(),zi(qn),zi(fn),uE(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(i===null||i.child===null)&&(Jg(e)?e.flags|=4:i===null||i.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,go!==null&&(Dw(go),go=null))),Mw(i,e),an(e),null;case 5:lE(e);var n=Fu(Pm.current);if(t=e.type,i!==null&&e.stateNode!=null)e9(i,e,t,r,n),i.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(et(166));return an(e),null}if(i=Fu(Xo.current),Jg(e)){r=e.stateNode,t=e.type;var a=e.memoizedProps;switch(r[Ho]=e,r[Em]=a,i=(e.mode&1)!==0,t){case"dialog":Ri("cancel",r),Ri("close",r);break;case"iframe":case"object":case"embed":Ri("load",r);break;case"video":case"audio":for(n=0;n<sf.length;n++)Ri(sf[n],r);break;case"source":Ri("error",r);break;case"img":case"image":case"link":Ri("error",r),Ri("load",r);break;case"details":Ri("toggle",r);break;case"input":SP(r,a),Ri("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ri("invalid",r);break;case"textarea":CP(r,a),Ri("invalid",r)}Jb(t,a),n=null;for(var o in a)if(a.hasOwnProperty(o)){var s=a[o];o==="children"?typeof s=="string"?r.textContent!==s&&(a.suppressHydrationWarning!==!0&&Yg(r.textContent,s,i),n=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&Yg(r.textContent,s,i),n=["children",""+s]):gm.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&Ri("scroll",r)}switch(t){case"input":Vg(r),MP(r,a,!0);break;case"textarea":Vg(r),EP(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=uv)}r=n,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=n.nodeType===9?n:n.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=AL(t)),i==="http://www.w3.org/1999/xhtml"?t==="script"?(i=o.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof r.is=="string"?i=o.createElement(t,{is:r.is}):(i=o.createElement(t),t==="select"&&(o=i,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):i=o.createElementNS(i,t),i[Ho]=e,i[Em]=r,Q7(i,e,!1,!1),e.stateNode=i;e:{switch(o=Kb(t,r),t){case"dialog":Ri("cancel",i),Ri("close",i),n=r;break;case"iframe":case"object":case"embed":Ri("load",i),n=r;break;case"video":case"audio":for(n=0;n<sf.length;n++)Ri(sf[n],i);n=r;break;case"source":Ri("error",i),n=r;break;case"img":case"image":case"link":Ri("error",i),Ri("load",i),n=r;break;case"details":Ri("toggle",i),n=r;break;case"input":SP(i,r),n=Wb(i,r),Ri("invalid",i);break;case"option":n=r;break;case"select":i._wrapperState={wasMultiple:!!r.multiple},n=ar({},r,{value:void 0}),Ri("invalid",i);break;case"textarea":CP(i,r),n=Zb(i,r),Ri("invalid",i);break;default:n=r}Jb(t,n),s=n;for(a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="style"?DL(i,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&IL(i,l)):a==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&ym(i,l):typeof l=="number"&&ym(i,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(gm.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Ri("scroll",i):l!=null&&NC(i,a,l,o))}switch(t){case"input":Vg(i),MP(i,r,!1);break;case"textarea":Vg(i),EP(i);break;case"option":r.value!=null&&i.setAttribute("value",""+Vl(r.value));break;case"select":i.multiple=!!r.multiple,a=r.value,a!=null?cp(i,!!r.multiple,a,!1):r.defaultValue!=null&&cp(i,!!r.multiple,r.defaultValue,!0);break;default:typeof n.onClick=="function"&&(i.onclick=uv)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return an(e),null;case 6:if(i&&e.stateNode!=null)t9(i,e,i.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(et(166));if(t=Fu(Pm.current),Fu(Xo.current),Jg(e)){if(r=e.stateNode,t=e.memoizedProps,r[Ho]=e,(a=r.nodeValue!==t)&&(i=ga,i!==null))switch(i.tag){case 3:Yg(r.nodeValue,t,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Yg(r.nodeValue,t,(i.mode&1)!==0)}a&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Ho]=e,e.stateNode=r}return an(e),null;case 13:if(zi(er),r=e.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Gi&&pa!==null&&e.mode&1&&!(e.flags&128))x7(),Np(),e.flags|=98560,a=!1;else if(a=Jg(e),r!==null&&r.dehydrated!==null){if(i===null){if(!a)throw Error(et(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(et(317));a[Ho]=e}else Np(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;an(e),a=!1}else go!==null&&(Dw(go),go=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(i!==null&&i.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(i===null||er.current&1?$r===0&&($r=3):bE())),e.updateQueue!==null&&(e.flags|=4),an(e),null);case 4:return Up(),Mw(i,e),i===null&&Mm(e.stateNode.containerInfo),an(e),null;case 10:return nE(e.type._context),an(e),null;case 17:return Zn(e.type)&&hv(),an(e),null;case 19:if(zi(er),a=e.memoizedState,a===null)return an(e),null;if(r=(e.flags&128)!==0,o=a.rendering,o===null)if(r)Od(a,!1);else{if($r!==0||i!==null&&i.flags&128)for(i=e.child;i!==null;){if(o=yv(i),o!==null){for(e.flags|=128,Od(a,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)a=t,i=r,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=i,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,i=o.dependencies,a.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),t=t.sibling;return Ii(er,er.current&1|2),e.child}i=i.sibling}a.tail!==null&&xr()>jp&&(e.flags|=128,r=!0,Od(a,!1),e.lanes=4194304)}else{if(!r)if(i=yv(o),i!==null){if(e.flags|=128,r=!0,t=i.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Od(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Gi)return an(e),null}else 2*xr()-a.renderingStartTime>jp&&t!==1073741824&&(e.flags|=128,r=!0,Od(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(t=a.last,t!==null?t.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=xr(),e.sibling=null,t=er.current,Ii(er,r?t&1|2:t&1),e):(an(e),null);case 22:case 23:return _E(),r=e.memoizedState!==null,i!==null&&i.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ua&1073741824&&(an(e),e.subtreeFlags&6&&(e.flags|=8192)):an(e),null;case 24:return null;case 25:return null}throw Error(et(156,e.tag))}function soe(i,e){switch(eE(e),e.tag){case 1:return Zn(e.type)&&hv(),i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 3:return Up(),zi(qn),zi(fn),uE(),i=e.flags,i&65536&&!(i&128)?(e.flags=i&-65537|128,e):null;case 5:return lE(e),null;case 13:if(zi(er),i=e.memoizedState,i!==null&&i.dehydrated!==null){if(e.alternate===null)throw Error(et(340));Np()}return i=e.flags,i&65536?(e.flags=i&-65537|128,e):null;case 19:return zi(er),null;case 4:return Up(),null;case 10:return nE(e.type._context),null;case 22:case 23:return _E(),null;case 24:return null;default:return null}}var e1=!1,cn=!1,loe=typeof WeakSet=="function"?WeakSet:Set,vt=null;function ep(i,e){var t=i.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){pr(i,e,r)}else t.current=null}function Cw(i,e,t){try{t()}catch(r){pr(i,e,r)}}var mA=!1;function uoe(i,e){if(lw=ov,i=o7(),KC(i)){if("selectionStart"in i)var t={start:i.selectionStart,end:i.selectionEnd};else e:{t=(t=i.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var n=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{t.nodeType,a.nodeType}catch{t=null;break e}var o=0,s=-1,l=-1,u=0,c=0,p=i,d=null;t:for(;;){for(var m;p!==t||n!==0&&p.nodeType!==3||(s=o+n),p!==a||r!==0&&p.nodeType!==3||(l=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(m=p.firstChild)!==null;)d=p,p=m;for(;;){if(p===i)break t;if(d===t&&++u===n&&(s=o),d===a&&++c===r&&(l=o),(m=p.nextSibling)!==null)break;p=d,d=p.parentNode}p=m}t=s===-1||l===-1?null:{start:s,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(uw={focusedElem:i,selectionRange:t},ov=!1,vt=e;vt!==null;)if(e=vt,i=e.child,(e.subtreeFlags&1028)!==0&&i!==null)i.return=e,vt=i;else for(;vt!==null;){e=vt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var _=g.memoizedProps,y=g.memoizedState,x=e.stateNode,w=x.getSnapshotBeforeUpdate(e.elementType===e.type?_:po(e.type,_),y);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(et(163))}}catch(C){pr(e,e.return,C)}if(i=e.sibling,i!==null){i.return=e.return,vt=i;break}vt=e.return}return g=mA,mA=!1,g}function lm(i,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&i)===i){var a=n.destroy;n.destroy=void 0,a!==void 0&&Cw(e,t,a)}n=n.next}while(n!==r)}}function wx(i,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&i)===i){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Ew(i){var e=i.ref;if(e!==null){var t=i.stateNode;switch(i.tag){case 5:i=t;break;default:i=t}typeof e=="function"?e(i):e.current=i}}function i9(i){var e=i.alternate;e!==null&&(i.alternate=null,i9(e)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(e=i.stateNode,e!==null&&(delete e[Ho],delete e[Em],delete e[pw],delete e[Gae],delete e[Wae])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function r9(i){return i.tag===5||i.tag===3||i.tag===4}function gA(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||r9(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Tw(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(i,e):t.insertBefore(i,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(i,t)):(e=t,e.appendChild(i)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=uv));else if(r!==4&&(i=i.child,i!==null))for(Tw(i,e,t),i=i.sibling;i!==null;)Tw(i,e,t),i=i.sibling}function Pw(i,e,t){var r=i.tag;if(r===5||r===6)i=i.stateNode,e?t.insertBefore(i,e):t.appendChild(i);else if(r!==4&&(i=i.child,i!==null))for(Pw(i,e,t),i=i.sibling;i!==null;)Pw(i,e,t),i=i.sibling}var Jr=null,mo=!1;function Xs(i,e,t){for(t=t.child;t!==null;)n9(i,e,t),t=t.sibling}function n9(i,e,t){if(Wo&&typeof Wo.onCommitFiberUnmount=="function")try{Wo.onCommitFiberUnmount(fx,t)}catch{}switch(t.tag){case 5:cn||ep(t,e);case 6:var r=Jr,n=mo;Jr=null,Xs(i,e,t),Jr=r,mo=n,Jr!==null&&(mo?(i=Jr,t=t.stateNode,i.nodeType===8?i.parentNode.removeChild(t):i.removeChild(t)):Jr.removeChild(t.stateNode));break;case 18:Jr!==null&&(mo?(i=Jr,t=t.stateNode,i.nodeType===8?c2(i.parentNode,t):i.nodeType===1&&c2(i,t),bm(i)):c2(Jr,t.stateNode));break;case 4:r=Jr,n=mo,Jr=t.stateNode.containerInfo,mo=!0,Xs(i,e,t),Jr=r,mo=n;break;case 0:case 11:case 14:case 15:if(!cn&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){n=r=r.next;do{var a=n,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Cw(t,e,o),n=n.next}while(n!==r)}Xs(i,e,t);break;case 1:if(!cn&&(ep(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(s){pr(t,e,s)}Xs(i,e,t);break;case 21:Xs(i,e,t);break;case 22:t.mode&1?(cn=(r=cn)||t.memoizedState!==null,Xs(i,e,t),cn=r):Xs(i,e,t);break;default:Xs(i,e,t)}}function yA(i){var e=i.updateQueue;if(e!==null){i.updateQueue=null;var t=i.stateNode;t===null&&(t=i.stateNode=new loe),e.forEach(function(r){var n=voe.bind(null,i,r);t.has(r)||(t.add(r),r.then(n,n))})}}function eo(i,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var n=t[r];try{var a=i,o=e,s=o;e:for(;s!==null;){switch(s.tag){case 5:Jr=s.stateNode,mo=!1;break e;case 3:Jr=s.stateNode.containerInfo,mo=!0;break e;case 4:Jr=s.stateNode.containerInfo,mo=!0;break e}s=s.return}if(Jr===null)throw Error(et(160));n9(a,o,n),Jr=null,mo=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(u){pr(n,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)a9(e,i),e=e.sibling}function a9(i,e){var t=i.alternate,r=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(eo(e,i),Do(i),r&4){try{lm(3,i,i.return),wx(3,i)}catch(_){pr(i,i.return,_)}try{lm(5,i,i.return)}catch(_){pr(i,i.return,_)}}break;case 1:eo(e,i),Do(i),r&512&&t!==null&&ep(t,t.return);break;case 5:if(eo(e,i),Do(i),r&512&&t!==null&&ep(t,t.return),i.flags&32){var n=i.stateNode;try{ym(n,"")}catch(_){pr(i,i.return,_)}}if(r&4&&(n=i.stateNode,n!=null)){var a=i.memoizedProps,o=t!==null?t.memoizedProps:a,s=i.type,l=i.updateQueue;if(i.updateQueue=null,l!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&TL(n,a),Kb(s,o);var u=Kb(s,a);for(o=0;o<l.length;o+=2){var c=l[o],p=l[o+1];c==="style"?DL(n,p):c==="dangerouslySetInnerHTML"?IL(n,p):c==="children"?ym(n,p):NC(n,c,p,u)}switch(s){case"input":Xb(n,a);break;case"textarea":PL(n,a);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?cp(n,!!a.multiple,m,!1):d!==!!a.multiple&&(a.defaultValue!=null?cp(n,!!a.multiple,a.defaultValue,!0):cp(n,!!a.multiple,a.multiple?[]:"",!1))}n[Em]=a}catch(_){pr(i,i.return,_)}}break;case 6:if(eo(e,i),Do(i),r&4){if(i.stateNode===null)throw Error(et(162));n=i.stateNode,a=i.memoizedProps;try{n.nodeValue=a}catch(_){pr(i,i.return,_)}}break;case 3:if(eo(e,i),Do(i),r&4&&t!==null&&t.memoizedState.isDehydrated)try{bm(e.containerInfo)}catch(_){pr(i,i.return,_)}break;case 4:eo(e,i),Do(i);break;case 13:eo(e,i),Do(i),n=i.child,n.flags&8192&&(a=n.memoizedState!==null,n.stateNode.isHidden=a,!a||n.alternate!==null&&n.alternate.memoizedState!==null||(vE=xr())),r&4&&yA(i);break;case 22:if(c=t!==null&&t.memoizedState!==null,i.mode&1?(cn=(u=cn)||c,eo(e,i),cn=u):eo(e,i),Do(i),r&8192){if(u=i.memoizedState!==null,(i.stateNode.isHidden=u)&&!c&&i.mode&1)for(vt=i,c=i.child;c!==null;){for(p=vt=c;vt!==null;){switch(d=vt,m=d.child,d.tag){case 0:case 11:case 14:case 15:lm(4,d,d.return);break;case 1:ep(d,d.return);var g=d.stateNode;if(typeof g.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(_){pr(r,t,_)}}break;case 5:ep(d,d.return);break;case 22:if(d.memoizedState!==null){xA(p);continue}}m!==null?(m.return=d,vt=m):xA(p)}c=c.sibling}e:for(c=null,p=i;;){if(p.tag===5){if(c===null){c=p;try{n=p.stateNode,u?(a=n.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=LL("display",o))}catch(_){pr(i,i.return,_)}}}else if(p.tag===6){if(c===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(_){pr(i,i.return,_)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===i)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===i)break e;for(;p.sibling===null;){if(p.return===null||p.return===i)break e;c===p&&(c=null),p=p.return}c===p&&(c=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:eo(e,i),Do(i),r&4&&yA(i);break;case 21:break;default:eo(e,i),Do(i)}}function Do(i){var e=i.flags;if(e&2){try{e:{for(var t=i.return;t!==null;){if(r9(t)){var r=t;break e}t=t.return}throw Error(et(160))}switch(r.tag){case 5:var n=r.stateNode;r.flags&32&&(ym(n,""),r.flags&=-33);var a=gA(i);Pw(i,a,n);break;case 3:case 4:var o=r.stateNode.containerInfo,s=gA(i);Tw(i,s,o);break;default:throw Error(et(161))}}catch(l){pr(i,i.return,l)}i.flags&=-3}e&4096&&(i.flags&=-4097)}function hoe(i,e,t){vt=i,o9(i)}function o9(i,e,t){for(var r=(i.mode&1)!==0;vt!==null;){var n=vt,a=n.child;if(n.tag===22&&r){var o=n.memoizedState!==null||e1;if(!o){var s=n.alternate,l=s!==null&&s.memoizedState!==null||cn;s=e1;var u=cn;if(e1=o,(cn=l)&&!u)for(vt=n;vt!==null;)o=vt,l=o.child,o.tag===22&&o.memoizedState!==null?_A(n):l!==null?(l.return=o,vt=l):_A(n);for(;a!==null;)vt=a,o9(a),a=a.sibling;vt=n,e1=s,cn=u}vA(i)}else n.subtreeFlags&8772&&a!==null?(a.return=n,vt=a):vA(i)}}function vA(i){for(;vt!==null;){var e=vt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:cn||wx(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!cn)if(t===null)r.componentDidMount();else{var n=e.elementType===e.type?t.memoizedProps:po(e.type,t.memoizedProps);r.componentDidUpdate(n,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&iA(e,a,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}iA(e,o,t)}break;case 5:var s=e.stateNode;if(t===null&&e.flags&4){t=s;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var p=c.dehydrated;p!==null&&bm(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(et(163))}cn||e.flags&512&&Ew(e)}catch(d){pr(e,e.return,d)}}if(e===i){vt=null;break}if(t=e.sibling,t!==null){t.return=e.return,vt=t;break}vt=e.return}}function xA(i){for(;vt!==null;){var e=vt;if(e===i){vt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,vt=t;break}vt=e.return}}function _A(i){for(;vt!==null;){var e=vt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{wx(4,e)}catch(l){pr(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var n=e.return;try{r.componentDidMount()}catch(l){pr(e,n,l)}}var a=e.return;try{Ew(e)}catch(l){pr(e,a,l)}break;case 5:var o=e.return;try{Ew(e)}catch(l){pr(e,o,l)}}}catch(l){pr(e,e.return,l)}if(e===i){vt=null;break}var s=e.sibling;if(s!==null){s.return=e.return,vt=s;break}vt=e.return}}var coe=Math.ceil,_v=Vs.ReactCurrentDispatcher,gE=Vs.ReactCurrentOwner,Ha=Vs.ReactCurrentBatchConfig,mi=0,Xr=null,Ir=null,en=0,ua=0,tp=Jl(0),$r=0,Dm=null,nh=0,Sx=0,yE=0,um=null,Vn=null,vE=0,jp=1/0,Ss=null,bv=!1,Aw=null,Rl=null,t1=!1,Sl=null,wv=0,hm=0,Iw=null,gy=-1,yy=0;function Pn(){return mi&6?xr():gy!==-1?gy:gy=xr()}function Fl(i){return i.mode&1?mi&2&&en!==0?en&-en:qae.transition!==null?(yy===0&&(yy=HL()),yy):(i=Si,i!==0||(i=window.event,i=i===void 0?16:JL(i.type)),i):1}function wo(i,e,t,r){if(50<hm)throw hm=0,Iw=null,Error(et(185));ig(i,t,r),(!(mi&2)||i!==Xr)&&(i===Xr&&(!(mi&2)&&(Sx|=t),$r===4&&_l(i,en)),Yn(i,r),t===1&&mi===0&&!(e.mode&1)&&(jp=xr()+500,xx&&Kl()))}function Yn(i,e){var t=i.callbackNode;qne(i,e);var r=av(i,i===Xr?en:0);if(r===0)t!==null&&AP(t),i.callbackNode=null,i.callbackPriority=0;else if(e=r&-r,i.callbackPriority!==e){if(t!=null&&AP(t),e===1)i.tag===0?Xae(bA.bind(null,i)):g7(bA.bind(null,i)),jae(function(){!(mi&6)&&Kl()}),t=null;else{switch(GL(r)){case 1:t=HC;break;case 4:t=VL;break;case 16:t=nv;break;case 536870912:t=jL;break;default:t=nv}t=f9(t,s9.bind(null,i))}i.callbackPriority=e,i.callbackNode=t}}function s9(i,e){if(gy=-1,yy=0,mi&6)throw Error(et(327));var t=i.callbackNode;if(gp()&&i.callbackNode!==t)return null;var r=av(i,i===Xr?en:0);if(r===0)return null;if(r&30||r&i.expiredLanes||e)e=Sv(i,r);else{e=r;var n=mi;mi|=2;var a=u9();(Xr!==i||en!==e)&&(Ss=null,jp=xr()+500,Vu(i,e));do try{foe();break}catch(s){l9(i,s)}while(!0);rE(),_v.current=a,mi=n,Ir!==null?e=0:(Xr=null,en=0,e=$r)}if(e!==0){if(e===2&&(n=rw(i),n!==0&&(r=n,e=Lw(i,n))),e===1)throw t=Dm,Vu(i,0),_l(i,r),Yn(i,xr()),t;if(e===6)_l(i,r);else{if(n=i.current.alternate,!(r&30)&&!poe(n)&&(e=Sv(i,r),e===2&&(a=rw(i),a!==0&&(r=a,e=Lw(i,a))),e===1))throw t=Dm,Vu(i,0),_l(i,r),Yn(i,xr()),t;switch(i.finishedWork=n,i.finishedLanes=r,e){case 0:case 1:throw Error(et(345));case 2:mu(i,Vn,Ss);break;case 3:if(_l(i,r),(r&130023424)===r&&(e=vE+500-xr(),10<e)){if(av(i,0)!==0)break;if(n=i.suspendedLanes,(n&r)!==r){Pn(),i.pingedLanes|=i.suspendedLanes&n;break}i.timeoutHandle=cw(mu.bind(null,i,Vn,Ss),e);break}mu(i,Vn,Ss);break;case 4:if(_l(i,r),(r&4194240)===r)break;for(e=i.eventTimes,n=-1;0<r;){var o=31-bo(r);a=1<<o,o=e[o],o>n&&(n=o),r&=~a}if(r=n,r=xr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*coe(r/1960))-r,10<r){i.timeoutHandle=cw(mu.bind(null,i,Vn,Ss),r);break}mu(i,Vn,Ss);break;case 5:mu(i,Vn,Ss);break;default:throw Error(et(329))}}}return Yn(i,xr()),i.callbackNode===t?s9.bind(null,i):null}function Lw(i,e){var t=um;return i.current.memoizedState.isDehydrated&&(Vu(i,e).flags|=256),i=Sv(i,e),i!==2&&(e=Vn,Vn=t,e!==null&&Dw(e)),i}function Dw(i){Vn===null?Vn=i:Vn.push.apply(Vn,i)}function poe(i){for(var e=i;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var n=t[r],a=n.getSnapshot;n=n.value;try{if(!Mo(a(),n))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===i)break;for(;e.sibling===null;){if(e.return===null||e.return===i)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _l(i,e){for(e&=~yE,e&=~Sx,i.suspendedLanes|=e,i.pingedLanes&=~e,i=i.expirationTimes;0<e;){var t=31-bo(e),r=1<<t;i[t]=-1,e&=~r}}function bA(i){if(mi&6)throw Error(et(327));gp();var e=av(i,0);if(!(e&1))return Yn(i,xr()),null;var t=Sv(i,e);if(i.tag!==0&&t===2){var r=rw(i);r!==0&&(e=r,t=Lw(i,r))}if(t===1)throw t=Dm,Vu(i,0),_l(i,e),Yn(i,xr()),t;if(t===6)throw Error(et(345));return i.finishedWork=i.current.alternate,i.finishedLanes=e,mu(i,Vn,Ss),Yn(i,xr()),null}function xE(i,e){var t=mi;mi|=1;try{return i(e)}finally{mi=t,mi===0&&(jp=xr()+500,xx&&Kl())}}function ah(i){Sl!==null&&Sl.tag===0&&!(mi&6)&&gp();var e=mi;mi|=1;var t=Ha.transition,r=Si;try{if(Ha.transition=null,Si=1,i)return i()}finally{Si=r,Ha.transition=t,mi=e,!(mi&6)&&Kl()}}function _E(){ua=tp.current,zi(tp)}function Vu(i,e){i.finishedWork=null,i.finishedLanes=0;var t=i.timeoutHandle;if(t!==-1&&(i.timeoutHandle=-1,Vae(t)),Ir!==null)for(t=Ir.return;t!==null;){var r=t;switch(eE(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hv();break;case 3:Up(),zi(qn),zi(fn),uE();break;case 5:lE(r);break;case 4:Up();break;case 13:zi(er);break;case 19:zi(er);break;case 10:nE(r.type._context);break;case 22:case 23:_E()}t=t.return}if(Xr=i,Ir=i=Ol(i.current,null),en=ua=e,$r=0,Dm=null,yE=Sx=nh=0,Vn=um=null,Ru!==null){for(e=0;e<Ru.length;e++)if(t=Ru[e],r=t.interleaved,r!==null){t.interleaved=null;var n=r.next,a=t.pending;if(a!==null){var o=a.next;a.next=n,r.next=o}t.pending=r}Ru=null}return i}function l9(i,e){do{var t=Ir;try{if(rE(),dy.current=xv,vv){for(var r=nr.memoizedState;r!==null;){var n=r.queue;n!==null&&(n.pending=null),r=r.next}vv=!1}if(rh=0,Wr=Br=nr=null,sm=!1,Am=0,gE.current=null,t===null||t.return===null){$r=1,Dm=e,Ir=null;break}e:{var a=i,o=t.return,s=t,l=e;if(e=en,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=s,p=c.tag;if(!(c.mode&1)&&(p===0||p===11||p===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=lA(o);if(m!==null){m.flags&=-257,uA(m,o,s,a,e),m.mode&1&&sA(a,u,e),e=m,l=u;var g=e.updateQueue;if(g===null){var _=new Set;_.add(l),e.updateQueue=_}else g.add(l);break e}else{if(!(e&1)){sA(a,u,e),bE();break e}l=Error(et(426))}}else if(Gi&&s.mode&1){var y=lA(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),uA(y,o,s,a,e),tE(Vp(l,s));break e}}a=l=Vp(l,s),$r!==4&&($r=2),um===null?um=[a]:um.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var x=G7(a,l,e);tA(a,x);break e;case 1:s=l;var w=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Rl===null||!Rl.has(b)))){a.flags|=65536,e&=-e,a.lanes|=e;var C=W7(a,s,e);tA(a,C);break e}}a=a.return}while(a!==null)}c9(t)}catch(E){e=E,Ir===t&&t!==null&&(Ir=t=t.return);continue}break}while(!0)}function u9(){var i=_v.current;return _v.current=xv,i===null?xv:i}function bE(){($r===0||$r===3||$r===2)&&($r=4),Xr===null||!(nh&268435455)&&!(Sx&268435455)||_l(Xr,en)}function Sv(i,e){var t=mi;mi|=2;var r=u9();(Xr!==i||en!==e)&&(Ss=null,Vu(i,e));do try{doe();break}catch(n){l9(i,n)}while(!0);if(rE(),mi=t,_v.current=r,Ir!==null)throw Error(et(261));return Xr=null,en=0,$r}function doe(){for(;Ir!==null;)h9(Ir)}function foe(){for(;Ir!==null&&!Nne();)h9(Ir)}function h9(i){var e=d9(i.alternate,i,ua);i.memoizedProps=i.pendingProps,e===null?c9(i):Ir=e,gE.current=null}function c9(i){var e=i;do{var t=e.alternate;if(i=e.return,e.flags&32768){if(t=soe(t,e),t!==null){t.flags&=32767,Ir=t;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{$r=6,Ir=null;return}}else if(t=ooe(t,e,ua),t!==null){Ir=t;return}if(e=e.sibling,e!==null){Ir=e;return}Ir=e=i}while(e!==null);$r===0&&($r=5)}function mu(i,e,t){var r=Si,n=Ha.transition;try{Ha.transition=null,Si=1,moe(i,e,t,r)}finally{Ha.transition=n,Si=r}return null}function moe(i,e,t,r){do gp();while(Sl!==null);if(mi&6)throw Error(et(327));t=i.finishedWork;var n=i.finishedLanes;if(t===null)return null;if(i.finishedWork=null,i.finishedLanes=0,t===i.current)throw Error(et(177));i.callbackNode=null,i.callbackPriority=0;var a=t.lanes|t.childLanes;if(Zne(i,a),i===Xr&&(Ir=Xr=null,en=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||t1||(t1=!0,f9(nv,function(){return gp(),null})),a=(t.flags&15990)!==0,t.subtreeFlags&15990||a){a=Ha.transition,Ha.transition=null;var o=Si;Si=1;var s=mi;mi|=4,gE.current=null,uoe(i,t),a9(t,i),Fae(uw),ov=!!lw,uw=lw=null,i.current=t,hoe(t),$ne(),mi=s,Si=o,Ha.transition=a}else i.current=t;if(t1&&(t1=!1,Sl=i,wv=n),a=i.pendingLanes,a===0&&(Rl=null),jne(t.stateNode),Yn(i,xr()),e!==null)for(r=i.onRecoverableError,t=0;t<e.length;t++)n=e[t],r(n.value,{componentStack:n.stack,digest:n.digest});if(bv)throw bv=!1,i=Aw,Aw=null,i;return wv&1&&i.tag!==0&&gp(),a=i.pendingLanes,a&1?i===Iw?hm++:(hm=0,Iw=i):hm=0,Kl(),null}function gp(){if(Sl!==null){var i=GL(wv),e=Ha.transition,t=Si;try{if(Ha.transition=null,Si=16>i?16:i,Sl===null)var r=!1;else{if(i=Sl,Sl=null,wv=0,mi&6)throw Error(et(331));var n=mi;for(mi|=4,vt=i.current;vt!==null;){var a=vt,o=a.child;if(vt.flags&16){var s=a.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(vt=u;vt!==null;){var c=vt;switch(c.tag){case 0:case 11:case 15:lm(8,c,a)}var p=c.child;if(p!==null)p.return=c,vt=p;else for(;vt!==null;){c=vt;var d=c.sibling,m=c.return;if(i9(c),c===u){vt=null;break}if(d!==null){d.return=m,vt=d;break}vt=m}}}var g=a.alternate;if(g!==null){var _=g.child;if(_!==null){g.child=null;do{var y=_.sibling;_.sibling=null,_=y}while(_!==null)}}vt=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,vt=o;else e:for(;vt!==null;){if(a=vt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:lm(9,a,a.return)}var x=a.sibling;if(x!==null){x.return=a.return,vt=x;break e}vt=a.return}}var w=i.current;for(vt=w;vt!==null;){o=vt;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,vt=b;else e:for(o=w;vt!==null;){if(s=vt,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:wx(9,s)}}catch(E){pr(s,s.return,E)}if(s===o){vt=null;break e}var C=s.sibling;if(C!==null){C.return=s.return,vt=C;break e}vt=s.return}}if(mi=n,Kl(),Wo&&typeof Wo.onPostCommitFiberRoot=="function")try{Wo.onPostCommitFiberRoot(fx,i)}catch{}r=!0}return r}finally{Si=t,Ha.transition=e}}return!1}function wA(i,e,t){e=Vp(t,e),e=G7(i,e,1),i=kl(i,e,1),e=Pn(),i!==null&&(ig(i,1,e),Yn(i,e))}function pr(i,e,t){if(i.tag===3)wA(i,i,t);else for(;e!==null;){if(e.tag===3){wA(e,i,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rl===null||!Rl.has(r))){i=Vp(t,i),i=W7(e,i,1),e=kl(e,i,1),i=Pn(),e!==null&&(ig(e,1,i),Yn(e,i));break}}e=e.return}}function goe(i,e,t){var r=i.pingCache;r!==null&&r.delete(e),e=Pn(),i.pingedLanes|=i.suspendedLanes&t,Xr===i&&(en&t)===t&&($r===4||$r===3&&(en&130023424)===en&&500>xr()-vE?Vu(i,0):yE|=t),Yn(i,e)}function p9(i,e){e===0&&(i.mode&1?(e=Gg,Gg<<=1,!(Gg&130023424)&&(Gg=4194304)):e=1);var t=Pn();i=Bs(i,e),i!==null&&(ig(i,e,t),Yn(i,t))}function yoe(i){var e=i.memoizedState,t=0;e!==null&&(t=e.retryLane),p9(i,t)}function voe(i,e){var t=0;switch(i.tag){case 13:var r=i.stateNode,n=i.memoizedState;n!==null&&(t=n.retryLane);break;case 19:r=i.stateNode;break;default:throw Error(et(314))}r!==null&&r.delete(e),p9(i,t)}var d9;d9=function(i,e,t){if(i!==null)if(i.memoizedProps!==e.pendingProps||qn.current)Wn=!0;else{if(!(i.lanes&t)&&!(e.flags&128))return Wn=!1,aoe(i,e,t);Wn=!!(i.flags&131072)}else Wn=!1,Gi&&e.flags&1048576&&y7(e,dv,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;my(i,e),i=e.pendingProps;var n=zp(e,fn.current);mp(e,t),n=cE(null,e,r,i,n,t);var a=pE();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zn(r)?(a=!0,cv(e)):a=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,oE(e),n.updater=bx,e.stateNode=n,n._reactInternals=e,vw(e,r,i,t),e=bw(null,e,r,!0,a,t)):(e.tag=0,Gi&&a&&QC(e),En(null,e,n,t),e=e.child),e;case 16:r=e.elementType;e:{switch(my(i,e),i=e.pendingProps,n=r._init,r=n(r._payload),e.type=r,n=e.tag=_oe(r),i=po(r,i),n){case 0:e=_w(null,e,r,i,t);break e;case 1:e=pA(null,e,r,i,t);break e;case 11:e=hA(null,e,r,i,t);break e;case 14:e=cA(null,e,r,po(r.type,i),t);break e}throw Error(et(306,r,""))}return e;case 0:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:po(r,n),_w(i,e,r,n,t);case 1:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:po(r,n),pA(i,e,r,n,t);case 3:e:{if(Y7(e),i===null)throw Error(et(387));r=e.pendingProps,a=e.memoizedState,n=a.element,S7(i,e),gv(e,r,null,t);var o=e.memoizedState;if(r=o.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){n=Vp(Error(et(423)),e),e=dA(i,e,r,t,n);break e}else if(r!==n){n=Vp(Error(et(424)),e),e=dA(i,e,r,t,n);break e}else for(pa=Dl(e.stateNode.containerInfo.firstChild),ga=e,Gi=!0,go=null,t=b7(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Np(),r===n){e=zs(i,e,t);break e}En(i,e,r,t)}e=e.child}return e;case 5:return M7(e),i===null&&mw(e),r=e.type,n=e.pendingProps,a=i!==null?i.memoizedProps:null,o=n.children,hw(r,n)?o=null:a!==null&&hw(r,a)&&(e.flags|=32),Z7(i,e),En(i,e,o,t),e.child;case 6:return i===null&&mw(e),null;case 13:return J7(i,e,t);case 4:return sE(e,e.stateNode.containerInfo),r=e.pendingProps,i===null?e.child=$p(e,null,r,t):En(i,e,r,t),e.child;case 11:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:po(r,n),hA(i,e,r,n,t);case 7:return En(i,e,e.pendingProps,t),e.child;case 8:return En(i,e,e.pendingProps.children,t),e.child;case 12:return En(i,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,n=e.pendingProps,a=e.memoizedProps,o=n.value,Ii(fv,r._currentValue),r._currentValue=o,a!==null)if(Mo(a.value,o)){if(a.children===n.children&&!qn.current){e=zs(i,e,t);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var s=a.dependencies;if(s!==null){o=a.child;for(var l=s.firstContext;l!==null;){if(l.context===r){if(a.tag===1){l=ks(-1,t&-t),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}a.lanes|=t,l=a.alternate,l!==null&&(l.lanes|=t),gw(a.return,t,e),s.lanes|=t;break}l=l.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(et(341));o.lanes|=t,s=o.alternate,s!==null&&(s.lanes|=t),gw(o,t,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}En(i,e,n.children,t),e=e.child}return e;case 9:return n=e.type,r=e.pendingProps.children,mp(e,t),n=Ga(n),r=r(n),e.flags|=1,En(i,e,r,t),e.child;case 14:return r=e.type,n=po(r,e.pendingProps),n=po(r.type,n),cA(i,e,r,n,t);case 15:return X7(i,e,e.type,e.pendingProps,t);case 17:return r=e.type,n=e.pendingProps,n=e.elementType===r?n:po(r,n),my(i,e),e.tag=1,Zn(r)?(i=!0,cv(e)):i=!1,mp(e,t),H7(e,r,n),vw(e,r,n,t),bw(null,e,r,!0,i,t);case 19:return K7(i,e,t);case 22:return q7(i,e,t)}throw Error(et(156,e.tag))};function f9(i,e){return UL(i,e)}function xoe(i,e,t,r){this.tag=i,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ua(i,e,t,r){return new xoe(i,e,t,r)}function wE(i){return i=i.prototype,!(!i||!i.isReactComponent)}function _oe(i){if(typeof i=="function")return wE(i)?1:0;if(i!=null){if(i=i.$$typeof,i===UC)return 11;if(i===VC)return 14}return 2}function Ol(i,e){var t=i.alternate;return t===null?(t=Ua(i.tag,e,i.key,i.mode),t.elementType=i.elementType,t.type=i.type,t.stateNode=i.stateNode,t.alternate=i,i.alternate=t):(t.pendingProps=e,t.type=i.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=i.flags&14680064,t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,e=i.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=i.sibling,t.index=i.index,t.ref=i.ref,t}function vy(i,e,t,r,n,a){var o=2;if(r=i,typeof i=="function")wE(i)&&(o=1);else if(typeof i=="string")o=5;else e:switch(i){case Gc:return ju(t.children,n,a,e);case $C:o=8,n|=8;break;case Vb:return i=Ua(12,t,e,n|2),i.elementType=Vb,i.lanes=a,i;case jb:return i=Ua(13,t,e,n),i.elementType=jb,i.lanes=a,i;case Hb:return i=Ua(19,t,e,n),i.elementType=Hb,i.lanes=a,i;case ML:return Mx(t,n,a,e);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case wL:o=10;break e;case SL:o=9;break e;case UC:o=11;break e;case VC:o=14;break e;case yl:o=16,r=null;break e}throw Error(et(130,i==null?i:typeof i,""))}return e=Ua(o,t,e,n),e.elementType=i,e.type=r,e.lanes=a,e}function ju(i,e,t,r){return i=Ua(7,i,r,e),i.lanes=t,i}function Mx(i,e,t,r){return i=Ua(22,i,r,e),i.elementType=ML,i.lanes=t,i.stateNode={isHidden:!1},i}function x2(i,e,t){return i=Ua(6,i,null,e),i.lanes=t,i}function _2(i,e,t){return e=Ua(4,i.children!==null?i.children:[],i.key,e),e.lanes=t,e.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},e}function boe(i,e,t,r,n){this.tag=e,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=e2(0),this.expirationTimes=e2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=e2(0),this.identifierPrefix=r,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function SE(i,e,t,r,n,a,o,s,l){return i=new boe(i,e,t,s,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Ua(3,null,null,e),i.current=a,a.stateNode=i,a.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},oE(a),i}function woe(i,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hc,key:r==null?null:""+r,children:i,containerInfo:e,implementation:t}}function m9(i){if(!i)return jl;i=i._reactInternals;e:{if(xh(i)!==i||i.tag!==1)throw Error(et(170));var e=i;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(et(171))}if(i.tag===1){var t=i.type;if(Zn(t))return m7(i,t,e)}return e}function g9(i,e,t,r,n,a,o,s,l){return i=SE(t,r,!0,i,n,a,o,s,l),i.context=m9(null),t=i.current,r=Pn(),n=Fl(t),a=ks(r,n),a.callback=e??null,kl(t,a,n),i.current.lanes=n,ig(i,n,r),Yn(i,r),i}function Cx(i,e,t,r){var n=e.current,a=Pn(),o=Fl(n);return t=m9(t),e.context===null?e.context=t:e.pendingContext=t,e=ks(a,o),e.payload={element:i},r=r===void 0?null:r,r!==null&&(e.callback=r),i=kl(n,e,o),i!==null&&(wo(i,n,o,a),py(i,n,o)),o}function Mv(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function SA(i,e){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var t=i.retryLane;i.retryLane=t!==0&&t<e?t:e}}function ME(i,e){SA(i,e),(i=i.alternate)&&SA(i,e)}function Soe(){return null}var y9=typeof reportError=="function"?reportError:function(i){console.error(i)};function CE(i){this._internalRoot=i}Ex.prototype.render=CE.prototype.render=function(i){var e=this._internalRoot;if(e===null)throw Error(et(409));Cx(i,e,null,null)};Ex.prototype.unmount=CE.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var e=i.containerInfo;ah(function(){Cx(null,i,null,null)}),e[Os]=null}};function Ex(i){this._internalRoot=i}Ex.prototype.unstable_scheduleHydration=function(i){if(i){var e=qL();i={blockedOn:null,target:i,priority:e};for(var t=0;t<xl.length&&e!==0&&e<xl[t].priority;t++);xl.splice(t,0,i),t===0&&YL(i)}};function EE(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Tx(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function MA(){}function Moe(i,e,t,r,n){if(n){if(typeof r=="function"){var a=r;r=function(){var u=Mv(o);a.call(u)}}var o=g9(e,r,i,0,null,!1,!1,"",MA);return i._reactRootContainer=o,i[Os]=o.current,Mm(i.nodeType===8?i.parentNode:i),ah(),o}for(;n=i.lastChild;)i.removeChild(n);if(typeof r=="function"){var s=r;r=function(){var u=Mv(l);s.call(u)}}var l=SE(i,0,!1,null,null,!1,!1,"",MA);return i._reactRootContainer=l,i[Os]=l.current,Mm(i.nodeType===8?i.parentNode:i),ah(function(){Cx(e,l,t,r)}),l}function Px(i,e,t,r,n){var a=t._reactRootContainer;if(a){var o=a;if(typeof n=="function"){var s=n;n=function(){var l=Mv(o);s.call(l)}}Cx(e,o,i,n)}else o=Moe(t,e,i,n,r);return Mv(o)}WL=function(i){switch(i.tag){case 3:var e=i.stateNode;if(e.current.memoizedState.isDehydrated){var t=of(e.pendingLanes);t!==0&&(GC(e,t|1),Yn(e,xr()),!(mi&6)&&(jp=xr()+500,Kl()))}break;case 13:ah(function(){var r=Bs(i,1);if(r!==null){var n=Pn();wo(r,i,1,n)}}),ME(i,1)}};WC=function(i){if(i.tag===13){var e=Bs(i,134217728);if(e!==null){var t=Pn();wo(e,i,134217728,t)}ME(i,134217728)}};XL=function(i){if(i.tag===13){var e=Fl(i),t=Bs(i,e);if(t!==null){var r=Pn();wo(t,i,e,r)}ME(i,e)}};qL=function(){return Si};ZL=function(i,e){var t=Si;try{return Si=i,e()}finally{Si=t}};ew=function(i,e,t){switch(e){case"input":if(Xb(i,t),e=t.name,t.type==="radio"&&e!=null){for(t=i;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==i&&r.form===i.form){var n=vx(r);if(!n)throw Error(et(90));EL(r),Xb(r,n)}}}break;case"textarea":PL(i,t);break;case"select":e=t.value,e!=null&&cp(i,!!t.multiple,e,!1)}};FL=xE;OL=ah;var Coe={usingClientEntryPoint:!1,Events:[ng,Zc,vx,kL,RL,xE]},Bd={findFiberByHostInstance:ku,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Eoe={bundleType:Bd.bundleType,version:Bd.version,rendererPackageName:Bd.rendererPackageName,rendererConfig:Bd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vs.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=NL(i),i===null?null:i.stateNode},findFiberByHostInstance:Bd.findFiberByHostInstance||Soe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var i1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!i1.isDisabled&&i1.supportsFiber)try{fx=i1.inject(Eoe),Wo=i1}catch{}}ba.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Coe;ba.createPortal=function(i,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!EE(e))throw Error(et(200));return woe(i,e,null,t)};ba.createRoot=function(i,e){if(!EE(i))throw Error(et(299));var t=!1,r="",n=y9;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=SE(i,1,!1,null,null,t,!1,r,n),i[Os]=e.current,Mm(i.nodeType===8?i.parentNode:i),new CE(e)};ba.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var e=i._reactInternals;if(e===void 0)throw typeof i.render=="function"?Error(et(188)):(i=Object.keys(i).join(","),Error(et(268,i)));return i=NL(e),i=i===null?null:i.stateNode,i};ba.flushSync=function(i){return ah(i)};ba.hydrate=function(i,e,t){if(!Tx(e))throw Error(et(200));return Px(null,i,e,!0,t)};ba.hydrateRoot=function(i,e,t){if(!EE(i))throw Error(et(405));var r=t!=null&&t.hydratedSources||null,n=!1,a="",o=y9;if(t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(a=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=g9(e,null,i,1,t??null,n,!1,a,o),i[Os]=e.current,Mm(i),r)for(i=0;i<r.length;i++)t=r[i],n=t._getVersion,n=n(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n);return new Ex(e)};ba.render=function(i,e,t){if(!Tx(e))throw Error(et(200));return Px(null,i,e,!1,t)};ba.unmountComponentAtNode=function(i){if(!Tx(i))throw Error(et(40));return i._reactRootContainer?(ah(function(){Px(null,null,i,!1,function(){i._reactRootContainer=null,i[Os]=null})}),!0):!1};ba.unstable_batchedUpdates=xE;ba.unstable_renderSubtreeIntoContainer=function(i,e,t,r){if(!Tx(t))throw Error(et(200));if(i==null||i._reactInternals===void 0)throw Error(et(38));return Px(i,e,t,!1,r)};ba.version="18.3.1-next-f1338f8080-20240426";function v9(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(v9)}catch(i){console.error(i)}}v9(),vL.exports=ba;var x9=vL.exports,_9,CA=x9;_9=CA.createRoot,CA.hydrateRoot;/**
 * @remix-run/router v1.19.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function km(){return km=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},km.apply(this,arguments)}var Ml;(function(i){i.Pop="POP",i.Push="PUSH",i.Replace="REPLACE"})(Ml||(Ml={}));const EA="popstate";function Toe(i){i===void 0&&(i={});function e(r,n){let{pathname:a,search:o,hash:s}=r.location;return kw("",{pathname:a,search:o,hash:s},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function t(r,n){return typeof n=="string"?n:w9(n)}return Aoe(e,t,null,i)}function Vr(i,e){if(i===!1||i===null||typeof i>"u")throw new Error(e)}function b9(i,e){if(!i){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Poe(){return Math.random().toString(36).substr(2,8)}function TA(i,e){return{usr:i.state,key:i.key,idx:e}}function kw(i,e,t,r){return t===void 0&&(t=null),km({pathname:typeof i=="string"?i:i.pathname,search:"",hash:""},typeof e=="string"?fd(e):e,{state:t,key:e&&e.key||r||Poe()})}function w9(i){let{pathname:e="/",search:t="",hash:r=""}=i;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function fd(i){let e={};if(i){let t=i.indexOf("#");t>=0&&(e.hash=i.substr(t),i=i.substr(0,t));let r=i.indexOf("?");r>=0&&(e.search=i.substr(r),i=i.substr(0,r)),i&&(e.pathname=i)}return e}function Aoe(i,e,t,r){r===void 0&&(r={});let{window:n=document.defaultView,v5Compat:a=!1}=r,o=n.history,s=Ml.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(km({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function p(){s=Ml.Pop;let y=c(),x=y==null?null:y-u;u=y,l&&l({action:s,location:_.location,delta:x})}function d(y,x){s=Ml.Push;let w=kw(_.location,y,x);u=c()+1;let b=TA(w,u),C=_.createHref(w);try{o.pushState(b,"",C)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;n.location.assign(C)}a&&l&&l({action:s,location:_.location,delta:1})}function m(y,x){s=Ml.Replace;let w=kw(_.location,y,x);u=c();let b=TA(w,u),C=_.createHref(w);o.replaceState(b,"",C),a&&l&&l({action:s,location:_.location,delta:0})}function g(y){let x=n.location.origin!=="null"?n.location.origin:n.location.href,w=typeof y=="string"?y:w9(y);return w=w.replace(/ $/,"%20"),Vr(x,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,x)}let _={get action(){return s},get location(){return i(n,o)},listen(y){if(l)throw new Error("A history only accepts one active listener");return n.addEventListener(EA,p),l=y,()=>{n.removeEventListener(EA,p),l=null}},createHref(y){return e(n,y)},createURL:g,encodeLocation(y){let x=g(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:d,replace:m,go(y){return o.go(y)}};return _}var PA;(function(i){i.data="data",i.deferred="deferred",i.redirect="redirect",i.error="error"})(PA||(PA={}));function Ioe(i,e,t){return t===void 0&&(t="/"),Loe(i,e,t,!1)}function Loe(i,e,t,r){let n=typeof e=="string"?fd(e):e,a=C9(n.pathname||"/",t);if(a==null)return null;let o=S9(i);Doe(o);let s=null;for(let l=0;s==null&&l<o.length;++l){let u=joe(a);s=Uoe(o[l],u,r)}return s}function S9(i,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let n=(a,o,s)=>{let l={relativePath:s===void 0?a.path||"":s,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};l.relativePath.startsWith("/")&&(Vr(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Hu([r,l.relativePath]),c=t.concat(l);a.children&&a.children.length>0&&(Vr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),S9(a.children,e,c,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:Noe(u,a.index),routesMeta:c})};return i.forEach((a,o)=>{var s;if(a.path===""||!((s=a.path)!=null&&s.includes("?")))n(a,o);else for(let l of M9(a.path))n(a,o,l)}),e}function M9(i){let e=i.split("/");if(e.length===0)return[];let[t,...r]=e,n=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return n?[a,""]:[a];let o=M9(r.join("/")),s=[];return s.push(...o.map(l=>l===""?a:[a,l].join("/"))),n&&s.push(...o),s.map(l=>i.startsWith("/")&&l===""?"/":l)}function Doe(i){i.sort((e,t)=>e.score!==t.score?t.score-e.score:$oe(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const koe=/^:[\w-]+$/,Roe=3,Foe=2,Ooe=1,Boe=10,zoe=-2,AA=i=>i==="*";function Noe(i,e){let t=i.split("/"),r=t.length;return t.some(AA)&&(r+=zoe),e&&(r+=Foe),t.filter(n=>!AA(n)).reduce((n,a)=>n+(koe.test(a)?Roe:a===""?Ooe:Boe),r)}function $oe(i,e){return i.length===e.length&&i.slice(0,-1).every((r,n)=>r===e[n])?i[i.length-1]-e[e.length-1]:0}function Uoe(i,e,t){let{routesMeta:r}=i,n={},a="/",o=[];for(let s=0;s<r.length;++s){let l=r[s],u=s===r.length-1,c=a==="/"?e:e.slice(a.length)||"/",p=IA({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),d=l.route;if(!p&&u&&t&&!r[r.length-1].route.index&&(p=IA({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!p)return null;Object.assign(n,p.params),o.push({params:n,pathname:Hu([a,p.pathname]),pathnameBase:Zoe(Hu([a,p.pathnameBase])),route:d}),p.pathnameBase!=="/"&&(a=Hu([a,p.pathnameBase]))}return o}function IA(i,e){typeof i=="string"&&(i={path:i,caseSensitive:!1,end:!0});let[t,r]=Voe(i.path,i.caseSensitive,i.end),n=e.match(t);if(!n)return null;let a=n[0],o=a.replace(/(.)\/+$/,"$1"),s=n.slice(1);return{params:r.reduce((u,c,p)=>{let{paramName:d,isOptional:m}=c;if(d==="*"){let _=s[p]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const g=s[p];return m&&!g?u[d]=void 0:u[d]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:i}}function Voe(i,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),b9(i==="*"||!i.endsWith("*")||i.endsWith("/*"),'Route path "'+i+'" will be treated as if it were '+('"'+i.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+i.replace(/\*$/,"/*")+'".'));let r=[],n="^"+i.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,s,l)=>(r.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return i.endsWith("*")?(r.push({paramName:"*"}),n+=i==="*"||i==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?n+="\\/*$":i!==""&&i!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),r]}function joe(i){try{return i.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return b9(!1,'The URL path "'+i+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),i}}function C9(i,e){if(e==="/")return i;if(!i.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=i.charAt(t);return r&&r!=="/"?null:i.slice(t)||"/"}function Hoe(i,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:n=""}=typeof i=="string"?fd(i):i;return{pathname:t?t.startsWith("/")?t:Goe(t,e):e,search:Yoe(r),hash:Joe(n)}}function Goe(i,e){let t=e.replace(/\/+$/,"").split("/");return i.split("/").forEach(n=>{n===".."?t.length>1&&t.pop():n!=="."&&t.push(n)}),t.length>1?t.join("/"):"/"}function b2(i,e,t,r){return"Cannot include a '"+i+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Woe(i){return i.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Xoe(i,e){let t=Woe(i);return e?t.map((r,n)=>n===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function qoe(i,e,t,r){r===void 0&&(r=!1);let n;typeof i=="string"?n=fd(i):(n=km({},i),Vr(!n.pathname||!n.pathname.includes("?"),b2("?","pathname","search",n)),Vr(!n.pathname||!n.pathname.includes("#"),b2("#","pathname","hash",n)),Vr(!n.search||!n.search.includes("#"),b2("#","search","hash",n)));let a=i===""||n.pathname==="",o=a?"/":n.pathname,s;if(o==null)s=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),p-=1;n.pathname=d.join("/")}s=p>=0?e[p]:"/"}let l=Hoe(n,s),u=o&&o!=="/"&&o.endsWith("/"),c=(a||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const Hu=i=>i.join("/").replace(/\/\/+/g,"/"),Zoe=i=>i.replace(/\/+$/,"").replace(/^\/*/,"/"),Yoe=i=>!i||i==="?"?"":i.startsWith("?")?i:"?"+i,Joe=i=>!i||i==="#"?"":i.startsWith("#")?i:"#"+i;function Koe(i){return i!=null&&typeof i.status=="number"&&typeof i.statusText=="string"&&typeof i.internal=="boolean"&&"data"in i}const E9=["post","put","patch","delete"];new Set(E9);const Qoe=["get",...E9];new Set(Qoe);/**
 * React Router v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rm(){return Rm=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])}return i},Rm.apply(this,arguments)}const TE=$e.createContext(null),ese=$e.createContext(null),Ax=$e.createContext(null),Ix=$e.createContext(null),md=$e.createContext({outlet:null,matches:[],isDataRoute:!1}),T9=$e.createContext(null);function Lx(){return $e.useContext(Ix)!=null}function P9(){return Lx()||Vr(!1),$e.useContext(Ix).location}function A9(i){$e.useContext(Ax).static||$e.useLayoutEffect(i)}function I9(){let{isDataRoute:i}=$e.useContext(md);return i?dse():tse()}function tse(){Lx()||Vr(!1);let i=$e.useContext(TE),{basename:e,future:t,navigator:r}=$e.useContext(Ax),{matches:n}=$e.useContext(md),{pathname:a}=P9(),o=JSON.stringify(Xoe(n,t.v7_relativeSplatPath)),s=$e.useRef(!1);return A9(()=>{s.current=!0}),$e.useCallback(function(u,c){if(c===void 0&&(c={}),!s.current)return;if(typeof u=="number"){r.go(u);return}let p=qoe(u,JSON.parse(o),a,c.relative==="path");i==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Hu([e,p.pathname])),(c.replace?r.replace:r.push)(p,c.state,c)},[e,r,o,a,i])}function ise(i,e){return rse(i,e)}function rse(i,e,t,r){Lx()||Vr(!1);let{navigator:n}=$e.useContext(Ax),{matches:a}=$e.useContext(md),o=a[a.length-1],s=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=P9(),c;if(e){var p;let y=typeof e=="string"?fd(e):e;l==="/"||(p=y.pathname)!=null&&p.startsWith(l)||Vr(!1),c=y}else c=u;let d=c.pathname||"/",m=d;if(l!=="/"){let y=l.replace(/^\//,"").split("/");m="/"+d.replace(/^\//,"").split("/").slice(y.length).join("/")}let g=Ioe(i,{pathname:m}),_=lse(g&&g.map(y=>Object.assign({},y,{params:Object.assign({},s,y.params),pathname:Hu([l,n.encodeLocation?n.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Hu([l,n.encodeLocation?n.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),a,t,r);return e&&_?$e.createElement(Ix.Provider,{value:{location:Rm({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Ml.Pop}},_):_}function nse(){let i=pse(),e=Koe(i)?i.status+" "+i.statusText:i instanceof Error?i.message:JSON.stringify(i),t=i instanceof Error?i.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return $e.createElement($e.Fragment,null,$e.createElement("h2",null,"Unexpected Application Error!"),$e.createElement("h3",{style:{fontStyle:"italic"}},e),t?$e.createElement("pre",{style:n},t):null,null)}const ase=$e.createElement(nse,null);class ose extends $e.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?$e.createElement(md.Provider,{value:this.props.routeContext},$e.createElement(T9.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function sse(i){let{routeContext:e,match:t,children:r}=i,n=$e.useContext(TE);return n&&n.static&&n.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=t.route.id),$e.createElement(md.Provider,{value:e},r)}function lse(i,e,t,r){var n;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),i==null){var a;if(!t)return null;if(t.errors)i=t.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)i=t.matches;else return null}let o=i,s=(n=t)==null?void 0:n.errors;if(s!=null){let c=o.findIndex(p=>p.route.id&&(s==null?void 0:s[p.route.id])!==void 0);c>=0||Vr(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(t&&r&&r.v7_partialHydration)for(let c=0;c<o.length;c++){let p=o[c];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=c),p.route.id){let{loaderData:d,errors:m}=t,g=p.route.loader&&d[p.route.id]===void 0&&(!m||m[p.route.id]===void 0);if(p.route.lazy||g){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,p,d)=>{let m,g=!1,_=null,y=null;t&&(m=s&&p.route.id?s[p.route.id]:void 0,_=p.route.errorElement||ase,l&&(u<0&&d===0?(g=!0,y=null):u===d&&(g=!0,y=p.route.hydrateFallbackElement||null)));let x=e.concat(o.slice(0,d+1)),w=()=>{let b;return m?b=_:g?b=y:p.route.Component?b=$e.createElement(p.route.Component,null):p.route.element?b=p.route.element:b=c,$e.createElement(sse,{match:p,routeContext:{outlet:c,matches:x,isDataRoute:t!=null},children:b})};return t&&(p.route.ErrorBoundary||p.route.errorElement||d===0)?$e.createElement(ose,{location:t.location,revalidation:t.revalidation,component:_,error:m,children:w(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):w()},null)}var L9=function(i){return i.UseBlocker="useBlocker",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i}(L9||{}),Cv=function(i){return i.UseBlocker="useBlocker",i.UseLoaderData="useLoaderData",i.UseActionData="useActionData",i.UseRouteError="useRouteError",i.UseNavigation="useNavigation",i.UseRouteLoaderData="useRouteLoaderData",i.UseMatches="useMatches",i.UseRevalidator="useRevalidator",i.UseNavigateStable="useNavigate",i.UseRouteId="useRouteId",i}(Cv||{});function use(i){let e=$e.useContext(TE);return e||Vr(!1),e}function hse(i){let e=$e.useContext(ese);return e||Vr(!1),e}function cse(i){let e=$e.useContext(md);return e||Vr(!1),e}function D9(i){let e=cse(),t=e.matches[e.matches.length-1];return t.route.id||Vr(!1),t.route.id}function pse(){var i;let e=$e.useContext(T9),t=hse(Cv.UseRouteError),r=D9(Cv.UseRouteError);return e!==void 0?e:(i=t.errors)==null?void 0:i[r]}function dse(){let{router:i}=use(L9.UseNavigateStable),e=D9(Cv.UseNavigateStable),t=$e.useRef(!1);return A9(()=>{t.current=!0}),$e.useCallback(function(n,a){a===void 0&&(a={}),t.current&&(typeof n=="number"?i.navigate(n):i.navigate(n,Rm({fromRouteId:e},a)))},[i,e])}function nc(i){Vr(!1)}function fse(i){let{basename:e="/",children:t=null,location:r,navigationType:n=Ml.Pop,navigator:a,static:o=!1,future:s}=i;Lx()&&Vr(!1);let l=e.replace(/^\/*/,"/"),u=$e.useMemo(()=>({basename:l,navigator:a,static:o,future:Rm({v7_relativeSplatPath:!1},s)}),[l,s,a,o]);typeof r=="string"&&(r=fd(r));let{pathname:c="/",search:p="",hash:d="",state:m=null,key:g="default"}=r,_=$e.useMemo(()=>{let y=C9(c,l);return y==null?null:{location:{pathname:y,search:p,hash:d,state:m,key:g},navigationType:n}},[l,c,p,d,m,g,n]);return _==null?null:$e.createElement(Ax.Provider,{value:u},$e.createElement(Ix.Provider,{children:t,value:_}))}function mse(i){let{children:e,location:t}=i;return ise(Rw(e),t)}new Promise(()=>{});function Rw(i,e){e===void 0&&(e=[]);let t=[];return $e.Children.forEach(i,(r,n)=>{if(!$e.isValidElement(r))return;let a=[...e,n];if(r.type===$e.Fragment){t.push.apply(t,Rw(r.props.children,a));return}r.type!==nc&&Vr(!1),!r.props.index||!r.props.children||Vr(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Rw(r.props.children,a)),t.push(o)}),t}/**
 * React Router DOM v6.26.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const gse="6";try{window.__reactRouterVersion=gse}catch{}const yse="startTransition",LA=gne[yse];function vse(i){let{basename:e,children:t,future:r,window:n}=i,a=$e.useRef();a.current==null&&(a.current=Toe({window:n,v5Compat:!0}));let o=a.current,[s,l]=$e.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},c=$e.useCallback(p=>{u&&LA?LA(()=>l(p)):l(p)},[l,u]);return $e.useLayoutEffect(()=>o.listen(c),[o,c]),$e.createElement(fse,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:o,future:r})}var DA;(function(i){i.UseScrollRestoration="useScrollRestoration",i.UseSubmit="useSubmit",i.UseSubmitFetcher="useSubmitFetcher",i.UseFetcher="useFetcher",i.useViewTransitionState="useViewTransitionState"})(DA||(DA={}));var kA;(function(i){i.UseFetcher="useFetcher",i.UseFetchers="useFetchers",i.UseScrollRestoration="useScrollRestoration"})(kA||(kA={}));function k9(i,e){return function(){return i.apply(e,arguments)}}const{toString:xse}=Object.prototype,{getPrototypeOf:PE}=Object,Dx=(i=>e=>{const t=xse.call(e);return i[t]||(i[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),To=i=>(i=i.toLowerCase(),e=>Dx(e)===i),kx=i=>e=>typeof e===i,{isArray:gd}=Array,Fm=kx("undefined");function _se(i){return i!==null&&!Fm(i)&&i.constructor!==null&&!Fm(i.constructor)&&ya(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}const R9=To("ArrayBuffer");function bse(i){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(i):e=i&&i.buffer&&R9(i.buffer),e}const wse=kx("string"),ya=kx("function"),F9=kx("number"),Rx=i=>i!==null&&typeof i=="object",Sse=i=>i===!0||i===!1,xy=i=>{if(Dx(i)!=="object")return!1;const e=PE(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},Mse=To("Date"),Cse=To("File"),Ese=To("Blob"),Tse=To("FileList"),Pse=i=>Rx(i)&&ya(i.pipe),Ase=i=>{let e;return i&&(typeof FormData=="function"&&i instanceof FormData||ya(i.append)&&((e=Dx(i))==="formdata"||e==="object"&&ya(i.toString)&&i.toString()==="[object FormData]"))},Ise=To("URLSearchParams"),[Lse,Dse,kse,Rse]=["ReadableStream","Request","Response","Headers"].map(To),Fse=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function og(i,e,{allOwnKeys:t=!1}={}){if(i===null||typeof i>"u")return;let r,n;if(typeof i!="object"&&(i=[i]),gd(i))for(r=0,n=i.length;r<n;r++)e.call(null,i[r],r,i);else{const a=t?Object.getOwnPropertyNames(i):Object.keys(i),o=a.length;let s;for(r=0;r<o;r++)s=a[r],e.call(null,i[s],s,i)}}function O9(i,e){e=e.toLowerCase();const t=Object.keys(i);let r=t.length,n;for(;r-- >0;)if(n=t[r],e===n.toLowerCase())return n;return null}const Ou=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,B9=i=>!Fm(i)&&i!==Ou;function Fw(){const{caseless:i}=B9(this)&&this||{},e={},t=(r,n)=>{const a=i&&O9(e,n)||n;xy(e[a])&&xy(r)?e[a]=Fw(e[a],r):xy(r)?e[a]=Fw({},r):gd(r)?e[a]=r.slice():e[a]=r};for(let r=0,n=arguments.length;r<n;r++)arguments[r]&&og(arguments[r],t);return e}const Ose=(i,e,t,{allOwnKeys:r}={})=>(og(e,(n,a)=>{t&&ya(n)?i[a]=k9(n,t):i[a]=n},{allOwnKeys:r}),i),Bse=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),zse=(i,e,t,r)=>{i.prototype=Object.create(e.prototype,r),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:e.prototype}),t&&Object.assign(i.prototype,t)},Nse=(i,e,t,r)=>{let n,a,o;const s={};if(e=e||{},i==null)return e;do{for(n=Object.getOwnPropertyNames(i),a=n.length;a-- >0;)o=n[a],(!r||r(o,i,e))&&!s[o]&&(e[o]=i[o],s[o]=!0);i=t!==!1&&PE(i)}while(i&&(!t||t(i,e))&&i!==Object.prototype);return e},$se=(i,e,t)=>{i=String(i),(t===void 0||t>i.length)&&(t=i.length),t-=e.length;const r=i.indexOf(e,t);return r!==-1&&r===t},Use=i=>{if(!i)return null;if(gd(i))return i;let e=i.length;if(!F9(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=i[e];return t},Vse=(i=>e=>i&&e instanceof i)(typeof Uint8Array<"u"&&PE(Uint8Array)),jse=(i,e)=>{const r=(i&&i[Symbol.iterator]).call(i);let n;for(;(n=r.next())&&!n.done;){const a=n.value;e.call(i,a[0],a[1])}},Hse=(i,e)=>{let t;const r=[];for(;(t=i.exec(e))!==null;)r.push(t);return r},Gse=To("HTMLFormElement"),Wse=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,n){return r.toUpperCase()+n}),RA=(({hasOwnProperty:i})=>(e,t)=>i.call(e,t))(Object.prototype),Xse=To("RegExp"),z9=(i,e)=>{const t=Object.getOwnPropertyDescriptors(i),r={};og(t,(n,a)=>{let o;(o=e(n,a,i))!==!1&&(r[a]=o||n)}),Object.defineProperties(i,r)},qse=i=>{z9(i,(e,t)=>{if(ya(i)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=i[t];if(ya(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Zse=(i,e)=>{const t={},r=n=>{n.forEach(a=>{t[a]=!0})};return gd(i)?r(i):r(String(i).split(e)),t},Yse=()=>{},Jse=(i,e)=>i!=null&&Number.isFinite(i=+i)?i:e,w2="abcdefghijklmnopqrstuvwxyz",FA="0123456789",N9={DIGIT:FA,ALPHA:w2,ALPHA_DIGIT:w2+w2.toUpperCase()+FA},Kse=(i=16,e=N9.ALPHA_DIGIT)=>{let t="";const{length:r}=e;for(;i--;)t+=e[Math.random()*r|0];return t};function Qse(i){return!!(i&&ya(i.append)&&i[Symbol.toStringTag]==="FormData"&&i[Symbol.iterator])}const ele=i=>{const e=new Array(10),t=(r,n)=>{if(Rx(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[n]=r;const a=gd(r)?[]:{};return og(r,(o,s)=>{const l=t(o,n+1);!Fm(l)&&(a[s]=l)}),e[n]=void 0,a}}return r};return t(i,0)},tle=To("AsyncFunction"),ile=i=>i&&(Rx(i)||ya(i))&&ya(i.then)&&ya(i.catch),$9=((i,e)=>i?setImmediate:e?((t,r)=>(Ou.addEventListener("message",({source:n,data:a})=>{n===Ou&&a===t&&r.length&&r.shift()()},!1),n=>{r.push(n),Ou.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ya(Ou.postMessage)),rle=typeof queueMicrotask<"u"?queueMicrotask.bind(Ou):typeof process<"u"&&process.nextTick||$9,De={isArray:gd,isArrayBuffer:R9,isBuffer:_se,isFormData:Ase,isArrayBufferView:bse,isString:wse,isNumber:F9,isBoolean:Sse,isObject:Rx,isPlainObject:xy,isReadableStream:Lse,isRequest:Dse,isResponse:kse,isHeaders:Rse,isUndefined:Fm,isDate:Mse,isFile:Cse,isBlob:Ese,isRegExp:Xse,isFunction:ya,isStream:Pse,isURLSearchParams:Ise,isTypedArray:Vse,isFileList:Tse,forEach:og,merge:Fw,extend:Ose,trim:Fse,stripBOM:Bse,inherits:zse,toFlatObject:Nse,kindOf:Dx,kindOfTest:To,endsWith:$se,toArray:Use,forEachEntry:jse,matchAll:Hse,isHTMLForm:Gse,hasOwnProperty:RA,hasOwnProp:RA,reduceDescriptors:z9,freezeMethods:qse,toObjectSet:Zse,toCamelCase:Wse,noop:Yse,toFiniteNumber:Jse,findKey:O9,global:Ou,isContextDefined:B9,ALPHABET:N9,generateString:Kse,isSpecCompliantForm:Qse,toJSONObject:ele,isAsyncFn:tle,isThenable:ile,setImmediate:$9,asap:rle};function Jt(i,e,t,r,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),n&&(this.response=n,this.status=n.status?n.status:null)}De.inherits(Jt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:De.toJSONObject(this.config),code:this.code,status:this.status}}});const U9=Jt.prototype,V9={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{V9[i]={value:i}});Object.defineProperties(Jt,V9);Object.defineProperty(U9,"isAxiosError",{value:!0});Jt.from=(i,e,t,r,n,a)=>{const o=Object.create(U9);return De.toFlatObject(i,o,function(l){return l!==Error.prototype},s=>s!=="isAxiosError"),Jt.call(o,i.message,e,t,r,n),o.cause=i,o.name=i.name,a&&Object.assign(o,a),o};const nle=null;function Ow(i){return De.isPlainObject(i)||De.isArray(i)}function j9(i){return De.endsWith(i,"[]")?i.slice(0,-2):i}function OA(i,e,t){return i?i.concat(e).map(function(n,a){return n=j9(n),!t&&a?"["+n+"]":n}).join(t?".":""):e}function ale(i){return De.isArray(i)&&!i.some(Ow)}const ole=De.toFlatObject(De,{},null,function(e){return/^is[A-Z]/.test(e)});function Fx(i,e,t){if(!De.isObject(i))throw new TypeError("target must be an object");e=e||new FormData,t=De.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,y){return!De.isUndefined(y[_])});const r=t.metaTokens,n=t.visitor||c,a=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&De.isSpecCompliantForm(e);if(!De.isFunction(n))throw new TypeError("visitor must be a function");function u(g){if(g===null)return"";if(De.isDate(g))return g.toISOString();if(!l&&De.isBlob(g))throw new Jt("Blob is not supported. Use a Buffer instead.");return De.isArrayBuffer(g)||De.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,_,y){let x=g;if(g&&!y&&typeof g=="object"){if(De.endsWith(_,"{}"))_=r?_:_.slice(0,-2),g=JSON.stringify(g);else if(De.isArray(g)&&ale(g)||(De.isFileList(g)||De.endsWith(_,"[]"))&&(x=De.toArray(g)))return _=j9(_),x.forEach(function(b,C){!(De.isUndefined(b)||b===null)&&e.append(o===!0?OA([_],C,a):o===null?_:_+"[]",u(b))}),!1}return Ow(g)?!0:(e.append(OA(y,_,a),u(g)),!1)}const p=[],d=Object.assign(ole,{defaultVisitor:c,convertValue:u,isVisitable:Ow});function m(g,_){if(!De.isUndefined(g)){if(p.indexOf(g)!==-1)throw Error("Circular reference detected in "+_.join("."));p.push(g),De.forEach(g,function(x,w){(!(De.isUndefined(x)||x===null)&&n.call(e,x,De.isString(w)?w.trim():w,_,d))===!0&&m(x,_?_.concat(w):[w])}),p.pop()}}if(!De.isObject(i))throw new TypeError("data must be an object");return m(i),e}function BA(i){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function AE(i,e){this._pairs=[],i&&Fx(i,this,e)}const H9=AE.prototype;H9.append=function(e,t){this._pairs.push([e,t])};H9.toString=function(e){const t=e?function(r){return e.call(this,r,BA)}:BA;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function sle(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function G9(i,e,t){if(!e)return i;const r=t&&t.encode||sle,n=t&&t.serialize;let a;if(n?a=n(e,t):a=De.isURLSearchParams(e)?e.toString():new AE(e,t).toString(r),a){const o=i.indexOf("#");o!==-1&&(i=i.slice(0,o)),i+=(i.indexOf("?")===-1?"?":"&")+a}return i}class zA{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){De.forEach(this.handlers,function(r){r!==null&&e(r)})}}const W9={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},lle=typeof URLSearchParams<"u"?URLSearchParams:AE,ule=typeof FormData<"u"?FormData:null,hle=typeof Blob<"u"?Blob:null,cle={isBrowser:!0,classes:{URLSearchParams:lle,FormData:ule,Blob:hle},protocols:["http","https","file","blob","url","data"]},IE=typeof window<"u"&&typeof document<"u",Bw=typeof navigator=="object"&&navigator||void 0,ple=IE&&(!Bw||["ReactNative","NativeScript","NS"].indexOf(Bw.product)<0),dle=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",fle=IE&&window.location.href||"http://localhost",mle=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:IE,hasStandardBrowserEnv:ple,hasStandardBrowserWebWorkerEnv:dle,navigator:Bw,origin:fle},Symbol.toStringTag,{value:"Module"})),Jn={...mle,...cle};function gle(i,e){return Fx(i,new Jn.classes.URLSearchParams,Object.assign({visitor:function(t,r,n,a){return Jn.isNode&&De.isBuffer(t)?(this.append(r,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function yle(i){return De.matchAll(/\w+|\[(\w*)]/g,i).map(e=>e[0]==="[]"?"":e[1]||e[0])}function vle(i){const e={},t=Object.keys(i);let r;const n=t.length;let a;for(r=0;r<n;r++)a=t[r],e[a]=i[a];return e}function X9(i){function e(t,r,n,a){let o=t[a++];if(o==="__proto__")return!0;const s=Number.isFinite(+o),l=a>=t.length;return o=!o&&De.isArray(n)?n.length:o,l?(De.hasOwnProp(n,o)?n[o]=[n[o],r]:n[o]=r,!s):((!n[o]||!De.isObject(n[o]))&&(n[o]=[]),e(t,r,n[o],a)&&De.isArray(n[o])&&(n[o]=vle(n[o])),!s)}if(De.isFormData(i)&&De.isFunction(i.entries)){const t={};return De.forEachEntry(i,(r,n)=>{e(yle(r),n,t,0)}),t}return null}function xle(i,e,t){if(De.isString(i))try{return(e||JSON.parse)(i),De.trim(i)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(i)}const sg={transitional:W9,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",n=r.indexOf("application/json")>-1,a=De.isObject(e);if(a&&De.isHTMLForm(e)&&(e=new FormData(e)),De.isFormData(e))return n?JSON.stringify(X9(e)):e;if(De.isArrayBuffer(e)||De.isBuffer(e)||De.isStream(e)||De.isFile(e)||De.isBlob(e)||De.isReadableStream(e))return e;if(De.isArrayBufferView(e))return e.buffer;if(De.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return gle(e,this.formSerializer).toString();if((s=De.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Fx(s?{"files[]":e}:e,l&&new l,this.formSerializer)}}return a||n?(t.setContentType("application/json",!1),xle(e)):e}],transformResponse:[function(e){const t=this.transitional||sg.transitional,r=t&&t.forcedJSONParsing,n=this.responseType==="json";if(De.isResponse(e)||De.isReadableStream(e))return e;if(e&&De.isString(e)&&(r&&!this.responseType||n)){const o=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(s){if(o)throw s.name==="SyntaxError"?Jt.from(s,Jt.ERR_BAD_RESPONSE,this,null,this.response):s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Jn.classes.FormData,Blob:Jn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};De.forEach(["delete","get","head","post","put","patch"],i=>{sg.headers[i]={}});const _le=De.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ble=i=>{const e={};let t,r,n;return i&&i.split(`
`).forEach(function(o){n=o.indexOf(":"),t=o.substring(0,n).trim().toLowerCase(),r=o.substring(n+1).trim(),!(!t||e[t]&&_le[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},NA=Symbol("internals");function zd(i){return i&&String(i).trim().toLowerCase()}function _y(i){return i===!1||i==null?i:De.isArray(i)?i.map(_y):String(i)}function wle(i){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(i);)e[r[1]]=r[2];return e}const Sle=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function S2(i,e,t,r,n){if(De.isFunction(r))return r.call(this,e,t);if(n&&(e=t),!!De.isString(e)){if(De.isString(r))return e.indexOf(r)!==-1;if(De.isRegExp(r))return r.test(e)}}function Mle(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function Cle(i,e){const t=De.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(i,r+t,{value:function(n,a,o){return this[r].call(this,e,n,a,o)},configurable:!0})})}class Kn{constructor(e){e&&this.set(e)}set(e,t,r){const n=this;function a(s,l,u){const c=zd(l);if(!c)throw new Error("header name must be a non-empty string");const p=De.findKey(n,c);(!p||n[p]===void 0||u===!0||u===void 0&&n[p]!==!1)&&(n[p||l]=_y(s))}const o=(s,l)=>De.forEach(s,(u,c)=>a(u,c,l));if(De.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(De.isString(e)&&(e=e.trim())&&!Sle(e))o(ble(e),t);else if(De.isHeaders(e))for(const[s,l]of e.entries())a(l,s,r);else e!=null&&a(t,e,r);return this}get(e,t){if(e=zd(e),e){const r=De.findKey(this,e);if(r){const n=this[r];if(!t)return n;if(t===!0)return wle(n);if(De.isFunction(t))return t.call(this,n,r);if(De.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=zd(e),e){const r=De.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||S2(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let n=!1;function a(o){if(o=zd(o),o){const s=De.findKey(r,o);s&&(!t||S2(r,r[s],s,t))&&(delete r[s],n=!0)}}return De.isArray(e)?e.forEach(a):a(e),n}clear(e){const t=Object.keys(this);let r=t.length,n=!1;for(;r--;){const a=t[r];(!e||S2(this,this[a],a,e,!0))&&(delete this[a],n=!0)}return n}normalize(e){const t=this,r={};return De.forEach(this,(n,a)=>{const o=De.findKey(r,a);if(o){t[o]=_y(n),delete t[a];return}const s=e?Mle(a):String(a).trim();s!==a&&delete t[a],t[s]=_y(n),r[s]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return De.forEach(this,(r,n)=>{r!=null&&r!==!1&&(t[n]=e&&De.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(n=>r.set(n)),r}static accessor(e){const r=(this[NA]=this[NA]={accessors:{}}).accessors,n=this.prototype;function a(o){const s=zd(o);r[s]||(Cle(n,o),r[s]=!0)}return De.isArray(e)?e.forEach(a):a(e),this}}Kn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);De.reduceDescriptors(Kn.prototype,({value:i},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>i,set(r){this[t]=r}}});De.freezeMethods(Kn);function M2(i,e){const t=this||sg,r=e||t,n=Kn.from(r.headers);let a=r.data;return De.forEach(i,function(s){a=s.call(t,a,n.normalize(),e?e.status:void 0)}),n.normalize(),a}function q9(i){return!!(i&&i.__CANCEL__)}function yd(i,e,t){Jt.call(this,i??"canceled",Jt.ERR_CANCELED,e,t),this.name="CanceledError"}De.inherits(yd,Jt,{__CANCEL__:!0});function Z9(i,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?i(t):e(new Jt("Request failed with status code "+t.status,[Jt.ERR_BAD_REQUEST,Jt.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Ele(i){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return e&&e[1]||""}function Tle(i,e){i=i||10;const t=new Array(i),r=new Array(i);let n=0,a=0,o;return e=e!==void 0?e:1e3,function(l){const u=Date.now(),c=r[a];o||(o=u),t[n]=l,r[n]=u;let p=a,d=0;for(;p!==n;)d+=t[p++],p=p%i;if(n=(n+1)%i,n===a&&(a=(a+1)%i),u-o<e)return;const m=c&&u-c;return m?Math.round(d*1e3/m):void 0}}function Ple(i,e){let t=0,r=1e3/e,n,a;const o=(u,c=Date.now())=>{t=c,n=null,a&&(clearTimeout(a),a=null),i.apply(null,u)};return[(...u)=>{const c=Date.now(),p=c-t;p>=r?o(u,c):(n=u,a||(a=setTimeout(()=>{a=null,o(n)},r-p)))},()=>n&&o(n)]}const Ev=(i,e,t=3)=>{let r=0;const n=Tle(50,250);return Ple(a=>{const o=a.loaded,s=a.lengthComputable?a.total:void 0,l=o-r,u=n(l),c=o<=s;r=o;const p={loaded:o,total:s,progress:s?o/s:void 0,bytes:l,rate:u||void 0,estimated:u&&s&&c?(s-o)/u:void 0,event:a,lengthComputable:s!=null,[e?"download":"upload"]:!0};i(p)},t)},$A=(i,e)=>{const t=i!=null;return[r=>e[0]({lengthComputable:t,total:i,loaded:r}),e[1]]},UA=i=>(...e)=>De.asap(()=>i(...e)),Ale=Jn.hasStandardBrowserEnv?function(){const e=Jn.navigator&&/(msie|trident)/i.test(Jn.navigator.userAgent),t=document.createElement("a");let r;function n(a){let o=a;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return r=n(window.location.href),function(o){const s=De.isString(o)?n(o):o;return s.protocol===r.protocol&&s.host===r.host}}():function(){return function(){return!0}}(),Ile=Jn.hasStandardBrowserEnv?{write(i,e,t,r,n,a){const o=[i+"="+encodeURIComponent(e)];De.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),De.isString(r)&&o.push("path="+r),De.isString(n)&&o.push("domain="+n),a===!0&&o.push("secure"),document.cookie=o.join("; ")},read(i){const e=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(i){this.write(i,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Lle(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function Dle(i,e){return e?i.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):i}function Y9(i,e){return i&&!Lle(e)?Dle(i,e):e}const VA=i=>i instanceof Kn?{...i}:i;function oh(i,e){e=e||{};const t={};function r(u,c,p){return De.isPlainObject(u)&&De.isPlainObject(c)?De.merge.call({caseless:p},u,c):De.isPlainObject(c)?De.merge({},c):De.isArray(c)?c.slice():c}function n(u,c,p){if(De.isUndefined(c)){if(!De.isUndefined(u))return r(void 0,u,p)}else return r(u,c,p)}function a(u,c){if(!De.isUndefined(c))return r(void 0,c)}function o(u,c){if(De.isUndefined(c)){if(!De.isUndefined(u))return r(void 0,u)}else return r(void 0,c)}function s(u,c,p){if(p in e)return r(u,c);if(p in i)return r(void 0,u)}const l={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:s,headers:(u,c)=>n(VA(u),VA(c),!0)};return De.forEach(Object.keys(Object.assign({},i,e)),function(c){const p=l[c]||n,d=p(i[c],e[c],c);De.isUndefined(d)&&p!==s||(t[c]=d)}),t}const J9=i=>{const e=oh({},i);let{data:t,withXSRFToken:r,xsrfHeaderName:n,xsrfCookieName:a,headers:o,auth:s}=e;e.headers=o=Kn.from(o),e.url=G9(Y9(e.baseURL,e.url),i.params,i.paramsSerializer),s&&o.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let l;if(De.isFormData(t)){if(Jn.hasStandardBrowserEnv||Jn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[u,...c]=l?l.split(";").map(p=>p.trim()).filter(Boolean):[];o.setContentType([u||"multipart/form-data",...c].join("; "))}}if(Jn.hasStandardBrowserEnv&&(r&&De.isFunction(r)&&(r=r(e)),r||r!==!1&&Ale(e.url))){const u=n&&a&&Ile.read(a);u&&o.set(n,u)}return e},kle=typeof XMLHttpRequest<"u",Rle=kle&&function(i){return new Promise(function(t,r){const n=J9(i);let a=n.data;const o=Kn.from(n.headers).normalize();let{responseType:s,onUploadProgress:l,onDownloadProgress:u}=n,c,p,d,m,g;function _(){m&&m(),g&&g(),n.cancelToken&&n.cancelToken.unsubscribe(c),n.signal&&n.signal.removeEventListener("abort",c)}let y=new XMLHttpRequest;y.open(n.method.toUpperCase(),n.url,!0),y.timeout=n.timeout;function x(){if(!y)return;const b=Kn.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),E={data:!s||s==="text"||s==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:b,config:i,request:y};Z9(function(L){t(L),_()},function(L){r(L),_()},E),y=null}"onloadend"in y?y.onloadend=x:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(x)},y.onabort=function(){y&&(r(new Jt("Request aborted",Jt.ECONNABORTED,i,y)),y=null)},y.onerror=function(){r(new Jt("Network Error",Jt.ERR_NETWORK,i,y)),y=null},y.ontimeout=function(){let C=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const E=n.transitional||W9;n.timeoutErrorMessage&&(C=n.timeoutErrorMessage),r(new Jt(C,E.clarifyTimeoutError?Jt.ETIMEDOUT:Jt.ECONNABORTED,i,y)),y=null},a===void 0&&o.setContentType(null),"setRequestHeader"in y&&De.forEach(o.toJSON(),function(C,E){y.setRequestHeader(E,C)}),De.isUndefined(n.withCredentials)||(y.withCredentials=!!n.withCredentials),s&&s!=="json"&&(y.responseType=n.responseType),u&&([d,g]=Ev(u,!0),y.addEventListener("progress",d)),l&&y.upload&&([p,m]=Ev(l),y.upload.addEventListener("progress",p),y.upload.addEventListener("loadend",m)),(n.cancelToken||n.signal)&&(c=b=>{y&&(r(!b||b.type?new yd(null,i,y):b),y.abort(),y=null)},n.cancelToken&&n.cancelToken.subscribe(c),n.signal&&(n.signal.aborted?c():n.signal.addEventListener("abort",c)));const w=Ele(n.url);if(w&&Jn.protocols.indexOf(w)===-1){r(new Jt("Unsupported protocol "+w+":",Jt.ERR_BAD_REQUEST,i));return}y.send(a||null)})},Fle=(i,e)=>{const{length:t}=i=i?i.filter(Boolean):[];if(e||t){let r=new AbortController,n;const a=function(u){if(!n){n=!0,s();const c=u instanceof Error?u:this.reason;r.abort(c instanceof Jt?c:new yd(c instanceof Error?c.message:c))}};let o=e&&setTimeout(()=>{o=null,a(new Jt(`timeout ${e} of ms exceeded`,Jt.ETIMEDOUT))},e);const s=()=>{i&&(o&&clearTimeout(o),o=null,i.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),i=null)};i.forEach(u=>u.addEventListener("abort",a));const{signal:l}=r;return l.unsubscribe=()=>De.asap(s),l}},Ole=function*(i,e){let t=i.byteLength;if(!e||t<e){yield i;return}let r=0,n;for(;r<t;)n=r+e,yield i.slice(r,n),r=n},Ble=async function*(i,e){for await(const t of zle(i))yield*Ole(t,e)},zle=async function*(i){if(i[Symbol.asyncIterator]){yield*i;return}const e=i.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},jA=(i,e,t,r)=>{const n=Ble(i,e);let a=0,o,s=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:u,value:c}=await n.next();if(u){s(),l.close();return}let p=c.byteLength;if(t){let d=a+=p;t(d)}l.enqueue(new Uint8Array(c))}catch(u){throw s(u),u}},cancel(l){return s(l),n.return()}},{highWaterMark:2})},Ox=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",K9=Ox&&typeof ReadableStream=="function",Nle=Ox&&(typeof TextEncoder=="function"?(i=>e=>i.encode(e))(new TextEncoder):async i=>new Uint8Array(await new Response(i).arrayBuffer())),Q9=(i,...e)=>{try{return!!i(...e)}catch{return!1}},$le=K9&&Q9(()=>{let i=!1;const e=new Request(Jn.origin,{body:new ReadableStream,method:"POST",get duplex(){return i=!0,"half"}}).headers.has("Content-Type");return i&&!e}),HA=64*1024,zw=K9&&Q9(()=>De.isReadableStream(new Response("").body)),Tv={stream:zw&&(i=>i.body)};Ox&&(i=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Tv[e]&&(Tv[e]=De.isFunction(i[e])?t=>t[e]():(t,r)=>{throw new Jt(`Response type '${e}' is not supported`,Jt.ERR_NOT_SUPPORT,r)})})})(new Response);const Ule=async i=>{if(i==null)return 0;if(De.isBlob(i))return i.size;if(De.isSpecCompliantForm(i))return(await new Request(Jn.origin,{method:"POST",body:i}).arrayBuffer()).byteLength;if(De.isArrayBufferView(i)||De.isArrayBuffer(i))return i.byteLength;if(De.isURLSearchParams(i)&&(i=i+""),De.isString(i))return(await Nle(i)).byteLength},Vle=async(i,e)=>{const t=De.toFiniteNumber(i.getContentLength());return t??Ule(e)},jle=Ox&&(async i=>{let{url:e,method:t,data:r,signal:n,cancelToken:a,timeout:o,onDownloadProgress:s,onUploadProgress:l,responseType:u,headers:c,withCredentials:p="same-origin",fetchOptions:d}=J9(i);u=u?(u+"").toLowerCase():"text";let m=Fle([n,a&&a.toAbortSignal()],o),g;const _=m&&m.unsubscribe&&(()=>{m.unsubscribe()});let y;try{if(l&&$le&&t!=="get"&&t!=="head"&&(y=await Vle(c,r))!==0){let E=new Request(e,{method:"POST",body:r,duplex:"half"}),T;if(De.isFormData(r)&&(T=E.headers.get("content-type"))&&c.setContentType(T),E.body){const[L,D]=$A(y,Ev(UA(l)));r=jA(E.body,HA,L,D)}}De.isString(p)||(p=p?"include":"omit");const x="credentials"in Request.prototype;g=new Request(e,{...d,signal:m,method:t.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",credentials:x?p:void 0});let w=await fetch(g);const b=zw&&(u==="stream"||u==="response");if(zw&&(s||b&&_)){const E={};["status","statusText","headers"].forEach(B=>{E[B]=w[B]});const T=De.toFiniteNumber(w.headers.get("content-length")),[L,D]=s&&$A(T,Ev(UA(s),!0))||[];w=new Response(jA(w.body,HA,L,()=>{D&&D(),_&&_()}),E)}u=u||"text";let C=await Tv[De.findKey(Tv,u)||"text"](w,i);return!b&&_&&_(),await new Promise((E,T)=>{Z9(E,T,{data:C,headers:Kn.from(w.headers),status:w.status,statusText:w.statusText,config:i,request:g})})}catch(x){throw _&&_(),x&&x.name==="TypeError"&&/fetch/i.test(x.message)?Object.assign(new Jt("Network Error",Jt.ERR_NETWORK,i,g),{cause:x.cause||x}):Jt.from(x,x&&x.code,i,g)}}),Nw={http:nle,xhr:Rle,fetch:jle};De.forEach(Nw,(i,e)=>{if(i){try{Object.defineProperty(i,"name",{value:e})}catch{}Object.defineProperty(i,"adapterName",{value:e})}});const GA=i=>`- ${i}`,Hle=i=>De.isFunction(i)||i===null||i===!1,eD={getAdapter:i=>{i=De.isArray(i)?i:[i];const{length:e}=i;let t,r;const n={};for(let a=0;a<e;a++){t=i[a];let o;if(r=t,!Hle(t)&&(r=Nw[(o=String(t)).toLowerCase()],r===void 0))throw new Jt(`Unknown adapter '${o}'`);if(r)break;n[o||"#"+a]=r}if(!r){const a=Object.entries(n).map(([s,l])=>`adapter ${s} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?a.length>1?`since :
`+a.map(GA).join(`
`):" "+GA(a[0]):"as no adapter specified";throw new Jt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:Nw};function C2(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new yd(null,i)}function WA(i){return C2(i),i.headers=Kn.from(i.headers),i.data=M2.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),eD.getAdapter(i.adapter||sg.adapter)(i).then(function(r){return C2(i),r.data=M2.call(i,i.transformResponse,r),r.headers=Kn.from(r.headers),r},function(r){return q9(r)||(C2(i),r&&r.response&&(r.response.data=M2.call(i,i.transformResponse,r.response),r.response.headers=Kn.from(r.response.headers))),Promise.reject(r)})}const tD="1.7.7",LE={};["object","boolean","number","function","string","symbol"].forEach((i,e)=>{LE[i]=function(r){return typeof r===i||"a"+(e<1?"n ":" ")+i}});const XA={};LE.transitional=function(e,t,r){function n(a,o){return"[Axios v"+tD+"] Transitional option '"+a+"'"+o+(r?". "+r:"")}return(a,o,s)=>{if(e===!1)throw new Jt(n(o," has been removed"+(t?" in "+t:"")),Jt.ERR_DEPRECATED);return t&&!XA[o]&&(XA[o]=!0,console.warn(n(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(a,o,s):!0}};function Gle(i,e,t){if(typeof i!="object")throw new Jt("options must be an object",Jt.ERR_BAD_OPTION_VALUE);const r=Object.keys(i);let n=r.length;for(;n-- >0;){const a=r[n],o=e[a];if(o){const s=i[a],l=s===void 0||o(s,a,i);if(l!==!0)throw new Jt("option "+a+" must be "+l,Jt.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Jt("Unknown option "+a,Jt.ERR_BAD_OPTION)}}const $w={assertOptions:Gle,validators:LE},qs=$w.validators;class Gu{constructor(e){this.defaults=e,this.interceptors={request:new zA,response:new zA}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let n;Error.captureStackTrace?Error.captureStackTrace(n={}):n=new Error;const a=n.stack?n.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=oh(this.defaults,t);const{transitional:r,paramsSerializer:n,headers:a}=t;r!==void 0&&$w.assertOptions(r,{silentJSONParsing:qs.transitional(qs.boolean),forcedJSONParsing:qs.transitional(qs.boolean),clarifyTimeoutError:qs.transitional(qs.boolean)},!1),n!=null&&(De.isFunction(n)?t.paramsSerializer={serialize:n}:$w.assertOptions(n,{encode:qs.function,serialize:qs.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=a&&De.merge(a.common,a[t.method]);a&&De.forEach(["delete","get","head","post","put","patch","common"],g=>{delete a[g]}),t.headers=Kn.concat(o,a);const s=[];let l=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(t)===!1||(l=l&&_.synchronous,s.unshift(_.fulfilled,_.rejected))});const u=[];this.interceptors.response.forEach(function(_){u.push(_.fulfilled,_.rejected)});let c,p=0,d;if(!l){const g=[WA.bind(this),void 0];for(g.unshift.apply(g,s),g.push.apply(g,u),d=g.length,c=Promise.resolve(t);p<d;)c=c.then(g[p++],g[p++]);return c}d=s.length;let m=t;for(p=0;p<d;){const g=s[p++],_=s[p++];try{m=g(m)}catch(y){_.call(this,y);break}}try{c=WA.call(this,m)}catch(g){return Promise.reject(g)}for(p=0,d=u.length;p<d;)c=c.then(u[p++],u[p++]);return c}getUri(e){e=oh(this.defaults,e);const t=Y9(e.baseURL,e.url);return G9(t,e.params,e.paramsSerializer)}}De.forEach(["delete","get","head","options"],function(e){Gu.prototype[e]=function(t,r){return this.request(oh(r||{},{method:e,url:t,data:(r||{}).data}))}});De.forEach(["post","put","patch"],function(e){function t(r){return function(a,o,s){return this.request(oh(s||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:o}))}}Gu.prototype[e]=t(),Gu.prototype[e+"Form"]=t(!0)});class DE{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const r=this;this.promise.then(n=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](n);r._listeners=null}),this.promise.then=n=>{let a;const o=new Promise(s=>{r.subscribe(s),a=s}).then(n);return o.cancel=function(){r.unsubscribe(a)},o},e(function(a,o,s){r.reason||(r.reason=new yd(a,o,s),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new DE(function(n){e=n}),cancel:e}}}function Wle(i){return function(t){return i.apply(null,t)}}function Xle(i){return De.isObject(i)&&i.isAxiosError===!0}const Uw={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Uw).forEach(([i,e])=>{Uw[e]=i});function iD(i){const e=new Gu(i),t=k9(Gu.prototype.request,e);return De.extend(t,Gu.prototype,e,{allOwnKeys:!0}),De.extend(t,e,null,{allOwnKeys:!0}),t.create=function(n){return iD(oh(i,n))},t}const Mr=iD(sg);Mr.Axios=Gu;Mr.CanceledError=yd;Mr.CancelToken=DE;Mr.isCancel=q9;Mr.VERSION=tD;Mr.toFormData=Fx;Mr.AxiosError=Jt;Mr.Cancel=Mr.CanceledError;Mr.all=function(e){return Promise.all(e)};Mr.spread=Wle;Mr.isAxiosError=Xle;Mr.mergeConfig=oh;Mr.AxiosHeaders=Kn;Mr.formToJSON=i=>X9(De.isHTMLForm(i)?new FormData(i):i);Mr.getAdapter=eD.getAdapter;Mr.HttpStatusCode=Uw;Mr.default=Mr;function qle(i){const[e,t]=$e.useState([]),[r,n]=$e.useState([]),[a,o]=$e.useState(!0),s=$e.useCallback(async()=>{Mr.get("http://localhost:5555/user/").then(l=>{t(l.data.data),n(l.data.data),o(!1)}).catch(l=>{console.log(l)})},[]);return $e.useEffect(()=>{(async()=>{await s(),console.log(e)})()},[s]),$e.useEffect(()=>{n(e.filter(l=>l.username.includes(i.searchParam)))},[i.searchParam]),a?At.jsx("p",{children:"Loading"}):At.jsx("div",{id:"friendList",children:r.map(l=>At.jsx(Zle,{imgSrc:l.profileImg,username:l.username},"friend:"+l.username))})}function Zle(i){function e(r,n=!1){const a=document.createElement("div");a.className="story",a.style="background-color: red; opacity: 0;";const o=document.createElement("button");o.id="backButton",o.className="storyButton",o.addEventListener("click",async d=>{a.style.opacity="0",a.style.pointerEvents="none",document.getElementById("navbar").style.opacity=1,await new Promise(m=>setTimeout(m,500)),a.parentElement==document.body&&document.body.removeChild(a)});const s=document.createElement("span");s.id="backButtonIcon",s.className="material-symbols-rounded",s.textContent="arrow_back_ios",s.style="width: 1.75vh; font-size: 3.5vh";const l=document.createElement("button");l.id="storySwapButton",l.className="storyButton";const u=document.createElement("span");u.className="material-symbols-rounded",u.id="storySwapIcon",u.style="font-size: 4vh; font-variation-settings: 'FILL' 1, 'wght' 300, 'GRAD' 0, 'opsz' 24;";const c=document.createElement("div");c.className="storyImage",c.style=`background: url(${r}); background-color: green`;const p=document.createElement("div");return p.className="mapContainer",p.style="",n?(a.appendChild(p),u.textContent="image",u.style.fontVariationSettings="font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 24;"):(a.appendChild(c),u.textContent="person_pin_circle"),l.addEventListener("click",d=>{u.textContent=="person_pin_circle"?(a.removeChild(c),a.appendChild(p),u.textContent="image",u.style.fontVariationSettings="font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 24;"):(a.removeChild(p),a.appendChild(c),u.textContent="person_pin_circle",u.style.fontVariationSettings="font-variation-settings: 'FILL' 1, 'wght' 300, 'GRAD' 0, 'opsz' 24;")}),o.appendChild(s),l.appendChild(u),a.appendChild(o),a.appendChild(l),a}async function t(){i.username;const r={image:"C:\\Users\\saaru\\Downloads\\Capture1726354644.jpg",status:"other"};switch(r.status){case"guessMade":break;case"noPhotos":break;default:const n=e(r.image,r.status=="guessMade");document.body.appendChild(n),document.getElementById("navbar").style.opacity=0,await new Promise(a=>setTimeout(a,50)),n.style.opacity="1";break}}return At.jsxs("button",{className:"friend",onClick:t,children:[At.jsx("img",{className:"profileImg",src:i.imgSrc}),At.jsx("pre",{className:"friendName",id:`friend-${i.username}-id`,children:i.username})]})}function Yle(i){function e(t=new InputEvent){const r=document.getElementById("searchbar").value;i.setSearchParam(r)}return At.jsxs(At.Fragment,{children:[At.jsx("input",{id:"searchbar",autoCapitalize:"none",onKeyUp:e}),At.jsx("span",{id:"searchbutton",className:"material-symbols-rounded",children:"search"})]})}var rD={exports:{}},Jle="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Kle=Jle,Qle=Kle;function nD(){}function aD(){}aD.resetWarningCache=nD;var eue=function(){function i(r,n,a,o,s,l){if(l!==Qle){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}i.isRequired=i;function e(){return i}var t={array:i,bigint:i,bool:i,func:i,number:i,object:i,string:i,symbol:i,any:i,arrayOf:e,element:i,elementType:i,instanceOf:e,node:i,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:aD,resetWarningCache:nD};return t.PropTypes=t,t};rD.exports=eue();var tue=rD.exports;const oD=oL(tue);function sD(i){const[e,t]=$e.useState("");return At.jsxs(At.Fragment,{children:[At.jsx("button",{onClick:i.logout,children:"Logout"}),At.jsx(Yle,{setSearchParam:t}),At.jsx(qle,{searchParam:e})]})}sD.prototype={logout:oD.func};function iue(){async function i(){const e=document.getElementById("cameraFeed"),t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight,t.getContext("2d").drawImage(e,0,0,t.width,t.height),navigator.geolocation.getCurrentPosition(n=>{localStorage.getItem("accountID or whatever"),t.toDataURL("image/jpeg"),n.coords.latitude,n.coords.longitude,n.coords.altitude&&n.coords.altitude,n.timestamp})}return At.jsxs(At.Fragment,{children:[At.jsx("video",{autoPlay:!0,playsInline:!0,id:"cameraFeed"}),At.jsx("input",{id:"shutter",onClick:i,role:"button",type:"button",capture:"camera"})]})}function rue(){return At.jsx("div",{children:At.jsx(iue,{})})}function lD(i){const e=I9();return $e.useEffect(()=>{function t(r){const n=document.getElementById("email").value,a=document.getElementById("pw").value;console.log(n+" "+a),r.preventDefault(),Mr.post("http://localhost:5555/user/login",{email:n,password:a}).then(o=>{console.log(o.data.verdict),o.data.verdict?(i.login(o.data._id),e("/LooGuessr")):alert("Incorrect password or email")}).catch(o=>{console.log(o)})}document.getElementById("loginForm").addEventListener("submit",t)},[]),At.jsx("div",{children:At.jsxs("form",{id:"loginForm",children:[At.jsx("label",{htmlFor:"email",children:"email:"}),At.jsx("br",{}),At.jsx("input",{type:"text",id:"email"}),At.jsx("br",{}),At.jsx("label",{htmlFor:"pw",children:"password:"}),At.jsx("br",{}),At.jsx("input",{type:"text",id:"pw"}),At.jsx("br",{}),At.jsx("input",{type:"submit"})]})})}lD.prototype={login:oD.func};function nue(){return At.jsx("div",{})}function aue(){return window.location.pathname.includes("photo")||window.location.pathname.includes("profile")||window.location.pathname.endsWith("LooGuessr/"),At.jsxs("div",{id:"navbar",children:[At.jsx(E2,{icon:"add_a_photo",id:"photoTab",borderRadius:"15px 0 0 15px",redirect:"photo"}),At.jsx(E2,{icon:"dashboard",id:"homeTab",redirect:""}),At.jsx(E2,{icon:"bar_chart",id:"profileTab",borderRadius:"0 15px 15px 0",redirect:"profile"})]})}function E2(i){const e=I9();async function t(r){if(r.preventDefault(),window.location.pathname.indexOf("photo")!=-1){const n=document.getElementById("cameraFeed"),a=n.srcObject;a!=null&&(a.getTracks().forEach(s=>s.stop()),n.srcObject=null)}if(e(`/LooGuessr/${i.redirect}`),i.redirect=="photo"){let n=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:2880,height:1800},audio:!1});const a=document.getElementById("cameraFeed");a.srcObject=n}}return At.jsx("button",{className:"navbutton",onClick:t,style:{borderRadius:i.borderRadius},children:At.jsx("span",{className:"navicon material-symbols-rounded",children:i.icon})})}const oue="modulepreload",sue=function(i){return"/LooGuessr/"+i},qA={},lg=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(t.map(l=>{if(l=sue(l),l in qA)return;qA[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":oue,u||(p.as="script"),p.crossOrigin="",p.href=l,s&&p.setAttribute("nonce",s),document.head.appendChild(p),u)return new Promise((d,m)=>{p.addEventListener("load",d),p.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return n.then(o=>{for(const s of o||[])s.status==="rejected"&&a(s.reason);return e().catch(a)})};var lue=Object.create,ug=Object.defineProperty,uue=Object.getOwnPropertyDescriptor,hue=Object.getOwnPropertyNames,cue=Object.getPrototypeOf,pue=Object.prototype.hasOwnProperty,due=(i,e,t)=>e in i?ug(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,h=(i,e)=>ug(i,"name",{value:e,configurable:!0}),fue=(i,e)=>()=>(i&&(e=i(i=0)),e),tt=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),_h=(i,e)=>{for(var t in e)ug(i,t,{get:e[t],enumerable:!0})},mue=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of hue(e))!pue.call(i,n)&&n!==t&&ug(i,n,{get:()=>e[n],enumerable:!(r=uue(e,n))||r.enumerable});return i},kt=(i,e,t)=>(t=i!=null?lue(cue(i)):{},mue(e||!i||!i.__esModule?ug(t,"default",{value:i,enumerable:!0}):t,i)),ie=(i,e,t)=>(due(i,typeof e!="symbol"?e+"":e,t),t),kE=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},M=(i,e,t)=>(kE(i,e,"read from private field"),t?t.call(i):e.get(i)),fe=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},Re=(i,e,t,r)=>(kE(i,e,"write to private field"),e.set(i,t),t),$t=(i,e,t)=>(kE(i,e,"access private method"),t),dr,R=fue(()=>{dr={env:{NODE_ENV:"production",npm_package_version:"6.0.1-beta.3"}}}),gi=tt((i,e)=>{R(),e.exports=t;function t(r,n){this.x=r,this.y=n}h(t,"Point"),t.prototype={clone:function(){return new t(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,n){return this.clone()._rotateAround(r,n)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var n=r.x-this.x,a=r.y-this.y;return n*n+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,n){return Math.atan2(this.x*n-this.y*r,this.x*r+this.y*n)},_matMult:function(r){var n=r[0]*this.x+r[1]*this.y,a=r[2]*this.x+r[3]*this.y;return this.x=n,this.y=a,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var n=Math.cos(r),a=Math.sin(r),o=n*this.x-a*this.y,s=a*this.x+n*this.y;return this.x=o,this.y=s,this},_rotateAround:function(r,n){var a=Math.cos(r),o=Math.sin(r),s=n.x+a*(this.x-n.x)-o*(this.y-n.y),l=n.y+o*(this.x-n.x)+a*(this.y-n.y);return this.x=s,this.y=l,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},t.convert=function(r){return r instanceof t?r:Array.isArray(r)?new t(r[0],r[1]):r}}),gue=tt((i,e)=>{R(),e.exports=t;function t(r,n,a,o){this.cx=3*r,this.bx=3*(a-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(o-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=n,this.p2x=a,this.p2y=o}h(t,"UnitBezier"),t.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,n){if(n===void 0&&(n=1e-6),r<0)return 0;if(r>1)return 1;for(var a=r,o=0;o<8;o++){var s=this.sampleCurveX(a)-r;if(Math.abs(s)<n)return a;var l=this.sampleCurveDerivativeX(a);if(Math.abs(l)<1e-6)break;a=a-s/l}var u=0,c=1;for(a=r,o=0;o<20&&(s=this.sampleCurveX(a),!(Math.abs(s-r)<n));o++)r>s?u=a:c=a,a=(c-u)*.5+u;return a},solve:function(r,n){return this.sampleCurveY(this.solveCurveX(r,n))}}}),yue=tt((i,e)=>{R();function t(r,n){var a,o,s,l,u,c,p,d;for(a=r.length&3,o=r.length-a,s=n,u=3432918353,c=461845907,d=0;d<o;)p=r.charCodeAt(d)&255|(r.charCodeAt(++d)&255)<<8|(r.charCodeAt(++d)&255)<<16|(r.charCodeAt(++d)&255)<<24,++d,p=(p&65535)*u+(((p>>>16)*u&65535)<<16)&4294967295,p=p<<15|p>>>17,p=(p&65535)*c+(((p>>>16)*c&65535)<<16)&4294967295,s^=p,s=s<<13|s>>>19,l=(s&65535)*5+(((s>>>16)*5&65535)<<16)&4294967295,s=(l&65535)+27492+(((l>>>16)+58964&65535)<<16);switch(p=0,a){case 3:p^=(r.charCodeAt(d+2)&255)<<16;case 2:p^=(r.charCodeAt(d+1)&255)<<8;case 1:p^=r.charCodeAt(d)&255,p=(p&65535)*u+(((p>>>16)*u&65535)<<16)&4294967295,p=p<<15|p>>>17,p=(p&65535)*c+(((p>>>16)*c&65535)<<16)&4294967295,s^=p}return s^=r.length,s^=s>>>16,s=(s&65535)*2246822507+(((s>>>16)*2246822507&65535)<<16)&4294967295,s^=s>>>13,s=(s&65535)*3266489909+(((s>>>16)*3266489909&65535)<<16)&4294967295,s^=s>>>16,s>>>0}h(t,"murmurhash3_32_gc"),typeof e<"u"&&(e.exports=t)}),vue=tt((i,e)=>{R();function t(r,n){for(var a=r.length,o=n^a,s=0,l;a>=4;)l=r.charCodeAt(s)&255|(r.charCodeAt(++s)&255)<<8|(r.charCodeAt(++s)&255)<<16|(r.charCodeAt(++s)&255)<<24,l=(l&65535)*1540483477+(((l>>>16)*1540483477&65535)<<16),l^=l>>>24,l=(l&65535)*1540483477+(((l>>>16)*1540483477&65535)<<16),o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)^l,a-=4,++s;switch(a){case 3:o^=(r.charCodeAt(s+2)&255)<<16;case 2:o^=(r.charCodeAt(s+1)&255)<<8;case 1:o^=r.charCodeAt(s)&255,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16)}return o^=o>>>13,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>15,o>>>0}h(t,"murmurhash2_32_gc"),typeof e!==void 0&&(e.exports=t)}),uD=tt((i,e)=>{R();var t=yue(),r=vue();e.exports=t,e.exports.murmur3=t,e.exports.murmur2=r}),hD=tt((i,e)=>{R(),e.exports=t,e.exports.default=t;function t(O,V,j){j=j||2;var q=V&&V.length,ee=q?V[0]*j:O.length,ae=r(O,0,ee,j,!0),N=[];if(!ae||ae.next===ae.prev)return N;var J,Y,oe,xe,ge,Te,me;if(q&&(ae=c(O,V,ae,j)),O.length>80*j){J=oe=O[0],Y=xe=O[1];for(var Q=j;Q<ee;Q+=j)ge=O[Q],Te=O[Q+1],ge<J&&(J=ge),Te<Y&&(Y=Te),ge>oe&&(oe=ge),Te>xe&&(xe=Te);me=Math.max(oe-J,xe-Y),me=me!==0?32767/me:0}return a(ae,N,j,J,Y,me,0),N}h(t,"earcut");function r(O,V,j,q,ee){var ae,N;if(ee===K(O,V,j,q)>0)for(ae=V;ae<j;ae+=q)N=P(ae,O[ae],O[ae+1],N);else for(ae=j-q;ae>=V;ae-=q)N=P(ae,O[ae],O[ae+1],N);return N&&T(N,N.next)&&(U(N),N=N.next),N}h(r,"linkedList");function n(O,V){if(!O)return O;V||(V=O);var j=O,q;do if(q=!1,!j.steiner&&(T(j,j.next)||E(j.prev,j,j.next)===0)){if(U(j),j=V=j.prev,j===j.next)break;q=!0}else j=j.next;while(q||j!==V);return V}h(n,"filterPoints");function a(O,V,j,q,ee,ae,N){if(O){!N&&ae&&_(O,q,ee,ae);for(var J=O,Y,oe;O.prev!==O.next;){if(Y=O.prev,oe=O.next,ae?s(O,q,ee,ae):o(O)){V.push(Y.i/j|0),V.push(O.i/j|0),V.push(oe.i/j|0),U(O),O=oe.next,J=oe.next;continue}if(O=oe,O===J){N?N===1?(O=l(n(O),V,j),a(O,V,j,q,ee,ae,2)):N===2&&u(O,V,j,q,ee,ae):a(n(O),V,j,q,ee,ae,1);break}}}}h(a,"earcutLinked");function o(O){var V=O.prev,j=O,q=O.next;if(E(V,j,q)>=0)return!1;for(var ee=V.x,ae=j.x,N=q.x,J=V.y,Y=j.y,oe=q.y,xe=ee<ae?ee<N?ee:N:ae<N?ae:N,ge=J<Y?J<oe?J:oe:Y<oe?Y:oe,Te=ee>ae?ee>N?ee:N:ae>N?ae:N,me=J>Y?J>oe?J:oe:Y>oe?Y:oe,Q=q.next;Q!==V;){if(Q.x>=xe&&Q.x<=Te&&Q.y>=ge&&Q.y<=me&&b(ee,J,ae,Y,N,oe,Q.x,Q.y)&&E(Q.prev,Q,Q.next)>=0)return!1;Q=Q.next}return!0}h(o,"isEar");function s(O,V,j,q){var ee=O.prev,ae=O,N=O.next;if(E(ee,ae,N)>=0)return!1;for(var J=ee.x,Y=ae.x,oe=N.x,xe=ee.y,ge=ae.y,Te=N.y,me=J<Y?J<oe?J:oe:Y<oe?Y:oe,Q=xe<ge?xe<Te?xe:Te:ge<Te?ge:Te,Me=J>Y?J>oe?J:oe:Y>oe?Y:oe,ve=xe>ge?xe>Te?xe:Te:ge>Te?ge:Te,Ie=x(me,Q,V,j,q),ke=x(Me,ve,V,j,q),we=O.prevZ,Oe=O.nextZ;we&&we.z>=Ie&&Oe&&Oe.z<=ke;){if(we.x>=me&&we.x<=Me&&we.y>=Q&&we.y<=ve&&we!==ee&&we!==N&&b(J,xe,Y,ge,oe,Te,we.x,we.y)&&E(we.prev,we,we.next)>=0||(we=we.prevZ,Oe.x>=me&&Oe.x<=Me&&Oe.y>=Q&&Oe.y<=ve&&Oe!==ee&&Oe!==N&&b(J,xe,Y,ge,oe,Te,Oe.x,Oe.y)&&E(Oe.prev,Oe,Oe.next)>=0))return!1;Oe=Oe.nextZ}for(;we&&we.z>=Ie;){if(we.x>=me&&we.x<=Me&&we.y>=Q&&we.y<=ve&&we!==ee&&we!==N&&b(J,xe,Y,ge,oe,Te,we.x,we.y)&&E(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;Oe&&Oe.z<=ke;){if(Oe.x>=me&&Oe.x<=Me&&Oe.y>=Q&&Oe.y<=ve&&Oe!==ee&&Oe!==N&&b(J,xe,Y,ge,oe,Te,Oe.x,Oe.y)&&E(Oe.prev,Oe,Oe.next)>=0)return!1;Oe=Oe.nextZ}return!0}h(s,"isEarHashed");function l(O,V,j){var q=O;do{var ee=q.prev,ae=q.next.next;!T(ee,ae)&&L(ee,q,q.next,ae)&&k(ee,ae)&&k(ae,ee)&&(V.push(ee.i/j|0),V.push(q.i/j|0),V.push(ae.i/j|0),U(q),U(q.next),q=O=ae),q=q.next}while(q!==O);return n(q)}h(l,"cureLocalIntersections");function u(O,V,j,q,ee,ae){var N=O;do{for(var J=N.next.next;J!==N.prev;){if(N.i!==J.i&&C(N,J)){var Y=z(N,J);N=n(N,N.next),Y=n(Y,Y.next),a(N,V,j,q,ee,ae,0),a(Y,V,j,q,ee,ae,0);return}J=J.next}N=N.next}while(N!==O)}h(u,"splitEarcut");function c(O,V,j,q){var ee=[],ae,N,J,Y,oe;for(ae=0,N=V.length;ae<N;ae++)J=V[ae]*q,Y=ae<N-1?V[ae+1]*q:O.length,oe=r(O,J,Y,q,!1),oe===oe.next&&(oe.steiner=!0),ee.push(w(oe));for(ee.sort(p),ae=0;ae<ee.length;ae++)j=d(ee[ae],j);return j}h(c,"eliminateHoles");function p(O,V){return O.x-V.x}h(p,"compareX");function d(O,V){var j=m(O,V);if(!j)return V;var q=z(j,O);return n(q,q.next),n(j,j.next)}h(d,"eliminateHole");function m(O,V){var j=V,q=O.x,ee=O.y,ae=-1/0,N;do{if(ee<=j.y&&ee>=j.next.y&&j.next.y!==j.y){var J=j.x+(ee-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(J<=q&&J>ae&&(ae=J,N=j.x<j.next.x?j:j.next,J===q))return N}j=j.next}while(j!==V);if(!N)return null;var Y=N,oe=N.x,xe=N.y,ge=1/0,Te;j=N;do q>=j.x&&j.x>=oe&&q!==j.x&&b(ee<xe?q:ae,ee,oe,xe,ee<xe?ae:q,ee,j.x,j.y)&&(Te=Math.abs(ee-j.y)/(q-j.x),k(j,O)&&(Te<ge||Te===ge&&(j.x>N.x||j.x===N.x&&g(N,j)))&&(N=j,ge=Te)),j=j.next;while(j!==Y);return N}h(m,"findHoleBridge");function g(O,V){return E(O.prev,O,V.prev)<0&&E(V.next,O,O.next)<0}h(g,"sectorContainsSector");function _(O,V,j,q){var ee=O;do ee.z===0&&(ee.z=x(ee.x,ee.y,V,j,q)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next;while(ee!==O);ee.prevZ.nextZ=null,ee.prevZ=null,y(ee)}h(_,"indexCurve");function y(O){var V,j,q,ee,ae,N,J,Y,oe=1;do{for(j=O,O=null,ae=null,N=0;j;){for(N++,q=j,J=0,V=0;V<oe&&(J++,q=q.nextZ,!!q);V++);for(Y=oe;J>0||Y>0&&q;)J!==0&&(Y===0||!q||j.z<=q.z)?(ee=j,j=j.nextZ,J--):(ee=q,q=q.nextZ,Y--),ae?ae.nextZ=ee:O=ee,ee.prevZ=ae,ae=ee;j=q}ae.nextZ=null,oe*=2}while(N>1);return O}h(y,"sortLinked");function x(O,V,j,q,ee){return O=(O-j)*ee|0,V=(V-q)*ee|0,O=(O|O<<8)&16711935,O=(O|O<<4)&252645135,O=(O|O<<2)&858993459,O=(O|O<<1)&1431655765,V=(V|V<<8)&16711935,V=(V|V<<4)&252645135,V=(V|V<<2)&858993459,V=(V|V<<1)&1431655765,O|V<<1}h(x,"zOrder");function w(O){var V=O,j=O;do(V.x<j.x||V.x===j.x&&V.y<j.y)&&(j=V),V=V.next;while(V!==O);return j}h(w,"getLeftmost");function b(O,V,j,q,ee,ae,N,J){return(ee-N)*(V-J)>=(O-N)*(ae-J)&&(O-N)*(q-J)>=(j-N)*(V-J)&&(j-N)*(ae-J)>=(ee-N)*(q-J)}h(b,"pointInTriangle");function C(O,V){return O.next.i!==V.i&&O.prev.i!==V.i&&!A(O,V)&&(k(O,V)&&k(V,O)&&$(O,V)&&(E(O.prev,O,V.prev)||E(O,V.prev,V))||T(O,V)&&E(O.prev,O,O.next)>0&&E(V.prev,V,V.next)>0)}h(C,"isValidDiagonal");function E(O,V,j){return(V.y-O.y)*(j.x-V.x)-(V.x-O.x)*(j.y-V.y)}h(E,"area");function T(O,V){return O.x===V.x&&O.y===V.y}h(T,"equals");function L(O,V,j,q){var ee=B(E(O,V,j)),ae=B(E(O,V,q)),N=B(E(j,q,O)),J=B(E(j,q,V));return!!(ee!==ae&&N!==J||ee===0&&D(O,j,V)||ae===0&&D(O,q,V)||N===0&&D(j,O,q)||J===0&&D(j,V,q))}h(L,"intersects");function D(O,V,j){return V.x<=Math.max(O.x,j.x)&&V.x>=Math.min(O.x,j.x)&&V.y<=Math.max(O.y,j.y)&&V.y>=Math.min(O.y,j.y)}h(D,"onSegment");function B(O){return O>0?1:O<0?-1:0}h(B,"sign");function A(O,V){var j=O;do{if(j.i!==O.i&&j.next.i!==O.i&&j.i!==V.i&&j.next.i!==V.i&&L(j,j.next,O,V))return!0;j=j.next}while(j!==O);return!1}h(A,"intersectsPolygon");function k(O,V){return E(O.prev,O,O.next)<0?E(O,V,O.next)>=0&&E(O,O.prev,V)>=0:E(O,V,O.prev)<0||E(O,O.next,V)<0}h(k,"locallyInside");function $(O,V){var j=O,q=!1,ee=(O.x+V.x)/2,ae=(O.y+V.y)/2;do j.y>ae!=j.next.y>ae&&j.next.y!==j.y&&ee<(j.next.x-j.x)*(ae-j.y)/(j.next.y-j.y)+j.x&&(q=!q),j=j.next;while(j!==O);return q}h($,"middleInside");function z(O,V){var j=new G(O.i,O.x,O.y),q=new G(V.i,V.x,V.y),ee=O.next,ae=V.prev;return O.next=V,V.prev=O,j.next=ee,ee.prev=j,q.next=j,j.prev=q,ae.next=q,q.prev=ae,q}h(z,"splitPolygon");function P(O,V,j,q){var ee=new G(O,V,j);return q?(ee.next=q.next,ee.prev=q,q.next.prev=ee,q.next=ee):(ee.prev=ee,ee.next=ee),ee}h(P,"insertNode");function U(O){O.next.prev=O.prev,O.prev.next=O.next,O.prevZ&&(O.prevZ.nextZ=O.nextZ),O.nextZ&&(O.nextZ.prevZ=O.prevZ)}h(U,"removeNode");function G(O,V,j){this.i=O,this.x=V,this.y=j,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}h(G,"Node"),t.deviation=function(O,V,j,q){var ee=V&&V.length,ae=ee?V[0]*j:O.length,N=Math.abs(K(O,0,ae,j));if(ee)for(var J=0,Y=V.length;J<Y;J++){var oe=V[J]*j,xe=J<Y-1?V[J+1]*j:O.length;N-=Math.abs(K(O,oe,xe,j))}var ge=0;for(J=0;J<q.length;J+=3){var Te=q[J]*j,me=q[J+1]*j,Q=q[J+2]*j;ge+=Math.abs((O[Te]-O[Q])*(O[me+1]-O[Te+1])-(O[Te]-O[me])*(O[Q+1]-O[Te+1]))}return N===0&&ge===0?0:Math.abs((ge-N)/N)};function K(O,V,j,q){for(var ee=0,ae=V,N=j-q;ae<j;ae+=q)ee+=(O[N]-O[ae])*(O[ae+1]+O[N+1]),N=ae;return ee}h(K,"signedArea"),t.flatten=function(O){for(var V=O[0][0].length,j={vertices:[],holes:[],dimensions:V},q=0,ee=0;ee<O.length;ee++){for(var ae=0;ae<O[ee].length;ae++)for(var N=0;N<V;N++)j.vertices.push(O[ee][ae][N]);ee>0&&(q+=O[ee-1].length,j.holes.push(q))}return j}}),cD=tt((i,e)=>{R();var t=gi();e.exports=r;function r(l,u,c,p,d){this.properties={},this.extent=c,this.type=0,this._pbf=l,this._geometry=-1,this._keys=p,this._values=d,l.readFields(n,this,u)}h(r,"VectorTileFeature");function n(l,u,c){l==1?u.id=c.readVarint():l==2?a(c,u):l==3?u.type=c.readVarint():l==4&&(u._geometry=c.pos)}h(n,"readFeature");function a(l,u){for(var c=l.readVarint()+l.pos;l.pos<c;){var p=u._keys[l.readVarint()],d=u._values[l.readVarint()];u.properties[p]=d}}h(a,"readTag"),r.types=["Unknown","Point","LineString","Polygon"],r.prototype.loadGeometry=function(){var l=this._pbf;l.pos=this._geometry;for(var u=l.readVarint()+l.pos,c=1,p=0,d=0,m=0,g=[],_;l.pos<u;){if(p<=0){var y=l.readVarint();c=y&7,p=y>>3}if(p--,c===1||c===2)d+=l.readSVarint(),m+=l.readSVarint(),c===1&&(_&&g.push(_),_=[]),_.push(new t(d,m));else if(c===7)_&&_.push(_[0].clone());else throw new Error("unknown command "+c)}return _&&g.push(_),g},r.prototype.bbox=function(){var l=this._pbf;l.pos=this._geometry;for(var u=l.readVarint()+l.pos,c=1,p=0,d=0,m=0,g=1/0,_=-1/0,y=1/0,x=-1/0;l.pos<u;){if(p<=0){var w=l.readVarint();c=w&7,p=w>>3}if(p--,c===1||c===2)d+=l.readSVarint(),m+=l.readSVarint(),d<g&&(g=d),d>_&&(_=d),m<y&&(y=m),m>x&&(x=m);else if(c!==7)throw new Error("unknown command "+c)}return[g,y,_,x]},r.prototype.toGeoJSON=function(l,u,c){var p=this.extent*Math.pow(2,c),d=this.extent*l,m=this.extent*u,g=this.loadGeometry(),_=r.types[this.type],y,x;function w(E){for(var T=0;T<E.length;T++){var L=E[T],D=180-(L.y+m)*360/p;E[T]=[(L.x+d)*360/p-180,360/Math.PI*Math.atan(Math.exp(D*Math.PI/180))-90]}}switch(h(w,"project"),this.type){case 1:var b=[];for(y=0;y<g.length;y++)b[y]=g[y][0];g=b,w(g);break;case 2:for(y=0;y<g.length;y++)w(g[y]);break;case 3:for(g=o(g),y=0;y<g.length;y++)for(x=0;x<g[y].length;x++)w(g[y][x]);break}g.length===1?g=g[0]:_="Multi"+_;var C={type:"Feature",geometry:{type:_,coordinates:g},properties:this.properties};return"id"in this&&(C.id=this.id),C};function o(l){var u=l.length;if(u<=1)return[l];for(var c=[],p,d,m=0;m<u;m++){var g=s(l[m]);g!==0&&(d===void 0&&(d=g<0),d===g<0?(p&&c.push(p),p=[l[m]]):p.push(l[m]))}return p&&c.push(p),c}h(o,"classifyRings");function s(l){for(var u=0,c=0,p=l.length,d=p-1,m,g;c<p;d=c++)m=l[c],g=l[d],u+=(g.x-m.x)*(m.y+g.y);return u}h(s,"signedArea")}),pD=tt((i,e)=>{R();var t=cD();e.exports=r;function r(o,s){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(n,this,s),this.length=this._features.length}h(r,"VectorTileLayer");function n(o,s,l){o===15?s.version=l.readVarint():o===1?s.name=l.readString():o===5?s.extent=l.readVarint():o===2?s._features.push(l.pos):o===3?s._keys.push(l.readString()):o===4&&s._values.push(a(l))}h(n,"readLayer");function a(o){for(var s=null,l=o.readVarint()+o.pos;o.pos<l;){var u=o.readVarint()>>3;s=u===1?o.readString():u===2?o.readFloat():u===3?o.readDouble():u===4?o.readVarint64():u===5?o.readVarint():u===6?o.readSVarint():u===7?o.readBoolean():null}return s}h(a,"readValueMessage"),r.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var s=this._pbf.readVarint()+this._pbf.pos;return new t(this._pbf,s,this.extent,this._keys,this._values)}}),xue=tt((i,e)=>{R();var t=pD();e.exports=r;function r(a,o){this.layers=a.readFields(n,{},o)}h(r,"VectorTile");function n(a,o,s){if(a===3){var l=new t(s,s.readVarint()+s.pos);l.length&&(o[l.name]=l)}}h(n,"readTile")}),Bx=tt((i,e)=>{R(),e.exports.VectorTile=xue(),e.exports.VectorTileFeature=cD(),e.exports.VectorTileLayer=pD()}),_ue=tt(i=>{R(),i.read=function(e,t,r,n,a){var o,s,l=a*8-n-1,u=(1<<l)-1,c=u>>1,p=-7,d=r?a-1:0,m=r?-1:1,g=e[t+d];for(d+=m,o=g&(1<<-p)-1,g>>=-p,p+=l;p>0;o=o*256+e[t+d],d+=m,p-=8);for(s=o&(1<<-p)-1,o>>=-p,p+=n;p>0;s=s*256+e[t+d],d+=m,p-=8);if(o===0)o=1-c;else{if(o===u)return s?NaN:(g?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-c}return(g?-1:1)*s*Math.pow(2,o-n)},i.write=function(e,t,r,n,a,o){var s,l,u,c=o*8-a-1,p=(1<<c)-1,d=p>>1,m=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:o-1,_=n?1:-1,y=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,s=p):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),s+d>=1?t+=m/u:t+=m*Math.pow(2,1-d),t*u>=2&&(s++,u/=2),s+d>=p?(l=0,s=p):s+d>=1?(l=(t*u-1)*Math.pow(2,a),s=s+d):(l=t*Math.pow(2,d-1)*Math.pow(2,a),s=0));a>=8;e[r+g]=l&255,g+=_,l/=256,a-=8);for(s=s<<a|l,c+=a;c>0;e[r+g]=s&255,g+=_,s/=256,c-=8);e[r+g-_]|=y*128}}),dD=tt((i,e)=>{R(),e.exports=r;var t=_ue();function r(P){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(P)?P:new Uint8Array(P||0),this.pos=0,this.type=0,this.length=this.buf.length}h(r,"Pbf"),r.Varint=0,r.Fixed64=1,r.Bytes=2,r.Fixed32=5;var n=65536*65536,a=1/n,o=12,s=typeof TextDecoder>"u"?null:new TextDecoder("utf8");r.prototype={destroy:function(){this.buf=null},readFields:function(P,U,G){for(G=G||this.length;this.pos<G;){var K=this.readVarint(),O=K>>3,V=this.pos;this.type=K&7,P(O,U,this),this.pos===V&&this.skip(K)}return U},readMessage:function(P,U){return this.readFields(P,U,this.readVarint()+this.pos)},readFixed32:function(){var P=D(this.buf,this.pos);return this.pos+=4,P},readSFixed32:function(){var P=A(this.buf,this.pos);return this.pos+=4,P},readFixed64:function(){var P=D(this.buf,this.pos)+D(this.buf,this.pos+4)*n;return this.pos+=8,P},readSFixed64:function(){var P=D(this.buf,this.pos)+A(this.buf,this.pos+4)*n;return this.pos+=8,P},readFloat:function(){var P=t.read(this.buf,this.pos,!0,23,4);return this.pos+=4,P},readDouble:function(){var P=t.read(this.buf,this.pos,!0,52,8);return this.pos+=8,P},readVarint:function(P){var U=this.buf,G,K;return K=U[this.pos++],G=K&127,K<128||(K=U[this.pos++],G|=(K&127)<<7,K<128)||(K=U[this.pos++],G|=(K&127)<<14,K<128)||(K=U[this.pos++],G|=(K&127)<<21,K<128)?G:(K=U[this.pos],G|=(K&15)<<28,l(G,P,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var P=this.readVarint();return P%2===1?(P+1)/-2:P/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var P=this.readVarint()+this.pos,U=this.pos;return this.pos=P,P-U>=o&&s?$(this.buf,U,P):k(this.buf,U,P)},readBytes:function(){var P=this.readVarint()+this.pos,U=this.buf.subarray(this.pos,P);return this.pos=P,U},readPackedVarint:function(P,U){if(this.type!==r.Bytes)return P.push(this.readVarint(U));var G=u(this);for(P=P||[];this.pos<G;)P.push(this.readVarint(U));return P},readPackedSVarint:function(P){if(this.type!==r.Bytes)return P.push(this.readSVarint());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readSVarint());return P},readPackedBoolean:function(P){if(this.type!==r.Bytes)return P.push(this.readBoolean());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readBoolean());return P},readPackedFloat:function(P){if(this.type!==r.Bytes)return P.push(this.readFloat());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readFloat());return P},readPackedDouble:function(P){if(this.type!==r.Bytes)return P.push(this.readDouble());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readDouble());return P},readPackedFixed32:function(P){if(this.type!==r.Bytes)return P.push(this.readFixed32());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readFixed32());return P},readPackedSFixed32:function(P){if(this.type!==r.Bytes)return P.push(this.readSFixed32());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readSFixed32());return P},readPackedFixed64:function(P){if(this.type!==r.Bytes)return P.push(this.readFixed64());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readFixed64());return P},readPackedSFixed64:function(P){if(this.type!==r.Bytes)return P.push(this.readSFixed64());var U=u(this);for(P=P||[];this.pos<U;)P.push(this.readSFixed64());return P},skip:function(P){var U=P&7;if(U===r.Varint)for(;this.buf[this.pos++]>127;);else if(U===r.Bytes)this.pos=this.readVarint()+this.pos;else if(U===r.Fixed32)this.pos+=4;else if(U===r.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+U)},writeTag:function(P,U){this.writeVarint(P<<3|U)},realloc:function(P){for(var U=this.length||16;U<this.pos+P;)U*=2;if(U!==this.length){var G=new Uint8Array(U);G.set(this.buf),this.buf=G,this.length=U}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(P){this.realloc(4),B(this.buf,P,this.pos),this.pos+=4},writeSFixed32:function(P){this.realloc(4),B(this.buf,P,this.pos),this.pos+=4},writeFixed64:function(P){this.realloc(8),B(this.buf,P&-1,this.pos),B(this.buf,Math.floor(P*a),this.pos+4),this.pos+=8},writeSFixed64:function(P){this.realloc(8),B(this.buf,P&-1,this.pos),B(this.buf,Math.floor(P*a),this.pos+4),this.pos+=8},writeVarint:function(P){if(P=+P||0,P>268435455||P<0){p(P,this);return}this.realloc(4),this.buf[this.pos++]=P&127|(P>127?128:0),!(P<=127)&&(this.buf[this.pos++]=(P>>>=7)&127|(P>127?128:0),!(P<=127)&&(this.buf[this.pos++]=(P>>>=7)&127|(P>127?128:0),!(P<=127)&&(this.buf[this.pos++]=P>>>7&127)))},writeSVarint:function(P){this.writeVarint(P<0?-P*2-1:P*2)},writeBoolean:function(P){this.writeVarint(!!P)},writeString:function(P){P=String(P),this.realloc(P.length*4),this.pos++;var U=this.pos;this.pos=z(this.buf,P,this.pos);var G=this.pos-U;G>=128&&g(U,G,this),this.pos=U-1,this.writeVarint(G),this.pos+=G},writeFloat:function(P){this.realloc(4),t.write(this.buf,P,this.pos,!0,23,4),this.pos+=4},writeDouble:function(P){this.realloc(8),t.write(this.buf,P,this.pos,!0,52,8),this.pos+=8},writeBytes:function(P){var U=P.length;this.writeVarint(U),this.realloc(U);for(var G=0;G<U;G++)this.buf[this.pos++]=P[G]},writeRawMessage:function(P,U){this.pos++;var G=this.pos;P(U,this);var K=this.pos-G;K>=128&&g(G,K,this),this.pos=G-1,this.writeVarint(K),this.pos+=K},writeMessage:function(P,U,G){this.writeTag(P,r.Bytes),this.writeRawMessage(U,G)},writePackedVarint:function(P,U){U.length&&this.writeMessage(P,_,U)},writePackedSVarint:function(P,U){U.length&&this.writeMessage(P,y,U)},writePackedBoolean:function(P,U){U.length&&this.writeMessage(P,b,U)},writePackedFloat:function(P,U){U.length&&this.writeMessage(P,x,U)},writePackedDouble:function(P,U){U.length&&this.writeMessage(P,w,U)},writePackedFixed32:function(P,U){U.length&&this.writeMessage(P,C,U)},writePackedSFixed32:function(P,U){U.length&&this.writeMessage(P,E,U)},writePackedFixed64:function(P,U){U.length&&this.writeMessage(P,T,U)},writePackedSFixed64:function(P,U){U.length&&this.writeMessage(P,L,U)},writeBytesField:function(P,U){this.writeTag(P,r.Bytes),this.writeBytes(U)},writeFixed32Field:function(P,U){this.writeTag(P,r.Fixed32),this.writeFixed32(U)},writeSFixed32Field:function(P,U){this.writeTag(P,r.Fixed32),this.writeSFixed32(U)},writeFixed64Field:function(P,U){this.writeTag(P,r.Fixed64),this.writeFixed64(U)},writeSFixed64Field:function(P,U){this.writeTag(P,r.Fixed64),this.writeSFixed64(U)},writeVarintField:function(P,U){this.writeTag(P,r.Varint),this.writeVarint(U)},writeSVarintField:function(P,U){this.writeTag(P,r.Varint),this.writeSVarint(U)},writeStringField:function(P,U){this.writeTag(P,r.Bytes),this.writeString(U)},writeFloatField:function(P,U){this.writeTag(P,r.Fixed32),this.writeFloat(U)},writeDoubleField:function(P,U){this.writeTag(P,r.Fixed64),this.writeDouble(U)},writeBooleanField:function(P,U){this.writeVarintField(P,!!U)}};function l(P,U,G){var K=G.buf,O,V;if(V=K[G.pos++],O=(V&112)>>4,V<128||(V=K[G.pos++],O|=(V&127)<<3,V<128)||(V=K[G.pos++],O|=(V&127)<<10,V<128)||(V=K[G.pos++],O|=(V&127)<<17,V<128)||(V=K[G.pos++],O|=(V&127)<<24,V<128)||(V=K[G.pos++],O|=(V&1)<<31,V<128))return c(P,O,U);throw new Error("Expected varint not more than 10 bytes")}h(l,"readVarintRemainder");function u(P){return P.type===r.Bytes?P.readVarint()+P.pos:P.pos+1}h(u,"readPackedEnd");function c(P,U,G){return G?U*4294967296+(P>>>0):(U>>>0)*4294967296+(P>>>0)}h(c,"toNum");function p(P,U){var G,K;if(P>=0?(G=P%4294967296|0,K=P/4294967296|0):(G=~(-P%4294967296),K=~(-P/4294967296),G^4294967295?G=G+1|0:(G=0,K=K+1|0)),P>=18446744073709552e3||P<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");U.realloc(10),d(G,K,U),m(K,U)}h(p,"writeBigVarint");function d(P,U,G){G.buf[G.pos++]=P&127|128,P>>>=7,G.buf[G.pos++]=P&127|128,P>>>=7,G.buf[G.pos++]=P&127|128,P>>>=7,G.buf[G.pos++]=P&127|128,P>>>=7,G.buf[G.pos]=P&127}h(d,"writeBigVarintLow");function m(P,U){var G=(P&7)<<4;U.buf[U.pos++]|=G|((P>>>=3)?128:0),P&&(U.buf[U.pos++]=P&127|((P>>>=7)?128:0),P&&(U.buf[U.pos++]=P&127|((P>>>=7)?128:0),P&&(U.buf[U.pos++]=P&127|((P>>>=7)?128:0),P&&(U.buf[U.pos++]=P&127|((P>>>=7)?128:0),P&&(U.buf[U.pos++]=P&127)))))}h(m,"writeBigVarintHigh");function g(P,U,G){var K=U<=16383?1:U<=2097151?2:U<=268435455?3:Math.floor(Math.log(U)/(Math.LN2*7));G.realloc(K);for(var O=G.pos-1;O>=P;O--)G.buf[O+K]=G.buf[O]}h(g,"makeRoomForExtraLength");function _(P,U){for(var G=0;G<P.length;G++)U.writeVarint(P[G])}h(_,"writePackedVarint");function y(P,U){for(var G=0;G<P.length;G++)U.writeSVarint(P[G])}h(y,"writePackedSVarint");function x(P,U){for(var G=0;G<P.length;G++)U.writeFloat(P[G])}h(x,"writePackedFloat");function w(P,U){for(var G=0;G<P.length;G++)U.writeDouble(P[G])}h(w,"writePackedDouble");function b(P,U){for(var G=0;G<P.length;G++)U.writeBoolean(P[G])}h(b,"writePackedBoolean");function C(P,U){for(var G=0;G<P.length;G++)U.writeFixed32(P[G])}h(C,"writePackedFixed32");function E(P,U){for(var G=0;G<P.length;G++)U.writeSFixed32(P[G])}h(E,"writePackedSFixed32");function T(P,U){for(var G=0;G<P.length;G++)U.writeFixed64(P[G])}h(T,"writePackedFixed64");function L(P,U){for(var G=0;G<P.length;G++)U.writeSFixed64(P[G])}h(L,"writePackedSFixed64");function D(P,U){return(P[U]|P[U+1]<<8|P[U+2]<<16)+P[U+3]*16777216}h(D,"readUInt32");function B(P,U,G){P[G]=U,P[G+1]=U>>>8,P[G+2]=U>>>16,P[G+3]=U>>>24}h(B,"writeInt32");function A(P,U){return(P[U]|P[U+1]<<8|P[U+2]<<16)+(P[U+3]<<24)}h(A,"readInt32");function k(P,U,G){for(var K="",O=U;O<G;){var V=P[O],j=null,q=V>239?4:V>223?3:V>191?2:1;if(O+q>G)break;var ee,ae,N;q===1?V<128&&(j=V):q===2?(ee=P[O+1],(ee&192)===128&&(j=(V&31)<<6|ee&63,j<=127&&(j=null))):q===3?(ee=P[O+1],ae=P[O+2],(ee&192)===128&&(ae&192)===128&&(j=(V&15)<<12|(ee&63)<<6|ae&63,(j<=2047||j>=55296&&j<=57343)&&(j=null))):q===4&&(ee=P[O+1],ae=P[O+2],N=P[O+3],(ee&192)===128&&(ae&192)===128&&(N&192)===128&&(j=(V&15)<<18|(ee&63)<<12|(ae&63)<<6|N&63,(j<=65535||j>=1114112)&&(j=null))),j===null?(j=65533,q=1):j>65535&&(j-=65536,K+=String.fromCharCode(j>>>10&1023|55296),j=56320|j&1023),K+=String.fromCharCode(j),O+=q}return K}h(k,"readUtf8");function $(P,U,G){return s.decode(P.subarray(U,G))}h($,"readUtf8TextDecoder");function z(P,U,G){for(var K=0,O,V;K<U.length;K++){if(O=U.charCodeAt(K),O>55295&&O<57344)if(V)if(O<56320){P[G++]=239,P[G++]=191,P[G++]=189,V=O;continue}else O=V-55296<<10|O-56320|65536,V=null;else{O>56319||K+1===U.length?(P[G++]=239,P[G++]=191,P[G++]=189):V=O;continue}else V&&(P[G++]=239,P[G++]=191,P[G++]=189,V=null);O<128?P[G++]=O:(O<2048?P[G++]=O>>6|192:(O<65536?P[G++]=O>>12|224:(P[G++]=O>>18|240,P[G++]=O>>12&63|128),P[G++]=O>>6&63|128),P[G++]=O&63|128)}return G}h(z,"writeUtf8")});R();var fD={name:"@packages/outdoor-context-v4",version:"4.1.3",private:!0,main:"dist/maplibre-gl.js",style:"dist/maplibre-gl.css",license:"BSD-3-Clause",homepage:"https://maplibre.org/",funding:"https://github.com/maplibre/maplibre-gl-js?sponsor=1",bugs:{url:"https://github.com/maplibre/maplibre-gl-js/issues/"},repository:{type:"git",url:"git://github.com/maplibre/maplibre-gl-js.git"},types:"dist/maplibre-gl.d.ts",type:"module",dependencies:{"@mapbox/geojson-rewind":"^0.5.2","@mapbox/jsonlint-lines-primitives":"^2.0.2","@mapbox/point-geometry":"^0.1.0","@mapbox/tiny-sdf":"^2.0.6","@mapbox/unitbezier":"^0.0.1","@mapbox/vector-tile":"^1.3.1","@mapbox/whoots-js":"^3.1.0","@maplibre/maplibre-gl-style-spec":"^20.1.1","@types/geojson":"^7946.0.14","@types/geojson-vt":"3.2.5","@types/junit-report-builder":"^3.0.2","@types/mapbox__point-geometry":"^0.1.4","@types/mapbox__vector-tile":"^1.3.4","@types/pbf":"^3.0.5","@types/supercluster":"^7.1.3",earcut:"^2.2.4","geojson-vt":"^3.2.1","gl-matrix":"^3.4.3","global-prefix":"^3.0.0",kdbush:"^4.0.2","murmurhash-js":"^1.0.0",pbf:"^3.2.1",potpack:"^2.0.0",quickselect:"^2.0.0",supercluster:"^8.0.1",tinyqueue:"^2.0.3","vt-pbf":"^3.1.3"},devDependencies:{"@mapbox/mapbox-gl-rtl-text":"^0.2.3","@mapbox/mvt-fixtures":"^3.10.0","@rollup/plugin-commonjs":"^25.0.7","@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-replace":"^5.0.5","@rollup/plugin-strip":"^3.0.4","@rollup/plugin-terser":"^0.4.4","@rollup/plugin-typescript":"^11.1.6","@types/benchmark":"^2.1.5","@types/cssnano":"^5.0.0","@types/d3":"^7.4.3","@types/diff":"^5.2.0","@types/earcut":"^2.1.4","@types/eslint":"^8.56.7","@types/gl":"^6.0.5","@types/glob":"^8.1.0","@types/jest":"^29.5.12","@types/jsdom":"^21.1.6","@types/minimist":"^1.2.5","@types/murmurhash-js":"^1.0.6","@types/nise":"^1.4.4","@types/node":"^20.12.7","@types/offscreencanvas":"^2019.7.3","@types/pixelmatch":"^5.2.6","@types/pngjs":"^6.0.4","@types/react":"^18.2.79","@types/react-dom":"^18.2.25","@types/request":"^2.48.12","@types/shuffle-seed":"^1.1.3","@types/window-or-global":"^1.0.6","@typescript-eslint/eslint-plugin":"^7.7.1","@typescript-eslint/parser":"^7.7.1",address:"^2.0.2",benchmark:"^2.1.4",canvas:"^2.11.2",cssnano:"^6.1.2",d3:"^7.9.0","d3-queue":"^3.0.7","devtools-protocol":"^0.0.1291694",diff:"^5.2.0","dts-bundle-generator":"^9.5.1",eslint:"^8.57.0","eslint-config-mourner":"^3.0.0","eslint-plugin-html":"^8.1.1","eslint-plugin-import":"^2.29.1","eslint-plugin-jest":"^28.2.0","eslint-plugin-react":"^7.34.1","eslint-plugin-tsdoc":"0.2.17",expect:"^29.7.0",glob:"^10.3.12","is-builtin-module":"^3.2.1",jest:"^29.7.0","jest-environment-jsdom":"^29.7.0","jest-junit":"^16.0.0","jest-monocart-coverage":"^1.1.0","jest-webgl-canvas-mock":"^2.5.3",jsdom:"^24.0.0","json-stringify-pretty-compact":"^4.0.0","junit-report-builder":"^3.2.1",minimist:"^1.2.8","mock-geolocation":"^1.0.11","monocart-coverage-reports":"^2.7.9",nise:"^5.1.9","npm-font-open-sans":"^1.1.0","npm-run-all":"^4.1.5","pdf-merger-js":"^5.1.1",pixelmatch:"^5.3.0",pngjs:"^7.0.0",postcss:"^8.4.38","postcss-cli":"^11.0.0","postcss-inline-svg":"^6.0.0","pretty-bytes":"^6.1.1",puppeteer:"^22.7.0",react:"^18.2.0","react-dom":"^18.2.0",rollup:"^4.16.4","rollup-plugin-sourcemaps":"^0.6.3",rw:"^1.3.3",semver:"^7.6.0","shuffle-seed":"^1.1.6","source-map-explorer":"^2.5.3",st:"^3.0.0",stylelint:"^16.4.0","stylelint-config-standard":"^36.0.0","ts-jest":"^29.1.2","ts-node":"^10.9.2",tslib:"^2.6.2",typedoc:"^0.25.13","typedoc-plugin-markdown":"^3.17.1","typedoc-plugin-missing-exports":"^2.2.0",typescript:"^5.4.5"},overrides:{"postcss-inline-svg":{"css-select":"^5.1.0","dom-serializer":"^2.0.0",htmlparser2:"^8.0.1","postcss-value-parser":"^4.2.0"}},scripts:{"generate-dist-package":"node --no-warnings --loader ts-node/esm build/generate-dist-package.js","generate-shaders":"node --no-warnings --loader ts-node/esm build/generate-shaders.ts","generate-struct-arrays":"node --no-warnings --loader ts-node/esm build/generate-struct-arrays.ts","generate-style-code":"node --no-warnings --loader ts-node/esm build/generate-style-code.ts","generate-typings":"dts-bundle-generator --export-referenced-types --umd-module-name=maplibregl -o ./dist/maplibre-gl.d.ts ./src/index.ts","generate-docs":"typedoc && node --no-warnings --loader ts-node/esm build/generate-docs.ts","generate-images":"node --no-warnings --loader ts-node/esm build/generate-doc-images.ts","build-dist":"npm run build-css && npm run generate-typings && npm run build-dev && npm run build-csp-dev && npm run build-prod && npm run build-csp","build-dev":"rollup --configPlugin @rollup/plugin-typescript -c --environment BUILD:dev","watch-dev":"rollup --configPlugin @rollup/plugin-typescript -c --environment BUILD:dev --watch","build-prod":"rollup --configPlugin @rollup/plugin-typescript -c --environment BUILD:production","build-csp":"rollup --configPlugin @rollup/plugin-typescript -c rollup.config.csp.ts","build-csp-dev":"rollup --configPlugin @rollup/plugin-typescript -c rollup.config.csp.ts --environment BUILD:dev","build-css":"postcss -o dist/maplibre-gl.css src/css/maplibre-gl.css","watch-css":"postcss --watch -o dist/maplibre-gl.css src/css/maplibre-gl.css","build-benchmarks":"npm run build-dev && rollup --configPlugin @rollup/plugin-typescript -c test/bench/rollup_config_benchmarks.ts","watch-benchmarks":"rollup --configPlugin @rollup/plugin-typescript -c test/bench/rollup_config_benchmarks.ts --watch","start-server":"st --no-cache -H 0.0.0.0 --port 9966 .","start-docs":"docker run --rm -it -p 8000:8000 -v ${PWD}:/docs squidfunk/mkdocs-material",start:"run-p watch-css watch-dev start-server","start-bench":"run-p watch-css watch-benchmarks start-server",lint:"eslint --cache --ext .ts,.tsx,.js,.html --ignore-path .gitignore .","lint-css":"stylelint src/css/maplibre-gl.css",test:"run-p lint lint-css test-render jest",jest:"jest","test-build":"jest --selectProjects=build --reporters=default","test-build-ci":"jest --selectProjects=build","test-integration":"jest --selectProjects=integration --reporters=default","test-integration-ci":"jest --selectProjects=integration","test-render":"node --no-warnings --loader ts-node/esm test/integration/render/run_render_tests.ts","test-unit":"jest --selectProjects=unit --reporters=default","test-unit-ci":"jest --coverage --selectProjects unit","test-watch-roots":"jest --watch",codegen:"run-p --print-label generate-dist-package generate-style-code generate-struct-arrays generate-shaders && npm run generate-typings",benchmark:"node --no-warnings --loader ts-node/esm test/bench/run-benchmarks.ts","gl-stats":"node --no-warnings --loader ts-node/esm test/bench/gl-stats.ts",prepare:"npm run codegen",typecheck:"tsc --noEmit && tsc --project tsconfig.dist.json",tsnode:"node --experimental-loader=ts-node/esm --no-warnings"},files:["build/","dist/*","src/"],engines:{npm:">=8.1.0",node:">=16.14.0"}};R();R();var bue=kt(gi(),1),wue=kt(gue(),1);R();R();var T2;function RE(){return T2==null&&(T2=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),T2}h(RE,"offscreenCanvasSupported");var r1;function mD(){if(r1==null&&(r1=!1,RE())){let i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let t=0;t<5*5;t++){let r=t*4;i.fillStyle=`rgb(${r},${r+1},${r+2})`,i.fillRect(t%5,Math.floor(t/5),1,1)}let e=i.getImageData(0,0,5,5).data;for(let t=0;t<5*5*4;t++)if(t%4!==3&&e[t]!==t){r1=!0;break}}}return r1||!1}h(mD,"isOffscreenCanvasDistorted");function gD(i){if(i<=0)return 0;if(i>=1)return 1;let e=i*i,t=e*i;return 4*(i<.5?t:3*(i-e)+t-.75)}h(gD,"easeCubicInOut");function zx(i,e,t,r){let n=new wue.default(i,e,t,r);return function(a){return n.solve(a)}}h(zx,"bezier");var Vw=zx(.25,.1,.25,1);function Lr(i,e,t){return Math.min(t,Math.max(e,i))}h(Lr,"clamp");function Bu(i,e,t){let r=t-e,n=((i-e)%r+r)%r+e;return n===e?t:n}h(Bu,"wrap");function yD(i,e){let t=[];for(let r in i)r in e||t.push(r);return t}h(yD,"keysDifference");function pt(i,...e){for(let t of e)for(let r in t)i[r]=t[r];return i}h(pt,"extend");function hg(i,e){let t={};for(let r=0;r<e.length;r++){let n=e[r];n in i&&(t[n]=i[n])}return t}h(hg,"pick");var Sue=1;function FE(){return Sue++}h(FE,"uniqueId");function vD(i){return Math.log(i)/Math.LN2%1===0}h(vD,"isPowerOfTwo");function xD(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}h(xD,"nextPowerOfTwo");function Nx(i,e,t){let r={};for(let n in i)r[n]=e.call(t||this,i[n],n,i);return r}h(Nx,"mapObject");function OE(i,e,t){let r={};for(let n in i)e.call(t||this,i[n],n,i)&&(r[n]=i[n]);return r}h(OE,"filterObject");function Cl(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Cl(i[t],e[t]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(let t in i)if(!Cl(i[t],e[t]))return!1;return!0}return i===e}h(Cl,"deepEqual");function da(i){return Array.isArray(i)?i.map(da):typeof i=="object"&&i?Nx(i,da):i}h(da,"clone");function _D(i,e){for(let t=0;t<i.length;t++)if(e.indexOf(i[t])>=0)return!0;return!1}h(_D,"arraysIntersect");var ZA={};function dn(i){ZA[i]||(typeof console<"u"&&console.warn(i),ZA[i]=!0)}h(dn,"warnOnce");function Ls(i,e,t){return(t.y-i.y)*(e.x-i.x)>(e.y-i.y)*(t.x-i.x)}h(Ls,"isCounterClockwise");function bD(i,e,t,r){let n=e.y-i.y,a=e.x-i.x,o=r.y-t.y,s=r.x-t.x,l=o*a-s*n;if(l===0)return null;let u=i.y-t.y,c=i.x-t.x,p=(s*u-o*c)/l;return new bue.default(i.x+p*a,i.y+p*n)}h(bD,"findLineIntersection");function wD(i){let e=0;for(let t=0,r=i.length,n=r-1,a,o;t<r;n=t++)a=i[t],o=i[n],e+=(o.x-a.x)*(a.y+o.y);return e}h(wD,"calculateSignedArea");function SD([i,e,t]){return e+=90,e*=Math.PI/180,t*=Math.PI/180,{x:i*Math.cos(e)*Math.sin(t),y:i*Math.sin(e)*Math.sin(t),z:i*Math.cos(t)}}h(SD,"sphericalToCartesian");function sh(i){return typeof WorkerGlobalScope<"u"&&typeof i<"u"&&i instanceof WorkerGlobalScope}h(sh,"isWorker");function MD(i){let e=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,t={};if(i.replace(e,(r,n,a,o)=>{let s=a||o;return t[n]=s?s.toLowerCase():!0,""}),t["max-age"]){let r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}h(MD,"parseCacheControl");var P2=null;function CD(i){if(P2==null){let e=i.navigator?i.navigator.userAgent:null;P2=!!i.safari||!!(e&&(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return P2}h(CD,"isSafari");function qo(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}h(qo,"isImageBitmap");var Mue=h(async i=>{if(i.byteLength===0)return createImageBitmap(new ImageData(1,1));let e=new Blob([new Uint8Array(i)],{type:"image/png"});try{return createImageBitmap(e)}catch(t){throw new Error(`Could not load image because of ${t.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}},"arrayBufferToImageBitmap"),YA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",Cue=h(i=>new Promise((e,t)=>{let r=new Image;r.onload=()=>{e(r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(()=>{r.src=YA})},r.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let n=new Blob([new Uint8Array(i)],{type:"image/png"});r.src=i.byteLength?URL.createObjectURL(n):YA}),"arrayBufferToImage");function ED(i,e,t,r,n){let a=Math.max(-e,0)*4,o=(Math.max(0,t)-t)*r*4+a,s=r*4,l=Math.max(0,e),u=Math.max(0,t),c=Math.min(i.width,e+r),p=Math.min(i.height,t+n);return{rect:{x:l,y:u,width:c-l,height:p-u},layout:[{offset:o,stride:s}]}}h(ED,"computeVideoFrameParameters");async function TD(i,e,t,r,n){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let a=new VideoFrame(i,{timestamp:0});try{let o=a==null?void 0:a.format;if(!o||!(o.startsWith("BGR")||o.startsWith("RGB")))throw new Error(`Unrecognized format ${o}`);let s=o.startsWith("BGR"),l=new Uint8ClampedArray(r*n*4);if(await a.copyTo(l,ED(i,e,t,r,n)),s)for(let u=0;u<l.length;u+=4){let c=l[u];l[u]=l[u+2],l[u+2]=c}return l}finally{a.close()}}h(TD,"readImageUsingVideoFrame");function PD(i,e,t,r){return i.addEventListener(e,t,r),{unsubscribe:()=>{i.removeEventListener(e,t,r)}}}h(PD,"subscribe");function jw(i){return i*Math.PI/180}h(jw,"degreesToRadians");R();R();var Eue="AbortError";function cg(){return new Error(Eue)}h(cg,"createAbortError");var Tue=typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),n1,A2,li={now:Tue,frameAsync(i){return new Promise((e,t)=>{let r=requestAnimationFrame(e);i.signal.addEventListener("abort",()=>{cancelAnimationFrame(r),t(cg())})})},getImageData(i,e=0){return this.getImageCanvasContext(i).getImageData(-e,-e,i.width+2*e,i.height+2*e)},getImageCanvasContext(i){let e=window.document.createElement("canvas"),t=e.getContext("2d",{willReadFrequently:!0});if(!t)throw new Error("failed to create canvas 2d context");return e.width=i.width,e.height=i.height,t.drawImage(i,0,0,i.width,i.height),t},resolveURL(i){return n1||(n1=document.createElement("a")),n1.href=i,n1.href},hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return matchMedia?(A2==null&&(A2=matchMedia("(prefers-reduced-motion: reduce)")),A2.matches):!1}};R();var Pue=kt(gi(),1),gu=class Ki{static testProp(e){if(!Ki.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in Ki.docStyle)return e[t];return e[0]}static create(e,t,r){let n=window.document.createElement(e);return t!==void 0&&(n.className=t),r&&r.appendChild(n),n}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){Ki.docStyle&&Ki.selectProp&&(Ki.userSelect=Ki.docStyle[Ki.selectProp],Ki.docStyle[Ki.selectProp]="none")}static enableDrag(){Ki.docStyle&&Ki.selectProp&&(Ki.docStyle[Ki.selectProp]=Ki.userSelect)}static setTransform(e,t){e.style[Ki.transformProp]=t}static addEventListener(e,t,r,n={}){"passive"in n?e.addEventListener(t,r,n):e.addEventListener(t,r,n.capture)}static removeEventListener(e,t,r,n={}){"passive"in n?e.removeEventListener(t,r,n):e.removeEventListener(t,r,n.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",Ki.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Ki.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",Ki.suppressClickInternal,!0)},0)}static getScale(e){let t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,t,r){let n=t.boundingClientRect;return new Pue.default((r.clientX-n.left)/t.x-e.clientLeft,(r.clientY-n.top)/t.y-e.clientTop)}static mousePos(e,t){let r=Ki.getScale(e);return Ki.getPoint(e,r,t)}static touchPos(e,t){let r=[],n=Ki.getScale(e);for(let a=0;a<t.length;a++)r.push(Ki.getPoint(e,n,t[a]));return r}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}};h(gu,"DOM"),gu.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,gu.selectProp=gu.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),gu.transformProp=gu.testProp(["transform","WebkitTransform"]);var He=gu;R();R();R();var Co={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function BE(i){return Co.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))]}h(BE,"getProtocol");function Aue(i,e){Co.REGISTERED_PROTOCOLS[i]=e}h(Aue,"addProtocol");function Iue(i){delete Co.REGISTERED_PROTOCOLS[i]}h(Iue,"removeProtocol");R();var Hw="global-dispatcher",AD=class extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=n}};h(AD,"AJAXError");var zE=AD,NE=h(()=>sh(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,"getReferrer"),Lue=h(i=>/^file:/.test(i)||/^file:/.test(NE())&&!/^\w+:/.test(i),"isFileURL");async function ID(i,e){let t=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,cache:i.cache,referrer:NE(),signal:e.signal});i.type==="json"&&t.headers.set("Accept","application/json");let r=await fetch(t);if(!r.ok){let o=await r.blob();throw new zE(r.status,r.statusText,i.url,o)}let n;i.type==="arrayBuffer"||i.type==="image"?n=r.arrayBuffer():i.type==="json"?n=r.json():n=r.text();let a=await n;if(e.signal.aborted)throw cg();return{data:a,cacheControl:r.headers.get("Cache-Control"),expires:r.headers.get("Expires")}}h(ID,"makeFetchRequest");function LD(i,e){return new Promise((t,r)=>{let n=new XMLHttpRequest;n.open(i.method||"GET",i.url,!0),(i.type==="arrayBuffer"||i.type==="image")&&(n.responseType="arraybuffer");for(let a in i.headers)n.setRequestHeader(a,i.headers[a]);i.type==="json"&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials=i.credentials==="include",n.onerror=()=>{r(new Error(n.statusText))},n.onload=()=>{if(!e.signal.aborted)if((n.status>=200&&n.status<300||n.status===0)&&n.response!==null){let a=n.response;if(i.type==="json")try{a=JSON.parse(n.response)}catch(o){r(o);return}t({data:a,cacheControl:n.getResponseHeader("Cache-Control"),expires:n.getResponseHeader("Expires")})}else{let a=new Blob([n.response],{type:n.getResponseHeader("Content-Type")});r(new zE(n.status,n.statusText,i.url,a))}},e.signal.addEventListener("abort",()=>{n.abort(),r(cg())}),n.send(i.body)})}h(LD,"makeXMLHttpRequest");var $x=h(function(i,e){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){let t=BE(i.url);if(t)return t(i,e);if(sh(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,targetMapId:Hw},e)}if(!Lue(i.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return ID(i,e);if(sh(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:i,mustQueue:!0,targetMapId:Hw},e)}return LD(i,e)},"makeRequest"),Ux=h((i,e)=>$x(pt(i,{type:"json"}),e),"getJSON"),Due=h((i,e)=>$x(pt(i,{type:"arrayBuffer"}),e),"getArrayBuffer");function $E(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;let e=new URL(i),t=window.location;return e.protocol===t.protocol&&e.host===t.host}h($E,"sameOrigin");var kue=h(i=>{let e=window.document.createElement("video");return e.muted=!0,new Promise(t=>{e.onloadstart=()=>{t(e)};for(let r of i){let n=window.document.createElement("source");$E(r)||(e.crossOrigin="Anonymous"),n.src=r,e.appendChild(n)}})},"getVideo");R();R();var UE={supported:!1,testSupport:kD},lf,VE=!1,ip,DD=!1;typeof document<"u"&&(ip=document.createElement("img"),ip.onload=function(){lf&&jE(lf),lf=null,DD=!0},ip.onerror=function(){VE=!0,lf=null},ip.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function kD(i){VE||!ip||(DD?jE(i):lf=i)}h(kD,"testSupport");function jE(i){let e=i.createTexture();i.bindTexture(i.TEXTURE_2D,e);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,ip),i.isContextLost())return;UE.supported=!0}catch{}i.deleteTexture(e),VE=!0}h(jE,"testWebpTextureUpload");var Zo;(i=>{let e,t,r,n;i.resetRequestQueue=h(()=>{e=[],t=0,r=0,n={}},"resetRequestQueue"),i.addThrottleControl=h(c=>{let p=r++;return n[p]=c,p},"addThrottleControl"),i.removeThrottleControl=h(c=>{delete n[c],l()},"removeThrottleControl");let a=h(()=>{for(let c of Object.keys(n))if(n[c]())return!0;return!1},"isThrottled");i.getImage=h((c,p,d=!0)=>new Promise((m,g)=>{UE.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),pt(c,{type:"image"});let _={abortController:p,requestParameters:c,supportImageRefresh:d,state:"queued",onError:y=>{g(y)},onSuccess:y=>{m(y)}};e.push(_),l()}),"getImage");let o=h(c=>typeof createImageBitmap=="function"?Mue(c):Cue(c),"arrayBufferToCanvasImageSource"),s=h(async c=>{c.state="running";let{requestParameters:p,supportImageRefresh:d,onError:m,onSuccess:g,abortController:_}=c,y=d===!1&&!sh(self)&&!BE(p.url)&&(!p.headers||Object.keys(p.headers).reduce((w,b)=>w&&b==="accept",!0));t++;let x=y?u(p,_):$x(p,_);try{let w=await x;if(delete c.abortController,c.state="completed",w.data instanceof HTMLImageElement||qo(w.data))g(w);else if(w.data){let b=await o(w.data);g({data:b,cacheControl:w.cacheControl,expires:w.expires})}}catch(w){delete c.abortController,m(w)}finally{t--,l()}},"doImageRequest"),l=h(()=>{let c=a()?Co.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:Co.MAX_PARALLEL_IMAGE_REQUESTS;for(let p=t;p<c&&e.length>0;p++){let d=e.shift();if(d.abortController.signal.aborted){p--;continue}s(d)}},"processQueue"),u=h((c,p)=>new Promise((d,m)=>{let g=new Image,_=c.url,y=c.credentials;y&&y==="include"?g.crossOrigin="use-credentials":(y&&y==="same-origin"||!$E(_))&&(g.crossOrigin="anonymous"),p.signal.addEventListener("abort",()=>{g.src="",m(cg())}),g.fetchPriority="high",g.onload=()=>{g.onerror=g.onload=null,d({data:g})},g.onerror=()=>{g.onerror=g.onload=null,!p.signal.aborted&&m(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},g.src=_}),"getImageUsingHtmlImage")})(Zo||(Zo={}));Zo.resetRequestQueue();R();var RD=class{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn?this._transformRequestFn(e,t)||{url:e}:{url:e}}normalizeSpriteURL(e,t,r){let n=FD(e);return n.path+=`${t}${r}`,OD(n)}setTransformRequest(e){this._transformRequestFn=e}};h(RD,"RequestManager");var Rue=RD,Fue=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function FD(i){let e=i.match(Fue);if(!e)throw new Error(`Unable to parse URL "${i}"`);return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}h(FD,"parseUrl");function OD(i){let e=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${e}`}h(OD,"formatUrl");R();R();function Gw(i,e,t){t[i]&&t[i].indexOf(e)!==-1||(t[i]=t[i]||[],t[i].push(e))}h(Gw,"_addEventListener");function by(i,e,t){if(t&&t[i]){let r=t[i].indexOf(e);r!==-1&&t[i].splice(r,1)}}h(by,"_removeEventListener");var BD=class{constructor(e,t={}){pt(this,t),this.type=e}};h(BD,"Event");var Ye=BD,zD=class extends Ye{constructor(e,t={}){super("error",pt({error:e},t))}};h(zD,"ErrorEvent");var Et=zD,ND=class{on(e,t){return this._listeners=this._listeners||{},Gw(e,t,this._listeners),this}off(e,t){return by(e,t,this._listeners),by(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},Gw(e,t,this._oneTimeListeners),this):new Promise(r=>this.once(e,r))}fire(e,t){typeof e=="string"&&(e=new Ye(e,t||{}));let r=e.type;if(this.listens(r)){e.target=this;let n=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(let s of n)s.call(this,e);let a=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(let s of a)by(r,s,this._oneTimeListeners),s.call(this,e);let o=this._eventedParent;o&&(pt(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),o.fire(e))}else e instanceof Et&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}};h(ND,"Evented");var mn=ND;R();R();R();R();var Oue=8,Bue={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},zue={"*":{type:"source"}},Nue=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],$ue={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Uue={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Vue={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},jue={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Hue={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Gue={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Wue={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Xue=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],que={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Zue={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Yue={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Jue={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Kue={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Que={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ehe={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},the={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ihe={type:"array",value:"*"},rhe={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},nhe={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},ahe={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},ohe={type:"array",value:"*",minimum:1},she={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},lhe={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},uhe={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},hhe={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},che=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],phe={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},dhe={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},fhe={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},mhe={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ghe={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},yhe={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},vhe={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},xhe={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},_he={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},bhe={"*":{type:"string"}},Le={$version:Oue,$root:Bue,sources:zue,source:Nue,source_vector:$ue,source_raster:Uue,source_raster_dem:Vue,source_geojson:jue,source_video:Hue,source_image:Gue,layer:Wue,layout:Xue,layout_background:que,layout_fill:Zue,layout_circle:Yue,layout_heatmap:Jue,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Kue,layout_symbol:Que,layout_raster:ehe,layout_hillshade:the,filter:ihe,filter_operator:rhe,geometry_type:nhe,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:ahe,expression:ohe,light:she,sky:lhe,terrain:uhe,projection:hhe,paint:che,paint_fill:phe,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:dhe,paint_circle:fhe,paint_heatmap:mhe,paint_symbol:ghe,paint_raster:yhe,paint_hillshade:vhe,paint_background:xhe,transition:_he,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:bhe},whe=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function $D(i,e){let t={};for(let r in i)r!=="ref"&&(t[r]=i[r]);return whe.forEach(r=>{r in e&&(t[r]=e[r])}),t}h($D,"deref");function Ww(i){i=i.slice();let e=Object.create(null);for(let t=0;t<i.length;t++)e[i[t].id]=i[t];for(let t=0;t<i.length;t++)"ref"in i[t]&&(i[t]=$D(i[t],e[i[t].ref]));return i}h(Ww,"derefLayers");function wi(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!wi(i[t],e[t]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(let t in i)if(!wi(i[t],e[t]))return!1;return!0}return i===e}h(wi,"deepEqual");function la(i,e){i.push(e)}h(la,"addCommand");function HE(i,e,t){la(t,{command:"addSource",args:[i,e[i]]})}h(HE,"addSource");function GE(i,e,t){la(e,{command:"removeSource",args:[i]}),t[i]=!0}h(GE,"removeSource");function UD(i,e,t,r){GE(i,t,r),HE(i,e,t)}h(UD,"updateSource");function VD(i,e,t){let r;for(r in i[t])if(Object.prototype.hasOwnProperty.call(i[t],r)&&r!=="data"&&!wi(i[t][r],e[t][r]))return!1;for(r in e[t])if(Object.prototype.hasOwnProperty.call(e[t],r)&&r!=="data"&&!wi(i[t][r],e[t][r]))return!1;return!0}h(VD,"canUpdateGeoJSON");function jD(i,e,t,r){i=i||{},e=e||{};let n;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(Object.prototype.hasOwnProperty.call(e,n)||GE(n,t,r));for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(Object.prototype.hasOwnProperty.call(i,n)?wi(i[n],e[n])||(i[n].type==="geojson"&&e[n].type==="geojson"&&VD(i,e,n)?la(t,{command:"setGeoJSONSourceData",args:[n,e[n].data]}):UD(n,e,t,r)):HE(n,e,t))}h(jD,"diffSources");function uf(i,e,t,r,n,a){i=i||{},e=e||{};for(let o in i)Object.prototype.hasOwnProperty.call(i,o)&&(wi(i[o],e[o])||t.push({command:a,args:[r,o,e[o],n]}));for(let o in e)!Object.prototype.hasOwnProperty.call(e,o)||Object.prototype.hasOwnProperty.call(i,o)||wi(i[o],e[o])||t.push({command:a,args:[r,o,e[o],n]})}h(uf,"diffLayerPropertyChanges");function Xw(i){return i.id}h(Xw,"pluckId");function qw(i,e){return i[e.id]=e,i}h(qw,"indexById");function HD(i,e,t){i=i||[],e=e||[];let r=i.map(Xw),n=e.map(Xw),a=i.reduce(qw,{}),o=e.reduce(qw,{}),s=r.slice(),l=Object.create(null),u,c,p,d,m;for(let g=0,_=0;g<r.length;g++)u=r[g],Object.prototype.hasOwnProperty.call(o,u)?_++:(la(t,{command:"removeLayer",args:[u]}),s.splice(s.indexOf(u,_),1));for(let g=0,_=0;g<n.length;g++)u=n[n.length-1-g],s[s.length-1-g]!==u&&(Object.prototype.hasOwnProperty.call(a,u)?(la(t,{command:"removeLayer",args:[u]}),s.splice(s.lastIndexOf(u,s.length-_),1)):_++,d=s[s.length-g],la(t,{command:"addLayer",args:[o[u],d]}),s.splice(s.length-g,0,u),l[u]=!0);for(let g=0;g<n.length;g++)if(u=n[g],c=a[u],p=o[u],!(l[u]||wi(c,p))){if(!wi(c.source,p.source)||!wi(c["source-layer"],p["source-layer"])||!wi(c.type,p.type)){la(t,{command:"removeLayer",args:[u]}),d=s[s.lastIndexOf(u)+1],la(t,{command:"addLayer",args:[p,d]});continue}uf(c.layout,p.layout,t,u,null,"setLayoutProperty"),uf(c.paint,p.paint,t,u,null,"setPaintProperty"),wi(c.filter,p.filter)||la(t,{command:"setFilter",args:[u,p.filter]}),(!wi(c.minzoom,p.minzoom)||!wi(c.maxzoom,p.maxzoom))&&la(t,{command:"setLayerZoomRange",args:[u,p.minzoom,p.maxzoom]});for(m in c)Object.prototype.hasOwnProperty.call(c,m)&&(m==="layout"||m==="paint"||m==="filter"||m==="metadata"||m==="minzoom"||m==="maxzoom"||(m.indexOf("paint.")===0?uf(c[m],p[m],t,u,m.slice(6),"setPaintProperty"):wi(c[m],p[m])||la(t,{command:"setLayerProperty",args:[u,m,p[m]]})));for(m in p)!Object.prototype.hasOwnProperty.call(p,m)||Object.prototype.hasOwnProperty.call(c,m)||m==="layout"||m==="paint"||m==="filter"||m==="metadata"||m==="minzoom"||m==="maxzoom"||(m.indexOf("paint.")===0?uf(c[m],p[m],t,u,m.slice(6),"setPaintProperty"):wi(c[m],p[m])||la(t,{command:"setLayerProperty",args:[u,m,p[m]]}))}}h(HD,"diffLayers");function GD(i,e){if(!i)return[{command:"setStyle",args:[e]}];let t=[];try{if(!wi(i.version,e.version))return[{command:"setStyle",args:[e]}];wi(i.center,e.center)||t.push({command:"setCenter",args:[e.center]}),wi(i.zoom,e.zoom)||t.push({command:"setZoom",args:[e.zoom]}),wi(i.bearing,e.bearing)||t.push({command:"setBearing",args:[e.bearing]}),wi(i.pitch,e.pitch)||t.push({command:"setPitch",args:[e.pitch]}),wi(i.sprite,e.sprite)||t.push({command:"setSprite",args:[e.sprite]}),wi(i.glyphs,e.glyphs)||t.push({command:"setGlyphs",args:[e.glyphs]}),wi(i.transition,e.transition)||t.push({command:"setTransition",args:[e.transition]}),wi(i.light,e.light)||t.push({command:"setLight",args:[e.light]}),wi(i.terrain,e.terrain)||t.push({command:"setTerrain",args:[e.terrain]}),wi(i.sky,e.sky)||t.push({command:"setSky",args:[e.sky]}),wi(i.projection,e.projection)||t.push({command:"setProjection",args:[e.projection]});let r={},n=[];jD(i.sources,e.sources,n,r);let a=[];i.layers&&i.layers.forEach(o=>{"source"in o&&r[o.source]?t.push({command:"removeLayer",args:[o.id]}):a.push(o)}),t=t.concat(n),HD(a,e.layers,t)}catch(r){console.warn("Unable to compute style diff:",r),t=[{command:"setStyle",args:[e]}]}return t}h(GD,"diffStyles");var WD=class{constructor(e,t,r,n){this.message=(e?`${e}: `:"")+r,n&&(this.identifier=n),t!=null&&t.__line__&&(this.line=t.__line__)}};h(WD,"ValidationError");var Qe=WD;function lh(i,...e){for(let t of e)for(let r in t)i[r]=t[r];return i}h(lh,"extendBy");var XD=class extends Error{constructor(e,t){super(t),this.message=t,this.key=e}};h(XD,"ExpressionParsingError");var Go=XD,qD=class ZD{constructor(e,t=[]){this.parent=e,this.bindings={};for(let[r,n]of t)this.bindings[r]=n}concat(e){return new ZD(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return this.bindings[e]?!0:this.parent?this.parent.has(e):!1}};h(qD,"Scope");var She=qD,pg={kind:"null"},nt={kind:"number"},ti={kind:"string"},Zt={kind:"boolean"},So={kind:"color"},yp={kind:"object"},Yt={kind:"value"},Mhe={kind:"error"},Vx={kind:"collator"},dg={kind:"formatted"},jx={kind:"padding"},fg={kind:"resolvedImage"},Hx={kind:"variableAnchorOffsetCollection"};function Hn(i,e){return{kind:"array",itemType:i,N:e}}h(Hn,"array$1");function Ni(i){if(i.kind==="array"){let e=Ni(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}else return i.kind}h(Ni,"toString$1");var Che=[pg,nt,ti,Zt,So,dg,yp,Hn(Yt),jx,fg,Hx];function Hp(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Hp(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(let t of Che)if(!Hp(t,e))return null}}return`Expected ${Ni(i)} but found ${Ni(e)} instead.`}h(Hp,"checkSubtype");function Gx(i,e){return e.some(t=>t.kind===i.kind)}h(Gx,"isValidType");function Gp(i,e){return e.some(t=>t==="null"?i===null:t==="array"?Array.isArray(i):t==="object"?i&&!Array.isArray(i)&&typeof i=="object":t===typeof i)}h(Gp,"isValidNativeType");function ac(i,e){return i.kind==="array"&&e.kind==="array"?i.itemType.kind===e.itemType.kind&&typeof i.N=="number":i.kind===e.kind}h(ac,"verifyType");var YD=.96422,JD=1,KD=.82521,QD=4/29,vp=6/29,ek=3*vp*vp,Ehe=vp*vp*vp,The=Math.PI/180,Phe=180/Math.PI;function WE(i){return i=i%360,i<0&&(i+=360),i}h(WE,"constrainAngle");function XE([i,e,t,r]){i=wy(i),e=wy(e),t=wy(t);let n,a,o=Sy((.2225045*i+.7168786*e+.0606169*t)/JD);i===e&&e===t?n=a=o:(n=Sy((.4360747*i+.3850649*e+.1430804*t)/YD),a=Sy((.0139322*i+.0971045*e+.7141733*t)/KD));let s=116*o-16;return[s<0?0:s,500*(n-o),200*(o-a),r]}h(XE,"rgbToLab");function wy(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}h(wy,"rgb2xyz");function Sy(i){return i>Ehe?Math.pow(i,1/3):i/ek+QD}h(Sy,"xyz2lab");function qE([i,e,t,r]){let n=(i+16)/116,a=isNaN(e)?n:n+e/500,o=isNaN(t)?n:n-t/200;return n=JD*Cy(n),a=YD*Cy(a),o=KD*Cy(o),[My(3.1338561*a-1.6168667*n-.4906146*o),My(-.9787684*a+1.9161415*n+.033454*o),My(.0719453*a-.2289914*n+1.4052427*o),r]}h(qE,"labToRgb");function My(i){return i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055,i<0?0:i>1?1:i}h(My,"xyz2rgb");function Cy(i){return i>vp?i*i*i:ek*(i-QD)}h(Cy,"lab2xyz");function tk(i){let[e,t,r,n]=XE(i),a=Math.sqrt(t*t+r*r);return[Math.round(a*1e4)?WE(Math.atan2(r,t)*Phe):NaN,a,e,n]}h(tk,"rgbToHcl");function ik([i,e,t,r]){return i=isNaN(i)?0:i*The,qE([t,Math.cos(i)*e,Math.sin(i)*e,r])}h(ik,"hclToRgb");function rk([i,e,t,r]){i=WE(i),e/=100,t/=100;function n(a){let o=(a+i/30)%12,s=e*Math.min(t,1-t);return t-s*Math.max(-1,Math.min(o-3,9-o,1))}return h(n,"f"),[n(0),n(8),n(4),r]}h(rk,"hslToRgb");function nk(i){if(i=i.toLowerCase().trim(),i==="transparent")return[0,0,0,0];let e=Ahe[i];if(e){let[n,a,o]=e;return[n/255,a/255,o/255,1]}if(i.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(i)){let n=i.length<6?1:2,a=1;return[hf(i.slice(a,a+=n)),hf(i.slice(a,a+=n)),hf(i.slice(a,a+=n)),hf(i.slice(a,a+n)||"ff")]}if(i.startsWith("rgb")){let n=/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,a=i.match(n);if(a){let[o,s,l,u,c,p,d,m,g,_,y,x]=a,w=[u||" ",d||" ",_].join("");if(w==="  "||w==="  /"||w===",,"||w===",,,"){let b=[l,p,g].join(""),C=b==="%%%"?100:b===""?255:0;if(C){let E=[Au(+s/C,0,1),Au(+c/C,0,1),Au(+m/C,0,1),y?Zw(+y,x):1];if(Yw(E))return E}}return}}let t=/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/,r=i.match(t);if(r){let[n,a,o,s,l,u,c,p,d]=r,m=[o||" ",l||" ",c].join("");if(m==="  "||m==="  /"||m===",,"||m===",,,"){let g=[+a,Au(+s,0,100),Au(+u,0,100),p?Zw(+p,d):1];if(Yw(g))return rk(g)}}}h(nk,"parseCssColor");function hf(i){return parseInt(i.padEnd(2,i),16)/255}h(hf,"parseHex");function Zw(i,e){return Au(e?i/100:i,0,1)}h(Zw,"parseAlpha");function Au(i,e,t){return Math.min(Math.max(e,i),t)}h(Au,"clamp");function Yw(i){return!i.some(Number.isNaN)}h(Yw,"validateNumbers");var Ahe={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},ak=class Jw{constructor(e,t,r,n=1,a=!0){this.r=e,this.g=t,this.b=r,this.a=n,a||(this.r*=n,this.g*=n,this.b*=n,n||this.overwriteGetter("rgb",[e,t,r,n]))}static parse(e){if(e instanceof Jw)return e;if(typeof e!="string")return;let t=nk(e);if(t)return new Jw(...t,!1)}get rgb(){let{r:e,g:t,b:r,a:n}=this,a=n||1/0;return this.overwriteGetter("rgb",[e/a,t/a,r/a,n])}get hcl(){return this.overwriteGetter("hcl",tk(this.rgb))}get lab(){return this.overwriteGetter("lab",XE(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){let[e,t,r,n]=this.rgb;return`rgba(${[e,t,r].map(a=>Math.round(a*255)).join(",")},${n})`}};h(ak,"Color");var zt=ak;zt.black=new zt(0,0,0,1);zt.white=new zt(1,1,1,1);zt.transparent=new zt(0,0,0,0);zt.red=new zt(1,0,0,1);var ok=class{constructor(e,t,r){e?this.sensitivity=t?"variant":"case":this.sensitivity=t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}};h(ok,"Collator");var ZE=ok,sk=class{constructor(e,t,r,n,a){this.text=e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=a}};h(sk,"FormattedSection");var Kw=sk,lk=class Ey{constructor(e){this.sections=e}static fromString(e){return new Ey([new Kw(e,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Ey?e:Ey.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}};h(lk,"Formatted");var Ns=lk,uk=class Ty{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Ty)return e;if(typeof e=="number")return new Ty([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(let t of e)if(typeof t!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]];break}return new Ty(e)}}toString(){return JSON.stringify(this.values)}};h(uk,"Padding");var js=uk,Ihe=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),hk=class Qw{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Qw)return e;if(!(!Array.isArray(e)||e.length<1||e.length%2!==0)){for(let t=0;t<e.length;t+=2){let r=e[t],n=e[t+1];if(typeof r!="string"||!Ihe.has(r)||!Array.isArray(n)||n.length!==2||typeof n[0]!="number"||typeof n[1]!="number")return}return new Qw(e)}}toString(){return JSON.stringify(this.values)}};h(hk,"VariableAnchorOffsetCollection");var bh=hk,ck=class pk{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new pk({name:e,available:!1}):null}};h(ck,"ResolvedImage");var es=ck;function YE(i,e,t,r){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255?typeof r>"u"||typeof r=="number"&&r>=0&&r<=1?null:`Invalid rgba value [${[i,e,t,r].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof r=="number"?[i,e,t,r]:[i,e,t]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}h(YE,"validateRGBA");function Wp(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof zt||i instanceof ZE||i instanceof Ns||i instanceof js||i instanceof bh||i instanceof es)return!0;if(Array.isArray(i)){for(let e of i)if(!Wp(e))return!1;return!0}else if(typeof i=="object"){for(let e in i)if(!Wp(i[e]))return!1;return!0}else return!1}h(Wp,"isValue");function wr(i){if(i===null)return pg;if(typeof i=="string")return ti;if(typeof i=="boolean")return Zt;if(typeof i=="number")return nt;if(i instanceof zt)return So;if(i instanceof ZE)return Vx;if(i instanceof Ns)return dg;if(i instanceof js)return jx;if(i instanceof bh)return Hx;if(i instanceof es)return fg;if(Array.isArray(i)){let e=i.length,t;for(let r of i){let n=wr(r);if(!t)t=n;else{if(t===n)continue;t=Yt;break}}return Hn(t||Yt,e)}else return yp}h(wr,"typeOf");function xp(i){let e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof zt||i instanceof Ns||i instanceof js||i instanceof bh||i instanceof es?i.toString():JSON.stringify(i)}h(xp,"toString");var dk=class fk{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(e.length!==2)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Wp(e[1]))return t.error("invalid value");let r=e[1],n=wr(r),a=t.expectedType;return n.kind==="array"&&n.N===0&&a&&a.kind==="array"&&(typeof a.N!="number"||a.N===0)&&(n=a),new fk(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}};h(dk,"Literal");var Om=dk,mk=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};h(mk,"RuntimeError");var Sr=mk,a1={string:ti,number:nt,boolean:Zt,object:yp},gk=class yk{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=1,n,a=e[0];if(a==="array"){let s;if(e.length>2){let u=e[1];if(typeof u!="string"||!(u in a1)||u==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);s=a1[u],r++}else s=Yt;let l;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);l=e[2],r++}n=Hn(s,l)}else{if(!a1[a])throw new Error(`Types doesn't contain name = ${a}`);n=a1[a]}let o=[];for(;r<e.length;r++){let s=t.parse(e[r],r,Yt);if(!s)return null;o.push(s)}return new yk(n,o)}evaluate(e){for(let t=0;t<this.args.length;t++){let r=this.args[t].evaluate(e);if(Hp(this.type,wr(r))){if(t===this.args.length-1)throw new Sr(`Expected value to be of type ${Ni(this.type)}, but found ${Ni(wr(r))} instead.`)}else return r}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};h(gk,"Assertion");var Ts=gk,JA={"to-boolean":Zt,"to-color":So,"to-number":nt,"to-string":ti},vk=class xk{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[0];if(!JA[r])throw new Error(`Can't parse ${r} as it is not part of the known types`);if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");let n=JA[r],a=[];for(let o=1;o<e.length;o++){let s=t.parse(e[o],o,Yt);if(!s)return null;a.push(s)}return new xk(n,a)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let t,r;for(let n of this.args){if(t=n.evaluate(e),r=null,t instanceof zt)return t;if(typeof t=="string"){let a=e.parseColor(t);if(a)return a}else if(Array.isArray(t)&&(t.length<3||t.length>4?r=`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:r=YE(t[0],t[1],t[2],t[3]),!r))return new zt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Sr(r||`Could not parse color from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"padding":{let t;for(let r of this.args){t=r.evaluate(e);let n=js.parse(t);if(n)return n}throw new Sr(`Could not parse padding from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"variableAnchorOffsetCollection":{let t;for(let r of this.args){t=r.evaluate(e);let n=bh.parse(t);if(n)return n}throw new Sr(`Could not parse variableAnchorOffsetCollection from value '${typeof t=="string"?t:JSON.stringify(t)}'`)}case"number":{let t=null;for(let r of this.args){if(t=r.evaluate(e),t===null)return 0;let n=Number(t);if(!isNaN(n))return n}throw new Sr(`Could not convert ${JSON.stringify(t)} to number.`)}case"formatted":return Ns.fromString(xp(this.args[0].evaluate(e)));case"resolvedImage":return es.fromString(xp(this.args[0].evaluate(e)));default:return xp(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};h(vk,"Coercion");var rp=vk,Lhe=["Unknown","Point","LineString","Polygon"],_k=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Lhe[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=zt.parse(e)),t}};h(_k,"EvaluationContext");var bk=_k,wk=class Sk{constructor(e,t,r=[],n,a=new She,o=[]){this.registry=e,this.path=r,this.key=r.map(s=>`[${s}]`).join(""),this.scope=a,this.errors=o,this.expectedType=n,this._isConstant=t}parse(e,t,r,n,a={}){return t?this.concat(t,r,n)._parse(e,a):this._parse(e,a)}_parse(e,t){(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number")&&(e=["literal",e]);function r(n,a,o){return o==="assert"?new Ts(a,[n]):o==="coerce"?new rp(a,[n]):n}if(h(r,"annotate"),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let n=e[0];if(typeof n!="string")return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let a=this.registry[n];if(a){let o=a.parse(e,this);if(!o)return null;if(this.expectedType){let s=this.expectedType,l=o.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")o=r(o,s,t.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string"))o=r(o,s,t.typeAnnotation||"coerce");else if(s.kind==="padding"&&(l.kind==="value"||l.kind==="number"||l.kind==="array"))o=r(o,s,t.typeAnnotation||"coerce");else if(s.kind==="variableAnchorOffsetCollection"&&(l.kind==="value"||l.kind==="array"))o=r(o,s,t.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(o instanceof Om)&&o.type.kind!=="resolvedImage"&&this._isConstant(o)){let s=new bk;try{o=new Om(o.type,o.evaluate(s))}catch(l){return this.error(l.message),null}}return o}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof e>"u"?this.error("'undefined' value invalid. Use null instead."):typeof e=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error(`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){let n=typeof e=="number"?this.path.concat(e):this.path,a=r?this.scope.concat(r):this.scope;return new Sk(this.registry,this._isConstant,n,t||null,a,this.errors)}error(e,...t){let r=`${this.key}${t.map(n=>`[${n}]`).join("")}`;this.errors.push(new Go(r,e))}checkSubtype(e,t){let r=Hp(e,t);return r&&this.error(r),r}};h(wk,"ParsingContext");var Mk=wk,Ck=class Ek{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(let t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);let r=[];for(let a=1;a<e.length-1;a+=2){let o=e[a];if(typeof o!="string")return t.error(`Expected string, but found ${typeof o} instead.`,a);if(/[^a-zA-Z0-9_]/.test(o))return t.error("Variable names must contain only alphanumeric characters or '_'.",a);let s=t.parse(e[a+1],a+1);if(!s)return null;r.push([o,s])}let n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new Ek(r,n):null}outputDefined(){return this.result.outputDefined()}};h(Ck,"Let");var Tk=Ck,Pk=class Ak{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");let r=e[1];return t.scope.has(r)?new Ak(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}};h(Pk,"Var");var Ik=Pk,Lk=class Dk{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,nt),n=t.parse(e[2],2,Hn(t.expectedType||Yt));if(!r||!n)return null;let a=n.type;return new Dk(a.itemType,r,n)}evaluate(e){let t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Sr(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new Sr(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new Sr(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}};h(Lk,"At");var Dhe=Lk,kk=class Rk{constructor(e,t){this.type=Zt,this.needle=e,this.haystack=t}static parse(e,t){if(e.length!==3)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,Yt),n=t.parse(e[2],2,Yt);return!r||!n?null:Gx(r.type,[Zt,ti,nt,pg,Yt])?new Rk(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(r.type)} instead`)}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!Gp(t,["boolean","string","number","null"]))throw new Sr(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(wr(t))} instead.`);if(!Gp(r,["string","array"]))throw new Sr(`Expected second argument to be of type array or string, but found ${Ni(wr(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}};h(kk,"In");var khe=kk,Fk=class e3{constructor(e,t,r){this.type=nt,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,Yt),n=t.parse(e[2],2,Yt);if(!r||!n)return null;if(!Gx(r.type,[Zt,ti,nt,pg,Yt]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(r.type)} instead`);if(e.length===4){let a=t.parse(e[3],3,nt);return a?new e3(r,n,a):null}else return new e3(r,n)}evaluate(e){let t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!Gp(t,["boolean","string","number","null"]))throw new Sr(`Expected first argument to be of type boolean, string, number or null, but found ${Ni(wr(t))} instead.`);if(!Gp(r,["string","array"]))throw new Sr(`Expected second argument to be of type array or string, but found ${Ni(wr(r))} instead.`);if(this.fromIndex){let n=this.fromIndex.evaluate(e);return r.indexOf(t,n)}return r.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}};h(Fk,"IndexOf");var Rhe=Fk,Ok=class Bk{constructor(e,t,r,n,a,o){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=a,this.otherwise=o}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!==1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&t.expectedType.kind!=="value"&&(n=t.expectedType);let a={},o=[];for(let u=2;u<e.length-1;u+=2){let c=e[u],p=e[u+1];Array.isArray(c)||(c=[c]);let d=t.concat(u);if(c.length===0)return d.error("Expected at least one branch label.");for(let g of c){if(typeof g!="number"&&typeof g!="string")return d.error("Branch labels must be numbers or strings.");if(typeof g=="number"&&Math.abs(g)>Number.MAX_SAFE_INTEGER)return d.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof g=="number"&&Math.floor(g)!==g)return d.error("Numeric branch labels must be integer values.");if(!r)r=wr(g);else if(d.checkSubtype(r,wr(g)))return null;if(typeof a[String(g)]<"u")return d.error("Branch labels must be unique.");a[String(g)]=o.length}let m=t.parse(p,u,n);if(!m)return null;n=n||m.type,o.push(m)}let s=t.parse(e[1],1,Yt);if(!s)return null;let l=t.parse(e[e.length-1],e.length-1,n);return!l||s.type.kind!=="value"&&t.concat(1).checkSubtype(r,s.type)?null:new Bk(r,n,s,a,o,l)}evaluate(e){let t=this.input.evaluate(e);return(wr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}};h(Ok,"Match");var Fhe=Ok,zk=class Nk{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!==0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);let n=[];for(let o=1;o<e.length-1;o+=2){let s=t.parse(e[o],o,Zt);if(!s)return null;let l=t.parse(e[o+1],o+1,r);if(!l)return null;n.push([s,l]),r=r||l.type}let a=t.parse(e[e.length-1],e.length-1,r);if(!a)return null;if(!r)throw new Error("Can't infer output type");return new Nk(r,n,a)}evaluate(e){for(let[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(let[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every(([e,t])=>t.outputDefined())&&this.otherwise.outputDefined()}};h(zk,"Case");var Ohe=zk,$k=class t3{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);let r=t.parse(e[1],1,Yt),n=t.parse(e[2],2,nt);if(!r||!n)return null;if(!Gx(r.type,[Hn(Yt),ti,Yt]))return t.error(`Expected first argument to be of type array or string, but found ${Ni(r.type)} instead`);if(e.length===4){let a=t.parse(e[3],3,nt);return a?new t3(r.type,r,n,a):null}else return new t3(r.type,r,n)}evaluate(e){let t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!Gp(t,["string","array"]))throw new Sr(`Expected first argument to be of type array or string, but found ${Ni(wr(t))} instead.`);if(this.endIndex){let n=this.endIndex.evaluate(e);return t.slice(r,n)}return t.slice(r)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}};h($k,"Slice");var Bhe=$k;function mg(i,e){let t=i.length-1,r=0,n=t,a=0,o,s;for(;r<=n;)if(a=Math.floor((r+n)/2),o=i[a],s=i[a+1],o<=e){if(a===t||e<s)return a;r=a+1}else if(o>e)n=a-1;else throw new Sr("Input is not a number.");return 0}h(mg,"findStopLessThanOrEqualTo");var Uk=class Vk{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(let[n,a]of r)this.labels.push(n),this.outputs.push(a)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");let r=t.parse(e[1],1,nt);if(!r)return null;let n=[],a=null;t.expectedType&&t.expectedType.kind!=="value"&&(a=t.expectedType);for(let o=1;o<e.length;o+=2){let s=o===1?-1/0:e[o],l=e[o+1],u=o,c=o+1;if(typeof s!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(n.length&&n[n.length-1][0]>=s)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);let p=t.parse(l,c,a);if(!p)return null;a=a||p.type,n.push([s,p])}return new Vk(a,r,n)}evaluate(e){let t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);let n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);let a=t.length;if(n>=t[a-1])return r[a-1].evaluate(e);let o=mg(t,n);return r[o].evaluate(e)}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};h(Uk,"Step");var JE=Uk;function jk(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}h(jk,"getDefaultExportFromCjs");var zhe=KE;function KE(i,e,t,r){this.cx=3*i,this.bx=3*(t-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(r-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=e,this.p2x=t,this.p2y=r}h(KE,"UnitBezier");KE.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,e){if(e===void 0&&(e=1e-6),i<0)return 0;if(i>1)return 1;for(var t=i,r=0;r<8;r++){var n=this.sampleCurveX(t)-i;if(Math.abs(n)<e)return t;var a=this.sampleCurveDerivativeX(t);if(Math.abs(a)<1e-6)break;t=t-n/a}var o=0,s=1;for(t=i,r=0;r<20&&(n=this.sampleCurveX(t),!(Math.abs(n-i)<e));r++)i>n?o=t:s=t,t=(s-o)*.5+o;return t},solve:function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))}};var Nhe=jk(zhe);function Hk(i){return i==="rgb"||i==="hcl"||i==="lab"}h(Hk,"isSupportedInterpolationColorSpace");function Bl(i,e,t){return i+t*(e-i)}h(Bl,"number");function Gk(i,e,t,r="rgb"){switch(r){case"rgb":{let[n,a,o,s]=Bm(i.rgb,e.rgb,t);return new zt(n,a,o,s,!1)}case"hcl":{let[n,a,o,s]=i.hcl,[l,u,c,p]=e.hcl,d,m;if(!isNaN(n)&&!isNaN(l)){let w=l-n;l>n&&w>180?w-=360:l<n&&n-l>180&&(w+=360),d=n+t*w}else isNaN(n)?isNaN(l)?d=NaN:(d=l,(o===1||o===0)&&(m=u)):(d=n,(c===1||c===0)&&(m=a));let[g,_,y,x]=ik([d,m??Bl(a,u,t),Bl(o,c,t),Bl(s,p,t)]);return new zt(g,_,y,x,!1)}case"lab":{let[n,a,o,s]=qE(Bm(i.lab,e.lab,t));return new zt(n,a,o,s,!1)}}}h(Gk,"color");function Bm(i,e,t){return i.map((r,n)=>Bl(r,e[n],t))}h(Bm,"array");function Wk(i,e,t){return new js(Bm(i.values,e.values,t))}h(Wk,"padding");function Xk(i,e,t){let r=i.values,n=e.values;if(r.length!==n.length)throw new Sr(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${e.toString()}`);let a=[];for(let o=0;o<r.length;o+=2){if(r[o]!==n[o])throw new Sr(`Cannot interpolate values containing mismatched anchors. from[${o}]: ${r[o]}, to[${o}]: ${n[o]}`);a.push(r[o]);let[s,l]=r[o+1],[u,c]=n[o+1];a.push([Bl(s,u,t),Bl(l,c,t)])}return new bh(a)}h(Xk,"variableAnchorOffsetCollection");var Wi={number:Bl,color:Gk,array:Bm,padding:Wk,variableAnchorOffsetCollection:Xk},qk=class i3{constructor(e,t,r,n,a){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(let[o,s]of a)this.labels.push(o),this.outputs.push(s)}static interpolationFactor(e,t,r,n){let a=0;if(e.name==="exponential")a=Py(t,e.base,r,n);else if(e.name==="linear")a=Py(t,1,r,n);else if(e.name==="cubic-bezier"){let o=e.controlPoints;a=new Nhe(o[0],o[1],o[2],o[3]).solve(Py(t,1,r,n))}return a}static parse(e,t){let[r,n,a,...o]=e;if(!Array.isArray(n)||n.length===0)return t.error("Expected an interpolation type expression.",1);if(n[0]==="linear")n={name:"linear"};else if(n[0]==="exponential"){let u=n[1];if(typeof u!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:u}}else if(n[0]==="cubic-bezier"){let u=n.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:u}}else return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!==0)return t.error("Expected an even number of arguments.");if(a=t.parse(a,2,nt),!a)return null;let s=[],l=null;r==="interpolate-hcl"||r==="interpolate-lab"?l=So:t.expectedType&&t.expectedType.kind!=="value"&&(l=t.expectedType);for(let u=0;u<o.length;u+=2){let c=o[u],p=o[u+1],d=u+3,m=u+4;if(typeof c!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',d);if(s.length&&s[s.length-1][0]>=c)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',d);let g=t.parse(p,m,l);if(!g)return null;l=l||g.type,s.push([c,g])}return!ac(l,nt)&&!ac(l,So)&&!ac(l,jx)&&!ac(l,Hx)&&!ac(l,Hn(nt))?t.error(`Type ${Ni(l)} is not interpolatable.`):new i3(l,r,n,a,s)}evaluate(e){let t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);let n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);let a=t.length;if(n>=t[a-1])return r[a-1].evaluate(e);let o=mg(t,n),s=t[o],l=t[o+1],u=i3.interpolationFactor(this.interpolation,n,s,l),c=r[o].evaluate(e),p=r[o+1].evaluate(e);switch(this.operator){case"interpolate":return Wi[this.type.kind](c,p,u);case"interpolate-hcl":return Wi.color(c,p,u,"hcl");case"interpolate-lab":return Wi.color(c,p,u,"lab")}}eachChild(e){e(this.input);for(let t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}};h(qk,"Interpolate");var Yo=qk;function Py(i,e,t,r){let n=r-t,a=i-t;return n===0?0:e===1?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}h(Py,"exponentialInterpolation");var Zk=class r3{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let r=null,n=t.expectedType;n&&n.kind!=="value"&&(r=n);let a=[];for(let o of e.slice(1)){let s=t.parse(o,1+a.length,r,void 0,{typeAnnotation:"omit"});if(!s)return null;r=r||s.type,a.push(s)}if(!r)throw new Error("No output type");return n&&a.some(o=>Hp(n,o.type))?new r3(Yt,a):new r3(r,a)}evaluate(e){let t=null,r=0,n;for(let a of this.args)if(r++,t=a.evaluate(e),t&&t instanceof es&&!t.available&&(n||(n=t.name),t=null,r===this.args.length&&(t=n)),t!==null)break;return t}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}};h(Zk,"Coalesce");var Yk=Zk;function n3(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}h(n3,"isComparableType");function Jk(i,e,t){return e===t}h(Jk,"eq");function Kk(i,e,t){return e!==t}h(Kk,"neq");function Qk(i,e,t){return e<t}h(Qk,"lt");function eR(i,e,t){return e>t}h(eR,"gt");function tR(i,e,t){return e<=t}h(tR,"lteq");function iR(i,e,t){return e>=t}h(iR,"gteq");function QE(i,e,t,r){return r.compare(e,t)===0}h(QE,"eqCollate");function rR(i,e,t,r){return!QE(i,e,t,r)}h(rR,"neqCollate");function nR(i,e,t,r){return r.compare(e,t)<0}h(nR,"ltCollate");function aR(i,e,t,r){return r.compare(e,t)>0}h(aR,"gtCollate");function oR(i,e,t,r){return r.compare(e,t)<=0}h(oR,"lteqCollate");function sR(i,e,t,r){return r.compare(e,t)>=0}h(sR,"gteqCollate");function wh(i,e,t){var r;let n=i!=="=="&&i!=="!=";return r=class{constructor(a,o,s){this.type=Zt,this.lhs=a,this.rhs=o,this.collator=s,this.hasUntypedArgument=a.type.kind==="value"||o.type.kind==="value"}static parse(a,o){if(a.length!==3&&a.length!==4)return o.error("Expected two or three arguments.");let s=a[0],l=o.parse(a[1],1,Yt);if(!l)return null;if(!n3(s,l.type))return o.concat(1).error(`"${s}" comparisons are not supported for type '${Ni(l.type)}'.`);let u=o.parse(a[2],2,Yt);if(!u)return null;if(!n3(s,u.type))return o.concat(2).error(`"${s}" comparisons are not supported for type '${Ni(u.type)}'.`);if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return o.error(`Cannot compare types '${Ni(l.type)}' and '${Ni(u.type)}'.`);n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new Ts(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new Ts(l.type,[u])));let c=null;if(a.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return o.error("Cannot use collator to compare non-string types.");if(c=o.parse(a[3],3,Vx),!c)return null}return new r(l,u,c)}evaluate(a){let o=this.lhs.evaluate(a),s=this.rhs.evaluate(a);if(n&&this.hasUntypedArgument){let l=wr(o),u=wr(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new Sr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${l.kind}, ${u.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){let l=wr(o),u=wr(s);if(l.kind!=="string"||u.kind!=="string")return e(a,o,s)}return this.collator?t(a,o,s,this.collator.evaluate(a)):e(a,o,s)}eachChild(a){a(this.lhs),a(this.rhs),this.collator&&a(this.collator)}outputDefined(){return!0}},h(r,"Comparison"),r}h(wh,"makeComparison");var $he=wh("==",Jk,QE),Uhe=wh("!=",Kk,rR),Vhe=wh("<",Qk,nR),jhe=wh(">",eR,aR),Hhe=wh("<=",tR,oR),Ghe=wh(">=",iR,sR),lR=class uR{constructor(e,t,r){this.type=Vx,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(e.length!==2)return t.error("Expected one argument.");let r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");let n=t.parse(r["case-sensitive"]===void 0?!1:r["case-sensitive"],1,Zt);if(!n)return null;let a=t.parse(r["diacritic-sensitive"]===void 0?!1:r["diacritic-sensitive"],1,Zt);if(!a)return null;let o=null;return r.locale&&(o=t.parse(r.locale,1,ti),!o)?null:new uR(n,a,o)}evaluate(e){return new ZE(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}};h(lR,"CollatorExpression");var hR=lR,cR=class pR{constructor(e,t,r,n,a){this.type=ti,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=n,this.maxFractionDigits=a}static parse(e,t){if(e.length!==3)return t.error("Expected two arguments.");let r=t.parse(e[1],1,nt);if(!r)return null;let n=e[2];if(typeof n!="object"||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let a=null;if(n.locale&&(a=t.parse(n.locale,1,ti),!a))return null;let o=null;if(n.currency&&(o=t.parse(n.currency,1,ti),!o))return null;let s=null;if(n["min-fraction-digits"]&&(s=t.parse(n["min-fraction-digits"],1,nt),!s))return null;let l=null;return n["max-fraction-digits"]&&(l=t.parse(n["max-fraction-digits"],1,nt),!l)?null:new pR(r,a,o,s,l)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}};h(cR,"NumberFormat");var Whe=cR,dR=class fR{constructor(e){this.type=dg,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");let n=[],a=!1;for(let o=1;o<=e.length-1;++o){let s=e[o];if(a&&typeof s=="object"&&!Array.isArray(s)){a=!1;let l=null;if(s["font-scale"]&&(l=t.parse(s["font-scale"],1,nt),!l))return null;let u=null;if(s["text-font"]&&(u=t.parse(s["text-font"],1,Hn(ti)),!u))return null;let c=null;if(s["text-color"]&&(c=t.parse(s["text-color"],1,So),!c))return null;let p=n[n.length-1];p.scale=l,p.font=u,p.textColor=c}else{let l=t.parse(e[o],1,Yt);if(!l)return null;let u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");a=!0,n.push({content:l,scale:null,font:null,textColor:null})}}return new fR(n)}evaluate(e){let t=h(r=>{let n=r.content.evaluate(e);return wr(n)===fg?new Kw("",n,null,null,null):new Kw(xp(n),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)},"evaluateSection");return new Ns(this.sections.map(t))}eachChild(e){for(let t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}};h(dR,"FormatExpression");var mR=dR,gR=class yR{constructor(e){this.type=fg,this.input=e}static parse(e,t){if(e.length!==2)return t.error("Expected two arguments.");let r=t.parse(e[1],1,ti);return r?new yR(r):t.error("No image name provided.")}evaluate(e){let t=this.input.evaluate(e),r=es.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}};h(gR,"ImageExpression");var Xhe=gR,vR=class xR{constructor(e){this.type=nt,this.input=e}static parse(e,t){if(e.length!==2)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);let r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error(`Expected argument of type string or array, but found ${Ni(r.type)} instead.`):new xR(r):null}evaluate(e){let t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Sr(`Expected value to be of type string or array, but found ${Ni(wr(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}};h(vR,"Length");var qhe=vR,Jo=8192;function _R(i,e){let t=bR(i[0]),r=SR(i[1]),n=Math.pow(2,e.z);return[Math.round(t*n*Jo),Math.round(r*n*Jo)]}h(_R,"getTileCoordinates");function Wx(i,e){let t=Math.pow(2,e.z),r=(i[0]/Jo+e.x)/t,n=(i[1]/Jo+e.y)/t;return[wR(r),MR(n)]}h(Wx,"getLngLatFromTileCoord");function bR(i){return(180+i)/360}h(bR,"mercatorXfromLng");function wR(i){return i*360-180}h(wR,"lngFromMercatorXfromLng");function SR(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}h(SR,"mercatorYfromLat");function MR(i){return 360/Math.PI*Math.atan(Math.exp((180-i*360)*Math.PI/180))-90}h(MR,"latFromMercatorY");function vd(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}h(vd,"updateBBox");function Xp(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}h(Xp,"boxWithinBox");function CR(i,e,t){return e[1]>i[1]!=t[1]>i[1]&&i[0]<(t[0]-e[0])*(i[1]-e[1])/(t[1]-e[1])+e[0]}h(CR,"rayIntersect");function ER(i,e,t){let r=i[0]-e[0],n=i[1]-e[1],a=i[0]-t[0],o=i[1]-t[1];return r*o-a*n===0&&r*a<=0&&n*o<=0}h(ER,"pointOnBoundary");function gg(i,e,t,r){let n=[e[0]-i[0],e[1]-i[1]],a=[r[0]-t[0],r[1]-t[1]];return IR(a,n)===0?!1:!!(a3(i,e,t,r)&&a3(t,r,i,e))}h(gg,"segmentIntersectSegment");function TR(i,e,t){for(let r of t)for(let n=0;n<r.length-1;++n)if(gg(i,e,r[n],r[n+1]))return!0;return!1}h(TR,"lineIntersectPolygon");function Sh(i,e,t=!1){let r=!1;for(let n of e)for(let a=0;a<n.length-1;a++){if(ER(i,n[a],n[a+1]))return t;CR(i,n[a],n[a+1])&&(r=!r)}return r}h(Sh,"pointWithinPolygon");function PR(i,e){for(let t of e)if(Sh(i,t))return!0;return!1}h(PR,"pointWithinPolygons");function e4(i,e){for(let t of i)if(!Sh(t,e))return!1;for(let t=0;t<i.length-1;++t)if(TR(i[t],i[t+1],e))return!1;return!0}h(e4,"lineStringWithinPolygon");function AR(i,e){for(let t of e)if(e4(i,t))return!0;return!1}h(AR,"lineStringWithinPolygons");function IR(i,e){return i[0]*e[1]-i[1]*e[0]}h(IR,"perp");function a3(i,e,t,r){let n=i[0]-t[0],a=i[1]-t[1],o=e[0]-t[0],s=e[1]-t[1],l=r[0]-t[0],u=r[1]-t[1],c=n*u-l*a,p=o*u-l*s;return c>0&&p<0||c<0&&p>0}h(a3,"twoSided");function Xx(i,e,t){let r=[];for(let n=0;n<i.length;n++){let a=[];for(let o=0;o<i[n].length;o++){let s=_R(i[n][o],t);vd(e,s),a.push(s)}r.push(a)}return r}h(Xx,"getTilePolygon");function t4(i,e,t){let r=[];for(let n=0;n<i.length;n++){let a=Xx(i[n],e,t);r.push(a)}return r}h(t4,"getTilePolygons");function i4(i,e,t,r){if(i[0]<t[0]||i[0]>t[2]){let n=r*.5,a=i[0]-t[0]>n?-r:t[0]-i[0]>n?r:0;a===0&&(a=i[0]-t[2]>n?-r:t[2]-i[0]>n?r:0),i[0]+=a}vd(e,i)}h(i4,"updatePoint");function LR(i){i[0]=i[1]=1/0,i[2]=i[3]=-1/0}h(LR,"resetBBox");function o3(i,e,t,r){let n=Math.pow(2,r.z)*Jo,a=[r.x*Jo,r.y*Jo],o=[];for(let s of i)for(let l of s){let u=[l.x+a[0],l.y+a[1]];i4(u,e,t,n),o.push(u)}return o}h(o3,"getTilePoints");function s3(i,e,t,r){let n=Math.pow(2,r.z)*Jo,a=[r.x*Jo,r.y*Jo],o=[];for(let s of i){let l=[];for(let u of s){let c=[u.x+a[0],u.y+a[1]];vd(e,c),l.push(c)}o.push(l)}if(e[2]-e[0]<=n/2){LR(e);for(let s of o)for(let l of s)i4(l,e,t,n)}return o}h(s3,"getTileLines");function DR(i,e){let t=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=i.canonicalID();if(e.type==="Polygon"){let a=Xx(e.coordinates,r,n),o=o3(i.geometry(),t,r,n);if(!Xp(t,r))return!1;for(let s of o)if(!Sh(s,a))return!1}if(e.type==="MultiPolygon"){let a=t4(e.coordinates,r,n),o=o3(i.geometry(),t,r,n);if(!Xp(t,r))return!1;for(let s of o)if(!PR(s,a))return!1}return!0}h(DR,"pointsWithinPolygons");function kR(i,e){let t=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],n=i.canonicalID();if(e.type==="Polygon"){let a=Xx(e.coordinates,r,n),o=s3(i.geometry(),t,r,n);if(!Xp(t,r))return!1;for(let s of o)if(!e4(s,a))return!1}if(e.type==="MultiPolygon"){let a=t4(e.coordinates,r,n),o=s3(i.geometry(),t,r,n);if(!Xp(t,r))return!1;for(let s of o)if(!AR(s,a))return!1}return!0}h(kR,"linesWithinPolygons");var RR=class Ay{constructor(e,t){this.type=Zt,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Wp(e[1])){let r=e[1];if(r.type==="FeatureCollection"){let n=[];for(let a of r.features){let{type:o,coordinates:s}=a.geometry;o==="Polygon"&&n.push(s),o==="MultiPolygon"&&n.push(...s)}if(n.length){let a={type:"MultiPolygon",coordinates:n};return new Ay(r,a)}}else if(r.type==="Feature"){let n=r.geometry.type;if(n==="Polygon"||n==="MultiPolygon")return new Ay(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Ay(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return DR(e,this.geometries);if(e.geometryType()==="LineString")return kR(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}};h(RR,"Within");var r4=RR,FR=class{constructor(e=[],t=BR){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){let{data:t,compare:r}=this,n=t[e];for(;e>0;){let a=e-1>>1,o=t[a];if(r(n,o)>=0)break;t[e]=o,e=a}t[e]=n}_down(e){let{data:t,compare:r}=this,n=this.length>>1,a=t[e];for(;e<n;){let o=(e<<1)+1,s=t[o],l=o+1;if(l<this.length&&r(t[l],s)<0&&(o=l,s=t[l]),r(s,a)>=0)break;t[e]=s,e=o}t[e]=a}};h(FR,"TinyQueue");var OR=FR;function BR(i,e){return i<e?-1:i>e?1:0}h(BR,"defaultCompare$1");function zR(i,e,t,r,n){n4(i,e,t,r||i.length-1,n||NR)}h(zR,"quickselect");function n4(i,e,t,r,n){for(;r>t;){if(r-t>600){var a=r-t+1,o=e-t+1,s=Math.log(a),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1),c=Math.max(t,Math.floor(e-o*l/a+u)),p=Math.min(r,Math.floor(e+(a-o)*l/a+u));n4(i,e,c,p,n)}var d=i[e],m=t,g=r;for(oc(i,t,e),n(i[r],d)>0&&oc(i,t,r);m<g;){for(oc(i,m,g),m++,g--;n(i[m],d)<0;)m++;for(;n(i[g],d)>0;)g--}n(i[t],d)===0?oc(i,t,g):(g++,oc(i,g,r)),g<=e&&(t=g+1),e<=g&&(r=g-1)}}h(n4,"quickselectStep");function oc(i,e,t){var r=i[e];i[e]=i[t],i[t]=r}h(oc,"swap");function NR(i,e){return i<e?-1:i>e?1:0}h(NR,"defaultCompare");function $R(i,e){if(i.length<=1)return[i];let t=[],r,n;for(let a of i){let o=VR(a);o!==0&&(a.area=Math.abs(o),n===void 0&&(n=o<0),n===o<0?(r&&t.push(r),r=[a]):r.push(a))}if(r&&t.push(r),e>1)for(let a=0;a<t.length;a++)t[a].length<=e||(zR(t[a],e,1,t[a].length-1,UR),t[a]=t[a].slice(0,e));return t}h($R,"classifyRings");function UR(i,e){return e.area-i.area}h(UR,"compareAreas");function VR(i){let e=0;for(let t=0,r=i.length,n=r-1,a,o;t<r;n=t++)a=i[t],o=i[n],e+=(o.x-a.x)*(a.y+o.y);return e}h(VR,"calculateSignedArea");var Zhe=6378.137,KA=1/298.257223563,QA=KA*(2-KA),e6=Math.PI/180,jR=class{constructor(e){let t=e6*Zhe*1e3,r=Math.cos(e*e6),n=1/(1-QA*(1-r*r)),a=Math.sqrt(n);this.kx=t*a*r,this.ky=t*a*n*(1-QA)}distance(e,t){let r=this.wrap(e[0]-t[0])*this.kx,n=(e[1]-t[1])*this.ky;return Math.sqrt(r*r+n*n)}pointOnLine(e,t){let r=1/0,n,a,o,s;for(let l=0;l<e.length-1;l++){let u=e[l][0],c=e[l][1],p=this.wrap(e[l+1][0]-u)*this.kx,d=(e[l+1][1]-c)*this.ky,m=0;(p!==0||d!==0)&&(m=(this.wrap(t[0]-u)*this.kx*p+(t[1]-c)*this.ky*d)/(p*p+d*d),m>1?(u=e[l+1][0],c=e[l+1][1]):m>0&&(u+=p/this.kx*m,c+=d/this.ky*m)),p=this.wrap(t[0]-u)*this.kx,d=(t[1]-c)*this.ky;let g=p*p+d*d;g<r&&(r=g,n=u,a=c,o=l,s=m)}return{point:[n,a],index:o,t:Math.max(0,Math.min(1,s))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}};h(jR,"CheapRuler");var a4=jR,l3=100,u3=50;function o4(i,e){return e[0]-i[0]}h(o4,"compareDistPair");function zm(i){return i[1]-i[0]+1}h(zm,"getRangeSize");function ts(i,e){return i[1]>=i[0]&&i[1]<e}h(ts,"isRangeSafe");function Pv(i,e){if(i[0]>i[1])return[null,null];let t=zm(i);if(e){if(t===2)return[i,null];let n=Math.floor(t/2);return[[i[0],i[0]+n],[i[0]+n,i[1]]]}if(t===1)return[i,null];let r=Math.floor(t/2)-1;return[[i[0],i[0]+r],[i[0]+r+1,i[1]]]}h(Pv,"splitRange");function Av(i,e){if(!ts(e,i.length))return[1/0,1/0,-1/0,-1/0];let t=[1/0,1/0,-1/0,-1/0];for(let r=e[0];r<=e[1];++r)vd(t,i[r]);return t}h(Av,"getBBox");function Iv(i){let e=[1/0,1/0,-1/0,-1/0];for(let t of i)for(let r of t)vd(e,r);return e}h(Iv,"getPolygonBBox");function h3(i){return i[0]!==-1/0&&i[1]!==-1/0&&i[2]!==1/0&&i[3]!==1/0}h(h3,"isValidBBox");function qx(i,e,t){if(!h3(i)||!h3(e))return NaN;let r=0,n=0;return i[2]<e[0]&&(r=e[0]-i[2]),i[0]>e[2]&&(r=i[0]-e[2]),i[1]>e[3]&&(n=i[1]-e[3]),i[3]<e[1]&&(n=e[1]-i[3]),t.distance([0,0],[r,n])}h(qx,"bboxToBBoxDistance");function El(i,e,t){let r=t.pointOnLine(e,i);return t.distance(i,r.point)}h(El,"pointToLineDistance");function Zx(i,e,t,r,n){let a=Math.min(El(i,[t,r],n),El(e,[t,r],n)),o=Math.min(El(t,[i,e],n),El(r,[i,e],n));return Math.min(a,o)}h(Zx,"segmentToSegmentDistance");function HR(i,e,t,r,n){if(!(ts(e,i.length)&&ts(r,t.length)))return 1/0;let a=1/0;for(let o=e[0];o<e[1];++o){let s=i[o],l=i[o+1];for(let u=r[0];u<r[1];++u){let c=t[u],p=t[u+1];if(gg(s,l,c,p))return 0;a=Math.min(a,Zx(s,l,c,p,n))}}return a}h(HR,"lineToLineDistance");function GR(i,e,t,r,n){if(!(ts(e,i.length)&&ts(r,t.length)))return NaN;let a=1/0;for(let o=e[0];o<=e[1];++o)for(let s=r[0];s<=r[1];++s)if(a=Math.min(a,n.distance(i[o],t[s])),a===0)return a;return a}h(GR,"pointsToPointsDistance");function WR(i,e,t){if(Sh(i,e,!0))return 0;let r=1/0;for(let n of e){let a=n[0],o=n[n.length-1];if(a!==o&&(r=Math.min(r,El(i,[o,a],t)),r===0))return r;let s=t.pointOnLine(n,i);if(r=Math.min(r,t.distance(i,s.point)),r===0)return r}return r}h(WR,"pointToPolygonDistance");function XR(i,e,t,r){if(!ts(e,i.length))return NaN;for(let a=e[0];a<=e[1];++a)if(Sh(i[a],t,!0))return 0;let n=1/0;for(let a=e[0];a<e[1];++a){let o=i[a],s=i[a+1];for(let l of t)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let d=l[p],m=l[u];if(gg(o,s,d,m))return 0;n=Math.min(n,Zx(o,s,d,m,r))}}return n}h(XR,"lineToPolygonDistance");function c3(i,e){for(let t of i)for(let r of t)if(Sh(r,e,!0))return!0;return!1}h(c3,"polygonIntersect");function qR(i,e,t,r=1/0){let n=Iv(i),a=Iv(e);if(r!==1/0&&qx(n,a,t)>=r)return r;if(Xp(n,a)){if(c3(i,e))return 0}else if(c3(e,i))return 0;let o=1/0;for(let s of i)for(let l=0,u=s.length,c=u-1;l<u;c=l++){let p=s[c],d=s[l];for(let m of e)for(let g=0,_=m.length,y=_-1;g<_;y=g++){let x=m[y],w=m[g];if(gg(p,d,x,w))return 0;o=Math.min(o,Zx(p,d,x,w,t))}}return o}h(qR,"polygonToPolygonDistance");function p3(i,e,t,r,n,a){if(!a)return;let o=qx(Av(r,a),n,t);o<e&&i.push([o,a,[0,0]])}h(p3,"updateQueue");function cf(i,e,t,r,n,a,o){if(!a||!o)return;let s=qx(Av(r,a),Av(n,o),t);s<e&&i.push([s,a,o])}h(cf,"updateQueueTwoSets");function Nm(i,e,t,r,n=1/0){let a=Math.min(r.distance(i[0],t[0][0]),n);if(a===0)return a;let o=new OR([[0,[0,i.length-1],[0,0]]],o4),s=Iv(t);for(;o.length>0;){let l=o.pop();if(l[0]>=a)continue;let u=l[1],c=e?u3:l3;if(zm(u)<=c){if(!ts(u,i.length))return NaN;if(e){let p=XR(i,u,t,r);if(isNaN(p)||p===0)return p;a=Math.min(a,p)}else for(let p=u[0];p<=u[1];++p){let d=WR(i[p],t,r);if(a=Math.min(a,d),a===0)return 0}}else{let p=Pv(u,e);p3(o,a,r,i,s,p[0]),p3(o,a,r,i,s,p[1])}}return a}h(Nm,"pointsToPolygonDistance");function $m(i,e,t,r,n,a=1/0){let o=Math.min(a,n.distance(i[0],t[0]));if(o===0)return o;let s=new OR([[0,[0,i.length-1],[0,t.length-1]]],o4);for(;s.length>0;){let l=s.pop();if(l[0]>=o)continue;let u=l[1],c=l[2],p=e?u3:l3,d=r?u3:l3;if(zm(u)<=p&&zm(c)<=d){if(!ts(u,i.length)&&ts(c,t.length))return NaN;let m;if(e&&r)m=HR(i,u,t,c,n),o=Math.min(o,m);else if(e&&!r){let g=i.slice(u[0],u[1]+1);for(let _=c[0];_<=c[1];++_)if(m=El(t[_],g,n),o=Math.min(o,m),o===0)return o}else if(!e&&r){let g=t.slice(c[0],c[1]+1);for(let _=u[0];_<=u[1];++_)if(m=El(i[_],g,n),o=Math.min(o,m),o===0)return o}else m=GR(i,u,t,c,n),o=Math.min(o,m)}else{let m=Pv(u,e),g=Pv(c,r);cf(s,o,n,i,t,m[0],g[0]),cf(s,o,n,i,t,m[0],g[1]),cf(s,o,n,i,t,m[1],g[0]),cf(s,o,n,i,t,m[1],g[1])}}return o}h($m,"pointSetToPointSetDistance");function ZR(i,e){let t=i.geometry(),r=t.flat().map(o=>Wx([o.x,o.y],i.canonical));if(t.length===0)return NaN;let n=new a4(r[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,$m(r,!1,[o.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,$m(r,!1,o.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,Nm(r,!1,o.coordinates,n,a));break}if(a===0)return a}return a}h(ZR,"pointToGeometryDistance");function YR(i,e){let t=i.geometry(),r=t.flat().map(o=>Wx([o.x,o.y],i.canonical));if(t.length===0)return NaN;let n=new a4(r[0][1]),a=1/0;for(let o of e){switch(o.type){case"Point":a=Math.min(a,$m(r,!0,[o.coordinates],!1,n,a));break;case"LineString":a=Math.min(a,$m(r,!0,o.coordinates,!0,n,a));break;case"Polygon":a=Math.min(a,Nm(r,!0,o.coordinates,n,a));break}if(a===0)return a}return a}h(YR,"lineStringToGeometryDistance");function JR(i,e){let t=i.geometry();if(t.length===0||t[0].length===0)return NaN;let r=$R(t,0).map(o=>o.map(s=>s.map(l=>Wx([l.x,l.y],i.canonical)))),n=new a4(r[0][0][0][1]),a=1/0;for(let o of e)for(let s of r){switch(o.type){case"Point":a=Math.min(a,Nm([o.coordinates],!1,s,n,a));break;case"LineString":a=Math.min(a,Nm(o.coordinates,!0,s,n,a));break;case"Polygon":a=Math.min(a,qR(s,o.coordinates,n,a));break}if(a===0)return a}return a}h(JR,"polygonToGeometryDistance");function Iy(i){return i.type==="MultiPolygon"?i.coordinates.map(e=>({type:"Polygon",coordinates:e})):i.type==="MultiLineString"?i.coordinates.map(e=>({type:"LineString",coordinates:e})):i.type==="MultiPoint"?i.coordinates.map(e=>({type:"Point",coordinates:e})):[i]}h(Iy,"toSimpleGeometry");var KR=class Ly{constructor(e,t){this.type=nt,this.geojson=e,this.geometries=t}static parse(e,t){if(e.length!==2)return t.error(`'distance' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Wp(e[1])){let r=e[1];if(r.type==="FeatureCollection")return new Ly(r,r.features.map(n=>Iy(n.geometry)).flat());if(r.type==="Feature")return new Ly(r,Iy(r.geometry));if("type"in r&&"coordinates"in r)return new Ly(r,Iy(r))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return ZR(e,this.geometries);if(e.geometryType()==="LineString")return YR(e,this.geometries);if(e.geometryType()==="Polygon")return JR(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}};h(KR,"Distance");var s4=KR,_p={"==":$he,"!=":Uhe,">":jhe,"<":Vhe,">=":Ghe,"<=":Hhe,array:Ts,at:Dhe,boolean:Ts,case:Ohe,coalesce:Yk,collator:hR,format:mR,image:Xhe,in:khe,"index-of":Rhe,interpolate:Yo,"interpolate-hcl":Yo,"interpolate-lab":Yo,length:qhe,let:Tk,literal:Om,match:Fhe,number:Ts,"number-format":Whe,object:Ts,slice:Bhe,step:JE,string:Ts,"to-boolean":rp,"to-color":rp,"to-number":rp,"to-string":rp,var:Ik,within:r4,distance:s4},QR=class pf{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){let r=e[0],n=pf.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);let a=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,s=o.filter(([u])=>!Array.isArray(u)||u.length===e.length-1),l=null;for(let[u,c]of s){l=new Mk(t.registry,Um,t.path,null,t.scope);let p=[],d=!1;for(let m=1;m<e.length;m++){let g=e[m],_=Array.isArray(u)?u[m-1]:u.type,y=l.parse(g,1+p.length,_);if(!y){d=!0;break}p.push(y)}if(!d){if(Array.isArray(u)&&u.length!==p.length){l.error(`Expected ${u.length} arguments, but found ${p.length} instead.`);continue}for(let m=0;m<p.length;m++){let g=Array.isArray(u)?u[m]:u.type,_=p[m];l.concat(m+1).checkSubtype(g,_.type)}if(l.errors.length===0)return new pf(r,a,c,p)}}if(s.length===1)t.errors.push(...l.errors);else{let u=(s.length?s:o).map(([p])=>tF(p)).join(" | "),c=[];for(let p=1;p<e.length;p++){let d=t.parse(e[p],1+c.length);if(!d)return null;c.push(Ni(d.type))}t.error(`Expected arguments of type ${u}, but found (${c.join(", ")}) instead.`)}return null}static register(e,t){pf.definitions=t;for(let r in t)e[r]=pf}};h(QR,"CompoundExpression");var Mh=QR;function d3(i,[e,t,r,n]){e=e.evaluate(i),t=t.evaluate(i),r=r.evaluate(i);let a=n?n.evaluate(i):1,o=YE(e,t,r,a);if(o)throw new Sr(o);return new zt(e/255,t/255,r/255,a,!1)}h(d3,"rgba");function f3(i,e){return i in e}h(f3,"has");function Dy(i,e){let t=e[i];return typeof t>"u"?null:t}h(Dy,"get");function eF(i,e,t,r){for(;t<=r;){let n=t+r>>1;if(e[n]===i)return!0;e[n]>i?r=n-1:t=n+1}return!1}h(eF,"binarySearch");function nl(i){return{type:i}}h(nl,"varargs");Mh.register(_p,{error:[Mhe,[ti],(i,[e])=>{throw new Sr(e.evaluate(i))}],typeof:[ti,[Yt],(i,[e])=>Ni(wr(e.evaluate(i)))],"to-rgba":[Hn(nt,4),[So],(i,[e])=>{let[t,r,n,a]=e.evaluate(i).rgb;return[t*255,r*255,n*255,a]}],rgb:[So,[nt,nt,nt],d3],rgba:[So,[nt,nt,nt,nt],d3],has:{type:Zt,overloads:[[[ti],(i,[e])=>f3(e.evaluate(i),i.properties())],[[ti,yp],(i,[e,t])=>f3(e.evaluate(i),t.evaluate(i))]]},get:{type:Yt,overloads:[[[ti],(i,[e])=>Dy(e.evaluate(i),i.properties())],[[ti,yp],(i,[e,t])=>Dy(e.evaluate(i),t.evaluate(i))]]},"feature-state":[Yt,[ti],(i,[e])=>Dy(e.evaluate(i),i.featureState||{})],properties:[yp,[],i=>i.properties()],"geometry-type":[ti,[],i=>i.geometryType()],id:[Yt,[],i=>i.id()],zoom:[nt,[],i=>i.globals.zoom],"heatmap-density":[nt,[],i=>i.globals.heatmapDensity||0],"line-progress":[nt,[],i=>i.globals.lineProgress||0],accumulated:[Yt,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[nt,nl(nt),(i,e)=>{let t=0;for(let r of e)t+=r.evaluate(i);return t}],"*":[nt,nl(nt),(i,e)=>{let t=1;for(let r of e)t*=r.evaluate(i);return t}],"-":{type:nt,overloads:[[[nt,nt],(i,[e,t])=>e.evaluate(i)-t.evaluate(i)],[[nt],(i,[e])=>-e.evaluate(i)]]},"/":[nt,[nt,nt],(i,[e,t])=>e.evaluate(i)/t.evaluate(i)],"%":[nt,[nt,nt],(i,[e,t])=>e.evaluate(i)%t.evaluate(i)],ln2:[nt,[],()=>Math.LN2],pi:[nt,[],()=>Math.PI],e:[nt,[],()=>Math.E],"^":[nt,[nt,nt],(i,[e,t])=>Math.pow(e.evaluate(i),t.evaluate(i))],sqrt:[nt,[nt],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[nt,[nt],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[nt,[nt],(i,[e])=>Math.log(e.evaluate(i))],log2:[nt,[nt],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[nt,[nt],(i,[e])=>Math.sin(e.evaluate(i))],cos:[nt,[nt],(i,[e])=>Math.cos(e.evaluate(i))],tan:[nt,[nt],(i,[e])=>Math.tan(e.evaluate(i))],asin:[nt,[nt],(i,[e])=>Math.asin(e.evaluate(i))],acos:[nt,[nt],(i,[e])=>Math.acos(e.evaluate(i))],atan:[nt,[nt],(i,[e])=>Math.atan(e.evaluate(i))],min:[nt,nl(nt),(i,e)=>Math.min(...e.map(t=>t.evaluate(i)))],max:[nt,nl(nt),(i,e)=>Math.max(...e.map(t=>t.evaluate(i)))],abs:[nt,[nt],(i,[e])=>Math.abs(e.evaluate(i))],round:[nt,[nt],(i,[e])=>{let t=e.evaluate(i);return t<0?-Math.round(-t):Math.round(t)}],floor:[nt,[nt],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[nt,[nt],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[Zt,[ti,Yt],(i,[e,t])=>i.properties()[e.value]===t.value],"filter-id-==":[Zt,[Yt],(i,[e])=>i.id()===e.value],"filter-type-==":[Zt,[ti],(i,[e])=>i.geometryType()===e.value],"filter-<":[Zt,[ti,Yt],(i,[e,t])=>{let r=i.properties()[e.value],n=t.value;return typeof r==typeof n&&r<n}],"filter-id-<":[Zt,[Yt],(i,[e])=>{let t=i.id(),r=e.value;return typeof t==typeof r&&t<r}],"filter->":[Zt,[ti,Yt],(i,[e,t])=>{let r=i.properties()[e.value],n=t.value;return typeof r==typeof n&&r>n}],"filter-id->":[Zt,[Yt],(i,[e])=>{let t=i.id(),r=e.value;return typeof t==typeof r&&t>r}],"filter-<=":[Zt,[ti,Yt],(i,[e,t])=>{let r=i.properties()[e.value],n=t.value;return typeof r==typeof n&&r<=n}],"filter-id-<=":[Zt,[Yt],(i,[e])=>{let t=i.id(),r=e.value;return typeof t==typeof r&&t<=r}],"filter->=":[Zt,[ti,Yt],(i,[e,t])=>{let r=i.properties()[e.value],n=t.value;return typeof r==typeof n&&r>=n}],"filter-id->=":[Zt,[Yt],(i,[e])=>{let t=i.id(),r=e.value;return typeof t==typeof r&&t>=r}],"filter-has":[Zt,[Yt],(i,[e])=>e.value in i.properties()],"filter-has-id":[Zt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Zt,[Hn(ti)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[Zt,[Hn(Yt)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[Zt,[ti,Hn(Yt)],(i,[e,t])=>t.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[Zt,[ti,Hn(Yt)],(i,[e,t])=>eF(i.properties()[e.value],t.value,0,t.value.length-1)],all:{type:Zt,overloads:[[[Zt,Zt],(i,[e,t])=>e.evaluate(i)&&t.evaluate(i)],[nl(Zt),(i,e)=>{for(let t of e)if(!t.evaluate(i))return!1;return!0}]]},any:{type:Zt,overloads:[[[Zt,Zt],(i,[e,t])=>e.evaluate(i)||t.evaluate(i)],[nl(Zt),(i,e)=>{for(let t of e)if(t.evaluate(i))return!0;return!1}]]},"!":[Zt,[Zt],(i,[e])=>!e.evaluate(i)],"is-supported-script":[Zt,[ti],(i,[e])=>{let t=i.globals&&i.globals.isSupportedScript;return t?t(e.evaluate(i)):!0}],upcase:[ti,[ti],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[ti,[ti],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[ti,nl(Yt),(i,e)=>e.map(t=>xp(t.evaluate(i))).join("")],"resolved-locale":[ti,[Vx],(i,[e])=>e.evaluate(i).resolvedLocale()]});function tF(i){return Array.isArray(i)?`(${i.map(Ni).join(", ")})`:`(${Ni(i.type)}...)`}h(tF,"stringifySignature");function Um(i){if(i instanceof Ik)return Um(i.boundExpression);if(i instanceof Mh&&i.name==="error"||i instanceof hR||i instanceof r4||i instanceof s4)return!1;let e=i instanceof rp||i instanceof Ts,t=!0;return i.eachChild(r=>{e?t=t&&Um(r):t=t&&r instanceof Om}),t?yg(i)&&vg(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}h(Um,"isExpressionConstant");function yg(i){if(i instanceof Mh&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof r4||i instanceof s4)return!1;let e=!0;return i.eachChild(t=>{e&&!yg(t)&&(e=!1)}),e}h(yg,"isFeatureConstant");function qp(i){if(i instanceof Mh&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(t=>{e&&!qp(t)&&(e=!1)}),e}h(qp,"isStateConstant");function vg(i,e){if(i instanceof Mh&&e.indexOf(i.name)>=0)return!1;let t=!0;return i.eachChild(r=>{t&&!vg(r,e)&&(t=!1)}),t}h(vg,"isGlobalPropertyConstant");function Lv(i){return{result:"success",value:i}}h(Lv,"success");function Iu(i){return{result:"error",value:i}}h(Iu,"error");function uh(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}h(uh,"supportsPropertyExpression");function l4(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}h(l4,"supportsZoomExpression");function Yx(i){return!!i.expression&&i.expression.interpolated}h(Yx,"supportsInterpolation");function pi(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}h(pi,"getType");function xg(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}h(xg,"isFunction$1");function iF(i){return i}h(iF,"identityFunction");function u4(i,e){let t=e.type==="color",r=i.stops&&typeof i.stops[0][0]=="object",n=r||i.property!==void 0,a=r||!n,o=i.type||(Yx(e)?"exponential":"interval");if(t||e.type==="padding"){let c=t?zt.parse:js.parse;i=lh({},i),i.stops&&(i.stops=i.stops.map(p=>[p[0],c(p[1])])),i.default?i.default=c(i.default):i.default=c(e.default)}if(i.colorSpace&&!Hk(i.colorSpace))throw new Error(`Unknown color space: "${i.colorSpace}"`);let s,l,u;if(o==="exponential")s=m3;else if(o==="interval")s=nF;else if(o==="categorical"){s=rF,l=Object.create(null);for(let c of i.stops)l[c[0]]=c[1];u=typeof i.stops[0][0]}else if(o==="identity")s=aF;else throw new Error(`Unknown function type "${o}"`);if(r){let c={},p=[];for(let g=0;g<i.stops.length;g++){let _=i.stops[g],y=_[0].zoom;c[y]===void 0&&(c[y]={zoom:y,type:i.type,property:i.property,default:i.default,stops:[]},p.push(y)),c[y].stops.push([_[0].value,_[1]])}let d=[];for(let g of p)d.push([c[g].zoom,u4(c[g],e)]);let m={name:"linear"};return{kind:"composite",interpolationType:m,interpolationFactor:Yo.interpolationFactor.bind(void 0,m),zoomStops:d.map(g=>g[0]),evaluate({zoom:g},_){return m3({stops:d,base:i.base},e,g).evaluate(g,_)}}}else if(a){let c=o==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:c,interpolationFactor:Yo.interpolationFactor.bind(void 0,c),zoomStops:i.stops.map(p=>p[0]),evaluate:({zoom:p})=>s(i,e,p,l,u)}}else return{kind:"source",evaluate(c,p){let d=p&&p.properties?p.properties[i.property]:void 0;return d===void 0?xd(i.default,e.default):s(i,e,d,l,u)}}}h(u4,"createFunction");function xd(i,e,t){if(i!==void 0)return i;if(e!==void 0)return e;if(t!==void 0)return t}h(xd,"coalesce$1");function rF(i,e,t,r,n){let a=typeof t===n?r[t]:void 0;return xd(a,i.default,e.default)}h(rF,"evaluateCategoricalFunction");function nF(i,e,t){if(pi(t)!=="number")return xd(i.default,e.default);let r=i.stops.length;if(r===1||t<=i.stops[0][0])return i.stops[0][1];if(t>=i.stops[r-1][0])return i.stops[r-1][1];let n=mg(i.stops.map(a=>a[0]),t);return i.stops[n][1]}h(nF,"evaluateIntervalFunction");function m3(i,e,t){let r=i.base!==void 0?i.base:1;if(pi(t)!=="number")return xd(i.default,e.default);let n=i.stops.length;if(n===1||t<=i.stops[0][0])return i.stops[0][1];if(t>=i.stops[n-1][0])return i.stops[n-1][1];let a=mg(i.stops.map(c=>c[0]),t),o=oF(t,r,i.stops[a][0],i.stops[a+1][0]),s=i.stops[a][1],l=i.stops[a+1][1],u=Wi[e.type]||iF;return typeof s.evaluate=="function"?{evaluate(...c){let p=s.evaluate.apply(void 0,c),d=l.evaluate.apply(void 0,c);if(!(p===void 0||d===void 0))return u(p,d,o,i.colorSpace)}}:u(s,l,o,i.colorSpace)}h(m3,"evaluateExponentialFunction");function aF(i,e,t){switch(e.type){case"color":t=zt.parse(t);break;case"formatted":t=Ns.fromString(t.toString());break;case"resolvedImage":t=es.fromString(t.toString());break;case"padding":t=js.parse(t);break;default:pi(t)!==e.type&&(e.type!=="enum"||!e.values[t])&&(t=void 0)}return xd(t,i.default,e.default)}h(aF,"evaluateIdentityFunction");function oF(i,e,t,r){let n=r-t,a=i-t;return n===0?0:e===1?a/n:(Math.pow(e,a)-1)/(Math.pow(e,n)-1)}h(oF,"interpolationFactor");var sF=class{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new bk,this._defaultValue=t?mF(t):null,this._enumValues=t&&t.type==="enum"?t.values:null}evaluateWithoutErrorHandling(e,t,r,n,a,o){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,a,o){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n,this._evaluator.availableImages=a||null,this._evaluator.formattedSection=o||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new Sr(`Expected value to be one of ${Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", ")}, but found ${JSON.stringify(s)} instead.`);return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};h(sF,"StyleExpression");var h4=sF;function _d(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in _p}h(_d,"isExpression");function Jx(i,e){let t=new Mk(_p,Um,[],e?fF(e):void 0),r=t.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return r?Lv(new h4(r,e)):Iu(t.errors)}h(Jx,"createExpression");var lF=class{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!qp(t.expression)}evaluateWithoutErrorHandling(e,t,r,n,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,a,o)}evaluate(e,t,r,n,a,o){return this._styleExpression.evaluate(e,t,r,n,a,o)}};h(lF,"ZoomConstantExpression");var Dv=lF,uF=class{constructor(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!qp(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,r,n,a,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,a,o)}evaluate(e,t,r,n,a,o){return this._styleExpression.evaluate(e,t,r,n,a,o)}interpolationFactor(e,t,r){return this.interpolationType?Yo.interpolationFactor(this.interpolationType,e,t,r):0}};h(uF,"ZoomDependentExpression");var kv=uF;function c4(i,e){let t=Jx(i,e);if(t.result==="error")return t;let r=t.value.expression,n=yg(r);if(!n&&!uh(e))return Iu([new Go("","data expressions not supported")]);let a=vg(r,["zoom"]);if(!a&&!l4(e))return Iu([new Go("","zoom expressions not supported")]);let o=cm(r);if(!o&&!a)return Iu([new Go("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(o instanceof Go)return Iu([o]);if(o instanceof Yo&&!Yx(e))return Iu([new Go("",'"interpolate" expressions cannot be used with this property')]);if(!o)return Lv(n?new Dv("constant",t.value):new Dv("source",t.value));let s=o instanceof Yo?o.interpolation:void 0;return Lv(n?new kv("camera",t.value,o.labels,s):new kv("composite",t.value,o.labels,s))}h(c4,"createPropertyExpression");var hF=class cF{constructor(e,t){this._parameters=e,this._specification=t,lh(this,u4(this._parameters,this._specification))}static deserialize(e){return new cF(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}};h(hF,"StylePropertyFunction");var pF=hF;function dF(i,e){if(xg(i))return new pF(i,e);if(_d(i)){let t=c4(i,e);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));return t.value}else{let t=i;return e.type==="color"&&typeof i=="string"?t=zt.parse(i):e.type==="padding"&&(typeof i=="number"||Array.isArray(i))?t=js.parse(i):e.type==="variableAnchorOffsetCollection"&&Array.isArray(i)&&(t=bh.parse(i)),{kind:"constant",evaluate:()=>t}}}h(dF,"normalizePropertyExpression");function cm(i){let e=null;if(i instanceof Tk)e=cm(i.result);else if(i instanceof Yk){for(let t of i.args)if(e=cm(t),e)break}else(i instanceof JE||i instanceof Yo)&&i.input instanceof Mh&&i.input.name==="zoom"&&(e=i);return e instanceof Go||i.eachChild(t=>{let r=cm(t);r instanceof Go?e=r:!e&&r?e=new Go("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&r&&e!==r&&(e=new Go("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}h(cm,"findZoomCurve");function fF(i){let e={color:So,string:ti,number:nt,enum:ti,boolean:Zt,formatted:dg,padding:jx,resolvedImage:fg,variableAnchorOffsetCollection:Hx};return i.type==="array"?Hn(e[i.value]||Yt,i.length):e[i.type]}h(fF,"getExpectedType");function mF(i){return i.type==="color"&&xg(i.default)?new zt(0,0,0,0):i.type==="color"?zt.parse(i.default)||null:i.type==="padding"?js.parse(i.default)||null:i.type==="variableAnchorOffsetCollection"?bh.parse(i.default)||null:i.default===void 0?null:i.default}h(mF,"getDefaultValue");function Kx(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(let e of i.slice(1))if(!Kx(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}h(Kx,"isExpressionFilter");var Yhe={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Rv(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Kx(i)||(i=Vm(i));let e=Jx(i,Yhe);if(e.result==="error")throw new Error(e.value.map(t=>`${t.key}: ${t.message}`).join(", "));{let t=p4(i);return{filter:(r,n,a)=>e.value.evaluate(r,n,{},a),needGeometry:t}}}h(Rv,"createFilter");function gF(i,e){return i<e?-1:i>e?1:0}h(gF,"compare");function p4(i){if(!Array.isArray(i))return!1;if(i[0]==="within"||i[0]==="distance")return!0;for(let e=1;e<i.length;e++)if(p4(i[e]))return!0;return!1}h(p4,"geometryNeeded");function Vm(i){if(!i)return!0;let e=i[0];return i.length<=1?e!=="any":e==="=="?ky(i[1],i[2],"=="):e==="!="?df(ky(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ky(i[1],i[2],e):e==="any"?yF(i.slice(1)):e==="all"?["all"].concat(i.slice(1).map(Vm)):e==="none"?["all"].concat(i.slice(1).map(Vm).map(df)):e==="in"?g3(i[1],i.slice(2)):e==="!in"?df(g3(i[1],i.slice(2))):e==="has"?y3(i[1]):e==="!has"?df(y3(i[1])):!0}h(Vm,"convertFilter$1");function ky(i,e,t){switch(i){case"$type":return[`filter-type-${t}`,e];case"$id":return[`filter-id-${t}`,e];default:return[`filter-${t}`,i,e]}}h(ky,"convertComparisonOp$1");function yF(i){return["any"].concat(i.map(Vm))}h(yF,"convertDisjunctionOp");function g3(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(t=>typeof t!=typeof e[0])?["filter-in-large",i,["literal",e.sort(gF)]]:["filter-in-small",i,["literal",e]]}}h(g3,"convertInOp$1");function y3(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}h(y3,"convertHasOp$1");function df(i){return["!",i]}h(df,"convertNegation");function vF(){let i={},e=Le.$version;for(let t in Le.$root){let r=Le.$root[t];if(r.required){let n=null;t==="version"?n=e:r.type==="array"?n=[]:n={},n!=null&&(i[t]=n)}}return i}h(vF,"emptyStyle");function d4(i){let e=i.key,t=i.value;return t?[new Qe(e,t,"constants have been deprecated as of v8")]:[]}h(d4,"validateConstants");function tr(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}h(tr,"unbundle");function Hl(i){if(Array.isArray(i))return i.map(Hl);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){let e={};for(let t in i)e[t]=Hl(i[t]);return e}return tr(i)}h(Hl,"deepUnbundle");function fa(i){let e=i.key,t=i.value,r=i.valueSpec||{},n=i.objectElementValidators||{},a=i.style,o=i.styleSpec,s=i.validateSpec,l=[],u=pi(t);if(u!=="object")return[new Qe(e,t,`object expected, ${u} found`)];for(let c in t){let p=c.split(".")[0],d=r[p]||r["*"],m;if(n[p])m=n[p];else if(r[p])m=s;else if(n["*"])m=n["*"];else if(r["*"])m=s;else{l.push(new Qe(e,t[c],`unknown property "${c}"`));continue}l=l.concat(m({key:(e&&`${e}.`)+c,value:t[c],valueSpec:d,style:a,styleSpec:o,object:t,objectKey:c,validateSpec:s},t))}for(let c in r)n[c]||r[c].required&&r[c].default===void 0&&t[c]===void 0&&l.push(new Qe(e,t,`missing required property "${c}"`));return l}h(fa,"validateObject");function Qx(i){let e=i.value,t=i.valueSpec,r=i.validateSpec,n=i.style,a=i.styleSpec,o=i.key,s=i.arrayElementValidator||r;if(pi(e)!=="array")return[new Qe(o,e,`array expected, ${pi(e)} found`)];if(t.length&&e.length!==t.length)return[new Qe(o,e,`array length ${t.length} expected, length ${e.length} found`)];if(t["min-length"]&&e.length<t["min-length"])return[new Qe(o,e,`array length at least ${t["min-length"]} expected, length ${e.length} found`)];let l={type:t.value,values:t.values};a.$version<7&&(l.function=t.function),pi(t.value)==="object"&&(l=t.value);let u=[];for(let c=0;c<e.length;c++)u=u.concat(s({array:e,arrayIndex:c,value:e[c],valueSpec:l,validateSpec:i.validateSpec,style:n,styleSpec:a,key:`${o}[${c}]`}));return u}h(Qx,"validateArray");function e_(i){let e=i.key,t=i.value,r=i.valueSpec,n=pi(t);return n==="number"&&t!==t&&(n="NaN"),n!=="number"?[new Qe(e,t,`number expected, ${n} found`)]:"minimum"in r&&t<r.minimum?[new Qe(e,t,`${t} is less than the minimum value ${r.minimum}`)]:"maximum"in r&&t>r.maximum?[new Qe(e,t,`${t} is greater than the maximum value ${r.maximum}`)]:[]}h(e_,"validateNumber");function f4(i){let e=i.valueSpec,t=tr(i.value.type),r,n={},a,o,s=t!=="categorical"&&i.value.property===void 0,l=!s,u=pi(i.value.stops)==="array"&&pi(i.value.stops[0])==="array"&&pi(i.value.stops[0][0])==="object",c=fa({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:p,default:g}});return t==="identity"&&s&&c.push(new Qe(i.key,i.value,'missing required property "property"')),t!=="identity"&&!i.value.stops&&c.push(new Qe(i.key,i.value,'missing required property "stops"')),t==="exponential"&&i.valueSpec.expression&&!Yx(i.valueSpec)&&c.push(new Qe(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(l&&!uh(i.valueSpec)?c.push(new Qe(i.key,i.value,"property functions not supported")):s&&!l4(i.valueSpec)&&c.push(new Qe(i.key,i.value,"zoom functions not supported"))),(t==="categorical"||u)&&i.value.property===void 0&&c.push(new Qe(i.key,i.value,'"property" property is required')),c;function p(_){if(t==="identity")return[new Qe(_.key,_.value,'identity function may not have a "stops" property')];let y=[],x=_.value;return y=y.concat(Qx({key:_.key,value:x,valueSpec:_.valueSpec,validateSpec:_.validateSpec,style:_.style,styleSpec:_.styleSpec,arrayElementValidator:d})),pi(x)==="array"&&x.length===0&&y.push(new Qe(_.key,x,"array must have at least one stop")),y}function d(_){let y=[],x=_.value,w=_.key;if(pi(x)!=="array")return[new Qe(w,x,`array expected, ${pi(x)} found`)];if(x.length!==2)return[new Qe(w,x,`array length 2 expected, length ${x.length} found`)];if(u){if(pi(x[0])!=="object")return[new Qe(w,x,`object expected, ${pi(x[0])} found`)];if(x[0].zoom===void 0)return[new Qe(w,x,"object stop key must have zoom")];if(x[0].value===void 0)return[new Qe(w,x,"object stop key must have value")];if(o&&o>tr(x[0].zoom))return[new Qe(w,x[0].zoom,"stop zoom values must appear in ascending order")];tr(x[0].zoom)!==o&&(o=tr(x[0].zoom),a=void 0,n={}),y=y.concat(fa({key:`${w}[0]`,value:x[0],valueSpec:{zoom:{}},validateSpec:_.validateSpec,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{zoom:e_,value:m}}))}else y=y.concat(m({key:`${w}[0]`,value:x[0],valueSpec:{},validateSpec:_.validateSpec,style:_.style,styleSpec:_.styleSpec},x));return _d(Hl(x[1]))?y.concat([new Qe(`${w}[1]`,x[1],"expressions are not allowed in function stops.")]):y.concat(_.validateSpec({key:`${w}[1]`,value:x[1],valueSpec:e,validateSpec:_.validateSpec,style:_.style,styleSpec:_.styleSpec}))}function m(_,y){let x=pi(_.value),w=tr(_.value),b=_.value!==null?_.value:y;if(!r)r=x;else if(x!==r)return[new Qe(_.key,b,`${x} stop domain type must match previous stop domain type ${r}`)];if(x!=="number"&&x!=="string"&&x!=="boolean")return[new Qe(_.key,b,"stop domain value must be a number, string, or boolean")];if(x!=="number"&&t!=="categorical"){let C=`number expected, ${x} found`;return uh(e)&&t===void 0&&(C+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Qe(_.key,b,C)]}return t==="categorical"&&x==="number"&&(!isFinite(w)||Math.floor(w)!==w)?[new Qe(_.key,b,`integer expected, found ${w}`)]:t!=="categorical"&&x==="number"&&a!==void 0&&w<a?[new Qe(_.key,b,"stop domain values must appear in ascending order")]:(a=w,t==="categorical"&&w in n?[new Qe(_.key,b,"stop domain values must be unique")]:(n[w]=!0,[]))}function g(_){return _.validateSpec({key:_.key,value:_.value,valueSpec:e,validateSpec:_.validateSpec,style:_.style,styleSpec:_.styleSpec})}}h(f4,"validateFunction");function hh(i){let e=(i.expressionContext==="property"?c4:Jx)(Hl(i.value),i.valueSpec);if(e.result==="error")return e.value.map(r=>new Qe(`${i.key}${r.key}`,i.value,r.message));let t=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!t.outputDefined())return[new Qe(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!qp(t))return[new Qe(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!qp(t))return[new Qe(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!vg(t,["zoom","feature-state"]))return[new Qe(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!yg(t))return[new Qe(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}h(hh,"validateExpression");function xF(i){let e=i.value,t=i.key,r=pi(e);return r!=="boolean"?[new Qe(t,e,`boolean expected, ${r} found`)]:[]}h(xF,"validateBoolean");function _F(i){let e=i.key,t=i.value,r=pi(t);return r!=="string"?[new Qe(e,t,`color expected, ${r} found`)]:zt.parse(String(t))?[]:[new Qe(e,t,`color expected, "${t}" found`)]}h(_F,"validateColor");function Zp(i){let e=i.key,t=i.value,r=i.valueSpec,n=[];return Array.isArray(r.values)?r.values.indexOf(tr(t))===-1&&n.push(new Qe(e,t,`expected one of [${r.values.join(", ")}], ${JSON.stringify(t)} found`)):Object.keys(r.values).indexOf(tr(t))===-1&&n.push(new Qe(e,t,`expected one of [${Object.keys(r.values).join(", ")}], ${JSON.stringify(t)} found`)),n}h(Zp,"validateEnum");function t_(i){return Kx(Hl(i.value))?hh(lh({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):m4(i)}h(t_,"validateFilter");function m4(i){let e=i.value,t=i.key;if(pi(e)!=="array")return[new Qe(t,e,`array expected, ${pi(e)} found`)];let r=i.styleSpec,n,a=[];if(e.length<1)return[new Qe(t,e,"filter array must have at least 1 element")];switch(a=a.concat(Zp({key:`${t}[0]`,value:e[0],valueSpec:r.filter_operator,style:i.style,styleSpec:i.styleSpec})),tr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&tr(e[1])==="$type"&&a.push(new Qe(t,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&a.push(new Qe(t,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(n=pi(e[1]),n!=="string"&&a.push(new Qe(`${t}[1]`,e[1],`string expected, ${n} found`)));for(let o=2;o<e.length;o++)n=pi(e[o]),tr(e[1])==="$type"?a=a.concat(Zp({key:`${t}[${o}]`,value:e[o],valueSpec:r.geometry_type,style:i.style,styleSpec:i.styleSpec})):n!=="string"&&n!=="number"&&n!=="boolean"&&a.push(new Qe(`${t}[${o}]`,e[o],`string, number, or boolean expected, ${n} found`));break;case"any":case"all":case"none":for(let o=1;o<e.length;o++)a=a.concat(m4({key:`${t}[${o}]`,value:e[o],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":n=pi(e[1]),e.length!==2?a.push(new Qe(t,e,`filter array for "${e[0]}" operator must have 2 elements`)):n!=="string"&&a.push(new Qe(`${t}[1]`,e[1],`string expected, ${n} found`));break}return a}h(m4,"validateNonExpressionFilter");function g4(i,e){let t=i.key,r=i.validateSpec,n=i.style,a=i.styleSpec,o=i.value,s=i.objectKey,l=a[`${e}_${i.layerType}`];if(!l)return[];let u=s.match(/^(.*)-transition$/);if(e==="paint"&&u&&l[u[1]]&&l[u[1]].transition)return r({key:t,value:o,valueSpec:a.transition,style:n,styleSpec:a});let c=i.valueSpec||l[s];if(!c)return[new Qe(t,o,`unknown property "${s}"`)];let p;if(pi(o)==="string"&&uh(c)&&!c.tokens&&(p=/^{([^}]+)}$/.exec(o)))return[new Qe(t,o,`"${s}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(p[1])} }\`.`)];let d=[];return i.layerType==="symbol"&&(s==="text-field"&&n&&!n.glyphs&&d.push(new Qe(t,o,'use of "text-field" requires a style "glyphs" property')),s==="text-font"&&xg(Hl(o))&&tr(o.type)==="identity"&&d.push(new Qe(t,o,'"text-font" does not support identity functions'))),d.concat(r({key:i.key,value:o,valueSpec:c,style:n,styleSpec:a,expressionContext:"property",propertyType:e,propertyKey:s}))}h(g4,"validateProperty");function y4(i){return g4(i,"paint")}h(y4,"validatePaintProperty");function v4(i){return g4(i,"layout")}h(v4,"validateLayoutProperty");function x4(i){let e=[],t=i.value,r=i.key,n=i.style,a=i.styleSpec;!t.type&&!t.ref&&e.push(new Qe(r,t,'either "type" or "ref" is required'));let o=tr(t.type),s=tr(t.ref);if(t.id){let l=tr(t.id);for(let u=0;u<i.arrayIndex;u++){let c=n.layers[u];tr(c.id)===l&&e.push(new Qe(r,t.id,`duplicate layer id "${t.id}", previously used at line ${c.id.__line__}`))}}if("ref"in t){["type","source","source-layer","filter","layout"].forEach(u=>{u in t&&e.push(new Qe(r,t[u],`"${u}" is prohibited for ref layers`))});let l;n.layers.forEach(u=>{tr(u.id)===s&&(l=u)}),l?l.ref?e.push(new Qe(r,t.ref,"ref cannot reference another ref layer")):o=tr(l.type):e.push(new Qe(r,t.ref,`ref layer "${s}" not found`))}else if(o!=="background")if(!t.source)e.push(new Qe(r,t,'missing required property "source"'));else{let l=n.sources&&n.sources[t.source],u=l&&tr(l.type);l?u==="vector"&&o==="raster"?e.push(new Qe(r,t.source,`layer "${t.id}" requires a raster source`)):u!=="raster-dem"&&o==="hillshade"?e.push(new Qe(r,t.source,`layer "${t.id}" requires a raster-dem source`)):u==="raster"&&o!=="raster"?e.push(new Qe(r,t.source,`layer "${t.id}" requires a vector source`)):u==="vector"&&!t["source-layer"]?e.push(new Qe(r,t,`layer "${t.id}" must specify a "source-layer"`)):u==="raster-dem"&&o!=="hillshade"?e.push(new Qe(r,t.source,"raster-dem source can only be used with layer type 'hillshade'.")):o==="line"&&t.paint&&t.paint["line-gradient"]&&(u!=="geojson"||!l.lineMetrics)&&e.push(new Qe(r,t,`layer "${t.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Qe(r,t.source,`source "${t.source}" not found`))}return e=e.concat(fa({key:r,value:t,valueSpec:a.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*"(){return[]},type(){return i.validateSpec({key:`${r}.type`,value:t.type,valueSpec:a.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:t,objectKey:"type"})},filter:t_,layout(l){return fa({layer:t,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return v4(lh({layerType:o},u))}}})},paint(l){return fa({layer:t,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return y4(lh({layerType:o},u))}}})}}})),e}h(x4,"validateLayer");function Gl(i){let e=i.value,t=i.key,r=pi(e);return r!=="string"?[new Qe(t,e,`string expected, ${r} found`)]:[]}h(Gl,"validateString");function bF(i){var e;let t=(e=i.sourceName)!==null&&e!==void 0?e:"",r=i.value,n=i.styleSpec,a=n.source_raster_dem,o=i.style,s=[],l=pi(r);if(r===void 0)return s;if(l!=="object")return s.push(new Qe("source_raster_dem",r,`object expected, ${l} found`)),s;let u=tr(r.encoding)==="custom",c=["redFactor","greenFactor","blueFactor","baseShift"],p=i.value.encoding?`"${i.value.encoding}"`:"Default";for(let d in r)!u&&c.includes(d)?s.push(new Qe(d,r[d],`In "${t}": "${d}" is only valid when "encoding" is set to "custom". ${p} encoding found`)):a[d]?s=s.concat(i.validateSpec({key:d,value:r[d],valueSpec:a[d],validateSpec:i.validateSpec,style:o,styleSpec:n})):s.push(new Qe(d,r[d],`unknown property "${d}"`));return s}h(bF,"validateRasterDEMSource");var t6={promoteId:wF};function _4(i){let e=i.value,t=i.key,r=i.styleSpec,n=i.style,a=i.validateSpec;if(!e.type)return[new Qe(t,e,'"type" is required')];let o=tr(e.type),s;switch(o){case"vector":case"raster":return s=fa({key:t,value:e,valueSpec:r[`source_${o.replace("-","_")}`],style:i.style,styleSpec:r,objectElementValidators:t6,validateSpec:a}),s;case"raster-dem":return s=bF({sourceName:t,value:e,style:i.style,styleSpec:r,validateSpec:a}),s;case"geojson":if(s=fa({key:t,value:e,valueSpec:r.source_geojson,style:n,styleSpec:r,validateSpec:a,objectElementValidators:t6}),e.cluster)for(let l in e.clusterProperties){let[u,c]=e.clusterProperties[l],p=typeof u=="string"?[u,["accumulated"],["get",l]]:u;s.push(...hh({key:`${t}.${l}.map`,value:c,validateSpec:a,expressionContext:"cluster-map"})),s.push(...hh({key:`${t}.${l}.reduce`,value:p,validateSpec:a,expressionContext:"cluster-reduce"}))}return s;case"video":return fa({key:t,value:e,valueSpec:r.source_video,style:n,validateSpec:a,styleSpec:r});case"image":return fa({key:t,value:e,valueSpec:r.source_image,style:n,validateSpec:a,styleSpec:r});case"canvas":return[new Qe(t,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Zp({key:`${t}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:n,validateSpec:a,styleSpec:r})}}h(_4,"validateSource");function wF({key:i,value:e}){if(pi(e)==="string")return Gl({key:i,value:e});{let t=[];for(let r in e)t.push(...Gl({key:`${i}.${r}`,value:e[r]}));return t}}h(wF,"validatePromoteId");function b4(i){let e=i.value,t=i.styleSpec,r=t.light,n=i.style,a=[],o=pi(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new Qe("light",e,`object expected, ${o} found`)]),a;for(let s in e){let l=s.match(/^(.*)-transition$/);l&&r[l[1]]&&r[l[1]].transition?a=a.concat(i.validateSpec({key:s,value:e[s],valueSpec:t.transition,validateSpec:i.validateSpec,style:n,styleSpec:t})):r[s]?a=a.concat(i.validateSpec({key:s,value:e[s],valueSpec:r[s],validateSpec:i.validateSpec,style:n,styleSpec:t})):a=a.concat([new Qe(s,e[s],`unknown property "${s}"`)])}return a}h(b4,"validateLight");function w4(i){let e=i.value,t=i.styleSpec,r=t.sky,n=i.style,a=pi(e);if(e===void 0)return[];if(a!=="object")return[new Qe("sky",e,`object expected, ${a} found`)];let o=[];for(let s in e)r[s]?o=o.concat(i.validateSpec({key:s,value:e[s],valueSpec:r[s],style:n,styleSpec:t})):o=o.concat([new Qe(s,e[s],`unknown property "${s}"`)]);return o}h(w4,"validateSky");function S4(i){let e=i.value,t=i.styleSpec,r=t.terrain,n=i.style,a=[],o=pi(e);if(e===void 0)return a;if(o!=="object")return a=a.concat([new Qe("terrain",e,`object expected, ${o} found`)]),a;for(let s in e)r[s]?a=a.concat(i.validateSpec({key:s,value:e[s],valueSpec:r[s],validateSpec:i.validateSpec,style:n,styleSpec:t})):a=a.concat([new Qe(s,e[s],`unknown property "${s}"`)]);return a}h(S4,"validateTerrain");function SF(i){return Gl(i).length===0?[]:hh(i)}h(SF,"validateFormatted");function MF(i){return Gl(i).length===0?[]:hh(i)}h(MF,"validateImage");function CF(i){let e=i.key,t=i.value;if(pi(t)==="array"){if(t.length<1||t.length>4)return[new Qe(e,t,`padding requires 1 to 4 values; ${t.length} values found`)];let r={type:"number"},n=[];for(let a=0;a<t.length;a++)n=n.concat(i.validateSpec({key:`${e}[${a}]`,value:t[a],validateSpec:i.validateSpec,valueSpec:r}));return n}else return e_({key:e,value:t,valueSpec:{}})}h(CF,"validatePadding");function EF(i){let e=i.key,t=i.value,r=pi(t),n=i.styleSpec;if(r!=="array"||t.length<1||t.length%2!==0)return[new Qe(e,t,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let o=0;o<t.length;o+=2)a=a.concat(Zp({key:`${e}[${o}]`,value:t[o],valueSpec:n.layout_symbol["text-anchor"]})),a=a.concat(Qx({key:`${e}[${o+1}]`,value:t[o+1],valueSpec:{length:2,value:"number"},validateSpec:i.validateSpec,style:i.style,styleSpec:n}));return a}h(EF,"validateVariableAnchorOffsetCollection");function M4(i){let e=[],t=i.value,r=i.key;if(Array.isArray(t)){let n=[],a=[];for(let o in t){t[o].id&&n.includes(t[o].id)&&e.push(new Qe(r,t,`all the sprites' ids must be unique, but ${t[o].id} is duplicated`)),n.push(t[o].id),t[o].url&&a.includes(t[o].url)&&e.push(new Qe(r,t,`all the sprites' URLs must be unique, but ${t[o].url} is duplicated`)),a.push(t[o].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};e=e.concat(fa({key:`${r}[${o}]`,value:t[o],valueSpec:s,validateSpec:i.validateSpec}))}return e}else return Gl({key:r,value:t})}h(M4,"validateSprite");function TF(i){let e=i.value,t=i.styleSpec,r=t.projection,n=i.style,a=pi(e);if(e===void 0)return[];if(a!=="object")return[new Qe("projection",e,`object expected, ${a} found`)];let o=[];for(let s in e)r[s]?o=o.concat(i.validateSpec({key:s,value:e[s],valueSpec:r[s],style:n,styleSpec:t})):o=o.concat([new Qe(s,e[s],`unknown property "${s}"`)]);return o}h(TF,"validateProjection");var i6={"*"(){return[]},array:Qx,boolean:xF,number:e_,color:_F,constants:d4,enum:Zp,filter:t_,function:f4,layer:x4,object:fa,source:_4,light:b4,sky:w4,terrain:S4,projection:TF,string:Gl,formatted:SF,resolvedImage:MF,padding:CF,variableAnchorOffsetCollection:EF,sprite:M4};function bp(i){let e=i.value,t=i.valueSpec,r=i.styleSpec;return i.validateSpec=bp,t.expression&&xg(tr(e))?f4(i):t.expression&&_d(Hl(e))?hh(i):t.type&&i6[t.type]?i6[t.type](i):fa(lh({},i,{valueSpec:t.type?r[t.type]:t}))}h(bp,"validate");function C4(i){let e=i.value,t=i.key,r=Gl(i);return r.length||(e.indexOf("{fontstack}")===-1&&r.push(new Qe(t,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&r.push(new Qe(t,e,'"glyphs" url must include a "{range}" token'))),r}h(C4,"validateGlyphsUrl");function qa(i,e=Le){let t=[];return t=t.concat(bp({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,validateSpec:bp,objectElementValidators:{glyphs:C4,"*"(){return[]}}})),i.constants&&(t=t.concat(d4({key:"constants",value:i.constants,style:i,styleSpec:e,validateSpec:bp}))),E4(t)}h(qa,"validateStyleMin");qa.source=Ao(Po(_4));qa.sprite=Ao(Po(M4));qa.glyphs=Ao(Po(C4));qa.light=Ao(Po(b4));qa.sky=Ao(Po(w4));qa.terrain=Ao(Po(S4));qa.layer=Ao(Po(x4));qa.filter=Ao(Po(t_));qa.paintProperty=Ao(Po(y4));qa.layoutProperty=Ao(Po(v4));function Po(i){return function(e){return i({...e,validateSpec:bp})}}h(Po,"injectValidateSpec");function E4(i){return[].concat(i).sort((e,t)=>e.line-t.line)}h(E4,"sortErrors");function Ao(i){return function(...e){return E4(i.apply(this,e))}}h(Ao,"wrapCleanErrors");R();var Or=qa;Or.source;var Jhe=Or.light;Or.terrain;Or.filter;var Khe=Or.paintProperty,Qhe=Or.layoutProperty;function i_(i,e){let t=!1;if(e&&e.length)for(let r of e)i.fire(new Et(new Error(r.message))),t=!0;return t}h(i_,"emitValidationErrors");R();R();R();var PF=class AF{constructor(e,t,r){let n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;let o=new Int32Array(this.arrayBuffer);e=o[0],t=o[1],r=o[2],this.d=t+2*r;for(let u=0;u<this.d*this.d;u++){let c=o[3+u],p=o[3+u+1];n.push(c===p?null:o.subarray(c,p))}let s=o[3+n.length],l=o[3+n.length+1];this.keys=o.subarray(s,l),this.bboxes=o.subarray(l),this.insert=this._insertReadonly}else{this.d=t+2*r;for(let o=0;o<this.d*this.d;o++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;let a=r/t*e;this.min=-a,this.max=e+a}insert(e,t,r,n,a){this._forEachCell(t,r,n,a,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,r,n,a,o){this.cells[a].push(o)}query(e,t,r,n,a){let o=this.min,s=this.max;if(e<=o&&t<=o&&s<=r&&s<=n&&!a)return Array.prototype.slice.call(this.keys);{let l=[],u={};return this._forEachCell(e,t,r,n,this._queryCell,l,u,a),l}}_queryCell(e,t,r,n,a,o,s,l){let u=this.cells[a];if(u!==null){let c=this.keys,p=this.bboxes;for(let d=0;d<u.length;d++){let m=u[d];if(s[m]===void 0){let g=m*4;(l?l(p[g+0],p[g+1],p[g+2],p[g+3]):e<=p[g+2]&&t<=p[g+3]&&r>=p[g+0]&&n>=p[g+1])?(s[m]=!0,o.push(c[m])):s[m]=!1}}}}_forEachCell(e,t,r,n,a,o,s,l){let u=this._convertToCellCoord(e),c=this._convertToCellCoord(t),p=this._convertToCellCoord(r),d=this._convertToCellCoord(n);for(let m=u;m<=p;m++)for(let g=c;g<=d;g++){let _=this.d*g+m;if(!(l&&!l(this._convertFromCellCoord(m),this._convertFromCellCoord(g),this._convertFromCellCoord(m+1),this._convertFromCellCoord(g+1)))&&a.call(this,e,t,r,n,_,o,s,l))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let e=this.cells,t=3+this.cells.length+1+1,r=0;for(let o=0;o<this.cells.length;o++)r+=this.cells[o].length;let n=new Int32Array(t+r+this.keys.length+this.bboxes.length);n[0]=this.extent,n[1]=this.n,n[2]=this.padding;let a=t;for(let o=0;o<e.length;o++){let s=e[o];n[3+o]=a,n.set(s,a),a+=s.length}return n[3+e.length]=a,n.set(this.keys,a),a+=this.keys.length,n[3+e.length+1]=a,n.set(this.bboxes,a),a+=this.bboxes.length,n.buffer}static serialize(e,t){let r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}}static deserialize(e){return new AF(e.buffer)}};h(PF,"TransferableGridIndex");var v3=PF,zl={};function ut(i,e,t={}){if(zl[i])throw new Error(`${i} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:i,writeable:!1}),zl[i]={klass:e,omit:t.omit||[],shallow:t.shallow||[]}}h(ut,"register");ut("Object",Object);ut("TransferableGridIndex",v3);ut("Color",zt);ut("Error",Error);ut("AJAXError",zE);ut("ResolvedImage",es);ut("StylePropertyFunction",pF);ut("StyleExpression",h4,{omit:["_evaluator"]});ut("ZoomDependentExpression",kv);ut("ZoomConstantExpression",Dv);ut("CompoundExpression",Mh,{omit:["_evaluate"]});for(let i in _p)_p[i]._classRegistryKey||ut(`Expression_${i}`,_p[i]);function T4(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}h(T4,"isArrayBuffer");function wp(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error)return i;if(T4(i)||qo(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){let t=i;return e&&e.push(t.buffer),t}if(i instanceof ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){let t=[];for(let r of i)t.push(wp(r,e));return t}if(typeof i=="object"){let t=i.constructor,r=t._classRegistryKey;if(!r)throw new Error(`can't serialize object of unregistered class ${t.name}`);if(!zl[r])throw new Error(`${r} is not registered.`);let n=t.serialize?t.serialize(i,e):{};if(t.serialize){if(e&&n===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let a in i){if(!i.hasOwnProperty(a)||zl[r].omit.indexOf(a)>=0)continue;let o=i[a];n[a]=zl[r].shallow.indexOf(a)>=0?o:wp(o,e)}i instanceof Error&&(n.message=i.message)}if(n.$name)throw new Error("$name property is reserved for worker serialization logic.");return r!=="Object"&&(n.$name=r),n}throw new Error(`can't serialize object of type ${typeof i}`)}h(wp,"serialize");function Sp(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||i instanceof Error||T4(i)||qo(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(Sp);if(typeof i=="object"){let e=i.$name||"Object";if(!zl[e])throw new Error(`can't deserialize unregistered class ${e}`);let{klass:t}=zl[e];if(!t)throw new Error(`can't deserialize unregistered class ${e}`);if(t.deserialize)return t.deserialize(i);let r=Object.create(t.prototype);for(let n of Object.keys(i)){if(n==="$name")continue;let a=i[n];r[n]=zl[e].shallow.indexOf(n)>=0?a:Sp(a)}return r}throw new Error(`can't deserialize object of type ${typeof i}`)}h(Sp,"deserialize");R();R();var IF=class{constructor(){this.first=!0}update(e,t){let r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom?(this.lastZoom=e,this.lastFloorZoom=r,!0):!1)}};h(IF,"ZoomHistory");var LF=IF;R();R();var ai={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function DF(i){for(let e of i)if(kF(e.charCodeAt(0)))return!0;return!1}h(DF,"allowsVerticalWritingMode");function kF(i){return i===746||i===747?!0:i<4352?!1:!!(ai["Bopomofo Extended"](i)||ai.Bopomofo(i)||ai["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||ai["CJK Compatibility Ideographs"](i)||ai["CJK Compatibility"](i)||ai["CJK Radicals Supplement"](i)||ai["CJK Strokes"](i)||ai["CJK Symbols and Punctuation"](i)&&!(i>=12296&&i<=12305)&&!(i>=12308&&i<=12319)&&i!==12336||ai["CJK Unified Ideographs Extension A"](i)||ai["CJK Unified Ideographs"](i)||ai["Enclosed CJK Letters and Months"](i)||ai["Hangul Compatibility Jamo"](i)||ai["Hangul Jamo Extended-A"](i)||ai["Hangul Jamo Extended-B"](i)||ai["Hangul Jamo"](i)||ai["Hangul Syllables"](i)||ai.Hiragana(i)||ai["Ideographic Description Characters"](i)||ai.Kanbun(i)||ai["Kangxi Radicals"](i)||ai["Katakana Phonetic Extensions"](i)||ai.Katakana(i)&&i!==12540||ai["Halfwidth and Fullwidth Forms"](i)&&i!==65288&&i!==65289&&i!==65293&&!(i>=65306&&i<=65310)&&i!==65339&&i!==65341&&i!==65343&&!(i>=65371&&i<=65503)&&i!==65507&&!(i>=65512&&i<=65519)||ai["Small Form Variants"](i)&&!(i>=65112&&i<=65118)&&!(i>=65123&&i<=65126)||ai["Unified Canadian Aboriginal Syllabics"](i)||ai["Unified Canadian Aboriginal Syllabics Extended"](i)||ai["Vertical Forms"](i)||ai["Yijing Hexagram Symbols"](i)||ai["Yi Syllables"](i)||ai["Yi Radicals"](i))}h(kF,"charHasUprightVerticalOrientation");function P4(i){return i>=1424&&i<=2303||ai["Arabic Presentation Forms-A"](i)||ai["Arabic Presentation Forms-B"](i)}h(P4,"charInRTLScript");function RF(i,e){return!(!e&&P4(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||ai.Khmer(i))}h(RF,"charInSupportedScript");function FF(i){for(let e of i)if(P4(e.charCodeAt(0)))return!0;return!1}h(FF,"stringContainsRTLText");function OF(i,e){for(let t of i)if(!RF(t.charCodeAt(0),e))return!1;return!0}h(OF,"isStringInSupportedScript");R();var BF=class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};h(BF,"RTLWorkerPlugin");var ece=BF,jm=new ece,zF=class{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new LF,this.transition={})}isSupportedScript(e){return OF(e,jm.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}}};h(zF,"EvaluationParameters");var Dr=zF,NF=class{constructor(e,t){this.property=e,this.value=t,this.expression=dF(t===void 0?e.specification.default:t,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}};h(NF,"PropertyValue");var r_=NF,$F=class{constructor(e){this.property=e,this.value=new r_(e,void 0)}transitioned(e,t){return new r6(this.property,this.value,t,pt({},e.transition,this.transition),e.now)}untransitioned(){return new r6(this.property,this.value,null,{},0)}};h($F,"TransitionablePropertyValue");var x3=$F,UF=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return da(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new x3(this._values[e].property)),this._values[e].value=new r_(this._values[e].property,t===null?void 0:da(t))}getTransition(e){return da(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new x3(this._values[e].property)),this._values[e].transition=da(t)||void 0}serialize(){let e={};for(let t of Object.keys(this._values)){let r=this.getValue(t);r!==void 0&&(e[t]=r);let n=this.getTransition(t);n!==void 0&&(e[`${t}-transition`]=n)}return e}transitioned(e,t){let r=new n6(this._properties);for(let n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(e,t._values[n]);return r}untransitioned(){let e=new n6(this._properties);for(let t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}};h(UF,"Transitionable");var VF=UF,jF=class{constructor(e,t,r,n,a){this.property=e,this.value=t,this.begin=a+n.delay||0,this.end=this.begin+n.duration||0,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){let n=e.now||0,a=this.value.possiblyEvaluate(e,t,r),o=this.prior;if(o){if(n>this.end)return this.prior=null,a;if(this.value.isDataDriven())return this.prior=null,a;if(n<this.begin)return o.possiblyEvaluate(e,t,r);{let s=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,r),a,gD(s))}}else return a}};h(jF,"TransitioningPropertyValue");var r6=jF,HF=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){let n=new n_(this._properties);for(let a of Object.keys(this._values))n._values[a]=this._values[a].possiblyEvaluate(e,t,r);return n}hasTransition(){for(let e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}};h(HF,"Transitioning");var n6=HF,GF=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return da(this._values[e].value)}setValue(e,t){this._values[e]=new r_(this._values[e].property,t===null?void 0:da(t))}serialize(){let e={};for(let t of Object.keys(this._values)){let r=this.getValue(t);r!==void 0&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){let n=new n_(this._properties);for(let a of Object.keys(this._values))n._values[a]=this._values[a].possiblyEvaluate(e,t,r);return n}};h(GF,"Layout");var tce=GF,WF=class{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}};h(WF,"PossiblyEvaluatedPropertyValue");var xo=WF,XF=class{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}};h(XF,"PossiblyEvaluated");var n_=XF,qF=class{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,r){let n=this.specification.type,a=Wi[n];return a?a(e,t,r):e}};h(qF,"DataConstantProperty");var yt=qF,ZF=class{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,n){return e.expression.kind==="constant"||e.expression.kind==="camera"?new xo(this,{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)},t):new xo(this,e.expression,t)}interpolate(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new xo(this,{kind:"constant",value:void 0},e.parameters);let n=this.specification.type,a=Wi[n];if(a){let o=a(e.value.value,t.value.value,r);return new xo(this,{kind:"constant",value:o},e.parameters)}else return e}evaluate(e,t,r,n,a,o){return e.kind==="constant"?e.value:e.evaluate(t,r,n,a,o)}};h(ZF,"DataDrivenProperty");var Ct=ZF,YF=class extends Ct{possiblyEvaluate(e,t,r,n){if(e.value===void 0)return new xo(this,{kind:"constant",value:void 0},t);if(e.expression.kind==="constant"){let a=e.expression.evaluate(t,null,{},r,n),o=e.property.specification.type==="resolvedImage"&&typeof a!="string"?a.name:a,s=this._calculate(o,o,o,t);return new xo(this,{kind:"constant",value:s},t)}else if(e.expression.kind==="camera"){let a=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new xo(this,{kind:"constant",value:a},t)}else return new xo(this,e.expression,t)}evaluate(e,t,r,n,a,o){if(e.kind==="source"){let s=e.evaluate(t,r,n,a,o);return this._calculate(s,s,s,t)}else return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},r,n),e.evaluate({zoom:Math.floor(t.zoom)},r,n),e.evaluate({zoom:Math.floor(t.zoom)+1},r,n),t):e.value}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}};h(YF,"CrossFadedDataDrivenProperty");var a_=YF,JF=class{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){if(e.value!==void 0)if(e.expression.kind==="constant"){let a=e.expression.evaluate(t,null,{},r,n);return this._calculate(a,a,a,t)}else return this._calculate(e.expression.evaluate(new Dr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new Dr(Math.floor(t.zoom),t)),e.expression.evaluate(new Dr(Math.floor(t.zoom+1),t)),t)}_calculate(e,t,r,n){return n.zoom>n.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}}interpolate(e){return e}};h(JF,"CrossFadedProperty");var A4=JF,KF=class{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}interpolate(){return!1}};h(KF,"ColorRampProperty");var I4=KF,QF=class{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let t in e){let r=e[t];r.specification.overridable&&this.overridableProperties.push(t);let n=this.defaultPropertyValues[t]=new r_(r,void 0),a=this.defaultTransitionablePropertyValues[t]=new x3(r);this.defaultTransitioningPropertyValues[t]=a.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=n.possiblyEvaluate({})}}};h(QF,"Properties");var ia=QF;ut("DataDrivenProperty",Ct);ut("DataConstantProperty",yt);ut("CrossFadedDataDrivenProperty",a_);ut("CrossFadedProperty",A4);ut("ColorRampProperty",I4);var o1="-transition",eO=class extends mn{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(e=e,this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new tce(t.layout)),t.paint)){this._transitionablePaint=new VF(t.paint);for(let r in e.paint)this.setPaintProperty(r,e.paint[r],{validate:!1});for(let r in e.layout)this.setLayoutProperty(r,e.layout[r],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new n_(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,r={}){if(t!=null){let n=`layers.${this.id}.layout.${e}`;if(this._validate(Qhe,n,e,t,r))return}if(e==="visibility"){this.visibility=t;return}this._unevaluatedLayout.setValue(e,t)}getPaintProperty(e){return e.endsWith(o1)?this._transitionablePaint.getTransition(e.slice(0,-o1.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(t!=null){let n=`layers.${this.id}.paint.${e}`;if(this._validate(Khe,n,e,t,r))return!1}if(e.endsWith(o1))return this._transitionablePaint.setTransition(e.slice(0,-o1.length),t||void 0),!1;{let n=this._transitionablePaint._values[e],a=n.property.specification["property-type"]==="cross-faded-data-driven",o=n.value.isDataDriven(),s=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);let l=this._transitionablePaint._values[e].value;return l.isDataDriven()||o||a||this._handleOverridablePaintPropertyUpdate(e,s,l)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e){return this.minzoom&&e<this.minzoom||this.maxzoom&&e>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){let e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),OE(e,(t,r)=>t!==void 0&&!(r==="layout"&&!Object.keys(t).length)&&!(r==="paint"&&!Object.keys(t).length))}_validate(e,t,r,n,a={}){return a&&a.validate===!1?!1:i_(this,e.call(Or,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:Le,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let e in this.paint._values){let t=this.paint.get(e);if(!(!(t instanceof xo)||!uh(t.property.specification))&&(t.value.kind==="source"||t.value.kind==="composite")&&t.value.isStateDependent)return!0}return!1}};h(eO,"StyleLayer");var is=eO;R();R();R();var ice={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},tO=class{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}};h(tO,"Struct");var _g=tO,rce=128,nce=5,iO=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){let t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(this.capacity*nce),rce),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};h(iO,"StructArray");var sr=iO;function Yi(i,e=1){let t=0,r=0,n=i.map(o=>{let s=rO(o.type),l=t=_3(t,Math.max(e,s)),u=o.components||1;return r=Math.max(r,s),t+=s*u,{name:o.name,type:o.type,components:u,offset:l}}),a=_3(t,Math.max(r,e));return{members:n,size:a,alignment:e}}h(Yi,"createLayout");function rO(i){return ice[i].BYTES_PER_ELEMENT}h(rO,"sizeOf");function _3(i,e){return Math.ceil(i/e)*e}h(_3,"align");var ace=kt(gi(),1),nO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let n=e*2;return this.int16[n+0]=t,this.int16[n+1]=r,e}};h(nO,"StructArrayLayout2i4");var bg=nO;bg.prototype.bytesPerElement=4;ut("StructArrayLayout2i4",bg);var aO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*3;return this.int16[a+0]=t,this.int16[a+1]=r,this.int16[a+2]=n,e}};h(aO,"StructArrayLayout3i6");var o_=aO;o_.prototype.bytesPerElement=6;ut("StructArrayLayout3i6",o_);var oO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n)}emplace(e,t,r,n,a){let o=e*4;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=n,this.int16[o+3]=a,e}};h(oO,"StructArrayLayout4i8");var L4=oO;L4.prototype.bytesPerElement=8;ut("StructArrayLayout4i8",L4);var sO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,a,o)}emplace(e,t,r,n,a,o,s){let l=e*6;return this.int16[l+0]=t,this.int16[l+1]=r,this.int16[l+2]=n,this.int16[l+3]=a,this.int16[l+4]=o,this.int16[l+5]=s,e}};h(sO,"StructArrayLayout2i4i12");var D4=sO;D4.prototype.bytesPerElement=12;ut("StructArrayLayout2i4i12",D4);var lO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,a,o)}emplace(e,t,r,n,a,o,s){let l=e*4,u=e*8;return this.int16[l+0]=t,this.int16[l+1]=r,this.uint8[u+4]=n,this.uint8[u+5]=a,this.uint8[u+6]=o,this.uint8[u+7]=s,e}};h(lO,"StructArrayLayout2i4ub8");var k4=lO;k4.prototype.bytesPerElement=8;ut("StructArrayLayout2i4ub8",k4);var uO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let n=e*2;return this.float32[n+0]=t,this.float32[n+1]=r,e}};h(uO,"StructArrayLayout2f8");var Hm=uO;Hm.prototype.bytesPerElement=8;ut("StructArrayLayout2f8",Hm);var hO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,e,t,r,n,a,o,s,l,u,c)}emplace(e,t,r,n,a,o,s,l,u,c,p){let d=e*10;return this.uint16[d+0]=t,this.uint16[d+1]=r,this.uint16[d+2]=n,this.uint16[d+3]=a,this.uint16[d+4]=o,this.uint16[d+5]=s,this.uint16[d+6]=l,this.uint16[d+7]=u,this.uint16[d+8]=c,this.uint16[d+9]=p,e}};h(hO,"StructArrayLayout10ui20");var R4=hO;R4.prototype.bytesPerElement=20;ut("StructArrayLayout10ui20",R4);var cO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u,c,p,d){let m=this.length;return this.resize(m+1),this.emplace(m,e,t,r,n,a,o,s,l,u,c,p,d)}emplace(e,t,r,n,a,o,s,l,u,c,p,d,m){let g=e*12;return this.int16[g+0]=t,this.int16[g+1]=r,this.int16[g+2]=n,this.int16[g+3]=a,this.uint16[g+4]=o,this.uint16[g+5]=s,this.uint16[g+6]=l,this.uint16[g+7]=u,this.int16[g+8]=c,this.int16[g+9]=p,this.int16[g+10]=d,this.int16[g+11]=m,e}};h(cO,"StructArrayLayout4i4ui4i24");var F4=cO;F4.prototype.bytesPerElement=24;ut("StructArrayLayout4i4ui4i24",F4);var pO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*3;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,e}};h(pO,"StructArrayLayout3f12");var O4=pO;O4.prototype.bytesPerElement=12;ut("StructArrayLayout3f12",O4);var dO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let r=e*1;return this.uint32[r+0]=t,e}};h(dO,"StructArrayLayout1ul4");var B4=dO;B4.prototype.bytesPerElement=4;ut("StructArrayLayout1ul4",B4);var fO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,e,t,r,n,a,o,s,l,u)}emplace(e,t,r,n,a,o,s,l,u,c){let p=e*10,d=e*5;return this.int16[p+0]=t,this.int16[p+1]=r,this.int16[p+2]=n,this.int16[p+3]=a,this.int16[p+4]=o,this.int16[p+5]=s,this.uint32[d+3]=l,this.uint16[p+8]=u,this.uint16[p+9]=c,e}};h(fO,"StructArrayLayout6i1ul2ui20");var z4=fO;z4.prototype.bytesPerElement=20;ut("StructArrayLayout6i1ul2ui20",z4);var mO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o){let s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,a,o)}emplace(e,t,r,n,a,o,s){let l=e*6;return this.int16[l+0]=t,this.int16[l+1]=r,this.int16[l+2]=n,this.int16[l+3]=a,this.int16[l+4]=o,this.int16[l+5]=s,e}};h(mO,"StructArrayLayout2i2i2i12");var N4=mO;N4.prototype.bytesPerElement=12;ut("StructArrayLayout2i2i2i12",N4);var gO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a){let o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,a)}emplace(e,t,r,n,a,o){let s=e*4,l=e*8;return this.float32[s+0]=t,this.float32[s+1]=r,this.float32[s+2]=n,this.int16[l+6]=a,this.int16[l+7]=o,e}};h(gO,"StructArrayLayout2f1f2i16");var $4=gO;$4.prototype.bytesPerElement=16;ut("StructArrayLayout2f1f2i16",$4);var yO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n)}emplace(e,t,r,n,a){let o=e*12,s=e*3;return this.uint8[o+0]=t,this.uint8[o+1]=r,this.float32[s+1]=n,this.float32[s+2]=a,e}};h(yO,"StructArrayLayout2ub2f12");var U4=yO;U4.prototype.bytesPerElement=12;ut("StructArrayLayout2ub2f12",U4);var vO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*3;return this.uint16[a+0]=t,this.uint16[a+1]=r,this.uint16[a+2]=n,e}};h(vO,"StructArrayLayout3ui6");var s_=vO;s_.prototype.bytesPerElement=6;ut("StructArrayLayout3ui6",s_);var xO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y,x){let w=this.length;return this.resize(w+1),this.emplace(w,e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y,x)}emplace(e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y,x,w){let b=e*24,C=e*12,E=e*48;return this.int16[b+0]=t,this.int16[b+1]=r,this.uint16[b+2]=n,this.uint16[b+3]=a,this.uint32[C+2]=o,this.uint32[C+3]=s,this.uint32[C+4]=l,this.uint16[b+10]=u,this.uint16[b+11]=c,this.uint16[b+12]=p,this.float32[C+7]=d,this.float32[C+8]=m,this.uint8[E+36]=g,this.uint8[E+37]=_,this.uint8[E+38]=y,this.uint32[C+10]=x,this.int16[b+22]=w,e}};h(xO,"StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48");var V4=xO;V4.prototype.bytesPerElement=48;ut("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",V4);var _O=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y,x,w,b,C,E,T,L,D,B,A,k,$){let z=this.length;return this.resize(z+1),this.emplace(z,e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y,x,w,b,C,E,T,L,D,B,A,k,$)}emplace(e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y,x,w,b,C,E,T,L,D,B,A,k,$,z){let P=e*32,U=e*16;return this.int16[P+0]=t,this.int16[P+1]=r,this.int16[P+2]=n,this.int16[P+3]=a,this.int16[P+4]=o,this.int16[P+5]=s,this.int16[P+6]=l,this.int16[P+7]=u,this.uint16[P+8]=c,this.uint16[P+9]=p,this.uint16[P+10]=d,this.uint16[P+11]=m,this.uint16[P+12]=g,this.uint16[P+13]=_,this.uint16[P+14]=y,this.uint16[P+15]=x,this.uint16[P+16]=w,this.uint16[P+17]=b,this.uint16[P+18]=C,this.uint16[P+19]=E,this.uint16[P+20]=T,this.uint16[P+21]=L,this.uint16[P+22]=D,this.uint32[U+12]=B,this.float32[U+13]=A,this.float32[U+14]=k,this.uint16[P+30]=$,this.uint16[P+31]=z,e}};h(_O,"StructArrayLayout8i15ui1ul2f2ui64");var j4=_O;j4.prototype.bytesPerElement=64;ut("StructArrayLayout8i15ui1ul2f2ui64",j4);var bO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let r=e*1;return this.float32[r+0]=t,e}};h(bO,"StructArrayLayout1f4");var l_=bO;l_.prototype.bytesPerElement=4;ut("StructArrayLayout1f4",l_);var wO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*6,o=e*3;return this.uint16[a+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,e}};h(wO,"StructArrayLayout1ui2f12");var H4=wO;H4.prototype.bytesPerElement=12;ut("StructArrayLayout1ui2f12",H4);var SO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){let n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){let a=e*2,o=e*4;return this.uint32[a+0]=t,this.uint16[o+2]=r,this.uint16[o+3]=n,e}};h(SO,"StructArrayLayout1ul2ui8");var G4=SO;G4.prototype.bytesPerElement=8;ut("StructArrayLayout1ul2ui8",G4);var MO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){let r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){let n=e*2;return this.uint16[n+0]=t,this.uint16[n+1]=r,e}};h(MO,"StructArrayLayout2ui4");var W4=MO;W4.prototype.bytesPerElement=4;ut("StructArrayLayout2ui4",W4);var CO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){let t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){let r=e*1;return this.uint16[r+0]=t,e}};h(CO,"StructArrayLayout1ui2");var X4=CO;X4.prototype.bytesPerElement=2;ut("StructArrayLayout1ui2",X4);var EO=class extends sr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){let a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n)}emplace(e,t,r,n,a){let o=e*4;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.float32[o+3]=a,e}};h(EO,"StructArrayLayout4f16");var q4=EO;q4.prototype.bytesPerElement=16;ut("StructArrayLayout4f16",q4);var TO=class extends _g{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ace.default(this.anchorPointX,this.anchorPointY)}};h(TO,"CollisionBoxStruct");var PO=TO;PO.prototype.size=20;var AO=class extends z4{get(e){return new PO(this,e)}};h(AO,"CollisionBoxArray");var IO=AO;ut("CollisionBoxArray",IO);var LO=class extends _g{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};h(LO,"PlacedSymbolStruct");var DO=LO;DO.prototype.size=48;var kO=class extends V4{get(e){return new DO(this,e)}};h(kO,"PlacedSymbolArray");var RO=kO;ut("PlacedSymbolArray",RO);var FO=class extends _g{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};h(FO,"SymbolInstanceStruct");var OO=FO;OO.prototype.size=64;var BO=class extends j4{get(e){return new OO(this,e)}};h(BO,"SymbolInstanceArray");var zO=BO;ut("SymbolInstanceArray",zO);var NO=class extends l_{getoffsetX(e){return this.float32[e*1+0]}};h(NO,"GlyphOffsetArray");var $O=NO;ut("GlyphOffsetArray",$O);var UO=class extends o_{getx(e){return this.int16[e*3+0]}gety(e){return this.int16[e*3+1]}gettileUnitDistanceFromAnchor(e){return this.int16[e*3+2]}};h(UO,"SymbolLineVertexArray");var VO=UO;ut("SymbolLineVertexArray",VO);var jO=class extends _g{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};h(jO,"TextAnchorOffsetStruct");var HO=jO;HO.prototype.size=12;var GO=class extends H4{get(e){return new HO(this,e)}};h(GO,"TextAnchorOffsetArray");var WO=GO;ut("TextAnchorOffsetArray",WO);var XO=class extends _g{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};h(XO,"FeatureIndexStruct");var qO=XO;qO.prototype.size=8;var ZO=class extends G4{get(e){return new qO(this,e)}};h(ZO,"FeatureIndexArray");var YO=ZO;ut("FeatureIndexArray",YO);var JO=class extends bg{};h(JO,"PosArray");var Ry=JO,KO=class extends o_{};h(KO,"Pos3dArray");var oce=KO,QO=class extends L4{};h(QO,"RasterBoundsArray");var eB=QO,tB=class extends bg{};h(tB,"CircleLayoutArray");var sce=tB,iB=class extends bg{};h(iB,"FillLayoutArray");var lce=iB,rB=class extends D4{};h(rB,"FillExtrusionLayoutArray");var uce=rB,nB=class extends k4{};h(nB,"LineLayoutArray");var hce=nB,aB=class extends Hm{};h(aB,"LineExtLayoutArray");var cce=aB,oB=class extends R4{};h(oB,"PatternLayoutArray");var Oh=oB,sB=class extends F4{};h(sB,"SymbolLayoutArray");var pce=sB,lB=class extends O4{};h(lB,"SymbolDynamicLayoutArray");var dce=lB,uB=class extends B4{};h(uB,"SymbolOpacityArray");var fce=uB,hB=class extends N4{};h(hB,"CollisionBoxLayoutArray");var a6=hB,cB=class extends $4{};h(cB,"CollisionCircleLayoutArray");var mce=cB,pB=class extends U4{};h(pB,"CollisionVertexArray");var gce=pB,dB=class extends s_{};h(dB,"QuadTriangleArray");var yce=dB,fB=class extends s_{};h(fB,"TriangleIndexArray");var Ch=fB,mB=class extends W4{};h(mB,"LineIndexArray");var b3=mB,gB=class extends X4{};h(gB,"LineStripIndexArray");var vce=gB;R();var xce=Yi([{name:"a_pos",components:2,type:"Int16"}],4),{members:_ce,size:cEe,alignment:pEe}=xce;R();var yB=class ff{constructor(e=[]){this.segments=e}prepareSegment(e,t,r,n){let a=this.segments[this.segments.length-1];return e>ff.MAX_VERTEX_ARRAY_LENGTH&&dn(`Max vertices per segment is ${ff.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!a||a.vertexLength+e>ff.MAX_VERTEX_ARRAY_LENGTH||a.sortKey!==n)&&(a={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},n!==void 0&&(a.sortKey=n),this.segments.push(a)),a}get(){return this.segments}destroy(){for(let e of this.segments)for(let t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,r,n){return new ff([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])}};h(yB,"SegmentVector");var fr=yB;fr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;ut("SegmentVector",fr);R();R();function w3(i,e){return i=Lr(Math.floor(i),0,255),e=Lr(Math.floor(e),0,255),256*i+e}h(w3,"packUint8ToFloat");R();var Fv=Yi([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);R();var bce=kt(uD(),1),vB=class xB{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,n){this.ids.push(S3(e)),this.positions.push(t,r,n)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let t=S3(e),r=0,n=this.ids.length-1;for(;r<n;){let o=r+n>>1;this.ids[o]>=t?n=o:r=o+1}let a=[];for(;this.ids[r]===t;){let o=this.positions[3*r],s=this.positions[3*r+1],l=this.positions[3*r+2];a.push({index:o,start:s,end:l}),r++}return a}static serialize(e,t){let r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return Ov(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}}static deserialize(e){let t=new xB;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}};h(vB,"FeaturePositionMap");var _B=vB;function S3(i){let e=+i;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:(0,bce.default)(String(i))}h(S3,"getNumericId");function Ov(i,e,t,r){for(;t<r;){let n=i[t+r>>1],a=t-1,o=r+1;for(;;){do a++;while(i[a]<n);do o--;while(i[o]>n);if(a>=o)break;mf(i,a,o),mf(e,3*a,3*o),mf(e,3*a+1,3*o+1),mf(e,3*a+2,3*o+2)}o-t<r-o?(Ov(i,e,t,o),t=o+1):(Ov(i,e,o+1,r),r=o)}}h(Ov,"sort");function mf(i,e,t){let r=i[e];i[e]=i[t],i[t]=r}h(mf,"swap");ut("FeaturePositionMap",_B);R();var bB=class{constructor(e,t){this.gl=e.gl,this.location=t}};h(bB,"Uniform");var Eh=bB,wB=class extends Eh{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}};h(wB,"Uniform1i");var Kt=wB,SB=class extends Eh{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}};h(SB,"Uniform1f");var ot=SB,MB=class extends Eh{constructor(e,t){super(e,t),this.current=[0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1])&&(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}};h(MB,"Uniform2f");var ii=MB,CB=class extends Eh{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2])&&(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}};h(CB,"Uniform3f");var Rs=CB,EB=class extends Eh{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){(e[0]!==this.current[0]||e[1]!==this.current[1]||e[2]!==this.current[2]||e[3]!==this.current[3])&&(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}};h(EB,"Uniform4f");var Z4=EB,TB=class extends Eh{constructor(e,t){super(e,t),this.current=zt.transparent}set(e){(e.r!==this.current.r||e.g!==this.current.g||e.b!==this.current.b||e.a!==this.current.a)&&(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}};h(TB,"UniformColor");var Mp=TB,wce=new Float32Array(16),PB=class extends Eh{constructor(e,t){super(e,t),this.current=wce}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);return}for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}};h(PB,"UniformMatrix4f");var ui=PB;function Bv(i){return[w3(255*i.r,255*i.g),w3(255*i.b,255*i.a)]}h(Bv,"packColor");var AB=class{constructor(e,t,r){this.value=e,this.uniformNames=t.map(n=>`u_${n}`),this.type=r}setUniform(e,t,r){e.set(r.constantOr(this.value))}getBinding(e,t,r){return this.type==="color"?new Mp(e,t):new ot(e,t)}};h(AB,"ConstantBinder");var gf=AB,IB=class{constructor(e,t){this.uniformNames=t.map(r=>`u_${r}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,r,n){let a=n==="u_pattern_to"?this.patternTo:n==="u_pattern_from"?this.patternFrom:n==="u_pixel_ratio_to"?this.pixelRatioTo:n==="u_pixel_ratio_from"?this.pixelRatioFrom:null;a&&e.set(a)}getBinding(e,t,r){return r.substr(0,9)==="u_pattern"?new Z4(e,t):new ot(e,t)}};h(IB,"CrossFadedConstantBinder");var sc=IB,LB=class{constructor(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(a=>({name:`a_${a}`,type:"Float32",components:r==="color"?2:1,offset:0})),this.paintVertexArray=new n}populatePaintArray(e,t,r,n,a){let o=this.paintVertexArray.length,s=this.expression.evaluate(new Dr(0),t,{},n,[],a);this.paintVertexArray.resize(e),this._setPaintValue(o,e,s)}updatePaintArray(e,t,r,n){let a=this.expression.evaluate({zoom:0},r,n);this._setPaintValue(e,t,a)}_setPaintValue(e,t,r){if(this.type==="color"){let n=Bv(r);for(let a=e;a<t;a++)this.paintVertexArray.emplace(a,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}};h(LB,"SourceExpressionBinder");var fs=LB,DB=class{constructor(e,t,r,n,a,o){this.expression=e,this.uniformNames=t.map(s=>`u_${s}_t`),this.type=r,this.useIntegerZoom=n,this.zoom=a,this.maxValue=0,this.paintVertexAttributes=t.map(s=>({name:`a_${s}`,type:"Float32",components:r==="color"?4:2,offset:0})),this.paintVertexArray=new o}populatePaintArray(e,t,r,n,a){let o=this.expression.evaluate(new Dr(this.zoom),t,{},n,[],a),s=this.expression.evaluate(new Dr(this.zoom+1),t,{},n,[],a),l=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(l,e,o,s)}updatePaintArray(e,t,r,n){let a=this.expression.evaluate({zoom:this.zoom},r,n),o=this.expression.evaluate({zoom:this.zoom+1},r,n);this._setPaintValue(e,t,a,o)}_setPaintValue(e,t,r,n){if(this.type==="color"){let a=Bv(r),o=Bv(n);for(let s=e;s<t;s++)this.paintVertexArray.emplace(s,a[0],a[1],o[0],o[1])}else{for(let a=e;a<t;a++)this.paintVertexArray.emplace(a,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){let r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,n=Lr(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(n)}getBinding(e,t,r){return new ot(e,t)}};h(DB,"CompositeExpressionBinder");var no=DB,kB=class{constructor(e,t,r,n,a,o){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=n,this.layerId=o,this.zoomInPaintVertexArray=new a,this.zoomOutPaintVertexArray=new a}populatePaintArray(e,t,r){let n=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)}updatePaintArray(e,t,r,n,a){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],a)}_setPaintValues(e,t,r,n){if(!n||!r)return;let{min:a,mid:o,max:s}=r,l=n[a],u=n[o],c=n[s];if(!(!l||!u||!c))for(let p=e;p<t;p++)this.zoomInPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Fv.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Fv.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}};h(kB,"CrossFadedCompositeBinder");var al=kB,RB=class{constructor(e,t,r){this.binders={},this._buffers=[];let n=[];for(let a in e.paint._values){if(!r(a))continue;let o=e.paint.get(a);if(!(o instanceof xo)||!uh(o.property.specification))continue;let s=BB(a,e.type),l=o.value,u=o.property.specification.type,c=o.property.useIntegerZoom,p=o.property.specification["property-type"],d=p==="cross-faded"||p==="cross-faded-data-driven";if(l.kind==="constant")this.binders[a]=d?new sc(l.value,s):new gf(l.value,s,u),n.push(`/u_${a}`);else if(l.kind==="source"||d){let m=M3(a,u,"source");this.binders[a]=d?new al(l,u,c,t,m,e.id):new fs(l,s,u,m),n.push(`/a_${a}`)}else{let m=M3(a,u,"composite");this.binders[a]=new no(l,s,u,c,t,m),n.push(`/z_${a}`)}}this.cacheKey=n.sort().join("")}getMaxValue(e){let t=this.binders[e];return t instanceof fs||t instanceof no?t.maxValue:0}populatePaintArrays(e,t,r,n,a){for(let o in this.binders){let s=this.binders[o];(s instanceof fs||s instanceof no||s instanceof al)&&s.populatePaintArray(e,t,r,n,a)}}setConstantPatternPositions(e,t){for(let r in this.binders){let n=this.binders[r];n instanceof sc&&n.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,r,n,a){let o=!1;for(let s in e){let l=t.getPositions(s);for(let u of l){let c=r.feature(u.index);for(let p in this.binders){let d=this.binders[p];if((d instanceof fs||d instanceof no||d instanceof al)&&d.expression.isStateDependent===!0){let m=n.paint.get(p);d.expression=m.value,d.updatePaintArray(u.start,u.end,c,e[s],a),o=!0}}}}return o}defines(){let e=[];for(let t in this.binders){let r=this.binders[t];(r instanceof gf||r instanceof sc)&&e.push(...r.uniformNames.map(n=>`#define HAS_UNIFORM_${n}`))}return e}getBinderAttributes(){let e=[];for(let t in this.binders){let r=this.binders[t];if(r instanceof fs||r instanceof no)for(let n=0;n<r.paintVertexAttributes.length;n++)e.push(r.paintVertexAttributes[n].name);else if(r instanceof al)for(let n=0;n<Fv.members.length;n++)e.push(Fv.members[n].name)}return e}getBinderUniforms(){let e=[];for(let t in this.binders){let r=this.binders[t];if(r instanceof gf||r instanceof sc||r instanceof no)for(let n of r.uniformNames)e.push(n)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){let r=[];for(let n in this.binders){let a=this.binders[n];if(a instanceof gf||a instanceof sc||a instanceof no){for(let o of a.uniformNames)if(t[o]){let s=a.getBinding(e,t[o],o);r.push({name:o,property:n,binding:s})}}}return r}setUniforms(e,t,r,n){for(let{name:a,property:o,binding:s}of t)this.binders[o].setUniform(s,n,r.get(o),a)}updatePaintBuffers(e){this._buffers=[];for(let t in this.binders){let r=this.binders[t];if(e&&r instanceof al){let n=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;n&&this._buffers.push(n)}else(r instanceof fs||r instanceof no)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(let t in this.binders){let r=this.binders[t];(r instanceof fs||r instanceof no||r instanceof al)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(let e in this.binders){let t=this.binders[e];(t instanceof fs||t instanceof no||t instanceof al)&&t.destroy()}}};h(RB,"ProgramConfiguration");var FB=RB,OB=class{constructor(e,t,r=()=>!0){this.programConfigurations={};for(let n of e)this.programConfigurations[n.id]=new FB(n,t,r);this.needsUpload=!1,this._featureMap=new _B,this._bufferOffset=0}populatePaintArrays(e,t,r,n,a,o){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,t,n,a,o);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,n){for(let a of r)this.needsUpload=this.programConfigurations[a.id].updatePaintArrays(e,this._featureMap,t,a,n)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(let t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(let e in this.programConfigurations)this.programConfigurations[e].destroy()}};h(OB,"ProgramConfigurationSet");var ch=OB;function BB(i,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}h(BB,"paintAttributeNames");function zB(i){return{"line-pattern":{source:Oh,composite:Oh},"fill-pattern":{source:Oh,composite:Oh},"fill-extrusion-pattern":{source:Oh,composite:Oh}}[i]}h(zB,"getLayoutException");function M3(i,e,t){let r={color:{source:Hm,composite:q4},number:{source:l_,composite:Hm}},n=zB(i);return n&&n[t]||r[e][t]}h(M3,"layoutType");ut("ConstantBinder",gf);ut("CrossFadedConstantBinder",sc);ut("SourceExpressionBinder",fs);ut("CrossFadedCompositeBinder",al);ut("CompositeExpressionBinder",no);ut("ProgramConfiguration",FB,{omit:["_buffers"]});ut("ProgramConfigurationSet",ch);R();R();R();var Sce=15,C3=Math.pow(2,Sce-1)-1,o6=-C3-1;function Ql(i){let e=8192/i.extent,t=i.loadGeometry();for(let r=0;r<t.length;r++){let n=t[r];for(let a=0;a<n.length;a++){let o=n[a],s=Math.round(o.x*e),l=Math.round(o.y*e);o.x=Lr(s,o6,C3),o.y=Lr(l,o6,C3),(s<o.x||s>o.x+1||l<o.y||l>o.y+1)&&dn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return t}h(Ql,"loadGeometry");R();function eu(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?Ql(i):[]}}h(eu,"toEvaluationFeature");function yf(i,e,t,r,n){i.emplaceBack(e*2+(r+1)/2,t*2+(n+1)/2)}h(yf,"addCircleVertex");var NB=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new sce,this.indexArray=new Ch,this.segments=new fr,this.programConfigurations=new ch(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,r){let n=this.layers[0],a=[],o=null,s=!1;n.type==="circle"&&(o=n.layout.get("circle-sort-key"),s=!o.isConstant());for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of e){let d=this.layers[0]._featureFilter.needGeometry,m=eu(l,d);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),m,r))continue;let g=s?o.evaluate(m,{},r):void 0,_={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:d?m.geometry:Ql(l),patterns:{},sortKey:g};a.push(_)}s&&a.sort((l,u)=>l.sortKey-u.sortKey);for(let l of a){let{geometry:u,index:c,sourceLayerIndex:p}=l,d=e[c].feature;this.addFeature(l,u,c,r),t.featureIndex.insert(d,u,c,p,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_ce),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,n){for(let a of t)for(let o of a){let s=o.x,l=o.y;if(s<0||s>=8192||l<0||l>=8192)continue;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),c=u.vertexLength;yf(this.layoutVertexArray,s,l,-1,-1),yf(this.layoutVertexArray,s,l,1,-1),yf(this.layoutVertexArray,s,l,1,1),yf(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n)}};h(NB,"CircleBucket");var Y4=NB;ut("CircleBucket",Y4,{omit:["layers"]});R();var s1=kt(gi(),1);function J4(i,e){for(let t=0;t<i.length;t++)if(ph(e,i[t]))return!0;for(let t=0;t<e.length;t++)if(ph(i,e[t]))return!0;return!!u_(i,e)}h(J4,"polygonIntersectsPolygon");function $B(i,e,t){return!!(ph(i,e)||zv(e,i,t))}h($B,"polygonIntersectsBufferedPoint");function K4(i,e){if(i.length===1)return E3(e,i[0]);for(let t=0;t<e.length;t++){let r=e[t];for(let n=0;n<r.length;n++)if(ph(i,r[n]))return!0}for(let t=0;t<i.length;t++)if(E3(e,i[t]))return!0;for(let t=0;t<e.length;t++)if(u_(i,e[t]))return!0;return!1}h(K4,"polygonIntersectsMultiPolygon");function UB(i,e,t){for(let r=0;r<e.length;r++){let n=e[r];if(i.length>=3){for(let a=0;a<n.length;a++)if(ph(i,n[a]))return!0}if(VB(i,n,t))return!0}return!1}h(UB,"polygonIntersectsBufferedMultiLine");function VB(i,e,t){if(i.length>1){if(u_(i,e))return!0;for(let r=0;r<e.length;r++)if(zv(e[r],i,t))return!0}for(let r=0;r<i.length;r++)if(zv(i[r],e,t))return!0;return!1}h(VB,"lineIntersectsBufferedLine");function u_(i,e){if(i.length===0||e.length===0)return!1;for(let t=0;t<i.length-1;t++){let r=i[t],n=i[t+1];for(let a=0;a<e.length-1;a++){let o=e[a],s=e[a+1];if(jB(r,n,o,s))return!0}}return!1}h(u_,"lineIntersectsLine");function jB(i,e,t,r){return Ls(i,t,r)!==Ls(e,t,r)&&Ls(i,e,t)!==Ls(i,e,r)}h(jB,"lineSegmentIntersectsLineSegment");function zv(i,e,t){let r=t*t;if(e.length===1)return i.distSqr(e[0])<r;for(let n=1;n<e.length;n++){let a=e[n-1],o=e[n];if(HB(i,a,o)<r)return!0}return!1}h(zv,"pointIntersectsBufferedLine");function HB(i,e,t){let r=e.distSqr(t);if(r===0)return i.distSqr(e);let n=((i.x-e.x)*(t.x-e.x)+(i.y-e.y)*(t.y-e.y))/r;return n<0?i.distSqr(e):n>1?i.distSqr(t):i.distSqr(t.sub(e)._mult(n)._add(e))}h(HB,"distToSegmentSquared");function E3(i,e){let t=!1,r,n,a;for(let o=0;o<i.length;o++){r=i[o];for(let s=0,l=r.length-1;s<r.length;l=s++)n=r[s],a=r[l],n.y>e.y!=a.y>e.y&&e.x<(a.x-n.x)*(e.y-n.y)/(a.y-n.y)+n.x&&(t=!t)}return t}h(E3,"multiPolygonContainsPoint");function ph(i,e){let t=!1;for(let r=0,n=i.length-1;r<i.length;n=r++){let a=i[r],o=i[n];a.y>e.y!=o.y>e.y&&e.x<(o.x-a.x)*(e.y-a.y)/(o.y-a.y)+a.x&&(t=!t)}return t}h(ph,"polygonContainsPoint");function GB(i,e,t,r,n){for(let o of i)if(e<=o.x&&t<=o.y&&r>=o.x&&n>=o.y)return!0;let a=[new s1.default(e,t),new s1.default(e,n),new s1.default(r,n),new s1.default(r,t)];if(i.length>2){for(let o of a)if(ph(i,o))return!0}for(let o=0;o<i.length-1;o++){let s=i[o],l=i[o+1];if(WB(s,l,a))return!0}return!1}h(GB,"polygonIntersectsBox");function WB(i,e,t){let r=t[0],n=t[2];if(i.x<r.x&&e.x<r.x||i.x>n.x&&e.x>n.x||i.y<r.y&&e.y<r.y||i.y>n.y&&e.y>n.y)return!1;let a=Ls(i,e,t[0]);return a!==Ls(i,e,t[1])||a!==Ls(i,e,t[2])||a!==Ls(i,e,t[3])}h(WB,"edgeIntersectsBox");R();var T3=kt(gi(),1);function Cp(i,e,t){let r=e.paint.get(i).value;return r.kind==="constant"?r.value:t.programConfigurations.get(e.id).getMaxValue(i)}h(Cp,"getMaximumPaintValue");function wg(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}h(wg,"translateDistance");function Sg(i,e,t,r,n){if(!e[0]&&!e[1])return i;let a=T3.default.convert(e)._mult(n);t==="viewport"&&a._rotate(-r);let o=[];for(let s=0;s<i.length;s++){let l=i[s];o.push(l.sub(a))}return o}h(Sg,"translate");function XB(i,e){let t=[];for(let r=0;r<i.length;r++){let n=i[r],a=[];for(let o=0;o<n.length;o++){let s=n[o-1],l=n[o],u=n[o+1],c=o===0?new T3.default(0,0):l.sub(s)._unit()._perp(),p=o===n.length-1?new T3.default(0,0):u.sub(l)._unit()._perp(),d=c._add(p)._unit(),m=d.x*p.x+d.y*p.y;m!==0&&d._mult(1/m),a.push(d._mult(e)._add(l))}t.push(a)}return t}h(XB,"offsetLine");R();var s6,Mce=h(()=>s6=s6||new ia({"circle-sort-key":new Ct(Le.layout_circle["circle-sort-key"])}),"getLayout"),l6,Cce=h(()=>l6=l6||new ia({"circle-radius":new Ct(Le.paint_circle["circle-radius"]),"circle-color":new Ct(Le.paint_circle["circle-color"]),"circle-blur":new Ct(Le.paint_circle["circle-blur"]),"circle-opacity":new Ct(Le.paint_circle["circle-opacity"]),"circle-translate":new yt(Le.paint_circle["circle-translate"]),"circle-translate-anchor":new yt(Le.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new yt(Le.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new yt(Le.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ct(Le.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ct(Le.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ct(Le.paint_circle["circle-stroke-opacity"])}),"getPaint"),Ece={get paint(){return Cce()},get layout(){return Mce()}};R();R();var Xt=1e-6,Li=typeof Float32Array<"u"?Float32Array:Array,zu=Math.random;Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var P3={};_h(P3,{LDU:()=>hz,add:()=>cz,adjoint:()=>iz,clone:()=>ZB,copy:()=>YB,create:()=>qB,determinant:()=>rz,equals:()=>dz,exactEquals:()=>pz,frob:()=>uz,fromRotation:()=>oz,fromScaling:()=>sz,fromValues:()=>KB,identity:()=>JB,invert:()=>tz,mul:()=>Tce,multiply:()=>Q4,multiplyScalar:()=>fz,multiplyScalarAndAdd:()=>mz,rotate:()=>nz,scale:()=>az,set:()=>QB,str:()=>lz,sub:()=>Pce,subtract:()=>e5,transpose:()=>ez});R();function qB(){var i=new Li(4);return Li!=Float32Array&&(i[1]=0,i[2]=0),i[0]=1,i[3]=1,i}h(qB,"create");function ZB(i){var e=new Li(4);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}h(ZB,"clone");function YB(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}h(YB,"copy");function JB(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=1,i}h(JB,"identity");function KB(i,e,t,r){var n=new Li(4);return n[0]=i,n[1]=e,n[2]=t,n[3]=r,n}h(KB,"fromValues");function QB(i,e,t,r,n){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}h(QB,"set");function ez(i,e){if(i===e){var t=e[1];i[1]=e[2],i[2]=t}else i[0]=e[0],i[1]=e[2],i[2]=e[1],i[3]=e[3];return i}h(ez,"transpose");function tz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=t*a-n*r;return o?(o=1/o,i[0]=a*o,i[1]=-r*o,i[2]=-n*o,i[3]=t*o,i):null}h(tz,"invert");function iz(i,e){var t=e[0];return i[0]=e[3],i[1]=-e[1],i[2]=-e[2],i[3]=t,i}h(iz,"adjoint");function rz(i){return i[0]*i[3]-i[2]*i[1]}h(rz,"determinant");function Q4(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=t[0],l=t[1],u=t[2],c=t[3];return i[0]=r*s+a*l,i[1]=n*s+o*l,i[2]=r*u+a*c,i[3]=n*u+o*c,i}h(Q4,"multiply");function nz(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=Math.sin(t),l=Math.cos(t);return i[0]=r*l+a*s,i[1]=n*l+o*s,i[2]=r*-s+a*l,i[3]=n*-s+o*l,i}h(nz,"rotate");function az(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=t[0],l=t[1];return i[0]=r*s,i[1]=n*s,i[2]=a*l,i[3]=o*l,i}h(az,"scale");function oz(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=t,i[2]=-t,i[3]=r,i}h(oz,"fromRotation");function sz(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=e[1],i}h(sz,"fromScaling");function lz(i){return"mat2("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}h(lz,"str");function uz(i){return Math.hypot(i[0],i[1],i[2],i[3])}h(uz,"frob");function hz(i,e,t,r){return i[2]=r[2]/r[0],t[0]=r[0],t[1]=r[1],t[3]=r[3]-i[2]*t[1],[i,e,t]}h(hz,"LDU");function cz(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}h(cz,"add");function e5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}h(e5,"subtract");function pz(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}h(pz,"exactEquals");function dz(i,e){var t=i[0],r=i[1],n=i[2],a=i[3],o=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(t-o)<=Xt*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(r-s)<=Xt*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=Xt*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=Xt*Math.max(1,Math.abs(a),Math.abs(u))}h(dz,"equals");function fz(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}h(fz,"multiplyScalar");function mz(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i}h(mz,"multiplyScalarAndAdd");var Tce=Q4,Pce=e5,A3={};_h(A3,{add:()=>Nz,adjoint:()=>Cz,clone:()=>vz,copy:()=>xz,create:()=>gz,determinant:()=>Ez,equals:()=>jz,exactEquals:()=>Vz,frob:()=>zz,fromMat2d:()=>kz,fromMat4:()=>yz,fromQuat:()=>Rz,fromRotation:()=>Lz,fromScaling:()=>Dz,fromTranslation:()=>Iz,fromValues:()=>_z,identity:()=>wz,invert:()=>Mz,mul:()=>Ace,multiply:()=>t5,multiplyScalar:()=>$z,multiplyScalarAndAdd:()=>Uz,normalFromMat4:()=>Fz,projection:()=>Oz,rotate:()=>Pz,scale:()=>Az,set:()=>bz,str:()=>Bz,sub:()=>Ice,subtract:()=>i5,translate:()=>Tz,transpose:()=>Sz});R();function gz(){var i=new Li(9);return Li!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}h(gz,"create");function yz(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[4],i[4]=e[5],i[5]=e[6],i[6]=e[8],i[7]=e[9],i[8]=e[10],i}h(yz,"fromMat4");function vz(i){var e=new Li(9);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e}h(vz,"clone");function xz(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i}h(xz,"copy");function _z(i,e,t,r,n,a,o,s,l){var u=new Li(9);return u[0]=i,u[1]=e,u[2]=t,u[3]=r,u[4]=n,u[5]=a,u[6]=o,u[7]=s,u[8]=l,u}h(_z,"fromValues");function bz(i,e,t,r,n,a,o,s,l,u){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i[4]=a,i[5]=o,i[6]=s,i[7]=l,i[8]=u,i}h(bz,"set");function wz(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}h(wz,"identity");function Sz(i,e){if(i===e){var t=e[1],r=e[2],n=e[5];i[1]=e[3],i[2]=e[6],i[3]=t,i[5]=e[7],i[6]=r,i[7]=n}else i[0]=e[0],i[1]=e[3],i[2]=e[6],i[3]=e[1],i[4]=e[4],i[5]=e[7],i[6]=e[2],i[7]=e[5],i[8]=e[8];return i}h(Sz,"transpose");function Mz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=c*o-s*u,d=-c*a+s*l,m=u*a-o*l,g=t*p+r*d+n*m;return g?(g=1/g,i[0]=p*g,i[1]=(-c*r+n*u)*g,i[2]=(s*r-n*o)*g,i[3]=d*g,i[4]=(c*t-n*l)*g,i[5]=(-s*t+n*a)*g,i[6]=m*g,i[7]=(-u*t+r*l)*g,i[8]=(o*t-r*a)*g,i):null}h(Mz,"invert");function Cz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return i[0]=o*c-s*u,i[1]=n*u-r*c,i[2]=r*s-n*o,i[3]=s*l-a*c,i[4]=t*c-n*l,i[5]=n*a-t*s,i[6]=a*u-o*l,i[7]=r*l-t*u,i[8]=t*o-r*a,i}h(Cz,"adjoint");function Ez(i){var e=i[0],t=i[1],r=i[2],n=i[3],a=i[4],o=i[5],s=i[6],l=i[7],u=i[8];return e*(u*a-o*l)+t*(-u*n+o*s)+r*(l*n-a*s)}h(Ez,"determinant");function t5(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],d=t[0],m=t[1],g=t[2],_=t[3],y=t[4],x=t[5],w=t[6],b=t[7],C=t[8];return i[0]=d*r+m*o+g*u,i[1]=d*n+m*s+g*c,i[2]=d*a+m*l+g*p,i[3]=_*r+y*o+x*u,i[4]=_*n+y*s+x*c,i[5]=_*a+y*l+x*p,i[6]=w*r+b*o+C*u,i[7]=w*n+b*s+C*c,i[8]=w*a+b*l+C*p,i}h(t5,"multiply");function Tz(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],d=t[0],m=t[1];return i[0]=r,i[1]=n,i[2]=a,i[3]=o,i[4]=s,i[5]=l,i[6]=d*r+m*o+u,i[7]=d*n+m*s+c,i[8]=d*a+m*l+p,i}h(Tz,"translate");function Pz(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],d=Math.sin(t),m=Math.cos(t);return i[0]=m*r+d*o,i[1]=m*n+d*s,i[2]=m*a+d*l,i[3]=m*o-d*r,i[4]=m*s-d*n,i[5]=m*l-d*a,i[6]=u,i[7]=c,i[8]=p,i}h(Pz,"rotate");function Az(i,e,t){var r=t[0],n=t[1];return i[0]=r*e[0],i[1]=r*e[1],i[2]=r*e[2],i[3]=n*e[3],i[4]=n*e[4],i[5]=n*e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i}h(Az,"scale");function Iz(i,e){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=1,i[5]=0,i[6]=e[0],i[7]=e[1],i[8]=1,i}h(Iz,"fromTranslation");function Lz(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=t,i[2]=0,i[3]=-t,i[4]=r,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}h(Lz,"fromRotation");function Dz(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=e[1],i[5]=0,i[6]=0,i[7]=0,i[8]=1,i}h(Dz,"fromScaling");function kz(i,e){return i[0]=e[0],i[1]=e[1],i[2]=0,i[3]=e[2],i[4]=e[3],i[5]=0,i[6]=e[4],i[7]=e[5],i[8]=1,i}h(kz,"fromMat2d");function Rz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=t+t,s=r+r,l=n+n,u=t*o,c=r*o,p=r*s,d=n*o,m=n*s,g=n*l,_=a*o,y=a*s,x=a*l;return i[0]=1-p-g,i[3]=c-x,i[6]=d+y,i[1]=c+x,i[4]=1-u-g,i[7]=m-_,i[2]=d-y,i[5]=m+_,i[8]=1-u-p,i}h(Rz,"fromQuat");function Fz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],d=e[10],m=e[11],g=e[12],_=e[13],y=e[14],x=e[15],w=t*s-r*o,b=t*l-n*o,C=t*u-a*o,E=r*l-n*s,T=r*u-a*s,L=n*u-a*l,D=c*_-p*g,B=c*y-d*g,A=c*x-m*g,k=p*y-d*_,$=p*x-m*_,z=d*x-m*y,P=w*z-b*$+C*k+E*A-T*B+L*D;return P?(P=1/P,i[0]=(s*z-l*$+u*k)*P,i[1]=(l*A-o*z-u*B)*P,i[2]=(o*$-s*A+u*D)*P,i[3]=(n*$-r*z-a*k)*P,i[4]=(t*z-n*A+a*B)*P,i[5]=(r*A-t*$-a*D)*P,i[6]=(_*L-y*T+x*E)*P,i[7]=(y*C-g*L-x*b)*P,i[8]=(g*T-_*C+x*w)*P,i):null}h(Fz,"normalFromMat4");function Oz(i,e,t){return i[0]=2/e,i[1]=0,i[2]=0,i[3]=0,i[4]=-2/t,i[5]=0,i[6]=-1,i[7]=1,i[8]=1,i}h(Oz,"projection");function Bz(i){return"mat3("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+")"}h(Bz,"str");function zz(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])}h(zz,"frob");function Nz(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i}h(Nz,"add");function i5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i}h(i5,"subtract");function $z(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i}h($z,"multiplyScalar");function Uz(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i[4]=e[4]+t[4]*r,i[5]=e[5]+t[5]*r,i[6]=e[6]+t[6]*r,i[7]=e[7]+t[7]*r,i[8]=e[8]+t[8]*r,i}h(Uz,"multiplyScalarAndAdd");function Vz(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]&&i[8]===e[8]}h(Vz,"exactEquals");function jz(i,e){var t=i[0],r=i[1],n=i[2],a=i[3],o=i[4],s=i[5],l=i[6],u=i[7],c=i[8],p=e[0],d=e[1],m=e[2],g=e[3],_=e[4],y=e[5],x=e[6],w=e[7],b=e[8];return Math.abs(t-p)<=Xt*Math.max(1,Math.abs(t),Math.abs(p))&&Math.abs(r-d)<=Xt*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-m)<=Xt*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(a-g)<=Xt*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(o-_)<=Xt*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-y)<=Xt*Math.max(1,Math.abs(s),Math.abs(y))&&Math.abs(l-x)<=Xt*Math.max(1,Math.abs(l),Math.abs(x))&&Math.abs(u-w)<=Xt*Math.max(1,Math.abs(u),Math.abs(w))&&Math.abs(c-b)<=Xt*Math.max(1,Math.abs(c),Math.abs(b))}h(jz,"equals");var Ace=t5,Ice=i5,ht={};_h(ht,{add:()=>CN,adjoint:()=>Jz,clone:()=>Gz,copy:()=>Wz,create:()=>Hz,determinant:()=>Kz,equals:()=>AN,exactEquals:()=>PN,frob:()=>MN,fromQuat:()=>gN,fromQuat2:()=>cN,fromRotation:()=>sN,fromRotationTranslation:()=>a5,fromRotationTranslationScale:()=>fN,fromRotationTranslationScaleOrigin:()=>mN,fromScaling:()=>oN,fromTranslation:()=>aN,fromValues:()=>Xz,fromXRotation:()=>lN,fromYRotation:()=>uN,fromZRotation:()=>hN,frustum:()=>yN,getRotation:()=>dN,getScaling:()=>o5,getTranslation:()=>pN,identity:()=>r5,invert:()=>Yz,lookAt:()=>bN,mul:()=>kce,multiply:()=>n5,multiplyScalar:()=>EN,multiplyScalarAndAdd:()=>TN,ortho:()=>Dce,orthoNO:()=>l5,orthoZO:()=>_N,perspective:()=>Lce,perspectiveFromFieldOfView:()=>xN,perspectiveNO:()=>s5,perspectiveZO:()=>vN,rotate:()=>tN,rotateX:()=>iN,rotateY:()=>rN,rotateZ:()=>nN,scale:()=>eN,set:()=>qz,str:()=>SN,sub:()=>Rce,subtract:()=>u5,targetTo:()=>wN,translate:()=>Qz,transpose:()=>Zz});R();function Hz(){var i=new Li(16);return Li!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i}h(Hz,"create");function Gz(i){var e=new Li(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e}h(Gz,"clone");function Wz(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}h(Wz,"copy");function Xz(i,e,t,r,n,a,o,s,l,u,c,p,d,m,g,_){var y=new Li(16);return y[0]=i,y[1]=e,y[2]=t,y[3]=r,y[4]=n,y[5]=a,y[6]=o,y[7]=s,y[8]=l,y[9]=u,y[10]=c,y[11]=p,y[12]=d,y[13]=m,y[14]=g,y[15]=_,y}h(Xz,"fromValues");function qz(i,e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i[4]=a,i[5]=o,i[6]=s,i[7]=l,i[8]=u,i[9]=c,i[10]=p,i[11]=d,i[12]=m,i[13]=g,i[14]=_,i[15]=y,i}h(qz,"set");function r5(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(r5,"identity");function Zz(i,e){if(i===e){var t=e[1],r=e[2],n=e[3],a=e[6],o=e[7],s=e[11];i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=t,i[6]=e[9],i[7]=e[13],i[8]=r,i[9]=a,i[11]=e[14],i[12]=n,i[13]=o,i[14]=s}else i[0]=e[0],i[1]=e[4],i[2]=e[8],i[3]=e[12],i[4]=e[1],i[5]=e[5],i[6]=e[9],i[7]=e[13],i[8]=e[2],i[9]=e[6],i[10]=e[10],i[11]=e[14],i[12]=e[3],i[13]=e[7],i[14]=e[11],i[15]=e[15];return i}h(Zz,"transpose");function Yz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],d=e[10],m=e[11],g=e[12],_=e[13],y=e[14],x=e[15],w=t*s-r*o,b=t*l-n*o,C=t*u-a*o,E=r*l-n*s,T=r*u-a*s,L=n*u-a*l,D=c*_-p*g,B=c*y-d*g,A=c*x-m*g,k=p*y-d*_,$=p*x-m*_,z=d*x-m*y,P=w*z-b*$+C*k+E*A-T*B+L*D;return P?(P=1/P,i[0]=(s*z-l*$+u*k)*P,i[1]=(n*$-r*z-a*k)*P,i[2]=(_*L-y*T+x*E)*P,i[3]=(d*T-p*L-m*E)*P,i[4]=(l*A-o*z-u*B)*P,i[5]=(t*z-n*A+a*B)*P,i[6]=(y*C-g*L-x*b)*P,i[7]=(c*L-d*C+m*b)*P,i[8]=(o*$-s*A+u*D)*P,i[9]=(r*A-t*$-a*D)*P,i[10]=(g*T-_*C+x*w)*P,i[11]=(p*C-c*T-m*w)*P,i[12]=(s*B-o*k-l*D)*P,i[13]=(t*k-r*B+n*D)*P,i[14]=(_*b-g*E-y*w)*P,i[15]=(c*E-p*b+d*w)*P,i):null}h(Yz,"invert");function Jz(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],d=e[10],m=e[11],g=e[12],_=e[13],y=e[14],x=e[15];return i[0]=s*(d*x-m*y)-p*(l*x-u*y)+_*(l*m-u*d),i[1]=-(r*(d*x-m*y)-p*(n*x-a*y)+_*(n*m-a*d)),i[2]=r*(l*x-u*y)-s*(n*x-a*y)+_*(n*u-a*l),i[3]=-(r*(l*m-u*d)-s*(n*m-a*d)+p*(n*u-a*l)),i[4]=-(o*(d*x-m*y)-c*(l*x-u*y)+g*(l*m-u*d)),i[5]=t*(d*x-m*y)-c*(n*x-a*y)+g*(n*m-a*d),i[6]=-(t*(l*x-u*y)-o*(n*x-a*y)+g*(n*u-a*l)),i[7]=t*(l*m-u*d)-o*(n*m-a*d)+c*(n*u-a*l),i[8]=o*(p*x-m*_)-c*(s*x-u*_)+g*(s*m-u*p),i[9]=-(t*(p*x-m*_)-c*(r*x-a*_)+g*(r*m-a*p)),i[10]=t*(s*x-u*_)-o*(r*x-a*_)+g*(r*u-a*s),i[11]=-(t*(s*m-u*p)-o*(r*m-a*p)+c*(r*u-a*s)),i[12]=-(o*(p*y-d*_)-c*(s*y-l*_)+g*(s*d-l*p)),i[13]=t*(p*y-d*_)-c*(r*y-n*_)+g*(r*d-n*p),i[14]=-(t*(s*y-l*_)-o*(r*y-n*_)+g*(r*l-n*s)),i[15]=t*(s*d-l*p)-o*(r*d-n*p)+c*(r*l-n*s),i}h(Jz,"adjoint");function Kz(i){var e=i[0],t=i[1],r=i[2],n=i[3],a=i[4],o=i[5],s=i[6],l=i[7],u=i[8],c=i[9],p=i[10],d=i[11],m=i[12],g=i[13],_=i[14],y=i[15],x=e*o-t*a,w=e*s-r*a,b=e*l-n*a,C=t*s-r*o,E=t*l-n*o,T=r*l-n*s,L=u*g-c*m,D=u*_-p*m,B=u*y-d*m,A=c*_-p*g,k=c*y-d*g,$=p*y-d*_;return x*$-w*k+b*A+C*B-E*D+T*L}h(Kz,"determinant");function n5(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=e[8],d=e[9],m=e[10],g=e[11],_=e[12],y=e[13],x=e[14],w=e[15],b=t[0],C=t[1],E=t[2],T=t[3];return i[0]=b*r+C*s+E*p+T*_,i[1]=b*n+C*l+E*d+T*y,i[2]=b*a+C*u+E*m+T*x,i[3]=b*o+C*c+E*g+T*w,b=t[4],C=t[5],E=t[6],T=t[7],i[4]=b*r+C*s+E*p+T*_,i[5]=b*n+C*l+E*d+T*y,i[6]=b*a+C*u+E*m+T*x,i[7]=b*o+C*c+E*g+T*w,b=t[8],C=t[9],E=t[10],T=t[11],i[8]=b*r+C*s+E*p+T*_,i[9]=b*n+C*l+E*d+T*y,i[10]=b*a+C*u+E*m+T*x,i[11]=b*o+C*c+E*g+T*w,b=t[12],C=t[13],E=t[14],T=t[15],i[12]=b*r+C*s+E*p+T*_,i[13]=b*n+C*l+E*d+T*y,i[14]=b*a+C*u+E*m+T*x,i[15]=b*o+C*c+E*g+T*w,i}h(n5,"multiply");function Qz(i,e,t){var r=t[0],n=t[1],a=t[2],o,s,l,u,c,p,d,m,g,_,y,x;return e===i?(i[12]=e[0]*r+e[4]*n+e[8]*a+e[12],i[13]=e[1]*r+e[5]*n+e[9]*a+e[13],i[14]=e[2]*r+e[6]*n+e[10]*a+e[14],i[15]=e[3]*r+e[7]*n+e[11]*a+e[15]):(o=e[0],s=e[1],l=e[2],u=e[3],c=e[4],p=e[5],d=e[6],m=e[7],g=e[8],_=e[9],y=e[10],x=e[11],i[0]=o,i[1]=s,i[2]=l,i[3]=u,i[4]=c,i[5]=p,i[6]=d,i[7]=m,i[8]=g,i[9]=_,i[10]=y,i[11]=x,i[12]=o*r+c*n+g*a+e[12],i[13]=s*r+p*n+_*a+e[13],i[14]=l*r+d*n+y*a+e[14],i[15]=u*r+m*n+x*a+e[15]),i}h(Qz,"translate");function eN(i,e,t){var r=t[0],n=t[1],a=t[2];return i[0]=e[0]*r,i[1]=e[1]*r,i[2]=e[2]*r,i[3]=e[3]*r,i[4]=e[4]*n,i[5]=e[5]*n,i[6]=e[6]*n,i[7]=e[7]*n,i[8]=e[8]*a,i[9]=e[9]*a,i[10]=e[10]*a,i[11]=e[11]*a,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i}h(eN,"scale");function tN(i,e,t,r){var n=r[0],a=r[1],o=r[2],s=Math.hypot(n,a,o),l,u,c,p,d,m,g,_,y,x,w,b,C,E,T,L,D,B,A,k,$,z,P,U;return s<Xt?null:(s=1/s,n*=s,a*=s,o*=s,l=Math.sin(t),u=Math.cos(t),c=1-u,p=e[0],d=e[1],m=e[2],g=e[3],_=e[4],y=e[5],x=e[6],w=e[7],b=e[8],C=e[9],E=e[10],T=e[11],L=n*n*c+u,D=a*n*c+o*l,B=o*n*c-a*l,A=n*a*c-o*l,k=a*a*c+u,$=o*a*c+n*l,z=n*o*c+a*l,P=a*o*c-n*l,U=o*o*c+u,i[0]=p*L+_*D+b*B,i[1]=d*L+y*D+C*B,i[2]=m*L+x*D+E*B,i[3]=g*L+w*D+T*B,i[4]=p*A+_*k+b*$,i[5]=d*A+y*k+C*$,i[6]=m*A+x*k+E*$,i[7]=g*A+w*k+T*$,i[8]=p*z+_*P+b*U,i[9]=d*z+y*P+C*U,i[10]=m*z+x*P+E*U,i[11]=g*z+w*P+T*U,e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i)}h(tN,"rotate");function iN(i,e,t){var r=Math.sin(t),n=Math.cos(t),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],p=e[10],d=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=a*n+u*r,i[5]=o*n+c*r,i[6]=s*n+p*r,i[7]=l*n+d*r,i[8]=u*n-a*r,i[9]=c*n-o*r,i[10]=p*n-s*r,i[11]=d*n-l*r,i}h(iN,"rotateX");function rN(i,e,t){var r=Math.sin(t),n=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],p=e[10],d=e[11];return e!==i&&(i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=a*n-u*r,i[1]=o*n-c*r,i[2]=s*n-p*r,i[3]=l*n-d*r,i[8]=a*r+u*n,i[9]=o*r+c*n,i[10]=s*r+p*n,i[11]=l*r+d*n,i}h(rN,"rotateY");function nN(i,e,t){var r=Math.sin(t),n=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],p=e[6],d=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=a*n+u*r,i[1]=o*n+c*r,i[2]=s*n+p*r,i[3]=l*n+d*r,i[4]=u*n-a*r,i[5]=c*n-o*r,i[6]=p*n-s*r,i[7]=d*n-l*r,i}h(nN,"rotateZ");function aN(i,e){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i}h(aN,"fromTranslation");function oN(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(oN,"fromScaling");function sN(i,e,t){var r=t[0],n=t[1],a=t[2],o=Math.hypot(r,n,a),s,l,u;return o<Xt?null:(o=1/o,r*=o,n*=o,a*=o,s=Math.sin(e),l=Math.cos(e),u=1-l,i[0]=r*r*u+l,i[1]=n*r*u+a*s,i[2]=a*r*u-n*s,i[3]=0,i[4]=r*n*u-a*s,i[5]=n*n*u+l,i[6]=a*n*u+r*s,i[7]=0,i[8]=r*a*u+n*s,i[9]=n*a*u-r*s,i[10]=a*a*u+l,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}h(sN,"fromRotation");function lN(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=r,i[6]=t,i[7]=0,i[8]=0,i[9]=-t,i[10]=r,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(lN,"fromXRotation");function uN(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=0,i[2]=-t,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=t,i[9]=0,i[10]=r,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(uN,"fromYRotation");function hN(i,e){var t=Math.sin(e),r=Math.cos(e);return i[0]=r,i[1]=t,i[2]=0,i[3]=0,i[4]=-t,i[5]=r,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(hN,"fromZRotation");function a5(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3],s=r+r,l=n+n,u=a+a,c=r*s,p=r*l,d=r*u,m=n*l,g=n*u,_=a*u,y=o*s,x=o*l,w=o*u;return i[0]=1-(m+_),i[1]=p+w,i[2]=d-x,i[3]=0,i[4]=p-w,i[5]=1-(c+_),i[6]=g+y,i[7]=0,i[8]=d+x,i[9]=g-y,i[10]=1-(c+m),i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}h(a5,"fromRotationTranslation");function cN(i,e){var t=new Li(3),r=-e[0],n=-e[1],a=-e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],p=r*r+n*n+a*a+o*o;return p>0?(t[0]=(s*o+c*r+l*a-u*n)*2/p,t[1]=(l*o+c*n+u*r-s*a)*2/p,t[2]=(u*o+c*a+s*n-l*r)*2/p):(t[0]=(s*o+c*r+l*a-u*n)*2,t[1]=(l*o+c*n+u*r-s*a)*2,t[2]=(u*o+c*a+s*n-l*r)*2),a5(i,e,t),i}h(cN,"fromQuat2");function pN(i,e){return i[0]=e[12],i[1]=e[13],i[2]=e[14],i}h(pN,"getTranslation");function o5(i,e){var t=e[0],r=e[1],n=e[2],a=e[4],o=e[5],s=e[6],l=e[8],u=e[9],c=e[10];return i[0]=Math.hypot(t,r,n),i[1]=Math.hypot(a,o,s),i[2]=Math.hypot(l,u,c),i}h(o5,"getScaling");function dN(i,e){var t=new Li(3);o5(t,e);var r=1/t[0],n=1/t[1],a=1/t[2],o=e[0]*r,s=e[1]*n,l=e[2]*a,u=e[4]*r,c=e[5]*n,p=e[6]*a,d=e[8]*r,m=e[9]*n,g=e[10]*a,_=o+c+g,y=0;return _>0?(y=Math.sqrt(_+1)*2,i[3]=.25*y,i[0]=(p-m)/y,i[1]=(d-l)/y,i[2]=(s-u)/y):o>c&&o>g?(y=Math.sqrt(1+o-c-g)*2,i[3]=(p-m)/y,i[0]=.25*y,i[1]=(s+u)/y,i[2]=(d+l)/y):c>g?(y=Math.sqrt(1+c-o-g)*2,i[3]=(d-l)/y,i[0]=(s+u)/y,i[1]=.25*y,i[2]=(p+m)/y):(y=Math.sqrt(1+g-o-c)*2,i[3]=(s-u)/y,i[0]=(d+l)/y,i[1]=(p+m)/y,i[2]=.25*y),i}h(dN,"getRotation");function fN(i,e,t,r){var n=e[0],a=e[1],o=e[2],s=e[3],l=n+n,u=a+a,c=o+o,p=n*l,d=n*u,m=n*c,g=a*u,_=a*c,y=o*c,x=s*l,w=s*u,b=s*c,C=r[0],E=r[1],T=r[2];return i[0]=(1-(g+y))*C,i[1]=(d+b)*C,i[2]=(m-w)*C,i[3]=0,i[4]=(d-b)*E,i[5]=(1-(p+y))*E,i[6]=(_+x)*E,i[7]=0,i[8]=(m+w)*T,i[9]=(_-x)*T,i[10]=(1-(p+g))*T,i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}h(fN,"fromRotationTranslationScale");function mN(i,e,t,r,n){var a=e[0],o=e[1],s=e[2],l=e[3],u=a+a,c=o+o,p=s+s,d=a*u,m=a*c,g=a*p,_=o*c,y=o*p,x=s*p,w=l*u,b=l*c,C=l*p,E=r[0],T=r[1],L=r[2],D=n[0],B=n[1],A=n[2],k=(1-(_+x))*E,$=(m+C)*E,z=(g-b)*E,P=(m-C)*T,U=(1-(d+x))*T,G=(y+w)*T,K=(g+b)*L,O=(y-w)*L,V=(1-(d+_))*L;return i[0]=k,i[1]=$,i[2]=z,i[3]=0,i[4]=P,i[5]=U,i[6]=G,i[7]=0,i[8]=K,i[9]=O,i[10]=V,i[11]=0,i[12]=t[0]+D-(k*D+P*B+K*A),i[13]=t[1]+B-($*D+U*B+O*A),i[14]=t[2]+A-(z*D+G*B+V*A),i[15]=1,i}h(mN,"fromRotationTranslationScaleOrigin");function gN(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=t+t,s=r+r,l=n+n,u=t*o,c=r*o,p=r*s,d=n*o,m=n*s,g=n*l,_=a*o,y=a*s,x=a*l;return i[0]=1-p-g,i[1]=c+x,i[2]=d-y,i[3]=0,i[4]=c-x,i[5]=1-u-g,i[6]=m+_,i[7]=0,i[8]=d+y,i[9]=m-_,i[10]=1-u-p,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}h(gN,"fromQuat");function yN(i,e,t,r,n,a,o){var s=1/(t-e),l=1/(n-r),u=1/(a-o);return i[0]=a*2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a*2*l,i[6]=0,i[7]=0,i[8]=(t+e)*s,i[9]=(n+r)*l,i[10]=(o+a)*u,i[11]=-1,i[12]=0,i[13]=0,i[14]=o*a*2*u,i[15]=0,i}h(yN,"frustum");function s5(i,e,t,r,n){var a=1/Math.tan(e/2),o;return i[0]=a/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,n!=null&&n!==1/0?(o=1/(r-n),i[10]=(n+r)*o,i[14]=2*n*r*o):(i[10]=-1,i[14]=-2*r),i}h(s5,"perspectiveNO");var Lce=s5;function vN(i,e,t,r,n){var a=1/Math.tan(e/2),o;return i[0]=a/t,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=a,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,n!=null&&n!==1/0?(o=1/(r-n),i[10]=n*o,i[14]=n*r*o):(i[10]=-1,i[14]=-r),i}h(vN,"perspectiveZO");function xN(i,e,t,r){var n=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(n+a);return i[0]=l,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=u,i[6]=0,i[7]=0,i[8]=-((o-s)*l*.5),i[9]=(n-a)*u*.5,i[10]=r/(t-r),i[11]=-1,i[12]=0,i[13]=0,i[14]=r*t/(t-r),i[15]=0,i}h(xN,"perspectiveFromFieldOfView");function l5(i,e,t,r,n,a,o){var s=1/(e-t),l=1/(r-n),u=1/(a-o);return i[0]=-2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*u,i[11]=0,i[12]=(e+t)*s,i[13]=(n+r)*l,i[14]=(o+a)*u,i[15]=1,i}h(l5,"orthoNO");var Dce=l5;function _N(i,e,t,r,n,a,o){var s=1/(e-t),l=1/(r-n),u=1/(a-o);return i[0]=-2*s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*l,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=u,i[11]=0,i[12]=(e+t)*s,i[13]=(n+r)*l,i[14]=a*u,i[15]=1,i}h(_N,"orthoZO");function bN(i,e,t,r){var n,a,o,s,l,u,c,p,d,m,g=e[0],_=e[1],y=e[2],x=r[0],w=r[1],b=r[2],C=t[0],E=t[1],T=t[2];return Math.abs(g-C)<Xt&&Math.abs(_-E)<Xt&&Math.abs(y-T)<Xt?r5(i):(c=g-C,p=_-E,d=y-T,m=1/Math.hypot(c,p,d),c*=m,p*=m,d*=m,n=w*d-b*p,a=b*c-x*d,o=x*p-w*c,m=Math.hypot(n,a,o),m?(m=1/m,n*=m,a*=m,o*=m):(n=0,a=0,o=0),s=p*o-d*a,l=d*n-c*o,u=c*a-p*n,m=Math.hypot(s,l,u),m?(m=1/m,s*=m,l*=m,u*=m):(s=0,l=0,u=0),i[0]=n,i[1]=s,i[2]=c,i[3]=0,i[4]=a,i[5]=l,i[6]=p,i[7]=0,i[8]=o,i[9]=u,i[10]=d,i[11]=0,i[12]=-(n*g+a*_+o*y),i[13]=-(s*g+l*_+u*y),i[14]=-(c*g+p*_+d*y),i[15]=1,i)}h(bN,"lookAt");function wN(i,e,t,r){var n=e[0],a=e[1],o=e[2],s=r[0],l=r[1],u=r[2],c=n-t[0],p=a-t[1],d=o-t[2],m=c*c+p*p+d*d;m>0&&(m=1/Math.sqrt(m),c*=m,p*=m,d*=m);var g=l*d-u*p,_=u*c-s*d,y=s*p-l*c;return m=g*g+_*_+y*y,m>0&&(m=1/Math.sqrt(m),g*=m,_*=m,y*=m),i[0]=g,i[1]=_,i[2]=y,i[3]=0,i[4]=p*y-d*_,i[5]=d*g-c*y,i[6]=c*_-p*g,i[7]=0,i[8]=c,i[9]=p,i[10]=d,i[11]=0,i[12]=n,i[13]=a,i[14]=o,i[15]=1,i}h(wN,"targetTo");function SN(i){return"mat4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+", "+i[4]+", "+i[5]+", "+i[6]+", "+i[7]+", "+i[8]+", "+i[9]+", "+i[10]+", "+i[11]+", "+i[12]+", "+i[13]+", "+i[14]+", "+i[15]+")"}h(SN,"str");function MN(i){return Math.hypot(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],i[9],i[10],i[11],i[12],i[13],i[14],i[15])}h(MN,"frob");function CN(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i[9]=e[9]+t[9],i[10]=e[10]+t[10],i[11]=e[11]+t[11],i[12]=e[12]+t[12],i[13]=e[13]+t[13],i[14]=e[14]+t[14],i[15]=e[15]+t[15],i}h(CN,"add");function u5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i[9]=e[9]-t[9],i[10]=e[10]-t[10],i[11]=e[11]-t[11],i[12]=e[12]-t[12],i[13]=e[13]-t[13],i[14]=e[14]-t[14],i[15]=e[15]-t[15],i}h(u5,"subtract");function EN(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=e[11]*t,i[12]=e[12]*t,i[13]=e[13]*t,i[14]=e[14]*t,i[15]=e[15]*t,i}h(EN,"multiplyScalar");function TN(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i[4]=e[4]+t[4]*r,i[5]=e[5]+t[5]*r,i[6]=e[6]+t[6]*r,i[7]=e[7]+t[7]*r,i[8]=e[8]+t[8]*r,i[9]=e[9]+t[9]*r,i[10]=e[10]+t[10]*r,i[11]=e[11]+t[11]*r,i[12]=e[12]+t[12]*r,i[13]=e[13]+t[13]*r,i[14]=e[14]+t[14]*r,i[15]=e[15]+t[15]*r,i}h(TN,"multiplyScalarAndAdd");function PN(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]&&i[4]===e[4]&&i[5]===e[5]&&i[6]===e[6]&&i[7]===e[7]&&i[8]===e[8]&&i[9]===e[9]&&i[10]===e[10]&&i[11]===e[11]&&i[12]===e[12]&&i[13]===e[13]&&i[14]===e[14]&&i[15]===e[15]}h(PN,"exactEquals");function AN(i,e){var t=i[0],r=i[1],n=i[2],a=i[3],o=i[4],s=i[5],l=i[6],u=i[7],c=i[8],p=i[9],d=i[10],m=i[11],g=i[12],_=i[13],y=i[14],x=i[15],w=e[0],b=e[1],C=e[2],E=e[3],T=e[4],L=e[5],D=e[6],B=e[7],A=e[8],k=e[9],$=e[10],z=e[11],P=e[12],U=e[13],G=e[14],K=e[15];return Math.abs(t-w)<=Xt*Math.max(1,Math.abs(t),Math.abs(w))&&Math.abs(r-b)<=Xt*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-C)<=Xt*Math.max(1,Math.abs(n),Math.abs(C))&&Math.abs(a-E)<=Xt*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(o-T)<=Xt*Math.max(1,Math.abs(o),Math.abs(T))&&Math.abs(s-L)<=Xt*Math.max(1,Math.abs(s),Math.abs(L))&&Math.abs(l-D)<=Xt*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(u-B)<=Xt*Math.max(1,Math.abs(u),Math.abs(B))&&Math.abs(c-A)<=Xt*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(p-k)<=Xt*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(d-$)<=Xt*Math.max(1,Math.abs(d),Math.abs($))&&Math.abs(m-z)<=Xt*Math.max(1,Math.abs(m),Math.abs(z))&&Math.abs(g-P)<=Xt*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(_-U)<=Xt*Math.max(1,Math.abs(_),Math.abs(U))&&Math.abs(y-G)<=Xt*Math.max(1,Math.abs(y),Math.abs(G))&&Math.abs(x-K)<=Xt*Math.max(1,Math.abs(x),Math.abs(K))}h(AN,"equals");var kce=n5,Rce=u5,yo={};_h(yo,{add:()=>RN,angle:()=>i$,bezier:()=>qN,ceil:()=>FN,clone:()=>IN,copy:()=>DN,create:()=>h5,cross:()=>GN,dist:()=>zce,distance:()=>m5,div:()=>Bce,divide:()=>f5,dot:()=>v5,equals:()=>o$,exactEquals:()=>a$,floor:()=>ON,forEach:()=>Vce,fromValues:()=>LN,hermite:()=>XN,inverse:()=>jN,len:()=>$ce,length:()=>c5,lerp:()=>WN,max:()=>zN,min:()=>BN,mul:()=>Oce,multiply:()=>d5,negate:()=>VN,normalize:()=>HN,random:()=>ZN,rotateX:()=>QN,rotateY:()=>e$,rotateZ:()=>t$,round:()=>NN,scale:()=>$N,scaleAndAdd:()=>UN,set:()=>kN,sqrDist:()=>Nce,sqrLen:()=>Uce,squaredDistance:()=>g5,squaredLength:()=>y5,str:()=>n$,sub:()=>Fce,subtract:()=>p5,transformMat3:()=>JN,transformMat4:()=>YN,transformQuat:()=>KN,zero:()=>r$});R();function h5(){var i=new Li(3);return Li!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}h(h5,"create");function IN(i){var e=new Li(3);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e}h(IN,"clone");function c5(i){var e=i[0],t=i[1],r=i[2];return Math.hypot(e,t,r)}h(c5,"length");function LN(i,e,t){var r=new Li(3);return r[0]=i,r[1]=e,r[2]=t,r}h(LN,"fromValues");function DN(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i}h(DN,"copy");function kN(i,e,t,r){return i[0]=e,i[1]=t,i[2]=r,i}h(kN,"set");function RN(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i}h(RN,"add");function p5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i}h(p5,"subtract");function d5(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i}h(d5,"multiply");function f5(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i}h(f5,"divide");function FN(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i[2]=Math.ceil(e[2]),i}h(FN,"ceil");function ON(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i[2]=Math.floor(e[2]),i}h(ON,"floor");function BN(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i}h(BN,"min");function zN(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i}h(zN,"max");function NN(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i[2]=Math.round(e[2]),i}h(NN,"round");function $N(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i}h($N,"scale");function UN(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i}h(UN,"scaleAndAdd");function m5(i,e){var t=e[0]-i[0],r=e[1]-i[1],n=e[2]-i[2];return Math.hypot(t,r,n)}h(m5,"distance");function g5(i,e){var t=e[0]-i[0],r=e[1]-i[1],n=e[2]-i[2];return t*t+r*r+n*n}h(g5,"squaredDistance");function y5(i){var e=i[0],t=i[1],r=i[2];return e*e+t*t+r*r}h(y5,"squaredLength");function VN(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i}h(VN,"negate");function jN(i,e){return i[0]=1/e[0],i[1]=1/e[1],i[2]=1/e[2],i}h(jN,"inverse");function HN(i,e){var t=e[0],r=e[1],n=e[2],a=t*t+r*r+n*n;return a>0&&(a=1/Math.sqrt(a)),i[0]=e[0]*a,i[1]=e[1]*a,i[2]=e[2]*a,i}h(HN,"normalize");function v5(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]}h(v5,"dot");function GN(i,e,t){var r=e[0],n=e[1],a=e[2],o=t[0],s=t[1],l=t[2];return i[0]=n*l-a*s,i[1]=a*o-r*l,i[2]=r*s-n*o,i}h(GN,"cross");function WN(i,e,t,r){var n=e[0],a=e[1],o=e[2];return i[0]=n+r*(t[0]-n),i[1]=a+r*(t[1]-a),i[2]=o+r*(t[2]-o),i}h(WN,"lerp");function XN(i,e,t,r,n,a){var o=a*a,s=o*(2*a-3)+1,l=o*(a-2)+a,u=o*(a-1),c=o*(3-2*a);return i[0]=e[0]*s+t[0]*l+r[0]*u+n[0]*c,i[1]=e[1]*s+t[1]*l+r[1]*u+n[1]*c,i[2]=e[2]*s+t[2]*l+r[2]*u+n[2]*c,i}h(XN,"hermite");function qN(i,e,t,r,n,a){var o=1-a,s=o*o,l=a*a,u=s*o,c=3*a*s,p=3*l*o,d=l*a;return i[0]=e[0]*u+t[0]*c+r[0]*p+n[0]*d,i[1]=e[1]*u+t[1]*c+r[1]*p+n[1]*d,i[2]=e[2]*u+t[2]*c+r[2]*p+n[2]*d,i}h(qN,"bezier");function ZN(i,e){e=e||1;var t=zu()*2*Math.PI,r=zu()*2-1,n=Math.sqrt(1-r*r)*e;return i[0]=Math.cos(t)*n,i[1]=Math.sin(t)*n,i[2]=r*e,i}h(ZN,"random");function YN(i,e,t){var r=e[0],n=e[1],a=e[2],o=t[3]*r+t[7]*n+t[11]*a+t[15];return o=o||1,i[0]=(t[0]*r+t[4]*n+t[8]*a+t[12])/o,i[1]=(t[1]*r+t[5]*n+t[9]*a+t[13])/o,i[2]=(t[2]*r+t[6]*n+t[10]*a+t[14])/o,i}h(YN,"transformMat4");function JN(i,e,t){var r=e[0],n=e[1],a=e[2];return i[0]=r*t[0]+n*t[3]+a*t[6],i[1]=r*t[1]+n*t[4]+a*t[7],i[2]=r*t[2]+n*t[5]+a*t[8],i}h(JN,"transformMat3");function KN(i,e,t){var r=t[0],n=t[1],a=t[2],o=t[3],s=e[0],l=e[1],u=e[2],c=n*u-a*l,p=a*s-r*u,d=r*l-n*s,m=n*d-a*p,g=a*c-r*d,_=r*p-n*c,y=o*2;return c*=y,p*=y,d*=y,m*=2,g*=2,_*=2,i[0]=s+c+m,i[1]=l+p+g,i[2]=u+d+_,i}h(KN,"transformQuat");function QN(i,e,t,r){var n=[],a=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],a[0]=n[0],a[1]=n[1]*Math.cos(r)-n[2]*Math.sin(r),a[2]=n[1]*Math.sin(r)+n[2]*Math.cos(r),i[0]=a[0]+t[0],i[1]=a[1]+t[1],i[2]=a[2]+t[2],i}h(QN,"rotateX");function e$(i,e,t,r){var n=[],a=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],a[0]=n[2]*Math.sin(r)+n[0]*Math.cos(r),a[1]=n[1],a[2]=n[2]*Math.cos(r)-n[0]*Math.sin(r),i[0]=a[0]+t[0],i[1]=a[1]+t[1],i[2]=a[2]+t[2],i}h(e$,"rotateY");function t$(i,e,t,r){var n=[],a=[];return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],a[0]=n[0]*Math.cos(r)-n[1]*Math.sin(r),a[1]=n[0]*Math.sin(r)+n[1]*Math.cos(r),a[2]=n[2],i[0]=a[0]+t[0],i[1]=a[1]+t[1],i[2]=a[2]+t[2],i}h(t$,"rotateZ");function i$(i,e){var t=i[0],r=i[1],n=i[2],a=e[0],o=e[1],s=e[2],l=Math.sqrt(t*t+r*r+n*n),u=Math.sqrt(a*a+o*o+s*s),c=l*u,p=c&&v5(i,e)/c;return Math.acos(Math.min(Math.max(p,-1),1))}h(i$,"angle");function r$(i){return i[0]=0,i[1]=0,i[2]=0,i}h(r$,"zero");function n$(i){return"vec3("+i[0]+", "+i[1]+", "+i[2]+")"}h(n$,"str");function a$(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]}h(a$,"exactEquals");function o$(i,e){var t=i[0],r=i[1],n=i[2],a=e[0],o=e[1],s=e[2];return Math.abs(t-a)<=Xt*Math.max(1,Math.abs(t),Math.abs(a))&&Math.abs(r-o)<=Xt*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=Xt*Math.max(1,Math.abs(n),Math.abs(s))}h(o$,"equals");var Fce=p5,Oce=d5,Bce=f5,zce=m5,Nce=g5,$ce=c5,Uce=y5,Vce=function(){var i=h5();return function(e,t,r,n,a,o){var s,l;for(t||(t=3),r||(r=0),n?l=Math.min(n*t+r,e.length):l=e.length,s=r;s<l;s+=t)i[0]=e[s],i[1]=e[s+1],i[2]=e[s+2],a(i,i,o),e[s]=i[0],e[s+1]=i[1],e[s+2]=i[2];return e}}(),Tn={};_h(Tn,{add:()=>c$,ceil:()=>p$,clone:()=>s$,copy:()=>u$,create:()=>x5,cross:()=>S$,dist:()=>Wce,distance:()=>S5,div:()=>Gce,divide:()=>w5,dot:()=>w$,equals:()=>L$,exactEquals:()=>I$,floor:()=>d$,forEach:()=>Yce,fromValues:()=>l$,inverse:()=>_$,len:()=>qce,length:()=>C5,lerp:()=>M$,max:()=>m$,min:()=>f$,mul:()=>Hce,multiply:()=>b5,negate:()=>x$,normalize:()=>b$,random:()=>C$,round:()=>g$,scale:()=>y$,scaleAndAdd:()=>v$,set:()=>h$,sqrDist:()=>Xce,sqrLen:()=>Zce,squaredDistance:()=>M5,squaredLength:()=>E5,str:()=>A$,sub:()=>jce,subtract:()=>_5,transformMat4:()=>E$,transformQuat:()=>T$,zero:()=>P$});R();function x5(){var i=new Li(4);return Li!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0,i[3]=0),i}h(x5,"create");function s$(i){var e=new Li(4);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e}h(s$,"clone");function l$(i,e,t,r){var n=new Li(4);return n[0]=i,n[1]=e,n[2]=t,n[3]=r,n}h(l$,"fromValues");function u$(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i}h(u$,"copy");function h$(i,e,t,r,n){return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}h(h$,"set");function c$(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i}h(c$,"add");function _5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i}h(_5,"subtract");function b5(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i[2]=e[2]*t[2],i[3]=e[3]*t[3],i}h(b5,"multiply");function w5(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i[2]=e[2]/t[2],i[3]=e[3]/t[3],i}h(w5,"divide");function p$(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i[2]=Math.ceil(e[2]),i[3]=Math.ceil(e[3]),i}h(p$,"ceil");function d$(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i[2]=Math.floor(e[2]),i[3]=Math.floor(e[3]),i}h(d$,"floor");function f$(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i[2]=Math.min(e[2],t[2]),i[3]=Math.min(e[3],t[3]),i}h(f$,"min");function m$(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i[3]=Math.max(e[3],t[3]),i}h(m$,"max");function g$(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i[2]=Math.round(e[2]),i[3]=Math.round(e[3]),i}h(g$,"round");function y$(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i}h(y$,"scale");function v$(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i[2]=e[2]+t[2]*r,i[3]=e[3]+t[3]*r,i}h(v$,"scaleAndAdd");function S5(i,e){var t=e[0]-i[0],r=e[1]-i[1],n=e[2]-i[2],a=e[3]-i[3];return Math.hypot(t,r,n,a)}h(S5,"distance");function M5(i,e){var t=e[0]-i[0],r=e[1]-i[1],n=e[2]-i[2],a=e[3]-i[3];return t*t+r*r+n*n+a*a}h(M5,"squaredDistance");function C5(i){var e=i[0],t=i[1],r=i[2],n=i[3];return Math.hypot(e,t,r,n)}h(C5,"length");function E5(i){var e=i[0],t=i[1],r=i[2],n=i[3];return e*e+t*t+r*r+n*n}h(E5,"squaredLength");function x$(i,e){return i[0]=-e[0],i[1]=-e[1],i[2]=-e[2],i[3]=-e[3],i}h(x$,"negate");function _$(i,e){return i[0]=1/e[0],i[1]=1/e[1],i[2]=1/e[2],i[3]=1/e[3],i}h(_$,"inverse");function b$(i,e){var t=e[0],r=e[1],n=e[2],a=e[3],o=t*t+r*r+n*n+a*a;return o>0&&(o=1/Math.sqrt(o)),i[0]=t*o,i[1]=r*o,i[2]=n*o,i[3]=a*o,i}h(b$,"normalize");function w$(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]*e[3]}h(w$,"dot");function S$(i,e,t,r){var n=t[0]*r[1]-t[1]*r[0],a=t[0]*r[2]-t[2]*r[0],o=t[0]*r[3]-t[3]*r[0],s=t[1]*r[2]-t[2]*r[1],l=t[1]*r[3]-t[3]*r[1],u=t[2]*r[3]-t[3]*r[2],c=e[0],p=e[1],d=e[2],m=e[3];return i[0]=p*u-d*l+m*s,i[1]=-(c*u)+d*o-m*a,i[2]=c*l-p*o+m*n,i[3]=-(c*s)+p*a-d*n,i}h(S$,"cross");function M$(i,e,t,r){var n=e[0],a=e[1],o=e[2],s=e[3];return i[0]=n+r*(t[0]-n),i[1]=a+r*(t[1]-a),i[2]=o+r*(t[2]-o),i[3]=s+r*(t[3]-s),i}h(M$,"lerp");function C$(i,e){e=e||1;var t,r,n,a,o,s;do t=zu()*2-1,r=zu()*2-1,o=t*t+r*r;while(o>=1);do n=zu()*2-1,a=zu()*2-1,s=n*n+a*a;while(s>=1);var l=Math.sqrt((1-o)/s);return i[0]=e*t,i[1]=e*r,i[2]=e*n*l,i[3]=e*a*l,i}h(C$,"random");function E$(i,e,t){var r=e[0],n=e[1],a=e[2],o=e[3];return i[0]=t[0]*r+t[4]*n+t[8]*a+t[12]*o,i[1]=t[1]*r+t[5]*n+t[9]*a+t[13]*o,i[2]=t[2]*r+t[6]*n+t[10]*a+t[14]*o,i[3]=t[3]*r+t[7]*n+t[11]*a+t[15]*o,i}h(E$,"transformMat4");function T$(i,e,t){var r=e[0],n=e[1],a=e[2],o=t[0],s=t[1],l=t[2],u=t[3],c=u*r+s*a-l*n,p=u*n+l*r-o*a,d=u*a+o*n-s*r,m=-o*r-s*n-l*a;return i[0]=c*u+m*-o+p*-l-d*-s,i[1]=p*u+m*-s+d*-o-c*-l,i[2]=d*u+m*-l+c*-s-p*-o,i[3]=e[3],i}h(T$,"transformQuat");function P$(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=0,i}h(P$,"zero");function A$(i){return"vec4("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")"}h(A$,"str");function I$(i,e){return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]}h(I$,"exactEquals");function L$(i,e){var t=i[0],r=i[1],n=i[2],a=i[3],o=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(t-o)<=Xt*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(r-s)<=Xt*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=Xt*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=Xt*Math.max(1,Math.abs(a),Math.abs(u))}h(L$,"equals");var jce=_5,Hce=b5,Gce=w5,Wce=S5,Xce=M5,qce=C5,Zce=E5,Yce=function(){var i=x5();return function(e,t,r,n,a,o){var s,l;for(t||(t=4),r||(r=0),n?l=Math.min(n*t+r,e.length):l=e.length,s=r;s<l;s+=t)i[0]=e[s],i[1]=e[s+1],i[2]=e[s+2],i[3]=e[s+3],a(i,i,o),e[s]=i[0],e[s+1]=i[1],e[s+2]=i[2],e[s+3]=i[3];return e}}(),T5={};_h(T5,{add:()=>O$,angle:()=>iU,ceil:()=>B$,clone:()=>D$,copy:()=>R$,create:()=>P5,cross:()=>q$,dist:()=>tpe,distance:()=>D5,div:()=>epe,divide:()=>L5,dot:()=>X$,equals:()=>oU,exactEquals:()=>aU,floor:()=>z$,forEach:()=>npe,fromValues:()=>k$,inverse:()=>G$,len:()=>Jce,length:()=>R5,lerp:()=>Z$,max:()=>$$,min:()=>N$,mul:()=>Qce,multiply:()=>I5,negate:()=>H$,normalize:()=>W$,random:()=>Y$,rotate:()=>tU,round:()=>U$,scale:()=>V$,scaleAndAdd:()=>j$,set:()=>F$,sqrDist:()=>ipe,sqrLen:()=>rpe,squaredDistance:()=>k5,squaredLength:()=>F5,str:()=>nU,sub:()=>Kce,subtract:()=>A5,transformMat2:()=>J$,transformMat2d:()=>K$,transformMat3:()=>Q$,transformMat4:()=>eU,zero:()=>rU});R();function P5(){var i=new Li(2);return Li!=Float32Array&&(i[0]=0,i[1]=0),i}h(P5,"create");function D$(i){var e=new Li(2);return e[0]=i[0],e[1]=i[1],e}h(D$,"clone");function k$(i,e){var t=new Li(2);return t[0]=i,t[1]=e,t}h(k$,"fromValues");function R$(i,e){return i[0]=e[0],i[1]=e[1],i}h(R$,"copy");function F$(i,e,t){return i[0]=e,i[1]=t,i}h(F$,"set");function O$(i,e,t){return i[0]=e[0]+t[0],i[1]=e[1]+t[1],i}h(O$,"add");function A5(i,e,t){return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i}h(A5,"subtract");function I5(i,e,t){return i[0]=e[0]*t[0],i[1]=e[1]*t[1],i}h(I5,"multiply");function L5(i,e,t){return i[0]=e[0]/t[0],i[1]=e[1]/t[1],i}h(L5,"divide");function B$(i,e){return i[0]=Math.ceil(e[0]),i[1]=Math.ceil(e[1]),i}h(B$,"ceil");function z$(i,e){return i[0]=Math.floor(e[0]),i[1]=Math.floor(e[1]),i}h(z$,"floor");function N$(i,e,t){return i[0]=Math.min(e[0],t[0]),i[1]=Math.min(e[1],t[1]),i}h(N$,"min");function $$(i,e,t){return i[0]=Math.max(e[0],t[0]),i[1]=Math.max(e[1],t[1]),i}h($$,"max");function U$(i,e){return i[0]=Math.round(e[0]),i[1]=Math.round(e[1]),i}h(U$,"round");function V$(i,e,t){return i[0]=e[0]*t,i[1]=e[1]*t,i}h(V$,"scale");function j$(i,e,t,r){return i[0]=e[0]+t[0]*r,i[1]=e[1]+t[1]*r,i}h(j$,"scaleAndAdd");function D5(i,e){var t=e[0]-i[0],r=e[1]-i[1];return Math.hypot(t,r)}h(D5,"distance");function k5(i,e){var t=e[0]-i[0],r=e[1]-i[1];return t*t+r*r}h(k5,"squaredDistance");function R5(i){var e=i[0],t=i[1];return Math.hypot(e,t)}h(R5,"length");function F5(i){var e=i[0],t=i[1];return e*e+t*t}h(F5,"squaredLength");function H$(i,e){return i[0]=-e[0],i[1]=-e[1],i}h(H$,"negate");function G$(i,e){return i[0]=1/e[0],i[1]=1/e[1],i}h(G$,"inverse");function W$(i,e){var t=e[0],r=e[1],n=t*t+r*r;return n>0&&(n=1/Math.sqrt(n)),i[0]=e[0]*n,i[1]=e[1]*n,i}h(W$,"normalize");function X$(i,e){return i[0]*e[0]+i[1]*e[1]}h(X$,"dot");function q$(i,e,t){var r=e[0]*t[1]-e[1]*t[0];return i[0]=i[1]=0,i[2]=r,i}h(q$,"cross");function Z$(i,e,t,r){var n=e[0],a=e[1];return i[0]=n+r*(t[0]-n),i[1]=a+r*(t[1]-a),i}h(Z$,"lerp");function Y$(i,e){e=e||1;var t=zu()*2*Math.PI;return i[0]=Math.cos(t)*e,i[1]=Math.sin(t)*e,i}h(Y$,"random");function J$(i,e,t){var r=e[0],n=e[1];return i[0]=t[0]*r+t[2]*n,i[1]=t[1]*r+t[3]*n,i}h(J$,"transformMat2");function K$(i,e,t){var r=e[0],n=e[1];return i[0]=t[0]*r+t[2]*n+t[4],i[1]=t[1]*r+t[3]*n+t[5],i}h(K$,"transformMat2d");function Q$(i,e,t){var r=e[0],n=e[1];return i[0]=t[0]*r+t[3]*n+t[6],i[1]=t[1]*r+t[4]*n+t[7],i}h(Q$,"transformMat3");function eU(i,e,t){var r=e[0],n=e[1];return i[0]=t[0]*r+t[4]*n+t[12],i[1]=t[1]*r+t[5]*n+t[13],i}h(eU,"transformMat4");function tU(i,e,t,r){var n=e[0]-t[0],a=e[1]-t[1],o=Math.sin(r),s=Math.cos(r);return i[0]=n*s-a*o+t[0],i[1]=n*o+a*s+t[1],i}h(tU,"rotate");function iU(i,e){var t=i[0],r=i[1],n=e[0],a=e[1],o=Math.sqrt(t*t+r*r)*Math.sqrt(n*n+a*a),s=o&&(t*n+r*a)/o;return Math.acos(Math.min(Math.max(s,-1),1))}h(iU,"angle");function rU(i){return i[0]=0,i[1]=0,i}h(rU,"zero");function nU(i){return"vec2("+i[0]+", "+i[1]+")"}h(nU,"str");function aU(i,e){return i[0]===e[0]&&i[1]===e[1]}h(aU,"exactEquals");function oU(i,e){var t=i[0],r=i[1],n=e[0],a=e[1];return Math.abs(t-n)<=Xt*Math.max(1,Math.abs(t),Math.abs(n))&&Math.abs(r-a)<=Xt*Math.max(1,Math.abs(r),Math.abs(a))}h(oU,"equals");var Jce=R5,Kce=A5,Qce=I5,epe=L5,tpe=D5,ipe=k5,rpe=F5,npe=function(){var i=P5();return function(e,t,r,n,a,o){var s,l;for(t||(t=2),r||(r=0),n?l=Math.min(n*t+r,e.length):l=e.length,s=r;s<l;s+=t)i[0]=e[s],i[1]=e[s+1],a(i,i,o),e[s]=i[0],e[s+1]=i[1];return e}}(),ape=kt(gi(),1),sU=class extends is{constructor(e){super(e,Ece)}createBucket(e){return new Y4(e)}queryRadius(e){let t=e;return Cp("circle-radius",this,t)+Cp("circle-stroke-width",this,t)+wg(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,n,a,o,s,l){let u=Sg(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,s),c=this.paint.get("circle-radius").evaluate(t,r),p=this.paint.get("circle-stroke-width").evaluate(t,r),d=c+p,m=this.paint.get("circle-pitch-alignment")==="map",g=m?u:lU(u,l),_=m?d*s:d;for(let y of n)for(let x of y){let w=m?x:O5(x,l),b=_,C=Tn.transformMat4([],[x.x,x.y,0,1],l);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?b*=C[3]/o.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(b*=o.cameraToCenterDistance/C[3]),$B(g,w,b))return!0}return!1}};h(sU,"CircleStyleLayer");var ope=sU;function O5(i,e){let t=Tn.transformMat4([],[i.x,i.y,0,1],e);return new ape.default(t[0]/t[3],t[1]/t[3])}h(O5,"projectPoint");function lU(i,e){return i.map(t=>O5(t,e))}h(lU,"projectQueryGeometry");R();R();var uU=class extends Y4{};h(uU,"HeatmapBucket");var hU=uU;ut("HeatmapBucket",hU,{omit:["layers"]});R();var u6,spe=h(()=>u6=u6||new ia({"heatmap-radius":new Ct(Le.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ct(Le.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new yt(Le.paint_heatmap["heatmap-intensity"]),"heatmap-color":new I4(Le.paint_heatmap["heatmap-color"]),"heatmap-opacity":new yt(Le.paint_heatmap["heatmap-opacity"])}),"getPaint"),lpe={get paint(){return spe()}};R();R();function h_(i,{width:e,height:t},r,n){if(!n)n=new Uint8Array(e*t*r);else if(n instanceof Uint8ClampedArray)n=new Uint8Array(n.buffer);else if(n.length!==e*t*r)throw new RangeError(`mismatched image size. expected: ${n.length} but got: ${e*t*r}`);return i.width=e,i.height=t,i.data=n,i}h(h_,"createImage");function B5(i,{width:e,height:t},r){if(e===i.width&&t===i.height)return;let n=h_({},{width:e,height:t},r);c_(i,n,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,e),height:Math.min(i.height,t)},r),i.width=e,i.height=t,i.data=n.data}h(B5,"resizeImage");function c_(i,e,t,r,n,a){if(n.width===0||n.height===0)return e;if(n.width>i.width||n.height>i.height||t.x>i.width-n.width||t.y>i.height-n.height)throw new RangeError("out of range source coordinates for image copy");if(n.width>e.width||n.height>e.height||r.x>e.width-n.width||r.y>e.height-n.height)throw new RangeError("out of range destination coordinates for image copy");let o=i.data,s=e.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<n.height;l++){let u=((t.y+l)*i.width+t.x)*a,c=((r.y+l)*e.width+r.x)*a;for(let p=0;p<n.width*a;p++)s[c+p]=o[u+p]}return e}h(c_,"copyImage");var cU=class pU{constructor(e,t){h_(this,e,1,t)}resize(e){B5(this,e,1)}clone(){return new pU({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,a){c_(e,t,r,n,a,1)}};h(cU,"AlphaImage");var z5=cU,dU=class fU{constructor(e,t){h_(this,e,4,t)}resize(e){B5(this,e,4)}replace(e,t){t?this.data.set(e):e instanceof Uint8ClampedArray?this.data=new Uint8Array(e.buffer):this.data=e}clone(){return new fU({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,a){c_(e,t,r,n,a,4)}};h(dU,"RGBAImage");var rr=dU;ut("AlphaImage",z5);ut("RGBAImage",rr);function N5(i){let e={},t=i.resolution||256,r=i.clips?i.clips.length:1,n=i.image||new rr({width:t,height:r});if(!vD(t))throw new Error(`width is not a power of 2 - ${t}`);let a=h((o,s,l)=>{e[i.evaluationKey]=l;let u=i.expression.evaluate(e);n.data[o+s+0]=Math.floor(u.r*255/u.a),n.data[o+s+1]=Math.floor(u.g*255/u.a),n.data[o+s+2]=Math.floor(u.b*255/u.a),n.data[o+s+3]=Math.floor(u.a*255)},"renderPixel");if(i.clips)for(let o=0,s=0;o<r;++o,s+=t*4)for(let l=0,u=0;l<t;l++,u+=4){let c=l/(t-1),{start:p,end:d}=i.clips[o],m=p*(1-c)+d*c;a(s,u,m)}else for(let o=0,s=0;o<t;o++,s+=4){let l=o/(t-1);a(0,s,l)}return n}h(N5,"renderColorRamp");var mU=class extends is{createBucket(e){return new hU(e)}constructor(e){super(e,lpe),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let e=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=N5({expression:e,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};h(mU,"HeatmapStyleLayer");var upe=mU;R();R();var h6,hpe=h(()=>h6=h6||new ia({"hillshade-illumination-direction":new yt(Le.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new yt(Le.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new yt(Le.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new yt(Le.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new yt(Le.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new yt(Le.paint_hillshade["hillshade-accent-color"])}),"getPaint"),cpe={get paint(){return hpe()}},gU=class extends is{constructor(e){super(e,cpe)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};h(gU,"HillshadeStyleLayer");var ppe=gU;R();R();R();var dpe=Yi([{name:"a_pos",components:2,type:"Int16"}],4),{members:fpe,size:kEe,alignment:REe}=dpe,mpe=kt(hD(),1);R();R();function yU(i,e,t,r,n){$5(i,e,t||0,r||i.length-1,n||vU)}h(yU,"quickselect");function $5(i,e,t,r,n){for(;r>t;){if(r-t>600){var a=r-t+1,o=e-t+1,s=Math.log(a),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1),c=Math.max(t,Math.floor(e-o*l/a+u)),p=Math.min(r,Math.floor(e+(a-o)*l/a+u));$5(i,e,c,p,n)}var d=i[e],m=t,g=r;for(lc(i,t,e),n(i[r],d)>0&&lc(i,t,r);m<g;){for(lc(i,m,g),m++,g--;n(i[m],d)<0;)m++;for(;n(i[g],d)>0;)g--}n(i[t],d)===0?lc(i,t,g):(g++,lc(i,g,r)),g<=e&&(t=g+1),e<=g&&(r=g-1)}}h($5,"quickselectStep");function lc(i,e,t){var r=i[e];i[e]=i[t],i[t]=r}h(lc,"swap");function vU(i,e){return i<e?-1:i>e?1:0}h(vU,"defaultCompare");function U5(i,e){let t=i.length;if(t<=1)return[i];let r=[],n,a;for(let o=0;o<t;o++){let s=wD(i[o]);s!==0&&(i[o].area=Math.abs(s),a===void 0&&(a=s<0),a===s<0?(n&&r.push(n),n=[i[o]]):n.push(i[o]))}if(n&&r.push(n),e>1)for(let o=0;o<r.length;o++)r[o].length<=e||(yU(r[o],e,1,r[o].length-1,xU),r[o]=r[o].slice(0,e));return r}h(U5,"classifyRings");function xU(i,e){return e.area-i.area}h(xU,"compareAreas");R();function p_(i,e,t){let r=t.patternDependencies,n=!1;for(let a of e){let o=a.paint.get(`${i}-pattern`);o.isConstant()||(n=!0);let s=o.constantOr(null);s&&(n=!0,r[s.to]=!0,r[s.from]=!0)}return n}h(p_,"hasPattern");function d_(i,e,t,r,n){let a=n.patternDependencies;for(let o of e){let s=o.paint.get(`${i}-pattern`).value;if(s.kind!=="constant"){let l=s.evaluate({zoom:r-1},t,{},n.availableImages),u=s.evaluate({zoom:r},t,{},n.availableImages),c=s.evaluate({zoom:r+1},t,{},n.availableImages);l=l&&l.name?l.name:l,u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,a[l]=!0,a[u]=!0,a[c]=!0,t.patterns[o.id]={min:l,mid:u,max:c}}}return t}h(d_,"addPatternDependencies");var gpe=500,_U=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new lce,this.indexArray=new Ch,this.indexArray2=new b3,this.programConfigurations=new ch(e.layers,e.zoom),this.segments=new fr,this.segments2=new fr,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,r){this.hasPattern=p_("fill",this.layers,t);let n=this.layers[0].layout.get("fill-sort-key"),a=!n.isConstant(),o=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,d=eu(s,p);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),d,r))continue;let m=a?n.evaluate(d,{},r,t.availableImages):void 0,g={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?d.geometry:Ql(s),patterns:{},sortKey:m};o.push(g)}a&&o.sort((s,l)=>s.sortKey-l.sortKey);for(let s of o){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let d=d_("fill",this.layers,s,this.zoom,t);this.patternFeatures.push(d)}else this.addFeature(s,l,u,r,{});let p=e[u].feature;t.featureIndex.insert(p,l,u,c,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(let n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fpe),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,n,a){for(let o of U5(t,gpe)){let s=0;for(let m of o)s+=m.length;let l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],p=[];for(let m of o){if(m.length===0)continue;m!==o[0]&&p.push(c.length/2);let g=this.segments2.prepareSegment(m.length,this.layoutVertexArray,this.indexArray2),_=g.vertexLength;this.layoutVertexArray.emplaceBack(m[0].x,m[0].y),this.indexArray2.emplaceBack(_+m.length-1,_),c.push(m[0].x),c.push(m[0].y);for(let y=1;y<m.length;y++)this.layoutVertexArray.emplaceBack(m[y].x,m[y].y),this.indexArray2.emplaceBack(_+y-1,_+y),c.push(m[y].x),c.push(m[y].y);g.vertexLength+=m.length,g.primitiveLength+=m.length}let d=(0,mpe.default)(c,p);for(let m=0;m<d.length;m+=3)this.indexArray.emplaceBack(u+d[m],u+d[m+1],u+d[m+2]);l.vertexLength+=s,l.primitiveLength+=d.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,n)}};h(_U,"FillBucket");var bU=_U;ut("FillBucket",bU,{omit:["layers","patternFeatures"]});R();var c6,ype=h(()=>c6=c6||new ia({"fill-sort-key":new Ct(Le.layout_fill["fill-sort-key"])}),"getLayout"),p6,vpe=h(()=>p6=p6||new ia({"fill-antialias":new yt(Le.paint_fill["fill-antialias"]),"fill-opacity":new Ct(Le.paint_fill["fill-opacity"]),"fill-color":new Ct(Le.paint_fill["fill-color"]),"fill-outline-color":new Ct(Le.paint_fill["fill-outline-color"]),"fill-translate":new yt(Le.paint_fill["fill-translate"]),"fill-translate-anchor":new yt(Le.paint_fill["fill-translate-anchor"]),"fill-pattern":new a_(Le.paint_fill["fill-pattern"])}),"getPaint"),xpe={get paint(){return vpe()},get layout(){return ype()}},wU=class extends is{constructor(e){super(e,xpe)}recalculate(e,t){super.recalculate(e,t);let r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new bU(e)}queryRadius(){return wg(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,n,a,o,s){let l=Sg(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,s);return K4(l,n)}isTileClipped(){return!0}};h(wU,"FillStyleLayer");var _pe=wU;R();R();R();var bpe=Yi([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),wpe=Yi([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Spe,size:BEe,alignment:zEe}=bpe,Mpe=kt(hD(),1),Cpe=kt(Bx(),1),Epe=Cpe.default.VectorTileFeature.types,Tpe=500,I2=Math.pow(2,13);function uc(i,e,t,r,n,a,o,s){i.emplaceBack(e,t,Math.floor(r*I2)*2+o,n*I2*2,a*I2*2,Math.round(s))}h(uc,"addVertex");var SU=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new uce,this.centroidVertexArray=new Ry,this.indexArray=new Ch,this.programConfigurations=new ch(e.layers,e.zoom),this.segments=new fr,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,r){this.features=[],this.hasPattern=p_("fill-extrusion",this.layers,t);for(let{feature:n,id:a,index:o,sourceLayerIndex:s}of e){let l=this.layers[0]._featureFilter.needGeometry,u=eu(n,l);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),u,r))continue;let c={id:a,sourceLayerIndex:s,index:o,geometry:l?u.geometry:Ql(n),properties:n.properties,type:n.type,patterns:{}};this.hasPattern?this.features.push(d_("fill-extrusion",this.layers,c,this.zoom,t)):this.addFeature(c,c.geometry,o,r,{}),t.featureIndex.insert(n,c.geometry,o,s,this.index,!0)}}addFeatures(e,t,r){for(let n of this.features){let{geometry:a}=n;this.addFeature(n,a,n.index,t,r)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Spe),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,wpe.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,r,n,a){let o={x:0,y:0,vertexCount:0};for(let s of U5(t,Tpe)){let l=0;for(let g of s)l+=g.length;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let g of s){if(g.length===0||EU(g))continue;let _=0;for(let y=0;y<g.length;y++){let x=g[y];if(y>=1){let w=g[y-1];if(!CU(x,w)){u.vertexLength+4>fr.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let b=x.sub(w)._perp()._unit(),C=w.dist(x);_+C>32768&&(_=0),uc(this.layoutVertexArray,x.x,x.y,b.x,b.y,0,0,_),uc(this.layoutVertexArray,x.x,x.y,b.x,b.y,0,1,_),o.x+=2*x.x,o.y+=2*x.y,o.vertexCount+=2,_+=C,uc(this.layoutVertexArray,w.x,w.y,b.x,b.y,0,0,_),uc(this.layoutVertexArray,w.x,w.y,b.x,b.y,0,1,_),o.x+=2*w.x,o.y+=2*w.y,o.vertexCount+=2;let E=u.vertexLength;this.indexArray.emplaceBack(E,E+2,E+1),this.indexArray.emplaceBack(E+1,E+2,E+3),u.vertexLength+=4,u.primitiveLength+=2}}}}if(u.vertexLength+l>fr.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),Epe[e.type]!=="Polygon")continue;let c=[],p=[],d=u.vertexLength;for(let g of s)if(g.length!==0){g!==s[0]&&p.push(c.length/2);for(let _=0;_<g.length;_++){let y=g[_];uc(this.layoutVertexArray,y.x,y.y,0,0,1,1,0),o.x+=y.x,o.y+=y.y,o.vertexCount+=1,c.push(y.x),c.push(y.y)}}let m=(0,Mpe.default)(c,p);for(let g=0;g<m.length;g+=3)this.indexArray.emplaceBack(d+m[g],d+m[g+2],d+m[g+1]);u.primitiveLength+=m.length/3,u.vertexLength+=l}for(let s=0;s<o.vertexCount;s++)this.centroidVertexArray.emplaceBack(Math.floor(o.x/o.vertexCount),Math.floor(o.y/o.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,n)}};h(SU,"FillExtrusionBucket");var MU=SU;ut("FillExtrusionBucket",MU,{omit:["layers","features"]});function CU(i,e){return i.x===e.x&&(i.x<0||i.x>8192)||i.y===e.y&&(i.y<0||i.y>8192)}h(CU,"isBoundaryEdge");function EU(i){return i.every(e=>e.x<0)||i.every(e=>e.x>8192)||i.every(e=>e.y<0)||i.every(e=>e.y>8192)}h(EU,"isEntirelyOutside");R();var d6,Ppe=h(()=>d6=d6||new ia({"fill-extrusion-opacity":new yt(Le["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ct(Le["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new yt(Le["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new yt(Le["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new a_(Le["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ct(Le["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ct(Le["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new yt(Le["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),"getPaint"),Ape={get paint(){return Ppe()}},I3=kt(gi(),1),TU=class extends is{constructor(e){super(e,Ape)}createBucket(e){return new MU(e)}queryRadius(){return wg(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,r,n,a,o,s,l){let u=Sg(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(t,r),p=this.paint.get("fill-extrusion-base").evaluate(t,r),d=IU(u,l,o,0),m=AU(n,p,c,l),g=m[0],_=m[1];return PU(g,_,d)}};h(TU,"FillExtrusionStyleLayer");var Ipe=TU;function hc(i,e){return i.x*e.x+i.y*e.y}h(hc,"dot");function L3(i,e){if(i.length===1){let t=0,r=e[t++],n;for(;!n||r.equals(n);)if(n=e[t++],!n)return 1/0;for(;t<e.length;t++){let a=e[t],o=i[0],s=n.sub(r),l=a.sub(r),u=o.sub(r),c=hc(s,s),p=hc(s,l),d=hc(l,l),m=hc(u,s),g=hc(u,l),_=c*d-p*p,y=(d*m-p*g)/_,x=(c*g-p*m)/_,w=1-y-x,b=r.z*w+n.z*y+a.z*x;if(isFinite(b))return b}return 1/0}else{let t=1/0;for(let r of e)t=Math.min(t,r.z);return t}}h(L3,"getIntersectionDistance");function PU(i,e,t){let r=1/0;K4(t,e)&&(r=L3(t,e[0]));for(let n=0;n<e.length;n++){let a=e[n],o=i[n];for(let s=0;s<a.length-1;s++){let l=a[s],u=a[s+1],c=o[s],p=o[s+1],d=[l,u,p,c,l];J4(t,d)&&(r=Math.min(r,L3(t,d)))}}return r===1/0?!1:r}h(PU,"checkIntersection");function AU(i,e,t,r){let n=[],a=[],o=r[8]*e,s=r[9]*e,l=r[10]*e,u=r[11]*e,c=r[8]*t,p=r[9]*t,d=r[10]*t,m=r[11]*t;for(let g of i){let _=[],y=[];for(let x of g){let w=x.x,b=x.y,C=r[0]*w+r[4]*b+r[12],E=r[1]*w+r[5]*b+r[13],T=r[2]*w+r[6]*b+r[14],L=r[3]*w+r[7]*b+r[15],D=C+o,B=E+s,A=T+l,k=L+u,$=C+c,z=E+p,P=T+d,U=L+m,G=new I3.default(D/k,B/k);G.z=A/k,_.push(G);let K=new I3.default($/U,z/U);K.z=P/U,y.push(K)}n.push(_),a.push(y)}return[n,a]}h(AU,"projectExtrusion");function IU(i,e,t,r){let n=[];for(let a of i){let o=[a.x,a.y,r,1];Tn.transformMat4(o,o,e),n.push(new I3.default(o[0]/o[3],o[1]/o[3]))}return n}h(IU,"projectQueryGeometry");R();R();R();var Lpe=Yi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Dpe,size:UEe,alignment:VEe}=Lpe;R();var kpe=Yi([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Rpe,size:jEe,alignment:HEe}=kpe,Fpe=kt(Bx(),1),Ope=Fpe.default.VectorTileFeature.types,f6=63,Bpe=Math.cos(75/2*(Math.PI/180)),zpe=15,Npe=20,$pe=15,LU=1/2,m6=Math.pow(2,$pe-1)/LU,DU=class{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(t=>t.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(t=>{this.gradients[t.id]={}}),this.layoutVertexArray=new hce,this.layoutVertexArray2=new cce,this.indexArray=new Ch,this.programConfigurations=new ch(e.layers,e.zoom),this.segments=new fr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(t=>t.isStateDependent()).map(t=>t.id)}populate(e,t,r){this.hasPattern=p_("line",this.layers,t);let n=this.layers[0].layout.get("line-sort-key"),a=!n.isConstant(),o=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of e){let p=this.layers[0]._featureFilter.needGeometry,d=eu(s,p);if(!this.layers[0]._featureFilter.filter(new Dr(this.zoom),d,r))continue;let m=a?n.evaluate(d,{},r):void 0,g={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?d.geometry:Ql(s),patterns:{},sortKey:m};o.push(g)}a&&o.sort((s,l)=>s.sortKey-l.sortKey);for(let s of o){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let d=d_("line",this.layers,s,this.zoom,t);this.patternFeatures.push(d)}else this.addFeature(s,l,u,r,{});let p=e[u].feature;t.featureIndex.insert(p,l,u,c,this.index)}}update(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)}addFeatures(e,t,r){for(let n of this.patternFeatures)this.addFeature(n,n.geometry,n.index,t,r)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Rpe)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Dpe),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end")){let t=+e.properties.mapbox_clip_start,r=+e.properties.mapbox_clip_end;return{start:t,end:r}}}addFeature(e,t,r,n,a){let o=this.layers[0].layout,s=o.get("line-join").evaluate(e,{}),l=o.get("line-cap"),u=o.get("line-miter-limit"),c=o.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(let p of t)this.addLine(p,e,s,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,a,n)}addLine(e,t,r,n,a,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let x=0;x<e.length-1;x++)this.totalDistance+=e[x].dist(e[x+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let s=Ope[t.type]==="Polygon",l=e.length;for(;l>=2&&e[l-1].equals(e[l-2]);)l--;let u=0;for(;u<l-1&&e[u].equals(e[u+1]);)u++;if(l<(s?3:2))return;r==="bevel"&&(a=1.05);let c=this.overscaling<=16?zpe*8192/(512*this.overscaling):0,p=this.segments.prepareSegment(l*10,this.layoutVertexArray,this.indexArray),d,m,g,_,y;this.e1=this.e2=-1,s&&(d=e[l-2],y=e[u].sub(d)._unit()._perp());for(let x=u;x<l;x++){if(g=x===l-1?s?e[u+1]:void 0:e[x+1],g&&e[x].equals(g))continue;y&&(_=y),d&&(m=d),d=e[x],y=g?g.sub(d)._unit()._perp():_,_=_||y;let w=_.add(y);(w.x!==0||w.y!==0)&&w._unit();let b=_.x*y.x+_.y*y.y,C=w.x*y.x+w.y*y.y,E=C!==0?1/C:1/0,T=2*Math.sqrt(2-2*C),L=C<Bpe&&m&&g,D=_.x*y.y-_.y*y.x>0;if(L&&x>u){let k=d.dist(m);if(k>2*c){let $=d.sub(d.sub(m)._mult(c/k)._round());this.updateDistance(m,$),this.addCurrentVertex($,_,0,0,p),m=$}}let B=m&&g,A=B?r:s?"butt":n;if(B&&A==="round"&&(E<o?A="miter":E<=2&&(A="fakeround")),A==="miter"&&E>a&&(A="bevel"),A==="bevel"&&(E>2&&(A="flipbevel"),E<a&&(A="miter")),m&&this.updateDistance(m,d),A==="miter")w._mult(E),this.addCurrentVertex(d,w,0,0,p);else if(A==="flipbevel"){if(E>100)w=y.mult(-1);else{let k=E*_.add(y).mag()/_.sub(y).mag();w._perp()._mult(k*(D?-1:1))}this.addCurrentVertex(d,w,0,0,p),this.addCurrentVertex(d,w.mult(-1),0,0,p)}else if(A==="bevel"||A==="fakeround"){let k=-Math.sqrt(E*E-1),$=D?k:0,z=D?0:k;if(m&&this.addCurrentVertex(d,_,$,z,p),A==="fakeround"){let P=Math.round(T*180/Math.PI/Npe);for(let U=1;U<P;U++){let G=U/P;if(G!==.5){let O=G-.5,V=1.0904+b*(-3.2452+b*(3.55645-b*1.43519)),j=.848013+b*(-1.06021+b*.215638);G=G+G*O*(G-1)*(V*O*O+j)}let K=y.sub(_)._mult(G)._add(_)._unit()._mult(D?-1:1);this.addHalfVertex(d,K.x,K.y,!1,D,0,p)}}g&&this.addCurrentVertex(d,y,-$,-z,p)}else if(A==="butt")this.addCurrentVertex(d,w,0,0,p);else if(A==="square"){let k=m?1:-1;this.addCurrentVertex(d,w,k,k,p)}else A==="round"&&(m&&(this.addCurrentVertex(d,_,0,0,p),this.addCurrentVertex(d,_,1,1,p,!0)),g&&(this.addCurrentVertex(d,y,-1,-1,p,!0),this.addCurrentVertex(d,y,0,0,p)));if(L&&x<l-1){let k=d.dist(g);if(k>2*c){let $=d.add(g.sub(d)._mult(c/k)._round());this.updateDistance(d,$),this.addCurrentVertex($,y,0,0,p),d=$}}}}addCurrentVertex(e,t,r,n,a,o=!1){let s=t.x+t.y*r,l=t.y-t.x*r,u=-t.x+t.y*n,c=-t.y-t.x*n;this.addHalfVertex(e,s,l,o,!1,r,a),this.addHalfVertex(e,u,c,o,!0,-n,a),this.distance>m6/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,r,n,a,o))}addHalfVertex({x:e,y:t},r,n,a,o,s,l){let u=(this.lineClips?this.scaledDistance*(m6-1):this.scaledDistance)*LU;if(this.layoutVertexArray.emplaceBack((e<<1)+(a?1:0),(t<<1)+(o?1:0),Math.round(f6*r)+128,Math.round(f6*n)+128,(s===0?0:s<0?-1:1)+1|(u&63)<<2,u>>6),this.lineClips){let p=this.scaledDistance-this.lineClips.start,d=this.lineClips.end-this.lineClips.start,m=p/d;this.layoutVertexArray2.emplaceBack(m,this.lineClipsArray.length)}let c=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),l.primitiveLength++),o?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}};h(DU,"LineBucket");var kU=DU;ut("LineBucket",kU,{omit:["layers","patternFeatures"]});R();var g6,Upe=h(()=>g6=g6||new ia({"line-cap":new yt(Le.layout_line["line-cap"]),"line-join":new Ct(Le.layout_line["line-join"]),"line-miter-limit":new yt(Le.layout_line["line-miter-limit"]),"line-round-limit":new yt(Le.layout_line["line-round-limit"]),"line-sort-key":new Ct(Le.layout_line["line-sort-key"])}),"getLayout"),y6,Vpe=h(()=>y6=y6||new ia({"line-opacity":new Ct(Le.paint_line["line-opacity"]),"line-color":new Ct(Le.paint_line["line-color"]),"line-translate":new yt(Le.paint_line["line-translate"]),"line-translate-anchor":new yt(Le.paint_line["line-translate-anchor"]),"line-width":new Ct(Le.paint_line["line-width"]),"line-gap-width":new Ct(Le.paint_line["line-gap-width"]),"line-offset":new Ct(Le.paint_line["line-offset"]),"line-blur":new Ct(Le.paint_line["line-blur"]),"line-dasharray":new A4(Le.paint_line["line-dasharray"]),"line-pattern":new a_(Le.paint_line["line-pattern"]),"line-gradient":new I4(Le.paint_line["line-gradient"])}),"getPaint"),v6={get paint(){return Vpe()},get layout(){return Upe()}},RU=class extends Ct{possiblyEvaluate(e,t){return t=new Dr(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,n){return t=pt({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,n)}};h(RU,"LineFloorwidthProperty");var jpe=RU,l1,FU=class extends is{constructor(e){super(e,v6),this.gradientVersion=0,l1||(l1=new jpe(v6.paint.properties["line-width"].specification),l1.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){let t=this.gradientExpression();_d(t)?this.stepInterpolant=t._styleExpression.expression instanceof JE:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=l1.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new kU(e)}queryRadius(e){let t=e,r=D3(Cp("line-width",this,t),Cp("line-gap-width",this,t)),n=Cp("line-offset",this,t);return r/2+Math.abs(n)+wg(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,n,a,o,s){let l=Sg(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,s),u=s/2*D3(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),c=this.paint.get("line-offset").evaluate(t,r);return c&&(n=XB(n,c*s)),UB(l,n,u)}isTileClipped(){return!0}};h(FU,"LineStyleLayer");var Hpe=FU;function D3(i,e){return e>0?e+2*i:i}h(D3,"getLineWidth");R();R();R();var Gpe=Yi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Wpe=Yi([{name:"a_projected_pos",components:3,type:"Float32"}],4);Yi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);var Xpe=Yi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Yi([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);var x6=Yi([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),qpe=Yi([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Yi([{name:"triangle",components:3,type:"Uint16"}]);Yi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]);Yi([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]);Yi([{type:"Float32",name:"offsetX"}]);Yi([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);Yi([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var u1=kt(gi(),1);R();function OU(i,e,t){let r=e.layout.get("text-transform").evaluate(t,{});return r==="uppercase"?i=i.toLocaleUpperCase():r==="lowercase"&&(i=i.toLocaleLowerCase()),jm.applyArabicShaping&&(i=jm.applyArabicShaping(i)),i}h(OU,"transformTextInternal");function BU(i,e,t){return i.sections.forEach(r=>{r.text=OU(r.text,e,t)}),i}h(BU,"transformText");R();function zU(i){let e={},t={},r=[],n=0;function a(u){r.push(i[u]),n++}h(a,"add");function o(u,c,p){let d=t[u];return delete t[u],t[c]=d,r[d].geometry[0].pop(),r[d].geometry[0]=r[d].geometry[0].concat(p[0]),d}h(o,"mergeFromRight");function s(u,c,p){let d=e[c];return delete e[c],e[u]=d,r[d].geometry[0].shift(),r[d].geometry[0]=p[0].concat(r[d].geometry[0]),d}h(s,"mergeFromLeft");function l(u,c,p){let d=p?c[0][c[0].length-1]:c[0][0];return`${u}:${d.x}:${d.y}`}h(l,"getKey");for(let u=0;u<i.length;u++){let c=i[u],p=c.geometry,d=c.text?c.text.toString():null;if(!d){a(u);continue}let m=l(d,p),g=l(d,p,!0);if(m in t&&g in e&&t[m]!==e[g]){let _=s(m,g,p),y=o(m,g,r[_].geometry);delete e[m],delete t[g],t[l(d,r[y].geometry,!0)]=y,r[_].geometry=null}else m in t?o(m,g,p):g in e?s(m,g,p):(a(u),e[m]=n-1,t[g]=n-1)}return r.filter(u=>u.geometry)}h(zU,"mergeLines");R();R();var Zpe={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};R();var NU=24;R();var Ype=kt(dD(),1),_6=3;function $U(i,e,t){i===1&&t.readMessage(UU,e)}h($U,"readFontstacks");function UU(i,e,t){if(i===3){let{id:r,bitmap:n,width:a,height:o,left:s,top:l,advance:u}=t.readMessage(VU,{});e.push({id:r,bitmap:new z5({width:a+2*_6,height:o+2*_6},n),metrics:{width:a,height:o,left:s,top:l,advance:u}})}}h(UU,"readFontstack");function VU(i,e,t){i===1?e.id=t.readVarint():i===2?e.bitmap=t.readBytes():i===3?e.width=t.readVarint():i===4?e.height=t.readVarint():i===5?e.left=t.readSVarint():i===6?e.top=t.readSVarint():i===7&&(e.advance=t.readVarint())}h(VU,"readGlyph");function jU(i){return new Ype.default(i).readFields($U,[])}h(jU,"parseGlyphPbf");R();R();function V5(i){let e=0,t=0;for(let o of i)e+=o.w*o.h,t=Math.max(t,o.w);i.sort((o,s)=>s.h-o.h);let r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),t),h:1/0}],n=0,a=0;for(let o of i)for(let s=r.length-1;s>=0;s--){let l=r[s];if(!(o.w>l.w||o.h>l.h)){if(o.x=l.x,o.y=l.y,a=Math.max(a,o.y+o.h),n=Math.max(n,o.x+o.w),o.w===l.w&&o.h===l.h){let u=r.pop();s<r.length&&(r[s]=u)}else o.h===l.h?(l.x+=o.w,l.w-=o.w):o.w===l.w?(l.y+=o.h,l.h-=o.h):(r.push({x:l.x+o.w,y:l.y,w:l.w-o.w,h:o.h}),l.y+=o.h,l.h-=o.h);break}}return{w:n,h:a,fill:e/(n*a)||0}}h(V5,"potpack");var Oa=1,HU=class{constructor(e,{pixelRatio:t,version:r,stretchX:n,stretchY:a,content:o}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=n,this.stretchY=a,this.content=o,this.version=r}get tl(){return[this.paddedRect.x+Oa,this.paddedRect.y+Oa]}get br(){return[this.paddedRect.x+this.paddedRect.w-Oa,this.paddedRect.y+this.paddedRect.h-Oa]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-Oa*2)/this.pixelRatio,(this.paddedRect.h-Oa*2)/this.pixelRatio]}};h(HU,"ImagePosition");var j5=HU,GU=class{constructor(e,t){let r={},n={};this.haveRenderCallbacks=[];let a=[];this.addImages(e,r,a),this.addImages(t,n,a);let{w:o,h:s}=V5(a),l=new rr({width:o||1,height:s||1});for(let u in e){let c=e[u],p=r[u].paddedRect;rr.copy(c.data,l,{x:0,y:0},{x:p.x+Oa,y:p.y+Oa},c.data)}for(let u in t){let c=t[u],p=n[u].paddedRect,d=p.x+Oa,m=p.y+Oa,g=c.data.width,_=c.data.height;rr.copy(c.data,l,{x:0,y:0},{x:d,y:m},c.data),rr.copy(c.data,l,{x:0,y:_-1},{x:d,y:m-1},{width:g,height:1}),rr.copy(c.data,l,{x:0,y:0},{x:d,y:m+_},{width:g,height:1}),rr.copy(c.data,l,{x:g-1,y:0},{x:d-1,y:m},{width:1,height:_}),rr.copy(c.data,l,{x:0,y:0},{x:d+g,y:m},{width:1,height:_})}this.image=l,this.iconPositions=r,this.patternPositions=n}addImages(e,t,r){for(let n in e){let a=e[n],o={x:0,y:0,w:a.data.width+2*Oa,h:a.data.height+2*Oa};r.push(o),t[n]=new j5(o,a),a.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t||e.version===t.version)return;e.version=t.version;let[n,a]=e.tl;r.update(t.data,void 0,{x:n,y:a})}};h(GU,"ImageAtlas");var Jpe=GU;ut("ImagePosition",j5);ut("ImageAtlas",Jpe);var WU=(i=>(i[i.none=0]="none",i[i.horizontal=1]="horizontal",i[i.vertical=2]="vertical",i[i.horizontalOnly=3]="horizontalOnly",i))(WU||{});function H5(i){let e=.5,t=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0;break}switch(i){case"bottom":case"bottom-right":case"bottom-left":t=1;break;case"top":case"top-right":case"top-left":t=0;break}return{horizontalAlign:e,verticalAlign:t}}h(H5,"getAnchorAlignment");var Kpe=kt(Bx(),1);R();var Qpe=255,Fy=128,b6=Qpe*Fy;function k3(i,e){let{expression:t}=e;if(t.kind==="constant")return{kind:"constant",layoutSize:t.evaluate(new Dr(i+1))};if(t.kind==="source")return{kind:"source"};{let{zoomStops:r,interpolationType:n}=t,a=0;for(;a<r.length&&r[a]<=i;)a++;a=Math.max(0,a-1);let o=a;for(;o<r.length&&r[o]<i+1;)o++;o=Math.min(r.length-1,o);let s=r[a],l=r[o];if(t.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:l,interpolationType:n};let u=t.evaluate(new Dr(s)),c=t.evaluate(new Dr(l));return{kind:"camera",minZoom:s,maxZoom:l,minSize:u,maxSize:c,interpolationType:n}}}h(k3,"getSizeData");function f_(i,{uSize:e,uSizeT:t},{lowerSize:r,upperSize:n}){return i.kind==="source"?r/Fy:i.kind==="composite"?Wi.number(r/Fy,n/Fy,t):e}h(f_,"evaluateSizeForFeature");function Mg(i,e){let t=0,r=0;if(i.kind==="constant")r=i.layoutSize;else if(i.kind!=="source"){let{interpolationType:n,minZoom:a,maxZoom:o}=i,s=n?Lr(Yo.interpolationFactor(n,e,a,o),0,1):0;i.kind==="camera"?r=Wi.number(i.minSize,i.maxSize,s):t=s}return{uSizeT:t,uSize:r}}h(Mg,"evaluateSizeForZoom");R();function Gm(i,e,t){let r="never",n=i.get(e);return n?r=n:i.get(t)&&(r="always"),r}h(Gm,"getOverlapMode");var ede=Kpe.default.VectorTileFeature.types,tde=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vf(i,e,t,r,n,a,o,s,l,u,c,p,d){let m=s?Math.min(b6,Math.round(s[0])):0,g=s?Math.min(b6,Math.round(s[1])):0;i.emplaceBack(e,t,Math.round(r*32),Math.round(n*32),a,o,(m<<1)+(l?1:0),g,u*16,c*16,p*256,d*256)}h(vf,"addVertex");function Yp(i,e,t){i.emplaceBack(e.x,e.y,t),i.emplaceBack(e.x,e.y,t),i.emplaceBack(e.x,e.y,t),i.emplaceBack(e.x,e.y,t)}h(Yp,"addDynamicAttributes");function XU(i){for(let e of i.sections)if(FF(e.text))return!0;return!1}h(XU,"containsRTLText");var qU=class{constructor(e){this.layoutVertexArray=new pce,this.indexArray=new Ch,this.programConfigurations=e,this.segments=new fr,this.dynamicLayoutVertexArray=new dce,this.opacityVertexArray=new fce,this.hasVisibleVertices=!1,this.placedSymbolArray=new RO}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Gpe.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Wpe.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,tde,!0),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};h(qU,"SymbolBuffers");var R3=qU;ut("SymbolBuffers",R3);var ZU=class{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new fr,this.collisionVertexArray=new gce}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Xpe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};h(ZU,"CollisionBuffers");var F3=ZU;ut("CollisionBuffers",F3);var YU=class{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ht.identity([]),this.placementViewportMatrix=ht.identity([]);let t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=k3(this.zoom,t["text-size"]),this.iconSizeData=k3(this.zoom,t["icon-size"]);let r=this.layers[0].layout,n=r.get("symbol-sort-key"),a=r.get("symbol-z-order");this.canOverlap=Gm(r,"text-overlap","text-allow-overlap")!=="never"||Gm(r,"icon-overlap","icon-allow-overlap")!=="never"||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!n.isConstant();let o=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=o&&this.canOverlap,r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map(s=>WU[s])),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.sourceID=e.sourceID}createArrays(){this.text=new R3(new ch(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new R3(new ch(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new $O,this.lineVertexArray=new VO,this.symbolInstances=new zO,this.textAnchorOffsets=new WO}calculateGlyphDependencies(e,t,r,n,a){for(let o=0;o<e.length;o++)if(t[e.charCodeAt(o)]=!0,(r||n)&&a){let s=Zpe[e.charAt(o)];s&&(t[s.charCodeAt(0)]=!0)}}populate(e,t,r){let n=this.layers[0],a=n.layout,o=a.get("text-font"),s=a.get("text-field"),l=a.get("icon-image"),u=(s.value.kind!=="constant"||s.value.value instanceof Ns&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(o.value.kind!=="constant"||o.value.value.length>0),c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0,p=a.get("symbol-sort-key");if(this.features=[],!u&&!c)return;let d=t.iconDependencies,m=t.glyphDependencies,g=t.availableImages,_=new Dr(this.zoom);for(let{feature:y,id:x,index:w,sourceLayerIndex:b}of e){let C=n._featureFilter.needGeometry,E=eu(y,C);if(!n._featureFilter.filter(_,E,r))continue;C||(E.geometry=Ql(y));let T;if(u){let A=n.getValueAndResolveTokens("text-field",E,r,g),k=Ns.factory(A),$=this.hasRTLText=this.hasRTLText||XU(k);(!$||jm.getRTLTextPluginStatus()==="unavailable"||$&&jm.isParsed())&&(T=BU(k,n,E))}let L;if(c){let A=n.getValueAndResolveTokens("icon-image",E,r,g);A instanceof es?L=A:L=es.fromString(A)}if(!T&&!L)continue;let D=this.sortFeaturesByKey?p.evaluate(E,{},r):void 0,B={id:x,text:T,icon:L,index:w,sourceLayerIndex:b,geometry:E.geometry,properties:y.properties,type:ede[y.type],sortKey:D};if(this.features.push(B),L&&(d[L.name]=!0),T){let A=o.evaluate(E,{},r).join(","),k=a.get("text-rotation-alignment")!=="viewport"&&a.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let $ of T.sections)if($.image)d[$.image.name]=!0;else{let z=DF(T.toString()),P=$.fontStack||A,U=m[P]=m[P]||{};this.calculateGlyphDependencies($.text,U,k,this.allowVerticalPlacement,z)}}}a.get("symbol-placement")==="line"&&(this.features=zU(this.features)),this.sortFeaturesByKey&&this.features.sort((y,x)=>y.sortKey-x.sortKey)}update(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){let r=this.lineVertexArray.length;if(e.segment!==void 0){let n=e.dist(t[e.segment+1]),a=e.dist(t[e.segment]),o={};for(let s=e.segment+1;s<t.length;s++)o[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:n},s<t.length-1&&(n+=t[s+1].dist(t[s]));for(let s=e.segment||0;s>=0;s--)o[s]={x:t[s].x,y:t[s].y,tileUnitDistanceFromAnchor:a},s>0&&(a+=t[s-1].dist(t[s]));for(let s=0;s<t.length;s++){let l=o[s];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(e,t,r,n,a,o,s,l,u,c,p,d){let m=e.indexArray,g=e.layoutVertexArray,_=e.segments.prepareSegment(4*t.length,g,m,this.canOverlap?o.sortKey:void 0),y=this.glyphOffsetArray.length,x=_.vertexLength,w=this.allowVerticalPlacement&&s===2?Math.PI/2:0,b=o.text&&o.text.sections;for(let C=0;C<t.length;C++){let{tl:E,tr:T,bl:L,br:D,tex:B,pixelOffsetTL:A,pixelOffsetBR:k,minFontScaleX:$,minFontScaleY:z,glyphOffset:P,isSDF:U,sectionIndex:G}=t[C],K=_.vertexLength,O=P[1];vf(g,l.x,l.y,E.x,O+E.y,B.x,B.y,r,U,A.x,A.y,$,z),vf(g,l.x,l.y,T.x,O+T.y,B.x+B.w,B.y,r,U,k.x,A.y,$,z),vf(g,l.x,l.y,L.x,O+L.y,B.x,B.y+B.h,r,U,A.x,k.y,$,z),vf(g,l.x,l.y,D.x,O+D.y,B.x+B.w,B.y+B.h,r,U,k.x,k.y,$,z),Yp(e.dynamicLayoutVertexArray,l,w),m.emplaceBack(K,K+1,K+2),m.emplaceBack(K+1,K+2,K+3),_.vertexLength+=4,_.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(P[0]),(C===t.length-1||G!==t[C+1].sectionIndex)&&e.programConfigurations.populatePaintArrays(g.length,o,o.index,{},d,b&&b[G])}e.placedSymbolArray.emplaceBack(l.x,l.y,y,this.glyphOffsetArray.length-y,x,u,c,l.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],s,0,!1,0,p)}_addCollisionDebugVertex(e,t,r,n,a,o){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,n,a,Math.round(o.x),Math.round(o.y))}addCollisionDebugVertices(e,t,r,n,a,o,s){let l=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),u=l.vertexLength,c=a.layoutVertexArray,p=a.collisionVertexArray,d=s.anchorX,m=s.anchorY;this._addCollisionDebugVertex(c,p,o,d,m,new u1.default(e,t)),this._addCollisionDebugVertex(c,p,o,d,m,new u1.default(r,t)),this._addCollisionDebugVertex(c,p,o,d,m,new u1.default(r,n)),this._addCollisionDebugVertex(c,p,o,d,m,new u1.default(e,n)),l.vertexLength+=4;let g=a.indexArray;g.emplaceBack(u,u+1),g.emplaceBack(u+1,u+2),g.emplaceBack(u+2,u+3),g.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(e,t,r,n){for(let a=e;a<t;a++){let o=this.collisionBoxArray.get(a),s=o.x1,l=o.y1,u=o.x2,c=o.y2;this.addCollisionDebugVertices(s,l,u,c,n?this.textCollisionBox:this.iconCollisionBox,o.anchorPoint,r)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new F3(a6,x6.members,b3),this.iconCollisionBox=new F3(a6,x6.members,b3);for(let e=0;e<this.symbolInstances.length;e++){let t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,r,n,a,o,s,l,u){let c={};for(let p=t;p<r;p++){let d=e.get(p);c.textBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.textFeatureIndex=d.featureIndex;break}for(let p=n;p<a;p++){let d=e.get(p);c.verticalTextBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.verticalTextFeatureIndex=d.featureIndex;break}for(let p=o;p<s;p++){let d=e.get(p);c.iconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.iconFeatureIndex=d.featureIndex;break}for(let p=l;p<u;p++){let d=e.get(p);c.verticalIconBox={x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2,anchorPointX:d.anchorPointX,anchorPointY:d.anchorPointY},c.verticalIconFeatureIndex=d.featureIndex;break}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){let r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){let r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+r.numGlyphs*4;for(let a=r.vertexStartIndex;a<n;a+=4)e.indexArray.emplaceBack(a,a+1,a+2),e.indexArray.emplaceBack(a+1,a+2,a+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let t=Math.sin(e),r=Math.cos(e),n=[],a=[],o=[];for(let s=0;s<this.symbolInstances.length;++s){o.push(s);let l=this.symbolInstances.get(s);n.push(Math.round(t*l.anchorX+r*l.anchorY)|0),a.push(l.featureIndex)}return o.sort((s,l)=>n[s]-n[l]||a[l]-a[s]),o}addToSortKeyRanges(e,t){let r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let t of this.symbolInstanceIndexes){let r=this.symbolInstances.get(t);this.featureSortOrder.push(r.featureIndex),[r.rightJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.leftJustifiedTextSymbolIndex].forEach((n,a,o)=>{n>=0&&o.indexOf(n)===a&&this.addIndicesForPlacedSymbol(this.text,n)}),r.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,r.verticalPlacedTextSymbolIndex),r.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.placedIconSymbolIndex),r.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,r.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};h(YU,"SymbolBucket");var Jp=YU;ut("SymbolBucket",Jp,{omit:["layers","collisionBoxArray","features","compareText"]});Jp.MAX_GLYPHS=65535;Jp.addDynamicAttributes=Yp;R();function JU(i,e){return e.replace(/{([^{}]+)}/g,(t,r)=>i&&r in i?String(i[r]):"")}h(JU,"resolveTokens");R();var w6,ide=h(()=>w6=w6||new ia({"symbol-placement":new yt(Le.layout_symbol["symbol-placement"]),"symbol-spacing":new yt(Le.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new yt(Le.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ct(Le.layout_symbol["symbol-sort-key"]),"symbol-z-order":new yt(Le.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new yt(Le.layout_symbol["icon-allow-overlap"]),"icon-overlap":new yt(Le.layout_symbol["icon-overlap"]),"icon-ignore-placement":new yt(Le.layout_symbol["icon-ignore-placement"]),"icon-optional":new yt(Le.layout_symbol["icon-optional"]),"icon-rotation-alignment":new yt(Le.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ct(Le.layout_symbol["icon-size"]),"icon-text-fit":new yt(Le.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new yt(Le.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ct(Le.layout_symbol["icon-image"]),"icon-rotate":new Ct(Le.layout_symbol["icon-rotate"]),"icon-padding":new Ct(Le.layout_symbol["icon-padding"]),"icon-keep-upright":new yt(Le.layout_symbol["icon-keep-upright"]),"icon-offset":new Ct(Le.layout_symbol["icon-offset"]),"icon-anchor":new Ct(Le.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new yt(Le.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new yt(Le.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new yt(Le.layout_symbol["text-rotation-alignment"]),"text-field":new Ct(Le.layout_symbol["text-field"]),"text-font":new Ct(Le.layout_symbol["text-font"]),"text-size":new Ct(Le.layout_symbol["text-size"]),"text-max-width":new Ct(Le.layout_symbol["text-max-width"]),"text-line-height":new yt(Le.layout_symbol["text-line-height"]),"text-letter-spacing":new Ct(Le.layout_symbol["text-letter-spacing"]),"text-justify":new Ct(Le.layout_symbol["text-justify"]),"text-radial-offset":new Ct(Le.layout_symbol["text-radial-offset"]),"text-variable-anchor":new yt(Le.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Ct(Le.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Ct(Le.layout_symbol["text-anchor"]),"text-max-angle":new yt(Le.layout_symbol["text-max-angle"]),"text-writing-mode":new yt(Le.layout_symbol["text-writing-mode"]),"text-rotate":new Ct(Le.layout_symbol["text-rotate"]),"text-padding":new yt(Le.layout_symbol["text-padding"]),"text-keep-upright":new yt(Le.layout_symbol["text-keep-upright"]),"text-transform":new Ct(Le.layout_symbol["text-transform"]),"text-offset":new Ct(Le.layout_symbol["text-offset"]),"text-allow-overlap":new yt(Le.layout_symbol["text-allow-overlap"]),"text-overlap":new yt(Le.layout_symbol["text-overlap"]),"text-ignore-placement":new yt(Le.layout_symbol["text-ignore-placement"]),"text-optional":new yt(Le.layout_symbol["text-optional"])}),"getLayout"),S6,rde=h(()=>S6=S6||new ia({"icon-opacity":new Ct(Le.paint_symbol["icon-opacity"]),"icon-color":new Ct(Le.paint_symbol["icon-color"]),"icon-halo-color":new Ct(Le.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ct(Le.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ct(Le.paint_symbol["icon-halo-blur"]),"icon-translate":new yt(Le.paint_symbol["icon-translate"]),"icon-translate-anchor":new yt(Le.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ct(Le.paint_symbol["text-opacity"]),"text-color":new Ct(Le.paint_symbol["text-color"],{runtimeType:So,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new Ct(Le.paint_symbol["text-halo-color"]),"text-halo-width":new Ct(Le.paint_symbol["text-halo-width"]),"text-halo-blur":new Ct(Le.paint_symbol["text-halo-blur"]),"text-translate":new yt(Le.paint_symbol["text-translate"]),"text-translate-anchor":new yt(Le.paint_symbol["text-translate-anchor"])}),"getPaint"),L2={get paint(){return rde()},get layout(){return ide()}};R();var KU=class{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:pg,this.defaultValue=e}evaluate(e){if(e.formattedSection){let t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){if(!this.defaultValue.isConstant()){let t=this.defaultValue.value;e(t._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};h(KU,"FormatSectionOverride");var QU=KU;ut("FormatSectionOverride",QU,{omit:["defaultValue"]});var eV=class O3 extends is{constructor(e){super(e,L2)}recalculate(e,t){if(super.recalculate(e,t),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let r=this.layout.get("text-writing-mode");if(r){let n=[];for(let a of r)n.indexOf(a)<0&&n.push(a);this.layout._values["text-writing-mode"]=n}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,n){let a=this.layout.get(e).evaluate(t,{},r,n),o=this._unevaluatedLayout._values[e];return!o.isDataDriven()&&!_d(o.value)&&a?JU(t.properties,a):a}createBucket(e){return new Jp(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let e of L2.paint.overridableProperties){if(!O3.hasPaintOverride(this.layout,e))continue;let t=this.paint.get(e),r=new QU(t),n=new h4(r,t.property.specification),a=null;t.value.kind==="constant"||t.value.kind==="source"?a=new Dv("source",n):a=new kv("composite",n,t.value.zoomStops),this.paint._values[e]=new xo(t.property,a,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!this.layout||t.isDataDriven()||r.isDataDriven()?!1:O3.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){let r=e.get("text-field"),n=L2.paint.properties[t],a=!1,o=h(s=>{for(let l of s)if(n.overrides&&n.overrides.hasOverride(l)){a=!0;return}},"checkSections");if(r.value.kind==="constant"&&r.value.value instanceof Ns)o(r.value.value.sections);else if(r.value.kind==="source"){let s=h(u=>{if(!a)if(u instanceof Om&&wr(u.value)===dg){let c=u.value;o(c.sections)}else u instanceof mR?o(u.sections):u.eachChild(s)},"checkExpression"),l=r.value;l._styleExpression&&s(l._styleExpression.expression)}return a}};h(eV,"SymbolStyleLayer");var nde=eV;R();R();var M6,ade=h(()=>M6=M6||new ia({"background-color":new yt(Le.paint_background["background-color"]),"background-pattern":new A4(Le.paint_background["background-pattern"]),"background-opacity":new yt(Le.paint_background["background-opacity"])}),"getPaint"),ode={get paint(){return ade()}},tV=class extends is{constructor(e){super(e,ode)}};h(tV,"BackgroundStyleLayer");var sde=tV;R();R();var C6,lde=h(()=>C6=C6||new ia({"raster-opacity":new yt(Le.paint_raster["raster-opacity"]),"raster-hue-rotate":new yt(Le.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new yt(Le.paint_raster["raster-brightness-min"]),"raster-brightness-max":new yt(Le.paint_raster["raster-brightness-max"]),"raster-saturation":new yt(Le.paint_raster["raster-saturation"]),"raster-contrast":new yt(Le.paint_raster["raster-contrast"]),"raster-resampling":new yt(Le.paint_raster["raster-resampling"]),"raster-fade-duration":new yt(Le.paint_raster["raster-fade-duration"])}),"getPaint"),ude={get paint(){return lde()}},iV=class extends is{constructor(e){super(e,ude)}};h(iV,"RasterStyleLayer");var hde=iV;R();function rV(i){let e=[],t=i.id;return t===void 0&&e.push({message:`layers.${t}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${t}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${t}: property "renderingMode" must be either "2d" or "3d"`}),e}h(rV,"validateCustomStyleLayer");var nV=class extends is{constructor(e){super(e,{}),this.onAdd=t=>{this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)},this.onRemove=t=>{this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};h(nV,"CustomStyleLayer");var cde=nV;function Oy(i){if(i.type==="custom")return new cde(i);switch(i.type){case"background":return new sde(i);case"circle":return new ope(i);case"fill":return new _pe(i);case"fill-extrusion":return new Ipe(i);case"heatmap":return new upe(i);case"hillshade":return new ppe(i);case"line":return new Hpe(i);case"raster":return new hde(i);case"symbol":return new nde(i)}}h(Oy,"createStyleLayer");R();R();function pm(i){let e=[];if(typeof i=="string")e.push({id:"default",url:i});else if(i&&i.length>0){let t=[];for(let{id:r,url:n}of i){let a=`${r}${n}`;t.indexOf(a)===-1&&(t.push(a),e.push({id:r,url:n}))}}return e}h(pm,"coerceSpriteToArray");async function aV(i,e,t,r){let n=pm(i),a=t>1?"@2x":"",o={},s={};for(let{id:l,url:u}of n){let c=e.transformRequest(e.normalizeSpriteURL(u,a,".json"),"SpriteJSON");o[l]=Ux(c,r);let p=e.transformRequest(e.normalizeSpriteURL(u,a,".png"),"SpriteImage");s[l]=Zo.getImage(p,r)}return await Promise.all([...Object.values(o),...Object.values(s)]),oV(o,s)}h(aV,"loadSprite");async function oV(i,e){let t={};for(let r in i){t[r]={};let n=li.getImageCanvasContext((await e[r]).data),a=(await i[r]).data;for(let o in a){let{width:s,height:l,x:u,y:c,sdf:p,pixelRatio:d,stretchX:m,stretchY:g,content:_}=a[o],y={width:s,height:l,x:u,y:c,context:n};t[r][o]={data:null,pixelRatio:d,sdf:p,stretchX:m,stretchY:g,content:_,spriteData:y}}}return t}h(oV,"doOnceCompleted");R();R();var sV=class{constructor(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)}update(e,t,r){let{width:n,height:a}=e,o=(!this.size||this.size[0]!==n||this.size[1]!==a)&&!r,{context:s}=this,{gl:l}=s;if(this.useMipmap=!!(t&&t.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!t||t.premultiply!==!1)),o)this.size=[n,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||qo(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,n,a,0,this.format,l.UNSIGNED_BYTE,e.data);else{let{x:u,y:c}=r||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||qo(e)?l.texSubImage2D(l.TEXTURE_2D,0,u,c,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,u,c,n,a,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(e,t,r){let{context:n}=this,{gl:a}=n;a.bindTexture(a.TEXTURE_2D,this.texture),r===a.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(r=a.LINEAR),e!==this.filter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,t),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}};h(sV,"Texture");var zr=sV;R();function lV(i){let{userImage:e}=i;return e&&e.render&&e.render()?(i.data.replace(new Uint8Array(e.data.buffer)),!0):!1}h(lV,"renderStyleImage");var h1=1,uV=class extends mn{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new rr({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:t,promiseResolve:r}of this.requestors)r(this._getImagesForIds(t));this.requestors=[]}}getImage(e){let t=this.images[e];if(t&&!t.data&&t.spriteData){let r=t.spriteData;t.data=new rr({width:r.width,height:r.height},r.context.getImageData(r.x,r.y,r.width,r.height).data),t.spriteData=null}return t}addImage(e,t){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,t)&&(this.images[e]=t)}_validate(e,t){let r=!0,n=t.data||t.spriteData;return this._validateStretch(t.stretchX,n&&n.width)||(this.fire(new Et(new Error(`Image "${e}" has invalid "stretchX" value`))),r=!1),this._validateStretch(t.stretchY,n&&n.height)||(this.fire(new Et(new Error(`Image "${e}" has invalid "stretchY" value`))),r=!1),this._validateContent(t.content,t)||(this.fire(new Et(new Error(`Image "${e}" has invalid "content" value`))),r=!1),r}_validateStretch(e,t){if(!e)return!0;let r=0;for(let n of e){if(n[0]<r||n[1]<n[0]||t<n[1])return!1;r=n[1]}return!0}_validateContent(e,t){if(!e)return!0;if(e.length!==4)return!1;let r=t.spriteData,n=r&&r.width||t.data.width,a=r&&r.height||t.data.height;return!(e[0]<0||n<e[0]||e[1]<0||a<e[1]||e[2]<0||n<e[2]||e[3]<0||a<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t,r=!0){let n=this.getImage(e);if(r&&(n.data.width!==t.data.width||n.data.height!==t.data.height))throw new Error(`size mismatch between old image (${n.data.width}x${n.data.height}) and new image (${t.data.width}x${t.data.height}).`);t.version=n.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){let t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((t,r)=>{let n=!0;if(!this.isLoaded())for(let a of e)this.images[a]||(n=!1);this.isLoaded()||n?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})})}_getImagesForIds(e){let t={};for(let r of e){let n=this.getImage(r);n||(this.fire(new Ye("styleimagemissing",{id:r})),n=this.getImage(r)),n?t[r]={data:n.data.clone(),pixelRatio:n.pixelRatio,sdf:n.sdf,version:n.version,stretchX:n.stretchX,stretchY:n.stretchY,content:n.content,hasRenderCallback:!!(n.userImage&&n.userImage.render)}:dn(`Image "${r}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return t}getPixelSize(){let{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){let t=this.patterns[e],r=this.getImage(e);if(!r)return null;if(t&&t.position.version===r.version)return t.position;if(t)t.position.version=r.version;else{let n=r.data.width+h1*2,a=r.data.height+h1*2,o={w:n,h:a,x:0,y:0},s=new j5(o,r);this.patterns[e]={bin:o,position:s}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new zr(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let a in this.patterns)e.push(this.patterns[a].bin);let{w:t,h:r}=V5(e),n=this.atlasImage;n.resize({width:t||1,height:r||1});for(let a in this.patterns){let{bin:o}=this.patterns[a],s=o.x+h1,l=o.y+h1,u=this.getImage(a).data,c=u.width,p=u.height;rr.copy(u,n,{x:0,y:0},{x:s,y:l},{width:c,height:p}),rr.copy(u,n,{x:0,y:p-1},{x:s,y:l-1},{width:c,height:1}),rr.copy(u,n,{x:0,y:0},{x:s,y:l+p},{width:c,height:1}),rr.copy(u,n,{x:c-1,y:0},{x:s-1,y:l},{width:1,height:p}),rr.copy(u,n,{x:0,y:0},{x:s+c,y:l},{width:1,height:p})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let t of e){if(this.callbackDispatchedThisFrame[t])continue;this.callbackDispatchedThisFrame[t]=!0;let r=this.getImage(t);r||dn(`Image with ID: "${t}" was not found`),lV(r)&&this.updateImage(t,r)}}};h(uV,"ImageManager");var pde=uV;R();R();async function hV(i,e,t,r){let n=e*256,a=n+255,o=r.transformRequest(t.replace("{fontstack}",i).replace("{range}",`${n}-${a}`),"Glyphs"),s=await Due(o,new AbortController);if(!s||!s.data)throw new Error(`Could not load glyph range. range: ${e}, ${n}-${a}`);let l={};for(let u of jU(s.data))l[u.id]=u;return l}h(hV,"loadGlyphRange");R();var cV=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:n=.25,fontFamily:a="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=t,this.cutoff=n,this.radius=r;let l=this.size=e+t*4,u=this._createCanvas(l),c=this.ctx=u.getContext("2d",{willReadFrequently:!0});c.font=`${s} ${o} ${e}px ${a}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(l*l),this.gridInner=new Float64Array(l*l),this.f=new Float64Array(l),this.z=new Float64Array(l+1),this.v=new Uint16Array(l)}_createCanvas(e){let t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){let{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:a,actualBoundingBoxRight:o}=this.ctx.measureText(e),s=Math.ceil(r),l=0,u=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-a))),c=Math.min(this.size-this.buffer,s+Math.ceil(n)),p=u+2*this.buffer,d=c+2*this.buffer,m=Math.max(p*d,0),g=new Uint8ClampedArray(m),_={data:g,width:p,height:d,glyphWidth:u,glyphHeight:c,glyphTop:s,glyphLeft:l,glyphAdvance:t};if(u===0||c===0)return _;let{ctx:y,buffer:x,gridInner:w,gridOuter:b}=this;y.clearRect(x,x,u,c),y.fillText(e,x,x+s);let C=y.getImageData(x,x,u,c);b.fill(1e20,0,m),w.fill(0,0,m);for(let E=0;E<c;E++)for(let T=0;T<u;T++){let L=C.data[4*(E*u+T)+3]/255;if(L===0)continue;let D=(E+x)*p+T+x;if(L===1)b[D]=0,w[D]=1e20;else{let B=.5-L;b[D]=B>0?B*B:0,w[D]=B<0?B*B:0}}B3(b,0,0,p,d,p,this.f,this.v,this.z),B3(w,x,x,u,c,p,this.f,this.v,this.z);for(let E=0;E<m;E++){let T=Math.sqrt(b[E])-Math.sqrt(w[E]);g[E]=Math.round(255-255*(T/this.radius+this.cutoff))}return _}};h(cV,"TinySDF");var dde=cV;function B3(i,e,t,r,n,a,o,s,l){for(let u=e;u<e+r;u++)z3(i,t*a+u,a,n,o,s,l);for(let u=t;u<t+n;u++)z3(i,u*a+e,1,r,o,s,l)}h(B3,"edt");function z3(i,e,t,r,n,a,o){a[0]=0,o[0]=-1e20,o[1]=1e20,n[0]=i[e];for(let s=1,l=0,u=0;s<r;s++){n[s]=i[e+s*t];let c=s*s;do{let p=a[l];u=(n[s]-n[p]+c-p*p)/(s-p)/2}while(u<=o[l]&&--l>-1);l++,a[l]=s,o[l]=u,o[l+1]=1e20}for(let s=0,l=0;s<r;s++){for(;o[l+1]<s;)l++;let u=a[l],c=s-u;i[e+s*t]=n[u]+c*c}}h(z3,"edt1d");var By=class N3{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}async getGlyphs(e){let t=[];for(let a in e)for(let o of e[a])t.push(this._getAndCacheGlyphsPromise(a,o));let r=await Promise.all(t),n={};for(let{stack:a,id:o,glyph:s}of r)n[a]||(n[a]={}),n[a][o]=s&&{id:s.id,bitmap:s.bitmap.clone(),metrics:s.metrics};return n}async _getAndCacheGlyphsPromise(e,t){let r=this.entries[e];r||(r=this.entries[e]={glyphs:{},requests:{},ranges:{}});let n=r.glyphs[t];if(n!==void 0)return{stack:e,id:t,glyph:n};if(n=this._tinySDF(r,e,t),n)return r.glyphs[t]=n,{stack:e,id:t,glyph:n};let a=Math.floor(t/256);if(a*256>65535)throw new Error("glyphs > 65535 not supported");if(r.ranges[a])return{stack:e,id:t,glyph:n};if(!this.url)throw new Error("glyphsUrl is not set");if(!r.requests[a]){let s=N3.loadGlyphRange(e,a,this.url,this.requestManager);r.requests[a]=s}let o=await r.requests[a];for(let s in o)this._doesCharSupportLocalGlyph(+s)||(r.glyphs[+s]=o[+s]);return r.ranges[a]=!0,{stack:e,id:t,glyph:o[t]||null}}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&(ai["CJK Unified Ideographs"](e)||ai["Hangul Syllables"](e)||ai.Hiragana(e)||ai.Katakana(e))}_tinySDF(e,t,r){let n=this.localIdeographFontFamily;if(!n||!this._doesCharSupportLocalGlyph(r))return;let a=2,o=e.tinySDF;if(!o){let l="400";/bold/i.test(t)?l="900":/medium/i.test(t)?l="500":/light/i.test(t)&&(l="200"),o=e.tinySDF=new N3.TinySDF({fontSize:24*a,buffer:3*a,radius:8*a,cutoff:.25,fontFamily:n,fontWeight:l})}let s=o.draw(String.fromCharCode(r));return{id:r,bitmap:new z5({width:s.width||30*a,height:s.height||30*a},s.data),metrics:{width:s.glyphWidth/a||24,height:s.glyphHeight/a||24,left:s.glyphLeft/a+.5||0,top:s.glyphTop/a-27.5||-8,advance:s.glyphAdvance/a||24,isDoubleResolution:!0}}}};h(By,"GlyphManager"),By.loadGlyphRange=hV,By.TinySDF=dde;var fde=By;R();var pV=class{constructor(){this.specification=Le.light.position}possiblyEvaluate(e,t){return SD(e.expression.evaluate(t))}interpolate(e,t,r){return{x:Wi.number(e.x,t.x,r),y:Wi.number(e.y,t.y,r),z:Wi.number(e.z,t.z,r)}}};h(pV,"LightPositionProperty");var mde=pV,E6="-transition",D2,dV=class extends mn{constructor(e){super(),D2=D2||new ia({anchor:new yt(Le.light.anchor),position:new mde,color:new yt(Le.light.color),intensity:new yt(Le.light.intensity)}),this._transitionable=new VF(D2),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,t={}){if(!this._validate(Jhe,e,t))for(let r in e){let n=e[r];r.endsWith(E6)?this._transitionable.setTransition(r.slice(0,-E6.length),n):this._transitionable.setValue(r,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,t,r){return r&&r.validate===!1?!1:i_(this,e.call(Or,{value:t,style:{glyphs:!0,sprite:!0},styleSpec:Le}))}};h(dV,"Light");var gde=dV;R();var fV=class{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){let r=e.join(",")+String(t);return this.dashEntry[r]||(this.dashEntry[r]=this.addDash(e,t)),this.dashEntry[r]}getDashRanges(e,t,r){let n=e.length%2===1,a=[],o=n?-e[e.length-1]*r:0,s=e[0]*r,l=!0;a.push({left:o,right:s,isDash:l,zeroLength:e[0]===0});let u=e[0];for(let c=1;c<e.length;c++){l=!l;let p=e[c];o=u*r,u+=p,s=u*r,a.push({left:o,right:s,isDash:l,zeroLength:p===0})}return a}addRoundDash(e,t,r){let n=t/2;for(let a=-r;a<=r;a++){let o=this.nextRow+r+a,s=this.width*o,l=0,u=e[l];for(let c=0;c<this.width;c++){c/u.right>1&&(u=e[++l]);let p=Math.abs(c-u.left),d=Math.abs(c-u.right),m=Math.min(p,d),g,_=a/r*(n+1);if(u.isDash){let y=n-Math.abs(_);g=Math.sqrt(m*m+y*y)}else g=n-Math.sqrt(m*m+_*_);this.data[s+c]=Math.max(0,Math.min(255,g+128))}}}addRegularDash(e){for(let s=e.length-1;s>=0;--s){let l=e[s],u=e[s+1];l.zeroLength?e.splice(s,1):u&&u.isDash===l.isDash&&(u.left=l.left,e.splice(s,1))}let t=e[0],r=e[e.length-1];t.isDash===r.isDash&&(t.left=r.left-this.width,r.right=t.right+this.width);let n=this.width*this.nextRow,a=0,o=e[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=e[++a]);let l=Math.abs(s-o.left),u=Math.abs(s-o.right),c=Math.min(l,u),p=o.isDash?c:-c;this.data[n+s]=Math.max(0,Math.min(255,p+128))}}addDash(e,t){let r=t?7:0,n=2*r+1;if(this.nextRow+n>this.height)return dn("LineAtlas out of space"),null;let a=0;for(let s=0;s<e.length;s++)a+=e[s];if(a!==0){let s=this.width/a,l=this.getDashRanges(e,this.width,s);t?this.addRoundDash(l,s,r):this.addRegularDash(l)}let o={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:a};return this.nextRow+=n,this.dirty=!0,o}bind(e){let t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}};h(fV,"LineAtlas");var yde=fV;R();R();R();var mV=class{constructor(e){this._methodToThrottle=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};h(mV,"ThrottledInvoker");var vde=mV,gV=class{constructor(e,t){this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new vde(()=>this.process()),this.subscription=PD(this.target,"message",r=>this.receive(r),!1),this.globalScope=sh(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}sendAsync(e,t){return new Promise((r,n)=>{let a=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[a]={resolve:r,reject:n},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[a];let l={id:a,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(l)},{once:!0});let o=[],s={...e,id:a,sourceMapId:this.mapId,origin:location.origin,data:wp(e.data,o)};this.target.postMessage(s,{transfer:o})})}receive(e){let t=e.data,r=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!==location.origin)&&!(t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[r];let n=this.abortControllers[r];delete this.abortControllers[r],n&&n.abort();return}if(sh(self)||t.mustQueue){this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger();return}this.processTask(r,t)}}process(){if(this.taskQueue.length===0)return;let e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(e,t)}async processTask(e,t){if(t.type==="<response>"){let a=this.resolveRejects[e];if(delete this.resolveRejects[e],!a)return;t.error?a.reject(Sp(t.error)):a.resolve(Sp(t.data));return}if(!this.messageHandlers[t.type]){this.completeTask(e,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));return}let r=Sp(t.data),n=new AbortController;this.abortControllers[e]=n;try{let a=await this.messageHandlers[t.type](t.sourceMapId,r,n);this.completeTask(e,null,a)}catch(a){this.completeTask(e,a)}}completeTask(e,t,r){let n=[];delete this.abortControllers[e];let a={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?wp(t):null,data:wp(r,n)};this.target.postMessage(a,{transfer:n})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};h(gV,"Actor");var xde=gV;R();R();R();R();var _de='(()=>{var by=Object.create;var Ba=Object.defineProperty;var vy=Object.getOwnPropertyDescriptor;var Py=Object.getOwnPropertyNames;var Sy=Object.getPrototypeOf,wy=Object.prototype.hasOwnProperty;var Ae=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ll=(e,t)=>{for(var r in t)Ba(e,r,{get:t[r],enumerable:!0})},Ay=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Py(t))!wy.call(e,i)&&i!==r&&Ba(e,i,{get:()=>t[i],enumerable:!(n=vy(t,i))||n.enumerable});return e};var Z=(e,t,r)=>(r=e!=null?by(Sy(e)):{},Ay(t||!e||!e.__esModule?Ba(r,"default",{value:e,enumerable:!0}):r,e));var he=Ae((l0,Dl)=>{"use strict";Dl.exports=or;function or(e,t){this.x=e,this.y=t}or.prototype={clone:function(){return new or(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,i=r*this.x+t*this.y;return this.x=n,this.y=i,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.x+r*(this.x-t.x)-n*(this.y-t.y),o=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=i,this.y=o,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};or.convert=function(e){return e instanceof or?e:Array.isArray(e)?new or(e[0],e[1]):e}});var zl=Ae((u0,Bl)=>{"use strict";Bl.exports=Vl;function Vl(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}Vl.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r=r-i/o}var a=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?a=r:s=r,r=(s-a)*.5+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}}});var Ac=Ae(($v,As)=>{function sd(e,t){var r,n,i,o,a,s,l,u,c,p;for(r=e.length&3,n=e.length-r,i=t,a=3432918353,l=461845907,p=0;p<n;)c=e.charCodeAt(p)&255|(e.charCodeAt(++p)&255)<<8|(e.charCodeAt(++p)&255)<<16|(e.charCodeAt(++p)&255)<<24,++p,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c,i=i<<13|i>>>19,o=(i&65535)*5+(((i>>>16)*5&65535)<<16)&4294967295,i=(o&65535)+27492+(((o>>>16)+58964&65535)<<16);switch(c=0,r){case 3:c^=(e.charCodeAt(p+2)&255)<<16;case 2:c^=(e.charCodeAt(p+1)&255)<<8;case 1:c^=e.charCodeAt(p)&255,c=(c&65535)*a+(((c>>>16)*a&65535)<<16)&4294967295,c=c<<15|c>>>17,c=(c&65535)*l+(((c>>>16)*l&65535)<<16)&4294967295,i^=c}return i^=e.length,i^=i>>>16,i=(i&65535)*2246822507+(((i>>>16)*2246822507&65535)<<16)&4294967295,i^=i>>>13,i=(i&65535)*3266489909+(((i>>>16)*3266489909&65535)<<16)&4294967295,i^=i>>>16,i>>>0}typeof As<"u"&&(As.exports=sd)});var _c=Ae((Gv,_s)=>{function ld(e,t){for(var r=e.length,n=t^r,i=0,o;r>=4;)o=e.charCodeAt(i)&255|(e.charCodeAt(++i)&255)<<8|(e.charCodeAt(++i)&255)<<16|(e.charCodeAt(++i)&255)<<24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),o^=o>>>24,o=(o&65535)*1540483477+(((o>>>16)*1540483477&65535)<<16),n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)^o,r-=4,++i;switch(r){case 3:n^=(e.charCodeAt(i+2)&255)<<16;case 2:n^=(e.charCodeAt(i+1)&255)<<8;case 1:n^=e.charCodeAt(i)&255,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16)}return n^=n>>>13,n=(n&65535)*1540483477+(((n>>>16)*1540483477&65535)<<16),n^=n>>>15,n>>>0}typeof _s!==void 0&&(_s.exports=ld)});var Is=Ae((qv,Mo)=>{var Ic=Ac(),ud=_c();Mo.exports=Ic;Mo.exports.murmur3=Ic;Mo.exports.murmur2=ud});var Os=Ae((BP,Rs)=>{"use strict";Rs.exports=Go;Rs.exports.default=Go;function Go(e,t,r){r=r||2;var n=t&&t.length,i=n?t[0]*r:e.length,o=fp(e,0,i,r,!0),a=[];if(!o||o.next===o.prev)return a;var s,l,u,c,p,f,y;if(n&&(o=Hg(e,t,o,r)),e.length>80*r){s=u=e[0],l=c=e[1];for(var m=r;m<i;m+=r)p=e[m],f=e[m+1],p<s&&(s=p),f<l&&(l=f),p>u&&(u=p),f>c&&(c=f);y=Math.max(u-s,c-l),y=y!==0?32767/y:0}return Zn(o,a,r,s,l,y,0),a}function fp(e,t,r,n,i){var o,a;if(i===zs(e,t,r,n)>0)for(o=t;o<r;o+=n)a=pp(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=pp(o,e[o],e[o+1],a);return a&&qo(a,a.next)&&(Hn(a),a=a.next),a}function Qt(e,t){if(!e)return e;t||(t=e);var r=e,n;do if(n=!1,!r.steiner&&(qo(r,r.next)||oe(r.prev,r,r.next)===0)){if(Hn(r),r=t=r.prev,r===r.next)break;n=!0}else r=r.next;while(n||r!==t);return t}function Zn(e,t,r,n,i,o,a){if(e){!a&&o&&ex(e,n,i,o);for(var s=e,l,u;e.prev!==e.next;){if(l=e.prev,u=e.next,o?Jg(e,n,i,o):jg(e)){t.push(l.i/r|0),t.push(e.i/r|0),t.push(u.i/r|0),Hn(e),e=u.next,s=u.next;continue}if(e=u,e===s){a?a===1?(e=Zg(Qt(e),t,r),Zn(e,t,r,n,i,o,2)):a===2&&Wg(e,t,r,n,i,o):Zn(Qt(e),t,r,n,i,o,1);break}}}}function jg(e){var t=e.prev,r=e,n=e.next;if(oe(t,r,n)>=0)return!1;for(var i=t.x,o=r.x,a=n.x,s=t.y,l=r.y,u=n.y,c=i<o?i<a?i:a:o<a?o:a,p=s<l?s<u?s:u:l<u?l:u,f=i>o?i>a?i:a:o>a?o:a,y=s>l?s>u?s:u:l>u?l:u,m=n.next;m!==t;){if(m.x>=c&&m.x<=f&&m.y>=p&&m.y<=y&&Ar(i,s,o,l,a,u,m.x,m.y)&&oe(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Jg(e,t,r,n){var i=e.prev,o=e,a=e.next;if(oe(i,o,a)>=0)return!1;for(var s=i.x,l=o.x,u=a.x,c=i.y,p=o.y,f=a.y,y=s<l?s<u?s:u:l<u?l:u,m=c<p?c<f?c:f:p<f?p:f,h=s>l?s>u?s:u:l>u?l:u,d=c>p?c>f?c:f:p>f?p:f,g=Vs(y,m,t,r,n),b=Vs(h,d,t,r,n),x=e.prevZ,v=e.nextZ;x&&x.z>=g&&v&&v.z<=b;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ar(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0||(x=x.prevZ,v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ar(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0))return!1;v=v.nextZ}for(;x&&x.z>=g;){if(x.x>=y&&x.x<=h&&x.y>=m&&x.y<=d&&x!==i&&x!==a&&Ar(s,c,l,p,u,f,x.x,x.y)&&oe(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;v&&v.z<=b;){if(v.x>=y&&v.x<=h&&v.y>=m&&v.y<=d&&v!==i&&v!==a&&Ar(s,c,l,p,u,f,v.x,v.y)&&oe(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function Zg(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!qo(i,o)&&yp(i,n,n.next,o)&&Wn(i,o)&&Wn(o,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(o.i/r|0),Hn(n),Hn(n.next),n=e=o),n=n.next}while(n!==e);return Qt(n)}function Wg(e,t,r,n,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&nx(a,s)){var l=mp(a,s);a=Qt(a,a.next),l=Qt(l,l.next),Zn(a,t,r,n,i,o,0),Zn(l,t,r,n,i,o,0);return}s=s.next}a=a.next}while(a!==e)}function Hg(e,t,r,n){var i=[],o,a,s,l,u;for(o=0,a=t.length;o<a;o++)s=t[o]*n,l=o<a-1?t[o+1]*n:e.length,u=fp(e,s,l,n,!1),u===u.next&&(u.steiner=!0),i.push(rx(u));for(i.sort(Xg),o=0;o<i.length;o++)r=Kg(i[o],r);return r}function Xg(e,t){return e.x-t.x}function Kg(e,t){var r=Yg(e,t);if(!r)return t;var n=mp(r,e);return Qt(n,n.next),Qt(r,r.next)}function Yg(e,t){var r=t,n=e.x,i=e.y,o=-1/0,a;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>o&&(o=s,a=r.x<r.next.x?r:r.next,s===n))return a}r=r.next}while(r!==t);if(!a)return null;var l=a,u=a.x,c=a.y,p=1/0,f;r=a;do n>=r.x&&r.x>=u&&n!==r.x&&Ar(i<c?n:o,i,u,c,i<c?o:n,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(n-r.x),Wn(r,e)&&(f<p||f===p&&(r.x>a.x||r.x===a.x&&Qg(a,r)))&&(a=r,p=f)),r=r.next;while(r!==l);return a}function Qg(e,t){return oe(e.prev,e,t.prev)<0&&oe(t.next,e,e.next)<0}function ex(e,t,r,n){var i=e;do i.z===0&&(i.z=Vs(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,tx(i)}function tx(e){var t,r,n,i,o,a,s,l,u=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ,!!n);t++);for(l=u;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,u*=2}while(a>1);return e}function Vs(e,t,r,n,i){return e=(e-r)*i|0,t=(t-n)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function rx(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function Ar(e,t,r,n,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(r-a)*(t-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function nx(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!ix(e,t)&&(Wn(e,t)&&Wn(t,e)&&ox(e,t)&&(oe(e.prev,e,t.prev)||oe(e,t.prev,t))||qo(e,t)&&oe(e.prev,e,e.next)>0&&oe(t.prev,t,t.next)>0)}function oe(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function qo(e,t){return e.x===t.x&&e.y===t.y}function yp(e,t,r,n){var i=$o(oe(e,t,r)),o=$o(oe(e,t,n)),a=$o(oe(r,n,e)),s=$o(oe(r,n,t));return!!(i!==o&&a!==s||i===0&&Uo(e,r,t)||o===0&&Uo(e,n,t)||a===0&&Uo(r,e,n)||s===0&&Uo(r,t,n))}function Uo(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function $o(e){return e>0?1:e<0?-1:0}function ix(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&yp(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Wn(e,t){return oe(e.prev,e,e.next)<0?oe(e,t,e.next)>=0&&oe(e,e.prev,t)>=0:oe(e,t,e.prev)<0||oe(e,e.next,t)<0}function ox(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function mp(e,t){var r=new Bs(e.i,e.x,e.y),n=new Bs(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function pp(e,t,r,n){var i=new Bs(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Hn(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Bs(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Go.deviation=function(e,t,r,n){var i=t&&t.length,o=i?t[0]*r:e.length,a=Math.abs(zs(e,0,o,r));if(i)for(var s=0,l=t.length;s<l;s++){var u=t[s]*r,c=s<l-1?t[s+1]*r:e.length;a-=Math.abs(zs(e,u,c,r))}var p=0;for(s=0;s<n.length;s+=3){var f=n[s]*r,y=n[s+1]*r,m=n[s+2]*r;p+=Math.abs((e[f]-e[m])*(e[y+1]-e[f+1])-(e[f]-e[y])*(e[m+1]-e[f+1]))}return a===0&&p===0?0:Math.abs((p-a)/a)};function zs(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}Go.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&(n+=e[i-1].length,r.holes.push(n))}return r}});var Us=Ae((bS,Sp)=>{"use strict";var fx=he();Sp.exports=Cr;function Cr(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(yx,this,t)}function yx(e,t,r){e==1?t.id=r.readVarint():e==2?mx(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function mx(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}Cr.types=["Unknown","Point","LineString","Polygon"];Cr.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,a=[],s;e.pos<t;){if(n<=0){var l=e.readVarint();r=l&7,n=l>>3}if(n--,r===1||r===2)i+=e.readSVarint(),o+=e.readSVarint(),r===1&&(s&&a.push(s),s=[]),s.push(new fx(i,o));else if(r===7)s&&s.push(s[0].clone());else throw new Error("unknown command "+r)}return s&&a.push(s),a};Cr.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(n<=0){var c=e.readVarint();r=c&7,n=c>>3}if(n--,r===1||r===2)i+=e.readSVarint(),o+=e.readSVarint(),i<a&&(a=i),i>s&&(s=i),o<l&&(l=o),o>u&&(u=o);else if(r!==7)throw new Error("unknown command "+r)}return[a,l,s,u]};Cr.prototype.toGeoJSON=function(e,t,r){var n=this.extent*Math.pow(2,r),i=this.extent*e,o=this.extent*t,a=this.loadGeometry(),s=Cr.types[this.type],l,u;function c(y){for(var m=0;m<y.length;m++){var h=y[m],d=180-(h.y+o)*360/n;y[m]=[(h.x+i)*360/n-180,360/Math.PI*Math.atan(Math.exp(d*Math.PI/180))-90]}}switch(this.type){case 1:var p=[];for(l=0;l<a.length;l++)p[l]=a[l][0];a=p,c(a);break;case 2:for(l=0;l<a.length;l++)c(a[l]);break;case 3:for(a=hx(a),l=0;l<a.length;l++)for(u=0;u<a[l].length;u++)c(a[l][u]);break}a.length===1?a=a[0]:s="Multi"+s;var f={type:"Feature",geometry:{type:s,coordinates:a},properties:this.properties};return"id"in this&&(f.id=this.id),f};function hx(e){var t=e.length;if(t<=1)return[e];for(var r=[],n,i,o=0;o<t;o++){var a=dx(e[o]);a!==0&&(i===void 0&&(i=a<0),i===a<0?(n&&r.push(n),n=[e[o]]):n.push(e[o]))}return n&&r.push(n),r}function dx(e){for(var t=0,r=0,n=e.length,i=n-1,o,a;r<n;i=r++)o=e[r],a=e[i],t+=(a.x-o.x)*(o.y+a.y);return t}});var $s=Ae((vS,Ap)=>{"use strict";var gx=Us();Ap.exports=wp;function wp(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(xx,this,t),this.length=this._features.length}function xx(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(bx(r))}function bx(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=n===1?e.readString():n===2?e.readFloat():n===3?e.readDouble():n===4?e.readVarint64():n===5?e.readVarint():n===6?e.readSVarint():n===7?e.readBoolean():null}return t}wp.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new gx(this._pbf,t,this.extent,this._keys,this._values)}});var Ip=Ae((PS,_p)=>{"use strict";var vx=$s();_p.exports=Px;function Px(e,t){this.layers=e.readFields(Sx,{},t)}function Sx(e,t,r){if(e===3){var n=new vx(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}});var Tt=Ae((SS,Jo)=>{Jo.exports.VectorTile=Ip();Jo.exports.VectorTileFeature=Us();Jo.exports.VectorTileLayer=$s()});var Zp=Ae(Zs=>{Zs.read=function(e,t,r,n,i){var o,a,s=i*8-n-1,l=(1<<s)-1,u=l>>1,c=-7,p=r?i-1:0,f=r?-1:1,y=e[t+p];for(p+=f,o=y&(1<<-c)-1,y>>=-c,c+=s;c>0;o=o*256+e[t+p],p+=f,c-=8);for(a=o&(1<<-c)-1,o>>=-c,c+=n;c>0;a=a*256+e[t+p],p+=f,c-=8);if(o===0)o=1-u;else{if(o===l)return a?NaN:(y?-1:1)*(1/0);a=a+Math.pow(2,n),o=o-u}return(y?-1:1)*a*Math.pow(2,o-n)};Zs.write=function(e,t,r,n,i,o){var a,s,l,u=o*8-i-1,c=(1<<u)-1,p=c>>1,f=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:o-1,m=n?1:-1,h=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+p>=1?t+=f/l:t+=f*Math.pow(2,1-p),t*l>=2&&(a++,l/=2),a+p>=c?(s=0,a=c):a+p>=1?(s=(t*l-1)*Math.pow(2,i),a=a+p):(s=t*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;e[r+y]=s&255,y+=m,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[r+y]=a&255,y+=m,a/=256,u-=8);e[r+y-m]|=h*128}});var Qn=Ae((i2,Yp)=>{"use strict";Yp.exports=J;var Ko=Zp();function J(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}J.Varint=0;J.Fixed64=1;J.Bytes=2;J.Fixed32=5;var Ws=65536*65536,Wp=1/Ws,Ux=12,Kp=typeof TextDecoder>"u"?null:new TextDecoder("utf8");J.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=n&7,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Yo(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Xp(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Yo(this.buf,this.pos)+Yo(this.buf,this.pos+4)*Ws;return this.pos+=8,e},readSFixed64:function(){var e=Yo(this.buf,this.pos)+Xp(this.buf,this.pos+4)*Ws;return this.pos+=8,e},readFloat:function(){var e=Ko.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=Ko.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t=this.buf,r,n;return n=t[this.pos++],r=n&127,n<128||(n=t[this.pos++],r|=(n&127)<<7,n<128)||(n=t[this.pos++],r|=(n&127)<<14,n<128)||(n=t[this.pos++],r|=(n&127)<<21,n<128)?r:(n=t[this.pos],r|=(n&15)<<28,$x(r,e,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2===1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=Ux&&Kp?rb(this.buf,t,e):tb(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==J.Bytes)return e.push(this.readVarint(t));var r=ct(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==J.Bytes)return e.push(this.readSVarint());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==J.Bytes)return e.push(this.readBoolean());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==J.Bytes)return e.push(this.readFloat());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==J.Bytes)return e.push(this.readDouble());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==J.Bytes)return e.push(this.readFixed32());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==J.Bytes)return e.push(this.readSFixed32());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==J.Bytes)return e.push(this.readFixed64());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==J.Bytes)return e.push(this.readSFixed64());var t=ct(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=e&7;if(t===J.Varint)for(;this.buf[this.pos++]>127;);else if(t===J.Bytes)this.pos=this.readVarint()+this.pos;else if(t===J.Fixed32)this.pos+=4;else if(t===J.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+t)},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Er(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Er(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Er(this.buf,e&-1,this.pos),Er(this.buf,Math.floor(e*Wp),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Er(this.buf,e&-1,this.pos),Er(this.buf,Math.floor(e*Wp),this.pos+4),this.pos+=8},writeVarint:function(e){if(e=+e||0,e>268435455||e<0){Gx(e,this);return}this.realloc(4),this.buf[this.pos++]=e&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=(e>>>=7)&127|(e>127?128:0),!(e<=127)&&(this.buf[this.pos++]=e>>>7&127)))},writeSVarint:function(e){this.writeVarint(e<0?-e*2-1:e*2)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(e.length*4),this.pos++;var t=this.pos;this.pos=nb(this.buf,e,this.pos);var r=this.pos-t;r>=128&&Hp(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Ko.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Ko.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&Hp(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,J.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Jx,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Zx,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Xx,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Wx,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Hx,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,Kx,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Yx,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Qx,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,eb,t)},writeBytesField:function(e,t){this.writeTag(e,J.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,J.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,J.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,J.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,J.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,J.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,J.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,J.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,J.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,J.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,!!t)}};function $x(e,t,r){var n=r.buf,i,o;if(o=n[r.pos++],i=(o&112)>>4,o<128||(o=n[r.pos++],i|=(o&127)<<3,o<128)||(o=n[r.pos++],i|=(o&127)<<10,o<128)||(o=n[r.pos++],i|=(o&127)<<17,o<128)||(o=n[r.pos++],i|=(o&127)<<24,o<128)||(o=n[r.pos++],i|=(o&1)<<31,o<128))return Mr(e,i,t);throw new Error("Expected varint not more than 10 bytes")}function ct(e){return e.type===J.Bytes?e.readVarint()+e.pos:e.pos+1}function Mr(e,t,r){return r?t*4294967296+(e>>>0):(t>>>0)*4294967296+(e>>>0)}function Gx(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(r=~(-e%4294967296),n=~(-e/4294967296),r^4294967295?r=r+1|0:(r=0,n=n+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn\'t fit into 10 bytes");t.realloc(10),qx(r,n,t),jx(n,t)}function qx(e,t,r){r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos++]=e&127|128,e>>>=7,r.buf[r.pos]=e&127}function jx(e,t){var r=(e&7)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=e&127)))))}function Hp(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function Jx(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function Zx(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Wx(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Hx(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function Xx(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function Kx(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Yx(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Qx(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function eb(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Yo(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+e[t+3]*16777216}function Er(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Xp(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function tb(e,t,r){for(var n="",i=t;i<r;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s>r)break;var l,u,c;s===1?o<128&&(a=o):s===2?(l=e[i+1],(l&192)===128&&(a=(o&31)<<6|l&63,a<=127&&(a=null))):s===3?(l=e[i+1],u=e[i+2],(l&192)===128&&(u&192)===128&&(a=(o&15)<<12|(l&63)<<6|u&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):s===4&&(l=e[i+1],u=e[i+2],c=e[i+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(a=(o&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,s=1):a>65535&&(a-=65536,n+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),n+=String.fromCharCode(a),i+=s}return n}function rb(e,t,r){return Kp.decode(e.subarray(t,r))}function nb(e,t,r){for(var n=0,i,o;n<t.length;n++){if(i=t.charCodeAt(n),i>55295&&i<57344)if(o)if(i<56320){e[r++]=239,e[r++]=191,e[r++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||n+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):o=i;continue}else o&&(e[r++]=239,e[r++]=191,e[r++]=189,o=null);i<128?e[r++]=i:(i<2048?e[r++]=i>>6|192:(i<65536?e[r++]=i>>12|224:(e[r++]=i>>18|240,e[r++]=i>>12&63|128),e[r++]=i>>6&63|128),e[r++]=i&63|128)}return r}});var Wf=Ae((tT,Zf)=>{Zf.exports=Pa;function Pa(e,t){var r=e&&e.type,n;if(r==="FeatureCollection")for(n=0;n<e.features.length;n++)Pa(e.features[n],t);else if(r==="GeometryCollection")for(n=0;n<e.geometries.length;n++)Pa(e.geometries[n],t);else if(r==="Feature")Pa(e.geometry,t);else if(r==="Polygon")jf(e.coordinates,t);else if(r==="MultiPolygon")for(n=0;n<e.coordinates.length;n++)jf(e.coordinates[n],t);return e}function jf(e,t){if(e.length!==0){Jf(e[0],t);for(var r=1;r<e.length;r++)Jf(e[r],!t)}}function Jf(e,t){for(var r=0,n=0,i=0,o=e.length,a=o-1;i<o;a=i++){var s=(e[i][0]-e[a][0])*(e[a][1]+e[i][1]),l=r+s;n+=Math.abs(r)>=Math.abs(s)?r-l+s:s-l+r,r=l}r+n>=0!=!!t&&e.reverse()}});var Yf=Ae((iT,Kf)=>{"use strict";var Ob=he(),Nb=Tt().VectorTileFeature;Kf.exports=Xf;function Xf(e,t){this.options=t||{},this.features=e,this.length=e.length}Xf.prototype.feature=function(e){return new wa(this.features[e],this.options.extent)};function wa(e,t){this.id=typeof e.id=="number"?e.id:void 0,this.type=e.type,this.rawGeometry=e.type===1?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}wa.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var r=e[t],n=[],i=0;i<r.length;i++)n.push(new Ob(r[i][0],r[i][1]));this.geometry.push(n)}return this.geometry};wa.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<e.length;o++)for(var a=e[o],s=0;s<a.length;s++){var l=a[s];t=Math.min(t,l.x),r=Math.max(r,l.x),n=Math.min(n,l.y),i=Math.max(i,l.y)}return[t,n,r,i]};wa.prototype.toGeoJSON=Nb.prototype.toGeoJSON});var ty=Ae((oT,di)=>{var Ub=Qn(),ey=Yf();di.exports=yl;di.exports.fromVectorTileJs=yl;di.exports.fromGeojsonVt=$b;di.exports.GeoJSONWrapper=ey;function yl(e){var t=new Ub;return Gb(e,t),t.finish()}function $b(e,t){t=t||{};var r={};for(var n in e)r[n]=new ey(e[n].features,t),r[n].name=n,r[n].version=t.version,r[n].extent=t.extent;return yl({layers:r})}function Gb(e,t){for(var r in e.layers)t.writeMessage(3,qb,e.layers[r])}function qb(e,t){t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var r,n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,jb,n);var i=n.keys;for(r=0;r<i.length;r++)t.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)t.writeMessage(4,Wb,o[r])}function jb(e,t){var r=e.feature;r.id!==void 0&&t.writeVarintField(1,r.id),t.writeMessage(2,Jb,e),t.writeVarintField(3,r.type),t.writeMessage(4,Zb,r)}function Jb(e,t){var r=e.feature,n=e.keys,i=e.values,o=e.keycache,a=e.valuecache;for(var s in r.properties){var l=r.properties[s],u=o[s];if(l!==null){typeof u>"u"&&(n.push(s),u=n.length-1,o[s]=u),t.writeVarint(u);var c=typeof l;c!=="string"&&c!=="boolean"&&c!=="number"&&(l=JSON.stringify(l));var p=c+":"+l,f=a[p];typeof f>"u"&&(i.push(l),f=i.length-1,a[p]=f),t.writeVarint(f)}}}function fl(e,t){return(t<<3)+(e&7)}function Qf(e){return e<<1^e>>31}function Zb(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,o=0,a=r.length,s=0;s<a;s++){var l=r[s],u=1;n===1&&(u=l.length),t.writeVarint(fl(1,u));for(var c=n===3?l.length-1:l.length,p=0;p<c;p++){p===1&&n!==1&&t.writeVarint(fl(2,c-1));var f=l[p].x-i,y=l[p].y-o;t.writeVarint(Qf(f)),t.writeVarint(Qf(y)),i+=f,o+=y}n===3&&t.writeVarint(fl(7,1))}}function Wb(e,t){var r=typeof e;r==="string"?t.writeStringField(1,e):r==="boolean"?t.writeBooleanField(7,e):r==="number"&&(e%1!==0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}});var _y=Z(he(),1),Ul=Z(zl(),1);var za;function Rl(){return za==null&&(za=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),za}var Ii;function Ol(){if(Ii==null&&(Ii=!1,Rl())){let r=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(r){for(let i=0;i<5*5;i++){let o=i*4;r.fillStyle=`rgb(${o},${o+1},${o+2})`,r.fillRect(i%5,Math.floor(i/5),1,1)}let n=r.getImageData(0,0,5,5).data;for(let i=0;i<5*5*4;i++)if(i%4!==3&&n[i]!==i){Ii=!0;break}}}return Ii||!1}function $l(e){if(e<=0)return 0;if(e>=1)return 1;let t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function Iy(e,t,r,n){let i=new Ul.default(e,t,r,n);return function(o){return i.solve(o)}}var m0=Iy(.25,.1,.25,1);function it(e,t,r){return Math.min(r,Math.max(t,e))}function Gl(e,t,r){let n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}function Pe(e,...t){for(let r of t)for(let n in r)e[n]=r[n];return e}function ql(e){return Math.log(e)/Math.LN2%1===0}function Gr(e,t,r){let n={};for(let i in e)n[i]=t.call(r||this,e[i],i,e);return n}function jl(e,t,r){let n={};for(let i in e)t.call(r||this,e[i],i,e)&&(n[i]=e[i]);return n}function nt(e){return Array.isArray(e)?e.map(nt):typeof e=="object"&&e?Gr(e,nt):e}function Jl(e,t){for(let r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}var Nl={};function fe(e){Nl[e]||(typeof console<"u"&&console.warn(e),Nl[e]=!0)}function ot(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function Zl(e){let t=0;for(let r=0,n=e.length,i=n-1,o,a;r<n;i=r++)o=e[r],a=e[i],t+=(a.x-o.x)*(o.y+a.y);return t}function at(e){return typeof WorkerGlobalScope<"u"&&typeof e<"u"&&e instanceof WorkerGlobalScope}function qr(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap}function Ty(e,t,r,n,i){let o=Math.max(-t,0)*4,l=(Math.max(0,r)-r)*n*4+o,u=n*4,c=Math.max(0,t),p=Math.max(0,r),f=Math.min(e.width,t+n),y=Math.min(e.height,r+i);return{rect:{x:c,y:p,width:f-c,height:y-p},layout:[{offset:l,stride:u}]}}async function Cy(e,t,r,n,i){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let o=new VideoFrame(e,{timestamp:0});try{let a=o==null?void 0:o.format;if(!a||!(a.startsWith("BGR")||a.startsWith("RGB")))throw new Error(`Unrecognized format ${a}`);let s=a.startsWith("BGR"),l=new Uint8ClampedArray(n*i*4);if(await o.copyTo(l,Ty(e,t,r,n,i)),s)for(let u=0;u<l.length;u+=4){let c=l[u];l[u]=l[u+2],l[u+2]=c}return l}finally{o.close()}}var Ur,$r;function ky(e,t,r,n,i){let o=e.width,a=e.height;(!Ur||!$r)&&(Ur=new OffscreenCanvas(o,a),$r=Ur.getContext("2d",{willReadFrequently:!0})),Ur.width=o,Ur.height=a,$r.drawImage(e,0,0,o,a);let s=$r.getImageData(t,r,n,i);return $r.clearRect(0,0,o,a),s.data}async function Wl(e,t,r,n,i){if(Ol())try{return await Cy(e,t,r,n,i)}catch{}return ky(e,t,r,n,i)}function Hl(e,t,r,n){return e.addEventListener(t,r,n),{unsubscribe:()=>{e.removeEventListener(t,r,n)}}}var Dt=class e{constructor(t,r,n){let i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;let a=new Int32Array(this.arrayBuffer);t=a[0],r=a[1],n=a[2],this.d=r+2*n;for(let u=0;u<this.d*this.d;u++){let c=a[3+u],p=a[3+u+1];i.push(c===p?null:a.subarray(c,p))}let s=a[3+i.length],l=a[3+i.length+1];this.keys=a.subarray(s,l),this.bboxes=a.subarray(l),this.insert=this._insertReadonly}else{this.d=r+2*n;for(let a=0;a<this.d*this.d;a++)i.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=t,this.padding=n,this.scale=r/t,this.uid=0;let o=n/r*t;this.min=-o,this.max=t+o}insert(t,r,n,i,o){this._forEachCell(r,n,i,o,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(o)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,r,n,i,o,a){this.cells[o].push(a)}query(t,r,n,i,o){let a=this.min,s=this.max;if(t<=a&&r<=a&&s<=n&&s<=i&&!o)return Array.prototype.slice.call(this.keys);{let l=[],u={};return this._forEachCell(t,r,n,i,this._queryCell,l,u,o),l}}_queryCell(t,r,n,i,o,a,s,l){let u=this.cells[o];if(u!==null){let c=this.keys,p=this.bboxes;for(let f=0;f<u.length;f++){let y=u[f];if(s[y]===void 0){let m=y*4;(l?l(p[m+0],p[m+1],p[m+2],p[m+3]):t<=p[m+2]&&r<=p[m+3]&&n>=p[m+0]&&i>=p[m+1])?(s[y]=!0,a.push(c[y])):s[y]=!1}}}}_forEachCell(t,r,n,i,o,a,s,l){let u=this._convertToCellCoord(t),c=this._convertToCellCoord(r),p=this._convertToCellCoord(n),f=this._convertToCellCoord(i);for(let y=u;y<=p;y++)for(let m=c;m<=f;m++){let h=this.d*m+y;if(!(l&&!l(this._convertFromCellCoord(y),this._convertFromCellCoord(m),this._convertFromCellCoord(y+1),this._convertFromCellCoord(m+1)))&&o.call(this,t,r,n,i,h,a,s,l))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let t=this.cells,r=3+this.cells.length+1+1,n=0;for(let a=0;a<this.cells.length;a++)n+=this.cells[a].length;let i=new Int32Array(r+n+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;let o=r;for(let a=0;a<t.length;a++){let s=t[a];i[3+a]=o,i.set(s,o),o+=s.length}return i[3+t.length]=o,i.set(this.keys,o),o+=this.keys.length,i[3+t.length+1]=o,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer}static serialize(t,r){let n=t.toArrayBuffer();return r&&r.push(n),{buffer:n}}static deserialize(t){return new e(t.buffer)}};var My=8,Ey={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},Fy={"*":{type:"source"}},Ly=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],Dy={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},Vy={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},By={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},zy={type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Ry={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Oy={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Ny={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Uy=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],$y={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Gy={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},qy={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},jy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Jy={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Zy={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Wy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Hy={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Xy={type:"array",value:"*"},Ky={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},Yy={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},Qy={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},em={type:"array",value:"*",minimum:1},tm={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},rm={"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},nm={source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},im={type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},om=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],am={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},sm={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},lm={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},um={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},cm={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},pm={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},fm={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ym={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},mm={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},hm={"*":{type:"string"}},S={$version:My,$root:Ey,sources:Fy,source:Ly,source_vector:Dy,source_raster:Vy,source_raster_dem:By,source_geojson:zy,source_video:Ry,source_image:Oy,layer:Ny,layout:Uy,layout_background:$y,layout_fill:Gy,layout_circle:qy,layout_heatmap:jy,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Jy,layout_symbol:Zy,layout_raster:Wy,layout_hillshade:Hy,filter:Xy,filter_operator:Ky,geometry_type:Yy,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:Qy,expression:em,light:tm,sky:rm,terrain:nm,projection:im,paint:om,paint_fill:am,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:sm,paint_circle:lm,paint_heatmap:um,paint_symbol:cm,paint_raster:pm,paint_hillshade:fm,paint_background:ym,transition:mm,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:hm},dm=["type","source","source-layer","minzoom","maxzoom","filter","layout"];var M=class{constructor(t,r,n,i){this.message=(t?`${t}: `:"")+n,i&&(this.identifier=i),r!=null&&r.__line__&&(this.line=r.__line__)}};function cr(e,...t){for(let r of t)for(let n in r)e[n]=r[n];return e}var Be=class extends Error{constructor(t,r){super(r),this.message=r,this.key=t}},Ja=class e{constructor(t,r=[]){this.parent=t,this.bindings={};for(let[n,i]of r)this.bindings[n]=i}concat(t){return new e(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return this.bindings[t]?!0:this.parent?this.parent.has(t):!1}},yr={kind:"null"},L={kind:"number"},G={kind:"string"},U={kind:"boolean"},Re={kind:"color"},lr={kind:"object"},$={kind:"value"},gm={kind:"error"},ji={kind:"collator"},mr={kind:"formatted"},Ji={kind:"padding"},un={kind:"resolvedImage"},Zi={kind:"variableAnchorOffsetCollection"};function Ee(e,t){return{kind:"array",itemType:e,N:t}}function te(e){if(e.kind==="array"){let t=te(e.itemType);return typeof e.N=="number"?`array<${t}, ${e.N}>`:e.itemType.kind==="value"?"array":`array<${t}>`}else return e.kind}var xm=[yr,L,G,U,Re,mr,lr,Ee($),Ji,un,Zi];function Hr(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Hr(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(let r of xm)if(!Hr(r,t))return null}}return`Expected ${te(e)} but found ${te(t)} instead.`}function us(e,t){return t.some(r=>r.kind===e.kind)}function Xr(e,t){return t.some(r=>r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e)}function jr(e,t){return e.kind==="array"&&t.kind==="array"?e.itemType.kind===t.itemType.kind&&typeof e.N=="number":e.kind===t.kind}var du=.96422,gu=1,xu=.82521,bu=4/29,ur=6/29,vu=3*ur*ur,bm=ur*ur*ur,vm=Math.PI/180,Pm=180/Math.PI;function Pu(e){return e=e%360,e<0&&(e+=360),e}function Su([e,t,r,n]){e=Ra(e),t=Ra(t),r=Ra(r);let i,o,a=Oa((.2225045*e+.7168786*t+.0606169*r)/gu);e===t&&t===r?i=o=a:(i=Oa((.4360747*e+.3850649*t+.1430804*r)/du),o=Oa((.0139322*e+.0971045*t+.7141733*r)/xu));let s=116*a-16;return[s<0?0:s,500*(i-a),200*(a-o),n]}function Ra(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Oa(e){return e>bm?Math.pow(e,1/3):e/vu+bu}function wu([e,t,r,n]){let i=(e+16)/116,o=isNaN(t)?i:i+t/500,a=isNaN(r)?i:i-r/200;return i=gu*Ua(i),o=du*Ua(o),a=xu*Ua(a),[Na(3.1338561*o-1.6168667*i-.4906146*a),Na(-.9787684*o+1.9161415*i+.033454*a),Na(.0719453*o-.2289914*i+1.4052427*a),n]}function Na(e){return e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055,e<0?0:e>1?1:e}function Ua(e){return e>ur?e*e*e:vu*(e-bu)}function Sm(e){let[t,r,n,i]=Su(e),o=Math.sqrt(r*r+n*n);return[Math.round(o*1e4)?Pu(Math.atan2(n,r)*Pm):NaN,o,t,i]}function wm([e,t,r,n]){return e=isNaN(e)?0:e*vm,wu([r,Math.cos(e)*t,Math.sin(e)*t,n])}function Am([e,t,r,n]){e=Pu(e),t/=100,r/=100;function i(o){let a=(o+e/30)%12,s=t*Math.min(r,1-r);return r-s*Math.max(-1,Math.min(a-3,9-a,1))}return[i(0),i(8),i(4),n]}function _m(e){if(e=e.toLowerCase().trim(),e==="transparent")return[0,0,0,0];let t=Im[e];if(t){let[i,o,a]=t;return[i/255,o/255,a/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){let o=e.length<6?1:2,a=1;return[Ti(e.slice(a,a+=o)),Ti(e.slice(a,a+=o)),Ti(e.slice(a,a+=o)),Ti(e.slice(a,a+o)||"ff")]}if(e.startsWith("rgb")){let i=/^rgba?\\(\\s*([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)(%)?(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,o=e.match(i);if(o){let[a,s,l,u,c,p,f,y,m,h,d,g]=o,b=[u||" ",f||" ",h].join("");if(b==="  "||b==="  /"||b===",,"||b===",,,"){let x=[l,p,m].join(""),v=x==="%%%"?100:x===""?255:0;if(v){let P=[ar(+s/v,0,1),ar(+c/v,0,1),ar(+y/v,0,1),d?Xl(+d,g):1];if(Kl(P))return P}}return}}let r=/^hsla?\\(\\s*([\\de.+-]+)(?:deg)?(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s+|\\s*(,)\\s*)([\\de.+-]+)%(?:\\s*([,\\/])\\s*([\\de.+-]+)(%)?)?\\s*\\)$/,n=e.match(r);if(n){let[i,o,a,s,l,u,c,p,f]=n,y=[a||" ",l||" ",c].join("");if(y==="  "||y==="  /"||y===",,"||y===",,,"){let m=[+o,ar(+s,0,100),ar(+u,0,100),p?Xl(+p,f):1];if(Kl(m))return Am(m)}}}function Ti(e){return parseInt(e.padEnd(2,e),16)/255}function Xl(e,t){return ar(t?e/100:e,0,1)}function ar(e,t,r){return Math.min(Math.max(t,e),r)}function Kl(e){return!e.some(Number.isNaN)}var Im={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},W=class e{constructor(t,r,n,i=1,o=!0){this.r=t,this.g=r,this.b=n,this.a=i,o||(this.r*=i,this.g*=i,this.b*=i,i||this.overwriteGetter("rgb",[t,r,n,i]))}static parse(t){if(t instanceof e)return t;if(typeof t!="string")return;let r=_m(t);if(r)return new e(...r,!1)}get rgb(){let{r:t,g:r,b:n,a:i}=this,o=i||1/0;return this.overwriteGetter("rgb",[t/o,r/o,n/o,i])}get hcl(){return this.overwriteGetter("hcl",Sm(this.rgb))}get lab(){return this.overwriteGetter("lab",Su(this.rgb))}overwriteGetter(t,r){return Object.defineProperty(this,t,{value:r}),r}toString(){let[t,r,n,i]=this.rgb;return`rgba(${[t,r,n].map(o=>Math.round(o*255)).join(",")},${i})`}};W.black=new W(0,0,0,1);W.white=new W(1,1,1,1);W.transparent=new W(0,0,0,0);W.red=new W(1,0,0,1);var Kr=class{constructor(t,r,n){t?this.sensitivity=r?"variant":"case":this.sensitivity=r?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,r){return this.collator.compare(t,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}},Yr=class{constructor(t,r,n,i,o){this.text=t,this.image=r,this.scale=n,this.fontStack=i,this.textColor=o}},Fe=class e{constructor(t){this.sections=t}static fromString(t){return new e([new Yr(t,null,null,null,null)])}isEmpty(){return this.sections.length===0?!0:!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof e?t:e.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}},Ze=class e{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof e)return t;if(typeof t=="number")return new e([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(let r of t)if(typeof r!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]];break}return new e(t)}}toString(){return JSON.stringify(this.values)}},Tm=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]),Ne=class e{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof e)return t;if(!(!Array.isArray(t)||t.length<1||t.length%2!==0)){for(let r=0;r<t.length;r+=2){let n=t[r],i=t[r+1];if(typeof n!="string"||!Tm.has(n)||!Array.isArray(i)||i.length!==2||typeof i[0]!="number"||typeof i[1]!="number")return}return new e(t)}}toString(){return JSON.stringify(this.values)}},Te=class e{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new e({name:t,available:!1}):null}};function Au(e,t,r,n){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?typeof n>"u"||typeof n=="number"&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: \'a\' must be between 0 and 1.`:`Invalid rgba value [${(typeof n=="number"?[e,t,r,n]:[e,t,r]).join(", ")}]: \'r\', \'g\', and \'b\' must be between 0 and 255.`}function Qr(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof W||e instanceof Kr||e instanceof Fe||e instanceof Ze||e instanceof Ne||e instanceof Te)return!0;if(Array.isArray(e)){for(let t of e)if(!Qr(t))return!1;return!0}else if(typeof e=="object"){for(let t in e)if(!Qr(e[t]))return!1;return!0}else return!1}function ue(e){if(e===null)return yr;if(typeof e=="string")return G;if(typeof e=="boolean")return U;if(typeof e=="number")return L;if(e instanceof W)return Re;if(e instanceof Kr)return ji;if(e instanceof Fe)return mr;if(e instanceof Ze)return Ji;if(e instanceof Ne)return Zi;if(e instanceof Te)return un;if(Array.isArray(e)){let t=e.length,r;for(let n of e){let i=ue(n);if(!r)r=i;else{if(r===i)continue;r=$;break}}return Ee(r||$,t)}else return lr}function Zr(e){let t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof W||e instanceof Fe||e instanceof Ze||e instanceof Ne||e instanceof Te?e.toString():JSON.stringify(e)}var mt=class e{constructor(t,r){this.type=t,this.value=r}static parse(t,r){if(t.length!==2)return r.error(`\'literal\' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Qr(t[1]))return r.error("invalid value");let n=t[1],i=ue(n),o=r.expectedType;return i.kind==="array"&&i.N===0&&o&&o.kind==="array"&&(typeof o.N!="number"||o.N===0)&&(i=o),new e(i,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}},ie=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}},Ci={string:G,number:L,boolean:U,object:lr},je=class e{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let n=1,i,o=t[0];if(o==="array"){let s;if(t.length>2){let u=t[1];if(typeof u!="string"||!(u in Ci)||u==="object")return r.error(\'The item type argument of "array" must be one of string, number, boolean\',1);s=Ci[u],n++}else s=$;let l;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return r.error(\'The length argument to "array" must be a positive integer literal\',2);l=t[2],n++}i=Ee(s,l)}else{if(!Ci[o])throw new Error(`Types doesn\'t contain name = ${o}`);i=Ci[o]}let a=[];for(;n<t.length;n++){let s=r.parse(t[n],n,$);if(!s)return null;a.push(s)}return new e(i,a)}evaluate(t){for(let r=0;r<this.args.length;r++){let n=this.args[r].evaluate(t);if(Hr(this.type,ue(n))){if(r===this.args.length-1)throw new ie(`Expected value to be of type ${te(this.type)}, but found ${te(ue(n))} instead.`)}else return n}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}},Yl={"to-boolean":U,"to-color":Re,"to-number":L,"to-string":G},yt=class e{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let n=t[0];if(!Yl[n])throw new Error(`Can\'t parse ${n} as it is not part of the known types`);if((n==="to-boolean"||n==="to-string")&&t.length!==2)return r.error("Expected one argument.");let i=Yl[n],o=[];for(let a=1;a<t.length;a++){let s=r.parse(t[a],a,$);if(!s)return null;o.push(s)}return new e(i,o)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let r,n;for(let i of this.args){if(r=i.evaluate(t),n=null,r instanceof W)return r;if(typeof r=="string"){let o=t.parseColor(r);if(o)return o}else if(Array.isArray(r)&&(r.length<3||r.length>4?n=`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:n=Au(r[0],r[1],r[2],r[3]),!n))return new W(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new ie(n||`Could not parse color from value \'${typeof r=="string"?r:JSON.stringify(r)}\'`)}case"padding":{let r;for(let n of this.args){r=n.evaluate(t);let i=Ze.parse(r);if(i)return i}throw new ie(`Could not parse padding from value \'${typeof r=="string"?r:JSON.stringify(r)}\'`)}case"variableAnchorOffsetCollection":{let r;for(let n of this.args){r=n.evaluate(t);let i=Ne.parse(r);if(i)return i}throw new ie(`Could not parse variableAnchorOffsetCollection from value \'${typeof r=="string"?r:JSON.stringify(r)}\'`)}case"number":{let r=null;for(let n of this.args){if(r=n.evaluate(t),r===null)return 0;let i=Number(r);if(!isNaN(i))return i}throw new ie(`Could not convert ${JSON.stringify(r)} to number.`)}case"formatted":return Fe.fromString(Zr(this.args[0].evaluate(t)));case"resolvedImage":return Te.fromString(Zr(this.args[0].evaluate(t)));default:return Zr(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}},Cm=["Unknown","Point","LineString","Polygon"],Fi=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Cm[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let r=this._parseColorCache[t];return r||(r=this._parseColorCache[t]=W.parse(t)),r}},Li=class e{constructor(t,r,n=[],i,o=new Ja,a=[]){this.registry=t,this.path=n,this.key=n.map(s=>`[${s}]`).join(""),this.scope=o,this.errors=a,this.expectedType=i,this._isConstant=r}parse(t,r,n,i,o={}){return r?this.concat(r,n,i)._parse(t,o):this._parse(t,o)}_parse(t,r){(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number")&&(t=["literal",t]);function n(i,o,a){return a==="assert"?new je(o,[i]):a==="coerce"?new yt(o,[i]):i}if(Array.isArray(t)){if(t.length===0)return this.error(\'Expected an array with at least one element. If you wanted a literal array, use ["literal", []].\');let i=t[0];if(typeof i!="string")return this.error(`Expression name must be a string, but found ${typeof i} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let o=this.registry[i];if(o){let a=o.parse(t,this);if(!a)return null;if(this.expectedType){let s=this.expectedType,l=a.type;if((s.kind==="string"||s.kind==="number"||s.kind==="boolean"||s.kind==="object"||s.kind==="array")&&l.kind==="value")a=n(a,s,r.typeAnnotation||"assert");else if((s.kind==="color"||s.kind==="formatted"||s.kind==="resolvedImage")&&(l.kind==="value"||l.kind==="string"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="padding"&&(l.kind==="value"||l.kind==="number"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(s.kind==="variableAnchorOffsetCollection"&&(l.kind==="value"||l.kind==="array"))a=n(a,s,r.typeAnnotation||"coerce");else if(this.checkSubtype(s,l))return null}if(!(a instanceof mt)&&a.type.kind!=="resolvedImage"&&this._isConstant(a)){let s=new Fi;try{a=new mt(a.type,a.evaluate(s))}catch(l){return this.error(l.message),null}}return a}return this.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0)}else return typeof t>"u"?this.error("\'undefined\' value invalid. Use null instead."):typeof t=="object"?this.error(\'Bare objects invalid. Use ["literal", {...}] instead.\'):this.error(`Expected an array, but found ${typeof t} instead.`)}concat(t,r,n){let i=typeof t=="number"?this.path.concat(t):this.path,o=n?this.scope.concat(n):this.scope;return new e(this.registry,this._isConstant,i,r||null,o,this.errors)}error(t,...r){let n=`${this.key}${r.map(i=>`[${i}]`).join("")}`;this.errors.push(new Be(n,t))}checkSubtype(t,r){let n=Hr(t,r);return n&&this.error(n),n}},Di=class e{constructor(t,r){this.type=r.type,this.bindings=[].concat(t),this.result=r}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(let r of this.bindings)t(r[1]);t(this.result)}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);let n=[];for(let o=1;o<t.length-1;o+=2){let a=t[o];if(typeof a!="string")return r.error(`Expected string, but found ${typeof a} instead.`,o);if(/[^a-zA-Z0-9_]/.test(a))return r.error("Variable names must contain only alphanumeric characters or \'_\'.",o);let s=r.parse(t[o+1],o+1);if(!s)return null;n.push([a,s])}let i=r.parse(t[t.length-1],t.length-1,r.expectedType,n);return i?new e(n,i):null}outputDefined(){return this.result.outputDefined()}},Vi=class e{constructor(t,r){this.type=r.type,this.name=t,this.boundExpression=r}static parse(t,r){if(t.length!==2||typeof t[1]!="string")return r.error("\'var\' expression requires exactly one string literal argument.");let n=t[1];return r.scope.has(n)?new e(n,r.scope.get(n)):r.error(`Unknown variable "${n}". Make sure "${n}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}},Za=class e{constructor(t,r,n){this.type=t,this.index=r,this.input=n}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let n=r.parse(t[1],1,L),i=r.parse(t[2],2,Ee(r.expectedType||$));if(!n||!i)return null;let o=i.type;return new e(o.itemType,n,i)}evaluate(t){let r=this.index.evaluate(t),n=this.input.evaluate(t);if(r<0)throw new ie(`Array index out of bounds: ${r} < 0.`);if(r>=n.length)throw new ie(`Array index out of bounds: ${r} > ${n.length-1}.`);if(r!==Math.floor(r))throw new ie(`Array index must be an integer, but found ${r} instead.`);return n[r]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}},Wa=class e{constructor(t,r){this.type=U,this.needle=t,this.haystack=r}static parse(t,r){if(t.length!==3)return r.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let n=r.parse(t[1],1,$),i=r.parse(t[2],2,$);return!n||!i?null:us(n.type,[U,G,L,yr,$])?new e(n,i):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${te(n.type)} instead`)}evaluate(t){let r=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!n)return!1;if(!Xr(r,["boolean","string","number","null"]))throw new ie(`Expected first argument to be of type boolean, string, number or null, but found ${te(ue(r))} instead.`);if(!Xr(n,["string","array"]))throw new ie(`Expected second argument to be of type array or string, but found ${te(ue(n))} instead.`);return n.indexOf(r)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}},Ha=class e{constructor(t,r,n){this.type=L,this.needle=t,this.haystack=r,this.fromIndex=n}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let n=r.parse(t[1],1,$),i=r.parse(t[2],2,$);if(!n||!i)return null;if(!us(n.type,[U,G,L,yr,$]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${te(n.type)} instead`);if(t.length===4){let o=r.parse(t[3],3,L);return o?new e(n,i,o):null}else return new e(n,i)}evaluate(t){let r=this.needle.evaluate(t),n=this.haystack.evaluate(t);if(!Xr(r,["boolean","string","number","null"]))throw new ie(`Expected first argument to be of type boolean, string, number or null, but found ${te(ue(r))} instead.`);if(!Xr(n,["string","array"]))throw new ie(`Expected second argument to be of type array or string, but found ${te(ue(n))} instead.`);if(this.fromIndex){let i=this.fromIndex.evaluate(t);return n.indexOf(r,i)}return n.indexOf(r)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}},Xa=class e{constructor(t,r,n,i,o,a){this.inputType=t,this.type=r,this.input=n,this.cases=i,this.outputs=o,this.otherwise=a}static parse(t,r){if(t.length<5)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!==1)return r.error("Expected an even number of arguments.");let n,i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);let o={},a=[];for(let u=2;u<t.length-1;u+=2){let c=t[u],p=t[u+1];Array.isArray(c)||(c=[c]);let f=r.concat(u);if(c.length===0)return f.error("Expected at least one branch label.");for(let m of c){if(typeof m!="number"&&typeof m!="string")return f.error("Branch labels must be numbers or strings.");if(typeof m=="number"&&Math.abs(m)>Number.MAX_SAFE_INTEGER)return f.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof m=="number"&&Math.floor(m)!==m)return f.error("Numeric branch labels must be integer values.");if(!n)n=ue(m);else if(f.checkSubtype(n,ue(m)))return null;if(typeof o[String(m)]<"u")return f.error("Branch labels must be unique.");o[String(m)]=a.length}let y=r.parse(p,u,i);if(!y)return null;i=i||y.type,a.push(y)}let s=r.parse(t[1],1,$);if(!s)return null;let l=r.parse(t[t.length-1],t.length-1,i);return!l||s.type.kind!=="value"&&r.concat(1).checkSubtype(n,s.type)?null:new e(n,i,s,o,a,l)}evaluate(t){let r=this.input.evaluate(t);return(ue(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}},Ka=class e{constructor(t,r,n){this.type=t,this.branches=r,this.otherwise=n}static parse(t,r){if(t.length<4)return r.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!==0)return r.error("Expected an odd number of arguments.");let n;r.expectedType&&r.expectedType.kind!=="value"&&(n=r.expectedType);let i=[];for(let a=1;a<t.length-1;a+=2){let s=r.parse(t[a],a,U);if(!s)return null;let l=r.parse(t[a+1],a+1,n);if(!l)return null;i.push([s,l]),n=n||l.type}let o=r.parse(t[t.length-1],t.length-1,n);if(!o)return null;if(!n)throw new Error("Can\'t infer output type");return new e(n,i,o)}evaluate(t){for(let[r,n]of this.branches)if(r.evaluate(t))return n.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(let[r,n]of this.branches)t(r),t(n);t(this.otherwise)}outputDefined(){return this.branches.every(([t,r])=>r.outputDefined())&&this.otherwise.outputDefined()}},Ya=class e{constructor(t,r,n,i){this.type=t,this.input=r,this.beginIndex=n,this.endIndex=i}static parse(t,r){if(t.length<=2||t.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let n=r.parse(t[1],1,$),i=r.parse(t[2],2,L);if(!n||!i)return null;if(!us(n.type,[Ee($),G,$]))return r.error(`Expected first argument to be of type array or string, but found ${te(n.type)} instead`);if(t.length===4){let o=r.parse(t[3],3,L);return o?new e(n.type,n,i,o):null}else return new e(n.type,n,i)}evaluate(t){let r=this.input.evaluate(t),n=this.beginIndex.evaluate(t);if(!Xr(r,["string","array"]))throw new ie(`Expected first argument to be of type array or string, but found ${te(ue(r))} instead.`);if(this.endIndex){let i=this.endIndex.evaluate(t);return r.slice(n,i)}return r.slice(n)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}};function Wi(e,t){let r=e.length-1,n=0,i=r,o=0,a,s;for(;n<=i;)if(o=Math.floor((n+i)/2),a=e[o],s=e[o+1],a<=t){if(o===r||t<s)return o;n=o+1}else if(a>t)i=o-1;else throw new ie("Input is not a number.");return 0}var pr=class e{constructor(t,r,n){this.type=t,this.input=r,this.labels=[],this.outputs=[];for(let[i,o]of n)this.labels.push(i),this.outputs.push(o)}static parse(t,r){if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!==0)return r.error("Expected an even number of arguments.");let n=r.parse(t[1],1,L);if(!n)return null;let i=[],o=null;r.expectedType&&r.expectedType.kind!=="value"&&(o=r.expectedType);for(let a=1;a<t.length;a+=2){let s=a===1?-1/0:t[a],l=t[a+1],u=a,c=a+1;if(typeof s!="number")return r.error(\'Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.\',u);if(i.length&&i[i.length-1][0]>=s)return r.error(\'Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.\',u);let p=r.parse(l,c,o);if(!p)return null;o=o||p.type,i.push([s,p])}return new e(o,n,i)}evaluate(t){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(t);let i=this.input.evaluate(t);if(i<=r[0])return n[0].evaluate(t);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(t);let a=Wi(r,i);return n[a].evaluate(t)}eachChild(t){t(this.input);for(let r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}};function km(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Mm=_u;function _u(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}_u.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(t===void 0&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r=r-i/o}var a=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?a=r:s=r,r=(s-a)*.5+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var Em=km(Mm);function Fm(e){return e==="rgb"||e==="hcl"||e==="lab"}function zt(e,t,r){return e+r*(t-e)}function Lm(e,t,r,n="rgb"){switch(n){case"rgb":{let[i,o,a,s]=Bi(e.rgb,t.rgb,r);return new W(i,o,a,s,!1)}case"hcl":{let[i,o,a,s]=e.hcl,[l,u,c,p]=t.hcl,f,y;if(!isNaN(i)&&!isNaN(l)){let b=l-i;l>i&&b>180?b-=360:l<i&&i-l>180&&(b+=360),f=i+r*b}else isNaN(i)?isNaN(l)?f=NaN:(f=l,(a===1||a===0)&&(y=u)):(f=i,(c===1||c===0)&&(y=o));let[m,h,d,g]=wm([f,y!=null?y:zt(o,u,r),zt(a,c,r),zt(s,p,r)]);return new W(m,h,d,g,!1)}case"lab":{let[i,o,a,s]=wu(Bi(e.lab,t.lab,r));return new W(i,o,a,s,!1)}}}function Bi(e,t,r){return e.map((n,i)=>zt(n,t[i],r))}function Dm(e,t,r){return new Ze(Bi(e.values,t.values,r))}function Vm(e,t,r){let n=e.values,i=t.values;if(n.length!==i.length)throw new ie(`Cannot interpolate values of different length. from: ${e.toString()}, to: ${t.toString()}`);let o=[];for(let a=0;a<n.length;a+=2){if(n[a]!==i[a])throw new ie(`Cannot interpolate values containing mismatched anchors. from[${a}]: ${n[a]}, to[${a}]: ${i[a]}`);o.push(n[a]);let[s,l]=n[a+1],[u,c]=i[a+1];o.push([zt(s,u,r),zt(l,c,r)])}return new Ne(o)}var Oe={number:zt,color:Lm,array:Bi,padding:Dm,variableAnchorOffsetCollection:Vm},Je=class e{constructor(t,r,n,i,o){this.type=t,this.operator=r,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(let[a,s]of o)this.labels.push(a),this.outputs.push(s)}static interpolationFactor(t,r,n,i){let o=0;if(t.name==="exponential")o=$a(r,t.base,n,i);else if(t.name==="linear")o=$a(r,1,n,i);else if(t.name==="cubic-bezier"){let a=t.controlPoints;o=new Em(a[0],a[1],a[2],a[3]).solve($a(r,1,n,i))}return o}static parse(t,r){let[n,i,o,...a]=t;if(!Array.isArray(i)||i.length===0)return r.error("Expected an interpolation type expression.",1);if(i[0]==="linear")i={name:"linear"};else if(i[0]==="exponential"){let u=i[1];if(typeof u!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:u}}else if(i[0]==="cubic-bezier"){let u=i.slice(1);if(u.length!==4||u.some(c=>typeof c!="number"||c<0||c>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:u}}else return r.error(`Unknown interpolation type ${String(i[0])}`,1,0);if(t.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!==0)return r.error("Expected an even number of arguments.");if(o=r.parse(o,2,L),!o)return null;let s=[],l=null;n==="interpolate-hcl"||n==="interpolate-lab"?l=Re:r.expectedType&&r.expectedType.kind!=="value"&&(l=r.expectedType);for(let u=0;u<a.length;u+=2){let c=a[u],p=a[u+1],f=u+3,y=u+4;if(typeof c!="number")return r.error(\'Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.\',f);if(s.length&&s[s.length-1][0]>=c)return r.error(\'Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.\',f);let m=r.parse(p,y,l);if(!m)return null;l=l||m.type,s.push([c,m])}return!jr(l,L)&&!jr(l,Re)&&!jr(l,Ji)&&!jr(l,Zi)&&!jr(l,Ee(L))?r.error(`Type ${te(l)} is not interpolatable.`):new e(l,n,i,o,s)}evaluate(t){let r=this.labels,n=this.outputs;if(r.length===1)return n[0].evaluate(t);let i=this.input.evaluate(t);if(i<=r[0])return n[0].evaluate(t);let o=r.length;if(i>=r[o-1])return n[o-1].evaluate(t);let a=Wi(r,i),s=r[a],l=r[a+1],u=e.interpolationFactor(this.interpolation,i,s,l),c=n[a].evaluate(t),p=n[a+1].evaluate(t);switch(this.operator){case"interpolate":return Oe[this.type.kind](c,p,u);case"interpolate-hcl":return Oe.color(c,p,u,"hcl");case"interpolate-lab":return Oe.color(c,p,u,"lab")}}eachChild(t){t(this.input);for(let r of this.outputs)t(r)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}};function $a(e,t,r,n){let i=n-r,o=e-r;return i===0?0:t===1?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}var zi=class e{constructor(t,r){this.type=t,this.args=r}static parse(t,r){if(t.length<2)return r.error("Expectected at least one argument.");let n=null,i=r.expectedType;i&&i.kind!=="value"&&(n=i);let o=[];for(let s of t.slice(1)){let l=r.parse(s,1+o.length,n,void 0,{typeAnnotation:"omit"});if(!l)return null;n=n||l.type,o.push(l)}if(!n)throw new Error("No output type");return i&&o.some(s=>Hr(i,s.type))?new e($,o):new e(n,o)}evaluate(t){let r=null,n=0,i;for(let o of this.args)if(n++,r=o.evaluate(t),r&&r instanceof Te&&!r.available&&(i||(i=r.name),r=null,n===this.args.length&&(r=i)),r!==null)break;return r}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}};function Ql(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function Bm(e,t,r){return t===r}function zm(e,t,r){return t!==r}function Rm(e,t,r){return t<r}function Om(e,t,r){return t>r}function Nm(e,t,r){return t<=r}function Um(e,t,r){return t>=r}function Iu(e,t,r,n){return n.compare(t,r)===0}function $m(e,t,r,n){return!Iu(e,t,r,n)}function Gm(e,t,r,n){return n.compare(t,r)<0}function qm(e,t,r,n){return n.compare(t,r)>0}function jm(e,t,r,n){return n.compare(t,r)<=0}function Jm(e,t,r,n){return n.compare(t,r)>=0}function hr(e,t,r){let n=e!=="=="&&e!=="!=";return class Tu{constructor(o,a,s){this.type=U,this.lhs=o,this.rhs=a,this.collator=s,this.hasUntypedArgument=o.type.kind==="value"||a.type.kind==="value"}static parse(o,a){if(o.length!==3&&o.length!==4)return a.error("Expected two or three arguments.");let s=o[0],l=a.parse(o[1],1,$);if(!l)return null;if(!Ql(s,l.type))return a.concat(1).error(`"${s}" comparisons are not supported for type \'${te(l.type)}\'.`);let u=a.parse(o[2],2,$);if(!u)return null;if(!Ql(s,u.type))return a.concat(2).error(`"${s}" comparisons are not supported for type \'${te(u.type)}\'.`);if(l.type.kind!==u.type.kind&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error(`Cannot compare types \'${te(l.type)}\' and \'${te(u.type)}\'.`);n&&(l.type.kind==="value"&&u.type.kind!=="value"?l=new je(u.type,[l]):l.type.kind!=="value"&&u.type.kind==="value"&&(u=new je(l.type,[u])));let c=null;if(o.length===4){if(l.type.kind!=="string"&&u.type.kind!=="string"&&l.type.kind!=="value"&&u.type.kind!=="value")return a.error("Cannot use collator to compare non-string types.");if(c=a.parse(o[3],3,ji),!c)return null}return new Tu(l,u,c)}evaluate(o){let a=this.lhs.evaluate(o),s=this.rhs.evaluate(o);if(n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!==u.kind||!(l.kind==="string"||l.kind==="number"))throw new ie(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${l.kind}, ${u.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){let l=ue(a),u=ue(s);if(l.kind!=="string"||u.kind!=="string")return t(o,a,s)}return this.collator?r(o,a,s,this.collator.evaluate(o)):t(o,a,s)}eachChild(o){o(this.lhs),o(this.rhs),this.collator&&o(this.collator)}outputDefined(){return!0}}}var Zm=hr("==",Bm,Iu),Wm=hr("!=",zm,$m),Hm=hr("<",Rm,Gm),Xm=hr(">",Om,qm),Km=hr("<=",Nm,jm),Ym=hr(">=",Um,Jm),Ri=class e{constructor(t,r,n){this.type=ji,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=r}static parse(t,r){if(t.length!==2)return r.error("Expected one argument.");let n=t[1];if(typeof n!="object"||Array.isArray(n))return r.error("Collator options argument must be an object.");let i=r.parse(n["case-sensitive"]===void 0?!1:n["case-sensitive"],1,U);if(!i)return null;let o=r.parse(n["diacritic-sensitive"]===void 0?!1:n["diacritic-sensitive"],1,U);if(!o)return null;let a=null;return n.locale&&(a=r.parse(n.locale,1,G),!a)?null:new e(i,o,a)}evaluate(t){return new Kr(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}},Qa=class e{constructor(t,r,n,i,o){this.type=G,this.number=t,this.locale=r,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(t,r){if(t.length!==3)return r.error("Expected two arguments.");let n=r.parse(t[1],1,L);if(!n)return null;let i=t[2];if(typeof i!="object"||Array.isArray(i))return r.error("NumberFormat options argument must be an object.");let o=null;if(i.locale&&(o=r.parse(i.locale,1,G),!o))return null;let a=null;if(i.currency&&(a=r.parse(i.currency,1,G),!a))return null;let s=null;if(i["min-fraction-digits"]&&(s=r.parse(i["min-fraction-digits"],1,L),!s))return null;let l=null;return i["max-fraction-digits"]&&(l=r.parse(i["max-fraction-digits"],1,L),!l)?null:new e(n,o,a,s,l)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}},en=class e{constructor(t){this.type=mr,this.sections=t}static parse(t,r){if(t.length<2)return r.error("Expected at least one argument.");let n=t[1];if(!Array.isArray(n)&&typeof n=="object")return r.error("First argument must be an image or text section.");let i=[],o=!1;for(let a=1;a<=t.length-1;++a){let s=t[a];if(o&&typeof s=="object"&&!Array.isArray(s)){o=!1;let l=null;if(s["font-scale"]&&(l=r.parse(s["font-scale"],1,L),!l))return null;let u=null;if(s["text-font"]&&(u=r.parse(s["text-font"],1,Ee(G)),!u))return null;let c=null;if(s["text-color"]&&(c=r.parse(s["text-color"],1,Re),!c))return null;let p=i[i.length-1];p.scale=l,p.font=u,p.textColor=c}else{let l=r.parse(t[a],1,$);if(!l)return null;let u=l.type.kind;if(u!=="string"&&u!=="value"&&u!=="null"&&u!=="resolvedImage")return r.error("Formatted text type must be \'string\', \'value\', \'image\' or \'null\'.");o=!0,i.push({content:l,scale:null,font:null,textColor:null})}}return new e(i)}evaluate(t){let r=n=>{let i=n.content.evaluate(t);return ue(i)===un?new Yr("",i,null,null,null):new Yr(Zr(i),null,n.scale?n.scale.evaluate(t):null,n.font?n.font.evaluate(t).join(","):null,n.textColor?n.textColor.evaluate(t):null)};return new Fe(this.sections.map(r))}eachChild(t){for(let r of this.sections)t(r.content),r.scale&&t(r.scale),r.font&&t(r.font),r.textColor&&t(r.textColor)}outputDefined(){return!1}},es=class e{constructor(t){this.type=un,this.input=t}static parse(t,r){if(t.length!==2)return r.error("Expected two arguments.");let n=r.parse(t[1],1,G);return n?new e(n):r.error("No image name provided.")}evaluate(t){let r=this.input.evaluate(t),n=Te.fromString(r);return n&&t.availableImages&&(n.available=t.availableImages.indexOf(r)>-1),n}eachChild(t){t(this.input)}outputDefined(){return!1}},ts=class e{constructor(t){this.type=L,this.input=t}static parse(t,r){if(t.length!==2)return r.error(`Expected 1 argument, but found ${t.length-1} instead.`);let n=r.parse(t[1],1);return n?n.type.kind!=="array"&&n.type.kind!=="string"&&n.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${te(n.type)} instead.`):new e(n):null}evaluate(t){let r=this.input.evaluate(t);if(typeof r=="string")return r.length;if(Array.isArray(r))return r.length;throw new ie(`Expected value to be of type string or array, but found ${te(ue(r))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}},Xe=8192;function Qm(e,t){let r=eh(e[0]),n=rh(e[1]),i=Math.pow(2,t.z);return[Math.round(r*i*Xe),Math.round(n*i*Xe)]}function cs(e,t){let r=Math.pow(2,t.z),n=(e[0]/Xe+t.x)/r,i=(e[1]/Xe+t.y)/r;return[th(n),nh(i)]}function eh(e){return(180+e)/360}function th(e){return e*360-180}function rh(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function nh(e){return 360/Math.PI*Math.atan(Math.exp((180-e*360)*Math.PI/180))-90}function cn(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function tn(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ih(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function oh(e,t,r){let n=e[0]-t[0],i=e[1]-t[1],o=e[0]-r[0],a=e[1]-r[1];return n*a-o*i===0&&n*o<=0&&i*a<=0}function Hi(e,t,r,n){let i=[t[0]-e[0],t[1]-e[1]],o=[n[0]-r[0],n[1]-r[1]];return uh(o,i)===0?!1:!!(eu(e,t,r,n)&&eu(r,n,e,t))}function ah(e,t,r){for(let n of r)for(let i=0;i<n.length-1;++i)if(Hi(e,t,n[i],n[i+1]))return!0;return!1}function dr(e,t,r=!1){let n=!1;for(let i of t)for(let o=0;o<i.length-1;o++){if(oh(e,i[o],i[o+1]))return r;ih(e,i[o],i[o+1])&&(n=!n)}return n}function sh(e,t){for(let r of t)if(dr(e,r))return!0;return!1}function Cu(e,t){for(let r of e)if(!dr(r,t))return!1;for(let r=0;r<e.length-1;++r)if(ah(e[r],e[r+1],t))return!1;return!0}function lh(e,t){for(let r of t)if(Cu(e,r))return!0;return!1}function uh(e,t){return e[0]*t[1]-e[1]*t[0]}function eu(e,t,r,n){let i=e[0]-r[0],o=e[1]-r[1],a=t[0]-r[0],s=t[1]-r[1],l=n[0]-r[0],u=n[1]-r[1],c=i*u-l*o,p=a*u-l*s;return c>0&&p<0||c<0&&p>0}function ps(e,t,r){let n=[];for(let i=0;i<e.length;i++){let o=[];for(let a=0;a<e[i].length;a++){let s=Qm(e[i][a],r);cn(t,s),o.push(s)}n.push(o)}return n}function ku(e,t,r){let n=[];for(let i=0;i<e.length;i++){let o=ps(e[i],t,r);n.push(o)}return n}function Mu(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){let i=n*.5,o=e[0]-r[0]>i?-n:r[0]-e[0]>i?n:0;o===0&&(o=e[0]-r[2]>i?-n:r[2]-e[0]>i?n:0),e[0]+=o}cn(t,e)}function ch(e){e[0]=e[1]=1/0,e[2]=e[3]=-1/0}function tu(e,t,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of e)for(let l of s){let u=[l.x+o[0],l.y+o[1]];Mu(u,t,r,i),a.push(u)}return a}function ru(e,t,r,n){let i=Math.pow(2,n.z)*Xe,o=[n.x*Xe,n.y*Xe],a=[];for(let s of e){let l=[];for(let u of s){let c=[u.x+o[0],u.y+o[1]];cn(t,c),l.push(c)}a.push(l)}if(t[2]-t[0]<=i/2){ch(t);for(let s of a)for(let l of s)Mu(l,t,r,i)}return a}function ph(e,t){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(t.type==="Polygon"){let o=ps(t.coordinates,n,i),a=tu(e.geometry(),r,n,i);if(!tn(r,n))return!1;for(let s of a)if(!dr(s,o))return!1}if(t.type==="MultiPolygon"){let o=ku(t.coordinates,n,i),a=tu(e.geometry(),r,n,i);if(!tn(r,n))return!1;for(let s of a)if(!sh(s,o))return!1}return!0}function fh(e,t){let r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(t.type==="Polygon"){let o=ps(t.coordinates,n,i),a=ru(e.geometry(),r,n,i);if(!tn(r,n))return!1;for(let s of a)if(!Cu(s,o))return!1}if(t.type==="MultiPolygon"){let o=ku(t.coordinates,n,i),a=ru(e.geometry(),r,n,i);if(!tn(r,n))return!1;for(let s of a)if(!lh(s,o))return!1}return!0}var rn=class e{constructor(t,r){this.type=U,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`\'within\' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Qr(t[1])){let n=t[1];if(n.type==="FeatureCollection"){let i=[];for(let o of n.features){let{type:a,coordinates:s}=o.geometry;a==="Polygon"&&i.push(s),a==="MultiPolygon"&&i.push(...s)}if(i.length){let o={type:"MultiPolygon",coordinates:i};return new e(n,o)}}else if(n.type==="Feature"){let i=n.geometry.type;if(i==="Polygon"||i==="MultiPolygon")return new e(n,n.geometry)}else if(n.type==="Polygon"||n.type==="MultiPolygon")return new e(n,n)}return r.error("\'within\' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return ph(t,this.geometries);if(t.geometryType()==="LineString")return fh(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}},Oi=class{constructor(t=[],r=yh){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let t=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){let{data:r,compare:n}=this,i=r[t];for(;t>0;){let o=t-1>>1,a=r[o];if(n(i,a)>=0)break;r[t]=a,t=o}r[t]=i}_down(t){let{data:r,compare:n}=this,i=this.length>>1,o=r[t];for(;t<i;){let a=(t<<1)+1,s=r[a],l=a+1;if(l<this.length&&n(r[l],s)<0&&(a=l,s=r[l]),n(s,o)>=0)break;r[t]=s,t=a}r[t]=o}};function yh(e,t){return e<t?-1:e>t?1:0}function mh(e,t,r,n,i){Eu(e,t,r,n||e.length-1,i||hh)}function Eu(e,t,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=t-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(t-a*l/o+u)),p=Math.min(n,Math.floor(t+(o-a)*l/o+u));Eu(e,t,c,p,i)}var f=e[t],y=r,m=n;for(Jr(e,r,t),i(e[n],f)>0&&Jr(e,r,n);y<m;){for(Jr(e,y,m),y++,m--;i(e[y],f)<0;)y++;for(;i(e[m],f)>0;)m--}i(e[r],f)===0?Jr(e,r,m):(m++,Jr(e,m,n)),m<=t&&(r=m+1),t<=m&&(n=m-1)}}function Jr(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function hh(e,t){return e<t?-1:e>t?1:0}function dh(e,t){if(e.length<=1)return[e];let n=[],i,o;for(let a of e){let s=xh(a);s!==0&&(a.area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[a]):i.push(a))}if(i&&n.push(i),t>1)for(let a=0;a<n.length;a++)n[a].length<=t||(mh(n[a],t,1,n[a].length-1,gh),n[a]=n[a].slice(0,t));return n}function gh(e,t){return t.area-e.area}function xh(e){let t=0;for(let r=0,n=e.length,i=n-1,o,a;r<n;i=r++)o=e[r],a=e[i],t+=(a.x-o.x)*(o.y+a.y);return t}var bh=6378.137,nu=1/298.257223563,iu=nu*(2-nu),ou=Math.PI/180,nn=class{constructor(t){let r=ou*bh*1e3,n=Math.cos(t*ou),i=1/(1-iu*(1-n*n)),o=Math.sqrt(i);this.kx=r*o*n,this.ky=r*o*i*(1-iu)}distance(t,r){let n=this.wrap(t[0]-r[0])*this.kx,i=(t[1]-r[1])*this.ky;return Math.sqrt(n*n+i*i)}pointOnLine(t,r){let n=1/0,i,o,a,s;for(let l=0;l<t.length-1;l++){let u=t[l][0],c=t[l][1],p=this.wrap(t[l+1][0]-u)*this.kx,f=(t[l+1][1]-c)*this.ky,y=0;(p!==0||f!==0)&&(y=(this.wrap(r[0]-u)*this.kx*p+(r[1]-c)*this.ky*f)/(p*p+f*f),y>1?(u=t[l+1][0],c=t[l+1][1]):y>0&&(u+=p/this.kx*y,c+=f/this.ky*y)),p=this.wrap(r[0]-u)*this.kx,f=(r[1]-c)*this.ky;let m=p*p+f*f;m<n&&(n=m,i=u,o=c,a=l,s=y)}return{point:[i,o],index:a,t:Math.max(0,Math.min(1,s))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}},rs=100,ns=50;function Fu(e,t){return t[0]-e[0]}function Ni(e){return e[1]-e[0]+1}function st(e,t){return e[1]>=e[0]&&e[1]<t}function is(e,t){if(e[0]>e[1])return[null,null];let r=Ni(e);if(t){if(r===2)return[e,null];let i=Math.floor(r/2);return[[e[0],e[0]+i],[e[0]+i,e[1]]]}if(r===1)return[e,null];let n=Math.floor(r/2)-1;return[[e[0],e[0]+n],[e[0]+n+1,e[1]]]}function os(e,t){if(!st(t,e.length))return[1/0,1/0,-1/0,-1/0];let r=[1/0,1/0,-1/0,-1/0];for(let n=t[0];n<=t[1];++n)cn(r,e[n]);return r}function as(e){let t=[1/0,1/0,-1/0,-1/0];for(let r of e)for(let n of r)cn(t,n);return t}function au(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function fs(e,t,r){if(!au(e)||!au(t))return NaN;let n=0,i=0;return e[2]<t[0]&&(n=t[0]-e[2]),e[0]>t[2]&&(n=e[0]-t[2]),e[1]>t[3]&&(i=e[1]-t[3]),e[3]<t[1]&&(i=t[1]-e[3]),r.distance([0,0],[n,i])}function Bt(e,t,r){let n=r.pointOnLine(t,e);return r.distance(e,n.point)}function ys(e,t,r,n,i){let o=Math.min(Bt(e,[r,n],i),Bt(t,[r,n],i)),a=Math.min(Bt(r,[e,t],i),Bt(n,[e,t],i));return Math.min(o,a)}function vh(e,t,r,n,i){if(!(st(t,e.length)&&st(n,r.length)))return 1/0;let a=1/0;for(let s=t[0];s<t[1];++s){let l=e[s],u=e[s+1];for(let c=n[0];c<n[1];++c){let p=r[c],f=r[c+1];if(Hi(l,u,p,f))return 0;a=Math.min(a,ys(l,u,p,f,i))}}return a}function Ph(e,t,r,n,i){if(!(st(t,e.length)&&st(n,r.length)))return NaN;let a=1/0;for(let s=t[0];s<=t[1];++s)for(let l=n[0];l<=n[1];++l)if(a=Math.min(a,i.distance(e[s],r[l])),a===0)return a;return a}function Sh(e,t,r){if(dr(e,t,!0))return 0;let n=1/0;for(let i of t){let o=i[0],a=i[i.length-1];if(o!==a&&(n=Math.min(n,Bt(e,[a,o],r)),n===0))return n;let s=r.pointOnLine(i,e);if(n=Math.min(n,r.distance(e,s.point)),n===0)return n}return n}function wh(e,t,r,n){if(!st(t,e.length))return NaN;for(let o=t[0];o<=t[1];++o)if(dr(e[o],r,!0))return 0;let i=1/0;for(let o=t[0];o<t[1];++o){let a=e[o],s=e[o+1];for(let l of r)for(let u=0,c=l.length,p=c-1;u<c;p=u++){let f=l[p],y=l[u];if(Hi(a,s,f,y))return 0;i=Math.min(i,ys(a,s,f,y,n))}}return i}function su(e,t){for(let r of e)for(let n of r)if(dr(n,t,!0))return!0;return!1}function Ah(e,t,r,n=1/0){let i=as(e),o=as(t);if(n!==1/0&&fs(i,o,r)>=n)return n;if(tn(i,o)){if(su(e,t))return 0}else if(su(t,e))return 0;let a=1/0;for(let s of e)for(let l=0,u=s.length,c=u-1;l<u;c=l++){let p=s[c],f=s[l];for(let y of t)for(let m=0,h=y.length,d=h-1;m<h;d=m++){let g=y[d],b=y[m];if(Hi(p,f,g,b))return 0;a=Math.min(a,ys(p,f,g,b,r))}}return a}function lu(e,t,r,n,i,o){if(!o)return;let a=fs(os(n,o),i,r);a<t&&e.push([a,o,[0,0]])}function ki(e,t,r,n,i,o,a){if(!o||!a)return;let s=fs(os(n,o),os(i,a),r);s<t&&e.push([s,o,a])}function Ui(e,t,r,n,i=1/0){let o=Math.min(n.distance(e[0],r[0][0]),i);if(o===0)return o;let a=new Oi([[0,[0,e.length-1],[0,0]]],Fu),s=as(r);for(;a.length>0;){let l=a.pop();if(l[0]>=o)continue;let u=l[1],c=t?ns:rs;if(Ni(u)<=c){if(!st(u,e.length))return NaN;if(t){let p=wh(e,u,r,n);if(isNaN(p)||p===0)return p;o=Math.min(o,p)}else for(let p=u[0];p<=u[1];++p){let f=Sh(e[p],r,n);if(o=Math.min(o,f),o===0)return 0}}else{let p=is(u,t);lu(a,o,n,e,s,p[0]),lu(a,o,n,e,s,p[1])}}return o}function $i(e,t,r,n,i,o=1/0){let a=Math.min(o,i.distance(e[0],r[0]));if(a===0)return a;let s=new Oi([[0,[0,e.length-1],[0,r.length-1]]],Fu);for(;s.length>0;){let l=s.pop();if(l[0]>=a)continue;let u=l[1],c=l[2],p=t?ns:rs,f=n?ns:rs;if(Ni(u)<=p&&Ni(c)<=f){if(!st(u,e.length)&&st(c,r.length))return NaN;let y;if(t&&n)y=vh(e,u,r,c,i),a=Math.min(a,y);else if(t&&!n){let m=e.slice(u[0],u[1]+1);for(let h=c[0];h<=c[1];++h)if(y=Bt(r[h],m,i),a=Math.min(a,y),a===0)return a}else if(!t&&n){let m=r.slice(c[0],c[1]+1);for(let h=u[0];h<=u[1];++h)if(y=Bt(e[h],m,i),a=Math.min(a,y),a===0)return a}else y=Ph(e,u,r,c,i),a=Math.min(a,y)}else{let y=is(u,t),m=is(c,n);ki(s,a,i,e,r,y[0],m[0]),ki(s,a,i,e,r,y[0],m[1]),ki(s,a,i,e,r,y[1],m[0]),ki(s,a,i,e,r,y[1],m[1])}}return a}function _h(e,t){let r=e.geometry(),n=r.flat().map(a=>cs([a.x,a.y],e.canonical));if(r.length===0)return NaN;let i=new nn(n[0][1]),o=1/0;for(let a of t){switch(a.type){case"Point":o=Math.min(o,$i(n,!1,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,$i(n,!1,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,Ui(n,!1,a.coordinates,i,o));break}if(o===0)return o}return o}function Ih(e,t){let r=e.geometry(),n=r.flat().map(a=>cs([a.x,a.y],e.canonical));if(r.length===0)return NaN;let i=new nn(n[0][1]),o=1/0;for(let a of t){switch(a.type){case"Point":o=Math.min(o,$i(n,!0,[a.coordinates],!1,i,o));break;case"LineString":o=Math.min(o,$i(n,!0,a.coordinates,!0,i,o));break;case"Polygon":o=Math.min(o,Ui(n,!0,a.coordinates,i,o));break}if(o===0)return o}return o}function Th(e,t){let r=e.geometry();if(r.length===0||r[0].length===0)return NaN;let n=dh(r,0).map(a=>a.map(s=>s.map(l=>cs([l.x,l.y],e.canonical)))),i=new nn(n[0][0][0][1]),o=1/0;for(let a of t)for(let s of n){switch(a.type){case"Point":o=Math.min(o,Ui([a.coordinates],!1,s,i,o));break;case"LineString":o=Math.min(o,Ui(a.coordinates,!0,s,i,o));break;case"Polygon":o=Math.min(o,Ah(s,a.coordinates,i,o));break}if(o===0)return o}return o}function Ga(e){return e.type==="MultiPolygon"?e.coordinates.map(t=>({type:"Polygon",coordinates:t})):e.type==="MultiLineString"?e.coordinates.map(t=>({type:"LineString",coordinates:t})):e.type==="MultiPoint"?e.coordinates.map(t=>({type:"Point",coordinates:t})):[e]}var on=class e{constructor(t,r){this.type=L,this.geojson=t,this.geometries=r}static parse(t,r){if(t.length!==2)return r.error(`\'distance\' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Qr(t[1])){let n=t[1];if(n.type==="FeatureCollection")return new e(n,n.features.map(i=>Ga(i.geometry)).flat());if(n.type==="Feature")return new e(n,Ga(n.geometry));if("type"in n&&"coordinates"in n)return new e(n,Ga(n))}return r.error("\'distance\' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return _h(t,this.geometries);if(t.geometryType()==="LineString")return Ih(t,this.geometries);if(t.geometryType()==="Polygon")return Th(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}},Ut={"==":Zm,"!=":Wm,">":Xm,"<":Hm,">=":Ym,"<=":Km,array:je,at:Za,boolean:je,case:Ka,coalesce:zi,collator:Ri,format:en,image:es,in:Wa,"index-of":Ha,interpolate:Je,"interpolate-hcl":Je,"interpolate-lab":Je,length:ts,let:Di,literal:mt,match:Xa,number:je,"number-format":Qa,object:je,slice:Ya,step:pr,string:je,"to-boolean":yt,"to-color":yt,"to-number":yt,"to-string":yt,var:Vi,within:rn,distance:on},Ke=class e{constructor(t,r,n,i){this.name=t,this.type=r,this._evaluate=n,this.args=i}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,r){let n=t[0],i=e.definitions[n];if(!i)return r.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0);let o=Array.isArray(i)?i[0]:i.type,a=Array.isArray(i)?[[i[1],i[2]]]:i.overloads,s=a.filter(([u])=>!Array.isArray(u)||u.length===t.length-1),l=null;for(let[u,c]of s){l=new Li(r.registry,Gi,r.path,null,r.scope);let p=[],f=!1;for(let y=1;y<t.length;y++){let m=t[y],h=Array.isArray(u)?u[y-1]:u.type,d=l.parse(m,1+p.length,h);if(!d){f=!0;break}p.push(d)}if(!f){if(Array.isArray(u)&&u.length!==p.length){l.error(`Expected ${u.length} arguments, but found ${p.length} instead.`);continue}for(let y=0;y<p.length;y++){let m=Array.isArray(u)?u[y]:u.type,h=p[y];l.concat(y+1).checkSubtype(m,h.type)}if(l.errors.length===0)return new e(n,o,c,p)}}if(s.length===1)r.errors.push(...l.errors);else{let c=(s.length?s:a).map(([f])=>kh(f)).join(" | "),p=[];for(let f=1;f<t.length;f++){let y=r.parse(t[f],1+p.length);if(!y)return null;p.push(te(y.type))}r.error(`Expected arguments of type ${c}, but found (${p.join(", ")}) instead.`)}return null}static register(t,r){e.definitions=r;for(let n in r)t[n]=e}};function uu(e,[t,r,n,i]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);let o=i?i.evaluate(e):1,a=Au(t,r,n,o);if(a)throw new ie(a);return new W(t/255,r/255,n/255,o,!1)}function cu(e,t){return e in t}function qa(e,t){let r=t[e];return typeof r>"u"?null:r}function Ch(e,t,r,n){for(;r<=n;){let i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}function Vt(e){return{type:e}}Ke.register(Ut,{error:[gm,[G],(e,[t])=>{throw new ie(t.evaluate(e))}],typeof:[G,[$],(e,[t])=>te(ue(t.evaluate(e)))],"to-rgba":[Ee(L,4),[Re],(e,[t])=>{let[r,n,i,o]=t.evaluate(e).rgb;return[r*255,n*255,i*255,o]}],rgb:[Re,[L,L,L],uu],rgba:[Re,[L,L,L,L],uu],has:{type:U,overloads:[[[G],(e,[t])=>cu(t.evaluate(e),e.properties())],[[G,lr],(e,[t,r])=>cu(t.evaluate(e),r.evaluate(e))]]},get:{type:$,overloads:[[[G],(e,[t])=>qa(t.evaluate(e),e.properties())],[[G,lr],(e,[t,r])=>qa(t.evaluate(e),r.evaluate(e))]]},"feature-state":[$,[G],(e,[t])=>qa(t.evaluate(e),e.featureState||{})],properties:[lr,[],e=>e.properties()],"geometry-type":[G,[],e=>e.geometryType()],id:[$,[],e=>e.id()],zoom:[L,[],e=>e.globals.zoom],"heatmap-density":[L,[],e=>e.globals.heatmapDensity||0],"line-progress":[L,[],e=>e.globals.lineProgress||0],accumulated:[$,[],e=>e.globals.accumulated===void 0?null:e.globals.accumulated],"+":[L,Vt(L),(e,t)=>{let r=0;for(let n of t)r+=n.evaluate(e);return r}],"*":[L,Vt(L),(e,t)=>{let r=1;for(let n of t)r*=n.evaluate(e);return r}],"-":{type:L,overloads:[[[L,L],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[L],(e,[t])=>-t.evaluate(e)]]},"/":[L,[L,L],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[L,[L,L],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[L,[],()=>Math.LN2],pi:[L,[],()=>Math.PI],e:[L,[],()=>Math.E],"^":[L,[L,L],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[L,[L],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[L,[L],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[L,[L],(e,[t])=>Math.log(t.evaluate(e))],log2:[L,[L],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[L,[L],(e,[t])=>Math.sin(t.evaluate(e))],cos:[L,[L],(e,[t])=>Math.cos(t.evaluate(e))],tan:[L,[L],(e,[t])=>Math.tan(t.evaluate(e))],asin:[L,[L],(e,[t])=>Math.asin(t.evaluate(e))],acos:[L,[L],(e,[t])=>Math.acos(t.evaluate(e))],atan:[L,[L],(e,[t])=>Math.atan(t.evaluate(e))],min:[L,Vt(L),(e,t)=>Math.min(...t.map(r=>r.evaluate(e)))],max:[L,Vt(L),(e,t)=>Math.max(...t.map(r=>r.evaluate(e)))],abs:[L,[L],(e,[t])=>Math.abs(t.evaluate(e))],round:[L,[L],(e,[t])=>{let r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[L,[L],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[L,[L],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[U,[G,$],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[U,[$],(e,[t])=>e.id()===t.value],"filter-type-==":[U,[G],(e,[t])=>e.geometryType()===t.value],"filter-<":[U,[G,$],(e,[t,r])=>{let n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[U,[$],(e,[t])=>{let r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[U,[G,$],(e,[t,r])=>{let n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[U,[$],(e,[t])=>{let r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[U,[G,$],(e,[t,r])=>{let n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[U,[$],(e,[t])=>{let r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[U,[G,$],(e,[t,r])=>{let n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[U,[$],(e,[t])=>{let r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[U,[$],(e,[t])=>t.value in e.properties()],"filter-has-id":[U,[],e=>e.id()!==null&&e.id()!==void 0],"filter-type-in":[U,[Ee(G)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[U,[Ee($)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[U,[G,Ee($)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[U,[G,Ee($)],(e,[t,r])=>Ch(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:U,overloads:[[[U,U],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Vt(U),(e,t)=>{for(let r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:U,overloads:[[[U,U],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Vt(U),(e,t)=>{for(let r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[U,[U],(e,[t])=>!t.evaluate(e)],"is-supported-script":[U,[G],(e,[t])=>{let r=e.globals&&e.globals.isSupportedScript;return r?r(t.evaluate(e)):!0}],upcase:[G,[G],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[G,[G],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[G,Vt($),(e,t)=>t.map(r=>Zr(r.evaluate(e))).join("")],"resolved-locale":[G,[ji],(e,[t])=>t.evaluate(e).resolvedLocale()]});function kh(e){return Array.isArray(e)?`(${e.map(te).join(", ")})`:`(${te(e.type)}...)`}function Gi(e){if(e instanceof Vi)return Gi(e.boundExpression);if(e instanceof Ke&&e.name==="error")return!1;if(e instanceof Ri)return!1;if(e instanceof rn)return!1;if(e instanceof on)return!1;let t=e instanceof yt||e instanceof je,r=!0;return e.eachChild(n=>{t?r=r&&Gi(n):r=r&&n instanceof mt}),r?Xi(e)&&Ki(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Xi(e){if(e instanceof Ke){if(e.name==="get"&&e.args.length===1)return!1;if(e.name==="feature-state")return!1;if(e.name==="has"&&e.args.length===1)return!1;if(e.name==="properties"||e.name==="geometry-type"||e.name==="id")return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof rn||e instanceof on)return!1;let t=!0;return e.eachChild(r=>{t&&!Xi(r)&&(t=!1)}),t}function an(e){if(e instanceof Ke&&e.name==="feature-state")return!1;let t=!0;return e.eachChild(r=>{t&&!an(r)&&(t=!1)}),t}function Ki(e,t){if(e instanceof Ke&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild(n=>{r&&!Ki(n,t)&&(r=!1)}),r}function ss(e){return{result:"success",value:e}}function sr(e){return{result:"error",value:e}}function ht(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function Lu(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ms(e){return!!e.expression&&e.expression.interpolated}function j(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Yi(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function Mh(e){return e}function Du(e,t){let r=t.type==="color",n=e.stops&&typeof e.stops[0][0]=="object",i=n||e.property!==void 0,o=n||!i,a=e.type||(ms(t)?"exponential":"interval");if(r||t.type==="padding"){let c=r?W.parse:Ze.parse;e=cr({},e),e.stops&&(e.stops=e.stops.map(p=>[p[0],c(p[1])])),e.default?e.default=c(e.default):e.default=c(t.default)}if(e.colorSpace&&!Fm(e.colorSpace))throw new Error(`Unknown color space: "${e.colorSpace}"`);let s,l,u;if(a==="exponential")s=pu;else if(a==="interval")s=Fh;else if(a==="categorical"){s=Eh,l=Object.create(null);for(let c of e.stops)l[c[0]]=c[1];u=typeof e.stops[0][0]}else if(a==="identity")s=Lh;else throw new Error(`Unknown function type "${a}"`);if(n){let c={},p=[];for(let m=0;m<e.stops.length;m++){let h=e.stops[m],d=h[0].zoom;c[d]===void 0&&(c[d]={zoom:d,type:e.type,property:e.property,default:e.default,stops:[]},p.push(d)),c[d].stops.push([h[0].value,h[1]])}let f=[];for(let m of p)f.push([c[m].zoom,Du(c[m],t)]);let y={name:"linear"};return{kind:"composite",interpolationType:y,interpolationFactor:Je.interpolationFactor.bind(void 0,y),zoomStops:f.map(m=>m[0]),evaluate({zoom:m},h){return pu({stops:f,base:e.base},t,m).evaluate(m,h)}}}else if(o){let c=a==="exponential"?{name:"exponential",base:e.base!==void 0?e.base:1}:null;return{kind:"camera",interpolationType:c,interpolationFactor:Je.interpolationFactor.bind(void 0,c),zoomStops:e.stops.map(p=>p[0]),evaluate:({zoom:p})=>s(e,t,p,l,u)}}else return{kind:"source",evaluate(c,p){let f=p&&p.properties?p.properties[e.property]:void 0;return f===void 0?pn(e.default,t.default):s(e,t,f,l,u)}}}function pn(e,t,r){if(e!==void 0)return e;if(t!==void 0)return t;if(r!==void 0)return r}function Eh(e,t,r,n,i){let o=typeof r===i?n[r]:void 0;return pn(o,e.default,t.default)}function Fh(e,t,r){if(j(r)!=="number")return pn(e.default,t.default);let n=e.stops.length;if(n===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];let i=Wi(e.stops.map(o=>o[0]),r);return e.stops[i][1]}function pu(e,t,r){let n=e.base!==void 0?e.base:1;if(j(r)!=="number")return pn(e.default,t.default);let i=e.stops.length;if(i===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];let o=Wi(e.stops.map(c=>c[0]),r),a=Dh(r,n,e.stops[o][0],e.stops[o+1][0]),s=e.stops[o][1],l=e.stops[o+1][1],u=Oe[t.type]||Mh;return typeof s.evaluate=="function"?{evaluate(...c){let p=s.evaluate.apply(void 0,c),f=l.evaluate.apply(void 0,c);if(!(p===void 0||f===void 0))return u(p,f,a,e.colorSpace)}}:u(s,l,a,e.colorSpace)}function Lh(e,t,r){switch(t.type){case"color":r=W.parse(r);break;case"formatted":r=Fe.fromString(r.toString());break;case"resolvedImage":r=Te.fromString(r.toString());break;case"padding":r=Ze.parse(r);break;default:j(r)!==t.type&&(t.type!=="enum"||!t.values[r])&&(r=void 0)}return pn(r,e.default,t.default)}function Dh(e,t,r,n){let i=n-r,o=e-r;return i===0?0:t===1?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}var Rt=class{constructor(t,r){this.expression=t,this._warningHistory={},this._evaluator=new Fi,this._defaultValue=r?Bh(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(t,r,n,i,o,a){return this._evaluator.globals=t,this._evaluator.feature=r,this._evaluator.featureState=n,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(t,r,n,i,o,a){this._evaluator.globals=t,this._evaluator.feature=r||null,this._evaluator.featureState=n||null,this._evaluator.canonical=i,this._evaluator.availableImages=o||null,this._evaluator.formattedSection=a||null;try{let s=this.expression.evaluate(this._evaluator);if(s==null||typeof s=="number"&&s!==s)return this._defaultValue;if(this._enumValues&&!(s in this._enumValues))throw new ie(`Expected value to be one of ${Object.keys(this._enumValues).map(l=>JSON.stringify(l)).join(", ")}, but found ${JSON.stringify(s)} instead.`);return s}catch(s){return this._warningHistory[s.message]||(this._warningHistory[s.message]=!0,typeof console<"u"&&console.warn(s.message)),this._defaultValue}}};function $t(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Ut}function Gt(e,t){let r=new Li(Ut,Gi,[],t?Vh(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return n?ss(new Rt(n,t)):sr(r.errors)}var dt=class{constructor(t,r){this.kind=t,this._styleExpression=r,this.isStateDependent=t!=="constant"&&!an(r.expression)}evaluateWithoutErrorHandling(t,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(t,r,n,i,o,a)}evaluate(t,r,n,i,o,a){return this._styleExpression.evaluate(t,r,n,i,o,a)}},gt=class{constructor(t,r,n,i){this.kind=t,this.zoomStops=n,this._styleExpression=r,this.isStateDependent=t!=="camera"&&!an(r.expression),this.interpolationType=i}evaluateWithoutErrorHandling(t,r,n,i,o,a){return this._styleExpression.evaluateWithoutErrorHandling(t,r,n,i,o,a)}evaluate(t,r,n,i,o,a){return this._styleExpression.evaluate(t,r,n,i,o,a)}interpolationFactor(t,r,n){return this.interpolationType?Je.interpolationFactor(this.interpolationType,t,r,n):0}};function Vu(e,t){let r=Gt(e,t);if(r.result==="error")return r;let n=r.value.expression,i=Xi(n);if(!i&&!ht(t))return sr([new Be("","data expressions not supported")]);let o=Ki(n,["zoom"]);if(!o&&!Lu(t))return sr([new Be("","zoom expressions not supported")]);let a=Ei(n);if(!a&&!o)return sr([new Be("",\'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.\')]);if(a instanceof Be)return sr([a]);if(a instanceof Je&&!ms(t))return sr([new Be("",\'"interpolate" expressions cannot be used with this property\')]);if(!a)return ss(i?new dt("constant",r.value):new dt("source",r.value));let s=a instanceof Je?a.interpolation:void 0;return ss(i?new gt("camera",r.value,a.labels,s):new gt("composite",r.value,a.labels,s))}var sn=class e{constructor(t,r){this._parameters=t,this._specification=r,cr(this,Du(this._parameters,this._specification))}static deserialize(t){return new e(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}};function Bu(e,t){if(Yi(e))return new sn(e,t);if($t(e)){let r=Vu(e,t);if(r.result==="error")throw new Error(r.value.map(n=>`${n.key}: ${n.message}`).join(", "));return r.value}else{let r=e;return t.type==="color"&&typeof e=="string"?r=W.parse(e):t.type==="padding"&&(typeof e=="number"||Array.isArray(e))?r=Ze.parse(e):t.type==="variableAnchorOffsetCollection"&&Array.isArray(e)&&(r=Ne.parse(e)),{kind:"constant",evaluate:()=>r}}}function Ei(e){let t=null;if(e instanceof Di)t=Ei(e.result);else if(e instanceof zi){for(let r of e.args)if(t=Ei(r),t)break}else(e instanceof pr||e instanceof Je)&&e.input instanceof Ke&&e.input.name==="zoom"&&(t=e);return t instanceof Be||e.eachChild(r=>{let n=Ei(r);n instanceof Be?t=n:!t&&n?t=new Be("",\'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.\'):t&&n&&t!==n&&(t=new Be("",\'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.\'))}),t}function Vh(e){let t={color:Re,string:G,number:L,enum:G,boolean:U,formatted:mr,padding:Ji,resolvedImage:un,variableAnchorOffsetCollection:Zi};return e.type==="array"?Ee(t[e.value]||$,e.length):t[e.type]}function Bh(e){return e.type==="color"&&Yi(e.default)?new W(0,0,0,0):e.type==="color"?W.parse(e.default)||null:e.type==="padding"?Ze.parse(e.default)||null:e.type==="variableAnchorOffsetCollection"?Ne.parse(e.default)||null:e.default===void 0?null:e.default}function hs(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(let t of e.slice(1))if(!hs(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}var zh={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function fn(e){if(e==null)return{filter:()=>!0,needGeometry:!1};hs(e)||(e=qi(e));let t=Gt(e,zh);if(t.result==="error")throw new Error(t.value.map(r=>`${r.key}: ${r.message}`).join(", "));{let r=zu(e);return{filter:(n,i,o)=>t.value.evaluate(n,i,{},o),needGeometry:r}}}function Rh(e,t){return e<t?-1:e>t?1:0}function zu(e){if(!Array.isArray(e))return!1;if(e[0]==="within"||e[0]==="distance")return!0;for(let t=1;t<e.length;t++)if(zu(e[t]))return!0;return!1}function qi(e){if(!e)return!0;let t=e[0];return e.length<=1?t!=="any":t==="=="?ja(e[1],e[2],"=="):t==="!="?Mi(ja(e[1],e[2],"==")):t==="<"||t===">"||t==="<="||t===">="?ja(e[1],e[2],t):t==="any"?Oh(e.slice(1)):t==="all"?["all"].concat(e.slice(1).map(qi)):t==="none"?["all"].concat(e.slice(1).map(qi).map(Mi)):t==="in"?fu(e[1],e.slice(2)):t==="!in"?Mi(fu(e[1],e.slice(2))):t==="has"?yu(e[1]):t==="!has"?Mi(yu(e[1])):!0}function ja(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function Oh(e){return["any"].concat(e.map(qi))}function fu(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(r=>typeof r!=typeof t[0])?["filter-in-large",e,["literal",t.sort(Rh)]]:["filter-in-small",e,["literal",t]]}}function yu(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function Mi(e){return["!",e]}function ls(e){let t=typeof e;if(t==="number"||t==="boolean"||t==="string"||e===void 0||e===null)return JSON.stringify(e);if(Array.isArray(e)){let i="[";for(let o of e)i+=`${ls(o)},`;return`${i}]`}let r=Object.keys(e).sort(),n="{";for(let i=0;i<r.length;i++)n+=`${JSON.stringify(r[i])}:${ls(e[r[i]])},`;return`${n}}`}function Nh(e){let t="";for(let r of dm)t+=`/${ls(e[r])}`;return t}function Ru(e,t){let r={};for(let i=0;i<e.length;i++){let o=t&&t[e[i].id]||Nh(e[i]);t&&(t[e[i].id]=o);let a=r[o];a||(a=r[o]=[]),a.push(e[i])}let n=[];for(let i in r)n.push(r[i]);return n}function Ou(e){let t=e.key,r=e.value;return r?[new M(t,r,"constants have been deprecated as of v8")]:[]}function ae(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ot(e){if(Array.isArray(e))return e.map(Ot);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){let t={};for(let r in e)t[r]=Ot(e[r]);return t}return ae(e)}function ze(e){let t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},o=e.style,a=e.styleSpec,s=e.validateSpec,l=[],u=j(r);if(u!=="object")return[new M(t,r,`object expected, ${u} found`)];for(let c in r){let p=c.split(".")[0],f=n[p]||n["*"],y;if(i[p])y=i[p];else if(n[p])y=s;else if(i["*"])y=i["*"];else if(n["*"])y=s;else{l.push(new M(t,r[c],`unknown property "${c}"`));continue}l=l.concat(y({key:(t&&`${t}.`)+c,value:r[c],valueSpec:f,style:o,styleSpec:a,object:r,objectKey:c,validateSpec:s},r))}for(let c in n)i[c]||n[c].required&&n[c].default===void 0&&r[c]===void 0&&l.push(new M(t,r,`missing required property "${c}"`));return l}function ds(e){let t=e.value,r=e.valueSpec,n=e.validateSpec,i=e.style,o=e.styleSpec,a=e.key,s=e.arrayElementValidator||n;if(j(t)!=="array")return[new M(a,t,`array expected, ${j(t)} found`)];if(r.length&&t.length!==r.length)return[new M(a,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new M(a,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let l={type:r.value,values:r.values};o.$version<7&&(l.function=r.function),j(r.value)==="object"&&(l=r.value);let u=[];for(let c=0;c<t.length;c++)u=u.concat(s({array:t,arrayIndex:c,value:t[c],valueSpec:l,validateSpec:e.validateSpec,style:i,styleSpec:o,key:`${a}[${c}]`}));return u}function gs(e){let t=e.key,r=e.value,n=e.valueSpec,i=j(r);return i==="number"&&r!==r&&(i="NaN"),i!=="number"?[new M(t,r,`number expected, ${i} found`)]:"minimum"in n&&r<n.minimum?[new M(t,r,`${r} is less than the minimum value ${n.minimum}`)]:"maximum"in n&&r>n.maximum?[new M(t,r,`${r} is greater than the maximum value ${n.maximum}`)]:[]}function Nu(e){let t=e.valueSpec,r=ae(e.value.type),n,i={},o,a,s=r!=="categorical"&&e.value.property===void 0,l=!s,u=j(e.value.stops)==="array"&&j(e.value.stops[0])==="array"&&j(e.value.stops[0][0])==="object",c=ze({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:p,default:m}});return r==="identity"&&s&&c.push(new M(e.key,e.value,\'missing required property "property"\')),r!=="identity"&&!e.value.stops&&c.push(new M(e.key,e.value,\'missing required property "stops"\')),r==="exponential"&&e.valueSpec.expression&&!ms(e.valueSpec)&&c.push(new M(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!ht(e.valueSpec)?c.push(new M(e.key,e.value,"property functions not supported")):s&&!Lu(e.valueSpec)&&c.push(new M(e.key,e.value,"zoom functions not supported"))),(r==="categorical"||u)&&e.value.property===void 0&&c.push(new M(e.key,e.value,\'"property" property is required\')),c;function p(h){if(r==="identity")return[new M(h.key,h.value,\'identity function may not have a "stops" property\')];let d=[],g=h.value;return d=d.concat(ds({key:h.key,value:g,valueSpec:h.valueSpec,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,arrayElementValidator:f})),j(g)==="array"&&g.length===0&&d.push(new M(h.key,g,"array must have at least one stop")),d}function f(h){let d=[],g=h.value,b=h.key;if(j(g)!=="array")return[new M(b,g,`array expected, ${j(g)} found`)];if(g.length!==2)return[new M(b,g,`array length 2 expected, length ${g.length} found`)];if(u){if(j(g[0])!=="object")return[new M(b,g,`object expected, ${j(g[0])} found`)];if(g[0].zoom===void 0)return[new M(b,g,"object stop key must have zoom")];if(g[0].value===void 0)return[new M(b,g,"object stop key must have value")];if(a&&a>ae(g[0].zoom))return[new M(b,g[0].zoom,"stop zoom values must appear in ascending order")];ae(g[0].zoom)!==a&&(a=ae(g[0].zoom),o=void 0,i={}),d=d.concat(ze({key:`${b}[0]`,value:g[0],valueSpec:{zoom:{}},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec,objectElementValidators:{zoom:gs,value:y}}))}else d=d.concat(y({key:`${b}[0]`,value:g[0],valueSpec:{},validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec},g));return $t(Ot(g[1]))?d.concat([new M(`${b}[1]`,g[1],"expressions are not allowed in function stops.")]):d.concat(h.validateSpec({key:`${b}[1]`,value:g[1],valueSpec:t,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec}))}function y(h,d){let g=j(h.value),b=ae(h.value),x=h.value!==null?h.value:d;if(!n)n=g;else if(g!==n)return[new M(h.key,x,`${g} stop domain type must match previous stop domain type ${n}`)];if(g!=="number"&&g!=="string"&&g!=="boolean")return[new M(h.key,x,"stop domain value must be a number, string, or boolean")];if(g!=="number"&&r!=="categorical"){let v=`number expected, ${g} found`;return ht(t)&&r===void 0&&(v+=\'\\nIf you intended to use a categorical function, specify `"type": "categorical"`.\'),[new M(h.key,x,v)]}return r==="categorical"&&g==="number"&&(!isFinite(b)||Math.floor(b)!==b)?[new M(h.key,x,`integer expected, found ${b}`)]:r!=="categorical"&&g==="number"&&o!==void 0&&b<o?[new M(h.key,x,"stop domain values must appear in ascending order")]:(o=b,r==="categorical"&&b in i?[new M(h.key,x,"stop domain values must be unique")]:(i[b]=!0,[]))}function m(h){return h.validateSpec({key:h.key,value:h.value,valueSpec:t,validateSpec:h.validateSpec,style:h.style,styleSpec:h.styleSpec})}}function fr(e){let t=(e.expressionContext==="property"?Vu:Gt)(Ot(e.value),e.valueSpec);if(t.result==="error")return t.value.map(n=>new M(`${e.key}${n.key}`,e.value,n.message));let r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new M(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!an(r))return[new M(e.key,e.value,\'"feature-state" data expressions are not supported with layout properties.\')];if(e.expressionContext==="filter"&&!an(r))return[new M(e.key,e.value,\'"feature-state" data expressions are not supported with filters.\')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Ki(r,["zoom","feature-state"]))return[new M(e.key,e.value,\'"zoom" and "feature-state" expressions are not supported with cluster properties.\')];if(e.expressionContext==="cluster-initial"&&!Xi(r))return[new M(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Uh(e){let t=e.value,r=e.key,n=j(t);return n!=="boolean"?[new M(r,t,`boolean expected, ${n} found`)]:[]}function $h(e){let t=e.key,r=e.value,n=j(r);return n!=="string"?[new M(t,r,`color expected, ${n} found`)]:W.parse(String(r))?[]:[new M(t,r,`color expected, "${r}" found`)]}function ln(e){let t=e.key,r=e.value,n=e.valueSpec,i=[];return Array.isArray(n.values)?n.values.indexOf(ae(r))===-1&&i.push(new M(t,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(n.values).indexOf(ae(r))===-1&&i.push(new M(t,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),i}function xs(e){return hs(Ot(e.value))?fr(cr({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Uu(e)}function Uu(e){let t=e.value,r=e.key;if(j(t)!=="array")return[new M(r,t,`array expected, ${j(t)} found`)];let n=e.styleSpec,i,o=[];if(t.length<1)return[new M(r,t,"filter array must have at least 1 element")];switch(o=o.concat(ln({key:`${r}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),ae(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ae(t[1])==="$type"&&o.push(new M(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&o.push(new M(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(i=j(t[1]),i!=="string"&&o.push(new M(`${r}[1]`,t[1],`string expected, ${i} found`)));for(let a=2;a<t.length;a++)i=j(t[a]),ae(t[1])==="$type"?o=o.concat(ln({key:`${r}[${a}]`,value:t[a],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):i!=="string"&&i!=="number"&&i!=="boolean"&&o.push(new M(`${r}[${a}]`,t[a],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let a=1;a<t.length;a++)o=o.concat(Uu({key:`${r}[${a}]`,value:t[a],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=j(t[1]),t.length!==2?o.push(new M(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):i!=="string"&&o.push(new M(`${r}[1]`,t[1],`string expected, ${i} found`));break}return o}function $u(e,t){let r=e.key,n=e.validateSpec,i=e.style,o=e.styleSpec,a=e.value,s=e.objectKey,l=o[`${t}_${e.layerType}`];if(!l)return[];let u=s.match(/^(.*)-transition$/);if(t==="paint"&&u&&l[u[1]]&&l[u[1]].transition)return n({key:r,value:a,valueSpec:o.transition,style:i,styleSpec:o});let c=e.valueSpec||l[s];if(!c)return[new M(r,a,`unknown property "${s}"`)];let p;if(j(a)==="string"&&ht(c)&&!c.tokens&&(p=/^{([^}]+)}$/.exec(a)))return[new M(r,a,`"${s}" does not support interpolation syntax\nUse an identity property function instead: \\`{ "type": "identity", "property": ${JSON.stringify(p[1])} }\\`.`)];let f=[];return e.layerType==="symbol"&&(s==="text-field"&&i&&!i.glyphs&&f.push(new M(r,a,\'use of "text-field" requires a style "glyphs" property\')),s==="text-font"&&Yi(Ot(a))&&ae(a.type)==="identity"&&f.push(new M(r,a,\'"text-font" does not support identity functions\'))),f.concat(n({key:e.key,value:a,valueSpec:c,style:i,styleSpec:o,expressionContext:"property",propertyType:t,propertyKey:s}))}function Gu(e){return $u(e,"paint")}function qu(e){return $u(e,"layout")}function ju(e){let t=[],r=e.value,n=e.key,i=e.style,o=e.styleSpec;!r.type&&!r.ref&&t.push(new M(n,r,\'either "type" or "ref" is required\'));let a=ae(r.type),s=ae(r.ref);if(r.id){let l=ae(r.id);for(let u=0;u<e.arrayIndex;u++){let c=i.layers[u];ae(c.id)===l&&t.push(new M(n,r.id,`duplicate layer id "${r.id}", previously used at line ${c.id.__line__}`))}}if("ref"in r){["type","source","source-layer","filter","layout"].forEach(u=>{u in r&&t.push(new M(n,r[u],`"${u}" is prohibited for ref layers`))});let l;i.layers.forEach(u=>{ae(u.id)===s&&(l=u)}),l?l.ref?t.push(new M(n,r.ref,"ref cannot reference another ref layer")):a=ae(l.type):t.push(new M(n,r.ref,`ref layer "${s}" not found`))}else if(a!=="background")if(!r.source)t.push(new M(n,r,\'missing required property "source"\'));else{let l=i.sources&&i.sources[r.source],u=l&&ae(l.type);l?u==="vector"&&a==="raster"?t.push(new M(n,r.source,`layer "${r.id}" requires a raster source`)):u!=="raster-dem"&&a==="hillshade"?t.push(new M(n,r.source,`layer "${r.id}" requires a raster-dem source`)):u==="raster"&&a!=="raster"?t.push(new M(n,r.source,`layer "${r.id}" requires a vector source`)):u==="vector"&&!r["source-layer"]?t.push(new M(n,r,`layer "${r.id}" must specify a "source-layer"`)):u==="raster-dem"&&a!=="hillshade"?t.push(new M(n,r.source,"raster-dem source can only be used with layer type \'hillshade\'.")):a==="line"&&r.paint&&r.paint["line-gradient"]&&(u!=="geojson"||!l.lineMetrics)&&t.push(new M(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \\`lineMetrics\\` enabled.`)):t.push(new M(n,r.source,`source "${r.source}" not found`))}return t=t.concat(ze({key:n,value:r,valueSpec:o.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*"(){return[]},type(){return e.validateSpec({key:`${n}.type`,value:r.type,valueSpec:o.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:r,objectKey:"type"})},filter:xs,layout(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return qu(cr({layerType:a},u))}}})},paint(l){return ze({layer:r,key:l.key,value:l.value,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*"(u){return Gu(cr({layerType:a},u))}}})}}})),t}function Nt(e){let t=e.value,r=e.key,n=j(t);return n!=="string"?[new M(r,t,`string expected, ${n} found`)]:[]}function Gh(e){var t;let r=(t=e.sourceName)!==null&&t!==void 0?t:"",n=e.value,i=e.styleSpec,o=i.source_raster_dem,a=e.style,s=[],l=j(n);if(n===void 0)return s;if(l!=="object")return s.push(new M("source_raster_dem",n,`object expected, ${l} found`)),s;let c=ae(n.encoding)==="custom",p=["redFactor","greenFactor","blueFactor","baseShift"],f=e.value.encoding?`"${e.value.encoding}"`:"Default";for(let y in n)!c&&p.includes(y)?s.push(new M(y,n[y],`In "${r}": "${y}" is only valid when "encoding" is set to "custom". ${f} encoding found`)):o[y]?s=s.concat(e.validateSpec({key:y,value:n[y],valueSpec:o[y],validateSpec:e.validateSpec,style:a,styleSpec:i})):s.push(new M(y,n[y],`unknown property "${y}"`));return s}var mu={promoteId:qh};function Ju(e){let t=e.value,r=e.key,n=e.styleSpec,i=e.style,o=e.validateSpec;if(!t.type)return[new M(r,t,\'"type" is required\')];let a=ae(t.type),s;switch(a){case"vector":case"raster":return s=ze({key:r,value:t,valueSpec:n[`source_${a.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:mu,validateSpec:o}),s;case"raster-dem":return s=Gh({sourceName:r,value:t,style:e.style,styleSpec:n,validateSpec:o}),s;case"geojson":if(s=ze({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n,validateSpec:o,objectElementValidators:mu}),t.cluster)for(let l in t.clusterProperties){let[u,c]=t.clusterProperties[l],p=typeof u=="string"?[u,["accumulated"],["get",l]]:u;s.push(...fr({key:`${r}.${l}.map`,value:c,validateSpec:o,expressionContext:"cluster-map"})),s.push(...fr({key:`${r}.${l}.reduce`,value:p,validateSpec:o,expressionContext:"cluster-reduce"}))}return s;case"video":return ze({key:r,value:t,valueSpec:n.source_video,style:i,validateSpec:o,styleSpec:n});case"image":return ze({key:r,value:t,valueSpec:n.source_image,style:i,validateSpec:o,styleSpec:n});case"canvas":return[new M(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ln({key:`${r}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,validateSpec:o,styleSpec:n})}}function qh({key:e,value:t}){if(j(t)==="string")return Nt({key:e,value:t});{let r=[];for(let n in t)r.push(...Nt({key:`${e}.${n}`,value:t[n]}));return r}}function Zu(e){let t=e.value,r=e.styleSpec,n=r.light,i=e.style,o=[],a=j(t);if(t===void 0)return o;if(a!=="object")return o=o.concat([new M("light",t,`object expected, ${a} found`)]),o;for(let s in t){let l=s.match(/^(.*)-transition$/);l&&n[l[1]]&&n[l[1]].transition?o=o.concat(e.validateSpec({key:s,value:t[s],valueSpec:r.transition,validateSpec:e.validateSpec,style:i,styleSpec:r})):n[s]?o=o.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,t[s],`unknown property "${s}"`)])}return o}function Wu(e){let t=e.value,r=e.styleSpec,n=r.sky,i=e.style,o=j(t);if(t===void 0)return[];if(o!=="object")return[new M("sky",t,`object expected, ${o} found`)];let a=[];for(let s in t)n[s]?a=a.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,t[s],`unknown property "${s}"`)]);return a}function Hu(e){let t=e.value,r=e.styleSpec,n=r.terrain,i=e.style,o=[],a=j(t);if(t===void 0)return o;if(a!=="object")return o=o.concat([new M("terrain",t,`object expected, ${a} found`)]),o;for(let s in t)n[s]?o=o.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],validateSpec:e.validateSpec,style:i,styleSpec:r})):o=o.concat([new M(s,t[s],`unknown property "${s}"`)]);return o}function jh(e){return Nt(e).length===0?[]:fr(e)}function Jh(e){return Nt(e).length===0?[]:fr(e)}function Zh(e){let t=e.key,r=e.value;if(j(r)==="array"){if(r.length<1||r.length>4)return[new M(t,r,`padding requires 1 to 4 values; ${r.length} values found`)];let i={type:"number"},o=[];for(let a=0;a<r.length;a++)o=o.concat(e.validateSpec({key:`${t}[${a}]`,value:r[a],validateSpec:e.validateSpec,valueSpec:i}));return o}else return gs({key:t,value:r,valueSpec:{}})}function Wh(e){let t=e.key,r=e.value,n=j(r),i=e.styleSpec;if(n!=="array"||r.length<1||r.length%2!==0)return[new M(t,r,"variableAnchorOffsetCollection requires a non-empty array of even length")];let o=[];for(let a=0;a<r.length;a+=2)o=o.concat(ln({key:`${t}[${a}]`,value:r[a],valueSpec:i.layout_symbol["text-anchor"]})),o=o.concat(ds({key:`${t}[${a+1}]`,value:r[a+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:i}));return o}function Xu(e){let t=[],r=e.value,n=e.key;if(Array.isArray(r)){let i=[],o=[];for(let a in r){r[a].id&&i.includes(r[a].id)&&t.push(new M(n,r,`all the sprites\' ids must be unique, but ${r[a].id} is duplicated`)),i.push(r[a].id),r[a].url&&o.includes(r[a].url)&&t.push(new M(n,r,`all the sprites\' URLs must be unique, but ${r[a].url} is duplicated`)),o.push(r[a].url);let s={id:{type:"string",required:!0},url:{type:"string",required:!0}};t=t.concat(ze({key:`${n}[${a}]`,value:r[a],valueSpec:s,validateSpec:e.validateSpec}))}return t}else return Nt({key:n,value:r})}function Hh(e){let t=e.value,r=e.styleSpec,n=r.projection,i=e.style,o=j(t);if(t===void 0)return[];if(o!=="object")return[new M("projection",t,`object expected, ${o} found`)];let a=[];for(let s in t)n[s]?a=a.concat(e.validateSpec({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r})):a=a.concat([new M(s,t[s],`unknown property "${s}"`)]);return a}var hu={"*"(){return[]},array:ds,boolean:Uh,number:gs,color:$h,constants:Ou,enum:ln,filter:xs,function:Nu,layer:ju,object:ze,source:Ju,light:Zu,sky:Wu,terrain:Hu,projection:Hh,string:Nt,formatted:jh,resolvedImage:Jh,padding:Zh,variableAnchorOffsetCollection:Wh,sprite:Xu};function Wr(e){let t=e.value,r=e.valueSpec,n=e.styleSpec;return e.validateSpec=Wr,r.expression&&Yi(ae(t))?Nu(e):r.expression&&$t(Ot(t))?fr(e):r.type&&hu[r.type]?hu[r.type](e):ze(cr({},e,{valueSpec:r.type?n[r.type]:r}))}function Ku(e){let t=e.value,r=e.key,n=Nt(e);return n.length||(t.indexOf("{fontstack}")===-1&&n.push(new M(r,t,\'"glyphs" url must include a "{fontstack}" token\')),t.indexOf("{range}")===-1&&n.push(new M(r,t,\'"glyphs" url must include a "{range}" token\'))),n}function Ue(e,t=S){let r=[];return r=r.concat(Wr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:Wr,objectElementValidators:{glyphs:Ku,"*"(){return[]}}})),e.constants&&(r=r.concat(Ou({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:Wr}))),Yu(r)}Ue.source=Qe(Ye(Ju));Ue.sprite=Qe(Ye(Xu));Ue.glyphs=Qe(Ye(Ku));Ue.light=Qe(Ye(Zu));Ue.sky=Qe(Ye(Wu));Ue.terrain=Qe(Ye(Hu));Ue.layer=Qe(Ye(ju));Ue.filter=Qe(Ye(xs));Ue.paintProperty=Qe(Ye(Gu));Ue.layoutProperty=Qe(Ye(qu));function Ye(e){return function(t){return e({...t,validateSpec:Wr})}}function Yu(e){return[].concat(e).sort((t,r)=>t.line-r.line)}function Qe(e){return function(...t){return Yu(e.apply(this,t))}}var Qu="AbortError";function ec(e){return e.message===Qu}function bs(){return new Error(Qu)}var Qi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function tc(e){return Qi.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]}function rc(e,t){Qi.REGISTERED_PROTOCOLS[e]=t}function nc(e){delete Qi.REGISTERED_PROTOCOLS[e]}var ic="global-dispatcher",gr=class extends Error{constructor(t,r,n,i){super(`AJAXError: ${r} (${t}): ${n}`),this.status=t,this.statusText=r,this.url=n,this.body=i}},ac=()=>at(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Xh=e=>/^file:/.test(e)||/^file:/.test(ac())&&!/^\\w+:/.test(e);async function Kh(e,t){let r=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:ac(),signal:t.signal});e.type==="json"&&r.headers.set("Accept","application/json");let n=await fetch(r);if(!n.ok){let a=await n.blob();throw new gr(n.status,n.statusText,e.url,a)}let i;e.type==="arrayBuffer"||e.type==="image"?i=n.arrayBuffer():e.type==="json"?i=n.json():i=n.text();let o=await i;if(t.signal.aborted)throw bs();return{data:o,cacheControl:n.headers.get("Cache-Control"),expires:n.headers.get("Expires")}}function Yh(e,t){return new Promise((r,n)=>{let i=new XMLHttpRequest;i.open(e.method||"GET",e.url,!0),(e.type==="arrayBuffer"||e.type==="image")&&(i.responseType="arraybuffer");for(let o in e.headers)i.setRequestHeader(o,e.headers[o]);e.type==="json"&&(i.responseType="text",i.setRequestHeader("Accept","application/json")),i.withCredentials=e.credentials==="include",i.onerror=()=>{n(new Error(i.statusText))},i.onload=()=>{if(!t.signal.aborted)if((i.status>=200&&i.status<300||i.status===0)&&i.response!==null){let o=i.response;if(e.type==="json")try{o=JSON.parse(i.response)}catch(a){n(a);return}r({data:o,cacheControl:i.getResponseHeader("Cache-Control"),expires:i.getResponseHeader("Expires")})}else{let o=new Blob([i.response],{type:i.getResponseHeader("Content-Type")});n(new gr(i.status,i.statusText,e.url,o))}},t.signal.addEventListener("abort",()=>{i.abort(),n(bs())}),i.send(e.body)})}var sc=function(e,t){if(/:\\/\\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){let r=tc(e.url);if(r)return r(e,t);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,targetMapId:ic},t)}if(!Xh(e.url)){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Kh(e,t);if(at(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,mustQueue:!0,targetMapId:ic},t)}return Yh(e,t)},lc=(e,t)=>sc(Pe(e,{type:"json"}),t),uc=(e,t)=>sc(Pe(e,{type:"arrayBuffer"}),t);var xt={};function C(e,t,r={}){if(xt[e])throw new Error(`${e} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),xt[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}C("Object",Object);C("TransferableGridIndex",Dt);C("Color",W);C("Error",Error);C("AJAXError",gr);C("ResolvedImage",Te);C("StylePropertyFunction",sn);C("StyleExpression",Rt,{omit:["_evaluator"]});C("ZoomDependentExpression",gt);C("ZoomConstantExpression",dt);C("CompoundExpression",Ke,{omit:["_evaluate"]});for(let e in Ut)Ut[e]._classRegistryKey||C(`Expression_${e}`,Ut[e]);function cc(e){return e&&typeof ArrayBuffer<"u"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function xr(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error)return e;if(cc(e)||qr(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){let r=e;return t&&t.push(r.buffer),r}if(e instanceof ImageData)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){let r=[];for(let n of e)r.push(xr(n,t));return r}if(typeof e=="object"){let r=e.constructor,n=r._classRegistryKey;if(!n)throw new Error(`can\'t serialize object of unregistered class ${r.name}`);if(!xt[n])throw new Error(`${n} is not registered.`);let i=r.serialize?r.serialize(e,t):{};if(r.serialize){if(t&&i===t[t.length-1])throw new Error("statically serialized object won\'t survive transfer of $name property")}else{for(let o in e){if(!e.hasOwnProperty(o)||xt[n].omit.indexOf(o)>=0)continue;let a=e[o];i[o]=xt[n].shallow.indexOf(o)>=0?a:xr(a,t)}e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return n!=="Object"&&(i.$name=n),i}throw new Error(`can\'t serialize object of type ${typeof e}`)}function br(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error||cc(e)||qr(e)||ArrayBuffer.isView(e)||e instanceof ImageData)return e;if(Array.isArray(e))return e.map(br);if(typeof e=="object"){let t=e.$name||"Object";if(!xt[t])throw new Error(`can\'t deserialize unregistered class ${t}`);let{klass:r}=xt[t];if(!r)throw new Error(`can\'t deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);let n=Object.create(r.prototype);for(let i of Object.keys(e)){if(i==="$name")continue;let o=e[i];n[i]=xt[t].shallow.indexOf(i)>=0?o:br(o)}return n}throw new Error(`can\'t deserialize object of type ${typeof e}`)}var eo=class{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}};var to=class{constructor(t,r){this.target=t,this.mapId=r,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new eo(()=>this.process()),this.subscription=Hl(this.target,"message",n=>this.receive(n),!1),this.globalScope=at(self)?t:window}registerMessageHandler(t,r){this.messageHandlers[t]=r}sendAsync(t,r){return new Promise((n,i)=>{let o=Math.round(Math.random()*1e18).toString(36).substring(0,10);this.resolveRejects[o]={resolve:n,reject:i},r&&r.signal.addEventListener("abort",()=>{delete this.resolveRejects[o];let l={id:o,type:"<cancel>",origin:location.origin,targetMapId:t.targetMapId,sourceMapId:this.mapId};this.target.postMessage(l)},{once:!0});let a=[],s={...t,id:o,sourceMapId:this.mapId,origin:location.origin,data:xr(t.data,a)};this.target.postMessage(s,{transfer:a})})}receive(t){let r=t.data,n=r.id;if(!(r.origin!=="file://"&&location.origin!=="file://"&&r.origin!==location.origin)&&!(r.targetMapId&&this.mapId!==r.targetMapId)){if(r.type==="<cancel>"){delete this.tasks[n];let i=this.abortControllers[n];delete this.abortControllers[n],i&&i.abort();return}if(at(self)||r.mustQueue){this.tasks[n]=r,this.taskQueue.push(n),this.invoker.trigger();return}this.processTask(n,r)}}process(){if(this.taskQueue.length===0)return;let t=this.taskQueue.shift(),r=this.tasks[t];delete this.tasks[t],this.taskQueue.length>0&&this.invoker.trigger(),r&&this.processTask(t,r)}async processTask(t,r){if(r.type==="<response>"){let o=this.resolveRejects[t];if(delete this.resolveRejects[t],!o)return;r.error?o.reject(br(r.error)):o.resolve(br(r.data));return}if(!this.messageHandlers[r.type]){this.completeTask(t,new Error(`Could not find a registered handler for ${r.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));return}let n=br(r.data),i=new AbortController;this.abortControllers[t]=i;try{let o=await this.messageHandlers[r.type](r.sourceMapId,n,i);this.completeTask(t,null,o)}catch(o){this.completeTask(t,o)}}completeTask(t,r,n){let i=[];delete this.abortControllers[t];let o={id:t,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:r?xr(r):null,data:xr(n,i)};this.target.postMessage(o,{transfer:i})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}};function pc(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function vs(e,t,r){if(r&&r[e]){let n=r[e].indexOf(t);n!==-1&&r[e].splice(n,1)}}var ro=class{constructor(t,r={}){Pe(this,r),this.type=t}},yn=class extends ro{constructor(t,r={}){super("error",Pe({error:t},r))}},no=class{on(t,r){return this._listeners=this._listeners||{},pc(t,r,this._listeners),this}off(t,r){return vs(t,r,this._listeners),vs(t,r,this._oneTimeListeners),this}once(t,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},pc(t,r,this._oneTimeListeners),this):new Promise(n=>this.once(t,n))}fire(t,r){typeof t=="string"&&(t=new ro(t,r||{}));let n=t.type;if(this.listens(n)){t.target=this;let i=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(let s of i)s.call(this,t);let o=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(let s of o)vs(n,s,this._oneTimeListeners),s.call(this,t);let a=this._eventedParent;a&&(Pe(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),a.fire(t))}else t instanceof yn&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,r){return this._eventedParent=t,this._eventedParentData=r,this}};var bt=Ue,j0=bt.source,J0=bt.light,Z0=bt.terrain,W0=bt.filter,fc=bt.paintProperty,yc=bt.layoutProperty;function mc(e,t){let r=!1;if(t&&t.length)for(let n of t)e.fire(new yn(new Error(n.message))),r=!0;return r}var io=class{constructor(){this.first=!0}update(t,r){let n=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=r),t!==this.lastZoom?(this.lastZoom=t,this.lastFloorZoom=n,!0):!1)}};var D={"Latin-1 Supplement":e=>e>=128&&e<=255,Arabic:e=>e>=1536&&e<=1791,"Arabic Supplement":e=>e>=1872&&e<=1919,"Arabic Extended-A":e=>e>=2208&&e<=2303,"Hangul Jamo":e=>e>=4352&&e<=4607,"Unified Canadian Aboriginal Syllabics":e=>e>=5120&&e<=5759,Khmer:e=>e>=6016&&e<=6143,"Unified Canadian Aboriginal Syllabics Extended":e=>e>=6320&&e<=6399,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"CJK Radicals Supplement":e=>e>=11904&&e<=12031,"Kangxi Radicals":e=>e>=12032&&e<=12255,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Hiragana:e=>e>=12352&&e<=12447,Katakana:e=>e>=12448&&e<=12543,Bopomofo:e=>e>=12544&&e<=12591,"Hangul Compatibility Jamo":e=>e>=12592&&e<=12687,Kanbun:e=>e>=12688&&e<=12703,"Bopomofo Extended":e=>e>=12704&&e<=12735,"CJK Strokes":e=>e>=12736&&e<=12783,"Katakana Phonetic Extensions":e=>e>=12784&&e<=12799,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"CJK Unified Ideographs Extension A":e=>e>=13312&&e<=19903,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"CJK Unified Ideographs":e=>e>=19968&&e<=40959,"Yi Syllables":e=>e>=40960&&e<=42127,"Yi Radicals":e=>e>=42128&&e<=42191,"Hangul Jamo Extended-A":e=>e>=43360&&e<=43391,"Hangul Syllables":e=>e>=44032&&e<=55215,"Hangul Jamo Extended-B":e=>e>=55216&&e<=55295,"Private Use Area":e=>e>=57344&&e<=63743,"CJK Compatibility Ideographs":e=>e>=63744&&e<=64255,"Arabic Presentation Forms-A":e=>e>=64336&&e<=65023,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Arabic Presentation Forms-B":e=>e>=65136&&e<=65279,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function mn(e){for(let t of e)if(oo(t.charCodeAt(0)))return!0;return!1}function hc(e){for(let t of e)if(!Qh(t.charCodeAt(0)))return!1;return!0}function Qh(e){return!(D.Arabic(e)||D["Arabic Supplement"](e)||D["Arabic Extended-A"](e)||D["Arabic Presentation Forms-A"](e)||D["Arabic Presentation Forms-B"](e))}function dc(e){return e<11904?!1:!!(D["Bopomofo Extended"](e)||D.Bopomofo(e)||D["CJK Compatibility Forms"](e)||D["CJK Compatibility Ideographs"](e)||D["CJK Compatibility"](e)||D["CJK Radicals Supplement"](e)||D["CJK Strokes"](e)||D["CJK Symbols and Punctuation"](e)||D["CJK Unified Ideographs Extension A"](e)||D["CJK Unified Ideographs"](e)||D["Enclosed CJK Letters and Months"](e)||D["Halfwidth and Fullwidth Forms"](e)||D.Hiragana(e)||D["Ideographic Description Characters"](e)||D["Kangxi Radicals"](e)||D["Katakana Phonetic Extensions"](e)||D.Katakana(e)||D["Vertical Forms"](e)||D["Yi Radicals"](e)||D["Yi Syllables"](e))}function oo(e){return e===746||e===747?!0:e<4352?!1:!!(D["Bopomofo Extended"](e)||D.Bopomofo(e)||D["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||D["CJK Compatibility Ideographs"](e)||D["CJK Compatibility"](e)||D["CJK Radicals Supplement"](e)||D["CJK Strokes"](e)||D["CJK Symbols and Punctuation"](e)&&!(e>=12296&&e<=12305)&&!(e>=12308&&e<=12319)&&e!==12336||D["CJK Unified Ideographs Extension A"](e)||D["CJK Unified Ideographs"](e)||D["Enclosed CJK Letters and Months"](e)||D["Hangul Compatibility Jamo"](e)||D["Hangul Jamo Extended-A"](e)||D["Hangul Jamo Extended-B"](e)||D["Hangul Jamo"](e)||D["Hangul Syllables"](e)||D.Hiragana(e)||D["Ideographic Description Characters"](e)||D.Kanbun(e)||D["Kangxi Radicals"](e)||D["Katakana Phonetic Extensions"](e)||D.Katakana(e)&&e!==12540||D["Halfwidth and Fullwidth Forms"](e)&&e!==65288&&e!==65289&&e!==65293&&!(e>=65306&&e<=65310)&&e!==65339&&e!==65341&&e!==65343&&!(e>=65371&&e<=65503)&&e!==65507&&!(e>=65512&&e<=65519)||D["Small Form Variants"](e)&&!(e>=65112&&e<=65118)&&!(e>=65123&&e<=65126)||D["Unified Canadian Aboriginal Syllabics"](e)||D["Unified Canadian Aboriginal Syllabics Extended"](e)||D["Vertical Forms"](e)||D["Yijing Hexagram Symbols"](e)||D["Yi Syllables"](e)||D["Yi Radicals"](e))}function ed(e){return!!(D["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||D["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||D["Letterlike Symbols"](e)||D["Number Forms"](e)||D["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||D["Control Pictures"](e)&&e!==9251||D["Optical Character Recognition"](e)||D["Enclosed Alphanumerics"](e)||D["Geometric Shapes"](e)||D["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||D["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||D["CJK Symbols and Punctuation"](e)||D.Katakana(e)||D["Private Use Area"](e)||D["CJK Compatibility Forms"](e)||D["Small Form Variants"](e)||D["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}function Ps(e){return!(oo(e)||ed(e))}function gc(e){return D.Arabic(e)||D["Arabic Supplement"](e)||D["Arabic Extended-A"](e)||D["Arabic Presentation Forms-A"](e)||D["Arabic Presentation Forms-B"](e)}function xc(e){return e>=1424&&e<=2303||D["Arabic Presentation Forms-A"](e)||D["Arabic Presentation Forms-B"](e)}function td(e,t){return!(!t&&xc(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||D.Khmer(e))}function bc(e){for(let t of e)if(xc(t.charCodeAt(0)))return!0;return!1}function vc(e,t){for(let r of e)if(!td(r.charCodeAt(0),t))return!1;return!0}var Ss=class{constructor(){this.applyArabicShaping=null;this.processBidirectionalText=null;this.processStyledBidirectionalText=null;this.pluginStatus="unavailable";this.pluginURL=null}setState(t){this.pluginStatus=t.pluginStatus,this.pluginURL=t.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(t){this.applyArabicShaping=t.applyArabicShaping,this.processBidirectionalText=t.processBidirectionalText,this.processStyledBidirectionalText=t.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}},ye=new Ss;var q=class{constructor(t,r){this.zoom=t,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new io,this.transition={})}isSupportedScript(t){return vc(t,ye.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let t=this.zoom,r=t-Math.floor(t),n=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*r}}};var vr=class{constructor(t,r){this.property=t,this.value=r,this.expression=Bu(r===void 0?t.specification.default:r,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,r,n){return this.property.possiblyEvaluate(this,t,r,n)}},hn=class{constructor(t){this.property=t,this.value=new vr(t,void 0)}transitioned(t,r){return new so(this.property,this.value,r,Pe({},t.transition,this.transition),t.now)}untransitioned(){return new so(this.property,this.value,null,{},0)}},ao=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return nt(this._values[t].value.value)}setValue(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new hn(this._values[t].property)),this._values[t].value=new vr(this._values[t].property,r===null?void 0:nt(r))}getTransition(t){return nt(this._values[t].transition)}setTransition(t,r){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new hn(this._values[t].property)),this._values[t].transition=nt(r)||void 0}serialize(){let t={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(t[r]=n);let i=this.getTransition(r);i!==void 0&&(t[`${r}-transition`]=i)}return t}transitioned(t,r){let n=new lo(this._properties);for(let i of Object.keys(this._values))n._values[i]=this._values[i].transitioned(t,r._values[i]);return n}untransitioned(){let t=new lo(this._properties);for(let r of Object.keys(this._values))t._values[r]=this._values[r].untransitioned();return t}},so=class{constructor(t,r,n,i,o){this.property=t,this.value=r,this.begin=o+i.delay||0,this.end=this.begin+i.duration||0,t.specification.transition&&(i.delay||i.duration)&&(this.prior=n)}possiblyEvaluate(t,r,n){let i=t.now||0,o=this.value.possiblyEvaluate(t,r,n),a=this.prior;if(a){if(i>this.end)return this.prior=null,o;if(this.value.isDataDriven())return this.prior=null,o;if(i<this.begin)return a.possiblyEvaluate(t,r,n);{let s=(i-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(t,r,n),o,$l(s))}}else return o}},lo=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(t,r,n);return i}hasTransition(){for(let t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}},uo=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return nt(this._values[t].value)}setValue(t,r){this._values[t]=new vr(this._values[t].property,r===null?void 0:nt(r))}serialize(){let t={};for(let r of Object.keys(this._values)){let n=this.getValue(r);n!==void 0&&(t[r]=n)}return t}possiblyEvaluate(t,r,n){let i=new vt(this._properties);for(let o of Object.keys(this._values))i._values[o]=this._values[o].possiblyEvaluate(t,r,n);return i}},Se=class{constructor(t,r,n){this.property=t,this.value=r,this.parameters=n}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,r,n,i){return this.property.evaluate(this.value,this.parameters,t,r,n,i)}},vt=class{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}},B=class{constructor(t){this.specification=t}possiblyEvaluate(t,r){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(r)}interpolate(t,r,n){let i=this.specification.type,o=Oe[i];return o?o(t,r,n):t}},R=class{constructor(t,r){this.specification=t,this.overrides=r}possiblyEvaluate(t,r,n,i){return t.expression.kind==="constant"||t.expression.kind==="camera"?new Se(this,{kind:"constant",value:t.expression.evaluate(r,null,{},n,i)},r):new Se(this,t.expression,r)}interpolate(t,r,n){if(t.value.kind!=="constant"||r.value.kind!=="constant")return t;if(t.value.value===void 0||r.value.value===void 0)return new Se(this,{kind:"constant",value:void 0},t.parameters);let i=this.specification.type,o=Oe[i];if(o){let a=o(t.value.value,r.value.value,n);return new Se(this,{kind:"constant",value:a},t.parameters)}else return t}evaluate(t,r,n,i,o,a){return t.kind==="constant"?t.value:t.evaluate(r,n,i,o,a)}},lt=class extends R{possiblyEvaluate(t,r,n,i){if(t.value===void 0)return new Se(this,{kind:"constant",value:void 0},r);if(t.expression.kind==="constant"){let o=t.expression.evaluate(r,null,{},n,i),s=t.property.specification.type==="resolvedImage"&&typeof o!="string"?o.name:o,l=this._calculate(s,s,s,r);return new Se(this,{kind:"constant",value:l},r)}else if(t.expression.kind==="camera"){let o=this._calculate(t.expression.evaluate({zoom:r.zoom-1}),t.expression.evaluate({zoom:r.zoom}),t.expression.evaluate({zoom:r.zoom+1}),r);return new Se(this,{kind:"constant",value:o},r)}else return new Se(this,t.expression,r)}evaluate(t,r,n,i,o,a){if(t.kind==="source"){let s=t.evaluate(r,n,i,o,a);return this._calculate(s,s,s,r)}else return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(r.zoom)-1},n,i),t.evaluate({zoom:Math.floor(r.zoom)},n,i),t.evaluate({zoom:Math.floor(r.zoom)+1},n,i),r):t.value}_calculate(t,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:n,to:r}}interpolate(t){return t}},qt=class{constructor(t){this.specification=t}possiblyEvaluate(t,r,n,i){if(t.value!==void 0)if(t.expression.kind==="constant"){let o=t.expression.evaluate(r,null,{},n,i);return this._calculate(o,o,o,r)}else return this._calculate(t.expression.evaluate(new q(Math.floor(r.zoom-1),r)),t.expression.evaluate(new q(Math.floor(r.zoom),r)),t.expression.evaluate(new q(Math.floor(r.zoom+1),r)),r)}_calculate(t,r,n,i){return i.zoom>i.zoomHistory.lastIntegerZoom?{from:t,to:r}:{from:n,to:r}}interpolate(t){return t}},jt=class{constructor(t){this.specification=t}possiblyEvaluate(t,r,n,i){return!!t.expression.evaluate(r,null,{},n,i)}interpolate(){return!1}},re=class{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let r in t){let n=t[r];n.specification.overridable&&this.overridableProperties.push(r);let i=this.defaultPropertyValues[r]=new vr(n,void 0),o=this.defaultTransitionablePropertyValues[r]=new hn(n);this.defaultTransitioningPropertyValues[r]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate({})}}};C("DataDrivenProperty",R);C("DataConstantProperty",B);C("CrossFadedDataDrivenProperty",lt);C("CrossFadedProperty",qt);C("ColorRampProperty",jt);var co="-transition",se=class extends no{constructor(t,r){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(t=t,this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),r.layout&&(this._unevaluatedLayout=new uo(r.layout)),r.paint)){this._transitionablePaint=new ao(r.paint);for(let n in t.paint)this.setPaintProperty(n,t.paint[n],{validate:!1});for(let n in t.layout)this.setLayoutProperty(n,t.layout[n],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new vt(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,r,n={}){if(r!=null){let i=`layers.${this.id}.layout.${t}`;if(this._validate(yc,i,t,r,n))return}if(t==="visibility"){this.visibility=r;return}this._unevaluatedLayout.setValue(t,r)}getPaintProperty(t){return t.endsWith(co)?this._transitionablePaint.getTransition(t.slice(0,-co.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,r,n={}){if(r!=null){let i=`layers.${this.id}.paint.${t}`;if(this._validate(fc,i,t,r,n))return!1}if(t.endsWith(co))return this._transitionablePaint.setTransition(t.slice(0,-co.length),r||void 0),!1;{let i=this._transitionablePaint._values[t],o=i.property.specification["property-type"]==="cross-faded-data-driven",a=i.value.isDataDriven(),s=i.value;this._transitionablePaint.setValue(t,r),this._handleSpecialPaintPropertyUpdate(t);let l=this._transitionablePaint._values[t].value;return l.isDataDriven()||a||o||this._handleOverridablePaintPropertyUpdate(t,s,l)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,r,n){return!1}isHidden(t){return this.minzoom&&t<this.minzoom||this.maxzoom&&t>=this.maxzoom?!0:this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,r){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,r)}serialize(){let t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),jl(t,(r,n)=>r!==void 0&&!(n==="layout"&&!Object.keys(r).length)&&!(n==="paint"&&!Object.keys(r).length))}_validate(t,r,n,i,o={}){return o&&o.validate===!1?!1:mc(this,t.call(bt,{key:r,layerType:this.type,objectKey:n,value:i,styleSpec:S,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let t in this.paint._values){let r=this.paint.get(t);if(!(!(r instanceof Se)||!ht(r.property.specification))&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}};var rd={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Pt=class{constructor(t,r){this._structArray=t,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}},nd=128,id=5,ee=class{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,r){return t._trim(),r&&(t.isTransferred=!0,r.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){let r=Object.create(this.prototype);return r.arrayBuffer=t.arrayBuffer,r.length=t.length,r.capacity=t.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(this.capacity*id),nd),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}};function Y(e,t=1){let r=0,n=0,i=e.map(a=>{let s=od(a.type),l=r=Pc(r,Math.max(t,s)),u=a.components||1;return n=Math.max(n,s),r+=s*u,{name:a.name,type:a.type,components:u,offset:l}}),o=Pc(r,Math.max(n,t));return{members:i,size:o,alignment:t}}function od(e){return rd[e].BYTES_PER_ELEMENT}function Pc(e,t){return Math.ceil(e/t)*t}var Sc=Z(he(),1),Jt=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r){let n=this.length;return this.resize(n+1),this.emplace(n,t,r)}emplace(t,r,n){let i=t*2;return this.int16[i+0]=r,this.int16[i+1]=n,t}};Jt.prototype.bytesPerElement=4;C("StructArrayLayout2i4",Jt);var dn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*3;return this.int16[o+0]=r,this.int16[o+1]=n,this.int16[o+2]=i,t}};dn.prototype.bytesPerElement=6;C("StructArrayLayout3i6",dn);var po=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,t,r,n,i)}emplace(t,r,n,i,o){let a=t*4;return this.int16[a+0]=r,this.int16[a+1]=n,this.int16[a+2]=i,this.int16[a+3]=o,t}};po.prototype.bytesPerElement=8;C("StructArrayLayout4i8",po);var gn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,t,r,n,i,o,a)}emplace(t,r,n,i,o,a,s){let l=t*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,t}};gn.prototype.bytesPerElement=12;C("StructArrayLayout2i4i12",gn);var xn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,t,r,n,i,o,a)}emplace(t,r,n,i,o,a,s){let l=t*4,u=t*8;return this.int16[l+0]=r,this.int16[l+1]=n,this.uint8[u+4]=i,this.uint8[u+5]=o,this.uint8[u+6]=a,this.uint8[u+7]=s,t}};xn.prototype.bytesPerElement=8;C("StructArrayLayout2i4ub8",xn);var St=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r){let n=this.length;return this.resize(n+1),this.emplace(n,t,r)}emplace(t,r,n){let i=t*2;return this.float32[i+0]=r,this.float32[i+1]=n,t}};St.prototype.bytesPerElement=8;C("StructArrayLayout2f8",St);var bn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u,c){let p=this.length;return this.resize(p+1),this.emplace(p,t,r,n,i,o,a,s,l,u,c)}emplace(t,r,n,i,o,a,s,l,u,c,p){let f=t*10;return this.uint16[f+0]=r,this.uint16[f+1]=n,this.uint16[f+2]=i,this.uint16[f+3]=o,this.uint16[f+4]=a,this.uint16[f+5]=s,this.uint16[f+6]=l,this.uint16[f+7]=u,this.uint16[f+8]=c,this.uint16[f+9]=p,t}};bn.prototype.bytesPerElement=20;C("StructArrayLayout10ui20",bn);var vn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u,c,p,f){let y=this.length;return this.resize(y+1),this.emplace(y,t,r,n,i,o,a,s,l,u,c,p,f)}emplace(t,r,n,i,o,a,s,l,u,c,p,f,y){let m=t*12;return this.int16[m+0]=r,this.int16[m+1]=n,this.int16[m+2]=i,this.int16[m+3]=o,this.uint16[m+4]=a,this.uint16[m+5]=s,this.uint16[m+6]=l,this.uint16[m+7]=u,this.int16[m+8]=c,this.int16[m+9]=p,this.int16[m+10]=f,this.int16[m+11]=y,t}};vn.prototype.bytesPerElement=24;C("StructArrayLayout4i4ui4i24",vn);var Pn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*3;return this.float32[o+0]=r,this.float32[o+1]=n,this.float32[o+2]=i,t}};Pn.prototype.bytesPerElement=12;C("StructArrayLayout3f12",Pn);var Sn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){let n=t*1;return this.uint32[n+0]=r,t}};Sn.prototype.bytesPerElement=4;C("StructArrayLayout1ul4",Sn);var wn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u){let c=this.length;return this.resize(c+1),this.emplace(c,t,r,n,i,o,a,s,l,u)}emplace(t,r,n,i,o,a,s,l,u,c){let p=t*10,f=t*5;return this.int16[p+0]=r,this.int16[p+1]=n,this.int16[p+2]=i,this.int16[p+3]=o,this.int16[p+4]=a,this.int16[p+5]=s,this.uint32[f+3]=l,this.uint16[p+8]=u,this.uint16[p+9]=c,t}};wn.prototype.bytesPerElement=20;C("StructArrayLayout6i1ul2ui20",wn);var An=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a){let s=this.length;return this.resize(s+1),this.emplace(s,t,r,n,i,o,a)}emplace(t,r,n,i,o,a,s){let l=t*6;return this.int16[l+0]=r,this.int16[l+1]=n,this.int16[l+2]=i,this.int16[l+3]=o,this.int16[l+4]=a,this.int16[l+5]=s,t}};An.prototype.bytesPerElement=12;C("StructArrayLayout2i2i2i12",An);var fo=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o){let a=this.length;return this.resize(a+1),this.emplace(a,t,r,n,i,o)}emplace(t,r,n,i,o,a){let s=t*4,l=t*8;return this.float32[s+0]=r,this.float32[s+1]=n,this.float32[s+2]=i,this.int16[l+6]=o,this.int16[l+7]=a,t}};fo.prototype.bytesPerElement=16;C("StructArrayLayout2f1f2i16",fo);var _n=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,t,r,n,i)}emplace(t,r,n,i,o){let a=t*12,s=t*3;return this.uint8[a+0]=r,this.uint8[a+1]=n,this.float32[s+1]=i,this.float32[s+2]=o,t}};_n.prototype.bytesPerElement=12;C("StructArrayLayout2ub2f12",_n);var In=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*3;return this.uint16[o+0]=r,this.uint16[o+1]=n,this.uint16[o+2]=i,t}};In.prototype.bytesPerElement=6;C("StructArrayLayout3ui6",In);var Tn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g){let b=this.length;return this.resize(b+1),this.emplace(b,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g)}emplace(t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b){let x=t*24,v=t*12,P=t*48;return this.int16[x+0]=r,this.int16[x+1]=n,this.uint16[x+2]=i,this.uint16[x+3]=o,this.uint32[v+2]=a,this.uint32[v+3]=s,this.uint32[v+4]=l,this.uint16[x+10]=u,this.uint16[x+11]=c,this.uint16[x+12]=p,this.float32[v+7]=f,this.float32[v+8]=y,this.uint8[P+36]=m,this.uint8[P+37]=h,this.uint8[P+38]=d,this.uint32[v+10]=g,this.int16[x+22]=b,t}};Tn.prototype.bytesPerElement=48;C("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Tn);var Cn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k){let V=this.length;return this.resize(V+1),this.emplace(V,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k)}emplace(t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V){let A=t*32,z=t*16;return this.int16[A+0]=r,this.int16[A+1]=n,this.int16[A+2]=i,this.int16[A+3]=o,this.int16[A+4]=a,this.int16[A+5]=s,this.int16[A+6]=l,this.int16[A+7]=u,this.uint16[A+8]=c,this.uint16[A+9]=p,this.uint16[A+10]=f,this.uint16[A+11]=y,this.uint16[A+12]=m,this.uint16[A+13]=h,this.uint16[A+14]=d,this.uint16[A+15]=g,this.uint16[A+16]=b,this.uint16[A+17]=x,this.uint16[A+18]=v,this.uint16[A+19]=P,this.uint16[A+20]=w,this.uint16[A+21]=T,this.uint16[A+22]=F,this.uint32[z+12]=E,this.float32[z+13]=_,this.float32[z+14]=I,this.uint16[A+30]=k,this.uint16[A+31]=V,t}};Cn.prototype.bytesPerElement=64;C("StructArrayLayout8i15ui1ul2f2ui64",Cn);var Zt=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){let n=t*1;return this.float32[n+0]=r,t}};Zt.prototype.bytesPerElement=4;C("StructArrayLayout1f4",Zt);var kn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*6,a=t*3;return this.uint16[o+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,t}};kn.prototype.bytesPerElement=12;C("StructArrayLayout1ui2f12",kn);var Mn=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r,n){let i=this.length;return this.resize(i+1),this.emplace(i,t,r,n)}emplace(t,r,n,i){let o=t*2,a=t*4;return this.uint32[o+0]=r,this.uint16[a+2]=n,this.uint16[a+3]=i,t}};Mn.prototype.bytesPerElement=8;C("StructArrayLayout1ul2ui8",Mn);var En=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,r){let n=this.length;return this.resize(n+1),this.emplace(n,t,r)}emplace(t,r,n){let i=t*2;return this.uint16[i+0]=r,this.uint16[i+1]=n,t}};En.prototype.bytesPerElement=4;C("StructArrayLayout2ui4",En);var yo=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){let r=this.length;return this.resize(r+1),this.emplace(r,t)}emplace(t,r){let n=t*1;return this.uint16[n+0]=r,t}};yo.prototype.bytesPerElement=2;C("StructArrayLayout1ui2",yo);var Pr=class extends ee{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,r,n,i){let o=this.length;return this.resize(o+1),this.emplace(o,t,r,n,i)}emplace(t,r,n,i,o){let a=t*4;return this.float32[a+0]=r,this.float32[a+1]=n,this.float32[a+2]=i,this.float32[a+3]=o,t}};Pr.prototype.bytesPerElement=16;C("StructArrayLayout4f16",Pr);var mo=class extends Pt{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Sc.default(this.anchorPointX,this.anchorPointY)}};mo.prototype.size=20;var Fn=class extends wn{get(t){return new mo(this,t)}};C("CollisionBoxArray",Fn);var ho=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}};ho.prototype.size=48;var Ln=class extends Tn{get(t){return new ho(this,t)}};C("PlacedSymbolArray",Ln);var go=class extends Pt{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}};go.prototype.size=64;var Dn=class extends Cn{get(t){return new go(this,t)}};C("SymbolInstanceArray",Dn);var Vn=class extends Zt{getoffsetX(t){return this.float32[t*1+0]}};C("GlyphOffsetArray",Vn);var Bn=class extends dn{getx(t){return this.int16[t*3+0]}gety(t){return this.int16[t*3+1]}gettileUnitDistanceFromAnchor(t){return this.int16[t*3+2]}};C("SymbolLineVertexArray",Bn);var xo=class extends Pt{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}};xo.prototype.size=12;var zn=class extends kn{get(t){return new xo(this,t)}};C("TextAnchorOffsetArray",zn);var bo=class extends Pt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}};bo.prototype.size=8;var Rn=class extends Mn{get(t){return new bo(this,t)}};C("FeatureIndexArray",Rn);var vo=class extends Jt{};var Po=class extends Jt{},So=class extends Jt{},wo=class extends gn{};var Ao=class extends xn{},_o=class extends St{},ut=class extends bn{},Io=class extends vn{},To=class extends Pn{},Co=class extends Sn{},On=class extends An{};var ko=class extends _n{};var Le=class extends In{},wt=class extends En{};var ad=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:wc,size:Fv,alignment:Lv}=ad;var me=class e{constructor(t=[]){this.segments=t}prepareSegment(t,r,n,i){let o=this.segments[this.segments.length-1];return t>e.MAX_VERTEX_ARRAY_LENGTH&&fe(`Max vertices per segment is ${e.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!o||o.vertexLength+t>e.MAX_VERTEX_ARRAY_LENGTH||o.sortKey!==i)&&(o={vertexOffset:r.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},i!==void 0&&(o.sortKey=i),this.segments.push(o)),o}get(){return this.segments}destroy(){for(let t of this.segments)for(let r in t.vaos)t.vaos[r].destroy()}static simpleSegment(t,r,n,i){return new e([{vertexOffset:t,primitiveOffset:r,vertexLength:n,primitiveLength:i,vaos:{},sortKey:0}])}};me.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1;C("SegmentVector",me);function ws(e,t){return e=it(Math.floor(e),0,255),t=it(Math.floor(t),0,255),256*e+t}var Nn=Y([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Cc=Z(Is(),1);var Un=class e{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,r,n,i){this.ids.push(Tc(t)),this.positions.push(r,n,i)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let r=Tc(t),n=0,i=this.ids.length-1;for(;n<i;){let a=n+i>>1;this.ids[a]>=r?i=a:n=a+1}let o=[];for(;this.ids[n]===r;){let a=this.positions[3*n],s=this.positions[3*n+1],l=this.positions[3*n+2];o.push({index:a,start:s,end:l}),n++}return o}static serialize(t,r){let n=new Float64Array(t.ids),i=new Uint32Array(t.positions);return Ts(n,i,0,n.length-1),r&&r.push(n.buffer,i.buffer),{ids:n,positions:i}}static deserialize(t){let r=new e;return r.ids=t.ids,r.positions=t.positions,r.indexed=!0,r}};function Tc(e){let t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:(0,Cc.default)(String(e))}function Ts(e,t,r,n){for(;r<n;){let i=e[r+n>>1],o=r-1,a=n+1;for(;;){do o++;while(e[o]<i);do a--;while(e[a]>i);if(o>=a)break;Eo(e,o,a),Eo(t,3*o,3*a),Eo(t,3*o+1,3*a+1),Eo(t,3*o+2,3*a+2)}a-r<n-a?(Ts(e,t,r,a),r=a+1):(Ts(e,t,a+1,n),n=a)}}function Eo(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}C("FeaturePositionMap",Un);var $n=class{constructor(t,r){this.gl=t.gl,this.location=r}};var Sr=class extends $n{constructor(t,r){super(t,r),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}};var Fo=class extends $n{constructor(t,r){super(t,r),this.current=[0,0,0,0]}set(t){(t[0]!==this.current[0]||t[1]!==this.current[1]||t[2]!==this.current[2]||t[3]!==this.current[3])&&(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}},Lo=class extends $n{constructor(t,r){super(t,r),this.current=W.transparent}set(t){(t.r!==this.current.r||t.g!==this.current.g||t.b!==this.current.b||t.a!==this.current.a)&&(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}},Wv=new Float32Array(16);function Cs(e){return[ws(255*e.r,255*e.g),ws(255*e.b,255*e.a)]}var Wt=class{constructor(t,r,n){this.value=t,this.uniformNames=r.map(i=>`u_${i}`),this.type=n}setUniform(t,r,n){t.set(n.constantOr(this.value))}getBinding(t,r,n){return this.type==="color"?new Lo(t,r):new Sr(t,r)}},At=class{constructor(t,r){this.uniformNames=r.map(n=>`u_${n}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=t.tlbr}setUniform(t,r,n,i){let o=i==="u_pattern_to"?this.patternTo:i==="u_pattern_from"?this.patternFrom:i==="u_pixel_ratio_to"?this.pixelRatioTo:i==="u_pixel_ratio_from"?this.pixelRatioFrom:null;o&&t.set(o)}getBinding(t,r,n){return n.substr(0,9)==="u_pattern"?new Fo(t,r):new Sr(t,r)}},We=class{constructor(t,r,n,i){this.expression=t,this.type=n,this.maxValue=0,this.paintVertexAttributes=r.map(o=>({name:`a_${o}`,type:"Float32",components:n==="color"?2:1,offset:0})),this.paintVertexArray=new i}populatePaintArray(t,r,n,i,o){let a=this.paintVertexArray.length,s=this.expression.evaluate(new q(0),r,{},i,[],o);this.paintVertexArray.resize(t),this._setPaintValue(a,t,s)}updatePaintArray(t,r,n,i){let o=this.expression.evaluate({zoom:0},n,i);this._setPaintValue(t,r,o)}_setPaintValue(t,r,n){if(this.type==="color"){let i=Cs(n);for(let o=t;o<r;o++)this.paintVertexArray.emplace(o,i[0],i[1])}else{for(let i=t;i<r;i++)this.paintVertexArray.emplace(i,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}},De=class{constructor(t,r,n,i,o,a){this.expression=t,this.uniformNames=r.map(s=>`u_${s}_t`),this.type=n,this.useIntegerZoom=i,this.zoom=o,this.maxValue=0,this.paintVertexAttributes=r.map(s=>({name:`a_${s}`,type:"Float32",components:n==="color"?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(t,r,n,i,o){let a=this.expression.evaluate(new q(this.zoom),r,{},i,[],o),s=this.expression.evaluate(new q(this.zoom+1),r,{},i,[],o),l=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(l,t,a,s)}updatePaintArray(t,r,n,i){let o=this.expression.evaluate({zoom:this.zoom},n,i),a=this.expression.evaluate({zoom:this.zoom+1},n,i);this._setPaintValue(t,r,o,a)}_setPaintValue(t,r,n,i){if(this.type==="color"){let o=Cs(n),a=Cs(i);for(let s=t;s<r;s++)this.paintVertexArray.emplace(s,o[0],o[1],a[0],a[1])}else{for(let o=t;o<r;o++)this.paintVertexArray.emplace(o,n,i);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(i))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,r){let n=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,i=it(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);t.set(i)}getBinding(t,r,n){return new Sr(t,r)}},et=class{constructor(t,r,n,i,o,a){this.expression=t,this.type=r,this.useIntegerZoom=n,this.zoom=i,this.layerId=a,this.zoomInPaintVertexArray=new o,this.zoomOutPaintVertexArray=new o}populatePaintArray(t,r,n){let i=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(i,t,r.patterns&&r.patterns[this.layerId],n)}updatePaintArray(t,r,n,i,o){this._setPaintValues(t,r,n.patterns&&n.patterns[this.layerId],o)}_setPaintValues(t,r,n,i){if(!i||!n)return;let{min:o,mid:a,max:s}=n,l=i[o],u=i[a],c=i[s];if(!(!l||!u||!c))for(let p=t;p<r;p++)this.zoomInPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],l.tl[0],l.tl[1],l.br[0],l.br[1],u.pixelRatio,l.pixelRatio),this.zoomOutPaintVertexArray.emplace(p,u.tl[0],u.tl[1],u.br[0],u.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],u.pixelRatio,c.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Nn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Nn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}},Do=class{constructor(t,r,n){this.binders={},this._buffers=[];let i=[];for(let o in t.paint._values){if(!n(o))continue;let a=t.paint.get(o);if(!(a instanceof Se)||!ht(a.property.specification))continue;let s=cd(o,t.type),l=a.value,u=a.property.specification.type,c=a.property.useIntegerZoom,p=a.property.specification["property-type"],f=p==="cross-faded"||p==="cross-faded-data-driven";if(l.kind==="constant")this.binders[o]=f?new At(l.value,s):new Wt(l.value,s,u),i.push(`/u_${o}`);else if(l.kind==="source"||f){let y=kc(o,u,"source");this.binders[o]=f?new et(l,u,c,r,y,t.id):new We(l,s,u,y),i.push(`/a_${o}`)}else{let y=kc(o,u,"composite");this.binders[o]=new De(l,s,u,c,r,y),i.push(`/z_${o}`)}}this.cacheKey=i.sort().join("")}getMaxValue(t){let r=this.binders[t];return r instanceof We||r instanceof De?r.maxValue:0}populatePaintArrays(t,r,n,i,o){for(let a in this.binders){let s=this.binders[a];(s instanceof We||s instanceof De||s instanceof et)&&s.populatePaintArray(t,r,n,i,o)}}setConstantPatternPositions(t,r){for(let n in this.binders){let i=this.binders[n];i instanceof At&&i.setConstantPatternPositions(t,r)}}updatePaintArrays(t,r,n,i,o){let a=!1;for(let s in t){let l=r.getPositions(s);for(let u of l){let c=n.feature(u.index);for(let p in this.binders){let f=this.binders[p];if((f instanceof We||f instanceof De||f instanceof et)&&f.expression.isStateDependent===!0){let y=i.paint.get(p);f.expression=y.value,f.updatePaintArray(u.start,u.end,c,t[s],o),a=!0}}}}return a}defines(){let t=[];for(let r in this.binders){let n=this.binders[r];(n instanceof Wt||n instanceof At)&&t.push(...n.uniformNames.map(i=>`#define HAS_UNIFORM_${i}`))}return t}getBinderAttributes(){let t=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof We||n instanceof De)for(let i=0;i<n.paintVertexAttributes.length;i++)t.push(n.paintVertexAttributes[i].name);else if(n instanceof et)for(let i=0;i<Nn.members.length;i++)t.push(Nn.members[i].name)}return t}getBinderUniforms(){let t=[];for(let r in this.binders){let n=this.binders[r];if(n instanceof Wt||n instanceof At||n instanceof De)for(let i of n.uniformNames)t.push(i)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,r){let n=[];for(let i in this.binders){let o=this.binders[i];if(o instanceof Wt||o instanceof At||o instanceof De){for(let a of o.uniformNames)if(r[a]){let s=o.getBinding(t,r[a],a);n.push({name:a,property:i,binding:s})}}}return n}setUniforms(t,r,n,i){for(let{name:o,property:a,binding:s}of r)this.binders[a].setUniform(s,i,n.get(a),o)}updatePaintBuffers(t){this._buffers=[];for(let r in this.binders){let n=this.binders[r];if(t&&n instanceof et){let i=t.fromScale===2?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;i&&this._buffers.push(i)}else(n instanceof We||n instanceof De)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(t){for(let r in this.binders){let n=this.binders[r];(n instanceof We||n instanceof De||n instanceof et)&&n.upload(t)}this.updatePaintBuffers()}destroy(){for(let t in this.binders){let r=this.binders[t];(r instanceof We||r instanceof De||r instanceof et)&&r.destroy()}}},Ce=class{constructor(t,r,n=()=>!0){this.programConfigurations={};for(let i of t)this.programConfigurations[i.id]=new Do(i,r,n);this.needsUpload=!1,this._featureMap=new Un,this._bufferOffset=0}populatePaintArrays(t,r,n,i,o,a){for(let s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(t,r,i,o,a);r.id!==void 0&&this._featureMap.add(r.id,n,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,r,n,i){for(let o of n)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(t,this._featureMap,r,o,i)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(let r in this.programConfigurations)this.programConfigurations[r].upload(t);this.needsUpload=!1}}destroy(){for(let t in this.programConfigurations)this.programConfigurations[t].destroy()}};function cd(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}function pd(e){return{"line-pattern":{source:ut,composite:ut},"fill-pattern":{source:ut,composite:ut},"fill-extrusion-pattern":{source:ut,composite:ut}}[e]}function kc(e,t,r){let n={color:{source:St,composite:Pr},number:{source:Zt,composite:St}},i=pd(e);return i&&i[r]||n[t][r]}C("ConstantBinder",Wt);C("CrossFadedConstantBinder",At);C("SourceExpressionBinder",We);C("CrossFadedCompositeBinder",et);C("CompositeExpressionBinder",De);C("ProgramConfiguration",Do,{omit:["_buffers"]});C("ProgramConfigurationSet",Ce);var fd=15,ks=Math.pow(2,fd-1)-1,Mc=-ks-1;function ke(e){let t=8192/e.extent,r=e.loadGeometry();for(let n=0;n<r.length;n++){let i=r[n];for(let o=0;o<i.length;o++){let a=i[o],s=Math.round(a.x*t),l=Math.round(a.y*t);a.x=it(s,Mc,ks),a.y=it(l,Mc,ks),(s<a.x||s>a.x+1||l<a.y||l>a.y+1)&&fe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function $e(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?ke(e):[]}}function Vo(e,t,r,n,i){e.emplaceBack(t*2+(n+1)/2,r*2+(i+1)/2)}var Ht=class{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Po,this.indexArray=new Le,this.segments=new me,this.programConfigurations=new Ce(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,n){let i=this.layers[0],o=[],a=null,s=!1;i.type==="circle"&&(a=i.layout.get("circle-sort-key"),s=!a.isConstant());for(let{feature:l,id:u,index:c,sourceLayerIndex:p}of t){let f=this.layers[0]._featureFilter.needGeometry,y=$e(l,f);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),y,n))continue;let m=s?a.evaluate(y,{},n):void 0,h={id:u,properties:l.properties,type:l.type,sourceLayerIndex:p,index:c,geometry:f?y.geometry:ke(l),patterns:{},sortKey:m};o.push(h)}s&&o.sort((l,u)=>l.sortKey-u.sortKey);for(let l of o){let{geometry:u,index:c,sourceLayerIndex:p}=l,f=t[c].feature;this.addFeature(l,u,c,n),r.featureIndex.insert(f,u,c,p,this.index)}}update(t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,wc),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,r,n,i){for(let o of r)for(let a of o){let s=a.x,l=a.y;if(s<0||s>=8192||l<0||l>=8192)continue;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),c=u.vertexLength;Vo(this.layoutVertexArray,s,l,-1,-1),Vo(this.layoutVertexArray,s,l,1,-1),Vo(this.layoutVertexArray,s,l,1,1),Vo(this.layoutVertexArray,s,l,-1,1),this.indexArray.emplaceBack(c,c+1,c+2),this.indexArray.emplaceBack(c,c+3,c+2),u.vertexLength+=4,u.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,{},i)}};C("CircleBucket",Ht,{omit:["layers"]});var Gn=Z(he(),1);function Fc(e,t){for(let r=0;r<e.length;r++)if(wr(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(wr(e,t[r]))return!0;return!!Es(e,t)}function Lc(e,t,r){return!!(wr(e,t)||Ms(t,e,r))}function Bo(e,t){if(e.length===1)return Ec(t,e[0]);for(let r=0;r<t.length;r++){let n=t[r];for(let i=0;i<n.length;i++)if(wr(e,n[i]))return!0}for(let r=0;r<e.length;r++)if(Ec(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(Es(e,t[r]))return!0;return!1}function Dc(e,t,r){for(let n=0;n<t.length;n++){let i=t[n];if(e.length>=3){for(let o=0;o<i.length;o++)if(wr(e,i[o]))return!0}if(yd(e,i,r))return!0}return!1}function yd(e,t,r){if(e.length>1){if(Es(e,t))return!0;for(let n=0;n<t.length;n++)if(Ms(t[n],e,r))return!0}for(let n=0;n<e.length;n++)if(Ms(e[n],t,r))return!0;return!1}function Es(e,t){if(e.length===0||t.length===0)return!1;for(let r=0;r<e.length-1;r++){let n=e[r],i=e[r+1];for(let o=0;o<t.length-1;o++){let a=t[o],s=t[o+1];if(md(n,i,a,s))return!0}}return!1}function md(e,t,r,n){return ot(e,r,n)!==ot(t,r,n)&&ot(e,t,r)!==ot(e,t,n)}function Ms(e,t,r){let n=r*r;if(t.length===1)return e.distSqr(t[0])<n;for(let i=1;i<t.length;i++){let o=t[i-1],a=t[i];if(Fs(e,o,a)<n)return!0}return!1}function Fs(e,t,r){let n=t.distSqr(r);if(n===0)return e.distSqr(t);let i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return i<0?e.distSqr(t):i>1?e.distSqr(r):e.distSqr(r.sub(t)._mult(i)._add(t))}function Ec(e,t){let r=!1,n,i,o;for(let a=0;a<e.length;a++){n=e[a];for(let s=0,l=n.length-1;s<n.length;l=s++)i=n[s],o=n[l],i.y>t.y!=o.y>t.y&&t.x<(o.x-i.x)*(t.y-i.y)/(o.y-i.y)+i.x&&(r=!r)}return r}function wr(e,t){let r=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){let o=e[n],a=e[i];o.y>t.y!=a.y>t.y&&t.x<(a.x-o.x)*(t.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function Vc(e,t,r,n,i){for(let a of e)if(t<=a.x&&r<=a.y&&n>=a.x&&i>=a.y)return!0;let o=[new Gn.default(t,r),new Gn.default(t,i),new Gn.default(n,i),new Gn.default(n,r)];if(e.length>2){for(let a of o)if(wr(e,a))return!0}for(let a=0;a<e.length-1;a++){let s=e[a],l=e[a+1];if(hd(s,l,o))return!0}return!1}function hd(e,t,r){let n=r[0],i=r[2];if(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y)return!1;let o=ot(e,t,r[0]);return o!==ot(e,t,r[1])||o!==ot(e,t,r[2])||o!==ot(e,t,r[3])}var zo=Z(he(),1);function Xt(e,t,r){let n=t.paint.get(e).value;return n.kind==="constant"?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function _t(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function It(e,t,r,n,i){if(!t[0]&&!t[1])return e;let o=zo.default.convert(t)._mult(i);r==="viewport"&&o._rotate(-n);let a=[];for(let s=0;s<e.length;s++){let l=e[s];a.push(l.sub(o))}return a}function Bc(e,t){let r=[];for(let n=0;n<e.length;n++){let i=e[n],o=[];for(let a=0;a<i.length;a++){let s=i[a-1],l=i[a],u=i[a+1],c=a===0?new zo.default(0,0):l.sub(s)._unit()._perp(),p=a===i.length-1?new zo.default(0,0):u.sub(l)._unit()._perp(),f=c._add(p)._unit(),y=f.x*p.x+f.y*p.y;y!==0&&f._mult(1/y),o.push(f._mult(t)._add(l))}r.push(o)}return r}var zc,dd=()=>zc=zc||new re({"circle-sort-key":new R(S.layout_circle["circle-sort-key"])}),Rc,gd=()=>Rc=Rc||new re({"circle-radius":new R(S.paint_circle["circle-radius"]),"circle-color":new R(S.paint_circle["circle-color"]),"circle-blur":new R(S.paint_circle["circle-blur"]),"circle-opacity":new R(S.paint_circle["circle-opacity"]),"circle-translate":new B(S.paint_circle["circle-translate"]),"circle-translate-anchor":new B(S.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new B(S.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new B(S.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new R(S.paint_circle["circle-stroke-width"]),"circle-stroke-color":new R(S.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new R(S.paint_circle["circle-stroke-opacity"])}),Oc={get paint(){return gd()},get layout(){return dd()}};var Q=1e-6,Ge=typeof Float32Array<"u"?Float32Array:Array,qn=Math.random;var N1=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var jn={};Ll(jn,{add:()=>tg,adjoint:()=>_d,clone:()=>bd,copy:()=>vd,create:()=>xd,determinant:()=>Id,equals:()=>og,exactEquals:()=>ig,frob:()=>eg,fromQuat:()=>qd,fromQuat2:()=>Od,fromRotation:()=>Vd,fromRotationTranslation:()=>Gc,fromRotationTranslationScale:()=>$d,fromRotationTranslationScaleOrigin:()=>Gd,fromScaling:()=>Dd,fromTranslation:()=>Ld,fromValues:()=>Pd,fromXRotation:()=>Bd,fromYRotation:()=>zd,fromZRotation:()=>Rd,frustum:()=>jd,getRotation:()=>Ud,getScaling:()=>qc,getTranslation:()=>Nd,identity:()=>Uc,invert:()=>Ad,lookAt:()=>Kd,mul:()=>ag,multiply:()=>$c,multiplyScalar:()=>rg,multiplyScalarAndAdd:()=>ng,ortho:()=>Hd,orthoNO:()=>Jc,orthoZO:()=>Xd,perspective:()=>Jd,perspectiveFromFieldOfView:()=>Wd,perspectiveNO:()=>jc,perspectiveZO:()=>Zd,rotate:()=>kd,rotateX:()=>Md,rotateY:()=>Ed,rotateZ:()=>Fd,scale:()=>Cd,set:()=>Sd,str:()=>Qd,sub:()=>sg,subtract:()=>Zc,targetTo:()=>Yd,translate:()=>Td,transpose:()=>wd});function xd(){var e=new Ge(16);return Ge!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function bd(e){var t=new Ge(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function vd(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Pd(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h){var d=new Ge(16);return d[0]=e,d[1]=t,d[2]=r,d[3]=n,d[4]=i,d[5]=o,d[6]=a,d[7]=s,d[8]=l,d[9]=u,d[10]=c,d[11]=p,d[12]=f,d[13]=y,d[14]=m,d[15]=h,d}function Sd(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=o,e[5]=a,e[6]=s,e[7]=l,e[8]=u,e[9]=c,e[10]=p,e[11]=f,e[12]=y,e[13]=m,e[14]=h,e[15]=d,e}function Uc(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function wd(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Ad(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],p=t[9],f=t[10],y=t[11],m=t[12],h=t[13],d=t[14],g=t[15],b=r*s-n*a,x=r*l-i*a,v=r*u-o*a,P=n*l-i*s,w=n*u-o*s,T=i*u-o*l,F=c*h-p*m,E=c*d-f*m,_=c*g-y*m,I=p*d-f*h,k=p*g-y*h,V=f*g-y*d,A=b*V-x*k+v*I+P*_-w*E+T*F;return A?(A=1/A,e[0]=(s*V-l*k+u*I)*A,e[1]=(i*k-n*V-o*I)*A,e[2]=(h*T-d*w+g*P)*A,e[3]=(f*w-p*T-y*P)*A,e[4]=(l*_-a*V-u*E)*A,e[5]=(r*V-i*_+o*E)*A,e[6]=(d*v-m*T-g*x)*A,e[7]=(c*T-f*v+y*x)*A,e[8]=(a*k-s*_+u*F)*A,e[9]=(n*_-r*k-o*F)*A,e[10]=(m*w-h*v+g*b)*A,e[11]=(p*v-c*w-y*b)*A,e[12]=(s*E-a*I-l*F)*A,e[13]=(r*I-n*E+i*F)*A,e[14]=(h*x-m*P-d*b)*A,e[15]=(c*P-p*x+f*b)*A,e):null}function _d(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],p=t[9],f=t[10],y=t[11],m=t[12],h=t[13],d=t[14],g=t[15];return e[0]=s*(f*g-y*d)-p*(l*g-u*d)+h*(l*y-u*f),e[1]=-(n*(f*g-y*d)-p*(i*g-o*d)+h*(i*y-o*f)),e[2]=n*(l*g-u*d)-s*(i*g-o*d)+h*(i*u-o*l),e[3]=-(n*(l*y-u*f)-s*(i*y-o*f)+p*(i*u-o*l)),e[4]=-(a*(f*g-y*d)-c*(l*g-u*d)+m*(l*y-u*f)),e[5]=r*(f*g-y*d)-c*(i*g-o*d)+m*(i*y-o*f),e[6]=-(r*(l*g-u*d)-a*(i*g-o*d)+m*(i*u-o*l)),e[7]=r*(l*y-u*f)-a*(i*y-o*f)+c*(i*u-o*l),e[8]=a*(p*g-y*h)-c*(s*g-u*h)+m*(s*y-u*p),e[9]=-(r*(p*g-y*h)-c*(n*g-o*h)+m*(n*y-o*p)),e[10]=r*(s*g-u*h)-a*(n*g-o*h)+m*(n*u-o*s),e[11]=-(r*(s*y-u*p)-a*(n*y-o*p)+c*(n*u-o*s)),e[12]=-(a*(p*d-f*h)-c*(s*d-l*h)+m*(s*f-l*p)),e[13]=r*(p*d-f*h)-c*(n*d-i*h)+m*(n*f-i*p),e[14]=-(r*(s*d-l*h)-a*(n*d-i*h)+m*(n*l-i*s)),e[15]=r*(s*f-l*p)-a*(n*f-i*p)+c*(n*l-i*s),e}function Id(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],p=e[10],f=e[11],y=e[12],m=e[13],h=e[14],d=e[15],g=t*a-r*o,b=t*s-n*o,x=t*l-i*o,v=r*s-n*a,P=r*l-i*a,w=n*l-i*s,T=u*m-c*y,F=u*h-p*y,E=u*d-f*y,_=c*h-p*m,I=c*d-f*m,k=p*d-f*h;return g*k-b*I+x*_+v*E-P*F+w*T}function $c(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],p=t[8],f=t[9],y=t[10],m=t[11],h=t[12],d=t[13],g=t[14],b=t[15],x=r[0],v=r[1],P=r[2],w=r[3];return e[0]=x*n+v*s+P*p+w*h,e[1]=x*i+v*l+P*f+w*d,e[2]=x*o+v*u+P*y+w*g,e[3]=x*a+v*c+P*m+w*b,x=r[4],v=r[5],P=r[6],w=r[7],e[4]=x*n+v*s+P*p+w*h,e[5]=x*i+v*l+P*f+w*d,e[6]=x*o+v*u+P*y+w*g,e[7]=x*a+v*c+P*m+w*b,x=r[8],v=r[9],P=r[10],w=r[11],e[8]=x*n+v*s+P*p+w*h,e[9]=x*i+v*l+P*f+w*d,e[10]=x*o+v*u+P*y+w*g,e[11]=x*a+v*c+P*m+w*b,x=r[12],v=r[13],P=r[14],w=r[15],e[12]=x*n+v*s+P*p+w*h,e[13]=x*i+v*l+P*f+w*d,e[14]=x*o+v*u+P*y+w*g,e[15]=x*a+v*c+P*m+w*b,e}function Td(e,t,r){var n=r[0],i=r[1],o=r[2],a,s,l,u,c,p,f,y,m,h,d,g;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*o+t[12],e[13]=t[1]*n+t[5]*i+t[9]*o+t[13],e[14]=t[2]*n+t[6]*i+t[10]*o+t[14],e[15]=t[3]*n+t[7]*i+t[11]*o+t[15]):(a=t[0],s=t[1],l=t[2],u=t[3],c=t[4],p=t[5],f=t[6],y=t[7],m=t[8],h=t[9],d=t[10],g=t[11],e[0]=a,e[1]=s,e[2]=l,e[3]=u,e[4]=c,e[5]=p,e[6]=f,e[7]=y,e[8]=m,e[9]=h,e[10]=d,e[11]=g,e[12]=a*n+c*i+m*o+t[12],e[13]=s*n+p*i+h*o+t[13],e[14]=l*n+f*i+d*o+t[14],e[15]=u*n+y*i+g*o+t[15]),e}function Cd(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function kd(e,t,r,n){var i=n[0],o=n[1],a=n[2],s=Math.hypot(i,o,a),l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F,E,_,I,k,V,A,z;return s<Q?null:(s=1/s,i*=s,o*=s,a*=s,l=Math.sin(r),u=Math.cos(r),c=1-u,p=t[0],f=t[1],y=t[2],m=t[3],h=t[4],d=t[5],g=t[6],b=t[7],x=t[8],v=t[9],P=t[10],w=t[11],T=i*i*c+u,F=o*i*c+a*l,E=a*i*c-o*l,_=i*o*c-a*l,I=o*o*c+u,k=a*o*c+i*l,V=i*a*c+o*l,A=o*a*c-i*l,z=a*a*c+u,e[0]=p*T+h*F+x*E,e[1]=f*T+d*F+v*E,e[2]=y*T+g*F+P*E,e[3]=m*T+b*F+w*E,e[4]=p*_+h*I+x*k,e[5]=f*_+d*I+v*k,e[6]=y*_+g*I+P*k,e[7]=m*_+b*I+w*k,e[8]=p*V+h*A+x*z,e[9]=f*V+d*A+v*z,e[10]=y*V+g*A+P*z,e[11]=m*V+b*A+w*z,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Md(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],p=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+u*n,e[5]=a*i+c*n,e[6]=s*i+p*n,e[7]=l*i+f*n,e[8]=u*i-o*n,e[9]=c*i-a*n,e[10]=p*i-s*n,e[11]=f*i-l*n,e}function Ed(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],u=t[8],c=t[9],p=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-u*n,e[1]=a*i-c*n,e[2]=s*i-p*n,e[3]=l*i-f*n,e[8]=o*n+u*i,e[9]=a*n+c*i,e[10]=s*n+p*i,e[11]=l*n+f*i,e}function Fd(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],c=t[5],p=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+u*n,e[1]=a*i+c*n,e[2]=s*i+p*n,e[3]=l*i+f*n,e[4]=u*i-o*n,e[5]=c*i-a*n,e[6]=p*i-s*n,e[7]=f*i-l*n,e}function Ld(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Dd(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Vd(e,t,r){var n=r[0],i=r[1],o=r[2],a=Math.hypot(n,i,o),s,l,u;return a<Q?null:(a=1/a,n*=a,i*=a,o*=a,s=Math.sin(t),l=Math.cos(t),u=1-l,e[0]=n*n*u+l,e[1]=i*n*u+o*s,e[2]=o*n*u-i*s,e[3]=0,e[4]=n*i*u-o*s,e[5]=i*i*u+l,e[6]=o*i*u+n*s,e[7]=0,e[8]=n*o*u+i*s,e[9]=i*o*u-n*s,e[10]=o*o*u+l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Bd(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function zd(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Rd(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Gc(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=n+n,l=i+i,u=o+o,c=n*s,p=n*l,f=n*u,y=i*l,m=i*u,h=o*u,d=a*s,g=a*l,b=a*u;return e[0]=1-(y+h),e[1]=p+b,e[2]=f-g,e[3]=0,e[4]=p-b,e[5]=1-(c+h),e[6]=m+d,e[7]=0,e[8]=f+g,e[9]=m-d,e[10]=1-(c+y),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Od(e,t){var r=new Ge(3),n=-t[0],i=-t[1],o=-t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],p=n*n+i*i+o*o+a*a;return p>0?(r[0]=(s*a+c*n+l*o-u*i)*2/p,r[1]=(l*a+c*i+u*n-s*o)*2/p,r[2]=(u*a+c*o+s*i-l*n)*2/p):(r[0]=(s*a+c*n+l*o-u*i)*2,r[1]=(l*a+c*i+u*n-s*o)*2,r[2]=(u*a+c*o+s*i-l*n)*2),Gc(e,t,r),e}function Nd(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function qc(e,t){var r=t[0],n=t[1],i=t[2],o=t[4],a=t[5],s=t[6],l=t[8],u=t[9],c=t[10];return e[0]=Math.hypot(r,n,i),e[1]=Math.hypot(o,a,s),e[2]=Math.hypot(l,u,c),e}function Ud(e,t){var r=new Ge(3);qc(r,t);var n=1/r[0],i=1/r[1],o=1/r[2],a=t[0]*n,s=t[1]*i,l=t[2]*o,u=t[4]*n,c=t[5]*i,p=t[6]*o,f=t[8]*n,y=t[9]*i,m=t[10]*o,h=a+c+m,d=0;return h>0?(d=Math.sqrt(h+1)*2,e[3]=.25*d,e[0]=(p-y)/d,e[1]=(f-l)/d,e[2]=(s-u)/d):a>c&&a>m?(d=Math.sqrt(1+a-c-m)*2,e[3]=(p-y)/d,e[0]=.25*d,e[1]=(s+u)/d,e[2]=(f+l)/d):c>m?(d=Math.sqrt(1+c-a-m)*2,e[3]=(f-l)/d,e[0]=(s+u)/d,e[1]=.25*d,e[2]=(p+y)/d):(d=Math.sqrt(1+m-a-c)*2,e[3]=(s-u)/d,e[0]=(f+l)/d,e[1]=(p+y)/d,e[2]=.25*d),e}function $d(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=t[3],l=i+i,u=o+o,c=a+a,p=i*l,f=i*u,y=i*c,m=o*u,h=o*c,d=a*c,g=s*l,b=s*u,x=s*c,v=n[0],P=n[1],w=n[2];return e[0]=(1-(m+d))*v,e[1]=(f+x)*v,e[2]=(y-b)*v,e[3]=0,e[4]=(f-x)*P,e[5]=(1-(p+d))*P,e[6]=(h+g)*P,e[7]=0,e[8]=(y+b)*w,e[9]=(h-g)*w,e[10]=(1-(p+m))*w,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Gd(e,t,r,n,i){var o=t[0],a=t[1],s=t[2],l=t[3],u=o+o,c=a+a,p=s+s,f=o*u,y=o*c,m=o*p,h=a*c,d=a*p,g=s*p,b=l*u,x=l*c,v=l*p,P=n[0],w=n[1],T=n[2],F=i[0],E=i[1],_=i[2],I=(1-(h+g))*P,k=(y+v)*P,V=(m-x)*P,A=(y-v)*w,z=(1-(f+g))*w,O=(d+b)*w,N=(m+x)*T,K=(d-b)*T,xe=(1-(f+h))*T;return e[0]=I,e[1]=k,e[2]=V,e[3]=0,e[4]=A,e[5]=z,e[6]=O,e[7]=0,e[8]=N,e[9]=K,e[10]=xe,e[11]=0,e[12]=r[0]+F-(I*F+A*E+N*_),e[13]=r[1]+E-(k*F+z*E+K*_),e[14]=r[2]+_-(V*F+O*E+xe*_),e[15]=1,e}function qd(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,l=i+i,u=r*a,c=n*a,p=n*s,f=i*a,y=i*s,m=i*l,h=o*a,d=o*s,g=o*l;return e[0]=1-p-m,e[1]=c+g,e[2]=f-d,e[3]=0,e[4]=c-g,e[5]=1-u-m,e[6]=y+h,e[7]=0,e[8]=f+d,e[9]=y-h,e[10]=1-u-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function jd(e,t,r,n,i,o,a){var s=1/(r-t),l=1/(i-n),u=1/(o-a);return e[0]=o*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*l,e[10]=(a+o)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*u,e[15]=0,e}function jc(e,t,r,n,i){var o=1/Math.tan(t/2),a;return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e}var Jd=jc;function Zd(e,t,r,n,i){var o=1/Math.tan(t/2),a;return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0?(a=1/(n-i),e[10]=i*a,e[14]=i*n*a):(e[10]=-1,e[14]=-n),e}function Wd(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),o=Math.tan(t.downDegrees*Math.PI/180),a=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),l=2/(a+s),u=2/(i+o);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-((a-s)*l*.5),e[9]=(i-o)*u*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function Jc(e,t,r,n,i,o,a){var s=1/(t-r),l=1/(n-i),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(a+o)*u,e[15]=1,e}var Hd=Jc;function Xd(e,t,r,n,i,o,a){var s=1/(t-r),l=1/(n-i),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=o*u,e[15]=1,e}function Kd(e,t,r,n){var i,o,a,s,l,u,c,p,f,y,m=t[0],h=t[1],d=t[2],g=n[0],b=n[1],x=n[2],v=r[0],P=r[1],w=r[2];return Math.abs(m-v)<Q&&Math.abs(h-P)<Q&&Math.abs(d-w)<Q?Uc(e):(c=m-v,p=h-P,f=d-w,y=1/Math.hypot(c,p,f),c*=y,p*=y,f*=y,i=b*f-x*p,o=x*c-g*f,a=g*p-b*c,y=Math.hypot(i,o,a),y?(y=1/y,i*=y,o*=y,a*=y):(i=0,o=0,a=0),s=p*a-f*o,l=f*i-c*a,u=c*o-p*i,y=Math.hypot(s,l,u),y?(y=1/y,s*=y,l*=y,u*=y):(s=0,l=0,u=0),e[0]=i,e[1]=s,e[2]=c,e[3]=0,e[4]=o,e[5]=l,e[6]=p,e[7]=0,e[8]=a,e[9]=u,e[10]=f,e[11]=0,e[12]=-(i*m+o*h+a*d),e[13]=-(s*m+l*h+u*d),e[14]=-(c*m+p*h+f*d),e[15]=1,e)}function Yd(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=n[0],l=n[1],u=n[2],c=i-r[0],p=o-r[1],f=a-r[2],y=c*c+p*p+f*f;y>0&&(y=1/Math.sqrt(y),c*=y,p*=y,f*=y);var m=l*f-u*p,h=u*c-s*f,d=s*p-l*c;return y=m*m+h*h+d*d,y>0&&(y=1/Math.sqrt(y),m*=y,h*=y,d*=y),e[0]=m,e[1]=h,e[2]=d,e[3]=0,e[4]=p*d-f*h,e[5]=f*m-c*d,e[6]=c*h-p*m,e[7]=0,e[8]=c,e[9]=p,e[10]=f,e[11]=0,e[12]=i,e[13]=o,e[14]=a,e[15]=1,e}function Qd(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function eg(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function tg(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Zc(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function rg(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function ng(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function ig(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function og(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],f=e[10],y=e[11],m=e[12],h=e[13],d=e[14],g=e[15],b=t[0],x=t[1],v=t[2],P=t[3],w=t[4],T=t[5],F=t[6],E=t[7],_=t[8],I=t[9],k=t[10],V=t[11],A=t[12],z=t[13],O=t[14],N=t[15];return Math.abs(r-b)<=Q*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-x)<=Q*Math.max(1,Math.abs(n),Math.abs(x))&&Math.abs(i-v)<=Q*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(o-P)<=Q*Math.max(1,Math.abs(o),Math.abs(P))&&Math.abs(a-w)<=Q*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-T)<=Q*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(l-F)<=Q*Math.max(1,Math.abs(l),Math.abs(F))&&Math.abs(u-E)<=Q*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-_)<=Q*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(p-I)<=Q*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(f-k)<=Q*Math.max(1,Math.abs(f),Math.abs(k))&&Math.abs(y-V)<=Q*Math.max(1,Math.abs(y),Math.abs(V))&&Math.abs(m-A)<=Q*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(h-z)<=Q*Math.max(1,Math.abs(h),Math.abs(z))&&Math.abs(d-O)<=Q*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(g-N)<=Q*Math.max(1,Math.abs(g),Math.abs(N))}var ag=$c,sg=Zc;var Kt={};Ll(Kt,{add:()=>fg,ceil:()=>yg,clone:()=>lg,copy:()=>cg,create:()=>Wc,cross:()=>Ag,dist:()=>Bg,distance:()=>Yc,div:()=>Vg,divide:()=>Kc,dot:()=>wg,equals:()=>Fg,exactEquals:()=>Eg,floor:()=>mg,forEach:()=>Ng,fromValues:()=>ug,inverse:()=>Pg,len:()=>Rg,length:()=>ep,lerp:()=>_g,max:()=>dg,min:()=>hg,mul:()=>Dg,multiply:()=>Xc,negate:()=>vg,normalize:()=>Sg,random:()=>Ig,round:()=>gg,scale:()=>xg,scaleAndAdd:()=>bg,set:()=>pg,sqrDist:()=>zg,sqrLen:()=>Og,squaredDistance:()=>Qc,squaredLength:()=>tp,str:()=>Mg,sub:()=>Lg,subtract:()=>Hc,transformMat4:()=>Tg,transformQuat:()=>Cg,zero:()=>kg});function Wc(){var e=new Ge(4);return Ge!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function lg(e){var t=new Ge(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function ug(e,t,r,n){var i=new Ge(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function cg(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function pg(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function fg(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Hc(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function Xc(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function Kc(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function yg(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function mg(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function hg(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function dg(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function gg(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function xg(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function bg(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function Yc(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.hypot(r,n,i,o)}function Qc(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+i*i+o*o}function ep(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.hypot(t,r,n,i)}function tp(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function vg(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function Pg(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Sg(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=o*a,e}function wg(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Ag(e,t,r,n){var i=r[0]*n[1]-r[1]*n[0],o=r[0]*n[2]-r[2]*n[0],a=r[0]*n[3]-r[3]*n[0],s=r[1]*n[2]-r[2]*n[1],l=r[1]*n[3]-r[3]*n[1],u=r[2]*n[3]-r[3]*n[2],c=t[0],p=t[1],f=t[2],y=t[3];return e[0]=p*u-f*l+y*s,e[1]=-(c*u)+f*a-y*o,e[2]=c*l-p*a+y*i,e[3]=-(c*s)+p*o-f*i,e}function _g(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e[3]=s+n*(r[3]-s),e}function Ig(e,t){t=t||1;var r,n,i,o,a,s;do r=qn()*2-1,n=qn()*2-1,a=r*r+n*n;while(a>=1);do i=qn()*2-1,o=qn()*2-1,s=i*i+o*o;while(s>=1);var l=Math.sqrt((1-a)/s);return e[0]=t*r,e[1]=t*n,e[2]=t*i*l,e[3]=t*o*l,e}function Tg(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}function Cg(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*i,p=u*i+l*n-a*o,f=u*o+a*i-s*n,y=-a*n-s*i-l*o;return e[0]=c*u+y*-a+p*-l-f*-s,e[1]=p*u+y*-s+f*-a-c*-l,e[2]=f*u+y*-l+c*-s-p*-a,e[3]=t[3],e}function kg(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Mg(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Eg(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Fg(e,t){var r=e[0],n=e[1],i=e[2],o=e[3],a=t[0],s=t[1],l=t[2],u=t[3];return Math.abs(r-a)<=Q*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=Q*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-l)<=Q*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-u)<=Q*Math.max(1,Math.abs(o),Math.abs(u))}var Lg=Hc,Dg=Xc,Vg=Kc,Bg=Yc,zg=Qc,Rg=ep,Og=tp,Ng=function(){var e=Wc();return function(t,r,n,i,o,a){var s,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();var rp=Z(he(),1),Ro=class extends se{constructor(t){super(t,Oc)}createBucket(t){return new Ht(t)}queryRadius(t){let r=t;return Xt("circle-radius",this,r)+Xt("circle-stroke-width",this,r)+_t(this.paint.get("circle-translate"))}queryIntersectsFeature(t,r,n,i,o,a,s,l){let u=It(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,s),c=this.paint.get("circle-radius").evaluate(r,n),p=this.paint.get("circle-stroke-width").evaluate(r,n),f=c+p,y=this.paint.get("circle-pitch-alignment")==="map",m=y?u:Ug(u,l),h=y?f*s:f;for(let d of i)for(let g of d){let b=y?g:np(g,l),x=h,v=Kt.transformMat4([],[g.x,g.y,0,1],l);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?x*=v[3]/a.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(x*=a.cameraToCenterDistance/v[3]),Lc(m,b,x))return!0}return!1}};function np(e,t){let r=Kt.transformMat4([],[e.x,e.y,0,1],t);return new rp.default(r[0]/r[3],r[1]/r[3])}function Ug(e,t){return e.map(r=>np(r,t))}var Jn=class extends Ht{};C("HeatmapBucket",Jn,{omit:["layers"]});var ip,$g=()=>ip=ip||new re({"heatmap-radius":new R(S.paint_heatmap["heatmap-radius"]),"heatmap-weight":new R(S.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new B(S.paint_heatmap["heatmap-intensity"]),"heatmap-color":new jt(S.paint_heatmap["heatmap-color"]),"heatmap-opacity":new B(S.paint_heatmap["heatmap-opacity"])}),op={get paint(){return $g()}};function Ls(e,{width:t,height:r},n,i){if(!i)i=new Uint8Array(t*r*n);else if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==t*r*n)throw new RangeError(`mismatched image size. expected: ${i.length} but got: ${t*r*n}`);return e.width=t,e.height=r,e.data=i,e}function ap(e,{width:t,height:r},n){if(t===e.width&&r===e.height)return;let i=Ls({},{width:t,height:r},n);Ds(e,i,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,t),height:Math.min(e.height,r)},n),e.width=t,e.height=r,e.data=i.data}function Ds(e,t,r,n,i,o){if(i.width===0||i.height===0)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");let a=e.data,s=t.data;if(a===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){let u=((r.y+l)*e.width+r.x)*o,c=((n.y+l)*t.width+n.x)*o;for(let p=0;p<i.width*o;p++)s[c+p]=a[u+p]}return t}var Yt=class e{constructor(t,r){Ls(this,t,1,r)}resize(t){ap(this,t,1)}clone(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,n,i,o){Ds(t,r,n,i,o,1)}},de=class e{constructor(t,r){Ls(this,t,4,r)}resize(t){ap(this,t,4)}replace(t,r){r?this.data.set(t):t instanceof Uint8ClampedArray?this.data=new Uint8Array(t.buffer):this.data=t}clone(){return new e({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,r,n,i,o){Ds(t,r,n,i,o,4)}};C("AlphaImage",Yt);C("RGBAImage",de);function sp(e){let t={},r=e.resolution||256,n=e.clips?e.clips.length:1,i=e.image||new de({width:r,height:n});if(!ql(r))throw new Error(`width is not a power of 2 - ${r}`);let o=(a,s,l)=>{t[e.evaluationKey]=l;let u=e.expression.evaluate(t);i.data[a+s+0]=Math.floor(u.r*255/u.a),i.data[a+s+1]=Math.floor(u.g*255/u.a),i.data[a+s+2]=Math.floor(u.b*255/u.a),i.data[a+s+3]=Math.floor(u.a*255)};if(e.clips)for(let a=0,s=0;a<n;++a,s+=r*4)for(let l=0,u=0;l<r;l++,u+=4){let c=l/(r-1),{start:p,end:f}=e.clips[a],y=p*(1-c)+f*c;o(s,u,y)}else for(let a=0,s=0;a<r;a++,s+=4){let l=a/(r-1);o(0,s,l)}return i}var Oo=class extends se{createBucket(t){return new Jn(t)}constructor(t){super(t,op),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){let t=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=sp({expression:t,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}};var lp,Gg=()=>lp=lp||new re({"hillshade-illumination-direction":new B(S.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new B(S.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new B(S.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new B(S.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new B(S.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new B(S.paint_hillshade["hillshade-accent-color"])}),up={get paint(){return Gg()}};var No=class extends se{constructor(t){super(t,up)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}};var qg=Y([{name:"a_pos",components:2,type:"Int16"}],4);var{members:cp,size:LP,alignment:DP}=qg;var dp=Z(Os(),1);function Ns(e,t,r,n,i){hp(e,t,r||0,n||e.length-1,i||ax)}function hp(e,t,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=t-r+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1),c=Math.max(r,Math.floor(t-a*l/o+u)),p=Math.min(n,Math.floor(t+(o-a)*l/o+u));hp(e,t,c,p,i)}var f=e[t],y=r,m=n;for(Xn(e,r,t),i(e[n],f)>0&&Xn(e,r,n);y<m;){for(Xn(e,y,m),y++,m--;i(e[y],f)<0;)y++;for(;i(e[m],f)>0;)m--}i(e[r],f)===0?Xn(e,r,m):(m++,Xn(e,m,n)),m<=t&&(r=m+1),t<=m&&(n=m-1)}}function Xn(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function ax(e,t){return e<t?-1:e>t?1:0}function _r(e,t){let r=e.length;if(r<=1)return[e];let n=[],i,o;for(let a=0;a<r;a++){let s=Zl(e[a]);s!==0&&(e[a].area=Math.abs(s),o===void 0&&(o=s<0),o===s<0?(i&&n.push(i),i=[e[a]]):i.push(e[a]))}if(i&&n.push(i),t>1)for(let a=0;a<n.length;a++)n[a].length<=t||(Ns(n[a],t,1,n[a].length-1,sx),n[a]=n[a].slice(0,t));return n}function sx(e,t){return t.area-e.area}function Ir(e,t,r){let n=r.patternDependencies,i=!1;for(let o of t){let a=o.paint.get(`${e}-pattern`);a.isConstant()||(i=!0);let s=a.constantOr(null);s&&(i=!0,n[s.to]=!0,n[s.from]=!0)}return i}function Tr(e,t,r,n,i){let o=i.patternDependencies;for(let a of t){let l=a.paint.get(`${e}-pattern`).value;if(l.kind!=="constant"){let u=l.evaluate({zoom:n-1},r,{},i.availableImages),c=l.evaluate({zoom:n},r,{},i.availableImages),p=l.evaluate({zoom:n+1},r,{},i.availableImages);u=u&&u.name?u.name:u,c=c&&c.name?c.name:c,p=p&&p.name?p.name:p,o[u]=!0,o[c]=!0,o[p]=!0,r.patterns[a.id]={min:u,mid:c,max:p}}}return r}var lx=500,er=class{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new So,this.indexArray=new Le,this.indexArray2=new wt,this.programConfigurations=new Ce(t.layers,t.zoom),this.segments=new me,this.segments2=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,n){this.hasPattern=Ir("fill",this.layers,r);let i=this.layers[0].layout.get("fill-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of t){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n,r.availableImages):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=Tr("fill",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=t[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,n)}addFeatures(t,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,cp),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,r,n,i,o){for(let a of _r(r,lx)){let s=0;for(let y of a)s+=y.length;let l=this.segments.prepareSegment(s,this.layoutVertexArray,this.indexArray),u=l.vertexLength,c=[],p=[];for(let y of a){if(y.length===0)continue;y!==a[0]&&p.push(c.length/2);let m=this.segments2.prepareSegment(y.length,this.layoutVertexArray,this.indexArray2),h=m.vertexLength;this.layoutVertexArray.emplaceBack(y[0].x,y[0].y),this.indexArray2.emplaceBack(h+y.length-1,h),c.push(y[0].x),c.push(y[0].y);for(let d=1;d<y.length;d++)this.layoutVertexArray.emplaceBack(y[d].x,y[d].y),this.indexArray2.emplaceBack(h+d-1,h+d),c.push(y[d].x),c.push(y[d].y);m.vertexLength+=y.length,m.primitiveLength+=y.length}let f=(0,dp.default)(c,p);for(let y=0;y<f.length;y+=3)this.indexArray.emplaceBack(u+f[y],u+f[y+1],u+f[y+2]);l.vertexLength+=s,l.primitiveLength+=f.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,o,i)}};C("FillBucket",er,{omit:["layers","patternFeatures"]});var gp,ux=()=>gp=gp||new re({"fill-sort-key":new R(S.layout_fill["fill-sort-key"])}),xp,cx=()=>xp=xp||new re({"fill-antialias":new B(S.paint_fill["fill-antialias"]),"fill-opacity":new R(S.paint_fill["fill-opacity"]),"fill-color":new R(S.paint_fill["fill-color"]),"fill-outline-color":new R(S.paint_fill["fill-outline-color"]),"fill-translate":new B(S.paint_fill["fill-translate"]),"fill-translate-anchor":new B(S.paint_fill["fill-translate-anchor"]),"fill-pattern":new lt(S.paint_fill["fill-pattern"])}),bp={get paint(){return cx()},get layout(){return ux()}};var jo=class extends se{constructor(t){super(t,bp)}recalculate(t,r){super.recalculate(t,r);let n=this.paint._values["fill-outline-color"];n.value.kind==="constant"&&n.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new er(t)}queryRadius(){return _t(this.paint.get("fill-translate"))}queryIntersectsFeature(t,r,n,i,o,a,s){let l=It(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,s);return Bo(l,i)}isTileClipped(){return!0}};var px=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),vp=Y([{name:"a_centroid",components:2,type:"Int16"}],4);var{members:Pp,size:dS,alignment:gS}=px;var Tp=Z(Os(),1),Cp=Z(Tt(),1);var wx=Cp.default.VectorTileFeature.types,Ax=500,Gs=Math.pow(2,13);function Kn(e,t,r,n,i,o,a,s){e.emplaceBack(t,r,Math.floor(n*Gs)*2+a,i*Gs*2,o*Gs*2,Math.round(s))}var tr=class{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new wo,this.centroidVertexArray=new vo,this.indexArray=new Le,this.programConfigurations=new Ce(t.layers,t.zoom),this.segments=new me,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,n){this.features=[],this.hasPattern=Ir("fill-extrusion",this.layers,r);for(let{feature:i,id:o,index:a,sourceLayerIndex:s}of t){let l=this.layers[0]._featureFilter.needGeometry,u=$e(i,l);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),u,n))continue;let c={id:o,sourceLayerIndex:s,index:a,geometry:l?u.geometry:ke(i),properties:i.properties,type:i.type,patterns:{}};this.hasPattern?this.features.push(Tr("fill-extrusion",this.layers,c,this.zoom,r)):this.addFeature(c,c.geometry,a,n,{}),r.featureIndex.insert(i,c.geometry,a,s,this.index,!0)}}addFeatures(t,r,n){for(let i of this.features){let{geometry:o}=i;this.addFeature(i,o,i.index,r,n)}}update(t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,n)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pp),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,vp.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,r,n,i,o){let a={x:0,y:0,vertexCount:0};for(let s of _r(r,Ax)){let l=0;for(let m of s)l+=m.length;let u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let m of s){if(m.length===0||Ix(m))continue;let h=0;for(let d=0;d<m.length;d++){let g=m[d];if(d>=1){let b=m[d-1];if(!_x(g,b)){u.vertexLength+4>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let x=g.sub(b)._perp()._unit(),v=b.dist(g);h+v>32768&&(h=0),Kn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,0,h),Kn(this.layoutVertexArray,g.x,g.y,x.x,x.y,0,1,h),a.x+=2*g.x,a.y+=2*g.y,a.vertexCount+=2,h+=v,Kn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,0,h),Kn(this.layoutVertexArray,b.x,b.y,x.x,x.y,0,1,h),a.x+=2*b.x,a.y+=2*b.y,a.vertexCount+=2;let P=u.vertexLength;this.indexArray.emplaceBack(P,P+2,P+1),this.indexArray.emplaceBack(P+1,P+2,P+3),u.vertexLength+=4,u.primitiveLength+=2}}}}if(u.vertexLength+l>me.MAX_VERTEX_ARRAY_LENGTH&&(u=this.segments.prepareSegment(l,this.layoutVertexArray,this.indexArray)),wx[t.type]!=="Polygon")continue;let c=[],p=[],f=u.vertexLength;for(let m of s)if(m.length!==0){m!==s[0]&&p.push(c.length/2);for(let h=0;h<m.length;h++){let d=m[h];Kn(this.layoutVertexArray,d.x,d.y,0,0,1,1,0),a.x+=d.x,a.y+=d.y,a.vertexCount+=1,c.push(d.x),c.push(d.y)}}let y=(0,Tp.default)(c,p);for(let m=0;m<y.length;m+=3)this.indexArray.emplaceBack(f+y[m],f+y[m+2],f+y[m+1]);u.primitiveLength+=y.length/3,u.vertexLength+=l}for(let s=0;s<a.vertexCount;s++)this.centroidVertexArray.emplaceBack(Math.floor(a.x/a.vertexCount),Math.floor(a.y/a.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,o,i)}};C("FillExtrusionBucket",tr,{omit:["layers","features"]});function _x(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}function Ix(e){return e.every(t=>t.x<0)||e.every(t=>t.x>8192)||e.every(t=>t.y<0)||e.every(t=>t.y>8192)}var kp,Tx=()=>kp=kp||new re({"fill-extrusion-opacity":new B(S["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new R(S["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new B(S["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new B(S["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new lt(S["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new R(S["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new R(S["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new B(S["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),Mp={get paint(){return Tx()}};var Zo=Z(he(),1);var Wo=class extends se{constructor(t){super(t,Mp)}createBucket(t){return new tr(t)}queryRadius(){return _t(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,r,n,i,o,a,s,l){let u=It(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(r,n),p=this.paint.get("fill-extrusion-base").evaluate(r,n),f=Mx(u,l,a,0),y=kx(i,p,c,l),m=y[0],h=y[1];return Cx(m,h,f)}};function Yn(e,t){return e.x*t.x+e.y*t.y}function Ep(e,t){if(e.length===1){let r=0,n=t[r++],i;for(;!i||n.equals(i);)if(i=t[r++],!i)return 1/0;for(;r<t.length;r++){let o=t[r],a=e[0],s=i.sub(n),l=o.sub(n),u=a.sub(n),c=Yn(s,s),p=Yn(s,l),f=Yn(l,l),y=Yn(u,s),m=Yn(u,l),h=c*f-p*p,d=(f*y-p*m)/h,g=(c*m-p*y)/h,b=1-d-g,x=n.z*b+i.z*d+o.z*g;if(isFinite(x))return x}return 1/0}else{let r=1/0;for(let n of t)r=Math.min(r,n.z);return r}}function Cx(e,t,r){let n=1/0;Bo(r,t)&&(n=Ep(r,t[0]));for(let i=0;i<t.length;i++){let o=t[i],a=e[i];for(let s=0;s<o.length-1;s++){let l=o[s],u=o[s+1],c=a[s],p=a[s+1],f=[l,u,p,c,l];Fc(r,f)&&(n=Math.min(n,Ep(r,f)))}}return n===1/0?!1:n}function kx(e,t,r,n){let i=[],o=[],a=n[8]*t,s=n[9]*t,l=n[10]*t,u=n[11]*t,c=n[8]*r,p=n[9]*r,f=n[10]*r,y=n[11]*r;for(let m of e){let h=[],d=[];for(let g of m){let b=g.x,x=g.y,v=n[0]*b+n[4]*x+n[12],P=n[1]*b+n[5]*x+n[13],w=n[2]*b+n[6]*x+n[14],T=n[3]*b+n[7]*x+n[15],F=v+a,E=P+s,_=w+l,I=T+u,k=v+c,V=P+p,A=w+f,z=T+y,O=new Zo.default(F/I,E/I);O.z=_/I,h.push(O);let N=new Zo.default(k/z,V/z);N.z=A/z,d.push(N)}i.push(h),o.push(d)}return[i,o]}function Mx(e,t,r,n){let i=[];for(let o of e){let a=[o.x,o.y,n,1];Kt.transformMat4(a,a,t),i.push(new Zo.default(a[0]/a[3],a[1]/a[3]))}return i}var Ex=Y([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Fp,size:QS,alignment:ew}=Ex;var Fx=Y([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Lp,size:nw,alignment:iw}=Fx;var Bp=Z(Tt(),1);var Lx=Bp.default.VectorTileFeature.types,Dp=63,Dx=Math.cos(75/2*(Math.PI/180)),Vx=15,Bx=20,zx=15,zp=1/2,Vp=Math.pow(2,zx-1)/zp,rr=class{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(r=>r.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new Ao,this.layoutVertexArray2=new _o,this.indexArray=new Le,this.programConfigurations=new Ce(t.layers,t.zoom),this.segments=new me,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(t,r,n){this.hasPattern=Ir("line",this.layers,r);let i=this.layers[0].layout.get("line-sort-key"),o=!i.isConstant(),a=[];for(let{feature:s,id:l,index:u,sourceLayerIndex:c}of t){let p=this.layers[0]._featureFilter.needGeometry,f=$e(s,p);if(!this.layers[0]._featureFilter.filter(new q(this.zoom),f,n))continue;let y=o?i.evaluate(f,{},n):void 0,m={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:p?f.geometry:ke(s),patterns:{},sortKey:y};a.push(m)}o&&a.sort((s,l)=>s.sortKey-l.sortKey);for(let s of a){let{geometry:l,index:u,sourceLayerIndex:c}=s;if(this.hasPattern){let f=Tr("line",this.layers,s,this.zoom,r);this.patternFeatures.push(f)}else this.addFeature(s,l,u,n,{});let p=t[u].feature;r.featureIndex.insert(p,l,u,c,this.index)}}update(t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,r,this.stateDependentLayers,n)}addFeatures(t,r,n){for(let i of this.patternFeatures)this.addFeature(i,i.geometry,i.index,r,n)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Lp)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Fp),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end")){let r=+t.properties.mapbox_clip_start,n=+t.properties.mapbox_clip_end;return{start:r,end:n}}}addFeature(t,r,n,i,o){let a=this.layers[0].layout,s=a.get("line-join").evaluate(t,{}),l=a.get("line-cap"),u=a.get("line-miter-limit"),c=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(let p of r)this.addLine(p,t,s,l,u,c);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,n,o,i)}addLine(t,r,n,i,o,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let g=0;g<t.length-1;g++)this.totalDistance+=t[g].dist(t[g+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let s=Lx[r.type]==="Polygon",l=t.length;for(;l>=2&&t[l-1].equals(t[l-2]);)l--;let u=0;for(;u<l-1&&t[u].equals(t[u+1]);)u++;if(l<(s?3:2))return;n==="bevel"&&(o=1.05);let c=this.overscaling<=16?Vx*8192/(512*this.overscaling):0,p=this.segments.prepareSegment(l*10,this.layoutVertexArray,this.indexArray),f,y,m,h,d;this.e1=this.e2=-1,s&&(f=t[l-2],d=t[u].sub(f)._unit()._perp());for(let g=u;g<l;g++){if(m=g===l-1?s?t[u+1]:void 0:t[g+1],m&&t[g].equals(m))continue;d&&(h=d),f&&(y=f),f=t[g],d=m?m.sub(f)._unit()._perp():h,h=h||d;let b=h.add(d);(b.x!==0||b.y!==0)&&b._unit();let x=h.x*d.x+h.y*d.y,v=b.x*d.x+b.y*d.y,P=v!==0?1/v:1/0,w=2*Math.sqrt(2-2*v),T=v<Dx&&y&&m,F=h.x*d.y-h.y*d.x>0;if(T&&g>u){let I=f.dist(y);if(I>2*c){let k=f.sub(f.sub(y)._mult(c/I)._round());this.updateDistance(y,k),this.addCurrentVertex(k,h,0,0,p),y=k}}let E=y&&m,_=E?n:s?"butt":i;if(E&&_==="round"&&(P<a?_="miter":P<=2&&(_="fakeround")),_==="miter"&&P>o&&(_="bevel"),_==="bevel"&&(P>2&&(_="flipbevel"),P<o&&(_="miter")),y&&this.updateDistance(y,f),_==="miter")b._mult(P),this.addCurrentVertex(f,b,0,0,p);else if(_==="flipbevel"){if(P>100)b=d.mult(-1);else{let I=P*h.add(d).mag()/h.sub(d).mag();b._perp()._mult(I*(F?-1:1))}this.addCurrentVertex(f,b,0,0,p),this.addCurrentVertex(f,b.mult(-1),0,0,p)}else if(_==="bevel"||_==="fakeround"){let I=-Math.sqrt(P*P-1),k=F?I:0,V=F?0:I;if(y&&this.addCurrentVertex(f,h,k,V,p),_==="fakeround"){let A=Math.round(w*180/Math.PI/Bx);for(let z=1;z<A;z++){let O=z/A;if(O!==.5){let K=O-.5,xe=1.0904+x*(-3.2452+x*(3.55645-x*1.43519)),X=.848013+x*(-1.06021+x*.215638);O=O+O*K*(O-1)*(xe*K*K+X)}let N=d.sub(h)._mult(O)._add(h)._unit()._mult(F?-1:1);this.addHalfVertex(f,N.x,N.y,!1,F,0,p)}}m&&this.addCurrentVertex(f,d,-k,-V,p)}else if(_==="butt")this.addCurrentVertex(f,b,0,0,p);else if(_==="square"){let I=y?1:-1;this.addCurrentVertex(f,b,I,I,p)}else _==="round"&&(y&&(this.addCurrentVertex(f,h,0,0,p),this.addCurrentVertex(f,h,1,1,p,!0)),m&&(this.addCurrentVertex(f,d,-1,-1,p,!0),this.addCurrentVertex(f,d,0,0,p)));if(T&&g<l-1){let I=f.dist(m);if(I>2*c){let k=f.add(m.sub(f)._mult(c/I)._round());this.updateDistance(f,k),this.addCurrentVertex(k,d,0,0,p),f=k}}}}addCurrentVertex(t,r,n,i,o,a=!1){let s=r.x+r.y*n,l=r.y-r.x*n,u=-r.x+r.y*i,c=-r.y-r.x*i;this.addHalfVertex(t,s,l,a,!1,n,o),this.addHalfVertex(t,u,c,a,!0,-i,o),this.distance>Vp/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,r,n,i,o,a))}addHalfVertex({x:t,y:r},n,i,o,a,s,l){let c=(this.lineClips?this.scaledDistance*(Vp-1):this.scaledDistance)*zp;if(this.layoutVertexArray.emplaceBack((t<<1)+(o?1:0),(r<<1)+(a?1:0),Math.round(Dp*n)+128,Math.round(Dp*i)+128,(s===0?0:s<0?-1:1)+1|(c&63)<<2,c>>6),this.lineClips){let f=this.scaledDistance-this.lineClips.start,y=this.lineClips.end-this.lineClips.start,m=f/y;this.layoutVertexArray2.emplaceBack(m,this.lineClipsArray.length)}let p=l.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),l.primitiveLength++),a?this.e2=p:this.e1=p}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,r){this.distance+=t.dist(r),this.updateScaledDistance()}};C("LineBucket",rr,{omit:["layers","patternFeatures"]});var Rp,Rx=()=>Rp=Rp||new re({"line-cap":new B(S.layout_line["line-cap"]),"line-join":new R(S.layout_line["line-join"]),"line-miter-limit":new B(S.layout_line["line-miter-limit"]),"line-round-limit":new B(S.layout_line["line-round-limit"]),"line-sort-key":new R(S.layout_line["line-sort-key"])}),Op,Ox=()=>Op=Op||new re({"line-opacity":new R(S.paint_line["line-opacity"]),"line-color":new R(S.paint_line["line-color"]),"line-translate":new B(S.paint_line["line-translate"]),"line-translate-anchor":new B(S.paint_line["line-translate-anchor"]),"line-width":new R(S.paint_line["line-width"]),"line-gap-width":new R(S.paint_line["line-gap-width"]),"line-offset":new R(S.paint_line["line-offset"]),"line-blur":new R(S.paint_line["line-blur"]),"line-dasharray":new qt(S.paint_line["line-dasharray"]),"line-pattern":new lt(S.paint_line["line-pattern"]),"line-gradient":new jt(S.paint_line["line-gradient"])}),qs={get paint(){return Ox()},get layout(){return Rx()}};var js=class extends R{possiblyEvaluate(t,r){return r=new q(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(t,r)}evaluate(t,r,n,i){return r=Pe({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(t,r,n,i)}},Ho,Xo=class extends se{constructor(t){super(t,qs),this.gradientVersion=0,Ho||(Ho=new js(qs.paint.properties["line-width"].specification),Ho.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){let r=this.gradientExpression();$t(r)?this.stepInterpolant=r._styleExpression.expression instanceof pr:this.stepInterpolant=!1,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,r){super.recalculate(t,r),this.paint._values["line-floorwidth"]=Ho.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new rr(t)}queryRadius(t){let r=t,n=Np(Xt("line-width",this,r),Xt("line-gap-width",this,r)),i=Xt("line-offset",this,r);return n/2+Math.abs(i)+_t(this.paint.get("line-translate"))}queryIntersectsFeature(t,r,n,i,o,a,s){let l=It(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),u=s/2*Np(this.paint.get("line-width").evaluate(r,n),this.paint.get("line-gap-width").evaluate(r,n)),c=this.paint.get("line-offset").evaluate(r,n);return c&&(i=Bc(i,c*s)),Dc(l,i,u)}isTileClipped(){return!0}};function Np(e,t){return t>0?t+2*e:e}var Up=Y([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),$p=Y([{name:"a_projected_pos",components:3,type:"Float32"}],4),Uw=Y([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Gp=Y([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),$w=Y([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Js=Y([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Gw=Y([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),qw=Y([{name:"triangle",components:3,type:"Uint16"}]),jw=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Jw=Y([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Zw=Y([{type:"Float32",name:"offsetX"}]),Ww=Y([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Hw=Y([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);var ii=Z(he(),1);function Nx(e,t,r){let n=t.layout.get("text-transform").evaluate(r,{});return n==="uppercase"?e=e.toLocaleUpperCase():n==="lowercase"&&(e=e.toLocaleLowerCase()),ye.applyArabicShaping&&(e=ye.applyArabicShaping(e)),e}function qp(e,t,r){return e.sections.forEach(n=>{n.text=Nx(n.text,t,r)}),e}function jp(e){let t={},r={},n=[],i=0;function o(u){n.push(e[u]),i++}function a(u,c,p){let f=r[u];return delete r[u],r[c]=f,n[f].geometry[0].pop(),n[f].geometry[0]=n[f].geometry[0].concat(p[0]),f}function s(u,c,p){let f=t[c];return delete t[c],t[u]=f,n[f].geometry[0].shift(),n[f].geometry[0]=p[0].concat(n[f].geometry[0]),f}function l(u,c,p){let f=p?c[0][c[0].length-1]:c[0][0];return`${u}:${f.x}:${f.y}`}for(let u=0;u<e.length;u++){let c=e[u],p=c.geometry,f=c.text?c.text.toString():null;if(!f){o(u);continue}let y=l(f,p),m=l(f,p,!0);if(y in r&&m in t&&r[y]!==t[m]){let h=s(y,m,p),d=a(y,m,n[h].geometry);delete t[y],delete r[m],r[l(f,n[d].geometry,!0)]=d,n[h].geometry=null}else y in r?a(y,m,p):m in t?s(y,m,p):(o(u),t[y]=i-1,r[m]=i-1)}return n.filter(u=>u.geometry)}var kr={"!":"\\uFE15","#":"\\uFF03",$:"\\uFF04","%":"\\uFF05","&":"\\uFF06","(":"\\uFE35",")":"\\uFE36","*":"\\uFF0A","+":"\\uFF0B",",":"\\uFE10","-":"\\uFE32",".":"\\u30FB","/":"\\uFF0F",":":"\\uFE13",";":"\\uFE14","<":"\\uFE3F","=":"\\uFF1D",">":"\\uFE40","?":"\\uFE16","@":"\\uFF20","[":"\\uFE47","\\\\":"\\uFF3C","]":"\\uFE48","^":"\\uFF3E",_:"\\uFE33","`":"\\uFF40","{":"\\uFE37","|":"\\u2015","}":"\\uFE38","~":"\\uFF5E","\\xA2":"\\uFFE0","\\xA3":"\\uFFE1","\\xA5":"\\uFFE5","\\xA6":"\\uFFE4","\\xAC":"\\uFFE2","\\xAF":"\\uFFE3","\\u2013":"\\uFE32","\\u2014":"\\uFE31","\\u2018":"\\uFE43","\\u2019":"\\uFE44","\\u201C":"\\uFE41","\\u201D":"\\uFE42","\\u2026":"\\uFE19","\\u2027":"\\u30FB","\\u20A9":"\\uFFE6","\\u3001":"\\uFE11","\\u3002":"\\uFE12","\\u3008":"\\uFE3F","\\u3009":"\\uFE40","\\u300A":"\\uFE3D","\\u300B":"\\uFE3E","\\u300C":"\\uFE41","\\u300D":"\\uFE42","\\u300E":"\\uFE43","\\u300F":"\\uFE44","\\u3010":"\\uFE3B","\\u3011":"\\uFE3C","\\u3014":"\\uFE39","\\u3015":"\\uFE3A","\\u3016":"\\uFE17","\\u3017":"\\uFE18","\\uFF01":"\\uFE15","\\uFF08":"\\uFE35","\\uFF09":"\\uFE36","\\uFF0C":"\\uFE10","\\uFF0D":"\\uFE32","\\uFF0E":"\\u30FB","\\uFF1A":"\\uFE13","\\uFF1B":"\\uFE14","\\uFF1C":"\\uFE3F","\\uFF1E":"\\uFE40","\\uFF1F":"\\uFE16","\\uFF3B":"\\uFE47","\\uFF3D":"\\uFE48","\\uFF3F":"\\uFE33","\\uFF5B":"\\uFE37","\\uFF5C":"\\u2015","\\uFF5D":"\\uFE38","\\uFF5F":"\\uFE35","\\uFF60":"\\uFE36","\\uFF61":"\\uFE12","\\uFF62":"\\uFE41","\\uFF63":"\\uFE42"};function Jp(e){let t="";for(let r=0;r<e.length;r++){let n=e.charCodeAt(r+1)||null,i=e.charCodeAt(r-1)||null;(!n||!Ps(n)||kr[e[r+1]])&&(!i||!Ps(i)||kr[e[r-1]])&&kr[e[r]]?t+=kr[e[r]]:t+=e[r]}return t}var ne=24;var ib=Z(Qn(),1),ob=3;var Qo=ob;function ei(e){let t=0,r=0;for(let s of e)t+=s.w*s.h,r=Math.max(r,s.w);e.sort((s,l)=>l.h-s.h);let i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],o=0,a=0;for(let s of e)for(let l=i.length-1;l>=0;l--){let u=i[l];if(!(s.w>u.w||s.h>u.h)){if(s.x=u.x,s.y=u.y,a=Math.max(a,s.y+s.h),o=Math.max(o,s.x+s.w),s.w===u.w&&s.h===u.h){let c=i.pop();l<i.length&&(i[l]=c)}else s.h===u.h?(u.x+=s.w,u.w-=s.w):s.w===u.w?(u.y+=s.h,u.h-=s.h):(i.push({x:u.x+s.w,y:u.y,w:u.w-s.w,h:s.h}),u.y+=s.h,u.h-=s.h);break}}return{w:o,h:a,fill:t/(o*a)||0}}var ge=1;var ea=class{constructor(t,{pixelRatio:r,version:n,stretchX:i,stretchY:o,content:a}){this.paddedRect=t,this.pixelRatio=r,this.stretchX=i,this.stretchY=o,this.content=a,this.version=n}get tl(){return[this.paddedRect.x+ge,this.paddedRect.y+ge]}get br(){return[this.paddedRect.x+this.paddedRect.w-ge,this.paddedRect.y+this.paddedRect.h-ge]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-ge*2)/this.pixelRatio,(this.paddedRect.h-ge*2)/this.pixelRatio]}},ti=class{constructor(t,r){let n={},i={};this.haveRenderCallbacks=[];let o=[];this.addImages(t,n,o),this.addImages(r,i,o);let{w:a,h:s}=ei(o),l=new de({width:a||1,height:s||1});for(let u in t){let c=t[u],p=n[u].paddedRect;de.copy(c.data,l,{x:0,y:0},{x:p.x+ge,y:p.y+ge},c.data)}for(let u in r){let c=r[u],p=i[u].paddedRect,f=p.x+ge,y=p.y+ge,m=c.data.width,h=c.data.height;de.copy(c.data,l,{x:0,y:0},{x:f,y},c.data),de.copy(c.data,l,{x:0,y:h-1},{x:f,y:y-1},{width:m,height:1}),de.copy(c.data,l,{x:0,y:0},{x:f,y:y+h},{width:m,height:1}),de.copy(c.data,l,{x:m-1,y:0},{x:f-1,y},{width:1,height:h}),de.copy(c.data,l,{x:0,y:0},{x:f+m,y},{width:1,height:h})}this.image=l,this.iconPositions=n,this.patternPositions=i}addImages(t,r,n){for(let i in t){let o=t[i],a={x:0,y:0,w:o.data.width+2*ge,h:o.data.height+2*ge};n.push(a),r[i]=new ea(a,o),o.hasRenderCallback&&this.haveRenderCallbacks.push(i)}}patchUpdatedImages(t,r){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let n in t.updatedImages)this.patchUpdatedImage(this.iconPositions[n],t.getImage(n),r),this.patchUpdatedImage(this.patternPositions[n],t.getImage(n),r)}patchUpdatedImage(t,r,n){if(!t||!r||t.version===r.version)return;t.version=r.version;let[i,o]=t.tl;n.update(r.data,void 0,{x:i,y:o})}};C("ImagePosition",ea);C("ImageAtlas",ti);var na=(i=>(i[i.none=0]="none",i[i.horizontal=1]="horizontal",i[i.vertical=2]="vertical",i[i.horizontalOnly=3]="horizontalOnly",i))(na||{}),Fr=-17;function ab(e){for(let t of e)if(t.positionedGlyphs.length!==0)return!1;return!0}var Qp=57344,ef=63743,ta=class e{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,r){let n=new e;return n.scale=t||1,n.fontStack=r,n}static forImage(t){let r=new e;return r.imageName=t,r}},ri=class e{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,r){let n=new e;for(let i=0;i<t.sections.length;i++){let o=t.sections[i];o.image?n.addImageSection(o):n.addTextSection(o,r)}return n}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=Jp(this.text)}trim(){let t=0;for(let n=0;n<this.text.length&&ra[this.text.charCodeAt(n)];n++)t++;let r=this.text.length;for(let n=this.text.length-1;n>=0&&n>=t&&ra[this.text.charCodeAt(n)];n--)r--;this.text=this.text.substring(t,r),this.sectionIndex=this.sectionIndex.slice(t,r)}substring(t,r){let n=new e;return n.text=this.text.substring(t,r),n.sectionIndex=this.sectionIndex.slice(t,r),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,r)=>Math.max(t,this.sections[r].scale),0)}addTextSection(t,r){this.text+=t.text,this.sections.push(ta.forText(t.scale,t.fontStack||r));let n=this.sections.length-1;for(let i=0;i<t.text.length;++i)this.sectionIndex.push(n)}addImageSection(t){let r=t.image?t.image.name:"";if(r.length===0){fe("Can\'t add FormattedSection with an empty image.");return}let n=this.getNextImageSectionCharCode();if(!n){fe(`Reached maximum number of images ${ef-Qp+2}`);return}this.text+=String.fromCharCode(n),this.sections.push(ta.forImage(r)),this.sectionIndex.push(this.sections.length-1)}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=ef?null:++this.imageSectionID:(this.imageSectionID=Qp,this.imageSectionID)}};function sb(e,t){let r=[],n=e.text,i=0;for(let o of t)r.push(e.substring(i,o)),i=o;return i<n.length&&r.push(e.substring(i,n.length)),r}function ni(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h){let d=ri.fromFeature(e,i);p===2&&d.verticalizePunctuation();let g,{processBidirectionalText:b,processStyledBidirectionalText:x}=ye;if(b&&d.sections.length===1){g=[];let w=b(d.toString(),Hs(d,u,o,t,n,y,m));for(let T of w){let F=new ri;F.text=T,F.sections=d.sections;for(let E=0;E<T.length;E++)F.sectionIndex.push(0);g.push(F)}}else if(x){g=[];let w=x(d.text,d.sectionIndex,Hs(d,u,o,t,n,y,m));for(let T of w){let F=new ri;F.text=T[0],F.sectionIndex=T[1],F.sections=d.sections,g.push(F)}}else g=sb(d,Hs(d,u,o,t,n,y,m));let v=[],P={positionedLines:v,text:d.toString(),top:c[1],bottom:c[1],left:c[0],right:c[0],writingMode:p,iconsInText:!1,verticalizable:!1};return pb(P,t,r,n,g,a,s,l,p,u,f,h),ab(v)?!1:P}var ra={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},lb={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function nf(e,t,r,n,i,o){if(t.imageName){let a=n[t.imageName];return a?a.displaySize[0]*t.scale*ne/o+i:0}else{let a=r[t.fontStack],s=a&&a[e];return s?s.metrics.advance*t.scale+i:0}}function ub(e,t,r,n,i,o){let a=0;for(let l=0;l<e.length();l++){let u=e.getSection(l);a+=nf(e.getCharCode(l),u,n,i,t,o)}let s=Math.max(1,Math.ceil(a/r));return a/s}function tf(e,t,r,n){let i=Math.pow(e-t,2);return n?e<t?i/2:i*2:i+Math.abs(r)*r}function cb(e,t,r){let n=0;return e===10&&(n-=1e4),r&&(n+=150),(e===40||e===65288)&&(n+=50),(t===41||t===65289)&&(n+=50),n}function rf(e,t,r,n,i,o){let a=null,s=tf(t,r,i,o);for(let l of n){let u=t-l.x,c=tf(u,r,i,o)+l.badness;c<=s&&(a=l,s=c)}return{index:e,x:t,priorBreak:a,badness:s}}function of(e){return e?of(e.priorBreak).concat(e.index):[]}function Hs(e,t,r,n,i,o,a){if(o!=="point")return[];if(!e)return[];let s=[],l=ub(e,t,r,n,i,a),u=e.text.indexOf("\\u200B")>=0,c=0;for(let p=0;p<e.length();p++){let f=e.getSection(p),y=e.getCharCode(p);if(ra[y]||(c+=nf(y,f,n,i,t,a)),p<e.length()-1){let m=dc(y);(lb[y]||m||f.imageName)&&s.push(rf(p+1,c,l,s,cb(y,e.getCharCode(p+1),m&&u),!1))}}return of(rf(e.length(),c,l,s,0,!0))}function af(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break}return{horizontalAlign:t,verticalAlign:r}}function pb(e,t,r,n,i,o,a,s,l,u,c,p){let f=0,y=Fr,m=0,h=0,d=s==="right"?1:s==="left"?0:.5,g=0;for(let P of i){P.trim();let w=P.getMaxScale(),T=(w-1)*ne,F={positionedGlyphs:[],lineOffset:0};e.positionedLines[g]=F;let E=F.positionedGlyphs,_=0;if(!P.length()){y+=o,++g;continue}for(let k=0;k<P.length();k++){let V=P.getSection(k),A=P.getSectionIndex(k),z=P.getCharCode(k),O=0,N=null,K=null,xe=null,X=ne,le=!(l===1||!c&&!oo(z)||c&&(ra[z]||gc(z)));if(V.imageName){let ce=n[V.imageName];if(!ce)continue;xe=V.imageName,e.iconsInText=e.iconsInText||!0,K=ce.paddedRect;let pe=ce.displaySize;V.scale=V.scale*ne/p,N={width:pe[0],height:pe[1],left:ge,top:-Qo,advance:le?pe[1]:pe[0]};let _e=ne-pe[1]*V.scale;O=T+_e,X=N.advance;let be=le?pe[0]*V.scale-ne*w:pe[1]*V.scale-ne*w;be>0&&be>_&&(_=be)}else{let ce=r[V.fontStack],pe=ce&&ce[z];if(pe&&pe.rect)K=pe.rect,N=pe.metrics;else{let _e=t[V.fontStack],be=_e&&_e[z];if(!be)continue;N=be.metrics}O=(w-V.scale)*ne}le?(e.verticalizable=!0,E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=X*V.scale+u):(E.push({glyph:z,imageName:xe,x:f,y:y+O,vertical:le,scale:V.scale,fontStack:V.fontStack,sectionIndex:A,metrics:N,rect:K}),f+=N.advance*V.scale+u)}if(E.length!==0){let k=f-u;m=Math.max(k,m),fb(E,0,E.length-1,d,_)}f=0;let I=o*w+_;F.lineOffset=Math.max(_,T),y+=I,h=Math.max(I,h),++g}let b=y-Fr,{horizontalAlign:x,verticalAlign:v}=af(a);yb(e.positionedLines,d,x,v,m,h,o,b,i.length),e.top+=-v*b,e.bottom=e.top+b,e.left+=-x*m,e.right=e.left+m}function fb(e,t,r,n,i){if(!n&&!i)return;let o=e[r],a=o.metrics.advance*o.scale,s=(e[r].x+a)*n;for(let l=t;l<=r;l++)e[l].x-=s,e[l].y+=i}function yb(e,t,r,n,i,o,a,s,l){let u=(t-r)*i,c=0;o!==a?c=-s*n-Fr:c=(-n*l+.5)*a;for(let p of e)for(let f of p.positionedGlyphs)f.x+=u,f.y+=c}function sf(e,t,r){let{horizontalAlign:n,verticalAlign:i}=af(r),o=t[0],a=t[1],s=o-e.displaySize[0]*n,l=s+e.displaySize[0],u=a-e.displaySize[1]*i,c=u+e.displaySize[1];return{image:e,top:u,bottom:c,left:s,right:l}}function Xs(e,t,r,n,i,o){let a=e.image,s;if(a.content){let d=a.content,g=a.pixelRatio||1;s=[d[0]/g,d[1]/g,a.displaySize[0]-d[2]/g,a.displaySize[1]-d[3]/g]}let l=t.left*o,u=t.right*o,c,p,f,y;r==="width"||r==="both"?(y=i[0]+l-n[3],p=i[0]+u+n[1]):(y=i[0]+(l+u-a.displaySize[0])/2,p=y+a.displaySize[0]);let m=t.top*o,h=t.bottom*o;return r==="height"||r==="both"?(c=i[1]+m-n[0],f=i[1]+h+n[2]):(c=i[1]+(m+h-a.displaySize[1])/2,f=c+a.displaySize[1]),{image:a,top:c,right:p,bottom:f,left:y,collisionPadding:s}}var lf=Z(Tt(),1);var Lr=255,Ct=128,tt=Lr*Ct;function Ks(e,t){let{expression:r}=t;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new q(e+1))};if(r.kind==="source")return{kind:"source"};{let{zoomStops:n,interpolationType:i}=r,o=0;for(;o<n.length&&n[o]<=e;)o++;o=Math.max(0,o-1);let a=o;for(;a<n.length&&n[a]<e+1;)a++;a=Math.min(n.length-1,a);let s=n[o],l=n[a];if(r.kind==="composite")return{kind:"composite",minZoom:s,maxZoom:l,interpolationType:i};let u=r.evaluate(new q(s)),c=r.evaluate(new q(l));return{kind:"camera",minZoom:s,maxZoom:l,minSize:u,maxSize:c,interpolationType:i}}}function Ys(e,t,r){let n="never",i=e.get(t);return i?n=i:e.get(r)&&(n="always"),n}var mb=lf.default.VectorTileFeature.types,hb=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ia(e,t,r,n,i,o,a,s,l,u,c,p,f){let y=s?Math.min(tt,Math.round(s[0])):0,m=s?Math.min(tt,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(n*32),Math.round(i*32),o,a,(y<<1)+(l?1:0),m,u*16,c*16,p*256,f*256)}function uf(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function db(e){for(let t of e.sections)if(bc(t.text))return!0;return!1}var oi=class{constructor(t){this.layoutVertexArray=new Io,this.indexArray=new Le,this.programConfigurations=t,this.segments=new me,this.dynamicLayoutVertexArray=new To,this.opacityVertexArray=new Co,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ln}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,r,n,i){this.isEmpty()||(n&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Up.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,$p.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,hb,!0),this.opacityVertexBuffer.itemSize=1),(n||i)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}};C("SymbolBuffers",oi);var ai=class{constructor(t,r,n){this.layoutVertexArray=new t,this.layoutAttributes=r,this.indexArray=new n,this.segments=new me,this.collisionVertexArray=new ko}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Gp.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}};C("CollisionBuffers",ai);var He=class{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(l=>l.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=jn.identity([]),this.placementViewportMatrix=jn.identity([]);let n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ks(this.zoom,n["text-size"]),this.iconSizeData=Ks(this.zoom,n["icon-size"]);let i=this.layers[0].layout,o=i.get("symbol-sort-key"),a=i.get("symbol-z-order");this.canOverlap=Ys(i,"text-overlap","text-allow-overlap")!=="never"||Ys(i,"icon-overlap","icon-allow-overlap")!=="never"||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=a!=="viewport-y"&&!o.isConstant();let s=a==="viewport-y"||a==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=s&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(l=>na[l])),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.sourceID=t.sourceID}createArrays(){this.text=new oi(new Ce(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new oi(new Ce(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Vn,this.lineVertexArray=new Bn,this.symbolInstances=new Dn,this.textAnchorOffsets=new zn}calculateGlyphDependencies(t,r,n,i,o){for(let a=0;a<t.length;a++)if(r[t.charCodeAt(a)]=!0,(n||i)&&o){let s=kr[t.charAt(a)];s&&(r[s.charCodeAt(0)]=!0)}}populate(t,r,n){let i=this.layers[0],o=i.layout,a=o.get("text-font"),s=o.get("text-field"),l=o.get("icon-image"),u=(s.value.kind!=="constant"||s.value.value instanceof Fe&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&(a.value.kind!=="constant"||a.value.value.length>0),c=l.value.kind!=="constant"||!!l.value.value||Object.keys(l.parameters).length>0,p=o.get("symbol-sort-key");if(this.features=[],!u&&!c)return;let f=r.iconDependencies,y=r.glyphDependencies,m=r.availableImages,h=new q(this.zoom);for(let{feature:d,id:g,index:b,sourceLayerIndex:x}of t){let v=i._featureFilter.needGeometry,P=$e(d,v);if(!i._featureFilter.filter(h,P,n))continue;v||(P.geometry=ke(d));let w;if(u){let _=i.getValueAndResolveTokens("text-field",P,n,m),I=Fe.factory(_),k=this.hasRTLText=this.hasRTLText||db(I);(!k||ye.getRTLTextPluginStatus()==="unavailable"||k&&ye.isParsed())&&(w=qp(I,i,P))}let T;if(c){let _=i.getValueAndResolveTokens("icon-image",P,n,m);_ instanceof Te?T=_:T=Te.fromString(_)}if(!w&&!T)continue;let F=this.sortFeaturesByKey?p.evaluate(P,{},n):void 0,E={id:g,text:w,icon:T,index:b,sourceLayerIndex:x,geometry:P.geometry,properties:d.properties,type:mb[d.type],sortKey:F};if(this.features.push(E),T&&(f[T.name]=!0),w){let _=a.evaluate(P,{},n).join(","),I=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(2)>=0;for(let k of w.sections)if(k.image)f[k.image.name]=!0;else{let V=mn(w.toString()),A=k.fontStack||_,z=y[A]=y[A]||{};this.calculateGlyphDependencies(k.text,z,I,this.allowVerticalPlacement,V)}}}o.get("symbol-placement")==="line"&&(this.features=jp(this.features)),this.sortFeaturesByKey&&this.features.sort((d,g)=>d.sortKey-g.sortKey)}update(t,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,r,this.layers,n),this.icon.programConfigurations.updatePaintArrays(t,r,this.layers,n))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,r){let n=this.lineVertexArray.length;if(t.segment!==void 0){let i=t.dist(r[t.segment+1]),o=t.dist(r[t.segment]),a={};for(let s=t.segment+1;s<r.length;s++)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:i},s<r.length-1&&(i+=r[s+1].dist(r[s]));for(let s=t.segment||0;s>=0;s--)a[s]={x:r[s].x,y:r[s].y,tileUnitDistanceFromAnchor:o},s>0&&(o+=r[s-1].dist(r[s]));for(let s=0;s<r.length;s++){let l=a[s];this.lineVertexArray.emplaceBack(l.x,l.y,l.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,r,n,i,o,a,s,l,u,c,p,f){let y=t.indexArray,m=t.layoutVertexArray,h=t.segments.prepareSegment(4*r.length,m,y,this.canOverlap?a.sortKey:void 0),d=this.glyphOffsetArray.length,g=h.vertexLength,b=this.allowVerticalPlacement&&s===2?Math.PI/2:0,x=a.text&&a.text.sections;for(let v=0;v<r.length;v++){let{tl:P,tr:w,bl:T,br:F,tex:E,pixelOffsetTL:_,pixelOffsetBR:I,minFontScaleX:k,minFontScaleY:V,glyphOffset:A,isSDF:z,sectionIndex:O}=r[v],N=h.vertexLength,K=A[1];ia(m,l.x,l.y,P.x,K+P.y,E.x,E.y,n,z,_.x,_.y,k,V),ia(m,l.x,l.y,w.x,K+w.y,E.x+E.w,E.y,n,z,I.x,_.y,k,V),ia(m,l.x,l.y,T.x,K+T.y,E.x,E.y+E.h,n,z,_.x,I.y,k,V),ia(m,l.x,l.y,F.x,K+F.y,E.x+E.w,E.y+E.h,n,z,I.x,I.y,k,V),uf(t.dynamicLayoutVertexArray,l,b),y.emplaceBack(N,N+1,N+2),y.emplaceBack(N+1,N+2,N+3),h.vertexLength+=4,h.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),(v===r.length-1||O!==r[v+1].sectionIndex)&&t.programConfigurations.populatePaintArrays(m.length,a,a.index,{},f,x&&x[O])}t.placedSymbolArray.emplaceBack(l.x,l.y,d,this.glyphOffsetArray.length-d,g,u,c,l.segment,n?n[0]:0,n?n[1]:0,i[0],i[1],s,0,!1,0,p)}_addCollisionDebugVertex(t,r,n,i,o,a){return r.emplaceBack(0,0),t.emplaceBack(n.x,n.y,i,o,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(t,r,n,i,o,a,s){let l=o.segments.prepareSegment(4,o.layoutVertexArray,o.indexArray),u=l.vertexLength,c=o.layoutVertexArray,p=o.collisionVertexArray,f=s.anchorX,y=s.anchorY;this._addCollisionDebugVertex(c,p,a,f,y,new ii.default(t,r)),this._addCollisionDebugVertex(c,p,a,f,y,new ii.default(n,r)),this._addCollisionDebugVertex(c,p,a,f,y,new ii.default(n,i)),this._addCollisionDebugVertex(c,p,a,f,y,new ii.default(t,i)),l.vertexLength+=4;let m=o.indexArray;m.emplaceBack(u,u+1),m.emplaceBack(u+1,u+2),m.emplaceBack(u+2,u+3),m.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(t,r,n,i){for(let o=t;o<r;o++){let a=this.collisionBoxArray.get(o),s=a.x1,l=a.y1,u=a.x2,c=a.y2;this.addCollisionDebugVertices(s,l,u,c,i?this.textCollisionBox:this.iconCollisionBox,a.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new ai(On,Js.members,wt),this.iconCollisionBox=new ai(On,Js.members,wt);for(let t=0;t<this.symbolInstances.length;t++){let r=this.symbolInstances.get(t);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(t,r,n,i,o,a,s,l,u){let c={};for(let p=r;p<n;p++){let f=t.get(p);c.textBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.textFeatureIndex=f.featureIndex;break}for(let p=i;p<o;p++){let f=t.get(p);c.verticalTextBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalTextFeatureIndex=f.featureIndex;break}for(let p=a;p<s;p++){let f=t.get(p);c.iconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.iconFeatureIndex=f.featureIndex;break}for(let p=l;p<u;p++){let f=t.get(p);c.verticalIconBox={x1:f.x1,y1:f.y1,x2:f.x2,y2:f.y2,anchorPointX:f.anchorPointX,anchorPointY:f.anchorPointY},c.verticalIconFeatureIndex=f.featureIndex;break}return c}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){let n=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,r){let n=t.placedSymbolArray.get(r),i=n.vertexStartIndex+n.numGlyphs*4;for(let o=n.vertexStartIndex;o<i;o+=4)t.indexArray.emplaceBack(o,o+1,o+2),t.indexArray.emplaceBack(o+1,o+2,o+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let r=Math.sin(t),n=Math.cos(t),i=[],o=[],a=[];for(let s=0;s<this.symbolInstances.length;++s){a.push(s);let l=this.symbolInstances.get(s);i.push(Math.round(r*l.anchorX+n*l.anchorY)|0),o.push(l.featureIndex)}return a.sort((s,l)=>i[s]-i[l]||o[l]-o[s]),a}addToSortKeyRanges(t,r){let n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===r?n.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let r of this.symbolInstanceIndexes){let n=this.symbolInstances.get(r);this.featureSortOrder.push(n.featureIndex),[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach((i,o,a)=>{i>=0&&a.indexOf(i)===o&&this.addIndicesForPlacedSymbol(this.text,i)}),n.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,n.verticalPlacedTextSymbolIndex),n.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.placedIconSymbolIndex),n.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,n.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}};C("SymbolBucket",He,{omit:["layers","collisionBoxArray","features","compareText"]});He.MAX_GLYPHS=65535;He.addDynamicAttributes=uf;function cf(e,t){return t.replace(/{([^{}]+)}/g,(r,n)=>e&&n in e?String(e[n]):"")}var pf,gb=()=>pf=pf||new re({"symbol-placement":new B(S.layout_symbol["symbol-placement"]),"symbol-spacing":new B(S.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new B(S.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new R(S.layout_symbol["symbol-sort-key"]),"symbol-z-order":new B(S.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new B(S.layout_symbol["icon-allow-overlap"]),"icon-overlap":new B(S.layout_symbol["icon-overlap"]),"icon-ignore-placement":new B(S.layout_symbol["icon-ignore-placement"]),"icon-optional":new B(S.layout_symbol["icon-optional"]),"icon-rotation-alignment":new B(S.layout_symbol["icon-rotation-alignment"]),"icon-size":new R(S.layout_symbol["icon-size"]),"icon-text-fit":new B(S.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new B(S.layout_symbol["icon-text-fit-padding"]),"icon-image":new R(S.layout_symbol["icon-image"]),"icon-rotate":new R(S.layout_symbol["icon-rotate"]),"icon-padding":new R(S.layout_symbol["icon-padding"]),"icon-keep-upright":new B(S.layout_symbol["icon-keep-upright"]),"icon-offset":new R(S.layout_symbol["icon-offset"]),"icon-anchor":new R(S.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new B(S.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new B(S.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new B(S.layout_symbol["text-rotation-alignment"]),"text-field":new R(S.layout_symbol["text-field"]),"text-font":new R(S.layout_symbol["text-font"]),"text-size":new R(S.layout_symbol["text-size"]),"text-max-width":new R(S.layout_symbol["text-max-width"]),"text-line-height":new B(S.layout_symbol["text-line-height"]),"text-letter-spacing":new R(S.layout_symbol["text-letter-spacing"]),"text-justify":new R(S.layout_symbol["text-justify"]),"text-radial-offset":new R(S.layout_symbol["text-radial-offset"]),"text-variable-anchor":new B(S.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new R(S.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new R(S.layout_symbol["text-anchor"]),"text-max-angle":new B(S.layout_symbol["text-max-angle"]),"text-writing-mode":new B(S.layout_symbol["text-writing-mode"]),"text-rotate":new R(S.layout_symbol["text-rotate"]),"text-padding":new B(S.layout_symbol["text-padding"]),"text-keep-upright":new B(S.layout_symbol["text-keep-upright"]),"text-transform":new R(S.layout_symbol["text-transform"]),"text-offset":new R(S.layout_symbol["text-offset"]),"text-allow-overlap":new B(S.layout_symbol["text-allow-overlap"]),"text-overlap":new B(S.layout_symbol["text-overlap"]),"text-ignore-placement":new B(S.layout_symbol["text-ignore-placement"]),"text-optional":new B(S.layout_symbol["text-optional"])}),ff,xb=()=>ff=ff||new re({"icon-opacity":new R(S.paint_symbol["icon-opacity"]),"icon-color":new R(S.paint_symbol["icon-color"]),"icon-halo-color":new R(S.paint_symbol["icon-halo-color"]),"icon-halo-width":new R(S.paint_symbol["icon-halo-width"]),"icon-halo-blur":new R(S.paint_symbol["icon-halo-blur"]),"icon-translate":new B(S.paint_symbol["icon-translate"]),"icon-translate-anchor":new B(S.paint_symbol["icon-translate-anchor"]),"text-opacity":new R(S.paint_symbol["text-opacity"]),"text-color":new R(S.paint_symbol["text-color"],{runtimeType:Re,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new R(S.paint_symbol["text-halo-color"]),"text-halo-width":new R(S.paint_symbol["text-halo-width"]),"text-halo-blur":new R(S.paint_symbol["text-halo-blur"]),"text-translate":new B(S.paint_symbol["text-translate"]),"text-translate-anchor":new B(S.paint_symbol["text-translate-anchor"])}),oa={get paint(){return xb()},get layout(){return gb()}};var si=class{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:yr,this.defaultValue=t}evaluate(t){if(t.formattedSection){let r=this.defaultValue.property.overrides;if(r&&r.hasOverride(t.formattedSection))return r.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){if(!this.defaultValue.isConstant()){let r=this.defaultValue.value;t(r._styleExpression.expression)}}outputDefined(){return!1}serialize(){return null}};C("FormatSectionOverride",si,{omit:["defaultValue"]});var aa=class e extends se{constructor(t){super(t,oa)}recalculate(t,r){if(super.recalculate(t,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let n=this.layout.get("text-writing-mode");if(n){let i=[];for(let o of n)i.indexOf(o)<0&&i.push(o);this.layout._values["text-writing-mode"]=i}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,r,n,i){let o=this.layout.get(t).evaluate(r,{},n,i),a=this._unevaluatedLayout._values[t];return!a.isDataDriven()&&!$t(a.value)&&o?cf(r.properties,o):o}createBucket(t){return new He(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let t of oa.paint.overridableProperties){if(!e.hasPaintOverride(this.layout,t))continue;let r=this.paint.get(t),n=new si(r),i=new Rt(n,r.property.specification),o=null;r.value.kind==="constant"||r.value.kind==="source"?o=new dt("source",i):o=new gt("composite",i,r.value.zoomStops),this.paint._values[t]=new Se(r.property,o,r.parameters)}}_handleOverridablePaintPropertyUpdate(t,r,n){return!this.layout||r.isDataDriven()||n.isDataDriven()?!1:e.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,r){let n=t.get("text-field"),i=oa.paint.properties[r],o=!1,a=s=>{for(let l of s)if(i.overrides&&i.overrides.hasOverride(l)){o=!0;return}};if(n.value.kind==="constant"&&n.value.value instanceof Fe)a(n.value.value.sections);else if(n.value.kind==="source"){let s=u=>{if(!o)if(u instanceof mt&&ue(u.value)===mr){let c=u.value;a(c.sections)}else u instanceof en?a(u.sections):u.eachChild(s)},l=n.value;l._styleExpression&&s(l._styleExpression.expression)}return o}};function yf(e,t,r,n=1){let i=e.get("icon-padding").evaluate(t,{},r),o=i&&i.values;return[o[0]*n,o[1]*n,o[2]*n,o[3]*n]}var mf,bb=()=>mf=mf||new re({"background-color":new B(S.paint_background["background-color"]),"background-pattern":new qt(S.paint_background["background-pattern"]),"background-opacity":new B(S.paint_background["background-opacity"])}),hf={get paint(){return bb()}};var sa=class extends se{constructor(t){super(t,hf)}};var df,vb=()=>df=df||new re({"raster-opacity":new B(S.paint_raster["raster-opacity"]),"raster-hue-rotate":new B(S.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new B(S.paint_raster["raster-brightness-min"]),"raster-brightness-max":new B(S.paint_raster["raster-brightness-max"]),"raster-saturation":new B(S.paint_raster["raster-saturation"]),"raster-contrast":new B(S.paint_raster["raster-contrast"]),"raster-resampling":new B(S.paint_raster["raster-resampling"]),"raster-fade-duration":new B(S.paint_raster["raster-fade-duration"])}),gf={get paint(){return vb()}};var la=class extends se{constructor(t){super(t,gf)}};var ua=class extends se{constructor(r){super(r,{});this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)};this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)};this.implementation=r}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}};function xf(e){if(e.type==="custom")return new ua(e);switch(e.type){case"background":return new sa(e);case"circle":return new Ro(e);case"fill":return new jo(e);case"fill-extrusion":return new Wo(e);case"heatmap":return new Oo(e);case"hillshade":return new No(e);case"line":return new Xo(e);case"raster":return new la(e);case"symbol":return new aa(e)}}var ca=class{constructor(t){this.keyCache={},t&&this.replace(t)}replace(t){this._layerConfigs={},this._layers={},this.update(t,[])}update(t,r){for(let i of t){this._layerConfigs[i.id]=i;let o=this._layers[i.id]=xf(i);o._featureFilter=fn(o.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(let i of r)delete this.keyCache[i],delete this._layerConfigs[i],delete this._layers[i];this.familiesBySource={};let n=Ru(Object.values(this._layerConfigs),this.keyCache);for(let i of n){let o=i.map(p=>this._layers[p.id]),a=o[0];if(a.visibility==="none")continue;let s=a.source||"",l=this.familiesBySource[s];l||(l=this.familiesBySource[s]={});let u=a.sourceLayer||"_geojsonTileLayer",c=l[u];c||(c=l[u]=[]),c.push(o)}}};var Gf=Z(Tt(),1),qf=Z(Qn(),1);var Dr=class{constructor(t){this._stringToNumber={},this._numberToString=[];for(let r=0;r<t.length;r++){let n=t[r];this._stringToNumber[n]=r,this._numberToString[r]=n}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can\'t be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}};var Pf=Z(Tt(),1),Sf=Z(Qn(),1);var pa=class{constructor(t,r,n,i,o){this.type="Feature",this._vectorTileFeature=t,t._z=r,t._x=n,t._y=i,this.properties=t.properties,this.id=o}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){let t={geometry:this.geometry};for(let r in this)r==="_geometry"||r==="_vectorTileFeature"||(t[r]=this[r]);return t}};var li=class{constructor(t,r){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Dt(8192,16,0),this.grid3D=new Dt(8192,16,0),this.featureIndexArray=new Rn,this.promoteId=r}insert(t,r,n,i,o,a){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,i,o);let l=a?this.grid3D:this.grid;for(let u=0;u<r.length;u++){let c=r[u],p=[1/0,1/0,-1/0,-1/0];for(let f=0;f<c.length;f++){let y=c[f];p[0]=Math.min(p[0],y.x),p[1]=Math.min(p[1],y.y),p[2]=Math.max(p[2],y.x),p[3]=Math.max(p[3],y.y)}p[0]<8192&&p[1]<8192&&p[2]>=0&&p[3]>=0&&l.insert(s,p[0],p[1],p[2],p[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Pf.default.VectorTile(new Sf.default(this.rawTileData)).layers,this.sourceLayerCoder=new Dr(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,r,n,i){this.loadVTLayers();let o=t.params||{},a=8192/t.tileSize/t.scale,s=fn(o.filter),l=t.queryGeometry,u=t.queryPadding*a,c=vf(l),p=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),f=vf(t.cameraQueryGeometry),y=this.grid3D.query(f.minX-u,f.minY-u,f.maxX+u,f.maxY+u,(d,g,b,x)=>Vc(t.cameraQueryGeometry,d-u,g-u,b+u,x+u));for(let d of y)p.push(d);p.sort(Pb);let m={},h;for(let d=0;d<p.length;d++){let g=p[d];if(g===h)continue;h=g;let b=this.featureIndexArray.get(g),x=null;this.loadMatchingFeature(m,b.bucketIndex,b.sourceLayerIndex,b.featureIndex,s,o.layers,o.availableImages,r,n,i,(v,P,w)=>(x||(x=ke(v)),P.queryIntersectsFeature(l,v,w,x,this.z,t.transform,a,t.pixelPosMatrix)))}return m}loadMatchingFeature(t,r,n,i,o,a,s,l,u,c,p){let f=this.bucketLayerIDs[r];if(a&&!Jl(a,f))return;let y=this.sourceLayerCoder.decode(n),h=this.vtLayers[y].feature(i);if(o.needGeometry){let g=$e(h,!0);if(!o.filter(new q(this.tileID.overscaledZ),g,this.tileID.canonical))return}else if(!o.filter(new q(this.tileID.overscaledZ),h))return;let d=this.getId(h,y);for(let g=0;g<f.length;g++){let b=f[g];if(a&&a.indexOf(b)<0)continue;let x=l[b];if(!x)continue;let v={};d&&c&&(v=c.getState(x.sourceLayer||"_geojsonTileLayer",d));let P=Pe({},u[b]);P.paint=bf(P.paint,x.paint,h,v,s),P.layout=bf(P.layout,x.layout,h,v,s);let w=!p||p(h,x,v);if(!w)continue;let T=new pa(h,this.z,this.x,this.y,d);T.layer=P;let F=t[b];F===void 0&&(F=t[b]=[]),F.push({featureIndex:i,feature:T,intersectionZ:w})}}lookupSymbolFeatures(t,r,n,i,o,a,s,l){let u={};this.loadVTLayers();let c=fn(o);for(let p of t)this.loadMatchingFeature(u,n,i,p,c,a,s,l,r);return u}hasLayer(t){for(let r of this.bucketLayerIDs)for(let n of r)if(t===n)return!0;return!1}getId(t,r){let n=t.id;if(this.promoteId){let i=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];n=t.properties[i],typeof n=="boolean"&&(n=Number(n))}return n}};C("FeatureIndex",li,{omit:["rawTileData","sourceLayerCoder"]});function bf(e,t,r,n,i){return Gr(e,(o,a)=>{let s=t instanceof vt?t.get(a):null;return s&&s.evaluate?s.evaluate(r,n,i):s})}function vf(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(let o of e)t=Math.min(t,o.x),r=Math.min(r,o.y),n=Math.max(n,o.x),i=Math.max(i,o.y);return{minX:t,minY:r,maxX:n,maxY:i}}function Pb(e,t){return t-e}var wf=Z(he(),1);var rt=class e extends wf.default{constructor(t,r,n,i){super(t,r),this.angle=n,i!==void 0&&(this.segment=i)}clone(){return new e(this.x,this.y,this.angle,this.segment)}};C("Anchor",rt);function Qs(e,t,r,n,i){if(t.segment===void 0||r===0)return!0;let o=t,a=t.segment+1,s=0;for(;s>-r/2;){if(a--,a<0)return!1;s-=e[a].dist(o),o=e[a]}s+=e[a].dist(e[a+1]),a++;let l=[],u=0;for(;s<r/2;){let c=e[a-1],p=e[a],f=e[a+1];if(!f)return!1;let y=c.angleTo(p)-p.angleTo(f);for(y=Math.abs((y+3*Math.PI)%(Math.PI*2)-Math.PI),l.push({distance:s,angleDelta:y}),u+=y;s-l[0].distance>n;)u-=l.shift().angleDelta;if(u>i)return!1;a++,s+=p.dist(f)}return!0}function Af(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function _f(e,t,r){return e?3/5*t*r:0}function If(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Tf(e,t,r,n,i,o){let a=_f(r,i,o),s=If(r,n)*o,l=0,u=Af(e)/2;for(let c=0;c<e.length-1;c++){let p=e[c],f=e[c+1],y=p.dist(f);if(l+y>u){let m=(u-l)/y,h=Oe.number(p.x,f.x,m),d=Oe.number(p.y,f.y,m),g=new rt(h,d,f.angleTo(p),c);return g._round(),!a||Qs(e,g,s,a,t)?g:void 0}l+=y}}function Cf(e,t,r,n,i,o,a,s,l){let u=_f(n,o,a),c=If(n,i),p=c*a,f=e[0].x===0||e[0].x===l||e[0].y===0||e[0].y===l;t-p<t/4&&(t=p+t/4);let y=o*2,m=f?t/2*s%t:(c/2+y)*a*s%t;return kf(e,m,t,u,r,p,f,!1,l)}function kf(e,t,r,n,i,o,a,s,l){let u=o/2,c=Af(e),p=0,f=t-r,y=[];for(let m=0;m<e.length-1;m++){let h=e[m],d=e[m+1],g=h.dist(d),b=d.angleTo(h);for(;f+r<p+g;){f+=r;let x=(f-p)/g,v=Oe.number(h.x,d.x,x),P=Oe.number(h.y,d.y,x);if(v>=0&&v<l&&P>=0&&P<l&&f-u>=0&&f+u<=c){let w=new rt(v,P,b,m);w._round(),(!n||Qs(e,w,o,n,i))&&y.push(w)}}p+=g}return!s&&!y.length&&!a&&(y=kf(e,p/2,r,n,i,o,a,!0,l)),y}var pt=Z(he(),1);function Mf(e,t,r,n,i){let o=[];for(let a=0;a<e.length;a++){let s=e[a],l;for(let u=0;u<s.length-1;u++){let c=s[u],p=s[u+1];c.x<t&&p.x<t||(c.x<t?c=new pt.default(t,c.y+(p.y-c.y)*((t-c.x)/(p.x-c.x)))._round():p.x<t&&(p=new pt.default(t,c.y+(p.y-c.y)*((t-c.x)/(p.x-c.x)))._round()),!(c.y<r&&p.y<r)&&(c.y<r?c=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round():p.y<r&&(p=new pt.default(c.x+(p.x-c.x)*((r-c.y)/(p.y-c.y)),r)._round()),!(c.x>=n&&p.x>=n)&&(c.x>=n?c=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round():p.x>=n&&(p=new pt.default(n,c.y+(p.y-c.y)*((n-c.x)/(p.x-c.x)))._round()),!(c.y>=i&&p.y>=i)&&(c.y>=i?c=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round():p.y>=i&&(p=new pt.default(c.x+(p.x-c.x)*((i-c.y)/(p.y-c.y)),i)._round()),(!l||!c.equals(l[l.length-1]))&&(l=[c],o.push(l)),l.push(p)))))}}return o}var we=Z(he(),1);var Vr=ge;function el(e,t,r,n){let i=[],o=e.image,a=o.pixelRatio,s=o.paddedRect.w-2*Vr,l=o.paddedRect.h-2*Vr,u=e.right-e.left,c=e.bottom-e.top,p=o.stretchX||[[0,s]],f=o.stretchY||[[0,l]],y=(I,k)=>I+k[1]-k[0],m=p.reduce(y,0),h=f.reduce(y,0),d=s-m,g=l-h,b=0,x=m,v=0,P=h,w=0,T=d,F=0,E=g;if(o.content&&n){let I=o.content;b=fa(p,0,I[0]),v=fa(f,0,I[1]),x=fa(p,I[0],I[2]),P=fa(f,I[1],I[3]),w=I[0]-b,F=I[1]-v,T=I[2]-I[0]-x,E=I[3]-I[1]-P}let _=(I,k,V,A)=>{let z=ya(I.stretch-b,x,u,e.left),O=ma(I.fixed-w,T,I.stretch,m),N=ya(k.stretch-v,P,c,e.top),K=ma(k.fixed-F,E,k.stretch,h),xe=ya(V.stretch-b,x,u,e.left),X=ma(V.fixed-w,T,V.stretch,m),le=ya(A.stretch-v,P,c,e.top),ce=ma(A.fixed-F,E,A.stretch,h),pe=new we.default(z,N),_e=new we.default(xe,N),be=new we.default(xe,le),wi=new we.default(z,le),Ea=new we.default(O/a,K/a),Fa=new we.default(X/a,ce/a),Or=t*Math.PI/180;if(Or){let Ie=Math.sin(Or),ve=Math.cos(Or),Ve=[ve,-Ie,Ie,ve];pe._matMult(Ve),_e._matMult(Ve),wi._matMult(Ve),be._matMult(Ve)}let Ai=I.stretch+I.fixed,Me=V.stretch+V.fixed,Ft=k.stretch+k.fixed,_i=A.stretch+A.fixed,La={x:o.paddedRect.x+Vr+Ai,y:o.paddedRect.y+Vr+Ft,w:Me-Ai,h:_i-Ft},Da=T/a/u,Va=E/a/c;return{tl:pe,tr:_e,bl:wi,br:be,tex:La,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ea,pixelOffsetBR:Fa,minFontScaleX:Da,minFontScaleY:Va,isSDF:r}};if(!n||!o.stretchX&&!o.stretchY)i.push(_({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:l+1}));else{let I=Ef(p,d,m),k=Ef(f,g,h);for(let V=0;V<I.length-1;V++){let A=I[V],z=I[V+1];for(let O=0;O<k.length-1;O++){let N=k[O],K=k[O+1];i.push(_(A,N,z,K))}}}return i}function fa(e,t,r){let n=0;for(let i of e)n+=Math.max(t,Math.min(r,i[1]))-Math.max(t,Math.min(r,i[0]));return n}function Ef(e,t,r){let n=[{fixed:-Vr,stretch:0}];for(let[i,o]of e){let a=n[n.length-1];n.push({fixed:i-a.stretch,stretch:a.stretch}),n.push({fixed:i-a.stretch,stretch:a.stretch+(o-i)})}return n.push({fixed:t+Vr,stretch:r}),n}function ya(e,t,r,n){return e/t*r+n}function ma(e,t,r,n){return e-t*r/n}function Ff(e,t,r,n,i,o,a,s){let l=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,u=[];for(let c of t.positionedLines)for(let p of c.positionedGlyphs){if(!p.rect)continue;let f=p.rect||{},m=Qo+1,h=!0,d=1,g=0,b=(i||s)&&p.vertical,x=p.metrics.advance*p.scale/2;if(s&&t.verticalizable){let X=(p.scale-1)*ne,le=(ne-p.metrics.width*p.scale)/2;g=c.lineOffset/2-(p.imageName?-le:X)}if(p.imageName){let X=a[p.imageName];h=X.sdf,d=X.pixelRatio,m=ge/d}let v=i?[p.x+x,p.y]:[0,0],P=i?[0,0]:[p.x+x+r[0],p.y+r[1]-g],w=[0,0];b&&(w=P,P=[0,0]);let T=p.metrics.isDoubleResolution?2:1,F=(p.metrics.left-m)*p.scale-x+P[0],E=(-p.metrics.top-m)*p.scale+P[1],_=F+f.w/T*p.scale/d,I=E+f.h/T*p.scale/d,k=new we.default(F,E),V=new we.default(_,E),A=new we.default(F,I),z=new we.default(_,I);if(b){let X=new we.default(-x,x-Fr),le=-Math.PI/2,ce=ne/2-x,pe=p.imageName?ce:0,_e=new we.default(5-Fr-ce,-pe),be=new we.default(...w);k._rotateAround(le,X)._add(_e)._add(be),V._rotateAround(le,X)._add(_e)._add(be),A._rotateAround(le,X)._add(_e)._add(be),z._rotateAround(le,X)._add(_e)._add(be)}if(l){let X=Math.sin(l),le=Math.cos(l),ce=[le,-X,X,le];k._matMult(ce),V._matMult(ce),A._matMult(ce),z._matMult(ce)}let O=new we.default(0,0),N=new we.default(0,0);u.push({tl:k,tr:V,bl:A,br:z,tex:f,writingMode:t.writingMode,glyphOffset:v,sectionIndex:p.sectionIndex,isSDF:h,pixelOffsetTL:O,pixelOffsetBR:N,minFontScaleX:0,minFontScaleY:0})}return u}var ui=Z(he(),1),nr=class{constructor(t,r,n,i,o,a,s,l,u,c){if(this.boxStartIndex=t.length,u){let p=a.top,f=a.bottom,y=a.collisionPadding;y&&(p-=y[1],f+=y[3]);let m=f-p;m>0&&(m=Math.max(10,m),this.circleDiameter=m)}else{let p=a.top*s-l[0],f=a.bottom*s+l[2],y=a.left*s-l[3],m=a.right*s+l[1],h=a.collisionPadding;if(h&&(y-=h[0]*s,p-=h[1]*s,m+=h[2]*s,f+=h[3]*s),c){let d=new ui.default(y,p),g=new ui.default(m,p),b=new ui.default(y,f),x=new ui.default(m,f),v=c*Math.PI/180;d._rotate(v),g._rotate(v),b._rotate(v),x._rotate(v),y=Math.min(d.x,g.x,b.x,x.x),m=Math.max(d.x,g.x,b.x,x.x),p=Math.min(d.y,g.y,b.y,x.y),f=Math.max(d.y,g.y,b.y,x.y)}t.emplaceBack(r.x,r.y,y,p,m,f,n,i,o)}this.boxEndIndex=t.length}};var ci=class{constructor(t=[],r=Sb){if(this.data=t,this.length=this.data.length,this.compare=r,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let t=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),t}peek(){return this.data[0]}_up(t){let{data:r,compare:n}=this,i=r[t];for(;t>0;){let o=t-1>>1,a=r[o];if(n(i,a)>=0)break;r[t]=a,t=o}r[t]=i}_down(t){let{data:r,compare:n}=this,i=this.length>>1,o=r[t];for(;t<i;){let a=(t<<1)+1,s=r[a],l=a+1;if(l<this.length&&n(r[l],s)<0&&(a=l,s=r[l]),n(s,o)>=0)break;r[t]=s,t=a}r[t]=o}};function Sb(e,t){return e<t?-1:e>t?1:0}var tl=Z(he(),1);function Lf(e,t=1,r=!1){let n=1/0,i=1/0,o=-1/0,a=-1/0,s=e[0];for(let h=0;h<s.length;h++){let d=s[h];(!h||d.x<n)&&(n=d.x),(!h||d.y<i)&&(i=d.y),(!h||d.x>o)&&(o=d.x),(!h||d.y>a)&&(a=d.y)}let l=o-n,u=a-i,c=Math.min(l,u),p=c/2,f=new ci([],wb);if(c===0)return new tl.default(n,i);for(let h=n;h<o;h+=c)for(let d=i;d<a;d+=c)f.push(new Br(h+p,d+p,p,e));let y=_b(e),m=f.length;for(;f.length;){let h=f.pop();(h.d>y.d||!y.d)&&(y=h,r&&console.log("found best %d after %d probes",Math.round(1e4*h.d)/1e4,m)),!(h.max-y.d<=t)&&(p=h.h/2,f.push(new Br(h.p.x-p,h.p.y-p,p,e)),f.push(new Br(h.p.x+p,h.p.y-p,p,e)),f.push(new Br(h.p.x-p,h.p.y+p,p,e)),f.push(new Br(h.p.x+p,h.p.y+p,p,e)),m+=4)}return r&&(console.log(`num probes: ${m}`),console.log(`best distance: ${y.d}`)),y.p}function wb(e,t){return t.max-e.max}function Br(e,t,r,n){this.p=new tl.default(e,t),this.h=r,this.d=Ab(this.p,n),this.max=this.d+this.h*Math.SQRT2}function Ab(e,t){let r=!1,n=1/0;for(let i=0;i<t.length;i++){let o=t[i];for(let a=0,s=o.length,l=s-1;a<s;l=a++){let u=o[a],c=o[l];u.y>e.y!=c.y>e.y&&e.x<(c.x-u.x)*(e.y-u.y)/(c.y-u.y)+u.x&&(r=!r),n=Math.min(n,Fs(e,u,c))}}return(r?1:-1)*Math.sqrt(n)}function _b(e){let t=0,r=0,n=0,i=e[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){let l=i[o],u=i[s],c=l.x*u.y-u.x*l.y;r+=(l.x+u.x)*c,n+=(l.y+u.y)*c,t+=c*3}return new Br(r/t,n/t,0,e)}var ol=Z(Is(),1);var rl=(o=>(o[o.center=1]="center",o[o.left=2]="left",o[o.right=3]="right",o[o.top=4]="top",o[o.bottom=5]="bottom",o[o["top-left"]=6]="top-left",o[o["top-right"]=7]="top-right",o[o["bottom-left"]=8]="bottom-left",o[o["bottom-right"]=9]="bottom-right",o))(rl||{}),kt=7,ha=Number.POSITIVE_INFINITY;function nl(e,t){function r(i,o){let a=0,s=0;o<0&&(o=0);let l=o/Math.SQRT2;switch(i){case"top-right":case"top-left":s=l-kt;break;case"bottom-right":case"bottom-left":s=-l+kt;break;case"bottom":s=-o+kt;break;case"top":s=o-kt;break}switch(i){case"top-right":case"bottom-right":a=-l;break;case"top-left":case"bottom-left":a=l;break;case"left":a=o;break;case"right":a=-o;break}return[a,s]}function n(i,o,a){let s=0,l=0;switch(o=Math.abs(o),a=Math.abs(a),i){case"top-right":case"top-left":case"top":l=a-kt;break;case"bottom-right":case"bottom-left":case"bottom":l=-a+kt;break}switch(i){case"top-right":case"bottom-right":case"right":s=-o;break;case"top-left":case"bottom-left":case"left":s=o;break}return[s,l]}return t[1]!==ha?n(e,t[0],t[1]):r(e,t[0])}function il(e,t,r){var a;let n=e.layout,i=(a=n.get("text-variable-anchor-offset"))==null?void 0:a.evaluate(t,{},r);if(i){let s=i.values,l=[];for(let u=0;u<s.length;u+=2){let c=l[u]=s[u],p=s[u+1].map(f=>f*ne);c.startsWith("top")?p[1]-=kt:c.startsWith("bottom")&&(p[1]+=kt),l[u+1]=p}return new Ne(l)}let o=n.get("text-variable-anchor");if(o){let s;e._unevaluatedLayout.getValue("text-radial-offset")!==void 0?s=[n.get("text-radial-offset").evaluate(t,{},r)*ne,ha]:s=n.get("text-offset").evaluate(t,{},r).map(c=>c*ne);let u=[];for(let c of o)u.push(c,nl(c,s));return new Ne(u)}return null}function Bf(e){e.bucket.createArrays();let t=512*e.bucket.overscaling;e.bucket.tilePixelRatio=8192/t,e.bucket.compareText={},e.bucket.iconsNeedLinear=!1;let r=e.bucket.layers[0],n=r.layout,i=r._unevaluatedLayout._values,o={layoutIconSize:i["icon-size"].possiblyEvaluate(new q(e.bucket.zoom+1),e.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new q(e.bucket.zoom+1),e.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new q(18))};if(e.bucket.textSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=e.bucket.textSizeData;o.compositeTextSizes=[i["text-size"].possiblyEvaluate(new q(c),e.canonical),i["text-size"].possiblyEvaluate(new q(p),e.canonical)]}if(e.bucket.iconSizeData.kind==="composite"){let{minZoom:c,maxZoom:p}=e.bucket.iconSizeData;o.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new q(c),e.canonical),i["icon-size"].possiblyEvaluate(new q(p),e.canonical)]}let a=n.get("text-line-height")*ne,s=n.get("text-rotation-alignment")!=="viewport"&&n.get("symbol-placement")!=="point",l=n.get("text-keep-upright"),u=n.get("text-size");for(let c of e.bucket.features){let p=n.get("text-font").evaluate(c,{},e.canonical).join(","),f=u.evaluate(c,{},e.canonical),y=o.layoutTextSize.evaluate(c,{},e.canonical),m=o.layoutIconSize.evaluate(c,{},e.canonical),h={horizontal:{},vertical:void 0},d=c.text,g=[0,0];if(d){let P=d.toString(),w=n.get("text-letter-spacing").evaluate(c,{},e.canonical)*ne,T=hc(P)?w:0,F=n.get("text-anchor").evaluate(c,{},e.canonical),E=il(r,c,e.canonical);if(!E){let A=n.get("text-radial-offset").evaluate(c,{},e.canonical);A?g=nl(F,[A*ne,ha]):g=n.get("text-offset").evaluate(c,{},e.canonical).map(z=>z*ne)}let _=s?"center":n.get("text-justify").evaluate(c,{},e.canonical),I=n.get("symbol-placement"),k=I==="point"?n.get("text-max-width").evaluate(c,{},e.canonical)*ne:0,V=()=>{e.bucket.allowVerticalPlacement&&mn(P)&&(h.vertical=ni(d,e.glyphMap,e.glyphPositions,e.imagePositions,p,k,a,F,"left",T,g,2,!0,I,y,f))};if(!s&&E){let A=new Set;if(_==="auto")for(let O=0;O<E.values.length;O+=2)A.add(Df(E.values[O]));else A.add(_);let z=!1;for(let O of A)if(!h.horizontal[O])if(z)h.horizontal[O]=h.horizontal[0];else{let N=ni(d,e.glyphMap,e.glyphPositions,e.imagePositions,p,k,a,"center",O,T,g,1,!1,I,y,f);N&&(h.horizontal[O]=N,z=N.positionedLines.length===1)}V()}else{_==="auto"&&(_=Df(F));let A=ni(d,e.glyphMap,e.glyphPositions,e.imagePositions,p,k,a,F,_,T,g,1,!1,I,y,f);A&&(h.horizontal[_]=A),V(),mn(P)&&s&&l&&(h.vertical=ni(d,e.glyphMap,e.glyphPositions,e.imagePositions,p,k,a,F,_,T,g,2,!1,I,y,f))}}let b,x=!1;if(c.icon&&c.icon.name){let P=e.imageMap[c.icon.name];P&&(b=sf(e.imagePositions[c.icon.name],n.get("icon-offset").evaluate(c,{},e.canonical),n.get("icon-anchor").evaluate(c,{},e.canonical)),x=!!P.sdf,e.bucket.sdfIcons===void 0?e.bucket.sdfIcons=x:e.bucket.sdfIcons!==x&&fe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(P.pixelRatio!==e.bucket.pixelRatio||n.get("icon-rotate").constantOr(1)!==0)&&(e.bucket.iconsNeedLinear=!0))}let v=zf(h.horizontal)||h.vertical;e.bucket.iconsInText=v?v.iconsInText:!1,(v||b)&&Ib(e.bucket,c,h,b,e.imageMap,o,y,m,g,x,e.canonical)}e.showCollisionBoxes&&e.bucket.generateCollisionDebugBuffers()}function Df(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Ib(e,t,r,n,i,o,a,s,l,u,c){let p=o.textMaxSize.evaluate(t,{});p===void 0&&(p=a);let f=e.layers[0].layout,y=f.get("icon-offset").evaluate(t,{},c),m=zf(r.horizontal),h=24,d=a/h,g=e.tilePixelRatio*d,b=e.tilePixelRatio*p/h,x=e.tilePixelRatio*s,v=e.tilePixelRatio*f.get("symbol-spacing"),P=f.get("text-padding")*e.tilePixelRatio,w=yf(f,t,c,e.tilePixelRatio),T=f.get("text-max-angle")/180*Math.PI,F=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",E=f.get("icon-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point",_=f.get("symbol-placement"),I=v/2,k=f.get("icon-text-fit"),V;n&&k!=="none"&&(e.allowVerticalPlacement&&r.vertical&&(V=Xs(n,r.vertical,k,f.get("icon-text-fit-padding"),y,d)),m&&(n=Xs(n,m,k,f.get("icon-text-fit-padding"),y,d)));let A=(z,O)=>{O.x<0||O.x>=8192||O.y<0||O.y>=8192||Cb(e,O,z,r,n,i,V,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,g,[P,P,P,P],F,l,x,w,E,y,t,o,u,c,a)};if(_==="line")for(let z of Mf(t.geometry,0,0,8192,8192)){let O=Cf(z,v,T,r.vertical||m,n,h,b,e.overscaling,8192);for(let N of O){let K=m;(!K||!kb(e,K.text,I,N))&&A(z,N)}}else if(_==="line-center"){for(let z of t.geometry)if(z.length>1){let O=Tf(z,T,r.vertical||m,n,h,b);O&&A(z,O)}}else if(t.type==="Polygon")for(let z of _r(t.geometry,0)){let O=Lf(z,16);A(z[0],new rt(O.x,O.y,0))}else if(t.type==="LineString")for(let z of t.geometry)A(z,new rt(z[0].x,z[0].y,0));else if(t.type==="Point")for(let z of t.geometry)for(let O of z)A([O],new rt(O.x,O.y,0))}function Tb(e,t){let r=e.length,n=t==null?void 0:t.values;if((n==null?void 0:n.length)>0)for(let i=0;i<n.length;i+=2){let o=rl[n[i]],a=n[i+1];e.emplaceBack(o,a[0],a[1])}return[r,e.length]}function Vf(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m){let h=Ff(t,r,s,i,o,a,n,e.allowVerticalPlacement),d=e.textSizeData,g=null;d.kind==="source"?(g=[Ct*i.layout.get("text-size").evaluate(a,{})],g[0]>tt&&fe(`${e.layerIds[0]}: Value for "text-size" is >= ${Lr}. Reduce your "text-size".`)):d.kind==="composite"&&(g=[Ct*y.compositeTextSizes[0].evaluate(a,{},m),Ct*y.compositeTextSizes[1].evaluate(a,{},m)],(g[0]>tt||g[1]>tt)&&fe(`${e.layerIds[0]}: Value for "text-size" is >= ${Lr}. Reduce your "text-size".`)),e.addSymbols(e.text,h,g,s,o,a,u,t,l.lineStartIndex,l.lineLength,f,m);for(let b of c)p[b]=e.text.placedSymbolArray.length-1;return h.length*4}function zf(e){for(let t in e)return e[t];return null}function Cb(e,t,r,n,i,o,a,s,l,u,c,p,f,y,m,h,d,g,b,x,v,P,w,T,F){let E=e.addToLineVertexArray(t,r),_,I,k,V,A=0,z=0,O=0,N=0,K=-1,xe=-1,X={},le=(0,ol.default)("");if(e.allowVerticalPlacement&&n.vertical){let ve=s.layout.get("text-rotate").evaluate(v,{},T)+90,Ve=n.vertical;k=new nr(l,t,u,c,p,Ve,f,y,m,ve),a&&(V=new nr(l,t,u,c,p,a,d,g,m,ve))}if(i){let Ie=s.layout.get("icon-rotate").evaluate(v,{}),ve=s.layout.get("icon-text-fit")!=="none",Ve=el(i,Ie,w,ve),Nr=a?el(a,Ie,w,ve):void 0;I=new nr(l,t,u,c,p,i,d,g,!1,Ie),A=Ve.length*4;let Fl=e.iconSizeData,Lt=null;Fl.kind==="source"?(Lt=[Ct*s.layout.get("icon-size").evaluate(v,{})],Lt[0]>tt&&fe(`${e.layerIds[0]}: Value for "icon-size" is >= ${Lr}. Reduce your "icon-size".`)):Fl.kind==="composite"&&(Lt=[Ct*P.compositeIconSizes[0].evaluate(v,{},T),Ct*P.compositeIconSizes[1].evaluate(v,{},T)],(Lt[0]>tt||Lt[1]>tt)&&fe(`${e.layerIds[0]}: Value for "icon-size" is >= ${Lr}. Reduce your "icon-size".`)),e.addSymbols(e.icon,Ve,Lt,x,b,v,0,t,E.lineStartIndex,E.lineLength,-1,T),K=e.icon.placedSymbolArray.length-1,Nr&&(z=Nr.length*4,e.addSymbols(e.icon,Nr,Lt,x,b,v,2,t,E.lineStartIndex,E.lineLength,-1,T),xe=e.icon.placedSymbolArray.length-1)}let ce=Object.keys(n.horizontal);for(let Ie of ce){let ve=n.horizontal[Ie];if(!_){le=(0,ol.default)(ve.text);let Nr=s.layout.get("text-rotate").evaluate(v,{},T);_=new nr(l,t,u,c,p,ve,f,y,m,Nr)}let Ve=ve.positionedLines.length===1;if(O+=Vf(e,t,ve,o,s,m,v,h,E,n.vertical?1:3,Ve?ce:[Ie],X,K,P,T),Ve)break}n.vertical&&(N+=Vf(e,t,n.vertical,o,s,m,v,h,E,2,["vertical"],X,xe,P,T));let pe=_?_.boxStartIndex:e.collisionBoxArray.length,_e=_?_.boxEndIndex:e.collisionBoxArray.length,be=k?k.boxStartIndex:e.collisionBoxArray.length,wi=k?k.boxEndIndex:e.collisionBoxArray.length,Ea=I?I.boxStartIndex:e.collisionBoxArray.length,Fa=I?I.boxEndIndex:e.collisionBoxArray.length,Or=V?V.boxStartIndex:e.collisionBoxArray.length,Ai=V?V.boxEndIndex:e.collisionBoxArray.length,Me=-1,Ft=(Ie,ve)=>Ie&&Ie.circleDiameter?Math.max(Ie.circleDiameter,ve):ve;Me=Ft(_,Me),Me=Ft(k,Me),Me=Ft(I,Me),Me=Ft(V,Me);let _i=Me>-1?1:0;_i&&(Me*=F/ne),e.glyphOffsetArray.length>=He.MAX_GLYPHS&&fe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),v.sortKey!==void 0&&e.addToSortKeyRanges(e.symbolInstances.length,v.sortKey);let La=il(s,v,T),[Da,Va]=Tb(e.textAnchorOffsets,La);e.symbolInstances.emplaceBack(t.x,t.y,X.right>=0?X.right:-1,X.center>=0?X.center:-1,X.left>=0?X.left:-1,X.vertical||-1,K,xe,le,pe,_e,be,wi,Ea,Fa,Or,Ai,u,O,N,A,z,_i,0,f,Me,Da,Va)}function kb(e,t,r,n){let i=e.compareText;if(!(t in i))i[t]=[];else{let o=i[t];for(let a=o.length-1;a>=0;a--)if(n.dist(o[a])<r)return!0}return i[t].push(n),!1}var da=1,pi=class{constructor(t){let r={},n=[];for(let s in t){let l=t[s],u=r[s]={};for(let c in l){let p=l[+c];if(!p||p.bitmap.width===0||p.bitmap.height===0)continue;let f={x:0,y:0,w:p.bitmap.width+2*da,h:p.bitmap.height+2*da};n.push(f),u[c]={rect:f,metrics:p.metrics}}}let{w:i,h:o}=ei(n),a=new Yt({width:i||1,height:o||1});for(let s in t){let l=t[s];for(let u in l){let c=l[+u];if(!c||c.bitmap.width===0||c.bitmap.height===0)continue;let p=r[s][u].rect;Yt.copy(c.bitmap,a,{x:0,y:0},{x:p.x+da,y:p.y+da},c.bitmap)}}this.image=a,this.positions=r}};C("GlyphAtlas",pi);function Of(e,t,r){t=Math.pow(2,r)-t-1;var n=Rf(e*256,t*256,r),i=Rf((e+1)*256,(t+1)*256,r);return n[0]+","+n[1]+","+i[0]+","+i[1]}function Rf(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r),i=e*n-2*Math.PI*6378137/2,o=t*n-2*Math.PI*6378137/2;return[i,o]}var $f=Z(he(),1);var al=63710088e-1,fi=class e{constructor(t,r){if(isNaN(t)||isNaN(r))throw new Error(`Invalid LngLat object: (${t}, ${r})`);if(this.lng=+t,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new e(Gl(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){let r=Math.PI/180,n=this.lat*r,i=t.lat*r,o=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos((t.lng-this.lng)*r);return al*Math.acos(Math.min(o,1))}static convert(t){if(t instanceof e)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new e(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new e(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};var Nf=2*Math.PI*al;function Uf(e){return Nf*Math.cos(e*Math.PI/180)}function Mb(e){return(180+e)/360}function Eb(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Fb(e,t){return e/Uf(t)}function Lb(e){return e*360-180}function sl(e){let t=180-e*360;return 360/Math.PI*Math.atan(Math.exp(t*Math.PI/180))-90}function Db(e,t){return e*Uf(sl(t))}function Vb(e){return 1/Math.cos(e*Math.PI/180)}var ga=class e{constructor(t,r,n=0){this.x=+t,this.y=+r,this.z=+n}static fromLngLat(t,r=0){let n=fi.convert(t);return new e(Mb(n.lng),Eb(n.lat),Fb(r,n.lat))}toLngLat(){return new fi(Lb(this.x),sl(this.y))}toAltitude(){return Db(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Nf*Vb(sl(this.y))}};var xa=class{constructor(t,r,n){if(t<0||t>25||n<0||n>=Math.pow(2,t)||r<0||r>=Math.pow(2,t))throw new Error(`x=${r}, y=${n}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=r,this.y=n,this.key=yi(0,t,t,r,n)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,r,n){let i=Of(this.x,this.y,this.z),o=Bb(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(n==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,o).replace(/{bbox-epsg-3857}/g,i)}isChildOf(t){let r=this.z-t.z;return r>0&&t.x===this.x>>r&&t.y===this.y>>r}getTilePoint(t){let r=Math.pow(2,this.z);return new $f.default((t.x*r-this.x)*8192,(t.y*r-this.y)*8192)}toString(){return`${this.z}/${this.x}/${this.y}`}},ll=class{constructor(t,r){this.wrap=t,this.canonical=r,this.key=yi(t,r.z,r.z,r.x,r.y)}},mi=class e{constructor(t,r,n,i,o){if(t<n)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${n}`);this.overscaledZ=t,this.wrap=r,this.canonical=new xa(n,+i,+o),this.key=yi(r,t,n,i,o)}clone(){return new e(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let r=this.canonical.z-t;return t>this.canonical.z?new e(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new e(t,this.wrap,t,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(t,r){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let n=this.canonical.z-t;return t>this.canonical.z?yi(this.wrap*+r,t,this.canonical.z,this.canonical.x,this.canonical.y):yi(this.wrap*+r,t,t,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(t){if(t.wrap!==this.wrap)return!1;let r=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>r&&t.canonical.y===this.canonical.y>>r}children(t){if(this.overscaledZ>=t)return[new e(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let r=this.canonical.z+1,n=this.canonical.x*2,i=this.canonical.y*2;return[new e(r,this.wrap,r,n,i),new e(r,this.wrap,r,n+1,i),new e(r,this.wrap,r,n,i+1),new e(r,this.wrap,r,n+1,i+1)]}isLessThan(t){return this.wrap<t.wrap?!0:this.wrap>t.wrap?!1:this.overscaledZ<t.overscaledZ?!0:this.overscaledZ>t.overscaledZ?!1:this.canonical.x<t.canonical.x?!0:this.canonical.x>t.canonical.x?!1:this.canonical.y<t.canonical.y}wrapped(){return new e(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new e(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ll(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new ga(t.x-this.wrap,t.y))}};function yi(e,t,r,n,i){e*=2,e<0&&(e=e*-1-1);let o=1<<r;return(o*o*e+o*i+n).toString(36)+r.toString(36)+t.toString(36)}function Bb(e,t,r){let n="",i;for(let o=e;o>0;o--)i=1<<o-1,n+=(t&i?1:0)+(r&i?2:0);return n}C("CanonicalTileID",xa);C("OverscaledTileID",mi,{omit:["posMatrix"]});var ba=class{constructor(t){this.tileID=new mi(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[]}async parse(t,r,n,i){this.status="parsing",this.data=t,this.collisionBoxArray=new Fn;let o=new Dr(Object.keys(t.layers).sort()),a=new li(this.tileID,this.promoteId);a.bucketLayerIDs=[];let s={},l={featureIndex:a,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:n},u=r.familiesBySource[this.source];for(let P in u){let w=t.layers[P];if(!w)continue;w.version===1&&fe(`Vector tile source "${this.source}" layer "${P}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let T=o.encode(P),F=[];for(let E=0;E<w.length;E++){let _=w.feature(E),I=a.getId(_,P);F.push({feature:_,id:I,index:E,sourceLayerIndex:T})}for(let E of u[P]){let _=E[0];if(_.source!==this.source&&fe(`layer.source = ${_.source} does not equal this.source = ${this.source}`),_.minzoom&&this.zoom<Math.floor(_.minzoom)||_.maxzoom&&this.zoom>=_.maxzoom||_.visibility==="none")continue;ul(E,this.zoom,n),(s[_.id]=_.createBucket({index:a.bucketLayerIDs.length,layers:E,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:T,sourceID:this.source})).populate(F,l,this.tileID.canonical),a.bucketLayerIDs.push(E.map(k=>k.id))}}let c=Gr(l.glyphDependencies,P=>Object.keys(P).map(Number));this.inFlightDependencies.forEach(P=>P==null?void 0:P.abort()),this.inFlightDependencies=[];let p=Promise.resolve({});if(Object.keys(c).length){let P=new AbortController;this.inFlightDependencies.push(P),p=i.sendAsync({type:"GG",data:{stacks:c,source:this.source,tileID:this.tileID,type:"glyphs"}},P)}let f=Object.keys(l.iconDependencies),y=Promise.resolve({});if(f.length){let P=new AbortController;this.inFlightDependencies.push(P),y=i.sendAsync({type:"GI",data:{icons:f,source:this.source,tileID:this.tileID,type:"icons"}},P)}let m=Object.keys(l.patternDependencies),h=Promise.resolve({});if(m.length){let P=new AbortController;this.inFlightDependencies.push(P),h=i.sendAsync({type:"GI",data:{icons:m,source:this.source,tileID:this.tileID,type:"patterns"}},P)}let[d,g,b]=await Promise.all([p,y,h]),x=new pi(d),v=new ti(g,b);for(let P in s){let w=s[P];w instanceof He?(ul(w.layers,this.zoom,n),Bf({bucket:w,glyphMap:d,glyphPositions:x.positions,imageMap:g,imagePositions:v.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):w.hasPattern&&(w instanceof rr||w instanceof er||w instanceof tr)&&(ul(w.layers,this.zoom,n),w.addFeatures(l,this.tileID.canonical,v.patternPositions))}return this.status="done",{buckets:Object.values(s).filter(P=>!P.isEmpty()),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:x.image,imageAtlas:v,glyphMap:this.returnDependencies?d:null,iconMap:this.returnDependencies?g:null,glyphPositions:this.returnDependencies?x.positions:null}}};function ul(e,t,r){let n=new q(t);for(let i of e)i.recalculate(n,r)}var zb=60,OI=1e3/zb;var zr=class{constructor(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let t=performance.getEntriesByName(this._marks.measure);return t.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),t=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),t}};var Rr=class{constructor(t,r,n){this.actor=t,this.layerIndex=r,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}async loadVectorTile(t,r){let n=await uc(t.request,r);try{return{vectorTile:new Gf.default.VectorTile(new qf.default(n.data)),rawData:n.data,cacheControl:n.cacheControl,expires:n.expires}}catch(i){let o=new Uint8Array(n.data),a=o[0]===31&&o[1]===139,s=`Unable to parse the tile at ${t.request.url}, `;throw a?s+="please make sure the data is not gzipped and that you have configured the relevant header in the server":s+=`got error: ${i.messge}`,new Error(s)}}async loadTile(t){let r=t.uid,n=t&&t.request&&t.request.collectResourceTiming?new zr(t.request):!1,i=new ba(t);this.loading[r]=i;let o=new AbortController;i.abort=o;try{let a=await this.loadVectorTile(t,o);if(delete this.loading[r],!a)return null;let s=a.rawData,l={};a.expires&&(l.expires=a.expires),a.cacheControl&&(l.cacheControl=a.cacheControl);let u={};if(n){let p=n.finish();p&&(u.resourceTiming=JSON.parse(JSON.stringify(p)))}i.vectorTile=a.vectorTile;let c=i.parse(a.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[r]=i,this.fetching[r]={rawTileData:s,cacheControl:l,resourceTiming:u};try{let p=await c;return Pe({rawTileData:s.slice(0)},p,l,u)}finally{delete this.fetching[r]}}catch(a){throw delete this.loading[r],i.status="done",this.loaded[r]=i,a}}async reloadTile(t){let r=t.uid;if(!this.loaded||!this.loaded[r])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let n=this.loaded[r];if(n.showCollisionBoxes=t.showCollisionBoxes,n.status==="parsing"){let i=await n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor),o;if(this.fetching[r]){let{rawTileData:a,cacheControl:s,resourceTiming:l}=this.fetching[r];delete this.fetching[r],o=Pe({rawTileData:a.slice(0)},i,s,l)}else o=i;return o}if(n.status==="done"&&n.vectorTile)return n.parse(n.vectorTile,this.layerIndex,this.availableImages,this.actor)}async abortTile(t){let r=this.loading,n=t.uid;r&&r[n]&&r[n].abort&&(r[n].abort.abort(),delete r[n])}async removeTile(t){this.loaded&&this.loaded[t.uid]&&delete this.loaded[t.uid]}};var hi=class{constructor(t,r,n,i=1,o=1,a=1,s=0){if(this.uid=t,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n)){fe(`"${n}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);return}this.stride=r.height;let l=this.dim=r.height-2;switch(this.data=new Uint32Array(r.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=i,this.greenFactor=o,this.blueFactor=a,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let u=0;u<l;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(l,u)]=this.data[this._idx(l-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,l)]=this.data[this._idx(u,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let u=0;u<l;u++)for(let c=0;c<l;c++){let p=this.get(u,c);p>this.max&&(this.max=p),p<this.min&&(this.min=p)}}get(t,r){let n=new Uint8Array(this.data.buffer),i=this._idx(t,r)*4;return this.unpack(n[i],n[i+1],n[i+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,r){if(t<-1||t>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(t+1)}unpack(t,r,n){return t*this.redFactor+r*this.greenFactor+n*this.blueFactor-this.baseShift}getPixels(){return new de({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,r,n){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let i=r*this.dim,o=r*this.dim+this.dim,a=n*this.dim,s=n*this.dim+this.dim;switch(r){case-1:i=o-1;break;case 1:o=i+1;break}switch(n){case-1:a=s-1;break;case 1:s=a+1;break}let l=-r*this.dim,u=-n*this.dim;for(let c=a;c<s;c++)for(let p=i;p<o;p++)this.data[this._idx(p,c)]=t.data[this._idx(p+l,c+u)]}};C("DEMData",hi);var va=class{constructor(){this.loaded={}}async loadTile(t){let{uid:r,encoding:n,rawImageData:i,redFactor:o,greenFactor:a,blueFactor:s,baseShift:l}=t,u=i.width+2,c=i.height+2,p=qr(i)?new de({width:u,height:c},await Wl(i,-1,-1,u,c)):i,f=new hi(r,p,n,o,a,s,l);return this.loaded=this.loaded||{},this.loaded[r]=f,f}removeTile(t){let r=this.loaded,n=t.uid;r&&r[n]&&delete r[n]}};var gy=Z(Wf(),1);var cl=Z(he(),1),Hf=Z(Tt(),1);var Rb=Hf.default.VectorTileFeature.prototype.toGeoJSON,pl=class{constructor(t){this._feature=t,this.extent=8192,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(this._feature.type===1){let t=[];for(let r of this._feature.geometry)t.push([new cl.default(r[0],r[1])]);return t}else{let t=[];for(let r of this._feature.geometry){let n=[];for(let i of r)n.push(new cl.default(i[0],i[1]));t.push(n)}return t}}toGeoJSON(t,r,n){return Rb.call(this,t,r,n)}},Sa=class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=8192,this.length=t.length,this._features=t}feature(t){return new pl(this._features[t])}};var xy=Z(ty(),1);var ry=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],ml=1,gi=8,bi=class e{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[r,n]=new Uint8Array(t,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");let i=n>>4;if(i!==ml)throw new Error(`Got v${i} data when expected v${ml}.`);let o=ry[n&15];if(!o)throw new Error("Unrecognized array type.");let[a]=new Uint16Array(t,2,1),[s]=new Uint32Array(t,4,1);return new e(s,a,o,t)}constructor(t,r=64,n=Float64Array,i){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=n,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;let o=ry.indexOf(this.ArrayType),a=t*2*this.ArrayType.BYTES_PER_ELEMENT,s=t*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(o<0)throw new Error(`Unexpected typed array class: ${n}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,gi,t),this.coords=new this.ArrayType(this.data,gi+s+l,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(gi+a+s+l),this.ids=new this.IndexArrayType(this.data,gi,t),this.coords=new this.ArrayType(this.data,gi+s+l,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(ml<<4)+o]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=t)}add(t,r){let n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=t,this.coords[this._pos++]=r,n}finish(){let t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return dl(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,r,n,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:o,coords:a,nodeSize:s}=this,l=[0,o.length-1,0],u=[];for(;l.length;){let c=l.pop()||0,p=l.pop()||0,f=l.pop()||0;if(p-f<=s){for(let d=f;d<=p;d++){let g=a[2*d],b=a[2*d+1];g>=t&&g<=n&&b>=r&&b<=i&&u.push(o[d])}continue}let y=f+p>>1,m=a[2*y],h=a[2*y+1];m>=t&&m<=n&&h>=r&&h<=i&&u.push(o[y]),(c===0?t<=m:r<=h)&&(l.push(f),l.push(y-1),l.push(1-c)),(c===0?n>=m:i>=h)&&(l.push(y+1),l.push(p),l.push(1-c))}return u}within(t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],l=[],u=n*n;for(;s.length;){let c=s.pop()||0,p=s.pop()||0,f=s.pop()||0;if(p-f<=a){for(let d=f;d<=p;d++)ny(o[2*d],o[2*d+1],t,r)<=u&&l.push(i[d]);continue}let y=f+p>>1,m=o[2*y],h=o[2*y+1];ny(m,h,t,r)<=u&&l.push(i[y]),(c===0?t-n<=m:r-n<=h)&&(s.push(f),s.push(y-1),s.push(1-c)),(c===0?t+n>=m:r+n>=h)&&(s.push(y+1),s.push(p),s.push(1-c))}return l}};function dl(e,t,r,n,i,o){if(i-n<=r)return;let a=n+i>>1;iy(e,t,a,n,i,o),dl(e,t,r,n,a-1,1-o),dl(e,t,r,a+1,i,1-o)}function iy(e,t,r,n,i,o){for(;i>n;){if(i-n>600){let u=i-n+1,c=r-n+1,p=Math.log(u),f=.5*Math.exp(2*p/3),y=.5*Math.sqrt(p*f*(u-f)/u)*(c-u/2<0?-1:1),m=Math.max(n,Math.floor(r-c*f/u+y)),h=Math.min(i,Math.floor(r+(u-c)*f/u+y));iy(e,t,r,m,h,o)}let a=t[2*r+o],s=n,l=i;for(xi(e,t,n,r),t[2*i+o]>a&&xi(e,t,n,i);s<l;){for(xi(e,t,s,l),s++,l--;t[2*s+o]<a;)s++;for(;t[2*l+o]>a;)l--}t[2*n+o]===a?xi(e,t,n,l):(l++,xi(e,t,l,i)),l<=r&&(n=l+1),r<=l&&(i=l-1)}}function xi(e,t,r,n){hl(e,r,n),hl(t,2*r,2*n),hl(t,2*r+1,2*n+1)}function hl(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function ny(e,t,r,n){let i=e-r,o=t-n;return i*i+o*o}var Hb={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},oy=Math.fround||(e=>t=>(e[0]=+t,e[0]))(new Float32Array(1)),ir=2,Et=3,gl=4,Mt=5,sy=6,vi=class{constructor(t){this.options=Object.assign(Object.create(Hb),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){let{log:r,minZoom:n,maxZoom:i}=this.options;r&&console.time("total time");let o=`prepare ${t.length} points`;r&&console.time(o),this.points=t;let a=[];for(let l=0;l<t.length;l++){let u=t[l];if(!u.geometry)continue;let[c,p]=u.geometry.coordinates,f=oy(Aa(c)),y=oy(_a(p));a.push(f,y,1/0,l,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[i+1]=this._createTree(a);r&&console.timeEnd(o);for(let l=i;l>=n;l--){let u=+Date.now();s=this.trees[l]=this._createTree(this._cluster(s,l)),r&&console.log("z%d: %d clusters in %dms",l,s.numItems,+Date.now()-u)}return r&&console.timeEnd("total time"),this}getClusters(t,r){let n=((t[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[1])),o=t[2]===180?180:((t[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,o=180;else if(n>o){let p=this.getClusters([n,i,180,a],r),f=this.getClusters([-180,i,o,a],r);return p.concat(f)}let s=this.trees[this._limitZoom(r)],l=s.range(Aa(n),_a(a),Aa(o),_a(i)),u=s.data,c=[];for(let p of l){let f=this.stride*p;c.push(u[f+Mt]>1?ay(u,f,this.clusterProps):this.points[u[f+Et]])}return c}getChildren(t){let r=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(i);let a=o.data;if(r*this.stride>=a.length)throw new Error(i);let s=this.options.radius/(this.options.extent*Math.pow(2,n-1)),l=a[r*this.stride],u=a[r*this.stride+1],c=o.within(l,u,s),p=[];for(let f of c){let y=f*this.stride;a[y+gl]===t&&p.push(a[y+Mt]>1?ay(a,y,this.clusterProps):this.points[a[y+Et]])}if(p.length===0)throw new Error(i);return p}getLeaves(t,r,n){r=r||10,n=n||0;let i=[];return this._appendLeaves(i,t,r,n,0),i}getTile(t,r,n){let i=this.trees[this._limitZoom(t)],o=Math.pow(2,t),{extent:a,radius:s}=this.options,l=s/a,u=(n-l)/o,c=(n+1+l)/o,p={features:[]};return this._addTileFeatures(i.range((r-l)/o,u,(r+1+l)/o,c),i.data,r,n,o,p),r===0&&this._addTileFeatures(i.range(1-l/o,u,1,c),i.data,o,n,o,p),r===o-1&&this._addTileFeatures(i.range(0,u,l/o,c),i.data,-1,n,o,p),p.features.length?p:null}getClusterExpansionZoom(t){let r=this._getOriginZoom(t)-1;for(;r<=this.options.maxZoom;){let n=this.getChildren(t);if(r++,n.length!==1)break;t=n[0].properties.cluster_id}return r}_appendLeaves(t,r,n,i,o){let a=this.getChildren(r);for(let s of a){let l=s.properties;if(l&&l.cluster?o+l.point_count<=i?o+=l.point_count:o=this._appendLeaves(t,l.cluster_id,n,i,o):o<i?o++:t.push(s),t.length===n)break}return o}_createTree(t){let r=new bi(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let n=0;n<t.length;n+=this.stride)r.add(t[n],t[n+1]);return r.finish(),r.data=t,r}_addTileFeatures(t,r,n,i,o,a){for(let s of t){let l=s*this.stride,u=r[l+Mt]>1,c,p,f;if(u)c=ly(r,l,this.clusterProps),p=r[l],f=r[l+1];else{let h=this.points[r[l+Et]];c=h.properties;let[d,g]=h.geometry.coordinates;p=Aa(d),f=_a(g)}let y={type:1,geometry:[[Math.round(this.options.extent*(p*o-n)),Math.round(this.options.extent*(f*o-i))]],tags:c},m;u||this.options.generateId?m=r[l+Et]:m=this.points[r[l+Et]].id,m!==void 0&&(y.id=m),a.features.push(y)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,r){let{radius:n,extent:i,reduce:o,minPoints:a}=this.options,s=n/(i*Math.pow(2,r)),l=t.data,u=[],c=this.stride;for(let p=0;p<l.length;p+=c){if(l[p+ir]<=r)continue;l[p+ir]=r;let f=l[p],y=l[p+1],m=t.within(l[p],l[p+1],s),h=l[p+Mt],d=h;for(let g of m){let b=g*c;l[b+ir]>r&&(d+=l[b+Mt])}if(d>h&&d>=a){let g=f*h,b=y*h,x,v=-1,P=((p/c|0)<<5)+(r+1)+this.points.length;for(let w of m){let T=w*c;if(l[T+ir]<=r)continue;l[T+ir]=r;let F=l[T+Mt];g+=l[T]*F,b+=l[T+1]*F,l[T+gl]=P,o&&(x||(x=this._map(l,p,!0),v=this.clusterProps.length,this.clusterProps.push(x)),o(x,this._map(l,T)))}l[p+gl]=P,u.push(g/d,b/d,1/0,P,-1,d),o&&u.push(v)}else{for(let g=0;g<c;g++)u.push(l[p+g]);if(d>1)for(let g of m){let b=g*c;if(!(l[b+ir]<=r)){l[b+ir]=r;for(let x=0;x<c;x++)u.push(l[b+x])}}}}return u}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,r,n){if(t[r+Mt]>1){let a=this.clusterProps[t[r+sy]];return n?Object.assign({},a):a}let i=this.points[t[r+Et]].properties,o=this.options.map(i);return n&&o===i?Object.assign({},o):o}};function ay(e,t,r){return{type:"Feature",id:e[t+Et],properties:ly(e,t,r),geometry:{type:"Point",coordinates:[Xb(e[t]),Kb(e[t+1])]}}}function ly(e,t,r){let n=e[t+Mt],i=n>=1e4?`${Math.round(n/1e3)}k`:n>=1e3?`${Math.round(n/100)/10}k`:n,o=e[t+sy],a=o===-1?{}:Object.assign({},r[o]);return Object.assign(a,{cluster:!0,cluster_id:e[t+Et],point_count:n,point_count_abbreviated:i})}function Aa(e){return e/360+.5}function _a(e){let t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function Xb(e){return(e-.5)*360}function Kb(e){let t=(180-e*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function Pi(e,t,r,n){for(var i=n,o=r-t>>1,a=r-t,s,l=e[t],u=e[t+1],c=e[r],p=e[r+1],f=t+3;f<r;f+=3){var y=Yb(e[f],e[f+1],l,u,c,p);if(y>i)s=f,i=y;else if(y===i){var m=Math.abs(f-o);m<a&&(s=f,a=m)}}i>n&&(s-t>3&&Pi(e,t,s,n),e[s+2]=i,r-s>3&&Pi(e,s,r,n))}function Yb(e,t,r,n,i,o){var a=i-r,s=o-n;if(a!==0||s!==0){var l=((e-r)*a+(t-n)*s)/(a*a+s*s);l>1?(r=i,n=o):l>0&&(r+=a*l,n+=s*l)}return a=e-r,s=t-n,a*a+s*s}function ft(e,t,r,n){var i={id:typeof e>"u"?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Qb(i),i}function Qb(e){var t=e.geometry,r=e.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")xl(e,t);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<t.length;n++)xl(e,t[n]);else if(r==="MultiPolygon")for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)xl(e,t[n][i])}function xl(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function Pl(e,t){var r=[];if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)Ia(r,e.features[n],t,n);else e.type==="Feature"?Ia(r,e,t):Ia(r,{geometry:e},t);return r}function Ia(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],l=t.id;if(r.promoteId?l=t.properties[r.promoteId]:r.generateId&&(l=n||0),o==="Point")uy(i,s);else if(o==="MultiPoint")for(var u=0;u<i.length;u++)uy(i[u],s);else if(o==="LineString")vl(i,s,a,!1);else if(o==="MultiLineString")if(r.lineMetrics){for(u=0;u<i.length;u++)s=[],vl(i[u],s,a,!1),e.push(ft(l,"LineString",s,t.properties));return}else bl(i,s,a,!1);else if(o==="Polygon")bl(i,s,a,!0);else if(o==="MultiPolygon")for(u=0;u<i.length;u++){var c=[];bl(i[u],c,a,!0),s.push(c)}else if(o==="GeometryCollection"){for(u=0;u<t.geometry.geometries.length;u++)Ia(e,{id:l,geometry:t.geometry.geometries[u],properties:t.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(ft(l,o,s,t.properties))}}function uy(e,t){t.push(cy(e[0])),t.push(py(e[1])),t.push(0)}function vl(e,t,r,n){for(var i,o,a=0,s=0;s<e.length;s++){var l=cy(e[s][0]),u=py(e[s][1]);t.push(l),t.push(u),t.push(0),s>0&&(n?a+=(i*u-l*o)/2:a+=Math.sqrt(Math.pow(l-i,2)+Math.pow(u-o,2))),i=l,o=u}var c=t.length-3;t[2]=1,Pi(t,0,c,r),t[c+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function bl(e,t,r,n){for(var i=0;i<e.length;i++){var o=[];vl(e[i],o,r,n),t.push(o)}}function cy(e){return e/360+.5}function py(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function qe(e,t,r,n,i,o,a,s){if(r/=t,n/=t,o>=r&&a<n)return e;if(a<r||o>=n)return null;for(var l=[],u=0;u<e.length;u++){var c=e[u],p=c.geometry,f=c.type,y=i===0?c.minX:c.minY,m=i===0?c.maxX:c.maxY;if(y>=r&&m<n){l.push(c);continue}else if(m<r||y>=n)continue;var h=[];if(f==="Point"||f==="MultiPoint")e0(p,h,r,n,i);else if(f==="LineString")yy(p,h,r,n,i,!1,s.lineMetrics);else if(f==="MultiLineString")Sl(p,h,r,n,i,!1);else if(f==="Polygon")Sl(p,h,r,n,i,!0);else if(f==="MultiPolygon")for(var d=0;d<p.length;d++){var g=[];Sl(p[d],g,r,n,i,!0),g.length&&h.push(g)}if(h.length){if(s.lineMetrics&&f==="LineString"){for(d=0;d<h.length;d++)l.push(ft(c.id,f,h[d],c.tags));continue}(f==="LineString"||f==="MultiLineString")&&(h.length===1?(f="LineString",h=h[0]):f="MultiLineString"),(f==="Point"||f==="MultiPoint")&&(f=h.length===3?"Point":"MultiPoint"),l.push(ft(c.id,f,h,c.tags))}}return l.length?l:null}function e0(e,t,r,n,i){for(var o=0;o<e.length;o+=3){var a=e[o+i];a>=r&&a<=n&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function yy(e,t,r,n,i,o,a){for(var s=fy(e),l=i===0?t0:r0,u=e.start,c,p,f=0;f<e.length-3;f+=3){var y=e[f],m=e[f+1],h=e[f+2],d=e[f+3],g=e[f+4],b=i===0?y:m,x=i===0?d:g,v=!1;a&&(c=Math.sqrt(Math.pow(y-d,2)+Math.pow(m-g,2))),b<r?x>r&&(p=l(s,y,m,d,g,r),a&&(s.start=u+c*p)):b>n?x<n&&(p=l(s,y,m,d,g,n),a&&(s.start=u+c*p)):wl(s,y,m,h),x<r&&b>=r&&(p=l(s,y,m,d,g,r),v=!0),x>n&&b<=n&&(p=l(s,y,m,d,g,n),v=!0),!o&&v&&(a&&(s.end=u+c*p),t.push(s),s=fy(e)),a&&(u+=c)}var P=e.length-3;y=e[P],m=e[P+1],h=e[P+2],b=i===0?y:m,b>=r&&b<=n&&wl(s,y,m,h),P=s.length-3,o&&P>=3&&(s[P]!==s[0]||s[P+1]!==s[1])&&wl(s,s[0],s[1],s[2]),s.length&&t.push(s)}function fy(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function Sl(e,t,r,n,i,o){for(var a=0;a<e.length;a++)yy(e[a],t,r,n,i,o,!1)}function wl(e,t,r,n){e.push(t),e.push(r),e.push(n)}function t0(e,t,r,n,i,o){var a=(o-t)/(n-t);return e.push(o),e.push(r+(i-r)*a),e.push(1),a}function r0(e,t,r,n,i,o){var a=(o-r)/(i-r);return e.push(t+(n-t)*a),e.push(o),e.push(1),a}function _l(e,t){var r=t.buffer/t.extent,n=e,i=qe(e,1,-1-r,r,0,-1,2,t),o=qe(e,1,1-r,2+r,0,-1,2,t);return(i||o)&&(n=qe(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=my(i,1).concat(n)),o&&(n=n.concat(my(o,-1)))),n}function my(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=i.type,a;if(o==="Point"||o==="MultiPoint"||o==="LineString")a=Al(i.geometry,t);else if(o==="MultiLineString"||o==="Polygon"){a=[];for(var s=0;s<i.geometry.length;s++)a.push(Al(i.geometry[s],t))}else if(o==="MultiPolygon")for(a=[],s=0;s<i.geometry.length;s++){for(var l=[],u=0;u<i.geometry[s].length;u++)l.push(Al(i.geometry[s][u],t));a.push(l)}r.push(ft(i.id,o,a,i.tags))}return r}function Al(e,t){var r=[];r.size=e.size,e.start!==void 0&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function Ta(e,t){if(e.transformed)return e;var r=1<<e.z,n=e.x,i=e.y,o,a,s;for(o=0;o<e.features.length;o++){var l=e.features[o],u=l.geometry,c=l.type;if(l.geometry=[],c===1)for(a=0;a<u.length;a+=2)l.geometry.push(hy(u[a],u[a+1],t,r,n,i));else for(a=0;a<u.length;a++){var p=[];for(s=0;s<u[a].length;s+=2)p.push(hy(u[a][s],u[a][s+1],t,r,n,i));l.geometry.push(p)}}return e.transformed=!0,e}function hy(e,t,r,n,i,o){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-o))]}function Tl(e,t,r,n,i){for(var o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,n0(a,e[s],o,i);var l=e[s].minX,u=e[s].minY,c=e[s].maxX,p=e[s].maxY;l<a.minX&&(a.minX=l),u<a.minY&&(a.minY=u),c>a.maxX&&(a.maxX=c),p>a.maxY&&(a.maxY=p)}return a}function n0(e,t,r,n){var i=t.geometry,o=t.type,a=[];if(o==="Point"||o==="MultiPoint")for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),e.numPoints++,e.numSimplified++;else if(o==="LineString")Il(a,i,e,r,!1,!1);else if(o==="MultiLineString"||o==="Polygon")for(s=0;s<i.length;s++)Il(a,i[s],e,r,o==="Polygon",s===0);else if(o==="MultiPolygon")for(var l=0;l<i.length;l++){var u=i[l];for(s=0;s<u.length;s++)Il(a,u[s],e,r,!0,s===0)}if(a.length){var c=t.tags||null;if(o==="LineString"&&n.lineMetrics){c={};for(var p in t.tags)c[p]=t.tags[p];c.mapbox_clip_start=i.start/i.size,c.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:o==="Polygon"||o==="MultiPolygon"?3:o==="LineString"||o==="MultiLineString"?2:1,tags:c};t.id!==null&&(f.id=t.id),e.features.push(f)}}function Il(e,t,r,n,i,o){var a=n*n;if(n>0&&t.size<(i?a:n)){r.numPoints+=t.length/3;return}for(var s=[],l=0;l<t.length;l+=3)(n===0||t[l+2]>a)&&(r.numSimplified++,s.push(t[l]),s.push(t[l+1])),r.numPoints++;i&&i0(s,o),e.push(s)}function i0(e,t){for(var r=0,n=0,i=e.length,o=i-2;n<i;o=n,n+=2)r+=(e[n]-e[o])*(e[n+1]+e[o+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var a=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=a,e[i-1-n]=s}}function kl(e,t){return new Ca(e,t)}function Ca(e,t){t=this.options=o0(Object.create(this.options),t);var r=t.debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=Pl(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=_l(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Ca.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};Ca.prototype.splitTile=function(e,t,r,n,i,o,a){for(var s=[e,t,r,n],l=this.options,u=l.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var c=1<<t,p=Cl(t,r,n),f=this.tiles[p];if(!f&&(u>1&&console.time("creation"),f=this.tiles[p]=Tl(e,t,r,n,l),this.tileCoords.push({z:t,x:r,y:n}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var y="z"+t;this.stats[y]=(this.stats[y]||0)+1,this.total++}if(f.source=e,i){if(t===l.maxZoom||t===i)continue;var m=1<<i-t;if(r!==Math.floor(o/m)||n!==Math.floor(a/m))continue}else if(t===l.indexMaxZoom||f.numPoints<=l.indexMaxPoints)continue;if(f.source=null,e.length!==0){u>1&&console.time("clipping");var h=.5*l.buffer/l.extent,d=.5-h,g=.5+h,b=1+h,x,v,P,w,T,F;x=v=P=w=null,T=qe(e,c,r-h,r+g,0,f.minX,f.maxX,l),F=qe(e,c,r+d,r+b,0,f.minX,f.maxX,l),e=null,T&&(x=qe(T,c,n-h,n+g,1,f.minY,f.maxY,l),v=qe(T,c,n+d,n+b,1,f.minY,f.maxY,l),T=null),F&&(P=qe(F,c,n-h,n+g,1,f.minY,f.maxY,l),w=qe(F,c,n+d,n+b,1,f.minY,f.maxY,l),F=null),u>1&&console.timeEnd("clipping"),s.push(x||[],t+1,r*2,n*2),s.push(v||[],t+1,r*2,n*2+1),s.push(P||[],t+1,r*2+1,n*2),s.push(w||[],t+1,r*2+1,n*2+1)}}};Ca.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,o=n.debug;if(e<0||e>24)return null;var a=1<<e;t=(t%a+a)%a;var s=Cl(e,t,r);if(this.tiles[s])return Ta(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var l=e,u=t,c=r,p;!p&&l>0;)l--,u=Math.floor(u/2),c=Math.floor(c/2),p=this.tiles[Cl(l,u,c)];return!p||!p.source?null:(o>1&&console.log("found parent tile z%d-%d-%d",l,u,c),o>1&&console.time("drilling down"),this.splitTile(p.source,l,u,c,e,t,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?Ta(this.tiles[s],i):null)};function Cl(e,t,r){return((1<<e)*r+t)*32+e}function o0(e,t){for(var r in t)e[r]=t[r];return e}function Si(e,t){return t?e.properties[t]:e.id}function Ml(e,t){if(e==null)return!0;if(e.type==="Feature")return Si(e,t)!=null;if(e.type==="FeatureCollection"){let r=new Set;for(let n of e.features){let i=Si(n,t);if(i==null||r.has(i))return!1;r.add(i)}return!0}return!1}function El(e,t){let r=new Map;if(e!=null)if(e.type==="Feature")r.set(Si(e,t),e);else for(let n of e.features)r.set(Si(n,t),n);return r}function dy(e,t,r){var n,i,o,a;if(t.removeAll&&e.clear(),t.remove)for(let s of t.remove)e.delete(s);if(t.add)for(let s of t.add){let l=Si(s,r);l!=null&&e.set(l,s)}if(t.update)for(let s of t.update){let l=e.get(s.id);if(l==null)continue;let u=s.newGeometry||s.removeAllProperties,c=!s.removeAllProperties&&(((n=s.removeProperties)==null?void 0:n.length)>0||((i=s.addOrUpdateProperties)==null?void 0:i.length)>0);if((u||c)&&(l={...l},e.set(s.id,l),c&&(l.properties={...l.properties})),s.newGeometry&&(l.geometry=s.newGeometry),s.removeAllProperties)l.properties={};else if(((o=s.removeProperties)==null?void 0:o.length)>0)for(let p of s.removeProperties)Object.prototype.hasOwnProperty.call(l.properties,p)&&delete l.properties[p];if(((a=s.addOrUpdateProperties)==null?void 0:a.length)>0)for(let{key:p,value:f}of s.addOrUpdateProperties)l.properties[p]=f}}var ka=class extends Rr{constructor(){super(...arguments);this._dataUpdateable=new Map}async loadVectorTile(r,n){let i=r.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let o=this._geoJSONIndex.getTile(i.z,i.x,i.y);if(!o)return null;let a=new Sa(o.features),s=(0,xy.default)(a);return(s.byteOffset!==0||s.byteLength!==s.buffer.byteLength)&&(s=new Uint8Array(s)),{vectorTile:a,rawData:s.buffer}}async loadData(r){var i;(i=this._pendingRequest)==null||i.abort();let n=r&&r.request&&r.request.collectResourceTiming?new zr(r.request):!1;this._pendingRequest=new AbortController;try{let o=await this.loadGeoJSON(r,this._pendingRequest);if(delete this._pendingRequest,typeof o!="object")throw new Error(`Input data given to \'${r.source}\' is not a valid GeoJSON object.`);if((0,gy.default)(o,!0),r.filter){let s=Gt(r.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(s.result==="error")throw new Error(s.value.map(u=>`${u.key}: ${u.message}`).join(", "));o={type:"FeatureCollection",features:o.features.filter(u=>s.value.evaluate({zoom:0},u))}}this._geoJSONIndex=r.cluster?new vi(a0(r)).load(o.features):kl(o,r.geojsonVtOptions),this.loaded={};let a={};if(n){let s=n.finish();s&&(a.resourceTiming={},a.resourceTiming[r.source]=JSON.parse(JSON.stringify(s)))}return a}catch(o){if(delete this._pendingRequest,ec(o))return{abandoned:!0};throw o}}reloadTile(r){let n=this.loaded,i=r.uid;return n&&n[i]?super.reloadTile(r):this.loadTile(r)}async loadGeoJSON(r,n){let{promoteId:i}=r;if(r.request){let o=await lc(r.request,n);return this._dataUpdateable=Ml(o.data,i)?El(o.data,i):void 0,o.data}if(typeof r.data=="string")try{let o=JSON.parse(r.data);return this._dataUpdateable=Ml(o,i)?El(o,i):void 0,o}catch{throw new Error(`Input data given to \'${r.source}\' is not a valid GeoJSON object.`)}if(!r.dataDiff)throw new Error(`Input data given to \'${r.source}\' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${r.source}`);return dy(this._dataUpdateable,r.dataDiff,i),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}}async removeSource(r){this._pendingRequest&&this._pendingRequest.abort()}getClusterExpansionZoom(r){return this._geoJSONIndex.getClusterExpansionZoom(r.clusterId)}getClusterChildren(r){return this._geoJSONIndex.getChildren(r.clusterId)}getClusterLeaves(r){return this._geoJSONIndex.getLeaves(r.clusterId,r.limit,r.offset)}};function a0({superclusterOptions:e,clusterProperties:t}){if(!t||!e)return e;let r={},n={},i={accumulated:null,zoom:0},o={properties:null},a=Object.keys(t);for(let s of a){let[l,u]=t[s],c=Gt(u),p=Gt(typeof l=="string"?[l,["accumulated"],["get",s]]:l);r[s]=c.value,n[s]=p.value}return e.map=s=>{o.properties=s;let l={};for(let u of a)l[u]=r[u].evaluate(i,o);return l},e.reduce=(s,l)=>{o.properties=l;for(let u of a)i.accumulated=s[u],s[u]=n[u].evaluate(i,o)},e}var Ma=class{constructor(t){this.self=t,this.actor=new to(t),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(r,n)=>{if(this.externalWorkerSourceTypes[r])throw new Error(`Worker source with name "${r}" already registered.`);this.externalWorkerSourceTypes[r]=n},this.self.addProtocol=rc,this.self.removeProtocol=nc,this.self.registerRTLTextPlugin=r=>{if(ye.isParsed())throw new Error("RTL text plugin already registered.");ye.setMethods(r)},this.actor.registerMessageHandler("LDT",(r,n)=>this._getDEMWorkerSource(r,n.source).loadTile(n)),this.actor.registerMessageHandler("RDT",async(r,n)=>{this._getDEMWorkerSource(r,n.source).removeTile(n)}),this.actor.registerMessageHandler("GCEZ",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterExpansionZoom(n)),this.actor.registerMessageHandler("GCC",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterChildren(n)),this.actor.registerMessageHandler("GCL",async(r,n)=>this._getWorkerSource(r,n.type,n.source).getClusterLeaves(n)),this.actor.registerMessageHandler("LD",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadData(n)),this.actor.registerMessageHandler("LT",(r,n)=>this._getWorkerSource(r,n.type,n.source).loadTile(n)),this.actor.registerMessageHandler("RT",(r,n)=>this._getWorkerSource(r,n.type,n.source).reloadTile(n)),this.actor.registerMessageHandler("AT",(r,n)=>this._getWorkerSource(r,n.type,n.source).abortTile(n)),this.actor.registerMessageHandler("RMT",(r,n)=>this._getWorkerSource(r,n.type,n.source).removeTile(n)),this.actor.registerMessageHandler("RS",async(r,n)=>{if(!this.workerSources[r]||!this.workerSources[r][n.type]||!this.workerSources[r][n.type][n.source])return;let i=this.workerSources[r][n.type][n.source];delete this.workerSources[r][n.type][n.source],i.removeSource!==void 0&&i.removeSource(n)}),this.actor.registerMessageHandler("RM",async r=>{delete this.layerIndexes[r],delete this.availableImages[r],delete this.workerSources[r],delete this.demWorkerSources[r]}),this.actor.registerMessageHandler("SR",async(r,n)=>{this.referrer=n}),this.actor.registerMessageHandler("SRPS",(r,n)=>this._syncRTLPluginState(r,n)),this.actor.registerMessageHandler("IS",async(r,n)=>{this.self.importScripts(n)}),this.actor.registerMessageHandler("SI",(r,n)=>this._setImages(r,n)),this.actor.registerMessageHandler("UL",async(r,n)=>{this._getLayerIndex(r).update(n.layers,n.removedIds)}),this.actor.registerMessageHandler("SL",async(r,n)=>{this._getLayerIndex(r).replace(n)})}async _setImages(t,r){this.availableImages[t]=r;for(let n in this.workerSources[t]){let i=this.workerSources[t][n];for(let o in i)i[o].availableImages=r}}async _syncRTLPluginState(t,r){if(ye.isParsed())return ye.getState();if(r.pluginStatus!=="loading")return ye.setState(r),r;let n=r.pluginURL;if(this.self.importScripts(n),ye.isParsed()){let o={pluginStatus:"loaded",pluginURL:n};return ye.setState(o),o}throw ye.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${n}`)}_getAvailableImages(t){let r=this.availableImages[t];return r||(r=[]),r}_getLayerIndex(t){let r=this.layerIndexes[t];return r||(r=this.layerIndexes[t]=new ca),r}_getWorkerSource(t,r,n){if(this.workerSources[t]||(this.workerSources[t]={}),this.workerSources[t][r]||(this.workerSources[t][r]={}),!this.workerSources[t][r][n]){let i={sendAsync:(o,a)=>(o.targetMapId=t,this.actor.sendAsync(o,a))};switch(r){case"vector":this.workerSources[t][r][n]=new Rr(i,this._getLayerIndex(t),this._getAvailableImages(t));break;case"geojson":this.workerSources[t][r][n]=new ka(i,this._getLayerIndex(t),this._getAvailableImages(t));break;default:this.workerSources[t][r][n]=new this.externalWorkerSourceTypes[r](i,this._getLayerIndex(t),this._getAvailableImages(t));break}}return this.workerSources[t][r][n]}_getDEMWorkerSource(t,r){return this.demWorkerSources[t]||(this.demWorkerSources[t]={}),this.demWorkerSources[t][r]||(this.demWorkerSources[t][r]=new va),this.demWorkerSources[t][r]}};at(self)&&(self.worker=new Ma(self));})();\n/*! Bundled license information:\n\nieee754/index.js:\n  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)\n*/\n',bde=h(()=>URL.createObjectURL(new Blob([_de],{type:"text/javascript"})),"getWorkerURL");function yV(){return new Worker(bde())}h(yV,"workerFactory");var G5="maplibre_preloaded_worker_pool",vV=class xV{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<xV.workerCount;)this.workers.push(yV());return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(t=>{t.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[G5]}numActive(){return Object.keys(this.active).length}};h(vV,"WorkerPool");var m_=vV,wde=Math.floor(li.hardwareConcurrency/2);m_.workerCount=CD(globalThis)?Math.max(Math.min(wde,3),1):1;var dm;function g_(){return dm||(dm=new m_),dm}h(g_,"getGlobalWorkerPool");function Sde(){g_().acquire(G5)}h(Sde,"prewarm");function Mde(){let i=dm;i&&(i.isPreloaded()&&i.numActive()===1?(i.release(G5),dm=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}h(Mde,"clearPrewarmedResources");var _V=class{constructor(e,t){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=t;let r=this.workerPool.acquire(t);for(let n=0;n<r.length;n++){let a=r[n],o=new xde(a,t);o.name=`Worker ${n}`,this.actors.push(o)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,t){let r=[];for(let n of this.actors)r.push(n.sendAsync({type:e,data:t}));return Promise.all(r)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(t=>{t.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(let r of this.actors)r.registerMessageHandler(e,t)}};h(_V,"Dispatcher");var bV=_V,c1;function W5(){return c1||(c1=new bV(g_(),Hw),c1.registerMessageHandler("GR",(i,e,t)=>$x(e,t))),c1}h(W5,"getGlobalDispatcher");R();function wV(i,e){let t=ht.create();return ht.translate(t,t,[1,1,0]),ht.scale(t,t,[i.width*.5,i.height*.5,1]),ht.multiply(t,t,i.calculatePosMatrix(e.toUnwrapped()))}h(wV,"getPixelPosMatrix");function SV(i,e,t){if(i)for(let r of i){let n=e[r];if(n&&n.source===t&&n.type==="fill-extrusion")return!0}else for(let r in e){let n=e[r];if(n.source===t&&n.type==="fill-extrusion")return!0}return!1}h(SV,"queryIncludes3DLayer");function MV(i,e,t,r,n,a){let o=SV(n&&n.layers,e,i.id),s=a.maxPitchScaleFactor(),l=i.tilesIn(r,s,o);l.sort(X5);let u=[];for(let p of l)u.push({wrappedTileID:p.tileID.wrapped().key,queryResults:p.tile.queryRenderedFeatures(e,t,i._state,p.queryGeometry,p.cameraQueryGeometry,p.scale,n,a,s,wV(i.transform,p.tileID))});let c=TV(u);for(let p in c)c[p].forEach(d=>{let m=d.feature,g=i.getFeatureState(m.layer["source-layer"],m.id);m.source=m.layer.source,m.layer["source-layer"]&&(m.sourceLayer=m.layer["source-layer"]),m.state=g});return c}h(MV,"queryRenderedFeatures");function CV(i,e,t,r,n,a,o){let s={},l=a.queryRenderedSymbols(r),u=[];for(let c of Object.keys(l).map(Number))u.push(o[c]);u.sort(X5);for(let c of u){let p=c.featureIndex.lookupSymbolFeatures(l[c.bucketInstanceId],e,c.bucketIndex,c.sourceLayerIndex,n.filter,n.layers,n.availableImages,i);for(let d in p){let m=s[d]=s[d]||[],g=p[d];g.sort((_,y)=>{let x=c.featureSortOrder;if(x){let w=x.indexOf(_.featureIndex);return x.indexOf(y.featureIndex)-w}else return y.featureIndex-_.featureIndex});for(let _ of g)m.push(_)}}for(let c in s)s[c].forEach(p=>{let d=p.feature,m=i[c],g=t[m.source].getFeatureState(d.layer["source-layer"],d.id);d.source=d.layer.source,d.layer["source-layer"]&&(d.sourceLayer=d.layer["source-layer"]),d.state=g});return s}h(CV,"queryRenderedSymbols");function EV(i,e){let t=i.getRenderableIds().map(a=>i.getTileByID(a)),r=[],n={};for(let a=0;a<t.length;a++){let o=t[a],s=o.tileID.canonical.key;n[s]||(n[s]=!0,o.querySourceFeatures(r,e))}return r}h(EV,"querySourceFeatures");function X5(i,e){let t=i.tileID,r=e.tileID;return t.overscaledZ-r.overscaledZ||t.canonical.y-r.canonical.y||t.wrap-r.wrap||t.canonical.x-r.canonical.x}h(X5,"sortTilesIn");function TV(i){let e={},t={};for(let r of i){let n=r.queryResults,a=r.wrappedTileID,o=t[a]=t[a]||{};for(let s in n){let l=n[s],u=o[s]=o[s]||{},c=e[s]=e[s]||[];for(let p of l)u[p.featureIndex]||(u[p.featureIndex]=!0,c.push(p))}}return e}h(TV,"mergeRenderedFeatureLayers");R();R();R();R();async function q5(i,e,t){let r=i;if(i.url?r=(await Ux(e.transformRequest(i.url,"Source"),t)).data:await li.frameAsync(t),!r)return null;let n=hg(pt(r,i),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in r&&r.vector_layers&&(n.vectorLayerIds=r.vector_layers.map(a=>a.id)),n}h(q5,"loadTileJson");R();R();R();var Z5=63710088e-1,PV=class xf{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new xf(Bu(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){let t=Math.PI/180,r=this.lat*t,n=e.lat*t,a=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return Z5*Math.acos(Math.min(a,1))}static convert(e){if(e instanceof xf)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new xf(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new xf(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};h(PV,"LngLat");var ei=PV,AV=class cc{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof ei?new ei(e.lng,e.lat):ei.convert(e),this}setSouthWest(e){return this._sw=e instanceof ei?new ei(e.lng,e.lat):ei.convert(e),this}extend(e){let t=this._sw,r=this._ne,n,a;if(e instanceof ei)n=e,a=e;else if(e instanceof cc){if(n=e._sw,a=e._ne,!n||!a)return this}else{if(Array.isArray(e))if(e.length===4||e.every(Array.isArray)){let o=e;return this.extend(cc.convert(o))}else{let o=e;return this.extend(ei.convert(o))}else if(e&&("lng"in e||"lon"in e)&&"lat"in e)return this.extend(ei.convert(e));return this}return!t&&!r?(this._sw=new ei(n.lng,n.lat),this._ne=new ei(a.lng,a.lat)):(t.lng=Math.min(n.lng,t.lng),t.lat=Math.min(n.lat,t.lat),r.lng=Math.max(a.lng,r.lng),r.lat=Math.max(a.lat,r.lat)),this}getCenter(){return new ei((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ei(this.getWest(),this.getNorth())}getSouthEast(){return new ei(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:t,lat:r}=ei.convert(e),n=this._sw.lat<=r&&r<=this._ne.lat,a=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=t&&t>=this._ne.lng),n&&a}static convert(e){return e instanceof cc||!e?e:new cc(e)}static fromLngLat(e,t=0){let r=360*t/40075017,n=r/Math.cos(Math.PI/180*e.lat);return new cc(new ei(e.lng-n,e.lat-r),new ei(e.lng+n,e.lat+r))}};h(AV,"LngLatBounds");var Wl=AV;R();var IV=2*Math.PI*Z5;function Y5(i){return IV*Math.cos(i*Math.PI/180)}h(Y5,"circumferenceAtLatitude");function Wu(i){return(180+i)/360}h(Wu,"mercatorXfromLng");function Xu(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}h(Xu,"mercatorYfromLat");function Nv(i,e){return i/Y5(e)}h(Nv,"mercatorZfromAltitude");function LV(i){return i*360-180}h(LV,"lngFromMercatorX");function $v(i){let e=180-i*360;return 360/Math.PI*Math.atan(Math.exp(e*Math.PI/180))-90}h($v,"latFromMercatorY");function DV(i,e){return i*Y5($v(e))}h(DV,"altitudeFromMercatorZ");function kV(i){return 1/Math.cos(i*Math.PI/180)}h(kV,"mercatorScale");var RV=class FV{constructor(e,t,r=0){this.x=+e,this.y=+t,this.z=+r}static fromLngLat(e,t=0){let r=ei.convert(e);return new FV(Wu(r.lng),Xu(r.lat),Nv(t,r.lat))}toLngLat(){return new ei(LV(this.x),$v(this.y))}toAltitude(){return DV(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/IV*kV($v(this.y))}};h(RV,"MercatorCoordinate");var Qr=RV,OV=class{constructor(e,t,r){this.bounds=Wl.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=r||24}validateBounds(e){return!Array.isArray(e)||e.length!==4?[-180,-90,180,90]:[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]}contains(e){let t=Math.pow(2,e.z),r={minX:Math.floor(Wu(this.bounds.getWest())*t),minY:Math.floor(Xu(this.bounds.getNorth())*t),maxX:Math.ceil(Wu(this.bounds.getEast())*t),maxY:Math.ceil(Xu(this.bounds.getSouth())*t)};return e.x>=r.minX&&e.x<r.maxX&&e.y>=r.minY&&e.y<r.maxY}};h(OV,"TileBounds");var BV=OV,zV=class extends mn{constructor(e,t,r,n){if(super(),this.id=e,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,pt(this,hg(t,["url","scheme","tileSize","promoteId"])),this._options=pt({type:"vector"},t),this._collectResourceTiming=t.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(n)}async load(){this._loaded=!1,this.fire(new Ye("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await q5(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(pt(this,e),e.bounds&&(this.tileBounds=new BV(e.bounds,this.minzoom,this.maxzoom)),this.fire(new Ye("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ye("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new Et(e))}}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return pt({},this._options)}async loadTile(e){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request.collectResourceTiming=this._collectResourceTiming;let n="RT";if(!e.actor||e.state==="expired")e.actor=this.dispatcher.getActor(),n="LT";else if(e.state==="loading")return new Promise((a,o)=>{e.reloadPromise={resolve:a,reject:o}});e.abortController=new AbortController;try{let a=await e.actor.sendAsync({type:n,data:r},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,a)}catch(a){if(delete e.abortController,e.aborted)return;if(a&&a.status!==404)throw a;this._afterTileLoadWorkerResponse(e,null)}}_afterTileLoadWorkerResponse(e,t){if(t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise){let r=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(r.resolve).catch(r.reject)}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&await e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}})}async unloadTile(e){e.unloadVectorData(),e.actor&&await e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}hasTransition(){return!1}};h(zV,"VectorTileSource");var Cde=zV;R();var NV=class extends mn{constructor(e,t,r,n){super(),this.id=e,this.dispatcher=r,this.setEventedParent(n),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=pt({type:"raster"},t),pt(this,hg(t,["url","scheme","tileSize"]))}async load(){this._loaded=!1,this.fire(new Ye("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=await q5(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(pt(this,e),e.bounds&&(this.tileBounds=new BV(e.bounds,this.minzoom,this.maxzoom)),this.fire(new Ye("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ye("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new Et(e))}}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return pt({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}async loadTile(e){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{let r=await Zo.getImage(this.map._requestManager.transformRequest(t,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(r&&r.data){this.map._refreshExpiredTiles&&r.cacheControl&&r.expires&&e.setExpiryData({cacheControl:r.cacheControl,expires:r.expires});let n=this.map.painter.context,a=n.gl,o=r.data;e.texture=this.map.painter.getTileTexture(o.width),e.texture?e.texture.update(o,{useMipmap:!0}):(e.texture=new zr(n,o,a.RGBA,{useMipmap:!0}),e.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.extTextureFilterAnisotropic&&a.texParameterf(a.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax)),e.state="loaded"}}catch(r){if(delete e.abortController,e.aborted)e.state="unloaded";else if(r)throw e.state="errored",r}}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController)}async unloadTile(e){e.texture&&this.map.painter.saveTileTexture(e.texture)}hasTransition(){return!1}};h(NV,"RasterTileSource");var $V=NV;R();R();R();function UV(i,e,t){e=Math.pow(2,t)-e-1;var r=$3(i*256,e*256,t),n=$3((i+1)*256,(e+1)*256,t);return r[0]+","+r[1]+","+n[0]+","+n[1]}h(UV,"getTileBBox");function $3(i,e,t){var r=2*Math.PI*6378137/256/Math.pow(2,t),n=i*r-2*Math.PI*6378137/2,a=e*r-2*Math.PI*6378137/2;return[n,a]}h($3,"getMercCoords");var Ede=kt(gi(),1),VV=class{constructor(e,t,r){if(e<0||e>25||r<0||r>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))throw new Error(`x=${t}, y=${r}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=t,this.y=r,this.key=Ep(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,r){let n=UV(this.x,this.y,this.z),a=GV(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,a).replace(/{bbox-epsg-3857}/g,n)}isChildOf(e){let t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){let t=Math.pow(2,this.z);return new Ede.default((e.x*t-this.x)*8192,(e.y*t-this.y)*8192)}toString(){return`${this.z}/${this.x}/${this.y}`}};h(VV,"CanonicalTileID");var J5=VV,jV=class{constructor(e,t){this.wrap=e,this.canonical=t,this.key=Ep(e,t.z,t.z,t.x,t.y)}};h(jV,"UnwrappedTileID");var U3=jV,HV=class ao{constructor(e,t,r,n,a){if(e<r)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${r}`);this.overscaledZ=e,this.wrap=t,this.canonical=new J5(r,+n,+a),this.key=Ep(t,e,r,n,a)}clone(){return new ao(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let t=this.canonical.z-e;return e>this.canonical.z?new ao(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ao(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);let r=this.canonical.z-e;return e>this.canonical.z?Ep(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Ep(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}isChildOf(e){if(e.wrap!==this.wrap)return!1;let t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new ao(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let t=this.canonical.z+1,r=this.canonical.x*2,n=this.canonical.y*2;return[new ao(t,this.wrap,t,r,n),new ao(t,this.wrap,t,r+1,n),new ao(t,this.wrap,t,r,n+1),new ao(t,this.wrap,t,r+1,n+1)]}isLessThan(e){return this.wrap<e.wrap?!0:this.wrap>e.wrap?!1:this.overscaledZ<e.overscaledZ?!0:this.overscaledZ>e.overscaledZ?!1:this.canonical.x<e.canonical.x?!0:this.canonical.x>e.canonical.x?!1:this.canonical.y<e.canonical.y}wrapped(){return new ao(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ao(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new U3(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Qr(e.x-this.wrap,e.y))}};h(HV,"OverscaledTileID");var ha=HV;function Ep(i,e,t,r,n){i*=2,i<0&&(i=i*-1-1);let a=1<<t;return(a*a*i+a*n+r).toString(36)+t.toString(36)+e.toString(36)}h(Ep,"calculateKey");function GV(i,e,t){let r="",n;for(let a=i;a>0;a--)n=1<<a-1,r+=(e&n?1:0)+(t&n?2:0);return r}h(GV,"getQuadkey");ut("CanonicalTileID",J5);ut("OverscaledTileID",ha,{omit:["posMatrix"]});R();var WV=class{constructor(e,t,r,n=1,a=1,o=1,s=0){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&!["mapbox","terrarium","custom"].includes(r)){dn(`"${r}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);return}this.stride=t.height;let l=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),r){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=n,this.greenFactor=a,this.blueFactor=o,this.baseShift=s;break;case"mapbox":default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4;break}for(let u=0;u<l;u++)this.data[this._idx(-1,u)]=this.data[this._idx(0,u)],this.data[this._idx(l,u)]=this.data[this._idx(l-1,u)],this.data[this._idx(u,-1)]=this.data[this._idx(u,0)],this.data[this._idx(u,l)]=this.data[this._idx(u,l-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(l,-1)]=this.data[this._idx(l-1,0)],this.data[this._idx(-1,l)]=this.data[this._idx(0,l-1)],this.data[this._idx(l,l)]=this.data[this._idx(l-1,l-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let u=0;u<l;u++)for(let c=0;c<l;c++){let p=this.get(u,c);p>this.max&&(this.max=p),p<this.min&&(this.min=p)}}get(e,t){let r=new Uint8Array(this.data.buffer),n=this._idx(e,t)*4;return this.unpack(r[n],r[n+1],r[n+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,r){return e*this.redFactor+t*this.greenFactor+r*this.blueFactor-this.baseShift}getPixels(){return new rr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,a=t*this.dim+this.dim,o=r*this.dim,s=r*this.dim+this.dim;switch(t){case-1:n=a-1;break;case 1:a=n+1;break}switch(r){case-1:o=s-1;break;case 1:s=o+1;break}let l=-t*this.dim,u=-r*this.dim;for(let c=o;c<s;c++)for(let p=n;p<a;p++)this.data[this._idx(p,c)]=e.data[this._idx(p+l,c+u)]}};h(WV,"DEMData");var Tde=WV;ut("DEMData",Tde);var XV=class extends $V{constructor(e,t,r,n){super(e,t,r,n),this.type="raster-dem",this.maxzoom=22,this._options=pt({type:"raster-dem"},t),this.encoding=t.encoding||"mapbox",this.redFactor=t.redFactor,this.greenFactor=t.greenFactor,this.blueFactor=t.blueFactor,this.baseShift=t.baseShift}async loadTile(e){let t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(t,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let n=await Zo.getImage(r,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted){e.state="unloaded";return}if(n&&n.data){let a=n.data;this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});let o=qo(a)&&RE()?a:await this.readImageNow(a),s={type:this.type,uid:e.uid,source:this.id,rawImageData:o,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();let l=await e.actor.sendAsync({type:"LDT",data:s});e.dem=l,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(n){if(delete e.abortController,e.aborted)e.state="unloaded";else if(n)throw e.state="errored",n}}async readImageNow(e){if(typeof VideoFrame<"u"&&mD()){let t=e.width+2,r=e.height+2;try{return new rr({width:t,height:r},await TD(e,-1,-1,t,r))}catch{}}return li.getImageData(e,1)}_getNeighboringTiles(e){let t=e.canonical,r=Math.pow(2,t.z),n=(t.x-1+r)%r,a=t.x===0?e.wrap-1:e.wrap,o=(t.x+1+r)%r,s=t.x+1===r?e.wrap+1:e.wrap,l={};return l[new ha(e.overscaledZ,a,t.z,n,t.y).key]={backfilled:!1},l[new ha(e.overscaledZ,s,t.z,o,t.y).key]={backfilled:!1},t.y>0&&(l[new ha(e.overscaledZ,a,t.z,n,t.y-1).key]={backfilled:!1},l[new ha(e.overscaledZ,e.wrap,t.z,t.x,t.y-1).key]={backfilled:!1},l[new ha(e.overscaledZ,s,t.z,o,t.y-1).key]={backfilled:!1}),t.y+1<r&&(l[new ha(e.overscaledZ,a,t.z,n,t.y+1).key]={backfilled:!1},l[new ha(e.overscaledZ,e.wrap,t.z,t.x,t.y+1).key]={backfilled:!1},l[new ha(e.overscaledZ,s,t.z,o,t.y+1).key]={backfilled:!1}),l}async unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&await e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}})}};h(XV,"RasterDEMTileSource");var Pde=XV;R();var qV=class extends mn{constructor(e,t,r,n){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(n),this._data=t.data,this._options=pt({},t),this._collectResourceTiming=t.collectResourceTiming,t.maxzoom!==void 0&&(this.maxzoom=t.maxzoom),t.type&&(this.type=t.type),t.attribution&&(this.attribution=t.attribution),this.promoteId=t.promoteId;let a=8192/this.tileSize;this.workerOptions=pt({source:this.id,cluster:t.cluster||!1,geojsonVtOptions:{buffer:(t.buffer!==void 0?t.buffer:128)*a,tolerance:(t.tolerance!==void 0?t.tolerance:.375)*a,extent:8192,maxZoom:this.maxzoom,lineMetrics:t.lineMetrics||!1,generateId:t.generateId||!1},superclusterOptions:{maxZoom:t.clusterMaxZoom!==void 0?t.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,t.clusterMinPoints||2),extent:8192,radius:(t.clusterRadius||50)*a,log:!1,generateId:t.generateId||!1},clusterProperties:t.clusterProperties,filter:t.filter},t.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}async load(){await this._updateWorkerData()}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,r){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:r}})}async _updateWorkerData(e){let t=pt({type:this.type},this.workerOptions);e?t.dataDiff=e:typeof this._data=="string"?(t.request=this.map._requestManager.transformRequest(li.resolveURL(this._data),"Source"),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new Ye("dataloading",{dataType:"source"}));try{let r=await this.actor.sendAsync({type:"LD",data:t});if(this._pendingLoads--,this._removed||r.abandoned){this.fire(new Ye("dataabort",{dataType:"source"}));return}let n=null;r.resourceTiming&&r.resourceTiming[this.id]&&(n=r.resourceTiming[this.id].slice(0));let a={dataType:"source"};this._collectResourceTiming&&n&&n.length>0&&pt(a,{resourceTiming:n}),this.fire(new Ye("data",{...a,sourceDataType:"metadata"})),this.fire(new Ye("data",{...a,sourceDataType:"content"}))}catch(r){if(this._pendingLoads--,this._removed){this.fire(new Ye("dataabort",{dataType:"source"}));return}this.fire(new Et(r))}}loaded(){return this._pendingLoads===0}async loadTile(e){let t=e.actor?"RT":"LT";e.actor=this.actor;let r={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;let n=await this.actor.sendAsync({type:t,data:r},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(n,this.map.painter,t==="RT")}async abortTile(e){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0}async unloadTile(e){e.unloadVectorData(),await this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return pt({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}};h(qV,"GeoJSONSource");var Ade=qV;R();R();R();var y_=Yi([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),ZV=class extends mn{constructor(e,t,r,n){super(),this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t}async load(e){this._loaded=!1,this.fire(new Ye("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let t=await Zo.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,t&&t.data&&(this.image=t.data,e&&(this.coordinates=e),this._finishLoading())}catch(t){this._request=null,this._loaded=!0,this.fire(new Et(t))}}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ye("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;let t=e.map(Qr.fromLngLat);this.tileID=YV(t),this.minzoom=this.maxzoom=this.tileID.z;let r=t.map(n=>this.tileID.getTilePoint(n)._round());return this._boundsArray=new eB,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,8192,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,8192),this._boundsArray.emplaceBack(r[2].x,r[2].y,8192,8192),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new Ye("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let e=this.map.painter.context,t=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,y_.members)),this.boundsSegments||(this.boundsSegments=fr.simpleSegment(0,0,4,2)),this.texture||(this.texture=new zr(e,this.image,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE));let r=!1;for(let n in this.tiles){let a=this.tiles[n];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,r=!0)}r&&this.fire(new Ye("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}async loadTile(e){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}};h(ZV,"ImageSource");var Wm=ZV;function YV(i){let e=1/0,t=1/0,r=-1/0,n=-1/0;for(let c of i)e=Math.min(e,c.x),t=Math.min(t,c.y),r=Math.max(r,c.x),n=Math.max(n,c.y);let a=r-e,o=n-t,s=Math.max(a,o),l=Math.max(0,Math.floor(-Math.log(s)/Math.LN2)),u=Math.pow(2,l);return new J5(l,Math.floor((e+r)/2*u),Math.floor((t+n)/2*u))}h(YV,"getCoordinatesCenterTileID");var JV=class extends Wm{constructor(e,t,r,n){super(e,t,r,n),this.roundZoom=!0,this.type="video",this.options=t}async load(){this._loaded=!1;let e=this.options;this.urls=[];for(let t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{let t=await kue(this.urls);if(this._loaded=!0,!t)return;this.video=t,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(t){this.fire(new Et(t))}}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let t=this.video.seekable;e<t.start(0)||e>t.end(0)?this.fire(new Et(new Qe(`sources.${this.id}`,null,`Playback for this video can be set only between the ${t.start(0)} and ${t.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let e=this.map.painter.context,t=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,y_.members)),this.boundsSegments||(this.boundsSegments=fr.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE),t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,this.video)):(this.texture=new zr(e,this.video,t.RGBA),this.texture.bind(t.LINEAR,t.CLAMP_TO_EDGE));let r=!1;for(let n in this.tiles){let a=this.tiles[n];a.state!=="loaded"&&(a.state="loaded",a.texture=this.texture,r=!0)}r&&this.fire(new Ye("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}};h(JV,"VideoSource");var Ide=JV;R();var KV=class extends Wm{constructor(e,t,r,n){super(e,t,r,n),t.coordinates?(!Array.isArray(t.coordinates)||t.coordinates.length!==4||t.coordinates.some(a=>!Array.isArray(a)||a.length!==2||a.some(o=>typeof o!="number")))&&this.fire(new Et(new Qe(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new Et(new Qe(`sources.${e}`,null,'missing required property "coordinates"'))),t.animate&&typeof t.animate!="boolean"&&this.fire(new Et(new Qe(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),t.canvas?typeof t.canvas!="string"&&!(t.canvas instanceof HTMLCanvasElement)&&this.fire(new Et(new Qe(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new Et(new Qe(`sources.${e}`,null,'missing required property "canvas"'))),this.options=t,this.animate=t.animate!==void 0?t.animate:!0}async load(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new Et(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let t=this.map.painter.context,r=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,y_.members)),this.boundsSegments||(this.boundsSegments=fr.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new zr(t,this.canvas,r.RGBA,{premultiply:!0});let n=!1;for(let a in this.tiles){let o=this.tiles[a];o.state!=="loaded"&&(o.state="loaded",o.texture=this.texture,n=!0)}n&&this.fire(new Ye("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}};h(KV,"CanvasSource");var Lde=KV,QV={},Dde=h((i,e,t,r)=>{let n=ej(e.type),a=new n(i,e,t,r);if(a.id!==i)throw new Error(`Expected Source id to be ${i} instead of ${a.id}`);return a},"create"),ej=h(i=>{switch(i){case"geojson":return Ade;case"image":return Wm;case"raster":return $V;case"raster-dem":return Pde;case"vector":return Cde;case"video":return Ide;case"canvas":return Lde}return QV[i]},"getSourceType"),kde=h((i,e)=>{QV[i]=e},"setSourceType"),S4e=h(async(i,e)=>{if(ej(i))throw new Error(`A source type called "${i}" already exists.`);kde(i,e)},"addSourceType");R();R();function tj(i,e){let t={};if(!e)return t;for(let r of i){let n=r.layerIds.map(a=>e.getLayer(a)).filter(Boolean);if(n.length!==0){r.layers=n,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map(a=>n.filter(o=>o.id===a)[0]));for(let a of n)t[a.id]=r}}return t}h(tj,"deserialize");R();R();var ij=class{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){let r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}};h(ij,"DictionaryCoder");var Rde=ij,Fde=kt(Bx(),1),Ode=kt(dD(),1);R();var rj=class{constructor(e,t,r,n,a){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=n,this.properties=e.properties,this.id=a}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){let e={geometry:this.geometry};for(let t in this)t==="_geometry"||t==="_vectorTileFeature"||(e[t]=this[t]);return e}};h(rj,"GeoJSONFeature");var nj=rj,aj=class{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new v3(8192,16,0),this.grid3D=new v3(8192,16,0),this.featureIndexArray=new YO,this.promoteId=t}insert(e,t,r,n,a,o){let s=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,a);let l=o?this.grid3D:this.grid;for(let u=0;u<t.length;u++){let c=t[u],p=[1/0,1/0,-1/0,-1/0];for(let d=0;d<c.length;d++){let m=c[d];p[0]=Math.min(p[0],m.x),p[1]=Math.min(p[1],m.y),p[2]=Math.max(p[2],m.x),p[3]=Math.max(p[3],m.y)}p[0]<8192&&p[1]<8192&&p[2]>=0&&p[3]>=0&&l.insert(s,p[0],p[1],p[2],p[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Fde.default.VectorTile(new Ode.default(this.rawTileData)).layers,this.sourceLayerCoder=new Rde(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,r,n){this.loadVTLayers();let a=e.params||{},o=8192/e.tileSize/e.scale,s=Rv(a.filter),l=e.queryGeometry,u=e.queryPadding*o,c=j3(l),p=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),d=j3(e.cameraQueryGeometry),m=this.grid3D.query(d.minX-u,d.minY-u,d.maxX+u,d.maxY+u,(y,x,w,b)=>GB(e.cameraQueryGeometry,y-u,x-u,w+u,b+u));for(let y of m)p.push(y);p.sort(oj);let g={},_;for(let y=0;y<p.length;y++){let x=p[y];if(x===_)continue;_=x;let w=this.featureIndexArray.get(x),b=null;this.loadMatchingFeature(g,w.bucketIndex,w.sourceLayerIndex,w.featureIndex,s,a.layers,a.availableImages,t,r,n,(C,E,T)=>(b||(b=Ql(C)),E.queryIntersectsFeature(l,C,T,b,this.z,e.transform,o,e.pixelPosMatrix)))}return g}loadMatchingFeature(e,t,r,n,a,o,s,l,u,c,p){let d=this.bucketLayerIDs[t];if(o&&!_D(o,d))return;let m=this.sourceLayerCoder.decode(r),g=this.vtLayers[m].feature(n);if(a.needGeometry){let y=eu(g,!0);if(!a.filter(new Dr(this.tileID.overscaledZ),y,this.tileID.canonical))return}else if(!a.filter(new Dr(this.tileID.overscaledZ),g))return;let _=this.getId(g,m);for(let y=0;y<d.length;y++){let x=d[y];if(o&&o.indexOf(x)<0)continue;let w=l[x];if(!w)continue;let b={};_&&c&&(b=c.getState(w.sourceLayer||"_geojsonTileLayer",_));let C=pt({},u[x]);C.paint=V3(C.paint,w.paint,g,b,s),C.layout=V3(C.layout,w.layout,g,b,s);let E=!p||p(g,w,b);if(!E)continue;let T=new nj(g,this.z,this.x,this.y,_);T.layer=C;let L=e[x];L===void 0&&(L=e[x]=[]),L.push({featureIndex:n,feature:T,intersectionZ:E})}}lookupSymbolFeatures(e,t,r,n,a,o,s,l){let u={};this.loadVTLayers();let c=Rv(a);for(let p of e)this.loadMatchingFeature(u,r,n,p,c,o,s,l,t);return u}hasLayer(e){for(let t of this.bucketLayerIDs)for(let r of t)if(e===r)return!0;return!1}getId(e,t){let r=e.id;if(this.promoteId){let n=typeof this.promoteId=="string"?this.promoteId:this.promoteId[t];r=e.properties[n],typeof r=="boolean"&&(r=Number(r))}return r}};h(aj,"FeatureIndex");var Bde=aj;ut("FeatureIndex",Bde,{omit:["rawTileData","sourceLayerCoder"]});function V3(i,e,t,r,n){return Nx(i,(a,o)=>{let s=e instanceof n_?e.get(o):null;return s&&s.evaluate?s.evaluate(t,r,n):s})}h(V3,"evaluateProperties");function j3(i){let e=1/0,t=1/0,r=-1/0,n=-1/0;for(let a of i)e=Math.min(e,a.x),t=Math.min(t,a.y),r=Math.max(r,a.x),n=Math.max(n,a.y);return{minX:e,minY:t,maxX:r,maxY:n}}h(j3,"getBounds");function oj(i,e){return e-i}h(oj,"topDownFeatureComparator");R();R();var H3="RTLPluginLoaded",sj=class extends mn{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=W5()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(t=>{throw this.status="error",t})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}async setRTLTextPlugin(e,t=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=li.resolveURL(e),!this.url)throw new Error(`requested url ${e} is invalid`);if(this.status==="unavailable")if(t)this.status="deferred",this._syncState(this.status);else return this._requestImport();else if(this.status==="requested")return this._requestImport()}async _requestImport(){await this._syncState("loading"),this.status="loaded",this.fire(new Ye(H3))}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}};h(sj,"RTLMainThreadPlugin");var zde=sj,k2=null;function Kp(){return k2||(k2=new zde),k2}h(Kp,"rtlMainThreadPluginFactory");var Nde=3e4,lj=class{constructor(e,t){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=FE(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let t=e+this.timeAdded;t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!e){this.collisionBoxArray=new IO;return}e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=tj(e.buckets,t.style),this.hasSymbolBuckets=!1;for(let n in this.buckets){let a=this.buckets[n];if(a instanceof Jp)if(this.hasSymbolBuckets=!0,r)a.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let n in this.buckets){let a=this.buckets[n];if(a instanceof Jp&&a.hasRTLText){this.hasRTLText=!0,Kp().lazyLoad();break}}this.queryPadding=0;for(let n in this.buckets){let a=this.buckets[n];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(n).queryRadius(a))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let r in this.buckets){let n=this.buckets[r];n.uploadPending()&&n.upload(e)}let t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new zr(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new zr(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,r,n,a,o,s,l,u,c){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:n,cameraQueryGeometry:a,scale:o,tileSize:this.tileSize,pixelPosMatrix:c,transform:l,params:s,queryPadding:this.queryPadding*u},e,t,r)}querySourceFeatures(e,t){let r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;let n=r.loadVTLayers(),a=t&&t.sourceLayer?t.sourceLayer:"",o=n._geojsonTileLayer||n[a];if(!o)return;let s=Rv(t&&t.filter),{z:l,x:u,y:c}=this.tileID.canonical,p={z:l,x:u,y:c};for(let d=0;d<o.length;d++){let m=o.feature(d);if(s.needGeometry){let y=eu(m,!0);if(!s.filter(new Dr(this.tileID.overscaledZ),y,this.tileID.canonical))continue}else if(!s.filter(new Dr(this.tileID.overscaledZ),m))continue;let g=r.getId(m,a),_=new nj(m,l,u,c,g);_.tile=p,e.push(_)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let t=this.expirationTime;if(e.cacheControl){let r=MD(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+r["max-age"]*1e3)}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let r=Date.now(),n=!1;if(this.expirationTime>r)n=!1;else if(!t)n=!0;else if(this.expirationTime<t)n=!0;else{let a=this.expirationTime-t;a?this.expirationTime=r+Math.max(a,Nde):n=!0}n?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;let r=this.latestFeatureIndex.loadVTLayers();for(let n in this.buckets){if(!t.style.hasLayer(n))continue;let a=this.buckets[n],o=a.layers[0].sourceLayer||"_geojsonTileLayer",s=r[o],l=e[o];if(!s||!l||Object.keys(l).length===0)continue;a.update(l,s,this.imageAtlas&&this.imageAtlas.patternPositions||{});let u=t&&t.style&&t.style.getLayer(n);u&&(this.queryPadding=Math.max(this.queryPadding,u.queryRadius(a)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<li.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=li.now()+e}setDependencies(e,t){let r={};for(let n of t)r[n]=!0;this.dependencies[e]=r}hasDependency(e,t){for(let r of e){let n=this.dependencies[r];if(n){for(let a of t)if(n[a])return!0}}return!1}};h(lj,"Tile");var uj=lj;R();var hj=class{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(let e in this.data)for(let t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,r){let n=e.wrapped().key;this.data[n]===void 0&&(this.data[n]=[]);let a={value:t,timeout:void 0};if(r!==void 0&&(a.timeout=setTimeout(()=>{this.remove(e,a)},r)),this.data[n].push(a),this.order.push(n),this.order.length>this.max){let o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){let t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;let r=e.wrapped().key,n=t===void 0?0:this.data[r].indexOf(t),a=this.data[r][n];return this.data[r].splice(n,1),a.timeout&&clearTimeout(a.timeout),this.data[r].length===0&&delete this.data[r],this.onRemove(a.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let t=this._getAndRemoveByKey(this.order[0]);t&&this.onRemove(t)}return this}filter(e){let t=[];for(let r in this.data)for(let n of this.data[r])e(n.value)||t.push(n);for(let r of t)this.remove(r.value.tileID,r)}};h(hj,"TileCache");var $de=hj,T6=kt(gi(),1);R();var cj=class{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,t,r){let n=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},pt(this.stateChanges[e][n],r),this.deletedStates[e]===null){this.deletedStates[e]={};for(let a in this.state[e])a!==n&&(this.deletedStates[e][a]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][n]===null){this.deletedStates[e][n]={};for(let a in this.state[e][n])r[a]||(this.deletedStates[e][n][a]=null)}else for(let a in r)this.deletedStates[e]&&this.deletedStates[e][n]&&this.deletedStates[e][n][a]===null&&delete this.deletedStates[e][n][a]}removeFeatureState(e,t,r){if(this.deletedStates[e]===null)return;let n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][n]!==null&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][n]){this.deletedStates[e][n]={};for(r in this.stateChanges[e][n])this.deletedStates[e][n][r]=null}else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,t){let r=String(t),n=this.state[e]||{},a=this.stateChanges[e]||{},o=pt({},n[r],a[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let s=this.deletedStates[e][t];if(s===null)return{};for(let l in s)delete o[l]}return o}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,t){let r={};for(let n in this.stateChanges){this.state[n]=this.state[n]||{};let a={};for(let o in this.stateChanges[n])this.state[n][o]||(this.state[n][o]={}),pt(this.state[n][o],this.stateChanges[n][o]),a[o]=this.state[n][o];r[n]=a}for(let n in this.deletedStates){this.state[n]=this.state[n]||{};let a={};if(this.deletedStates[n]===null)for(let o in this.state[n])a[o]={},this.state[n][o]={};else for(let o in this.deletedStates[n]){if(this.deletedStates[n][o]===null)this.state[n][o]={};else for(let s of Object.keys(this.deletedStates[n][o]))delete this.state[n][o][s];a[o]=this.state[n][o]}r[n]=r[n]||{},pt(r[n],a)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(let n in e)e[n].setFeatureState(r,t)}};h(cj,"SourceFeatureState");var Ude=cj,pj=class _f extends mn{constructor(e,t,r){super(),this.id=e,this.dispatcher=r,this.on("data",n=>this._dataHandler(n)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=Dde(e,t,r,this),this._tiles={},this._cache=new $de(0,n=>this._unloadTile(n)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ude,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if((this.used!==void 0||this.usedForTerrain!==void 0)&&!this.used&&!this.usedForTerrain)return!0;if(!this._updated)return!1;for(let e in this._tiles){let t=this._tiles[e];if(t.state!=="loaded"&&t.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}async _loadTile(e,t,r){try{await this._source.loadTile(e),this._tileLoaded(e,t,r)}catch(n){e.state="errored",n.status!==404?this._source.fire(new Et(n,{tile:e})):this.update(this.transform,this.terrain)}}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new Ye("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let t in this._tiles){let r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(G3).map(e=>e.key)}getRenderableIds(e){let t=[];for(let r in this._tiles)this._isIdRenderable(r,e)&&t.push(this._tiles[r]);return e?t.sort((r,n)=>{let a=r.tileID,o=n.tileID,s=new T6.default(a.canonical.x,a.canonical.y)._rotate(this.transform.angle),l=new T6.default(o.canonical.x,o.canonical.y)._rotate(this.transform.angle);return a.overscaledZ-o.overscaledZ||l.y-s.y||l.x-s.x}).map(r=>r.tileID.key):t.map(r=>r.tileID).sort(G3).map(r=>r.key)}hasRenderableParent(e){let t=this.findLoadedParent(e,0);return t?this._isIdRenderable(t.tileID.key):!1}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(let e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}async _reloadTile(e,t){let r=this._tiles[e];r&&(r.state!=="loading"&&(r.state=t),await this._loadTile(r,e,t))}_tileLoaded(e,t,r){e.timeAdded=li.now(),r==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new Ye("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let t=this.getRenderableIds();for(let n=0;n<t.length;n++){let a=t[n];if(e.neighboringTiles&&e.neighboringTiles[a]){let o=this.getTileByID(a);r(e,o),r(o,e)}}function r(n,a){n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0;let o=a.tileID.canonical.x-n.tileID.canonical.x,s=a.tileID.canonical.y-n.tileID.canonical.y,l=Math.pow(2,n.tileID.canonical.z),u=a.tileID.key;o===0&&s===0||Math.abs(s)>1||(Math.abs(o)>1&&(Math.abs(o+l)===1?o+=l:Math.abs(o-l)===1&&(o-=l)),!(!a.dem||!n.dem)&&(n.dem.backfillBorder(a.dem,o,s),n.neighboringTiles&&n.neighboringTiles[u]&&(n.neighboringTiles[u].backfilled=!0)))}h(r,"fillBorder")}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,r,n){for(let a in this._tiles){let o=this._tiles[a];if(n[a]||!o.hasData()||o.tileID.overscaledZ<=t||o.tileID.overscaledZ>r)continue;let s=o.tileID;for(;o&&o.tileID.overscaledZ>t+1;){let u=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[u.key],o&&o.hasData()&&(s=u)}let l=s;for(;l.overscaledZ>t;)if(l=l.scaledTo(l.overscaledZ-1),e[l.key]){n[s.key]=s;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){let r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(let r=e.overscaledZ-1;r>=t;r--){let n=e.scaledTo(r),a=this._getLoadedTile(n);if(a)return a}}_getLoadedTile(e){let t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let t=Math.ceil(e.width/this._source.tileSize)+1,r=Math.ceil(e.height/this._source.tileSize)+1,n=t*r,a=this._maxTileCacheZoomLevels===null?Co.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels,o=Math.floor(n*a),s=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(s)}handleWrapJump(e){let t=this._prevLng===void 0?e:this._prevLng,r=(e-t)/360,n=Math.round(r);if(this._prevLng=e,n){let a={};for(let o in this._tiles){let s=this._tiles[o];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+n),a[s.tileID.key]=s}this._tiles=a;for(let o in this._timers)clearTimeout(this._timers[o]),delete this._timers[o];for(let o in this._tiles){let s=this._tiles[o];this._setTileReloadTimer(o,s)}}}update(e,t){if(!this._sourceLoaded||this._paused)return;this.transform=e,this.terrain=t,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};let r;!this.used&&!this.usedForTerrain?r=[]:this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(c=>new ha(c.canonical.z,c.wrap,c.canonical.z,c.canonical.x,c.canonical.y)):(r=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this.usedForTerrain?!1:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:t}),this._source.hasTile&&(r=r.filter(c=>this._source.hasTile(c))));let n=e.coveringZoomLevel(this._source),a=Math.max(n-_f.maxOverzooming,this._source.minzoom),o=Math.max(n+_f.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let c={};for(let p of r)if(p.canonical.z>this._source.minzoom){let d=p.scaledTo(p.canonical.z-1);c[d.key]=d;let m=p.scaledTo(Math.max(this._source.minzoom,Math.min(p.canonical.z,5)));c[m.key]=m}r=r.concat(Object.values(c))}let s=r.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new Ye("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let l=this._updateRetainedTiles(r,n);if(W3(this._source.type)){let c={},p={},d=Object.keys(l),m=li.now();for(let g of d){let _=l[g],y=this._tiles[g];if(!y||y.fadeEndTime!==0&&y.fadeEndTime<=m)continue;let x=this.findLoadedParent(_,a);x&&(this._addTile(x.tileID),c[x.tileID.key]=x.tileID),p[g]=_}this._retainLoadedChildren(p,n,o,l);for(let g in c)l[g]||(this._coveredTiles[g]=!0,l[g]=c[g]);if(t){let g={},_={};for(let y of r)this._tiles[y.key].hasData()?g[y.key]=y:_[y.key]=y;for(let y in _){let x=_[y].children(this._source.maxzoom);this._tiles[x[0].key]&&this._tiles[x[1].key]&&this._tiles[x[2].key]&&this._tiles[x[3].key]&&(g[x[0].key]=l[x[0].key]=x[0],g[x[1].key]=l[x[1].key]=x[1],g[x[2].key]=l[x[2].key]=x[2],g[x[3].key]=l[x[3].key]=x[3],delete _[y])}for(let y in _){let x=this.findLoadedParent(_[y],this._source.minzoom);if(x){g[x.tileID.key]=l[x.tileID.key]=x.tileID;for(let w in g)g[w].isChildOf(x.tileID)&&delete g[w]}}for(let y in this._tiles)g[y]||(this._coveredTiles[y]=!0)}}for(let c in l)this._tiles[c].clearFadeHold();let u=yD(this._tiles,l);for(let c of u){let p=this._tiles[c];p.hasSymbolBuckets&&!p.holdingForFade()?p.setHoldDuration(this.map._fadeDuration):(!p.hasSymbolBuckets||p.symbolFadeFinished())&&this._removeTile(c)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){let r={},n={},a=Math.max(t-_f.maxOverzooming,this._source.minzoom),o=Math.max(t+_f.maxUnderzooming,this._source.minzoom),s={};for(let l of e){let u=this._addTile(l);r[l.key]=l,!u.hasData()&&t<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,t,o,r);for(let l of e){let u=this._tiles[l.key];if(u.hasData())continue;if(t+1>this._source.maxzoom){let p=l.children(this._source.maxzoom)[0],d=this.getTile(p);if(d&&d.hasData()){r[p.key]=p;continue}}else{let p=l.children(this._source.maxzoom);if(r[p[0].key]&&r[p[1].key]&&r[p[2].key]&&r[p[3].key])continue}let c=u.wasRequested();for(let p=l.overscaledZ-1;p>=a;--p){let d=l.scaledTo(p);if(n[d.key])break;if(n[d.key]=!0,u=this.getTile(d),!u&&c&&(u=this._addTile(d)),u){let m=u.hasData();if((c||m)&&(r[d.key]=d),c=u.wasRequested(),m)break}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let t=[],r,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){r=this._loadedParentTiles[n.key];break}t.push(n.key);let a=n.scaledTo(n.overscaledZ-1);if(r=this._getLoadedTile(a),r)break;n=a}for(let a of t)this._loadedParentTiles[a]=r}}_addTile(e){let t=this._tiles[e.key];if(t)return t;t=this._cache.getAndRemove(e),t&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));let r=t;return t||(t=new uj(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(t,e.key,t.state)),t.uses++,this._tiles[e.key]=t,r||this._source.fire(new Ye("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},r))}_removeTile(e){let t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),!(t.uses>0)&&(t.hasData()&&t.state!=="reloading"?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}_dataHandler(e){let t=e.sourceDataType;e.dataType==="source"&&t==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&t==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,t,r){let n=[],a=this.transform;if(!a)return n;let o=r?a.getCameraQueryGeometry(e):e,s=e.map(g=>a.pointCoordinate(g,this.terrain)),l=o.map(g=>a.pointCoordinate(g,this.terrain)),u=this.getIds(),c=1/0,p=1/0,d=-1/0,m=-1/0;for(let g of l)c=Math.min(c,g.x),p=Math.min(p,g.y),d=Math.max(d,g.x),m=Math.max(m,g.y);for(let g=0;g<u.length;g++){let _=this._tiles[u[g]];if(_.holdingForFade())continue;let y=_.tileID,x=Math.pow(2,a.zoom-_.tileID.overscaledZ),w=t*_.queryPadding*8192/_.tileSize/x,b=[y.getTilePoint(new Qr(c,p)),y.getTilePoint(new Qr(d,m))];if(b[0].x-w<8192&&b[0].y-w<8192&&b[1].x+w>=0&&b[1].y+w>=0){let C=s.map(T=>y.getTilePoint(T)),E=l.map(T=>y.getTilePoint(T));n.push({tile:_,tileID:y,queryGeometry:C,cameraQueryGeometry:E,scale:x})}}return n}getVisibleCoordinates(e){let t=this.getRenderableIds(e).map(r=>this._tiles[r].tileID);for(let r of t)r.posMatrix=this.transform.calculatePosMatrix(r.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(W3(this._source.type)){let e=li.now();for(let t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setFeatureState(e,t,r){e=e||"_geojsonTileLayer",this._state.updateState(e,t,r)}removeFeatureState(e,t,r){e=e||"_geojsonTileLayer",this._state.removeFeatureState(e,t,r)}getFeatureState(e,t){return e=e||"_geojsonTileLayer",this._state.getState(e,t)}setDependencies(e,t,r){let n=this._tiles[e];n&&n.setDependencies(t,r)}reloadTilesForDependencies(e,t){for(let r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(r,"reloading");this._cache.filter(r=>!r.hasDependency(e,t))}};h(pj,"SourceCache");var Xm=pj;Xm.maxOverzooming=10;Xm.maxUnderzooming=3;function G3(i,e){let t=Math.abs(i.wrap*2)-+(i.wrap<0),r=Math.abs(e.wrap*2)-+(e.wrap<0);return i.overscaledZ-e.overscaledZ||r-t||e.canonical.y-i.canonical.y||e.canonical.x-i.canonical.x}h(G3,"compareTileId");function W3(i){return i==="raster"||i==="image"||i==="video"}h(W3,"isRasterType");R();R();R();var os=kt(gi(),1);R();var Zs=kt(gi(),1);function dj(i,e,t,r,n){let a=[];for(let o=0;o<i.length;o++){let s=i[o],l;for(let u=0;u<s.length-1;u++){let c=s[u],p=s[u+1];c.x<e&&p.x<e||(c.x<e?c=new Zs.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round():p.x<e&&(p=new Zs.default(e,c.y+(p.y-c.y)*((e-c.x)/(p.x-c.x)))._round()),!(c.y<t&&p.y<t)&&(c.y<t?c=new Zs.default(c.x+(p.x-c.x)*((t-c.y)/(p.y-c.y)),t)._round():p.y<t&&(p=new Zs.default(c.x+(p.x-c.x)*((t-c.y)/(p.y-c.y)),t)._round()),!(c.x>=r&&p.x>=r)&&(c.x>=r?c=new Zs.default(r,c.y+(p.y-c.y)*((r-c.x)/(p.x-c.x)))._round():p.x>=r&&(p=new Zs.default(r,c.y+(p.y-c.y)*((r-c.x)/(p.x-c.x)))._round()),!(c.y>=n&&p.y>=n)&&(c.y>=n?c=new Zs.default(c.x+(p.x-c.x)*((n-c.y)/(p.y-c.y)),n)._round():p.y>=n&&(p=new Zs.default(c.x+(p.x-c.x)*((n-c.y)/(p.y-c.y)),n)._round()),(!l||!c.equals(l[l.length-1]))&&(l=[c],a.push(l)),l.push(p)))))}}return a}h(dj,"clipLine");R();var fj=class{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,this.length*.5),this.paddedLength=this.length-this.padding*2}lerp(e){if(this.points.length===1)return this.points[0];e=Lr(e,0,1);let t=1,r=this._distances[t],n=e*this.paddedLength+this.padding;for(;r<n&&t<this._distances.length;)r=this._distances[++t];let a=t-1,o=this._distances[a],s=r-o,l=s>0?(n-o)/s:0;return this.points[a].mult(1-l).add(this.points[t].mult(l))}};h(fj,"PathInterpolator");var Vde=fj;R();function bf(i,e){let t=!0;return i==="always"||(i==="never"||e==="never")&&(t=!1),t}h(bf,"overlapAllowed");var mj=class{constructor(e,t,r){let n=this.boxCells=[],a=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let o=0;o<this.xCellCount*this.yCellCount;o++)n.push([]),a.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,r,n,a){this._forEachCell(t,r,n,a,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(a)}insertCircle(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)}_insertBoxCell(e,t,r,n,a,o){this.boxCells[a].push(o)}_insertCircleCell(e,t,r,n,a,o){this.circleCells[a].push(o)}_query(e,t,r,n,a,o,s){if(r<0||e>this.width||n<0||t>this.height)return[];let l=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(a)return[{key:null,x1:e,y1:t,x2:r,y2:n}];for(let u=0;u<this.boxKeys.length;u++)l.push({key:this.boxKeys[u],x1:this.bboxes[u*4],y1:this.bboxes[u*4+1],x2:this.bboxes[u*4+2],y2:this.bboxes[u*4+3]});for(let u=0;u<this.circleKeys.length;u++){let c=this.circles[u*3],p=this.circles[u*3+1],d=this.circles[u*3+2];l.push({key:this.circleKeys[u],x1:c-d,y1:p-d,x2:c+d,y2:p+d})}}else{let u={hitTest:a,overlapMode:o,seenUids:{box:{},circle:{}}};this._forEachCell(e,t,r,n,this._queryCell,l,u,s)}return l}query(e,t,r,n){return this._query(e,t,r,n,!1,null)}hitTest(e,t,r,n,a,o){return this._query(e,t,r,n,!0,a,o).length>0}hitTestCircle(e,t,r,n,a){let o=e-r,s=e+r,l=t-r,u=t+r;if(s<0||o>this.width||u<0||l>this.height)return!1;let c=[],p={hitTest:!0,overlapMode:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}};return this._forEachCell(o,l,s,u,this._queryCellCircle,c,p,a),c.length>0}_queryCell(e,t,r,n,a,o,s,l){let{seenUids:u,hitTest:c,overlapMode:p}=s,d=this.boxCells[a];if(d!==null){let g=this.bboxes;for(let _ of d)if(!u.box[_]){u.box[_]=!0;let y=_*4,x=this.boxKeys[_];if(e<=g[y+2]&&t<=g[y+3]&&r>=g[y+0]&&n>=g[y+1]&&(!l||l(x))&&(!c||!bf(p,x.overlapMode))&&(o.push({key:x,x1:g[y],y1:g[y+1],x2:g[y+2],y2:g[y+3]}),c))return!0}}let m=this.circleCells[a];if(m!==null){let g=this.circles;for(let _ of m)if(!u.circle[_]){u.circle[_]=!0;let y=_*3,x=this.circleKeys[_];if(this._circleAndRectCollide(g[y],g[y+1],g[y+2],e,t,r,n)&&(!l||l(x))&&(!c||!bf(p,x.overlapMode))){let w=g[y],b=g[y+1],C=g[y+2];if(o.push({key:x,x1:w-C,y1:b-C,x2:w+C,y2:b+C}),c)return!0}}}return!1}_queryCellCircle(e,t,r,n,a,o,s,l){let{circle:u,seenUids:c,overlapMode:p}=s,d=this.boxCells[a];if(d!==null){let g=this.bboxes;for(let _ of d)if(!c.box[_]){c.box[_]=!0;let y=_*4,x=this.boxKeys[_];if(this._circleAndRectCollide(u.x,u.y,u.radius,g[y+0],g[y+1],g[y+2],g[y+3])&&(!l||l(x))&&!bf(p,x.overlapMode))return o.push(!0),!0}}let m=this.circleCells[a];if(m!==null){let g=this.circles;for(let _ of m)if(!c.circle[_]){c.circle[_]=!0;let y=_*3,x=this.circleKeys[_];if(this._circlesCollide(g[y],g[y+1],g[y+2],u.x,u.y,u.radius)&&(!l||l(x))&&!bf(p,x.overlapMode))return o.push(!0),!0}}}_forEachCell(e,t,r,n,a,o,s,l){let u=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),p=this._convertToXCellCoord(r),d=this._convertToYCellCoord(n);for(let m=u;m<=p;m++)for(let g=c;g<=d;g++){let _=this.xCellCount*g+m;if(a.call(this,e,t,r,n,_,o,s,l))return}}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,r,n,a,o){let s=n-e,l=a-t,u=r+o;return u*u>s*s+l*l}_circleAndRectCollide(e,t,r,n,a,o,s){let l=(o-n)/2,u=Math.abs(e-(n+l));if(u>l+r)return!1;let c=(s-a)/2,p=Math.abs(t-(a+c));if(p>c+r)return!1;if(u<=l||p<=c)return!0;let d=u-l,m=p-c;return d*d+m*m<=r*r}};h(mj,"GridIndex");var P6=mj;R();var qm=kt(gi(),1);function v_(i,e,t,r,n){let a=ht.create();return e?(ht.scale(a,a,[1/n,1/n,1]),t||ht.rotateZ(a,a,r.angle)):ht.multiply(a,r.labelPlaneMatrix,i),a}h(v_,"getLabelPlaneMatrix");function K5(i,e,t,r,n){if(e){let a=ht.clone(i);return ht.scale(a,a,[n,n,1]),t||ht.rotateZ(a,a,-r.angle),a}else return r.glCoordMatrix}h(K5,"getGlCoordMatrix");function ma(i,e,t){let r;t?(r=[i.x,i.y,t(i.x,i.y),1],Tn.transformMat4(r,r,e)):(r=[i.x,i.y,0,1],__(r,r,e));let n=r[3];return{point:new qm.default(r[0]/n,r[1]/n),signedDistanceFromCamera:n}}h(ma,"project");function x_(i,e){return .5+.5*(i/e)}h(x_,"getPerspectiveRatio");function gj(i,e){let t=i[0]/i[3],r=i[1]/i[3];return t>=-e[0]&&t<=e[0]&&r>=-e[1]&&r<=e[1]}h(gj,"isVisible");function yj(i,e,t,r,n,a,o,s,l,u){let c=r?i.textSizeData:i.iconSizeData,p=Mg(c,t.transform.zoom),d=[256/t.width*2+1,256/t.height*2+1],m=r?i.text.dynamicLayoutVertexArray:i.icon.dynamicLayoutVertexArray;m.clear();let g=i.lineVertexArray,_=r?i.text.placedSymbolArray:i.icon.placedSymbolArray,y=t.transform.width/t.transform.height,x=!1;for(let w=0;w<_.length;w++){let b=_.get(w);if(b.hidden||b.writingMode===2&&!x){qu(b.numGlyphs,m);continue}x=!1;let C;if(u?(C=[b.anchorX,b.anchorY,u(b.anchorX,b.anchorY),1],Tn.transformMat4(C,C,e)):(C=[b.anchorX,b.anchorY,0,1],__(C,C,e)),!gj(C,d)){qu(b.numGlyphs,m);continue}let E=C[3],T=x_(t.transform.cameraToCenterDistance,E),L=f_(c,p,b),D=o?L/T:L*T,B=new qm.default(b.anchorX,b.anchorY),A=ma(B,n,u).point,k={projections:{},offsets:{}},$=q3(b,D,!1,s,e,n,a,i.glyphOffsetArray,g,m,A,B,k,y,l,u);x=$.useVertical,($.notEnoughRoom||x||$.needsFlipping&&q3(b,D,!0,s,e,n,a,i.glyphOffsetArray,g,m,A,B,k,y,l,u).notEnoughRoom)&&qu(b.numGlyphs,m)}r?i.text.dynamicLayoutVertexBuffer.updateData(m):i.icon.dynamicLayoutVertexBuffer.updateData(m)}h(yj,"updateLineLabels");function Q5(i,e,t,r,n,a,o,s,l,u,c,p,d){let m=s.glyphStartIndex+s.numGlyphs,g=s.lineStartIndex,_=s.lineStartIndex+s.lineLength,y=e.getoffsetX(s.glyphStartIndex),x=e.getoffsetX(m-1),w=Zm(i*y,t,r,n,a,o,s.segment,g,_,l,u,c,p,d);if(!w)return null;let b=Zm(i*x,t,r,n,a,o,s.segment,g,_,l,u,c,p,d);return b?{first:w,last:b}:null}h(Q5,"placeFirstAndLastGlyph");function X3(i,e,t,r){if(i===1){let n=Math.abs(t.y-e.y),a=Math.abs(t.x-e.x)*r;if(n>a)return{useVertical:!0}}return(i===2?e.y<t.y:e.x>t.x)?{needsFlipping:!0}:null}h(X3,"requiresOrientationChange");function q3(i,e,t,r,n,a,o,s,l,u,c,p,d,m,g,_){let y=e/24,x=i.lineOffsetX*y,w=i.lineOffsetY*y,b;if(i.numGlyphs>1){let C=i.glyphStartIndex+i.numGlyphs,E=i.lineStartIndex,T=i.lineStartIndex+i.lineLength,L=Q5(y,s,x,w,t,c,p,i,l,a,d,g,_);if(!L)return{notEnoughRoom:!0};let D=ma(L.first.point,o,_).point,B=ma(L.last.point,o,_).point;if(r&&!t){let A=X3(i.writingMode,D,B,m);if(A)return A}b=[L.first];for(let A=i.glyphStartIndex+1;A<C-1;A++)b.push(Zm(y*s.getoffsetX(A),x,w,t,c,p,i.segment,E,T,l,a,d,g,_));b.push(L.last)}else{if(r&&!t){let E=ma(p,n,_).point,T=i.lineStartIndex+i.segment+1,L=new qm.default(l.getx(T),l.gety(T)),D=ma(L,n,_),B=D.signedDistanceFromCamera>0?D.point:eT(p,L,E,1,n,_),A=X3(i.writingMode,E,B,m);if(A)return A}let C=Zm(y*s.getoffsetX(i.glyphStartIndex),x,w,t,c,p,i.segment,i.lineStartIndex,i.lineStartIndex+i.lineLength,l,a,d,g,_);if(!C)return{notEnoughRoom:!0};b=[C]}for(let C of b)Yp(u,C.point,C.angle);return{}}h(q3,"placeGlyphsAlongLine");function eT(i,e,t,r,n,a){let o=ma(i.add(i.sub(e)._unit()),n,a).point,s=t.sub(o);return t.add(s._mult(r/s.mag()))}h(eT,"projectTruncatedLineSegment");function Uv(i,e){let{projectionCache:t,lineVertexArray:r,labelPlaneMatrix:n,tileAnchorPoint:a,distanceFromAnchor:o,getElevation:s,previousVertex:l,direction:u,absOffsetX:c}=e;if(t.projections[i])return t.projections[i];let p=new qm.default(r.getx(i),r.gety(i)),d=ma(p,n,s);if(d.signedDistanceFromCamera>0)return t.projections[i]=d.point,d.point;let m=i-u,g=o===0?a:new qm.default(r.getx(m),r.gety(m));return eT(g,p,l,c-o+1,n,s)}h(Uv,"projectVertexToViewport");function Vv(i,e,t){return i._unit()._perp()._mult(e*t)}h(Vv,"transformToOffsetNormal");function vj(i,e,t,r,n,a,o,s){let{projectionCache:l,direction:u}=s;if(l.offsets[i])return l.offsets[i];let c=t.add(e);if(i+u<r||i+u>=n)return l.offsets[i]=c,c;let p=Uv(i+u,s),d=Vv(p.sub(t),o,u),m=t.add(d),g=p.add(d);return l.offsets[i]=bD(a,c,m,g)||c,l.offsets[i]}h(vj,"findOffsetIntersectionPoint");function Zm(i,e,t,r,n,a,o,s,l,u,c,p,d,m){let g=r?i-e:i+e,_=g>0?1:-1,y=0;r&&(_*=-1,y=Math.PI),_<0&&(y+=Math.PI);let x=_>0?s+o:s+o+1,w=n,b=n,C,E,T=0,L=0,D=Math.abs(g),B=[],A;for(;T+L<=D;){if(x+=_,x<s||x>=l)return null;T+=L,b=w,E=C;let P={projectionCache:p,lineVertexArray:u,labelPlaneMatrix:c,tileAnchorPoint:a,distanceFromAnchor:T,getElevation:m,previousVertex:b,direction:_,absOffsetX:D};if(w=Uv(x,P),t===0)B.push(b),A=w.sub(b);else{let U,G=w.sub(b);if(G.mag()===0){let K=Uv(x+_,P);U=Vv(K.sub(w),t,_)}else U=Vv(G,t,_);E||(E=b.add(U)),C=vj(x,U,w,s,l,E,t,P),B.push(E),A=C.sub(E)}L=A.mag()}let k=(D-T)/L,$=A._mult(k)._add(E||b),z=y+Math.atan2(w.y-b.y,w.x-b.x);return B.push($),{point:$,angle:d?z:0,path:B}}h(Zm,"placeGlyphAlongLine");var jde=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function qu(i,e){for(let t=0;t<i;t++){let r=e.length;e.resize(r+4),e.float32.set(jde,r*3)}}h(qu,"hideGlyphs");function __(i,e,t){let r=e[0],n=e[1];return i[0]=t[0]*r+t[4]*n+t[12],i[1]=t[1]*r+t[5]*n+t[13],i[3]=t[3]*r+t[7]*n+t[15],i}h(__,"xyTransformMat4");var Cr=100,xj=class{constructor(e,t=new P6(e.width+2*Cr,e.height+2*Cr,25),r=new P6(e.width+2*Cr,e.height+2*Cr,25)){this.transform=e,this.grid=t,this.ignoredGrid=r,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Cr,this.screenBottomBoundary=e.height+Cr,this.gridRightBoundary=e.width+2*Cr,this.gridBottomBoundary=e.height+2*Cr,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,r,n,a,o){let s=this.projectAndGetPerspectiveRatio(n,e.anchorPointX,e.anchorPointY,o),l=r*s.perspectiveRatio,u=e.x1*l+s.point.x,c=e.y1*l+s.point.y,p=e.x2*l+s.point.x,d=e.y2*l+s.point.y;return!this.isInsideGrid(u,c,p,d)||t!=="always"&&this.grid.hitTest(u,c,p,d,t,a)||s.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[u,c,p,d],offscreen:this.isOffscreen(u,c,p,d)}}placeCollisionCircles(e,t,r,n,a,o,s,l,u,c,p,d,m,g){let _=[],y=new os.default(t.anchorX,t.anchorY),x=ma(y,o,g),w=x_(this.transform.cameraToCenterDistance,x.signedDistanceFromCamera),b=(c?a/w:a*w)/NU,C=ma(y,s,g).point,E={projections:{},offsets:{}},T=t.lineOffsetX*b,L=t.lineOffsetY*b,D=Q5(b,n,T,L,!1,C,y,t,r,s,E,!1,g),B=!1,A=!1,k=!0;if(D){let $=d*.5*w+m,z=new os.default(-Cr,-Cr),P=new os.default(this.screenRightBoundary,this.screenBottomBoundary),U=new Vde,G=D.first,K=D.last,O=[];for(let q=G.path.length-1;q>=1;q--)O.push(G.path[q]);for(let q=1;q<K.path.length;q++)O.push(K.path[q]);let V=$*2.5;if(l){let q=O.map(ee=>ma(ee,l,g));q.some(ee=>ee.signedDistanceFromCamera<=0)?O=[]:O=q.map(ee=>ee.point)}let j=[];if(O.length>0){let q=O[0].clone(),ee=O[0].clone();for(let ae=1;ae<O.length;ae++)q.x=Math.min(q.x,O[ae].x),q.y=Math.min(q.y,O[ae].y),ee.x=Math.max(ee.x,O[ae].x),ee.y=Math.max(ee.y,O[ae].y);q.x>=z.x&&ee.x<=P.x&&q.y>=z.y&&ee.y<=P.y?j=[O]:ee.x<z.x||q.x>P.x||ee.y<z.y||q.y>P.y?j=[]:j=dj([O],z.x,z.y,P.x,P.y)}for(let q of j){U.reset(q,$*.25);let ee=0;U.length<=.5*$?ee=1:ee=Math.ceil(U.paddedLength/V)+1;for(let ae=0;ae<ee;ae++){let N=ae/Math.max(ee-1,1),J=U.lerp(N),Y=J.x+Cr,oe=J.y+Cr;_.push(Y,oe,$,0);let xe=Y-$,ge=oe-$,Te=Y+$,me=oe+$;if(k=k&&this.isOffscreen(xe,ge,Te,me),A=A||this.isInsideGrid(xe,ge,Te,me),e!=="always"&&this.grid.hitTestCircle(Y,oe,$,e,p)&&(B=!0,!u))return{circles:[],offscreen:!1,collisionDetected:B}}}}return{circles:!u&&B||!A||w<this.perspectiveRatioCutoff?[]:_,offscreen:k,collisionDetected:B}}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let t=[],r=1/0,n=1/0,a=-1/0,o=-1/0;for(let c of e){let p=new os.default(c.x+Cr,c.y+Cr);r=Math.min(r,p.x),n=Math.min(n,p.y),a=Math.max(a,p.x),o=Math.max(o,p.y),t.push(p)}let s=this.grid.query(r,n,a,o).concat(this.ignoredGrid.query(r,n,a,o)),l={},u={};for(let c of s){let p=c.key;if(l[p.bucketInstanceId]===void 0&&(l[p.bucketInstanceId]={}),l[p.bucketInstanceId][p.featureIndex])continue;let d=[new os.default(c.x1,c.y1),new os.default(c.x2,c.y1),new os.default(c.x2,c.y2),new os.default(c.x1,c.y2)];J4(t,d)&&(l[p.bucketInstanceId][p.featureIndex]=!0,u[p.bucketInstanceId]===void 0&&(u[p.bucketInstanceId]=[]),u[p.bucketInstanceId].push(p.featureIndex))}return u}insertCollisionBox(e,t,r,n,a,o){let s=r?this.ignoredGrid:this.grid,l={bucketInstanceId:n,featureIndex:a,collisionGroupID:o,overlapMode:t};s.insert(l,e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,r,n,a,o){let s=r?this.ignoredGrid:this.grid,l={bucketInstanceId:n,featureIndex:a,collisionGroupID:o,overlapMode:t};for(let u=0;u<e.length;u+=4)s.insertCircle(l,e[u],e[u+1],e[u+2])}projectAndGetPerspectiveRatio(e,t,r,n){let a;return n?(a=[t,r,n(t,r),1],Tn.transformMat4(a,a,e)):(a=[t,r,0,1],__(a,a,e)),{point:new os.default((a[0]/a[3]+1)/2*this.transform.width+Cr,(-a[1]/a[3]+1)/2*this.transform.height+Cr),perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/a[3])}}isOffscreen(e,t,r,n){return r<Cr||e>=this.screenRightBoundary||n<Cr||t>this.screenBottomBoundary}isInsideGrid(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){let e=ht.identity([]);return ht.translate(e,e,[-Cr,-Cr,0]),e}};h(xj,"CollisionIndex");var Hde=xj;R();R();var Gde=kt(gi(),1),_j=class bj extends Gde.default{constructor(e,t,r,n){super(e,t),this.angle=r,n!==void 0&&(this.segment=n)}clone(){return new bj(this.x,this.y,this.angle,this.segment)}};h(_j,"Anchor");var Wde=_j;ut("Anchor",Wde);R();R();R();kt(gi(),1);R();kt(gi(),1);R();R();kt(gi(),1);kt(uD(),1);R();var Z3=(i=>(i[i.center=1]="center",i[i.left=2]="left",i[i.right=3]="right",i[i.top=4]="top",i[i.bottom=5]="bottom",i[i["top-left"]=6]="top-left",i[i["top-right"]=7]="top-right",i[i["bottom-left"]=8]="bottom-left",i[i["bottom-right"]=9]="bottom-right",i))(Z3||{});function wj(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}h(wj,"getAnchorJustification");R();function ta(i,e,t){return e*(8192/(i.tileSize*Math.pow(2,t-i.tileID.overscaledZ)))}h(ta,"pixelsToTileUnits");var tT=kt(gi(),1),Sj=class{constructor(e,t,r,n){e?this.opacity=Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):this.opacity=n&&r?1:0,this.placed=r}isHidden(){return this.opacity===0&&!this.placed}};h(Sj,"OpacityState");var A6=Sj,Mj=class{constructor(e,t,r,n,a){this.text=new A6(e?e.text:null,t,r,a),this.icon=new A6(e?e.icon:null,t,n,a)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}};h(Mj,"JointOpacityState");var Nd=Mj,Cj=class{constructor(e,t,r){this.text=e,this.icon=t,this.skipFade=r}};h(Cj,"JointPlacement");var I6=Cj,Ej=class{constructor(){this.invProjMatrix=ht.create(),this.viewportMatrix=ht.create(),this.circles=[]}};h(Ej,"CollisionCircleArray");var Xde=Ej,Tj=class{constructor(e,t,r,n,a){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=a}};h(Tj,"RetainedQueryData");var qde=Tj,Pj=class{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:r=>r.collisionGroupID===t}}return this.collisionGroups[e]}};h(Pj,"CollisionGroups");var Zde=Pj;function Y3(i,e,t,r,n){let{horizontalAlign:a,verticalAlign:o}=H5(i),s=-(a-.5)*e,l=-(o-.5)*t;return new tT.default(s+r[0]*n,l+r[1]*n)}h(Y3,"calculateVariableLayoutShift");function zy(i,e,t,r,n,a){let{x1:o,x2:s,y1:l,y2:u,anchorPointX:c,anchorPointY:p}=i,d=new tT.default(e,t);return r&&d._rotate(n?a:-a),{x1:o+d.x,y1:l+d.y,x2:s+d.x,y2:u+d.y,anchorPointX:c,anchorPointY:p}}h(zy,"shiftVariableCollisionBox");var Aj=class{constructor(e,t,r,n,a){this.transform=e.clone(),this.terrain=t,this.collisionIndex=new Hde(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new Zde(n),this.collisionCircleArrays={},this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,t,r,n){let a=r.getBucket(t),o=r.latestFeatureIndex;if(!a||!o||t.id!==a.layerIds[0])return;let s=r.collisionBoxArray,l=a.layers[0].layout,u=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),c=r.tileSize/8192,p=this.transform.calculatePosMatrix(r.tileID.toUnwrapped()),d=l.get("text-pitch-alignment")==="map",m=l.get("text-rotation-alignment")==="map",g=ta(r,1,this.transform.zoom),_=v_(p,d,m,this.transform,g),y=null;if(d){let w=K5(p,d,m,this.transform,g);y=ht.multiply([],this.transform.labelPlaneMatrix,w)}this.retainedQueryData[a.bucketInstanceId]=new qde(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,r.tileID);let x={bucket:a,layout:l,posMatrix:p,textLabelPlaneMatrix:_,labelToScreenMatrix:y,scale:u,textPixelRatio:c,holdingForFade:r.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:Mg(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(n)for(let w of a.sortKeyRanges){let{sortKey:b,symbolInstanceStart:C,symbolInstanceEnd:E}=w;e.push({sortKey:b,symbolInstanceStart:C,symbolInstanceEnd:E,parameters:x})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:x})}attemptAnchorPlacement(e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y){let x=Z3[e.textAnchor],w=[e.textOffset0,e.textOffset1],b=Y3(x,r,n,w,a),C=this.collisionIndex.placeCollisionBox(zy(t,b.x,b.y,o,s,this.transform.angle),p,l,u,c.predicate,y);if(!(_&&this.collisionIndex.placeCollisionBox(zy(_,b.x,b.y,o,s,this.transform.angle),p,l,u,c.predicate,y).box.length===0)&&C.box.length>0){let E;if(this.prevPlacement&&this.prevPlacement.variableOffsets[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID]&&this.prevPlacement.placements[d.crossTileID].text&&(E=this.prevPlacement.variableOffsets[d.crossTileID].anchor),d.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[d.crossTileID]={textOffset:w,width:r,height:n,anchor:x,textBoxScale:a,prevAnchor:E},this.markUsedJustification(m,x,d,g),m.allowVerticalPlacement&&(this.markUsedOrientation(m,g,d),this.placedOrientations[d.crossTileID]=g),{shift:b,placedGlyphBoxes:C}}}placeLayerBucketPart(e,t,r){let{bucket:n,layout:a,posMatrix:o,textLabelPlaneMatrix:s,labelToScreenMatrix:l,textPixelRatio:u,holdingForFade:c,collisionBoxArray:p,partiallyEvaluatedTextSize:d,collisionGroup:m}=e.parameters,g=a.get("text-optional"),_=a.get("icon-optional"),y=Gm(a,"text-overlap","text-allow-overlap"),x=y==="always",w=Gm(a,"icon-overlap","icon-allow-overlap"),b=w==="always",C=a.get("text-rotation-alignment")==="map",E=a.get("text-pitch-alignment")==="map",T=a.get("icon-text-fit")!=="none",L=a.get("symbol-z-order")==="viewport-y",D=x&&(b||!n.hasIconData()||_),B=b&&(x||!n.hasTextData()||g);!n.collisionArrays&&p&&n.deserializeCollisionBoxes(p);let A=this.retainedQueryData[n.bucketInstanceId].tileID,k=this.terrain?(z,P)=>this.terrain.getElevation(A,z,P):null,$=h((z,P)=>{var U,G;if(t[z.crossTileID])return;if(c){this.placements[z.crossTileID]=new I6(!1,!1,!1);return}let K=!1,O=!1,V=!0,j=null,q={box:null,offscreen:null},ee={box:null,offscreen:null},ae=null,N=null,J=null,Y=0,oe=0,xe=0;P.textFeatureIndex?Y=P.textFeatureIndex:z.useRuntimeCollisionCircles&&(Y=z.featureIndex),P.verticalTextFeatureIndex&&(oe=P.verticalTextFeatureIndex);let ge=P.textBox;if(ge){let Q=h(ke=>{let we=1;if(n.allowVerticalPlacement&&!ke&&this.prevPlacement){let Oe=this.prevPlacement.placedOrientations[z.crossTileID];Oe&&(this.placedOrientations[z.crossTileID]=Oe,we=Oe,this.markUsedOrientation(n,we,z))}return we},"updatePreviousOrientationIfNotPlaced"),Me=h((ke,we)=>{if(n.allowVerticalPlacement&&z.numVerticalGlyphVertices>0&&P.verticalTextBox){for(let Oe of n.writingModes)if(Oe===2?(q=we(),ee=q):q=ke(),q&&q.box&&q.box.length)break}else q=ke()},"placeTextForPlacementModes"),ve=z.textAnchorOffsetStartIndex,Ie=z.textAnchorOffsetEndIndex;if(Ie===ve){let ke=h((we,Oe)=>{let Je=this.collisionIndex.placeCollisionBox(we,y,u,o,m.predicate,k);return Je&&Je.box&&Je.box.length&&(this.markUsedOrientation(n,Oe,z),this.placedOrientations[z.crossTileID]=Oe),Je},"placeBox");Me(h(()=>ke(ge,1),"placeHorizontal"),h(()=>{let we=P.verticalTextBox;return n.allowVerticalPlacement&&z.numVerticalGlyphVertices>0&&we?ke(we,2):{box:null,offscreen:null}},"placeVertical")),Q(q&&q.box&&q.box.length)}else{let ke=Z3[(G=(U=this.prevPlacement)==null?void 0:U.variableOffsets[z.crossTileID])==null?void 0:G.anchor],we=h((Je,xt,ne)=>{let W=Je.x2-Je.x1,_e=Je.y2-Je.y1,Fe=z.textBoxScale,Ue=T&&w==="never"?xt:null,Be={box:[],offscreen:!1},bt=y==="never"?1:2,lt="never";ke&&bt++;for(let Ge=0;Ge<bt;Ge++){for(let We=ve;We<Ie;We++){let St=n.textAnchorOffsets.get(We);if(ke&&St.textAnchor!==ke)continue;let Ze=this.attemptAnchorPlacement(St,Je,W,_e,Fe,C,E,u,o,m,lt,z,n,ne,Ue,k);if(Ze&&(Be=Ze.placedGlyphBoxes,Be&&Be.box&&Be.box.length))return K=!0,j=Ze.shift,Be}ke?ke=null:lt=y}return Be},"placeBoxForVariableAnchors");Me(h(()=>we(ge,P.iconBox,1),"placeHorizontal"),h(()=>{let Je=P.verticalTextBox,xt=q&&q.box&&q.box.length;return n.allowVerticalPlacement&&!xt&&z.numVerticalGlyphVertices>0&&Je?we(Je,P.verticalIconBox,2):{box:null,offscreen:null}},"placeVertical")),q&&(K=q.box,V=q.offscreen);let Oe=Q(q&&q.box);if(!K&&this.prevPlacement){let Je=this.prevPlacement.variableOffsets[z.crossTileID];Je&&(this.variableOffsets[z.crossTileID]=Je,this.markUsedJustification(n,Je.anchor,z,Oe))}}}if(ae=q,K=ae&&ae.box&&ae.box.length>0,V=ae&&ae.offscreen,z.useRuntimeCollisionCircles){let Q=n.text.placedSymbolArray.get(z.centerJustifiedTextSymbolIndex),Me=f_(n.textSizeData,d,Q),ve=a.get("text-padding"),Ie=z.collisionCircleDiameter;N=this.collisionIndex.placeCollisionCircles(y,Q,n.lineVertexArray,n.glyphOffsetArray,Me,o,s,l,r,E,m.predicate,Ie,ve,k),N.circles.length&&N.collisionDetected&&!r&&dn("Collisions detected, but collision boxes are not shown"),K=x||N.circles.length>0&&!N.collisionDetected,V=V&&N.offscreen}if(P.iconFeatureIndex&&(xe=P.iconFeatureIndex),P.iconBox){let Q=h(Me=>{let ve=T&&j?zy(Me,j.x,j.y,C,E,this.transform.angle):Me;return this.collisionIndex.placeCollisionBox(ve,w,u,o,m.predicate,k)},"placeIconFeature");ee&&ee.box&&ee.box.length&&P.verticalIconBox?(J=Q(P.verticalIconBox),O=J.box.length>0):(J=Q(P.iconBox),O=J.box.length>0),V=V&&J.offscreen}let Te=g||z.numHorizontalGlyphVertices===0&&z.numVerticalGlyphVertices===0,me=_||z.numIconVertices===0;if(!Te&&!me?O=K=O&&K:me?Te||(O=O&&K):K=O&&K,K&&ae&&ae.box&&(ee&&ee.box&&oe?this.collisionIndex.insertCollisionBox(ae.box,y,a.get("text-ignore-placement"),n.bucketInstanceId,oe,m.ID):this.collisionIndex.insertCollisionBox(ae.box,y,a.get("text-ignore-placement"),n.bucketInstanceId,Y,m.ID)),O&&J&&this.collisionIndex.insertCollisionBox(J.box,w,a.get("icon-ignore-placement"),n.bucketInstanceId,xe,m.ID),N&&(K&&this.collisionIndex.insertCollisionCircles(N.circles,y,a.get("text-ignore-placement"),n.bucketInstanceId,Y,m.ID),r)){let Q=n.bucketInstanceId,Me=this.collisionCircleArrays[Q];Me===void 0&&(Me=this.collisionCircleArrays[Q]=new Xde);for(let ve=0;ve<N.circles.length;ve+=4)Me.circles.push(N.circles[ve+0]),Me.circles.push(N.circles[ve+1]),Me.circles.push(N.circles[ve+2]),Me.circles.push(N.collisionDetected?1:0)}if(z.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(n.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[z.crossTileID]=new I6(K||D,O||B,V||n.justReloaded),t[z.crossTileID]=!0},"placeSymbol");if(L){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let z=n.getSortedSymbolIndexes(this.transform.angle);for(let P=z.length-1;P>=0;--P){let U=z[P];$(n.symbolInstances.get(U),n.collisionArrays[U])}}else for(let z=e.symbolInstanceStart;z<e.symbolInstanceEnd;z++)$(n.symbolInstances.get(z),n.collisionArrays[z]);if(r&&n.bucketInstanceId in this.collisionCircleArrays){let z=this.collisionCircleArrays[n.bucketInstanceId];ht.invert(z.invProjMatrix,o),z.viewportMatrix=this.collisionIndex.getViewportMatrix()}n.justReloaded=!1}markUsedJustification(e,t,r,n){let a={left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex},o;n===2?o=r.verticalPlacedTextSymbolIndex:o=a[wj(t)];let s=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(let l of s)l>=0&&(o>=0&&l!==o?e.text.placedSymbolArray.get(l).crossTileID=0:e.text.placedSymbolArray.get(l).crossTileID=r.crossTileID)}markUsedOrientation(e,t,r){let n=t===1||t===3?t:0,a=t===2?t:0,o=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(let s of o)e.text.placedSymbolArray.get(s).placedOrientation=n;r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let t=this.prevPlacement,r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;let n=t?t.symbolFadeChange(e):1,a=t?t.opacities:{},o=t?t.variableOffsets:{},s=t?t.placedOrientations:{};for(let l in this.placements){let u=this.placements[l],c=a[l];c?(this.opacities[l]=new Nd(c,n,u.text,u.icon),r=r||u.text!==c.text.placed||u.icon!==c.icon.placed):(this.opacities[l]=new Nd(null,n,u.text,u.icon,u.skipFade),r=r||u.text||u.icon)}for(let l in a){let u=a[l];if(!this.opacities[l]){let c=new Nd(u,n,!1,!1);c.isHidden()||(this.opacities[l]=c,r=r||u.text.placed||u.icon.placed)}}for(let l in o)!this.variableOffsets[l]&&this.opacities[l]&&!this.opacities[l].isHidden()&&(this.variableOffsets[l]=o[l]);for(let l in s)!this.placedOrientations[l]&&this.opacities[l]&&!this.opacities[l].isHidden()&&(this.placedOrientations[l]=s[l]);if(t&&t.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");r?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){let r={};for(let n of t){let a=n.getBucket(e);a&&n.latestFeatureIndex&&e.id===a.layerIds[0]&&this.updateBucketOpacities(a,r,n.collisionBoxArray)}}updateBucketOpacities(e,t,r){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let n=e.layers[0],a=n.layout,o=new Nd(null,0,!1,!1,!0),s=a.get("text-allow-overlap"),l=a.get("icon-allow-overlap"),u=n._unevaluatedLayout.hasValue("text-variable-anchor")||n._unevaluatedLayout.hasValue("text-variable-anchor-offset"),c=a.get("text-rotation-alignment")==="map",p=a.get("text-pitch-alignment")==="map",d=a.get("icon-text-fit")!=="none",m=new Nd(null,0,s&&(l||!e.hasIconData()||a.get("icon-optional")),l&&(s||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&r&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(r);let g=h((_,y,x)=>{for(let w=0;w<y/4;w++)_.opacityVertexArray.emplaceBack(x);_.hasVisibleVertices=_.hasVisibleVertices||x!==$d},"addOpacities");for(let _=0;_<e.symbolInstances.length;_++){let y=e.symbolInstances.get(_),{numHorizontalGlyphVertices:x,numVerticalGlyphVertices:w,crossTileID:b}=y,C=t[b],E=this.opacities[b];C?E=o:E||(E=m,this.opacities[b]=E),t[b]=!0;let T=x>0||w>0,L=y.numIconVertices>0,D=this.placedOrientations[y.crossTileID],B=D===2,A=D===1||D===3;if(T){let k=J3(E.text),$=B?$d:k;g(e.text,x,$);let z=A?$d:k;g(e.text,w,z);let P=E.text.isHidden();[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach(K=>{K>=0&&(e.text.placedSymbolArray.get(K).hidden=P||B?1:0)}),y.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(y.verticalPlacedTextSymbolIndex).hidden=P||A?1:0);let U=this.variableOffsets[y.crossTileID];U&&this.markUsedJustification(e,U.anchor,y,D);let G=this.placedOrientations[y.crossTileID];G&&(this.markUsedJustification(e,"left",y,G),this.markUsedOrientation(e,G,y))}if(L){let k=J3(E.icon),$=!(d&&y.verticalPlacedIconSymbolIndex&&B);if(y.placedIconSymbolIndex>=0){let z=$?k:$d;g(e.icon,y.numIconVertices,z),e.icon.placedSymbolArray.get(y.placedIconSymbolIndex).hidden=E.icon.isHidden()}if(y.verticalPlacedIconSymbolIndex>=0){let z=$?$d:k;g(e.icon,y.numVerticalIconVertices,z),e.icon.placedSymbolArray.get(y.verticalPlacedIconSymbolIndex).hidden=E.icon.isHidden()}}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let k=e.collisionArrays[_];if(k){let $=new tT.default(0,0);if(k.textBox||k.verticalTextBox){let P=!0;if(u){let U=this.variableOffsets[b];U?($=Y3(U.anchor,U.width,U.height,U.textOffset,U.textBoxScale),c&&$._rotate(p?this.transform.angle:-this.transform.angle)):P=!1}k.textBox&&wf(e.textCollisionBox.collisionVertexArray,E.text.placed,!P||B,$.x,$.y),k.verticalTextBox&&wf(e.textCollisionBox.collisionVertexArray,E.text.placed,!P||A,$.x,$.y)}let z=!!(!A&&k.verticalIconBox);k.iconBox&&wf(e.iconCollisionBox.collisionVertexArray,E.icon.placed,z,d?$.x:0,d?$.y:0),k.verticalIconBox&&wf(e.iconCollisionBox.collisionVertexArray,E.icon.placed,!z,d?$.x:0,d?$.y:0)}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){let _=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=_.invProjMatrix,e.placementViewportMatrix=_.viewportMatrix,e.collisionCircleArray=_.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){let r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}setStale(){this.stale=!0}};h(Aj,"Placement");var Yde=Aj;function wf(i,e,t,r,n){i.emplaceBack(e?1:0,t?1:0,r||0,n||0),i.emplaceBack(e?1:0,t?1:0,r||0,n||0),i.emplaceBack(e?1:0,t?1:0,r||0,n||0),i.emplaceBack(e?1:0,t?1:0,r||0,n||0)}h(wf,"updateCollisionVertices");var Jde=Math.pow(2,25),Kde=Math.pow(2,24),Qde=Math.pow(2,17),efe=Math.pow(2,16),tfe=Math.pow(2,9),ife=Math.pow(2,8),rfe=Math.pow(2,1);function J3(i){if(i.opacity===0&&!i.placed)return 0;if(i.opacity===1&&i.placed)return 4294967295;let e=i.placed?1:0,t=Math.floor(i.opacity*127);return t*Jde+e*Kde+t*Qde+e*efe+t*tfe+e*ife+t*rfe+e}h(J3,"packOpacity");var $d=0,Ij=class{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,r,n,a){let o=this._bucketParts;for(;this._currentTileIndex<e.length;){let s=e[this._currentTileIndex];if(t.getBucketParts(o,n,s,this._sortAcrossTiles),this._currentTileIndex++,a())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort((s,l)=>s.sortKey-l.sortKey));this._currentPartIndex<o.length;){let s=o[this._currentPartIndex];if(t.placeLayerBucketPart(s,this._seenCrossTileIDs,r),this._currentPartIndex++,a())return!0}return!1}};h(Ij,"LayerPlacement");var nfe=Ij,Lj=class{constructor(e,t,r,n,a,o,s,l){this.placement=new Yde(e,t,o,s,l),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=n,this._showCollisionBoxes=a,this._done=!1}isDone(){return this._done}continuePlacement(e,t,r){let n=li.now(),a=h(()=>this._forceFullPlacement?!1:li.now()-n>2,"shouldPausePlacement");for(;this._currentPlacementIndex>=0;){let o=e[this._currentPlacementIndex],s=t[o],l=this.placement.collisionIndex.transform.zoom;if(s.type==="symbol"&&(!s.minzoom||s.minzoom<=l)&&(!s.maxzoom||s.maxzoom>l)){if(this._inProgressLayer||(this._inProgressLayer=new nfe(s)),this._inProgressLayer.continuePlacement(r[s.source],this.placement,this._showCollisionBoxes,s,a))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}};h(Lj,"PauseablePlacement");var afe=Lj;R();R();var L6=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],R2=1,Ud=8,Dj=class kj{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[t,r]=new Uint8Array(e,0,2);if(t!==219)throw new Error("Data does not appear to be in a KDBush format.");let n=r>>4;if(n!==R2)throw new Error(`Got v${n} data when expected v${R2}.`);let a=L6[r&15];if(!a)throw new Error("Unrecognized array type.");let[o]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new kj(s,o,a,e)}constructor(e,t=64,r=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;let a=L6.indexOf(this.ArrayType),o=e*2*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-s%8)%8;if(a<0)throw new Error(`Unexpected typed array class: ${r}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,Ud,e),this.coords=new this.ArrayType(this.data,Ud+s+l,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Ud+o+s+l),this.ids=new this.IndexArrayType(this.data,Ud,e),this.coords=new this.ArrayType(this.data,Ud+s+l,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(R2<<4)+a]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){let r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=t,r}finish(){let e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return jv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,r,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:a,coords:o,nodeSize:s}=this,l=[0,a.length-1,0],u=[];for(;l.length;){let c=l.pop()||0,p=l.pop()||0,d=l.pop()||0;if(p-d<=s){for(let y=d;y<=p;y++){let x=o[2*y],w=o[2*y+1];x>=e&&x<=r&&w>=t&&w<=n&&u.push(a[y])}continue}let m=d+p>>1,g=o[2*m],_=o[2*m+1];g>=e&&g<=r&&_>=t&&_<=n&&u.push(a[m]),(c===0?e<=g:t<=_)&&(l.push(d),l.push(m-1),l.push(1-c)),(c===0?r>=g:n>=_)&&(l.push(m+1),l.push(p),l.push(1-c))}return u}within(e,t,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:n,coords:a,nodeSize:o}=this,s=[0,n.length-1,0],l=[],u=r*r;for(;s.length;){let c=s.pop()||0,p=s.pop()||0,d=s.pop()||0;if(p-d<=o){for(let y=d;y<=p;y++)K3(a[2*y],a[2*y+1],e,t)<=u&&l.push(n[y]);continue}let m=d+p>>1,g=a[2*m],_=a[2*m+1];K3(g,_,e,t)<=u&&l.push(n[m]),(c===0?e-r<=g:t-r<=_)&&(s.push(d),s.push(m-1),s.push(1-c)),(c===0?e+r>=g:t+r>=_)&&(s.push(m+1),s.push(p),s.push(1-c))}return l}};h(Dj,"KDBush");var ofe=Dj;function jv(i,e,t,r,n,a){if(n-r<=t)return;let o=r+n>>1;iT(i,e,o,r,n,a),jv(i,e,t,r,o-1,1-a),jv(i,e,t,o+1,n,1-a)}h(jv,"sort");function iT(i,e,t,r,n,a){for(;n>r;){if(n-r>600){let u=n-r+1,c=t-r+1,p=Math.log(u),d=.5*Math.exp(2*p/3),m=.5*Math.sqrt(p*d*(u-d)/u)*(c-u/2<0?-1:1),g=Math.max(r,Math.floor(t-c*d/u+m)),_=Math.min(n,Math.floor(t+(u-c)*d/u+m));iT(i,e,t,g,_,a)}let o=e[2*t+a],s=r,l=n;for(pc(i,e,r,t),e[2*n+a]>o&&pc(i,e,r,n);s<l;){for(pc(i,e,s,l),s++,l--;e[2*s+a]<o;)s++;for(;e[2*l+a]>o;)l--}e[2*r+a]===o?pc(i,e,r,l):(l++,pc(i,e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}}h(iT,"select");function pc(i,e,t,r){Ny(i,t,r),Ny(e,2*t,2*r),Ny(e,2*t+1,2*r+1)}h(pc,"swapItem");function Ny(i,e,t){let r=i[e];i[e]=i[t],i[t]=r}h(Ny,"swap");function K3(i,e,t,r){let n=i-t,a=e-r;return n*n+a*a}h(K3,"sqDist");var Vd=512/8192/2,sfe=128,Rj=class{constructor(e,t,r){this.tileID=e,this.bucketInstanceId=r,this._symbolsByKey={};let n=new Map;for(let a=0;a<t.length;a++){let o=t.get(a),s=o.key,l=n.get(s);l?l.push(o):n.set(s,[o])}for(let[a,o]of n){let s=o.map(c=>({x:Math.floor(c.anchorX*Vd),y:Math.floor(c.anchorY*Vd)})),l=o.map(c=>c.crossTileID),u={positions:s,crossTileIDs:l};if(u.positions.length>sfe){let c=new ofe(u.positions.length,16,Uint16Array);for(let{x:p,y:d}of u.positions)c.add(p,d);c.finish(),delete u.positions,u.index=c}this._symbolsByKey[a]=u}}getScaledCoordinates(e,t){let{x:r,y:n,z:a}=this.tileID.canonical,{x:o,y:s,z:l}=t.canonical,u=l-a,c=Vd/Math.pow(2,u),p=(o*8192+e.anchorX)*c,d=(s*8192+e.anchorY)*c,m=r*8192*Vd,g=n*8192*Vd;return{x:Math.floor(p-m),y:Math.floor(d-g)}}findMatches(e,t,r){let n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let a=0;a<e.length;a++){let o=e.get(a);if(o.crossTileID)continue;let s=this._symbolsByKey[o.key];if(!s)continue;let l=this.getScaledCoordinates(o,t);if(s.index){let u=s.index.range(l.x-n,l.y-n,l.x+n,l.y+n).sort();for(let c of u){let p=s.crossTileIDs[c];if(!r[p]){r[p]=!0,o.crossTileID=p;break}}}else if(s.positions)for(let u=0;u<s.positions.length;u++){let c=s.positions[u],p=s.crossTileIDs[u];if(Math.abs(c.x-l.x)<=n&&Math.abs(c.y-l.y)<=n&&!r[p]){r[p]=!0,o.crossTileID=p;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}};h(Rj,"TileLayerIndex");var lfe=Rj,Fj=class{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}};h(Fj,"CrossTileIDs");var ufe=Fj,Oj=class{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let t=Math.round((e-this.lng)/360);if(t!==0)for(let r in this.indexes){let n=this.indexes[r],a={};for(let o in n){let s=n[o];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+t),a[s.tileID.key]=s}this.indexes[r]=a}this.lng=e}addBucket(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let a=0;a<t.symbolInstances.length;a++){let o=t.symbolInstances.get(a);o.crossTileID=0}this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let n=this.usedCrossTileIDs[e.overscaledZ];for(let a in this.indexes){let o=this.indexes[a];if(Number(a)>e.overscaledZ)for(let s in o){let l=o[s];l.tileID.isChildOf(e)&&l.findMatches(t.symbolInstances,e,n)}else{let s=e.scaledTo(Number(a)),l=o[s.key];l&&l.findMatches(t.symbolInstances,e,n)}}for(let a=0;a<t.symbolInstances.length;a++){let o=t.symbolInstances.get(a);o.crossTileID||(o.crossTileID=r.generate(),n[o.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new lfe(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(let r of t.getCrossTileIDsLists())for(let n of r)delete this.usedCrossTileIDs[e][n]}removeStaleBuckets(e){let t=!1;for(let r in this.indexes){let n=this.indexes[r];for(let a in n)e[n[a].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[a]),delete n[a],t=!0)}return t}};h(Oj,"CrossTileSymbolLayerIndex");var hfe=Oj,Bj=class{constructor(){this.layerIndexes={},this.crossTileIDs=new ufe,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,r){let n=this.layerIndexes[e.id];n===void 0&&(n=this.layerIndexes[e.id]=new hfe);let a=!1,o={};n.handleWrapJump(r);for(let s of t){let l=s.getBucket(e);!l||e.id!==l.layerIds[0]||(l.bucketInstanceId||(l.bucketInstanceId=++this.maxBucketInstanceId),n.addBucket(s.tileID,l,this.crossTileIDs)&&(a=!0),o[l.bucketInstanceId]=!0)}return n.removeStaleBuckets(o)&&(a=!0),a}pruneUnusedLayers(e){let t={};e.forEach(r=>{t[r]=!0});for(let r in this.layerIndexes)t[r]||delete this.layerIndexes[r]}};h(Bj,"CrossTileSymbolIndex");var zj=Bj,p1=h((i,e)=>i_(i,e&&e.filter(t=>t.identifier!=="source.canvas")),"emitValidationErrors"),cfe=vF(),Nj=class extends mn{constructor(e,t={}){super(),this._rtlPluginLoaded=()=>{for(let r in this.sourceCaches){let n=this.sourceCaches[r].getSource().type;(n==="vector"||n==="geojson")&&this.sourceCaches[r].reload()}},this.map=e,this.dispatcher=new bV(g_(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(r,n)=>this.getGlyphs(r,n)),this.dispatcher.registerMessageHandler("GI",(r,n)=>this.getImages(r,n)),this.imageManager=new pde,this.imageManager.setEventedParent(this),this.glyphManager=new fde(e._requestManager,t.localIdeographFontFamily),this.lineAtlas=new yde(256,512),this.crossTileSymbolIndex=new zj,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new LF,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",NE()),Kp().on(H3,this._rtlPluginLoaded),this.on("data",r=>{if(r.dataType!=="source"||r.sourceDataType!=="metadata")return;let n=this.sourceCaches[r.sourceId];if(!n)return;let a=n.getSource();if(!(!a||!a.vectorLayerIds))for(let o in this._layers){let s=this._layers[o];s.source===a.id&&this._validateLayer(s)}})}loadURL(e,t={},r){this.fire(new Ye("dataloading",{dataType:"style"})),t.validate=typeof t.validate=="boolean"?t.validate:!0;let n=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController,Ux(n,this._loadStyleRequest).then(a=>{this._loadStyleRequest=null,this._load(a.data,t,r)}).catch(a=>{this._loadStyleRequest=null,a&&this.fire(new Et(a))})}loadJSON(e,t={},r){this.fire(new Ye("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,li.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,t.validate=t.validate!==!1,this._load(e,t,r)}).catch(()=>{})}loadEmpty(){this.fire(new Ye("dataloading",{dataType:"style"})),this._load(cfe,{validate:!1})}_load(e,t,r){var n;let a=t.transformStyle?t.transformStyle(r,e):e;if(!(t.validate&&p1(this,Or(a)))){this._loaded=!0,this.stylesheet=a;for(let o in a.sources)this.addSource(o,a.sources[o],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new gde(this.stylesheet.light),this.map.setTerrain((n=this.stylesheet.terrain)!=null?n:null),this.fire(new Ye("data",{dataType:"style"})),this.fire(new Ye("style.load"))}}_createLayers(){let e=Ww(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(t=>t.id),this._layers={},this._serializedLayers=null;for(let t of e){let r=Oy(t);r.setEventedParent(this,{layer:{id:t.id}}),this._layers[t.id]=r}}_loadSprite(e,t=!1,r=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController;let n;aV(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(a=>{if(this._spriteRequest=null,a)for(let o in a){this._spritesImagesIds[o]=[];let s=this._spritesImagesIds[o]?this._spritesImagesIds[o].filter(l=>!(l in a)):[];for(let l of s)this.imageManager.removeImage(l),this._changedImages[l]=!0;for(let l in a[o]){let u=o==="default"?l:`${o}:${l}`;this._spritesImagesIds[o].push(u),u in this.imageManager.images?this.imageManager.updateImage(u,a[o][l],!1):this.imageManager.addImage(u,a[o][l]),t&&(this._changedImages[u]=!0)}}}).catch(a=>{this._spriteRequest=null,n=a,this.fire(new Et(n))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),t&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Ye("data",{dataType:"style"})),r&&r(n)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Ye("data",{dataType:"style"}))}_validateLayer(e){let t=this.sourceCaches[e.source];if(!t)return;let r=e.sourceLayer;if(!r)return;let n=t.getSource();(n.type==="geojson"||n.vectorLayerIds&&n.vectorLayerIds.indexOf(r)===-1)&&this.fire(new Et(new Error(`Source layer "${r}" does not exist on source "${n.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){let t=this._serializedAllLayers();if(!e||e.length===0)return Object.values(t);let r=[];for(let n of e)t[n]&&r.push(t[n]);return r}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};let t=Object.keys(this._layers);for(let r of t){let n=this._layers[r];n.type!=="custom"&&(e[r]=n.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(let e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;let t=this._changed;if(t){let n=Object.keys(this._updatedLayers),a=Object.keys(this._removedLayers);(n.length||a.length)&&this._updateWorkerLayers(n,a);for(let o in this._updatedSources){let s=this._updatedSources[o];if(s==="reload")this._reloadSource(o);else if(s==="clear")this._clearSource(o);else throw new Error(`Invalid action ${s}`)}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let o in this._updatedPaintProps)this._layers[o].updateTransitions(e);this.light.updateTransitions(e),this._resetUpdates()}let r={};for(let n in this.sourceCaches){let a=this.sourceCaches[n];r[n]=a.used,a.used=!1}for(let n of this._order){let a=this._layers[n];a.recalculate(e,this._availableImages),!a.isHidden(e.zoom)&&a.source&&(this.sourceCaches[a.source].used=!0)}for(let n in r){let a=this.sourceCaches[n];!!r[n]!=!!a.used&&a.fire(new Ye("data",{sourceDataType:"visibility",dataType:"source",sourceId:n}))}this.light.recalculate(e),this.z=e.zoom,t&&this.fire(new Ye("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,t={}){var r;this._checkLoaded();let n=this.serialize();if(e=t.transformStyle?t.transformStyle(n,e):e,((r=t.validate)!=null?r:!0)&&p1(this,Or(e)))return!1;e=da(e),e.layers=Ww(e.layers);let a=GD(n,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error(`Unimplemented: ${o.unimplemented.join(", ")}.`);if(o.operations.length===0)return!1;for(let s of o.operations)s();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let t=[],r=[];for(let n of e)switch(n.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":t.push(()=>this.addLayer.apply(this,n.args));break;case"removeLayer":t.push(()=>this.removeLayer.apply(this,n.args));break;case"setPaintProperty":t.push(()=>this.setPaintProperty.apply(this,n.args));break;case"setLayoutProperty":t.push(()=>this.setLayoutProperty.apply(this,n.args));break;case"setFilter":t.push(()=>this.setFilter.apply(this,n.args));break;case"addSource":t.push(()=>this.addSource.apply(this,n.args));break;case"removeSource":t.push(()=>this.removeSource.apply(this,n.args));break;case"setLayerZoomRange":t.push(()=>this.setLayerZoomRange.apply(this,n.args));break;case"setLight":t.push(()=>this.setLight.apply(this,n.args));break;case"setGeoJSONSourceData":t.push(()=>this.setGeoJSONSourceData.apply(this,n.args));break;case"setGlyphs":t.push(()=>this.setGlyphs.apply(this,n.args));break;case"setSprite":t.push(()=>this.setSprite.apply(this,n.args));break;case"setTerrain":t.push(()=>this.map.setTerrain.apply(this,n.args));break;case"setTransition":t.push(()=>{});break;default:r.push(n.command);break}return{operations:t,unimplemented:r}}addImage(e,t){if(this.getImage(e))return this.fire(new Et(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,t),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new Et(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Ye("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,t,r={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!t.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(t).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(t.type)>=0&&this._validate(Or.source,`sources.${e}`,t,null,r))return;this.map&&this.map._collectResourceTiming&&(t.collectResourceTiming=!0);let n=this.sourceCaches[e]=new Xm(e,t,this.dispatcher);n.style=this,n.setEventedParent(this,()=>({isSourceLoaded:n.loaded(),source:n.serialize(),sourceId:e})),n.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(let r in this._layers)if(this._layers[r].source===e)return this.fire(new Et(new Error(`Source "${e}" cannot be removed while layer "${r}" is using it.`)));let t=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],t.fire(new Ye("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),t.setEventedParent(null),t.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);let r=this.sourceCaches[e].getSource();if(r.type!=="geojson")throw new Error(`geojsonSource.type is ${r.type}, which is !== 'geojson`);r.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,t,r={}){this._checkLoaded();let n=e.id;if(this.getLayer(n)){this.fire(new Et(new Error(`Layer "${n}" already exists on this map.`)));return}let a;if(e.type==="custom"){if(p1(this,rV(e)))return;a=Oy(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(n,e.source),e=da(e),e=pt(e,{source:n})),this._validate(Or.layer,`layers.${n}`,e,{arrayIndex:-1},r))return;a=Oy(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:n}})}let o=t?this._order.indexOf(t):this._order.length;if(t&&o===-1){this.fire(new Et(new Error(`Cannot add layer "${n}" before non-existing layer "${t}".`)));return}if(this._order.splice(o,0,n),this._layerOrderChanged=!0,this._layers[n]=a,this._removedLayers[n]&&a.source&&a.type!=="custom"){let s=this._removedLayers[n];delete this._removedLayers[n],s.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}moveLayer(e,t){if(this._checkLoaded(),this._changed=!0,!this._layers[e]){this.fire(new Et(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));return}if(e===t)return;let r=this._order.indexOf(e);this._order.splice(r,1);let n=t?this._order.indexOf(t):this._order.length;if(t&&n===-1){this.fire(new Et(new Error(`Cannot move layer "${e}" before non-existing layer "${t}".`)));return}this._order.splice(n,0,e),this._layerOrderChanged=!0}removeLayer(e){this._checkLoaded();let t=this._layers[e];if(!t){this.fire(new Et(new Error(`Cannot remove non-existing layer "${e}".`)));return}t.setEventedParent(null);let r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=t,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],t.onRemove&&t.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,t,r){this._checkLoaded();let n=this.getLayer(e);if(!n){this.fire(new Et(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)));return}n.minzoom===t&&n.maxzoom===r||(t!=null&&(n.minzoom=t),r!=null&&(n.maxzoom=r),this._updateLayer(n))}setFilter(e,t,r={}){this._checkLoaded();let n=this.getLayer(e);if(!n){this.fire(new Et(new Error(`Cannot filter non-existing layer "${e}".`)));return}if(!Cl(n.filter,t)){if(t==null){n.filter=void 0,this._updateLayer(n);return}this._validate(Or.filter,`layers.${n.id}.filter`,t,null,r)||(n.filter=da(t),this._updateLayer(n))}}getFilter(e){return da(this.getLayer(e).filter)}setLayoutProperty(e,t,r,n={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new Et(new Error(`Cannot style non-existing layer "${e}".`)));return}Cl(a.getLayoutProperty(t),r)||(a.setLayoutProperty(t,r,n),this._updateLayer(a))}getLayoutProperty(e,t){let r=this.getLayer(e);if(!r){this.fire(new Et(new Error(`Cannot get style of non-existing layer "${e}".`)));return}return r.getLayoutProperty(t)}setPaintProperty(e,t,r,n={}){this._checkLoaded();let a=this.getLayer(e);if(!a){this.fire(new Et(new Error(`Cannot style non-existing layer "${e}".`)));return}Cl(a.getPaintProperty(t),r)||(a.setPaintProperty(t,r,n)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null)}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,t){this._checkLoaded();let r=e.source,n=e.sourceLayer,a=this.sourceCaches[r];if(a===void 0){this.fire(new Et(new Error(`The source '${r}' does not exist in the map's style.`)));return}let o=a.getSource().type;if(o==="geojson"&&n){this.fire(new Et(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(o==="vector"&&!n){this.fire(new Et(new Error("The sourceLayer parameter must be provided for vector source types.")));return}e.id===void 0&&this.fire(new Et(new Error("The feature id parameter must be provided."))),a.setFeatureState(n,e.id,t)}removeFeatureState(e,t){this._checkLoaded();let r=e.source,n=this.sourceCaches[r];if(n===void 0){this.fire(new Et(new Error(`The source '${r}' does not exist in the map's style.`)));return}let a=n.getSource().type,o=a==="vector"?e.sourceLayer:void 0;if(a==="vector"&&!o){this.fire(new Et(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(t&&typeof e.id!="string"&&typeof e.id!="number"){this.fire(new Et(new Error("A feature id is required to remove its specific state property.")));return}n.removeFeatureState(o,e.id,t)}getFeatureState(e){this._checkLoaded();let t=e.source,r=e.sourceLayer,n=this.sourceCaches[t];if(n===void 0){this.fire(new Et(new Error(`The source '${t}' does not exist in the map's style.`)));return}if(n.getSource().type==="vector"&&!r){this.fire(new Et(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return e.id===void 0&&this.fire(new Et(new Error("The feature id parameter must be provided."))),n.getFeatureState(r,e.id)}getTransition(){return pt({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=Nx(this.sourceCaches,a=>a.serialize()),t=this._serializeByIds(this._order),r=this.map.getTerrain()||void 0,n=this.stylesheet;return OE({version:n.version,name:n.name,metadata:n.metadata,light:n.light,center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch,sprite:n.sprite,glyphs:n.glyphs,transition:n.transition,sources:e,layers:t,terrain:r},a=>a!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let t=h(o=>this._layers[o].type==="fill-extrusion","isLayer3D"),r={},n=[];for(let o=this._order.length-1;o>=0;o--){let s=this._order[o];if(t(s)){r[s]=o;for(let l of e){let u=l[s];if(u)for(let c of u)n.push(c)}}}n.sort((o,s)=>s.intersectionZ-o.intersectionZ);let a=[];for(let o=this._order.length-1;o>=0;o--){let s=this._order[o];if(t(s))for(let l=n.length-1;l>=0;l--){let u=n[l].feature;if(r[u.layer.id]<o)break;a.push(u),n.pop()}else for(let l of e){let u=l[s];if(u)for(let c of u)a.push(c.feature)}}return a}queryRenderedFeatures(e,t,r){t&&t.filter&&this._validate(Or.filter,"queryRenderedFeatures.filter",t.filter,null,t);let n={};if(t&&t.layers){if(!Array.isArray(t.layers))return this.fire(new Et(new Error("parameters.layers must be an Array."))),[];for(let s of t.layers){let l=this._layers[s];if(!l)return this.fire(new Et(new Error(`The layer '${s}' does not exist in the map's style and cannot be queried for features.`))),[];n[l.source]=!0}}let a=[];t.availableImages=this._availableImages;let o=this._serializedAllLayers();for(let s in this.sourceCaches)t.layers&&!n[s]||a.push(MV(this.sourceCaches[s],this._layers,o,e,t,r));return this.placement&&a.push(CV(this._layers,o,this.sourceCaches,e,t,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,t){t&&t.filter&&this._validate(Or.filter,"querySourceFeatures.filter",t.filter,null,t);let r=this.sourceCaches[e];return r?EV(r,t):[]}getLight(){return this.light.getLight()}setLight(e,t={}){this._checkLoaded();let r=this.light.getLight(),n=!1;for(let o in e)if(!Cl(e[o],r[o])){n=!0;break}if(!n)return;let a={now:li.now(),transition:pt({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,t),this.light.updateTransitions(a)}_validate(e,t,r,n,a={}){return a&&a.validate===!1?!1:p1(this,e.call(Or,pt({key:t,style:this.serialize(),value:r,styleSpec:Le},n)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Kp().off(H3,this._rtlPluginLoaded);for(let t in this._layers)this._layers[t].setEventedParent(null);for(let t in this.sourceCaches){let r=this.sourceCaches[t];r.setEventedParent(null),r.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let t in this.sourceCaches)this.sourceCaches[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,t,r,n,a=!1){let o=!1,s=!1,l={};for(let u of this._order){let c=this._layers[u];if(c.type!=="symbol")continue;if(!l[c.source]){let d=this.sourceCaches[c.source];l[c.source]=d.getRenderableIds(!0).map(m=>d.getTileByID(m)).sort((m,g)=>g.tileID.overscaledZ-m.tileID.overscaledZ||(m.tileID.isLessThan(g.tileID)?-1:1))}let p=this.crossTileSymbolIndex.addLayer(c,l[c.source],e.center.lng);o=o||p}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),a=a||this._layerOrderChanged||r===0,(a||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(li.now(),e.zoom))&&(this.pauseablePlacement=new afe(e,this.map.terrain,this._order,a,t,r,n,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(li.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(let u of this._order){let c=this._layers[u];c.type==="symbol"&&this.placement.updateLayerOpacities(c,l[c.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(li.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}async getImages(e,t){let r=await this.imageManager.getImages(t.icons);this._updateTilesForChangedImages();let n=this.sourceCaches[t.source];return n&&n.setDependencies(t.tileID.key,t.type,t.icons),r}async getGlyphs(e,t){let r=await this.glyphManager.getGlyphs(t.stacks),n=this.sourceCaches[t.source];return n&&n.setDependencies(t.tileID.key,t.type,[""]),r}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,t={}){this._checkLoaded(),!(e&&this._validate(Or.glyphs,"glyphs",e,null,t))&&(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,t,r={},n){this._checkLoaded();let a=[{id:e,url:t}],o=[...pm(this.stylesheet.sprite),...a];this._validate(Or.sprite,"sprite",o,null,r)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,n))}removeSprite(e){this._checkLoaded();let t=pm(this.stylesheet.sprite);if(!t.find(r=>r.id===e)){this.fire(new Et(new Error(`Sprite "${e}" doesn't exists on this map.`)));return}if(this._spritesImagesIds[e])for(let r of this._spritesImagesIds[e])this.imageManager.removeImage(r),this._changedImages[r]=!0;t.splice(t.findIndex(r=>r.id===e),1),this.stylesheet.sprite=t.length>0?t:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new Ye("data",{dataType:"style"}))}getSprite(){return pm(this.stylesheet.sprite)}setSprite(e,t={},r){this._checkLoaded(),!(e&&this._validate(Or.sprite,"sprite",e,null,t))&&(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,r):(this._unloadSprite(),r&&r(null)))}};h(Nj,"Style");var D6=Nj;R();R();var F2=Yi([{name:"a_pos",type:"Int16",components:2}]);R();R();var pfe=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`;R();var dfe=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`;R();var ffe=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var mfe="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";R();var gfe=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var yfe="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}";R();var vfe=`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var xfe=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`;R();var _fe="void main() {gl_FragColor=vec4(1.0);}";R();var bfe="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}";R();var wfe=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Sfe=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`;R();var Mfe=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`;R();var Cfe="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}";R();var Efe="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}";R();var Tfe="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}";R();var Pfe="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}";R();var Afe="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}";R();var Ife="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}";R();var Lfe="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}";R();var Dfe=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var kfe=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`;R();var Rfe=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Ffe=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;R();var Ofe=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Bfe=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`;R();var zfe=`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Nfe=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`;R();var $fe=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Ufe=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`;R();var Vfe=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var jfe=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`;R();var Hfe=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Gfe="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}";R();var Wfe=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Xfe="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}";R();var qfe=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Zfe=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;R();var Yfe=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Jfe=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`;R();var Kfe=`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var Qfe=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`;R();var eme=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var tme=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`;R();var ime=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var rme="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}";R();var nme=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var ame=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`;R();var ome=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var sme=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`;R();var lme=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`;R();var ume=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`;R();var hme="varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}";R();var cme="precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}";R();var pme="uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}";R();var O2="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}",Sf={prelude:xi(pfe,dfe),background:xi(ffe,mfe),backgroundPattern:xi(gfe,yfe),circle:xi(vfe,xfe),clippingMask:xi(_fe,bfe),heatmap:xi(wfe,Sfe),heatmapTexture:xi(Mfe,Cfe),collisionBox:xi(Efe,Tfe),collisionCircle:xi(Pfe,Afe),debug:xi(Ife,Lfe),fill:xi(Dfe,kfe),fillOutline:xi(Rfe,Ffe),fillOutlinePattern:xi(Ofe,Bfe),fillPattern:xi(zfe,Nfe),fillExtrusion:xi($fe,Ufe),fillExtrusionPattern:xi(Vfe,jfe),hillshadePrepare:xi(Hfe,Gfe),hillshade:xi(Wfe,Xfe),line:xi(qfe,Zfe),lineGradient:xi(Yfe,Jfe),linePattern:xi(Kfe,Qfe),lineSDF:xi(eme,tme),raster:xi(ime,rme),symbolIcon:xi(nme,ame),symbolSDF:xi(ome,sme),symbolTextAndIcon:xi(lme,ume),terrain:xi(pme,O2),terrainDepth:xi(hme,O2),terrainCoords:xi(cme,O2)};function xi(i,e){let t=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=e.match(/attribute ([\w]+) ([\w]+)/g),n=i.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(n):n,s={};return i=i.replace(t,(l,u,c,p,d)=>(s[d]=!0,u==="define"?`
#ifndef HAS_UNIFORM_u_${d}
varying ${c} ${p} ${d};
#else
uniform ${c} ${p} u_${d};
#endif
`:`
#ifdef HAS_UNIFORM_u_${d}
    ${c} ${p} ${d} = u_${d};
#endif
`)),e=e.replace(t,(l,u,c,p,d)=>{let m=p==="float"?"vec2":"vec4",g=d.match(/color/)?"color":m;return s[d]?u==="define"?`
#ifndef HAS_UNIFORM_u_${d}
uniform lowp float u_${d}_t;
attribute ${c} ${m} a_${d};
varying ${c} ${p} ${d};
#else
uniform ${c} ${p} u_${d};
#endif
`:g==="vec4"?`
#ifndef HAS_UNIFORM_u_${d}
    ${d} = a_${d};
#else
    ${c} ${p} ${d} = u_${d};
#endif
`:`
#ifndef HAS_UNIFORM_u_${d}
    ${d} = unpack_mix_${g}(a_${d}, u_${d}_t);
#else
    ${c} ${p} ${d} = u_${d};
#endif
`:u==="define"?`
#ifndef HAS_UNIFORM_u_${d}
uniform lowp float u_${d}_t;
attribute ${c} ${m} a_${d};
#else
uniform ${c} ${p} u_${d};
#endif
`:g==="vec4"?`
#ifndef HAS_UNIFORM_u_${d}
    ${c} ${p} ${d} = a_${d};
#else
    ${c} ${p} ${d} = u_${d};
#endif
`:`
#ifndef HAS_UNIFORM_u_${d}
    ${c} ${p} ${d} = unpack_mix_${g}(a_${d}, u_${d}_t);
#else
    ${c} ${p} ${d} = u_${d};
#endif
`}),{fragmentSource:i,vertexSource:e,staticAttributes:r,staticUniforms:o}}h(xi,"compile");R();R();var $j=class{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,r,n,a,o,s,l,u){this.context=e;let c=this.boundPaintVertexBuffers.length!==n.length;for(let p=0;!c&&p<n.length;p++)this.boundPaintVertexBuffers[p]!==n[p]&&(c=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==r||c||this.boundIndexBuffer!==a||this.boundVertexOffset!==o||this.boundDynamicVertexBuffer!==s||this.boundDynamicVertexBuffer2!==l||this.boundDynamicVertexBuffer3!==u?this.freshBind(t,r,n,a,o,s,l,u):(e.bindVertexArray.set(this.vao),s&&s.bind(),a&&a.dynamicDraw&&a.bind(),l&&l.bind(),u&&u.bind())}freshBind(e,t,r,n,a,o,s,l){let u=e.numAttributes,c=this.context,p=c.gl;this.vao&&this.destroy(),this.vao=c.createVertexArray(),c.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=a,this.boundDynamicVertexBuffer=o,this.boundDynamicVertexBuffer2=s,this.boundDynamicVertexBuffer3=l,t.enableAttributes(p,e);for(let d of r)d.enableAttributes(p,e);o&&o.enableAttributes(p,e),s&&s.enableAttributes(p,e),l&&l.enableAttributes(p,e),t.bind(),t.setVertexAttribPointers(p,e,a);for(let d of r)d.bind(),d.setVertexAttribPointers(p,e,a);o&&(o.bind(),o.setVertexAttribPointers(p,e,a)),n&&n.bind(),s&&(s.bind(),s.setVertexAttribPointers(p,e,a)),l&&(l.bind(),l.setVertexAttribPointers(p,e,a)),c.currentNumAttributes=u}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}};h($j,"VertexArrayObject");var dme=$j;R();var fme=h((i,e)=>({u_depth:new Kt(i,e.u_depth),u_terrain:new Kt(i,e.u_terrain),u_terrain_dim:new ot(i,e.u_terrain_dim),u_terrain_matrix:new ui(i,e.u_terrain_matrix),u_terrain_unpack:new Z4(i,e.u_terrain_unpack),u_terrain_exaggeration:new ot(i,e.u_terrain_exaggeration)}),"terrainPreludeUniforms"),mme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_texture:new Kt(i,e.u_texture),u_ele_delta:new ot(i,e.u_ele_delta)}),"terrainUniforms"),gme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_ele_delta:new ot(i,e.u_ele_delta)}),"terrainDepthUniforms"),yme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_texture:new Kt(i,e.u_texture),u_terrain_coords_id:new ot(i,e.u_terrain_coords_id),u_ele_delta:new ot(i,e.u_ele_delta)}),"terrainCoordsUniforms"),vme=h((i,e)=>({u_matrix:i,u_texture:0,u_ele_delta:e}),"terrainUniformValues"),xme=h((i,e)=>({u_matrix:i,u_ele_delta:e}),"terrainDepthUniformValues"),_me=h((i,e,t)=>({u_matrix:i,u_terrain_coords_id:e/255,u_texture:0,u_ele_delta:t}),"terrainCoordsUniformValues");function $y(i){let e=[];for(let t=0;t<i.length;t++){if(i[t]===null)continue;let r=i[t].split(" ");e.push(r.pop())}return e}h($y,"getTokenizedAttributesAndUniforms");var Uj=class{constructor(e,t,r,n,a,o){let s=e.gl;this.program=s.createProgram();let l=$y(t.staticAttributes),u=r?r.getBinderAttributes():[],c=l.concat(u),p=Sf.prelude.staticUniforms?$y(Sf.prelude.staticUniforms):[],d=t.staticUniforms?$y(t.staticUniforms):[],m=r?r.getBinderUniforms():[],g=p.concat(d).concat(m),_=[];for(let T of g)_.indexOf(T)<0&&_.push(T);let y=r?r.defines():[];a&&y.push("#define OVERDRAW_INSPECTOR;"),o&&y.push("#define TERRAIN3D;");let x=y.concat(Sf.prelude.fragmentSource,t.fragmentSource).join(`
`),w=y.concat(Sf.prelude.vertexSource,t.vertexSource).join(`
`),b=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost()){this.failedToCreate=!0;return}if(s.shaderSource(b,x),s.compileShader(b),!s.getShaderParameter(b,s.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${s.getShaderInfoLog(b)}`);s.attachShader(this.program,b);let C=s.createShader(s.VERTEX_SHADER);if(s.isContextLost()){this.failedToCreate=!0;return}if(s.shaderSource(C,w),s.compileShader(C),!s.getShaderParameter(C,s.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${s.getShaderInfoLog(C)}`);s.attachShader(this.program,C),this.attributes={};let E={};this.numAttributes=c.length;for(let T=0;T<this.numAttributes;T++)c[T]&&(s.bindAttribLocation(this.program,T,c[T]),this.attributes[c[T]]=T);if(s.linkProgram(this.program),!s.getProgramParameter(this.program,s.LINK_STATUS))throw new Error(`Program failed to link: ${s.getProgramInfoLog(this.program)}`);s.deleteShader(C),s.deleteShader(b);for(let T=0;T<_.length;T++){let L=_[T];if(L&&!E[L]){let D=s.getUniformLocation(this.program,L);D&&(E[L]=D)}}this.fixedUniforms=n(e,E),this.terrainUniforms=fme(e,E),this.binderUniforms=r?r.getUniforms(e,E):[]}draw(e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y,x,w){let b=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(a),e.setCullFace(o),l){e.activeTexture.set(b.TEXTURE2),b.bindTexture(b.TEXTURE_2D,l.depthTexture),e.activeTexture.set(b.TEXTURE3),b.bindTexture(b.TEXTURE_2D,l.texture);for(let E in this.terrainUniforms)this.terrainUniforms[E].set(l[E])}for(let E in this.fixedUniforms)this.fixedUniforms[E].set(s[E]);_&&_.setUniforms(e,this.binderUniforms,m,{zoom:g});let C=0;switch(t){case b.LINES:C=2;break;case b.TRIANGLES:C=3;break;case b.LINE_STRIP:C=1;break}for(let E of d.get()){let T=E.vaos||(E.vaos={});(T[u]||(T[u]=new dme)).bind(e,this,c,_?_.getPaintVertexBuffers():[],p,E.vertexOffset,y,x,w),b.drawElements(t,E.primitiveLength*C,b.UNSIGNED_SHORT,E.primitiveOffset*C*2)}}};h(Uj,"Program");var bme=Uj;R();R();R();function rT(i,e,t){let r=1/ta(t,1,e.transform.tileZoom),n=Math.pow(2,t.tileID.overscaledZ),a=t.tileSize*Math.pow(2,e.transform.tileZoom)/n,o=a*(t.tileID.canonical.x+t.tileID.wrap*n),s=a*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_scale:[r,i.fromScale,i.toScale],u_fade:i.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[o&65535,s&65535]}}h(rT,"patternUniformValues");function Vj(i,e,t,r){let n=t.imageManager.getPattern(i.from.toString()),a=t.imageManager.getPattern(i.to.toString()),{width:o,height:s}=t.imageManager.getPixelSize(),l=Math.pow(2,r.tileID.overscaledZ),u=r.tileSize*Math.pow(2,t.transform.tileZoom)/l,c=u*(r.tileID.canonical.x+r.tileID.wrap*l),p=u*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:n.tl,u_pattern_br_a:n.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,s],u_mix:e.t,u_pattern_size_a:n.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:e.fromScale,u_scale_b:e.toScale,u_tile_units_to_pixels:1/ta(r,1,t.transform.tileZoom),u_pixel_coord_upper:[c>>16,p>>16],u_pixel_coord_lower:[c&65535,p&65535]}}h(Vj,"bgPatternUniformValues");var wme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_lightpos:new Rs(i,e.u_lightpos),u_lightintensity:new ot(i,e.u_lightintensity),u_lightcolor:new Rs(i,e.u_lightcolor),u_vertical_gradient:new ot(i,e.u_vertical_gradient),u_opacity:new ot(i,e.u_opacity)}),"fillExtrusionUniforms"),Sme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_lightpos:new Rs(i,e.u_lightpos),u_lightintensity:new ot(i,e.u_lightintensity),u_lightcolor:new Rs(i,e.u_lightcolor),u_vertical_gradient:new ot(i,e.u_vertical_gradient),u_height_factor:new ot(i,e.u_height_factor),u_image:new Kt(i,e.u_image),u_texsize:new ii(i,e.u_texsize),u_pixel_coord_upper:new ii(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new ii(i,e.u_pixel_coord_lower),u_scale:new Rs(i,e.u_scale),u_fade:new ot(i,e.u_fade),u_opacity:new ot(i,e.u_opacity)}),"fillExtrusionPatternUniforms"),jj=h((i,e,t,r)=>{let n=e.style.light,a=n.properties.get("position"),o=[a.x,a.y,a.z],s=A3.create();n.properties.get("anchor")==="viewport"&&A3.fromRotation(s,-e.transform.angle),yo.transformMat3(o,o,s);let l=n.properties.get("color");return{u_matrix:i,u_lightpos:o,u_lightintensity:n.properties.get("intensity"),u_lightcolor:[l.r,l.g,l.b],u_vertical_gradient:+t,u_opacity:r}},"fillExtrusionUniformValues"),Mme=h((i,e,t,r,n,a,o)=>pt(jj(i,e,t,r),rT(a,e,o),{u_height_factor:-Math.pow(2,n.overscaledZ)/o.tileSize/8}),"fillExtrusionPatternUniformValues");R();var Cme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix)}),"fillUniforms"),Eme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_image:new Kt(i,e.u_image),u_texsize:new ii(i,e.u_texsize),u_pixel_coord_upper:new ii(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new ii(i,e.u_pixel_coord_lower),u_scale:new Rs(i,e.u_scale),u_fade:new ot(i,e.u_fade)}),"fillPatternUniforms"),Tme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_world:new ii(i,e.u_world)}),"fillOutlineUniforms"),Pme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_world:new ii(i,e.u_world),u_image:new Kt(i,e.u_image),u_texsize:new ii(i,e.u_texsize),u_pixel_coord_upper:new ii(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new ii(i,e.u_pixel_coord_lower),u_scale:new Rs(i,e.u_scale),u_fade:new ot(i,e.u_fade)}),"fillOutlinePatternUniforms"),Hj=h(i=>({u_matrix:i}),"fillUniformValues"),Gj=h((i,e,t,r)=>pt(Hj(i),rT(t,e,r)),"fillPatternUniformValues"),Ame=h((i,e)=>({u_matrix:i,u_world:e}),"fillOutlineUniformValues"),Ime=h((i,e,t,r,n)=>pt(Gj(i,e,t,r),{u_world:n}),"fillOutlinePatternUniformValues");R();var Lme=h((i,e)=>({u_camera_to_center_distance:new ot(i,e.u_camera_to_center_distance),u_scale_with_map:new Kt(i,e.u_scale_with_map),u_pitch_with_map:new Kt(i,e.u_pitch_with_map),u_extrude_scale:new ii(i,e.u_extrude_scale),u_device_pixel_ratio:new ot(i,e.u_device_pixel_ratio),u_matrix:new ui(i,e.u_matrix)}),"circleUniforms"),Dme=h((i,e,t,r)=>{let n=i.transform,a,o;if(r.paint.get("circle-pitch-alignment")==="map"){let s=ta(t,1,n.zoom);a=!0,o=[s,s]}else a=!1,o=n.pixelsToGLUnits;return{u_camera_to_center_distance:n.cameraToCenterDistance,u_scale_with_map:+(r.paint.get("circle-pitch-scale")==="map"),u_matrix:i.translatePosMatrix(e.posMatrix,t,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:i.pixelRatio,u_extrude_scale:o}},"circleUniformValues");R();var kme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_camera_to_center_distance:new ot(i,e.u_camera_to_center_distance),u_pixels_to_tile_units:new ot(i,e.u_pixels_to_tile_units),u_extrude_scale:new ii(i,e.u_extrude_scale),u_overscale_factor:new ot(i,e.u_overscale_factor)}),"collisionUniforms"),Rme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_inv_matrix:new ui(i,e.u_inv_matrix),u_camera_to_center_distance:new ot(i,e.u_camera_to_center_distance),u_viewport_size:new ii(i,e.u_viewport_size)}),"collisionCircleUniforms"),Fme=h((i,e,t)=>{let r=ta(t,1,e.zoom),n=Math.pow(2,e.zoom-t.tileID.overscaledZ),a=t.tileID.overscaleFactor();return{u_matrix:i,u_camera_to_center_distance:e.cameraToCenterDistance,u_pixels_to_tile_units:r,u_extrude_scale:[e.pixelsToGLUnits[0]/(r*n),e.pixelsToGLUnits[1]/(r*n)],u_overscale_factor:a}},"collisionUniformValues"),Ome=h((i,e,t)=>({u_matrix:i,u_inv_matrix:e,u_camera_to_center_distance:t.cameraToCenterDistance,u_viewport_size:[t.width,t.height]}),"collisionCircleUniformValues");R();var Bme=h((i,e)=>({u_color:new Mp(i,e.u_color),u_matrix:new ui(i,e.u_matrix),u_overlay:new Kt(i,e.u_overlay),u_overlay_scale:new ot(i,e.u_overlay_scale)}),"debugUniforms"),k6=h((i,e,t=1)=>({u_matrix:i,u_color:e,u_overlay:0,u_overlay_scale:t}),"debugUniformValues");R();var zme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix)}),"clippingMaskUniforms"),R6=h(i=>({u_matrix:i}),"clippingMaskUniformValues");R();var Nme=h((i,e)=>({u_extrude_scale:new ot(i,e.u_extrude_scale),u_intensity:new ot(i,e.u_intensity),u_matrix:new ui(i,e.u_matrix)}),"heatmapUniforms"),$me=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_world:new ii(i,e.u_world),u_image:new Kt(i,e.u_image),u_color_ramp:new Kt(i,e.u_color_ramp),u_opacity:new ot(i,e.u_opacity)}),"heatmapTextureUniforms"),Ume=h((i,e,t,r)=>({u_matrix:i,u_extrude_scale:ta(e,1,t),u_intensity:r}),"heatmapUniformValues"),Vme=h((i,e,t,r)=>{let n=ht.create();ht.ortho(n,0,i.width,i.height,0,0,1);let a=i.context.gl;return{u_matrix:n,u_world:[a.drawingBufferWidth,a.drawingBufferHeight],u_image:t,u_color_ramp:r,u_opacity:e.paint.get("heatmap-opacity")}},"heatmapTextureUniformValues");R();var jme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_image:new Kt(i,e.u_image),u_latrange:new ii(i,e.u_latrange),u_light:new ii(i,e.u_light),u_shadow:new Mp(i,e.u_shadow),u_highlight:new Mp(i,e.u_highlight),u_accent:new Mp(i,e.u_accent)}),"hillshadeUniforms"),Hme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_image:new Kt(i,e.u_image),u_dimension:new ii(i,e.u_dimension),u_zoom:new ot(i,e.u_zoom),u_unpack:new Z4(i,e.u_unpack)}),"hillshadePrepareUniforms"),Gme=h((i,e,t,r)=>{let n=t.paint.get("hillshade-shadow-color"),a=t.paint.get("hillshade-highlight-color"),o=t.paint.get("hillshade-accent-color"),s=t.paint.get("hillshade-illumination-direction")*(Math.PI/180);t.paint.get("hillshade-illumination-anchor")==="viewport"&&(s-=i.transform.angle);let l=!i.options.moving;return{u_matrix:r?r.posMatrix:i.transform.calculatePosMatrix(e.tileID.toUnwrapped(),l),u_image:0,u_latrange:Wj(i,e.tileID),u_light:[t.paint.get("hillshade-exaggeration"),s],u_shadow:n,u_highlight:a,u_accent:o}},"hillshadeUniformValues"),Wme=h((i,e)=>{let t=e.stride,r=ht.create();return ht.ortho(r,0,8192,-8192,0,0,1),ht.translate(r,r,[0,-8192,0]),{u_matrix:r,u_image:1,u_dimension:[t,t],u_zoom:i.overscaledZ,u_unpack:e.getUnpackVector()}},"hillshadeUniformPrepareValues");function Wj(i,e){let t=Math.pow(2,e.canonical.z),r=e.canonical.y;return[new Qr(0,r/t).toLngLat().lat,new Qr(0,(r+1)/t).toLngLat().lat]}h(Wj,"getTileLatRange");R();var Xme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_ratio:new ot(i,e.u_ratio),u_device_pixel_ratio:new ot(i,e.u_device_pixel_ratio),u_units_to_pixels:new ii(i,e.u_units_to_pixels)}),"lineUniforms"),qme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_ratio:new ot(i,e.u_ratio),u_device_pixel_ratio:new ot(i,e.u_device_pixel_ratio),u_units_to_pixels:new ii(i,e.u_units_to_pixels),u_image:new Kt(i,e.u_image),u_image_height:new ot(i,e.u_image_height)}),"lineGradientUniforms"),Zme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_texsize:new ii(i,e.u_texsize),u_ratio:new ot(i,e.u_ratio),u_device_pixel_ratio:new ot(i,e.u_device_pixel_ratio),u_image:new Kt(i,e.u_image),u_units_to_pixels:new ii(i,e.u_units_to_pixels),u_scale:new Rs(i,e.u_scale),u_fade:new ot(i,e.u_fade)}),"linePatternUniforms"),Yme=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_ratio:new ot(i,e.u_ratio),u_device_pixel_ratio:new ot(i,e.u_device_pixel_ratio),u_units_to_pixels:new ii(i,e.u_units_to_pixels),u_patternscale_a:new ii(i,e.u_patternscale_a),u_patternscale_b:new ii(i,e.u_patternscale_b),u_sdfgamma:new ot(i,e.u_sdfgamma),u_image:new Kt(i,e.u_image),u_tex_y_a:new ot(i,e.u_tex_y_a),u_tex_y_b:new ot(i,e.u_tex_y_b),u_mix:new ot(i,e.u_mix)}),"lineSDFUniforms"),nT=h((i,e,t,r)=>{let n=i.transform;return{u_matrix:oT(i,e,t,r),u_ratio:1/ta(e,1,n.zoom),u_device_pixel_ratio:i.pixelRatio,u_units_to_pixels:[1/n.pixelsToGLUnits[0],1/n.pixelsToGLUnits[1]]}},"lineUniformValues"),Jme=h((i,e,t,r,n)=>pt(nT(i,e,t,n),{u_image:0,u_image_height:r}),"lineGradientUniformValues"),Kme=h((i,e,t,r,n)=>{let a=i.transform,o=aT(e,a);return{u_matrix:oT(i,e,t,n),u_texsize:e.imageAtlasTexture.size,u_ratio:1/ta(e,1,a.zoom),u_device_pixel_ratio:i.pixelRatio,u_image:0,u_scale:[o,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},"linePatternUniformValues"),Qme=h((i,e,t,r,n,a)=>{let o=i.transform,s=i.lineAtlas,l=aT(e,o),u=t.layout.get("line-cap")==="round",c=s.getDash(r.from,u),p=s.getDash(r.to,u),d=c.width*n.fromScale,m=p.width*n.toScale;return pt(nT(i,e,t,a),{u_patternscale_a:[l/d,-c.height/2],u_patternscale_b:[l/m,-p.height/2],u_sdfgamma:s.width/(Math.min(d,m)*256*i.pixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:p.y,u_mix:n.t})},"lineSDFUniformValues");function aT(i,e){return 1/ta(i,1,e.tileZoom)}h(aT,"calculateTileRatio");function oT(i,e,t,r){return i.translatePosMatrix(r?r.posMatrix:e.tileID.posMatrix,e,t.paint.get("line-translate"),t.paint.get("line-translate-anchor"))}h(oT,"calculateMatrix");R();var ege=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_tl_parent:new ii(i,e.u_tl_parent),u_scale_parent:new ot(i,e.u_scale_parent),u_buffer_scale:new ot(i,e.u_buffer_scale),u_fade_t:new ot(i,e.u_fade_t),u_opacity:new ot(i,e.u_opacity),u_image0:new Kt(i,e.u_image0),u_image1:new Kt(i,e.u_image1),u_brightness_low:new ot(i,e.u_brightness_low),u_brightness_high:new ot(i,e.u_brightness_high),u_saturation_factor:new ot(i,e.u_saturation_factor),u_contrast_factor:new ot(i,e.u_contrast_factor),u_spin_weights:new Rs(i,e.u_spin_weights)}),"rasterUniforms"),tge=h((i,e,t,r,n)=>({u_matrix:i,u_tl_parent:e,u_scale_parent:t,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*n.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:n.paint.get("raster-brightness-min"),u_brightness_high:n.paint.get("raster-brightness-max"),u_saturation_factor:Zj(n.paint.get("raster-saturation")),u_contrast_factor:qj(n.paint.get("raster-contrast")),u_spin_weights:Xj(n.paint.get("raster-hue-rotate"))}),"rasterUniformValues");function Xj(i){i*=Math.PI/180;let e=Math.sin(i),t=Math.cos(i);return[(2*t+1)/3,(-Math.sqrt(3)*e-t+1)/3,(Math.sqrt(3)*e-t+1)/3]}h(Xj,"spinWeights");function qj(i){return i>0?1/(1-i):1+i}h(qj,"contrastFactor");function Zj(i){return i>0?1-1/(1.001-i):-i}h(Zj,"saturationFactor");R();var ige=h((i,e)=>({u_is_size_zoom_constant:new Kt(i,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Kt(i,e.u_is_size_feature_constant),u_size_t:new ot(i,e.u_size_t),u_size:new ot(i,e.u_size),u_camera_to_center_distance:new ot(i,e.u_camera_to_center_distance),u_pitch:new ot(i,e.u_pitch),u_rotate_symbol:new Kt(i,e.u_rotate_symbol),u_aspect_ratio:new ot(i,e.u_aspect_ratio),u_fade_change:new ot(i,e.u_fade_change),u_matrix:new ui(i,e.u_matrix),u_label_plane_matrix:new ui(i,e.u_label_plane_matrix),u_coord_matrix:new ui(i,e.u_coord_matrix),u_is_text:new Kt(i,e.u_is_text),u_pitch_with_map:new Kt(i,e.u_pitch_with_map),u_texsize:new ii(i,e.u_texsize),u_texture:new Kt(i,e.u_texture)}),"symbolIconUniforms"),rge=h((i,e)=>({u_is_size_zoom_constant:new Kt(i,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Kt(i,e.u_is_size_feature_constant),u_size_t:new ot(i,e.u_size_t),u_size:new ot(i,e.u_size),u_camera_to_center_distance:new ot(i,e.u_camera_to_center_distance),u_pitch:new ot(i,e.u_pitch),u_rotate_symbol:new Kt(i,e.u_rotate_symbol),u_aspect_ratio:new ot(i,e.u_aspect_ratio),u_fade_change:new ot(i,e.u_fade_change),u_matrix:new ui(i,e.u_matrix),u_label_plane_matrix:new ui(i,e.u_label_plane_matrix),u_coord_matrix:new ui(i,e.u_coord_matrix),u_is_text:new Kt(i,e.u_is_text),u_pitch_with_map:new Kt(i,e.u_pitch_with_map),u_texsize:new ii(i,e.u_texsize),u_texture:new Kt(i,e.u_texture),u_gamma_scale:new ot(i,e.u_gamma_scale),u_device_pixel_ratio:new ot(i,e.u_device_pixel_ratio),u_is_halo:new Kt(i,e.u_is_halo)}),"symbolSDFUniforms"),nge=h((i,e)=>({u_is_size_zoom_constant:new Kt(i,e.u_is_size_zoom_constant),u_is_size_feature_constant:new Kt(i,e.u_is_size_feature_constant),u_size_t:new ot(i,e.u_size_t),u_size:new ot(i,e.u_size),u_camera_to_center_distance:new ot(i,e.u_camera_to_center_distance),u_pitch:new ot(i,e.u_pitch),u_rotate_symbol:new Kt(i,e.u_rotate_symbol),u_aspect_ratio:new ot(i,e.u_aspect_ratio),u_fade_change:new ot(i,e.u_fade_change),u_matrix:new ui(i,e.u_matrix),u_label_plane_matrix:new ui(i,e.u_label_plane_matrix),u_coord_matrix:new ui(i,e.u_coord_matrix),u_is_text:new Kt(i,e.u_is_text),u_pitch_with_map:new Kt(i,e.u_pitch_with_map),u_texsize:new ii(i,e.u_texsize),u_texsize_icon:new ii(i,e.u_texsize_icon),u_texture:new Kt(i,e.u_texture),u_texture_icon:new Kt(i,e.u_texture_icon),u_gamma_scale:new ot(i,e.u_gamma_scale),u_device_pixel_ratio:new ot(i,e.u_device_pixel_ratio),u_is_halo:new Kt(i,e.u_is_halo)}),"symbolTextAndIconUniforms"),Yj=h((i,e,t,r,n,a,o,s,l,u)=>{let c=n.transform;return{u_is_size_zoom_constant:+(i==="constant"||i==="source"),u_is_size_feature_constant:+(i==="constant"||i==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:c.cameraToCenterDistance,u_pitch:c.pitch/360*2*Math.PI,u_rotate_symbol:+t,u_aspect_ratio:c.width/c.height,u_fade_change:n.options.fadeDuration?n.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:o,u_coord_matrix:s,u_is_text:+l,u_pitch_with_map:+r,u_texsize:u,u_texture:0}},"symbolIconUniformValues"),Jj=h((i,e,t,r,n,a,o,s,l,u,c)=>{let p=n.transform;return pt(Yj(i,e,t,r,n,a,o,s,l,u),{u_gamma_scale:r?Math.cos(p._pitch)*p.cameraToCenterDistance:1,u_device_pixel_ratio:n.pixelRatio,u_is_halo:+c})},"symbolSDFUniformValues"),age=h((i,e,t,r,n,a,o,s,l,u)=>pt(Jj(i,e,t,r,n,a,o,s,!0,l,!0),{u_texsize_icon:u,u_texture_icon:1}),"symbolTextAndIconUniformValues");R();var oge=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_opacity:new ot(i,e.u_opacity),u_color:new Mp(i,e.u_color)}),"backgroundUniforms"),sge=h((i,e)=>({u_matrix:new ui(i,e.u_matrix),u_opacity:new ot(i,e.u_opacity),u_image:new Kt(i,e.u_image),u_pattern_tl_a:new ii(i,e.u_pattern_tl_a),u_pattern_br_a:new ii(i,e.u_pattern_br_a),u_pattern_tl_b:new ii(i,e.u_pattern_tl_b),u_pattern_br_b:new ii(i,e.u_pattern_br_b),u_texsize:new ii(i,e.u_texsize),u_mix:new ot(i,e.u_mix),u_pattern_size_a:new ii(i,e.u_pattern_size_a),u_pattern_size_b:new ii(i,e.u_pattern_size_b),u_scale_a:new ot(i,e.u_scale_a),u_scale_b:new ot(i,e.u_scale_b),u_pixel_coord_upper:new ii(i,e.u_pixel_coord_upper),u_pixel_coord_lower:new ii(i,e.u_pixel_coord_lower),u_tile_units_to_pixels:new ot(i,e.u_tile_units_to_pixels)}),"backgroundPatternUniforms"),lge=h((i,e,t)=>({u_matrix:i,u_opacity:e,u_color:t}),"backgroundUniformValues"),uge=h((i,e,t,r,n,a)=>pt(Vj(r,a,t,n),{u_matrix:i,u_opacity:e}),"backgroundPatternUniformValues"),hge={fillExtrusion:wme,fillExtrusionPattern:Sme,fill:Cme,fillPattern:Eme,fillOutline:Tme,fillOutlinePattern:Pme,circle:Lme,collisionBox:kme,collisionCircle:Rme,debug:Bme,clippingMask:zme,heatmap:Nme,heatmapTexture:$me,hillshade:jme,hillshadePrepare:Hme,line:Xme,lineGradient:qme,linePattern:Zme,lineSDF:Yme,raster:ege,symbolIcon:ige,symbolSDF:rge,symbolTextAndIcon:nge,background:oge,backgroundPattern:sge,terrain:mme,terrainDepth:gme,terrainCoords:yme};R();R();var Kj=class{constructor(e,t,r){this.context=e;let n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=!!r,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){let t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};h(Kj,"IndexBuffer");var cge=Kj;R();var pge={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Qj=class{constructor(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;let a=e.gl;this.buffer=a.createBuffer(),e.bindVertexBuffer.set(this.buffer),a.bufferData(a.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?a.DYNAMIC_DRAW:a.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);let t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let r=0;r<this.attributes.length;r++){let n=this.attributes[r],a=t.attributes[n.name];a!==void 0&&e.enableVertexAttribArray(a)}}setVertexAttribPointers(e,t,r){for(let n=0;n<this.attributes.length;n++){let a=this.attributes[n],o=t.attributes[a.name];o!==void 0&&e.vertexAttribPointer(o,a.components,e[pge[a.type]],!1,this.itemSize,a.offset+this.itemSize*(r||0))}}destroy(){let e=this.context.gl;this.buffer&&(e.deleteBuffer(this.buffer),delete this.buffer)}};h(Qj,"VertexBuffer");var dge=Qj;R();R();R();var B2=new WeakMap;function fm(i){var e;if(B2.has(i))return B2.get(i);{let t=(e=i.getParameter(i.VERSION))==null?void 0:e.startsWith("WebGL 2.0");return B2.set(i,t),t}}h(fm,"isWebGL2");var eH=class{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}};h(eH,"BaseValue");var yi=eH,tH=class extends yi{getDefault(){return zt.transparent}set(e){let t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};h(tH,"ClearColor");var fge=tH,iH=class extends yi{getDefault(){return 1}set(e){e===this.current&&!this.dirty||(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}};h(iH,"ClearDepth");var mge=iH,rH=class extends yi{getDefault(){return 0}set(e){e===this.current&&!this.dirty||(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}};h(rH,"ClearStencil");var gge=rH,nH=class extends yi{getDefault(){return[!0,!0,!0,!0]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};h(nH,"ColorMask");var yge=nH,aH=class extends yi{getDefault(){return!0}set(e){e===this.current&&!this.dirty||(this.gl.depthMask(e),this.current=e,this.dirty=!1)}};h(aH,"DepthMask");var vge=aH,oH=class extends yi{getDefault(){return 255}set(e){e===this.current&&!this.dirty||(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}};h(oH,"StencilMask");var xge=oH,sH=class extends yi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){let t=this.current;e.func===t.func&&e.ref===t.ref&&e.mask===t.mask&&!this.dirty||(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}};h(sH,"StencilFunc");var _ge=sH,lH=class extends yi{getDefault(){let e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&!this.dirty||(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}};h(lH,"StencilOp");var bge=lH,uH=class extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}};h(uH,"StencilTest");var wge=uH,hH=class extends yi{getDefault(){return[0,1]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}};h(hH,"DepthRange");var Sge=hH,cH=class extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}};h(cH,"DepthTest");var Mge=cH,pH=class extends yi{getDefault(){return this.gl.LESS}set(e){e===this.current&&!this.dirty||(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}};h(pH,"DepthFunc");var Cge=pH,dH=class extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}};h(dH,"Blend");var Ege=dH,fH=class extends yi{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&!this.dirty||(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}};h(fH,"BlendFunc");var Tge=fH,mH=class extends yi{getDefault(){return zt.transparent}set(e){let t=this.current;e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a&&!this.dirty||(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}};h(mH,"BlendColor");var Pge=mH,gH=class extends yi{getDefault(){return this.gl.FUNC_ADD}set(e){e===this.current&&!this.dirty||(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}};h(gH,"BlendEquation");var Age=gH,yH=class extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}};h(yH,"CullFace");var Ige=yH,vH=class extends yi{getDefault(){return this.gl.BACK}set(e){e===this.current&&!this.dirty||(this.gl.cullFace(e),this.current=e,this.dirty=!1)}};h(vH,"CullFaceSide");var Lge=vH,xH=class extends yi{getDefault(){return this.gl.CCW}set(e){e===this.current&&!this.dirty||(this.gl.frontFace(e),this.current=e,this.dirty=!1)}};h(xH,"FrontFace");var Dge=xH,_H=class extends yi{getDefault(){return null}set(e){e===this.current&&!this.dirty||(this.gl.useProgram(e),this.current=e,this.dirty=!1)}};h(_H,"ProgramValue");var kge=_H,bH=class extends yi{getDefault(){return this.gl.TEXTURE0}set(e){e===this.current&&!this.dirty||(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}};h(bH,"ActiveTextureUnit");var Rge=bH,wH=class extends yi{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let t=this.current;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&!this.dirty||(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}};h(wH,"Viewport");var Fge=wH,SH=class extends yi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}};h(SH,"BindFramebuffer");var Oge=SH,MH=class extends yi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}};h(MH,"BindRenderbuffer");var Bge=MH,CH=class extends yi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}};h(CH,"BindTexture");var zge=CH,EH=class extends yi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};h(EH,"BindVertexBuffer");var Nge=EH,TH=class extends yi{getDefault(){return null}set(e){let t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}};h(TH,"BindElementBuffer");var $ge=TH,PH=class extends yi{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;let r=this.gl;fm(r)?r.bindVertexArray(e):(t=r.getExtension("OES_vertex_array_object"))==null||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}};h(PH,"BindVertexArray");var Uge=PH,AH=class extends yi{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}};h(AH,"PixelStoreUnpack");var Vge=AH,IH=class extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}};h(IH,"PixelStoreUnpackPremultiplyAlpha");var jge=IH,LH=class extends yi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}};h(LH,"PixelStoreUnpackFlipY");var Hge=LH,DH=class extends yi{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}};h(DH,"FramebufferAttachment");var sT=DH,kH=class extends sT{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}};h(kH,"ColorAttachment");var Gge=kH,RH=class extends sT{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}};h(RH,"DepthAttachment");var Wge=RH,FH=class extends sT{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}};h(FH,"DepthStencilAttachment");var Xge=FH,OH=class{constructor(e,t,r,n,a){this.context=e,this.width=t,this.height=r;let o=e.gl,s=this.framebuffer=o.createFramebuffer();if(this.colorAttachment=new Gge(e,s),n)this.depthAttachment=a?new Xge(e,s):new Wge(e,s);else if(a)throw new Error("Stencil cannot be set without depth");if(o.checkFramebufferStatus(o.FRAMEBUFFER)!==o.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){let r=this.depthAttachment.get();r&&e.deleteRenderbuffer(r)}e.deleteFramebuffer(this.framebuffer)}};h(OH,"Framebuffer");var qge=OH;R();var Zge=0,BH=1,Yge=771,zH=class{constructor(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r}};h(zH,"ColorMode");var _r=zH;_r.Replace=[BH,Zge];_r.disabled=new _r(_r.Replace,zt.transparent,[!1,!1,!1,!1]);_r.unblended=new _r(_r.Replace,zt.transparent,[!0,!0,!0,!0]);_r.alphaBlended=new _r([BH,Yge],zt.transparent,[!0,!0,!0,!0]);var NH=class{constructor(e){var t,r;if(this.gl=e,this.clearColor=new fge(this),this.clearDepth=new mge(this),this.clearStencil=new gge(this),this.colorMask=new yge(this),this.depthMask=new vge(this),this.stencilMask=new xge(this),this.stencilFunc=new _ge(this),this.stencilOp=new bge(this),this.stencilTest=new wge(this),this.depthRange=new Sge(this),this.depthTest=new Mge(this),this.depthFunc=new Cge(this),this.blend=new Ege(this),this.blendFunc=new Tge(this),this.blendColor=new Pge(this),this.blendEquation=new Age(this),this.cullFace=new Ige(this),this.cullFaceSide=new Lge(this),this.frontFace=new Dge(this),this.program=new kge(this),this.activeTexture=new Rge(this),this.viewport=new Fge(this),this.bindFramebuffer=new Oge(this),this.bindRenderbuffer=new Bge(this),this.bindTexture=new zge(this),this.bindVertexBuffer=new Nge(this),this.bindElementBuffer=new $ge(this),this.bindVertexArray=new Uge(this),this.pixelStoreUnpack=new Vge(this),this.pixelStoreUnpackPremultiplyAlpha=new jge(this),this.pixelStoreUnpackFlipY=new Hge(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),fm(e)){this.HALF_FLOAT=e.HALF_FLOAT;let n=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(t=e.RGBA16F)!=null?t:n==null?void 0:n.RGBA16F_EXT,this.RGB16F=(r=e.RGB16F)!=null?r:n==null?void 0:n.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let n=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=n==null?void 0:n.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new cge(this,e,t)}createVertexBuffer(e,t,r){return new dge(this,e,t,r)}createRenderbuffer(e,t,r){let n=this.gl,a=n.createRenderbuffer();return this.bindRenderbuffer.set(a),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),a}createFramebuffer(e,t,r,n){return new qge(this,e,t,r,n)}clear({color:e,depth:t,stencil:r}){let n=this.gl,a=0;e&&(a|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),typeof t<"u"&&(a|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),typeof r<"u"&&(a|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),n.clear(a)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func===this.gl.ALWAYS&&!e.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range))}setStencilMode(e){e.test.func===this.gl.ALWAYS&&!e.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask}))}setColorMode(e){Cl(e.blendFunction,_r.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return fm(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return fm(this.gl)?this.gl.deleteVertexArray(e):(t=this.gl.getExtension("OES_vertex_array_object"))==null?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}};h(NH,"Context");var Jge=NH;R();var $H=class{constructor(e,t,r){this.func=e,this.mask=t,this.range=r}};h($H,"DepthMode");var oi=$H;oi.ReadOnly=!1;oi.ReadWrite=!0;oi.disabled=new oi(519,oi.ReadOnly,[0,1]);R();var UH=class{constructor(e,t,r,n,a,o){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=a,this.pass=o}};h(UH,"StencilMode");var Xi=UH;Xi.disabled=new Xi({func:519,mask:0},0,0,7680,7680,7680);R();var VH=class{constructor(e,t,r){this.enable=e,this.mode=t,this.frontFace=r}};h(VH,"CullFaceMode");var $i=VH;$i.disabled=new $i(!1,1029,2305);$i.backCCW=new $i(!0,1029,2305);R();var jH=kt(gi(),1);R();var d1;function Q3(i,e,t,r,n,a,o){let s=i.context,l=s.gl,u=i.useProgram("collisionBox"),c=[],p=0,d=0;for(let w=0;w<r.length;w++){let b=r[w],C=e.getTile(b),E=C.getBucket(t);if(!E)continue;let T=b.posMatrix;(n[0]!==0||n[1]!==0)&&(T=i.translatePosMatrix(b.posMatrix,C,n,a));let L=o?E.textCollisionBox:E.iconCollisionBox,D=E.collisionCircleArray;if(D.length>0){let B=ht.create(),A=T;ht.mul(B,E.placementInvProjMatrix,i.transform.glCoordMatrix),ht.mul(B,B,E.placementViewportMatrix),c.push({circleArray:D,circleOffset:d,transform:A,invTransform:B,coord:b}),p+=D.length/4,d=p}L&&u.draw(s,l.LINES,oi.disabled,Xi.disabled,i.colorModeForRenderPass(),$i.disabled,Fme(T,i.transform,C),i.style.map.terrain&&i.style.map.terrain.getTerrainData(b),t.id,L.layoutVertexBuffer,L.indexBuffer,L.segments,null,i.transform.zoom,null,null,L.collisionVertexBuffer)}if(!o||!c.length)return;let m=i.useProgram("collisionCircle"),g=new mce;g.resize(p*4),g._trim();let _=0;for(let w of c)for(let b=0;b<w.circleArray.length/4;b++){let C=b*4,E=w.circleArray[C+0],T=w.circleArray[C+1],L=w.circleArray[C+2],D=w.circleArray[C+3];g.emplace(_++,E,T,L,D,0),g.emplace(_++,E,T,L,D,1),g.emplace(_++,E,T,L,D,2),g.emplace(_++,E,T,L,D,3)}(!d1||d1.length<p*2)&&(d1=HH(p));let y=s.createIndexBuffer(d1,!0),x=s.createVertexBuffer(g,qpe.members,!0);for(let w of c){let b=Ome(w.transform,w.invTransform,i.transform);m.draw(s,l.TRIANGLES,oi.disabled,Xi.disabled,i.colorModeForRenderPass(),$i.disabled,b,i.style.map.terrain&&i.style.map.terrain.getTerrainData(w.coord),t.id,x,y,fr.simpleSegment(0,w.circleOffset*2,w.circleArray.length,w.circleArray.length/2),null,i.transform.zoom,null,null,null)}x.destroy(),y.destroy()}h(Q3,"drawCollisionDebug");function HH(i){let e=i*2,t=new yce;t.resize(e),t._trim();for(let r=0;r<e;r++){let n=r*6;t.uint16[n+0]=r*4+0,t.uint16[n+1]=r*4+1,t.uint16[n+2]=r*4+2,t.uint16[n+3]=r*4+2,t.uint16[n+4]=r*4+3,t.uint16[n+5]=r*4+0}return t}h(HH,"createQuadTriangles");var Kge=ht.identity(new Float32Array(16));function GH(i,e,t,r,n){if(i.renderPass!=="translucent")return;let a=Xi.disabled,o=i.colorModeForRenderPass();(t._unevaluatedLayout.hasValue("text-variable-anchor")||t._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&XH(r,i,t,e,t.layout.get("text-rotation-alignment"),t.layout.get("text-pitch-alignment"),n),t.paint.get("icon-opacity").constantOr(1)!==0&&eS(i,e,t,r,!1,t.paint.get("icon-translate"),t.paint.get("icon-translate-anchor"),t.layout.get("icon-rotation-alignment"),t.layout.get("icon-pitch-alignment"),t.layout.get("icon-keep-upright"),a,o),t.paint.get("text-opacity").constantOr(1)!==0&&eS(i,e,t,r,!0,t.paint.get("text-translate"),t.paint.get("text-translate-anchor"),t.layout.get("text-rotation-alignment"),t.layout.get("text-pitch-alignment"),t.layout.get("text-keep-upright"),a,o),e.map.showCollisionBoxes&&(Q3(i,e,t,r,t.paint.get("text-translate"),t.paint.get("text-translate-anchor"),!0),Q3(i,e,t,r,t.paint.get("icon-translate"),t.paint.get("icon-translate-anchor"),!1))}h(GH,"drawSymbols");function WH(i,e,t,r,n,a){let{horizontalAlign:o,verticalAlign:s}=H5(i),l=-(o-.5)*e,u=-(s-.5)*t;return new jH.default((l/n+r[0])*a,(u/n+r[1])*a)}h(WH,"calculateVariableRenderShift");function XH(i,e,t,r,n,a,o){let s=e.transform,l=n==="map",u=a==="map";for(let c of i){let p=r.getTile(c),d=p.getBucket(t);if(!d||!d.text||!d.text.segments.get().length)continue;let m=d.textSizeData,g=Mg(m,s.zoom),_=ta(p,1,e.transform.zoom),y=v_(c.posMatrix,u,l,e.transform,_),x=t.layout.get("icon-text-fit")!=="none"&&d.hasIconData();if(g){let w=Math.pow(2,s.zoom-p.tileID.overscaledZ),b=e.style.map.terrain?(C,E)=>e.style.map.terrain.getElevation(c,C,E):null;qH(d,l,u,o,s,y,c.posMatrix,w,g,x,b)}}}h(XH,"updateVariableAnchors");function qH(i,e,t,r,n,a,o,s,l,u,c){let p=i.text.placedSymbolArray,d=i.text.dynamicLayoutVertexArray,m=i.icon.dynamicLayoutVertexArray,g={};d.clear();for(let _=0;_<p.length;_++){let y=p.get(_),x=i.allowVerticalPlacement&&!y.placedOrientation,w=!y.hidden&&y.crossTileID&&!x?r[y.crossTileID]:null;if(!w)qu(y.numGlyphs,d);else{let b=new jH.default(y.anchorX,y.anchorY),C=ma(b,t?o:a,c),E=x_(n.cameraToCenterDistance,C.signedDistanceFromCamera),T=f_(i.textSizeData,l,y)*E/NU;t&&(T*=i.tilePixelRatio/s);let{width:L,height:D,anchor:B,textOffset:A,textBoxScale:k}=w,$=WH(B,L,D,A,k,T),z=t?ma(b.add($),a,c).point:C.point.add(e?$.rotate(-n.angle):$),P=i.allowVerticalPlacement&&y.placedOrientation===2?Math.PI/2:0;for(let U=0;U<y.numGlyphs;U++)Yp(d,z,P);u&&y.associatedIconIndex>=0&&(g[y.associatedIconIndex]={shiftedAnchor:z,angle:P})}}if(u){m.clear();let _=i.icon.placedSymbolArray;for(let y=0;y<_.length;y++){let x=_.get(y);if(x.hidden)qu(x.numGlyphs,m);else{let w=g[y];if(!w)qu(x.numGlyphs,m);else for(let b=0;b<x.numGlyphs;b++)Yp(m,w.shiftedAnchor,w.angle)}}i.icon.dynamicLayoutVertexBuffer.updateData(m)}i.text.dynamicLayoutVertexBuffer.updateData(d)}h(qH,"updateVariableAnchorsForBucket");function ZH(i,e,t){return t.iconsInText&&e?"symbolTextAndIcon":i?"symbolSDF":"symbolIcon"}h(ZH,"getSymbolProgramName");function eS(i,e,t,r,n,a,o,s,l,u,c,p){let d=i.context,m=d.gl,g=i.transform,_=s==="map",y=l==="map",x=s!=="viewport"&&t.layout.get("symbol-placement")!=="point",w=_&&!y&&!x,b=!t.layout.get("symbol-sort-key").isConstant(),C=!1,E=i.depthModeForSublayer(0,oi.ReadOnly),T=t._unevaluatedLayout.hasValue("text-variable-anchor")||t._unevaluatedLayout.hasValue("text-variable-anchor-offset"),L=[];for(let D of r){let B=e.getTile(D),A=B.getBucket(t);if(!A)continue;let k=n?A.text:A.icon;if(!k||!k.segments.get().length||!k.hasVisibleVertices)continue;let $=k.programConfigurations.get(t.id),z=n||A.sdfIcons,P=n?A.textSizeData:A.iconSizeData,U=y||g.pitch!==0,G=i.useProgram(ZH(z,n,A),$),K=Mg(P,g.zoom),O=i.style.map.terrain&&i.style.map.terrain.getTerrainData(D),V,j=[0,0],q,ee,ae=null,N;if(n){if(q=B.glyphAtlasTexture,ee=m.LINEAR,V=B.glyphAtlasTexture.size,A.iconsInText){j=B.imageAtlasTexture.size,ae=B.imageAtlasTexture;let ke=P.kind==="composite"||P.kind==="camera";N=U||i.options.rotating||i.options.zooming||ke?m.LINEAR:m.NEAREST}}else{let ke=t.layout.get("icon-size").constantOr(0)!==1||A.iconsNeedLinear;q=B.imageAtlasTexture,ee=z||i.options.rotating||i.options.zooming||ke||U?m.LINEAR:m.NEAREST,V=B.imageAtlasTexture.size}let J=ta(B,1,i.transform.zoom),Y=v_(D.posMatrix,y,_,i.transform,J),oe=K5(D.posMatrix,y,_,i.transform,J),xe=T&&A.hasTextData(),ge=t.layout.get("icon-text-fit")!=="none"&&xe&&A.hasIconData();if(x){let ke=i.style.map.terrain?(Oe,Je)=>i.style.map.terrain.getElevation(D,Oe,Je):null,we=t.layout.get("text-rotation-alignment")==="map";yj(A,D.posMatrix,i,n,Y,oe,y,u,we,ke)}let Te=i.translatePosMatrix(D.posMatrix,B,a,o),me=x||n&&T||ge?Kge:Y,Q=i.translatePosMatrix(oe,B,a,o,!0),Me=z&&t.paint.get(n?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ve;z?A.iconsInText?ve=age(P.kind,K,w,y,i,Te,me,Q,V,j):ve=Jj(P.kind,K,w,y,i,Te,me,Q,n,V,!0):ve=Yj(P.kind,K,w,y,i,Te,me,Q,n,V);let Ie={program:G,buffers:k,uniformValues:ve,atlasTexture:q,atlasTextureIcon:ae,atlasInterpolation:ee,atlasInterpolationIcon:N,isSDF:z,hasHalo:Me};if(b&&A.canOverlap){C=!0;let ke=k.segments.get();for(let we of ke)L.push({segments:new fr([we]),sortKey:we.sortKey,state:Ie,terrainData:O})}else L.push({segments:k.segments,sortKey:0,state:Ie,terrainData:O})}C&&L.sort((D,B)=>D.sortKey-B.sortKey);for(let D of L){let B=D.state;if(d.activeTexture.set(m.TEXTURE0),B.atlasTexture.bind(B.atlasInterpolation,m.CLAMP_TO_EDGE),B.atlasTextureIcon&&(d.activeTexture.set(m.TEXTURE1),B.atlasTextureIcon&&B.atlasTextureIcon.bind(B.atlasInterpolationIcon,m.CLAMP_TO_EDGE)),B.isSDF){let A=B.uniformValues;B.hasHalo&&(A.u_is_halo=1,tS(B.buffers,D.segments,t,i,B.program,E,c,p,A,D.terrainData)),A.u_is_halo=0}tS(B.buffers,D.segments,t,i,B.program,E,c,p,B.uniformValues,D.terrainData)}}h(eS,"drawLayerSymbols");function tS(i,e,t,r,n,a,o,s,l,u){let c=r.context,p=c.gl;n.draw(c,p.TRIANGLES,a,o,s,$i.disabled,l,u,t.id,i.layoutVertexBuffer,i.indexBuffer,e,t.paint,r.transform.zoom,i.programConfigurations.get(t.id),i.dynamicLayoutVertexBuffer,i.opacityVertexBuffer)}h(tS,"drawSymbolElements");R();function YH(i,e,t,r){if(i.renderPass!=="translucent")return;let n=t.paint.get("circle-opacity"),a=t.paint.get("circle-stroke-width"),o=t.paint.get("circle-stroke-opacity"),s=!t.layout.get("circle-sort-key").isConstant();if(n.constantOr(1)===0&&(a.constantOr(1)===0||o.constantOr(1)===0))return;let l=i.context,u=l.gl,c=i.depthModeForSublayer(0,oi.ReadOnly),p=Xi.disabled,d=i.colorModeForRenderPass(),m=[];for(let g=0;g<r.length;g++){let _=r[g],y=e.getTile(_),x=y.getBucket(t);if(!x)continue;let w=x.programConfigurations.get(t.id),b=i.useProgram("circle",w),C=x.layoutVertexBuffer,E=x.indexBuffer,T=i.style.map.terrain&&i.style.map.terrain.getTerrainData(_),L=Dme(i,_,y,t),D={programConfiguration:w,program:b,layoutVertexBuffer:C,indexBuffer:E,uniformValues:L,terrainData:T};if(s){let B=x.segments.get();for(let A of B)m.push({segments:new fr([A]),sortKey:A.sortKey,state:D})}else m.push({segments:x.segments,sortKey:0,state:D})}s&&m.sort((g,_)=>g.sortKey-_.sortKey);for(let g of m){let{programConfiguration:_,program:y,layoutVertexBuffer:x,indexBuffer:w,uniformValues:b,terrainData:C}=g.state,E=g.segments;y.draw(l,u.TRIANGLES,c,p,d,$i.disabled,b,C,t.id,x,w,E,t.paint,i.transform.zoom,_)}}h(YH,"drawCircles");R();function JH(i,e,t,r){if(t.paint.get("heatmap-opacity")!==0)if(i.renderPass==="offscreen"){let n=i.context,a=n.gl,o=Xi.disabled,s=new _r([a.ONE,a.ONE],zt.transparent,[!0,!0,!0,!0]);KH(n,i,t),n.clear({color:zt.transparent});for(let l=0;l<r.length;l++){let u=r[l];if(e.hasRenderableParent(u))continue;let c=e.getTile(u),p=c.getBucket(t);if(!p)continue;let d=p.programConfigurations.get(t.id),m=i.useProgram("heatmap",d),{zoom:g}=i.transform;m.draw(n,a.TRIANGLES,oi.disabled,o,s,$i.disabled,Ume(u.posMatrix,c,g,t.paint.get("heatmap-intensity")),null,t.id,p.layoutVertexBuffer,p.indexBuffer,p.segments,t.paint,i.transform.zoom,d)}n.viewport.set([0,0,i.width,i.height])}else i.renderPass==="translucent"&&(i.context.setColorMode(i.colorModeForRenderPass()),eG(i,t))}h(JH,"drawHeatmap");function KH(i,e,t){let r=i.gl;i.activeTexture.set(r.TEXTURE1),i.viewport.set([0,0,e.width/4,e.height/4]);let n=t.heatmapFbo;if(n)r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),i.bindFramebuffer.set(n.framebuffer);else{let a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),n=t.heatmapFbo=i.createFramebuffer(e.width/4,e.height/4,!1,!1),QH(i,e,a,n)}}h(KH,"bindFramebuffer");function QH(i,e,t,r){var n,a;let o=i.gl,s=(n=i.HALF_FLOAT)!=null?n:o.UNSIGNED_BYTE,l=(a=i.RGBA16F)!=null?a:o.RGBA;o.texImage2D(o.TEXTURE_2D,0,l,e.width/4,e.height/4,0,o.RGBA,s,null),r.colorAttachment.set(t)}h(QH,"bindTextureToFramebuffer");function eG(i,e){let t=i.context,r=t.gl,n=e.heatmapFbo;if(!n)return;t.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,n.colorAttachment.get()),t.activeTexture.set(r.TEXTURE1);let a=e.colorRampTexture;a||(a=e.colorRampTexture=new zr(t,e.colorRamp,r.RGBA)),a.bind(r.LINEAR,r.CLAMP_TO_EDGE),i.useProgram("heatmapTexture").draw(t,r.TRIANGLES,oi.disabled,Xi.disabled,i.colorModeForRenderPass(),$i.disabled,Vme(i,e,0,1),null,e.id,i.viewportBuffer,i.quadTriangleIndexBuffer,i.viewportSegments,e.paint,i.transform.zoom)}h(eG,"renderTextureToMap");R();function tG(i,e,t,r){if(i.renderPass!=="translucent")return;let n=t.paint.get("line-opacity"),a=t.paint.get("line-width");if(n.constantOr(1)===0||a.constantOr(1)===0)return;let o=i.depthModeForSublayer(0,oi.ReadOnly),s=i.colorModeForRenderPass(),l=t.paint.get("line-dasharray"),u=t.paint.get("line-pattern"),c=u.constantOr(1),p=t.paint.get("line-gradient"),d=t.getCrossfadeParameters(),m=c?"linePattern":l?"lineSDF":p?"lineGradient":"line",g=i.context,_=g.gl,y=!0;for(let x of r){let w=e.getTile(x);if(c&&!w.patternsLoaded())continue;let b=w.getBucket(t);if(!b)continue;let C=b.programConfigurations.get(t.id),E=i.context.program.get(),T=i.useProgram(m,C),L=y||T.program!==E,D=i.style.map.terrain&&i.style.map.terrain.getTerrainData(x),B=u.constantOr(null);if(B&&w.imageAtlas){let $=w.imageAtlas,z=$.patternPositions[B.to.toString()],P=$.patternPositions[B.from.toString()];z&&P&&C.setConstantPatternPositions(z,P)}let A=D?x:null,k=c?Kme(i,w,t,d,A):l?Qme(i,w,t,l,d,A):p?Jme(i,w,t,b.lineClipsArray.length,A):nT(i,w,t,A);if(c)g.activeTexture.set(_.TEXTURE0),w.imageAtlasTexture.bind(_.LINEAR,_.CLAMP_TO_EDGE),C.updatePaintBuffers(d);else if(l&&(L||i.lineAtlas.dirty))g.activeTexture.set(_.TEXTURE0),i.lineAtlas.bind(g);else if(p){let $=b.gradients[t.id],z=$.texture;if(t.gradientVersion!==$.version){let P=256;if(t.stepInterpolant){let U=e.getSource().maxzoom,G=x.canonical.z===U?Math.ceil(1<<i.transform.maxZoom-x.canonical.z):1,K=b.maxLineLength/8192*1024*G;P=Lr(xD(K),256,g.maxTextureSize)}$.gradient=N5({expression:t.gradientExpression(),evaluationKey:"lineProgress",resolution:P,image:$.gradient||void 0,clips:b.lineClipsArray}),$.texture?$.texture.update($.gradient):$.texture=new zr(g,$.gradient,_.RGBA),$.version=t.gradientVersion,z=$.texture}g.activeTexture.set(_.TEXTURE0),z.bind(t.stepInterpolant?_.NEAREST:_.LINEAR,_.CLAMP_TO_EDGE)}T.draw(g,_.TRIANGLES,o,i.stencilModeForClipping(x),s,$i.disabled,k,D,t.id,b.layoutVertexBuffer,b.indexBuffer,b.segments,t.paint,i.transform.zoom,C,b.layoutVertexBuffer2),y=!1}}h(tG,"drawLine");R();R();function lT(i,e,t,r,n){if(!t||!r||!r.imageAtlas)return;let a=r.imageAtlas.patternPositions,o=a[t.to.toString()],s=a[t.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){let l=n.getPaintProperty(e);o=a[l],s=a[l]}o&&s&&i.setConstantPatternPositions(o,s)}h(lT,"updatePatternPositionsInProgram");function iG(i,e,t,r){let n=t.paint.get("fill-color"),a=t.paint.get("fill-opacity");if(a.constantOr(1)===0)return;let o=i.colorModeForRenderPass(),s=t.paint.get("fill-pattern"),l=i.opaquePassEnabledForLayer()&&!s.constantOr(1)&&n.constantOr(zt.transparent).a===1&&a.constantOr(0)===1?"opaque":"translucent";if(i.renderPass===l){let u=i.depthModeForSublayer(1,i.renderPass==="opaque"?oi.ReadWrite:oi.ReadOnly);iS(i,e,t,r,u,o,!1)}if(i.renderPass==="translucent"&&t.paint.get("fill-antialias")){let u=i.depthModeForSublayer(t.getPaintProperty("fill-outline-color")?2:0,oi.ReadOnly);iS(i,e,t,r,u,o,!0)}}h(iG,"drawFill");function iS(i,e,t,r,n,a,o){let s=i.context.gl,l="fill-pattern",u=t.paint.get(l),c=u&&u.constantOr(1),p=t.getCrossfadeParameters(),d,m,g,_,y;o?(m=c&&!t.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",d=s.LINES):(m=c?"fillPattern":"fill",d=s.TRIANGLES);let x=u.constantOr(null);for(let w of r){let b=e.getTile(w);if(c&&!b.patternsLoaded())continue;let C=b.getBucket(t);if(!C)continue;let E=C.programConfigurations.get(t.id),T=i.useProgram(m,E),L=i.style.map.terrain&&i.style.map.terrain.getTerrainData(w);c&&(i.context.activeTexture.set(s.TEXTURE0),b.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),E.updatePaintBuffers(p)),lT(E,l,x,b,t);let D=L?w:null,B=D?D.posMatrix:w.posMatrix,A=i.translatePosMatrix(B,b,t.paint.get("fill-translate"),t.paint.get("fill-translate-anchor"));if(!o)_=C.indexBuffer,y=C.segments,g=c?Gj(A,i,p,b):Hj(A);else{_=C.indexBuffer2,y=C.segments2;let k=[s.drawingBufferWidth,s.drawingBufferHeight];g=m==="fillOutlinePattern"&&c?Ime(A,i,p,b,k):Ame(A,k)}T.draw(i.context,d,n,i.stencilModeForClipping(w),a,$i.disabled,g,L,t.id,C.layoutVertexBuffer,_,y,t.paint,i.transform.zoom,E)}}h(iS,"drawFillTiles");R();function rG(i,e,t,r){let n=t.paint.get("fill-extrusion-opacity");if(n!==0&&i.renderPass==="translucent"){let a=new oi(i.context.gl.LEQUAL,oi.ReadWrite,i.depthRangeFor3D);if(n===1&&!t.paint.get("fill-extrusion-pattern").constantOr(1)){let o=i.colorModeForRenderPass();Uy(i,e,t,r,a,Xi.disabled,o)}else Uy(i,e,t,r,a,Xi.disabled,_r.disabled),Uy(i,e,t,r,a,i.stencilModeFor3D(),i.colorModeForRenderPass())}}h(rG,"drawFillExtrusion");function Uy(i,e,t,r,n,a,o){let s=i.context,l=s.gl,u="fill-extrusion-pattern",c=t.paint.get(u),p=c.constantOr(1),d=t.getCrossfadeParameters(),m=t.paint.get("fill-extrusion-opacity"),g=c.constantOr(null);for(let _ of r){let y=e.getTile(_),x=y.getBucket(t);if(!x)continue;let w=i.style.map.terrain&&i.style.map.terrain.getTerrainData(_),b=x.programConfigurations.get(t.id),C=i.useProgram(p?"fillExtrusionPattern":"fillExtrusion",b);p&&(i.context.activeTexture.set(l.TEXTURE0),y.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),b.updatePaintBuffers(d)),lT(b,u,g,y,t);let E=i.translatePosMatrix(_.posMatrix,y,t.paint.get("fill-extrusion-translate"),t.paint.get("fill-extrusion-translate-anchor")),T=t.paint.get("fill-extrusion-vertical-gradient"),L=p?Mme(E,i,T,m,_,d,y):jj(E,i,T,m);C.draw(s,s.gl.TRIANGLES,n,a,o,$i.backCCW,L,w,t.id,x.layoutVertexBuffer,x.indexBuffer,x.segments,t.paint,i.transform.zoom,b,i.style.map.terrain&&x.centroidVertexBuffer)}}h(Uy,"drawExtrusionTiles");R();function nG(i,e,t,r){if(i.renderPass!=="offscreen"&&i.renderPass!=="translucent")return;let n=i.context,a=i.depthModeForSublayer(0,oi.ReadOnly),o=i.colorModeForRenderPass(),[s,l]=i.renderPass==="translucent"?i.stencilConfigForOverlap(r):[{},r];for(let u of l){let c=e.getTile(u);typeof c.needsHillshadePrepare<"u"&&c.needsHillshadePrepare&&i.renderPass==="offscreen"?oG(i,c,t,a,Xi.disabled,o):i.renderPass==="translucent"&&aG(i,u,c,t,a,s[u.overscaledZ],o)}n.viewport.set([0,0,i.width,i.height])}h(nG,"drawHillshade");function aG(i,e,t,r,n,a,o){let s=i.context,l=s.gl,u=t.fbo;if(!u)return;let c=i.useProgram("hillshade"),p=i.style.map.terrain&&i.style.map.terrain.getTerrainData(e);s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.colorAttachment.get());let d=p?e:null;c.draw(s,l.TRIANGLES,n,a,o,$i.disabled,Gme(i,t,r,d),p,r.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}h(aG,"renderHillshade");function oG(i,e,t,r,n,a){let o=i.context,s=o.gl,l=e.dem;if(l&&l.data){let u=l.dim,c=l.stride,p=l.getPixels();if(o.activeTexture.set(s.TEXTURE1),o.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||i.getTileTexture(c),e.demTexture){let m=e.demTexture;m.update(p,{premultiply:!1}),m.bind(s.NEAREST,s.CLAMP_TO_EDGE)}else e.demTexture=new zr(o,p,s.RGBA,{premultiply:!1}),e.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE);o.activeTexture.set(s.TEXTURE0);let d=e.fbo;if(!d){let m=new zr(o,{width:u,height:u,data:null},s.RGBA);m.bind(s.LINEAR,s.CLAMP_TO_EDGE),d=e.fbo=o.createFramebuffer(u,u,!0,!1),d.colorAttachment.set(m.texture)}o.bindFramebuffer.set(d.framebuffer),o.viewport.set([0,0,u,u]),i.useProgram("hillshadePrepare").draw(o,s.TRIANGLES,r,n,a,$i.disabled,Wme(e.tileID,l),null,t.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments),e.needsHillshadePrepare=!1}}h(oG,"prepareHillshade");R();function sG(i,e,t,r){if(i.renderPass!=="translucent"||t.paint.get("raster-opacity")===0||!r.length)return;let n=i.context,a=n.gl,o=e.getSource(),s=i.useProgram("raster"),l=i.colorModeForRenderPass(),[u,c]=o instanceof Wm?[{},r]:i.stencilConfigForOverlap(r),p=c[c.length-1].overscaledZ,d=!i.options.moving;for(let m of c){let g=i.depthModeForSublayer(m.overscaledZ-p,t.paint.get("raster-opacity")===1?oi.ReadWrite:oi.ReadOnly,a.LESS),_=e.getTile(m);_.registerFadeDuration(t.paint.get("raster-fade-duration"));let y=e.findLoadedParent(m,0),x=lG(_,y,e,t,i.transform,i.style.map.terrain),w,b,C=t.paint.get("raster-resampling")==="nearest"?a.NEAREST:a.LINEAR;n.activeTexture.set(a.TEXTURE0),_.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),n.activeTexture.set(a.TEXTURE1),y?(y.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),w=Math.pow(2,y.tileID.overscaledZ-_.tileID.overscaledZ),b=[_.tileID.canonical.x*w%1,_.tileID.canonical.y*w%1]):_.texture.bind(C,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST);let E=i.style.map.terrain&&i.style.map.terrain.getTerrainData(m),T=E?m:null,L=T?T.posMatrix:i.transform.calculatePosMatrix(m.toUnwrapped(),d),D=tge(L,b||[0,0],w||1,x,t);o instanceof Wm?s.draw(n,a.TRIANGLES,g,Xi.disabled,l,$i.disabled,D,E,t.id,o.boundsBuffer,i.quadTriangleIndexBuffer,o.boundsSegments):s.draw(n,a.TRIANGLES,g,u[m.overscaledZ],l,$i.disabled,D,E,t.id,i.rasterBoundsBuffer,i.quadTriangleIndexBuffer,i.rasterBoundsSegments)}}h(sG,"drawRaster");function lG(i,e,t,r,n,a){let o=r.paint.get("raster-fade-duration");if(!a&&o>0){let s=li.now(),l=(s-i.timeAdded)/o,u=e?(s-e.timeAdded)/o:-1,c=t.getSource(),p=n.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),d=!e||Math.abs(e.tileID.overscaledZ-p)>Math.abs(i.tileID.overscaledZ-p),m=d&&i.refreshedUponExpiration?1:Lr(d?l:1-u,0,1);return i.refreshedUponExpiration&&l>=1&&(i.refreshedUponExpiration=!1),e?{opacity:1,mix:1-m}:{opacity:m,mix:0}}else return{opacity:1,mix:0}}h(lG,"getFadeValues");R();function uG(i,e,t,r){let n=t.paint.get("background-color"),a=t.paint.get("background-opacity");if(a===0)return;let o=i.context,s=o.gl,l=i.transform,u=l.tileSize,c=t.paint.get("background-pattern");if(i.isPatternMissing(c))return;let p=!c&&n.a===1&&a===1&&i.opaquePassEnabledForLayer()?"opaque":"translucent";if(i.renderPass!==p)return;let d=Xi.disabled,m=i.depthModeForSublayer(0,p==="opaque"?oi.ReadWrite:oi.ReadOnly),g=i.colorModeForRenderPass(),_=i.useProgram(c?"backgroundPattern":"background"),y=r||l.coveringTiles({tileSize:u,terrain:i.style.map.terrain});c&&(o.activeTexture.set(s.TEXTURE0),i.imageManager.bind(i.context));let x=t.getCrossfadeParameters();for(let w of y){let b=r?w.posMatrix:i.transform.calculatePosMatrix(w.toUnwrapped()),C=c?uge(b,a,i,c,{tileID:w,tileSize:u},x):lge(b,a,n),E=i.style.map.terrain&&i.style.map.terrain.getTerrainData(w);_.draw(o,s.TRIANGLES,m,d,g,$i.disabled,C,E,t.id,i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}h(uG,"drawBackground");R();var Qge=new zt(1,0,0,1),e1e=new zt(0,1,0,1),t1e=new zt(0,0,1,1),i1e=new zt(1,0,1,1),r1e=new zt(0,1,1,1);function hG(i){let e=i.transform.padding,t=3;rS(i,i.transform.height-(e.top||0),t,Qge),rS(i,e.bottom||0,t,e1e),nS(i,e.left||0,t,t1e),nS(i,i.transform.width-(e.right||0),t,i1e);let r=i.transform.centerPoint;cG(i,r.x,i.transform.height-r.y,r1e)}h(hG,"drawDebugPadding");function cG(i,e,t,r){Ym(i,e-2/2,t-20/2,2,20,r),Ym(i,e-20/2,t-2/2,20,2,r)}h(cG,"drawCrosshair");function rS(i,e,t,r){Ym(i,0,e+t/2,i.transform.width,t,r)}h(rS,"drawHorizontalLine");function nS(i,e,t,r){Ym(i,e-t/2,0,t,i.transform.height,r)}h(nS,"drawVerticalLine");function Ym(i,e,t,r,n,a){let o=i.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(e*i.pixelRatio,t*i.pixelRatio,r*i.pixelRatio,n*i.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}h(Ym,"drawDebugSSRect");function pG(i,e,t){for(let r=0;r<t.length;r++)dG(i,e,t[r])}h(pG,"drawDebug");function dG(i,e,t){let r=i.context,n=r.gl,a=t.posMatrix,o=i.useProgram("debug"),s=oi.disabled,l=Xi.disabled,u=i.colorModeForRenderPass(),c="$debug",p=i.style.map.terrain&&i.style.map.terrain.getTerrainData(t);r.activeTexture.set(n.TEXTURE0);let d=e.getTileByID(t.key).latestRawTileData,m=d&&d.byteLength||0,g=Math.floor(m/1024),_=e.getTile(t).tileSize,y=512/Math.min(_,512)*(t.overscaledZ/i.transform.zoom)*.5,x=t.canonical.toString();t.overscaledZ!==t.canonical.z&&(x+=` => ${t.overscaledZ}`);let w=`${x} ${g}kB`;fG(i,w),o.draw(r,n.TRIANGLES,s,l,_r.alphaBlended,$i.disabled,k6(a,zt.transparent,y),null,c,i.debugBuffer,i.quadTriangleIndexBuffer,i.debugSegments),o.draw(r,n.LINE_STRIP,s,l,u,$i.disabled,k6(a,zt.red),p,c,i.debugBuffer,i.tileBorderIndexBuffer,i.debugSegments)}h(dG,"drawDebugTile");function fG(i,e){i.initDebugOverlayCanvas();let t=i.debugOverlayCanvas,r=i.context.gl,n=i.debugOverlayCanvas.getContext("2d");n.clearRect(0,0,t.width,t.height),n.shadowColor="white",n.shadowBlur=2,n.lineWidth=1.5,n.strokeStyle="white",n.textBaseline="top",n.font="bold 36px Open Sans, sans-serif",n.fillText(e,5,5),n.strokeText(e,5,5),i.debugOverlayTexture.update(t),i.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}h(fG,"drawTextToOverlay");function mG(i,e){let t=null,r=Object.values(i._layers).flatMap(s=>s.source&&!s.isHidden(e)?[i.sourceCaches[s.source]]:[]),n=r.filter(s=>s.getSource().type==="vector"),a=r.filter(s=>s.getSource().type!=="vector"),o=h(s=>{(!t||t.getSource().maxzoom<s.getSource().maxzoom)&&(t=s)},"considerSource");return n.forEach(s=>o(s)),t||a.forEach(s=>o(s)),t}h(mG,"selectDebugSource");R();function gG(i,e,t){let r=i.context,n=t.implementation;if(i.renderPass==="offscreen"){let a=n.prerender;a&&(i.setCustomLayerDefaults(),r.setColorMode(i.colorModeForRenderPass()),a.call(n,r.gl,i.transform.customLayerMatrix()),r.setDirty(),i.setBaseState())}else if(i.renderPass==="translucent"){i.setCustomLayerDefaults(),r.setColorMode(i.colorModeForRenderPass()),r.setStencilMode(Xi.disabled);let a=n.renderingMode==="3d"?new oi(i.context.gl.LEQUAL,oi.ReadWrite,i.depthRangeFor3D):i.depthModeForSublayer(0,oi.ReadOnly);r.setDepthMode(a),n.render(r.gl,i.transform.customLayerMatrix()),r.setDirty(),i.setBaseState(),r.bindFramebuffer.set(null)}}h(gG,"drawCustom");R();function yG(i,e){let t=i.context,r=t.gl,n=_r.unblended,a=new oi(r.LEQUAL,oi.ReadWrite,[0,1]),o=e.getTerrainMesh(),s=e.sourceCache.getRenderableTiles(),l=i.useProgram("terrainDepth");t.bindFramebuffer.set(e.getFramebuffer("depth").framebuffer),t.viewport.set([0,0,i.width/devicePixelRatio,i.height/devicePixelRatio]),t.clear({color:zt.transparent,depth:1});for(let u of s){let c=e.getTerrainData(u.tileID),p=i.transform.calculatePosMatrix(u.tileID.toUnwrapped()),d=xme(p,e.getMeshFrameDelta(i.transform.zoom));l.draw(t,r.TRIANGLES,a,Xi.disabled,n,$i.backCCW,d,c,"terrain",o.vertexBuffer,o.indexBuffer,o.segments)}t.bindFramebuffer.set(null),t.viewport.set([0,0,i.width,i.height])}h(yG,"drawDepth");function vG(i,e){let t=i.context,r=t.gl,n=_r.unblended,a=new oi(r.LEQUAL,oi.ReadWrite,[0,1]),o=e.getTerrainMesh(),s=e.getCoordsTexture(),l=e.sourceCache.getRenderableTiles(),u=i.useProgram("terrainCoords");t.bindFramebuffer.set(e.getFramebuffer("coords").framebuffer),t.viewport.set([0,0,i.width/devicePixelRatio,i.height/devicePixelRatio]),t.clear({color:zt.transparent,depth:1}),e.coordsIndex=[];for(let c of l){let p=e.getTerrainData(c.tileID);t.activeTexture.set(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,s.texture);let d=i.transform.calculatePosMatrix(c.tileID.toUnwrapped()),m=_me(d,255-e.coordsIndex.length,e.getMeshFrameDelta(i.transform.zoom));u.draw(t,r.TRIANGLES,a,Xi.disabled,n,$i.backCCW,m,p,"terrain",o.vertexBuffer,o.indexBuffer,o.segments),e.coordsIndex.push(c.tileID.key)}t.bindFramebuffer.set(null),t.viewport.set([0,0,i.width,i.height])}h(vG,"drawCoords");function aS(i,e,t){let r=i.context,n=r.gl,a=i.colorModeForRenderPass(),o=new oi(n.LEQUAL,oi.ReadWrite,i.depthRangeFor3D),s=i.useProgram("terrain"),l=e.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,i.width,i.height]);for(let u of t){let c=i.renderToTexture.getTexture(u),p=e.getTerrainData(u.tileID);r.activeTexture.set(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,c.texture);let d=i.transform.calculatePosMatrix(u.tileID.toUnwrapped()),m=vme(d,e.getMeshFrameDelta(i.transform.zoom));s.draw(r,n.TRIANGLES,o,Xi.disabled,a,$i.backCCW,m,p,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}h(aS,"drawTerrain");var xG=class{constructor(e,t){this.context=new Jge(e),this.transform=t,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:ht.identity(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Xm.maxUnderzooming+Xm.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new zj}resize(e,t,r){if(this.width=Math.floor(e*r),this.height=Math.floor(t*r),this.pixelRatio=r,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let n of this.style._order)this.style._layers[n].resize()}setup(){let e=this.context,t=new Ry;t.emplaceBack(0,0),t.emplaceBack(8192,0),t.emplaceBack(0,8192),t.emplaceBack(8192,8192),this.tileExtentBuffer=e.createVertexBuffer(t,F2.members),this.tileExtentSegments=fr.simpleSegment(0,0,4,2);let r=new Ry;r.emplaceBack(0,0),r.emplaceBack(8192,0),r.emplaceBack(0,8192),r.emplaceBack(8192,8192),this.debugBuffer=e.createVertexBuffer(r,F2.members),this.debugSegments=fr.simpleSegment(0,0,4,5);let n=new eB;n.emplaceBack(0,0,0,0),n.emplaceBack(8192,0,8192,0),n.emplaceBack(0,8192,0,8192),n.emplaceBack(8192,8192,8192,8192),this.rasterBoundsBuffer=e.createVertexBuffer(n,y_.members),this.rasterBoundsSegments=fr.simpleSegment(0,0,4,2);let a=new Ry;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,F2.members),this.viewportSegments=fr.simpleSegment(0,0,4,2);let o=new vce;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(o);let s=new Ch;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);let l=this.context.gl;this.stencilClearMode=new Xi({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){let e=this.context,t=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let r=ht.create();ht.ortho(r,0,this.width,this.height,0,0,1),ht.scale(r,r,[t.drawingBufferWidth,t.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,t.TRIANGLES,oi.disabled,this.stencilClearMode,_r.disabled,$i.disabled,R6(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source;let r=this.context,n=r.gl;this.nextStencilID+t.length>256&&this.clearStencil(),r.setColorMode(_r.disabled),r.setDepthMode(oi.disabled);let a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let o of t){let s=this._tileClippingMaskIDs[o.key]=this.nextStencilID++,l=this.style.map.terrain&&this.style.map.terrain.getTerrainData(o);a.draw(r,n.TRIANGLES,oi.disabled,new Xi({func:n.ALWAYS,mask:0},s,255,n.KEEP,n.KEEP,n.REPLACE),_r.disabled,$i.disabled,R6(o.posMatrix),l,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,t=this.context.gl;return new Xi({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){let t=this.context.gl;return new Xi({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){let t=this.context.gl,r=e.sort((o,s)=>s.overscaledZ-o.overscaledZ),n=r[r.length-1].overscaledZ,a=r[0].overscaledZ-n+1;if(a>1){this.currentStencilSource=void 0,this.nextStencilID+a>256&&this.clearStencil();let o={};for(let s=0;s<a;s++)o[s+n]=new Xi({func:t.GEQUAL,mask:255},s+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=a,[o,r]}return[{[n]:Xi.disabled},r]}colorModeForRenderPass(){let e=this.context.gl;return this._showOverdrawInspector?new _r([e.CONSTANT_COLOR,e.ONE],new zt(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?_r.unblended:_r.alphaBlended}depthModeForSublayer(e,t,r){if(!this.opaquePassEnabledForLayer())return oi.disabled;let n=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new oi(r||this.context.gl.LEQUAL,t,[n,n])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,t){this.style=e,this.options=t,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(li.now()),this.imageManager.beginFrame();let r=this.style._order,n=this.style.sourceCaches,a={},o={},s={};for(let l in n){let u=n[l];u.used&&u.prepare(this.context),a[l]=u.getVisibleCoordinates(),o[l]=a[l].slice().reverse(),s[l]=u.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let l=0;l<r.length;l++){let u=r[l];if(this.style._layers[u].is3D()){this.opaquePassCutoff=l;break}}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let l of r){let u=this.style._layers[l];if(!u.hasOffscreenPass()||u.isHidden(this.transform.zoom))continue;let c=o[u.source];u.type!=="custom"&&!c.length||this.renderLayer(this,n[u.source],u,c)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:t.showOverdrawInspector?zt.black:zt.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=t.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){let l=this.style._layers[r[this.currentLayer]],u=n[l.source],c=a[l.source];this._renderTileClippingMasks(l,c),this.renderLayer(this,u,l,c)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){let l=this.style._layers[r[this.currentLayer]],u=n[l.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(l))continue;let c=(l.type==="symbol"?s:o)[l.source];this._renderTileClippingMasks(l,a[l.source]),this.renderLayer(this,u,l,c)}if(this.options.showTileBoundaries){let l=mG(this.style,this.transform.zoom);l&&pG(this,l,l.getVisibleCoordinates())}this.options.showPadding&&hG(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let t=this.terrainFacilitator.matrix,r=this.transform.projMatrix,n=this.terrainFacilitator.dirty;n||(n=e?!ht.exactEquals(t,r):!ht.equals(t,r)),n||(n=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),n&&(ht.copy(t,r),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,yG(this,this.style.map.terrain),vG(this,this.style.map.terrain))}renderLayer(e,t,r,n){if(!r.isHidden(this.transform.zoom)&&!(r.type!=="background"&&r.type!=="custom"&&!(n||[]).length))switch(this.id=r.id,r.type){case"symbol":GH(e,t,r,n,this.style.placement.variableOffsets);break;case"circle":YH(e,t,r,n);break;case"heatmap":JH(e,t,r,n);break;case"line":tG(e,t,r,n);break;case"fill":iG(e,t,r,n);break;case"fill-extrusion":rG(e,t,r,n);break;case"hillshade":nG(e,t,r,n);break;case"raster":sG(e,t,r,n);break;case"background":uG(e,t,r,n);break;case"custom":gG(e,t,r);break}}translatePosMatrix(e,t,r,n,a){if(!r[0]&&!r[1])return e;let o=a?n==="map"?this.transform.angle:0:n==="viewport"?-this.transform.angle:0;if(o){let u=Math.sin(o),c=Math.cos(o);r=[r[0]*c-r[1]*u,r[0]*u+r[1]*c]}let s=[a?r[0]:ta(t,r[0],this.transform.zoom),a?r[1]:ta(t,r[1],this.transform.zoom),0],l=new Float32Array(16);return ht.translate(l,e,s),l}saveTileTexture(e){let t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let t=this.imageManager.getPattern(e.from.toString()),r=this.imageManager.getPattern(e.to.toString());return!t||!r}useProgram(e,t){this.cache=this.cache||{};let r=e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[r]||(this.cache[r]=new bme(this.context,Sf[e],t,hge[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[r]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;let e=this.context.gl;this.debugOverlayTexture=new zr(this.context,this.debugOverlayCanvas,e.RGBA)}}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}};h(xG,"Painter");var n1e=xG;R();var Er=kt(gi(),1);R();var _G=class bG{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,t,r){let n=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],a=Math.pow(2,r),o=n.map(l=>{l=Tn.transformMat4([],l,e);let u=1/l[3]/t*a;return Tn.mul(l,l,[u,u,1/l[3],u])}),s=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(l=>{let u=yo.sub([],o[l[0]],o[l[1]]),c=yo.sub([],o[l[2]],o[l[1]]),p=yo.normalize([],yo.cross([],u,c)),d=-yo.dot(p,o[l[1]]);return p.concat(d)});return new bG(o,s)}};h(_G,"Frustum");var a1e=_G,wG=class SG{constructor(e,t){this.min=e,this.max=t,this.center=yo.scale([],yo.add([],this.min,this.max),.5)}quadrant(e){let t=[e%2===0,e<2],r=yo.clone(this.min),n=yo.clone(this.max);for(let a=0;a<t.length;a++)r[a]=t[a]?this.min[a]:this.center[a],n[a]=t[a]?this.center[a]:this.max[a];return n[2]=this.max[2],new SG(r,n)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){let t=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],r=!0;for(let n=0;n<e.planes.length;n++){let a=e.planes[n],o=0;for(let s=0;s<t.length;s++)Tn.dot(a,t[s])>=0&&o++;if(o===0)return 0;o!==t.length&&(r=!1)}if(r)return 2;for(let n=0;n<3;n++){let a=Number.MAX_VALUE,o=-Number.MAX_VALUE;for(let s=0;s<e.points.length;s++){let l=e.points[s][n]-this.min[n];a=Math.min(a,l),o=Math.max(o,l)}if(o<0||a>this.max[n]-this.min[n])return 0}return 1}};h(wG,"Aabb");var F6=wG;R();var o1e=kt(gi(),1),MG=class CG{constructor(e=0,t=0,r=0,n=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n}interpolate(e,t,r){return t.top!=null&&e.top!=null&&(this.top=Wi.number(e.top,t.top,r)),t.bottom!=null&&e.bottom!=null&&(this.bottom=Wi.number(e.bottom,t.bottom,r)),t.left!=null&&e.left!=null&&(this.left=Wi.number(e.left,t.left,r)),t.right!=null&&e.right!=null&&(this.right=Wi.number(e.right,t.right,r)),this}getCenter(e,t){let r=Lr((this.left+e-this.right)/2,0,e),n=Lr((this.top+t-this.bottom)/2,0,t);return new o1e.default(r,n)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new CG(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}};h(MG,"EdgeInsets");var s1e=MG,f1=85.051129,EG=class TG{constructor(e,t,r,n,a){this.tileSize=512,this._renderWorldCopies=a===void 0?!0:!!a,this._minZoom=e||0,this._maxZoom=t||22,this._minPitch=r??0,this._maxPitch=n??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new ei(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new s1e,this._posMatrixCache={},this._alignedPosMatrixCache={},this.minElevationForCurrentTile=0}clone(){let e=new TG(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new Er.default(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){let t=-Bu(e,-180,180)*Math.PI/180;this.angle!==t&&(this._unmodified=!1,this.angle=t,this._calcMatrices(),this.rotationMatrix=P3.create(),P3.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){let t=Lr(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==t&&(this._unmodified=!1,this._pitch=t,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){let t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.tileZoom=Math.max(0,Math.floor(t)),this.scale=this.zoomScale(t),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){let t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(e){let t=[new U3(0,e)];if(this._renderWorldCopies){let r=this.pointCoordinate(new Er.default(0,0)),n=this.pointCoordinate(new Er.default(this.width,0)),a=this.pointCoordinate(new Er.default(this.width,this.height)),o=this.pointCoordinate(new Er.default(0,this.height)),s=Math.floor(Math.min(r.x,n.x,a.x,o.x)),l=Math.floor(Math.max(r.x,n.x,a.x,o.x)),u=1;for(let c=s-u;c<=l+u;c++)c!==0&&t.push(new U3(c,e))}return t}coveringTiles(e){var t,r;let n=this.coveringZoomLevel(e),a=n;if(e.minzoom!==void 0&&n<e.minzoom)return[];e.maxzoom!==void 0&&n>e.maxzoom&&(n=e.maxzoom);let o=this.pointCoordinate(this.getCameraPoint()),s=Qr.fromLngLat(this.center),l=Math.pow(2,n),u=[l*o.x,l*o.y,0],c=[l*s.x,l*s.y,0],p=a1e.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n),d=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(d=n);let m=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,g=h(b=>({aabb:new F6([b*l,0,0],[(b+1)*l,l,0]),zoom:0,x:0,y:0,wrap:b,fullyVisible:!1}),"newRootTile"),_=[],y=[],x=n,w=e.reparseOverscaled?a:n;if(this._renderWorldCopies)for(let b=1;b<=3;b++)_.push(g(-b)),_.push(g(b));for(_.push(g(0));_.length>0;){let b=_.pop(),C=b.x,E=b.y,T=b.fullyVisible;if(!T){let $=b.aabb.intersects(p);if($===0)continue;T=$===2}let L=e.terrain?u:c,D=b.aabb.distanceX(L),B=b.aabb.distanceY(L),A=Math.max(Math.abs(D),Math.abs(B)),k=m+(1<<x-b.zoom)-2;if(b.zoom===x||A>k&&b.zoom>=d){let $=x-b.zoom,z=u[0]-.5-(C<<$),P=u[1]-.5-(E<<$);y.push({tileID:new ha(b.zoom===x?w:b.zoom,b.wrap,b.zoom,C,E),distanceSq:T5.sqrLen([c[0]-.5-C,c[1]-.5-E]),tileDistanceToCamera:Math.sqrt(z*z+P*P)});continue}for(let $=0;$<4;$++){let z=(C<<1)+$%2,P=(E<<1)+($>>1),U=b.zoom+1,G=b.aabb.quadrant($);if(e.terrain){let K=new ha(U,b.wrap,U,z,P),O=e.terrain.getMinMaxElevation(K),V=(t=O.minElevation)!=null?t:this.elevation,j=(r=O.maxElevation)!=null?r:this.elevation;G=new F6([G.min[0],G.min[1],V],[G.max[0],G.max[1],j])}_.push({aabb:G,zoom:U,x:z,y:P,wrap:b.wrap,fullyVisible:T})}}return y.sort((b,C)=>b.distanceSq-C.distanceSq).map(b=>b.tileID)}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){let t=Lr(e.lat,-f1,f1);return new Er.default(Wu(e.lng)*this.worldSize,Xu(t)*this.worldSize)}unproject(e){return new Qr(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){let e=this.pointLocation(this.getCameraPoint()),t=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter;return{lngLat:e,altitude:t+this.elevation}}recalculateZoom(e){let t=this.elevation,r=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,n=this.pointLocation(this.centerPoint,e),a=e.getElevationForLngLatZoom(n,this.tileZoom);if(!(this.elevation-a))return;let o=r+t-a,s=Math.cos(this._pitch)*this.cameraToCenterDistance/o/Nv(1,n.lat)/this.tileSize,l=this.scaleZoom(s);this._elevation=a,this._center=n,this.zoom=l}setLocationAtPoint(e,t){let r=this.pointCoordinate(t),n=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),o=new Qr(a.x-(r.x-n.x),a.y-(r.y-n.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,t){return t?this.coordinatePoint(this.locationCoordinate(e),t.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,t){return this.coordinateLocation(this.pointCoordinate(e,t))}locationCoordinate(e){return Qr.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,t){if(t){let _=t.pointCoordinate(e);if(_!=null)return _}let r=0,n=[e.x,e.y,0,1],a=[e.x,e.y,1,1];Tn.transformMat4(n,n,this.pixelMatrixInverse),Tn.transformMat4(a,a,this.pixelMatrixInverse);let o=n[3],s=a[3],l=n[0]/o,u=a[0]/s,c=n[1]/o,p=a[1]/s,d=n[2]/o,m=a[2]/s,g=d===m?0:(r-d)/(m-d);return new Qr(Wi.number(l,u,g)/this.worldSize,Wi.number(c,p,g)/this.worldSize)}coordinatePoint(e,t=0,r=this.pixelMatrix){let n=[e.x*this.worldSize,e.y*this.worldSize,t,1];return Tn.transformMat4(n,n,r),new Er.default(n[0]/n[3],n[1]/n[3])}getBounds(){let e=Math.max(0,this.height/2-this.getHorizon());return new Wl().extend(this.pointLocation(new Er.default(0,e))).extend(this.pointLocation(new Er.default(this.width,e))).extend(this.pointLocation(new Er.default(this.width,this.height))).extend(this.pointLocation(new Er.default(0,this.height)))}getMaxBounds(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new Wl([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-f1,f1])}calculatePosMatrix(e,t=!1){let r=e.key,n=t?this._alignedPosMatrixCache:this._posMatrixCache;if(n[r])return n[r];let a=e.canonical,o=this.worldSize/this.zoomScale(a.z),s=a.x+Math.pow(2,a.z)*e.wrap,l=ht.identity(new Float64Array(16));return ht.translate(l,l,[s*o,a.y*o,0]),ht.scale(l,l,[o/8192,o/8192,1]),ht.multiply(l,t?this.alignedProjMatrix:this.projMatrix,l),n[r]=new Float32Array(l),n[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,t){t=Lr(+t,this.minZoom,this.maxZoom);let r={center:new ei(e.lng,e.lat),zoom:t},n=this.lngRange;if(!this._renderWorldCopies&&n===null){let b=179.9999999999;n=[-b,b]}let a=this.tileSize*this.zoomScale(r.zoom),o=0,s=a,l=0,u=a,c=0,p=0,{x:d,y:m}=this.size;if(this.latRange){let b=this.latRange;o=Xu(b[1])*a,s=Xu(b[0])*a,s-o<m&&(c=m/(s-o))}n&&(l=Bu(Wu(n[0])*a,0,a),u=Bu(Wu(n[1])*a,0,a),u<l&&(u+=a),u-l<d&&(p=d/(u-l)));let{x:g,y:_}=this.project.call({worldSize:a},e),y,x,w=Math.max(p||0,c||0);if(w){let b=new Er.default(p?(u+l)/2:g,c?(s+o)/2:_);return r.center=this.unproject.call({worldSize:a},b).wrap(),r.zoom+=this.scaleZoom(w),r}if(this.latRange){let b=m/2;_-b<o&&(x=o+b),_+b>s&&(x=s-b)}if(n){let b=(l+u)/2,C=g;this._renderWorldCopies&&(C=Bu(g,b-a/2,b+a/2));let E=d/2;C-E<l&&(y=l+E),C+E>u&&(y=u-E)}if(y!==void 0||x!==void 0){let b=new Er.default(y??g,x??_);r.center=this.unproject.call({worldSize:a},b).wrap()}return r}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:t,zoom:r}=this.getConstrained(this.center,this.zoom);this.center=t,this.zoom=r,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;let e=this._fov/2,t=this.centerOffset,r=this.point.x,n=this.point.y;this.cameraToCenterDistance=.5/Math.tan(e)*this.height,this._pixelPerMeter=Nv(1,this.center.lat)*this.worldSize;let a=ht.identity(new Float64Array(16));ht.scale(a,a,[this.width/2,-this.height/2,1]),ht.translate(a,a,[1,-1,0]),this.labelPlaneMatrix=a,a=ht.identity(new Float64Array(16)),ht.scale(a,a,[1,-1,1]),ht.translate(a,a,[-1,-1,0]),ht.scale(a,a,[2/this.width,2/this.height,1]),this.glCoordMatrix=a;let o=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),s=Math.min(this.elevation,this.minElevationForCurrentTile),l=o-s*this._pixelPerMeter/Math.cos(this._pitch),u=s<0?l:o,c=Math.PI/2+this._pitch,p=this._fov*(.5+t.y/this.height),d=Math.sin(p)*u/Math.sin(Lr(Math.PI-c-p,.01,Math.PI-.01)),m=this.getHorizon(),g=2*Math.atan(m/this.cameraToCenterDistance)*(.5+t.y/(m*2)),_=Math.sin(g)*u/Math.sin(Lr(Math.PI-c-g,.01,Math.PI-.01)),y=Math.min(d,_),x=(Math.cos(Math.PI/2-this._pitch)*y+u)*1.01,w=this.height/50;a=new Float64Array(16),ht.perspective(a,this._fov,this.width/this.height,w,x),a[8]=-t.x*2/this.width,a[9]=t.y*2/this.height,ht.scale(a,a,[1,-1,1]),ht.translate(a,a,[0,0,-this.cameraToCenterDistance]),ht.rotateX(a,a,this._pitch),ht.rotateZ(a,a,this.angle),ht.translate(a,a,[-r,-n,0]),this.mercatorMatrix=ht.scale([],a,[this.worldSize,this.worldSize,this.worldSize]),ht.scale(a,a,[1,1,this._pixelPerMeter]),this.pixelMatrix=ht.multiply(new Float64Array(16),this.labelPlaneMatrix,a),ht.translate(a,a,[0,0,-this.elevation]),this.projMatrix=a,this.invProjMatrix=ht.invert([],a),this.pixelMatrix3D=ht.multiply(new Float64Array(16),this.labelPlaneMatrix,a);let b=this.width%2/2,C=this.height%2/2,E=Math.cos(this.angle),T=Math.sin(this.angle),L=r-Math.round(r)+E*b+T*C,D=n-Math.round(n)+E*C+T*b,B=new Float64Array(a);if(ht.translate(B,B,[L>.5?L-1:L,D>.5?D-1:D,0]),this.alignedProjMatrix=B,a=ht.invert(new Float64Array(16),this.pixelMatrix),!a)throw new Error("failed to invert matrix");this.pixelMatrixInverse=a,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let e=this.pointCoordinate(new Er.default(0,0)),t=[e.x*this.worldSize,e.y*this.worldSize,0,1];return Tn.transformMat4(t,t,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let e=this._pitch,t=Math.tan(e)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Er.default(0,t))}getCameraQueryGeometry(e){let t=this.getCameraPoint();if(e.length===1)return[e[0],t];{let r=t.x,n=t.y,a=t.x,o=t.y;for(let s of e)r=Math.min(r,s.x),n=Math.min(n,s.y),a=Math.max(a,s.x),o=Math.max(o,s.y);return[new Er.default(r,n),new Er.default(a,n),new Er.default(a,o),new Er.default(r,o),new Er.default(r,n)]}}lngLatToCameraDepth(e,t){let r=this.locationCoordinate(e),n=[r.x*this.worldSize,r.y*this.worldSize,t,1];return Tn.transformMat4(n,n,this.projMatrix),n[2]/n[3]}};h(EG,"Transform");var l1e=EG;R();R();function uT(i,e){let t=!1,r=null,n=null,a,o=h(()=>{r=null,t&&(i.apply(n,a),r=setTimeout(o,e),t=!1)},"later");return(...s)=>(t=!0,n=this,a=s,r||o(),r)}h(uT,"throttle");var PG=class{constructor(e){this._getCurrentHash=()=>{let t=window.location.hash.replace("#","");if(this._hashName){let r;return t.split("&").map(n=>n.split("=")).forEach(n=>{n[0]===this._hashName&&(r=n)}),(r&&r[1]||"").split("/")}return t.split("/")},this._onHashChange=()=>{let t=this._getCurrentHash();if(t.length>=3&&!t.some(r=>isNaN(r))){let r=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:r,pitch:+(t[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{let t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch{}},this._updateHash=uT(this._updateHashUnthrottled,30*1e3/100),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(e){let t=this._map.getCenter(),r=Math.round(this._map.getZoom()*100)/100,n=Math.ceil((r*Math.LN2+Math.log(512/360/.5))/Math.LN10),a=Math.pow(10,n),o=Math.round(t.lng*a)/a,s=Math.round(t.lat*a)/a,l=this._map.getBearing(),u=this._map.getPitch(),c="";if(e?c+=`/${o}/${s}/${r}`:c+=`${r}/${s}/${o}`,(l||u)&&(c+=`/${Math.round(l*10)/10}`),u&&(c+=`/${Math.round(u)}`),this._hashName){let p=this._hashName,d=!1,m=window.location.hash.slice(1).split("&").map(g=>{let _=g.split("=")[0];return _===p?(d=!0,`${_}=${c}`):g}).filter(g=>g);return d||m.push(`${p}=${c}`),`#${m.join("&")}`}return`#${c}`}};h(PG,"Hash");var u1e=PG;R();R();var h1e=kt(gi(),1),b_={linearity:.3,easing:zx(0,0,.3,1)},c1e=pt({deceleration:2500,maxSpeed:1400},b_),p1e=pt({deceleration:20,maxSpeed:1400},b_),d1e=pt({deceleration:1e3,maxSpeed:360},b_),f1e=pt({deceleration:1e3,maxSpeed:90},b_),AG=class{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:li.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,t=li.now(),r=160;for(;e.length>0&&t-e[0].time>r;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let t={zoom:0,bearing:0,pitch:0,pan:new h1e.default(0,0),pinchAround:void 0,around:void 0};for(let{settings:a}of this._inertiaBuffer)t.zoom+=a.zoomDelta||0,t.bearing+=a.bearingDelta||0,t.pitch+=a.pitchDelta||0,a.panDelta&&t.pan._add(a.panDelta),a.around&&(t.around=a.around),a.pinchAround&&(t.pinchAround=a.pinchAround);let r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,n={};if(t.pan.mag()){let a=Cf(t.pan.mag(),r,pt({},c1e,e||{}));n.offset=t.pan.mult(a.amount/t.pan.mag()),n.center=this._map.transform.center,Mf(n,a)}if(t.zoom){let a=Cf(t.zoom,r,p1e);n.zoom=this._map.transform.zoom+a.amount,Mf(n,a)}if(t.bearing){let a=Cf(t.bearing,r,d1e);n.bearing=this._map.transform.bearing+Lr(a.amount,-179,179),Mf(n,a)}if(t.pitch){let a=Cf(t.pitch,r,f1e);n.pitch=this._map.transform.pitch+a.amount,Mf(n,a)}if(n.zoom||n.bearing){let a=t.pinchAround===void 0?t.around:t.pinchAround;n.around=a?this._map.unproject(a):this._map.getCenter()}return this.clear(),pt(n,{noMoveStart:!0})}};h(AG,"HandlerInertia");var m1e=AG;function Mf(i,e){(!i.duration||i.duration<e.duration)&&(i.duration=e.duration,i.easing=e.easing)}h(Mf,"extendDuration");function Cf(i,e,t){let{maxSpeed:r,linearity:n,deceleration:a}=t,o=Lr(i*n/(e/1e3),-r,r),s=Math.abs(o)/(a*n);return{easing:t.easing,duration:s*1e3,amount:o*(s/2)}}h(Cf,"calculateEasing");R();R();var g1e=kt(gi(),1),IG=class extends Ye{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r,n={}){let a=He.mousePos(t.getCanvas(),r),o=t.unproject(a);super(e,pt({point:a,lngLat:o,originalEvent:r},n)),this._defaultPrevented=!1,this.target=t}};h(IG,"MapMouseEvent");var Ba=IG,LG=class extends Ye{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){let n=e==="touchend"?r.changedTouches:r.touches,a=He.touchPos(t.getCanvasContainer(),n),o=a.map(u=>t.unproject(u)),s=a.reduce((u,c,p,d)=>u.add(c.div(d.length)),new g1e.default(0,0)),l=t.unproject(s);super(e,{points:a,point:s,lngLats:o,lngLat:l,originalEvent:r}),this._defaultPrevented=!1}};h(LG,"MapTouchEvent");var m1=LG,DG=class extends Ye{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){super(e,{originalEvent:r}),this._defaultPrevented=!1}};h(DG,"MapWheelEvent");var y1e=DG,kG=class{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new y1e(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new Ba(e.type,this._map,e))}mouseup(e){this._map.fire(new Ba(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new Ba(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Ba(e.type,this._map,e))}mouseover(e){this._map.fire(new Ba(e.type,this._map,e))}mouseout(e){this._map.fire(new Ba(e.type,this._map,e))}touchstart(e){return this._firePreventable(new m1(e.type,this._map,e))}touchmove(e){this._map.fire(new m1(e.type,this._map,e))}touchend(e){this._map.fire(new m1(e.type,this._map,e))}touchcancel(e){this._map.fire(new m1(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};h(kG,"MapEventHandler");var v1e=kG,RG=class{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Ba(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ba("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Ba(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}};h(RG,"BlockableMapEventHandler");var x1e=RG;R();R();var _1e=kt(gi(),1),FG=class{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(_1e.default.convert(e),this._map.terrain)}};h(FG,"TransformProvider");var Cg=FG,OG=class{constructor(e,t){this._map=e,this._tr=new Cg(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){console.warn("boxZoom will not work. Use SDK interaction events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&e.button===0&&(He.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;let r=t;if(this._lastPos.equals(r)||!this._box&&r.dist(this._startPos)<this._clickTolerance)return;let n=this._startPos;this._lastPos=r,this._box||(this._box=He.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));let a=Math.min(n.x,r.x),o=Math.max(n.x,r.x),s=Math.min(n.y,r.y),l=Math.max(n.y,r.y);He.setTransform(this._box,`translate(${a}px,${s}px)`),this._box.style.width=`${o-a}px`,this._box.style.height=`${l-s}px`}mouseupWindow(e,t){if(!this._active||e.button!==0)return;let r=this._startPos,n=t;if(this.reset(),He.suppressClick(),r.x===n.x&&r.y===n.y)this._fireEvent("boxzoomcancel",e);else return this._map.fire(new Ye("boxzoomend",{originalEvent:e})),{cameraAnimation:a=>a.fitScreenCoordinates(r,n,this._tr.bearing,{linear:!0})}}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(He.remove(this._box),this._box=null),He.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,t){return this._map.fire(new Ye(e,{originalEvent:t}))}};h(OG,"BoxZoomHandler");var b1e=OG;R();R();var w1e=kt(gi(),1);R();function Hv(i,e){if(i.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${i.length}, points ${e.length}`);let t={};for(let r=0;r<i.length;r++)t[i[r].identifier]=e[r];return t}h(Hv,"indexTouches");function BG(i){let e=new w1e.default(0,0);for(let t of i)e._add(t);return e.div(i.length)}h(BG,"getCentroid");var zG=500,S1e=500,hT=30,NG=class{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,t,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=BG(t),this.touches=Hv(r,t)))}touchmove(e,t,r){if(this.aborted||!this.centroid)return;let n=Hv(r,t);for(let a in this.touches){let o=this.touches[a],s=n[a];(!s||s.dist(o)>hT)&&(this.aborted=!0)}}touchend(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>S1e)&&(this.aborted=!0),r.length===0){let n=!this.aborted&&this.centroid;if(this.reset(),n)return n}}};h(NG,"SingleTapRecognizer");var M1e=NG,$G=class{constructor(e){this.singleTap=new M1e(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,r){this.singleTap.touchstart(e,t,r)}touchmove(e,t,r){this.singleTap.touchmove(e,t,r)}touchend(e,t,r){let n=this.singleTap.touchend(e,t,r);if(n){let a=e.timeStamp-this.lastTime<zG,o=!this.lastTap||this.lastTap.dist(n)<hT;if((!a||!o)&&this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}};h($G,"TapRecognizer");var oS=$G,UG=class{constructor(e){this._tr=new Cg(e),this._zoomIn=new oS({numTouches:1,numTaps:2}),this._zoomOut=new oS({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}touchmove(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}touchend(e,t,r){let n=this._zoomIn.touchend(e,t,r),a=this._zoomOut.touchend(e,t,r),o=this._tr;if(n)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s=>s.easeTo({duration:300,zoom:o.zoom+1,around:o.unproject(n)},{originalEvent:e})};if(a)return this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:s=>s.easeTo({duration:300,zoom:o.zoom-1,around:o.unproject(a)},{originalEvent:e})}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};h(UG,"TapZoomHandler");var C1e=UG;R();R();var VG=class{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){let t=this._moveFunction(...e);if(t.bearingDelta||t.pitchDelta||t.around||t.panDelta)return this._active=!0,t}dragStart(e,t){!this.isEnabled()||this._lastPoint||this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=t.length?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;let r=this._lastPoint;if(!r)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e)){this.reset(e);return}let n=t.length?t[0]:t;if(!(!this._moved&&n.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=n,this._move(r,n)}dragEnd(e){!this.isEnabled()||!this._lastPoint||this._moveStateManager.isValidEndEvent(e)&&(this._moved&&He.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}};h(VG,"DragHandler");var Eg=VG;R();var E1e=0,T1e=2,P1e={[E1e]:1,[T1e]:2};function jG(i,e){let t=P1e[e];return i.buttons===void 0||(i.buttons&t)!==t}h(jG,"buttonNoLongerPressed");var HG=class{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let t=He.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!jG(e,this._eventButton)}isValidEndEvent(e){return He.mouseButton(e)===this._eventButton}};h(HG,"MouseMoveStateManager");var cT=HG,GG=class{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){let t=e.targetTouches[0].identifier;this._firstTouch=t}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}};h(GG,"OneFingerTouchMoveStateManager");var WG=GG,pT=0,XG=2,dT=h(i=>{i.mousedown=i.dragStart,i.mousemoveWindow=i.dragMove,i.mouseup=i.dragEnd,i.contextmenu=function(e){e.preventDefault()}},"assignEvents"),A1e=h(({enable:i,clickTolerance:e})=>{let t=new cT({checkCorrectEvent:r=>He.mouseButton(r)===pT&&!r.ctrlKey});return new Eg({clickTolerance:e,move:(r,n)=>({around:n,panDelta:n.sub(r)}),activateOnStart:!0,moveStateManager:t,enable:i,assignEvents:dT})},"generateMousePanHandler"),qG=h(({enable:i,clickTolerance:e,bearingDegreesPerPixelMoved:t=.8})=>{let r=new cT({checkCorrectEvent:n=>He.mouseButton(n)===pT&&n.ctrlKey||He.mouseButton(n)===XG});return new Eg({clickTolerance:e,move:(n,a)=>({bearingDelta:(a.x-n.x)*t}),moveStateManager:r,enable:i,assignEvents:dT})},"generateMouseRotationHandler"),ZG=h(({enable:i,clickTolerance:e,pitchDegreesPerPixelMoved:t=-.5})=>{let r=new cT({checkCorrectEvent:n=>He.mouseButton(n)===pT&&n.ctrlKey||He.mouseButton(n)===XG});return new Eg({clickTolerance:e,move:(n,a)=>({pitchDelta:(a.y-n.y)*t}),moveStateManager:r,enable:i,assignEvents:dT})},"generateMousePitchHandler");R();var z2=kt(gi(),1),YG=class{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new z2.default(0,0)}minTouchs(){return this._map.cooperativeGestures.isEnabled()?2:1}touchstart(e,t,r){return this._calculateTransform(e,t,r)}touchmove(e,t,r){if(!(!this._active||r.length<this.minTouchs()))return e.preventDefault(),this._calculateTransform(e,t,r)}touchend(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this.minTouchs()&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,t,r){r.length>0&&(this._active=!0);let n=Hv(r,t),a=new z2.default(0,0),o=new z2.default(0,0),s=0;for(let u in n){let c=n[u],p=this._touches[u];p&&(a._add(c),o._add(c.sub(p)),s++,n[u]=c)}if(this._touches=n,s<this.minTouchs()||!o.mag())return;let l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};h(YG,"TouchPanHandler");var I1e=YG;R();var JG=class{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,r){if(!this._firstTwoTouches)return;e.preventDefault();let[n,a]=this._firstTwoTouches,o=Ef(r,t,n),s=Ef(r,t,a);if(!o||!s)return;let l=this._aroundCenter?null:o.add(s).div(2);return this._move([o,s],l,e)}touchend(e,t,r){if(!this._firstTwoTouches)return;let[n,a]=this._firstTwoTouches,o=Ef(r,t,n),s=Ef(r,t,a);o&&s||(this._active&&He.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}};h(JG,"TwoFingersTouchHandler");var fT=JG;function Ef(i,e,t){for(let r=0;r<i.length;r++)if(i[r].identifier===t)return e[r]}h(Ef,"getTouchById");var L1e=.1;function sS(i,e){return Math.log(i/e)/Math.LN2}h(sS,"getZoomDelta");var KG=class extends fT{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){let r=this._distance;if(this._distance=e[0].dist(e[1]),!(!this._active&&Math.abs(sS(this._distance,this._startDistance))<L1e))return this._active=!0,{zoomDelta:sS(this._distance,r),pinchAround:t}}};h(KG,"TwoFingersTouchZoomHandler");var D1e=KG,k1e=25;function lS(i,e){return i.angleWith(e)*180/Math.PI}h(lS,"getBearingDelta");var QG=class extends fT{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,r){let n=this._vector;if(this._vector=e[0].sub(e[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:lS(this._vector,n),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let t=Math.PI*this._minDiameter,r=k1e/t*360,n=lS(e,this._startVector);return Math.abs(n)<r}};h(QG,"TwoFingersTouchRotateHandler");var R1e=QG;function Vy(i){return Math.abs(i.y)>Math.abs(i.x)}h(Vy,"isVertical");var F1e=100,eW=class extends fT{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,r){super.touchstart(e,t,r),this._currentTouchCount=r.length}_start(e){this._lastPoints=e,Vy(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,r){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let n=e[0].sub(this._lastPoints[0]),a=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(n,a,r.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(n.y+a.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,r){if(this._valid!==void 0)return this._valid;let n=2,a=e.mag()>=n,o=t.mag()>=n;if(!a&&!o)return;if(!a||!o)return this._firstMove===void 0&&(this._firstMove=r),r-this._firstMove<F1e?void 0:!1;let s=e.y>0==t.y>0;return Vy(e)&&Vy(t)&&s}};h(eW,"TwoFingersTouchPitchHandler");var O1e=eW;R();var B1e={panStep:100,bearingStep:15,pitchStep:10},tW=class{constructor(e){this._tr=new Cg(e);let t=B1e;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,r=0,n=0,a=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?r=-1:(e.preventDefault(),a=-1);break;case 39:e.shiftKey?r=1:(e.preventDefault(),a=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(r=0,n=0),{cameraAnimation:s=>{let l=this._tr;s.easeTo({duration:300,easeId:"keyboardHandler",easing:iW,zoom:t?Math.round(l.zoom)+t*(e.shiftKey?2:1):l.zoom,bearing:l.bearing+r*this._bearingStep,pitch:l.pitch+n*this._pitchStep,offset:[-a*this._panStep,-o*this._panStep],center:l.center},{originalEvent:e})}}}enable(){console.warn("maplibre keyboard events are not supported, use SDK keyboard events instead.")}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}};h(tW,"KeyboardHandler");var z1e=tW;function iW(i){return i*(2-i)}h(iW,"easeOut");R();var O6=4.000244140625,N1e=1/100,$1e=1/450,U1e=2,rW=class{constructor(e,t){this._onTimeout=r=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(r)},this._map=e,this._tr=new Cg(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=N1e,this._wheelZoomRate=$1e}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){console.log("Enable maplibre scrollZoom events will not work. Use Mappedin SDK interactions events instead.")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(e){if(!this.isEnabled()||this._map.cooperativeGestures.isEnabled()&&!e[this._map.cooperativeGestures._bypassKey])return;let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?e.deltaY*40:e.deltaY,r=li.now(),n=r-(this._lastWheelEventTime||0);this._lastWheelEventTime=r,t!==0&&t%O6===0?this._type="wheel":t!==0&&Math.abs(t)<4?this._type="trackpad":n>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(n*t)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t=t/4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let t=He.mousePos(this._map.getCanvas(),e),r=this._tr;t.y>r.transform.height/2-r.transform.getHorizon()?this._around=ei.convert(this._aroundCenter?r.center:r.unproject(t)):this._around=ei.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let e=this._tr.transform;if(this._delta!==0){let s=this._type==="wheel"&&Math.abs(this._delta)>O6?this._wheelZoomRate:this._defaultZoomRate,l=U1e/(1+Math.exp(-Math.abs(this._delta*s)));this._delta<0&&l!==0&&(l=1/l);let u=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(u*l))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let t=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,r=this._startZoom,n=this._easing,a=!1,o;if(this._type==="wheel"&&r&&n){let s=Math.min((li.now()-this._lastWheelEventTime)/200,1),l=n(s);o=Wi.number(r,t,l),s<1?this._frameId||(this._frameId=!0):a=!0}else o=t,a=!0;return this._active=!0,a&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!a,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let t=Vw;if(this._prevEase){let r=this._prevEase,n=(li.now()-r.start)/r.duration,a=r.easing(n+.01)-r.easing(n),o=.27/Math.sqrt(a*a+1e-4)*.01,s=Math.sqrt(.27*.27-o*o);t=zx(o,s,.25,1)}return this._prevEase={start:li.now(),duration:e,easing:t},t}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}};h(rW,"ScrollZoomHandler");var V1e=rW;R();var nW=class{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}};h(nW,"DoubleClickZoomHandler");var j1e=nW;R();var aW=class{constructor(e){this._tr=new Cg(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};h(aW,"ClickZoomHandler");var H1e=aW;R();var oW=class{constructor(){this._tap=new oS({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,r){if(!this._swipePoint)if(!this._tapTime)this._tap.touchstart(e,t,r);else{let n=t[0],a=e.timeStamp-this._tapTime<zG,o=this._tapPoint.dist(n)<hT;!a||!o?this.reset():r.length>0&&(this._swipePoint=n,this._swipeTouch=r[0].identifier)}}touchmove(e,t,r){if(!this._tapTime)this._tap.touchmove(e,t,r);else if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;let n=t[0],a=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:a/128}}}touchend(e,t,r){if(this._tapTime)this._swipePoint&&r.length===0&&this.reset();else{let n=this._tap.touchend(e,t,r);n&&(this._tapTime=e.timeStamp,this._tapPoint=n)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}};h(oW,"TapDragZoomHandler");var G1e=oW;R();var sW=class{constructor(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}enable(e){console.log("Maplibre interaction is not supported. Use Mappedin SDK interaction instead")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}};h(sW,"DragPanHandler");var W1e=sW;R();var lW=class{constructor(e,t,r){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=r}enable(){console.warn("dragRotate does not work. Use SDK interaction events instead.")}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}};h(lW,"DragRotateHandler");var X1e=lW;R();var uW=class{constructor(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}};h(uW,"TwoFingersTouchZoomRotateHandler");var q1e=uW;R();var hW=class{constructor(e,t){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=He.create("div","maplibregl-cooperative-gesture-screen",e);let t=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(t=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let r=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),n=document.createElement("div");n.className="maplibregl-desktop-message",n.textContent=t,this._container.appendChild(n);let a=document.createElement("div");a.className="maplibregl-mobile-message",a.textContent=r,this._container.appendChild(a),this._container.setAttribute("aria-hidden","true")}_destoryUI(){this._container&&(He.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destoryUI()}isEnabled(){return this._enabled}touchmove(e){this._onCooperativeGesture(e.touches.length===1)}wheel(e){this._map.scrollZoom.isEnabled()&&this._onCooperativeGesture(!e[this._bypassKey])}_onCooperativeGesture(e){!this._enabled||!e||(this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}};h(hW,"CooperativeGesturesHandler");var Z1e=hW,Y1e=kt(gi(),1),g1=h(i=>i.zoom||i.drag||i.pitch||i.rotate,"isMoving"),cW=class extends Ye{};h(cW,"RenderFrameEvent");var J1e=cW;function jy(i){return i.panDelta&&i.panDelta.mag()||i.zoomDelta||i.bearingDelta||i.pitchDelta}h(jy,"hasChange");var pW=class{constructor(e,t){this.handleWindowEvent=n=>{this.handleEvent(n,`${n.type}Window`)},this.handleEvent=(n,a)=>{if(n.type==="blur"){this.stop(!0);return}this._updatingCamera=!0;let o=n.type==="renderFrame"?void 0:n,s={needsRenderFrame:!1},l={},u={},c=n.touches,p=c?this._getMapTouches(c):void 0,d=p?He.touchPos(this._map.getCanvas(),p):He.mousePos(this._map.getCanvas(),n);for(let{handlerName:_,handler:y,allowed:x}of this._handlers){if(!y.isEnabled())continue;let w;this._blockedByActive(u,x,_)?y.reset():y[a||n.type]&&(w=y[a||n.type](n,d,p),this.mergeHandlerResult(s,l,w,_,o),w&&w.needsRenderFrame&&this._triggerRenderFrame()),(w||y.isActive())&&(u[_]=y)}let m={};for(let _ in this._previousActiveHandlers)u[_]||(m[_]=o);this._previousActiveHandlers=u,(Object.keys(m).length||jy(s))&&(this._changes.push([s,l,m]),this._triggerRenderFrame()),(Object.keys(u).length||jy(s))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:g}=s;g&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],g(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new m1e(e),this._bearingSnap=t.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(t);let r=this._el;this._listeners=[[r,"touchstart",{passive:!0}],[r,"touchmove",{passive:!1}],[r,"touchend",void 0],[r,"touchcancel",void 0],[r,"mousedown",void 0],[r,"mousemove",void 0],[r,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[r,"mouseover",void 0],[r,"mouseout",void 0],[r,"dblclick",void 0],[r,"click",void 0],[r,"keydown",{capture:!1}],[r,"keyup",void 0],[r,"wheel",{passive:!1}],[r,"contextmenu",void 0],[window,"blur",void 0]];for(let[n,a,o]of this._listeners);}destroy(){for(let[e,t,r]of this._listeners)He.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,r)}_addDefaultHandlers(e){let t=this._map,r=t.getCanvasContainer();this._add("mapEvent",new v1e(t,e));let n=t.boxZoom=new b1e(t,e);this._add("boxZoom",n),e.interactive&&e.boxZoom&&n.enable();let a=t.cooperativeGestures=new Z1e(t,e.cooperativeGestures);this._add("cooperativeGestures",a),e.cooperativeGestures&&a.enable();let o=new C1e(t),s=new H1e(t);t.doubleClickZoom=new j1e(s,o),this._add("tapZoom",o),this._add("clickZoom",s),e.interactive&&e.doubleClickZoom&&t.doubleClickZoom.enable();let l=new G1e;this._add("tapDragZoom",l);let u=t.touchPitch=new O1e(t);this._add("touchPitch",u),e.interactive&&e.touchPitch&&t.touchPitch.enable(e.touchPitch);let c=qG(e),p=ZG(e);t.dragRotate=new X1e(e,c,p),this._add("mouseRotate",c,["mousePitch"]),this._add("mousePitch",p,["mouseRotate"]),e.interactive&&e.dragRotate&&t.dragRotate.enable();let d=A1e(e),m=new I1e(e,t);t.dragPan=new W1e(r,d,m),this._add("mousePan",d),this._add("touchPan",m,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&t.dragPan.enable(e.dragPan);let g=new R1e,_=new D1e;t.touchZoomRotate=new q1e(r,_,g,l),this._add("touchRotate",g,["touchPan","touchZoom"]),this._add("touchZoom",_,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&t.touchZoomRotate.enable(e.touchZoomRotate);let y=t.scrollZoom=new V1e(t,()=>this._triggerRenderFrame());this._add("scrollZoom",y,["mousePan"]),e.interactive&&e.scrollZoom&&t.scrollZoom.enable(e.scrollZoom);let x=t.keyboard=new z1e(t);this._add("keyboard",x),e.interactive&&e.keyboard&&t.keyboard.enable(),this._add("blockableMapEvent",new x1e(t))}_add(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(let{handler:t}of this._handlers)t.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!g1(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,t,r){for(let n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1}_getMapTouches(e){let t=[];for(let r of e){let n=r.target;this._el.contains(n)&&t.push(r)}return t}mergeHandlerResult(e,t,r,n,a){if(!r)return;pt(e,r);let o={handlerName:n,originalEvent:r.originalEvent||a};r.zoomDelta!==void 0&&(t.zoom=o),r.panDelta!==void 0&&(t.drag=o),r.pitchDelta!==void 0&&(t.pitch=o),r.bearingDelta!==void 0&&(t.rotate=o)}_applyChanges(){let e={},t={},r={};for(let[n,a,o]of this._changes)n.panDelta&&(e.panDelta=(e.panDelta||new Y1e.default(0,0))._add(n.panDelta)),n.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+n.zoomDelta),n.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+n.bearingDelta),n.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+n.pitchDelta),n.around!==void 0&&(e.around=n.around),n.pinchAround!==void 0&&(e.pinchAround=n.pinchAround),n.noInertia&&(e.noInertia=n.noInertia),pt(t,a),pt(r,o);this._updateMapTransform(e,t,r),this._changes=[]}_updateMapTransform(e,t,r){let n=this._map,a=n._getTransformForUpdate(),o=n.terrain;if(!jy(e)&&!(o&&this._terrainMovement))return this._fireEvents(t,r,!0);let{panDelta:s,zoomDelta:l,bearingDelta:u,pitchDelta:c,around:p,pinchAround:d}=e;d!==void 0&&(p=d),n._stop(!0),p=p||n.transform.centerPoint;let m=a.pointLocation(s?p.sub(s):p);u&&(a.bearing+=u),c&&(a.pitch+=c),l&&(a.zoom+=l),o?!this._terrainMovement&&(t.drag||t.zoom)?(this._terrainMovement=!0,this._map._elevationFreeze=!0,a.setLocationAtPoint(m,p),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,a.recalculateZoom(n.terrain)})):t.drag&&this._terrainMovement?a.center=a.pointLocation(a.centerPoint.sub(s)):a.setLocationAtPoint(m,p):a.setLocationAtPoint(m,p),n._applyUpdatedTransform(a),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,r,!0)}_fireEvents(e,t,r){let n=g1(this._eventsInProgress),a=g1(e),o={};for(let c in e){let{originalEvent:p}=e[c];this._eventsInProgress[c]||(o[`${c}start`]=p),this._eventsInProgress[c]=e[c]}!n&&a&&this._fireEvent("movestart",a.originalEvent);for(let c in o)this._fireEvent(c,o[c]);a&&this._fireEvent("move",a.originalEvent);for(let c in e){let{originalEvent:p}=e[c];this._fireEvent(c,p)}let s={},l;for(let c in this._eventsInProgress){let{handlerName:p,originalEvent:d}=this._eventsInProgress[c];this._handlersById[p].isActive()||(delete this._eventsInProgress[c],l=t[p]||d,s[`${c}end`]=l)}for(let c in s)this._fireEvent(c,s[c]);let u=g1(this._eventsInProgress);if(r&&(n||a)&&!u){this._updatingCamera=!0;let c=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),p=h(d=>d!==0&&-this._bearingSnap<d&&d<this._bearingSnap,"shouldSnapToNorth");c&&(c.essential||!li.prefersReducedMotion)?(p(c.bearing||this._map.getBearing())&&(c.bearing=0),c.freezeElevation=!0,this._map.easeTo(c,{originalEvent:l})):(this._map.fire(new Ye("moveend",{originalEvent:l})),p(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,t){this._map.fire(new Ye(e,t?{originalEvent:t}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new J1e("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}};h(pW,"HandlerManager");var K1e=pW;R();var ss=kt(gi(),1),dW=class extends mn{constructor(e,t){super(),this._renderFrameCallback=()=>{let r=Math.min((li.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(r)),r<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=t.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new ei(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(e,t,r){return e=ss.default.convert(e).mult(-1),this.panTo(this.transform.center,pt({offset:e},t),r)}panTo(e,t,r){return this.easeTo(pt({center:e},t),r)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,t,r){return this.easeTo(pt({zoom:e},t),r)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,t,r){return this.easeTo(pt({bearing:e},t),r)}resetNorth(e,t){return this.rotateTo(0,pt({duration:1e3},e),t),this}resetNorthPitch(e,t){return this.easeTo(pt({bearing:0,pitch:0,duration:1e3},e),t),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(e,t){e=Wl.convert(e);let r=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),r,t)}_cameraForBoxAndBearing(e,t,r,n){let a={top:0,bottom:0,right:0,left:0};if(n=pt({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},n),typeof n.padding=="number"){let z=n.padding;n.padding={top:z,bottom:z,right:z,left:z}}n.padding=pt(a,n.padding);let o=this.transform,s=o.padding,l=new Wl(e,t),u=o.project(l.getNorthWest()),c=o.project(l.getNorthEast()),p=o.project(l.getSouthEast()),d=o.project(l.getSouthWest()),m=jw(-r),g=u.rotate(m),_=c.rotate(m),y=p.rotate(m),x=d.rotate(m),w=new ss.default(Math.max(g.x,_.x,x.x,y.x),Math.max(g.y,_.y,x.y,y.y)),b=new ss.default(Math.min(g.x,_.x,x.x,y.x),Math.min(g.y,_.y,x.y,y.y)),C=w.sub(b),E=(o.width-(s.left+s.right+n.padding.left+n.padding.right))/C.x,T=(o.height-(s.top+s.bottom+n.padding.top+n.padding.bottom))/C.y;if(T<0||E<0){dn("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}let L=Math.min(o.scaleZoom(o.scale*Math.min(E,T)),n.maxZoom),D=ss.default.convert(n.offset),B=(n.padding.left-n.padding.right)/2,A=(n.padding.top-n.padding.bottom)/2,k=new ss.default(B,A).rotate(jw(r)),$=D.add(k).mult(o.scale/o.zoomScale(L));return{center:o.unproject(u.add(p).div(2).sub($)),zoom:L,bearing:r}}fitBounds(e,t,r){return this._fitInternal(this.cameraForBounds(e,t),t,r)}fitScreenCoordinates(e,t,r,n,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(ss.default.convert(e)),this.transform.pointLocation(ss.default.convert(t)),r,n),n,a)}_fitInternal(e,t,r){return e?(t=pt(e,t),delete t.padding,t.linear?this.easeTo(t,r):this.flyTo(t,r)):this}jumpTo(e,t){this.stop();let r=this._getTransformForUpdate(),n=!1,a=!1,o=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(n=!0,r.zoom=+e.zoom),e.center!==void 0&&(r.center=ei.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(a=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(o=!0,r.pitch=+e.pitch),e.padding!=null&&!r.isPaddingEqual(e.padding)&&(r.padding=e.padding),this._applyUpdatedTransform(r),this.fire(new Ye("movestart",t)).fire(new Ye("move",t)),n&&this.fire(new Ye("zoomstart",t)).fire(new Ye("zoom",t)).fire(new Ye("zoomend",t)),a&&this.fire(new Ye("rotatestart",t)).fire(new Ye("rotate",t)).fire(new Ye("rotateend",t)),o&&this.fire(new Ye("pitchstart",t)).fire(new Ye("pitch",t)).fire(new Ye("pitchend",t)),this.fire(new Ye("moveend",t))}calculateCameraOptionsFromTo(e,t,r,n=0){let a=Qr.fromLngLat(e,t),o=Qr.fromLngLat(r,n),s=o.x-a.x,l=o.y-a.y,u=o.z-a.z,c=Math.hypot(s,l,u);if(c===0)throw new Error("Can't calculate camera options with same From and To");let p=Math.hypot(s,l),d=this.transform.scaleZoom(this.transform.cameraToCenterDistance/c/this.transform.tileSize),m=Math.atan2(s,-l)*180/Math.PI,g=Math.acos(p/c)*180/Math.PI;return g=u<0?90-g:90+g,{center:o.toLngLat(),zoom:d,pitch:g,bearing:m}}easeTo(e,t){var r;this._stop(!1,e.easeId),e=pt({offset:[0,0],duration:500,easing:Vw},e),(e.animate===!1||!e.essential&&li.prefersReducedMotion)&&(e.duration=0);let n=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l=this.getPadding(),u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:n.padding,d=ss.default.convert(e.offset),m=n.centerPoint.add(d),g=n.pointLocation(m),{center:_,zoom:y}=n.getConstrained(ei.convert(e.center||g),(r=e.zoom)!=null?r:a);this._normalizeCenter(_);let x=n.project(g),w=n.project(_).sub(x),b=n.zoomScale(y-a),C,E;e.around&&(C=ei.convert(e.around),E=n.locationPoint(C));let T={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||y!==a,this._rotating=this._rotating||o!==u,this._pitching=this._pitching||c!==s,this._padding=!n.isPaddingEqual(p),this._easeId=e.easeId,this._prepareEase(t,e.noMoveStart,T),this.terrain&&this._prepareElevation(_),this._ease(L=>{if(this._zooming&&(n.zoom=Wi.number(a,y,L)),this._rotating&&(n.bearing=Wi.number(o,u,L)),this._pitching&&(n.pitch=Wi.number(s,c,L)),this._padding&&(n.interpolatePadding(l,p,L),m=n.centerPoint.add(d)),this.terrain&&!e.freezeElevation&&this._updateElevation(L),C)n.setLocationAtPoint(C,E);else{let D=n.zoomScale(n.zoom-a),B=y>a?Math.min(2,b):Math.max(.5,b),A=Math.pow(B,1-L),k=n.unproject(x.add(w.mult(L*A)).mult(D));n.setLocationAtPoint(n.renderWorldCopies?k.wrap():k,m)}this._applyUpdatedTransform(n),this._fireMoveEvents(t)},L=>{this.terrain&&this._finalizeElevation(),this._afterEase(t,L)},e),this}_prepareEase(e,t,r={}){this._moving=!0,!t&&!r.moving&&this.fire(new Ye("movestart",e)),this._zooming&&!r.zooming&&this.fire(new Ye("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new Ye("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new Ye("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let t=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&t!==this._elevationTarget){let r=this._elevationTarget-this._elevationStart,n=(t-(r*e+this._elevationStart))/(1-e);this._elevationStart+=e*(r-n),this._elevationTarget=t}this.transform.elevation=Wi.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(e){if(!this.transformCameraUpdate)return;let t=e.clone(),{center:r,zoom:n,pitch:a,bearing:o,elevation:s}=this.transformCameraUpdate(t);r&&(t.center=r),n!==void 0&&(t.zoom=n),a!==void 0&&(t.pitch=a),o!==void 0&&(t.bearing=o),s!==void 0&&(t.elevation=s),this.transform.apply(t)}_fireMoveEvents(e){this.fire(new Ye("move",e)),this._zooming&&this.fire(new Ye("zoom",e)),this._rotating&&this.fire(new Ye("rotate",e)),this._pitching&&this.fire(new Ye("pitch",e))}_afterEase(e,t){if(this._easeId&&t&&this._easeId===t)return;delete this._easeId;let r=this._zooming,n=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new Ye("zoomend",e)),n&&this.fire(new Ye("rotateend",e)),a&&this.fire(new Ye("pitchend",e)),this.fire(new Ye("moveend",e))}flyTo(e,t){var r;if(!e.essential&&li.prefersReducedMotion){let K=hg(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(K,t)}this.stop(),e=pt({offset:[0,0],speed:1.2,curve:1.42,easing:Vw},e);let n=this._getTransformForUpdate(),a=this.getZoom(),o=this.getBearing(),s=this.getPitch(),l=this.getPadding(),u="bearing"in e?this._normalizeBearing(e.bearing,o):o,c="pitch"in e?+e.pitch:s,p="padding"in e?e.padding:n.padding,d=ss.default.convert(e.offset),m=n.centerPoint.add(d),g=n.pointLocation(m),{center:_,zoom:y}=n.getConstrained(ei.convert(e.center||g),(r=e.zoom)!=null?r:a);this._normalizeCenter(_);let x=n.zoomScale(y-a),w=n.project(g),b=n.project(_).sub(w),C=e.curve,E=Math.max(n.width,n.height),T=E/x,L=b.mag();if("minZoom"in e){let K=Lr(Math.min(e.minZoom,a,y),n.minZoom,n.maxZoom),O=E/n.zoomScale(K-a);C=Math.sqrt(O/L*2)}let D=C*C;function B(K){let O=(T*T-E*E+(K?-1:1)*D*D*L*L)/(2*(K?T:E)*D*L);return Math.log(Math.sqrt(O*O+1)-O)}h(B,"zoomOutFactor");function A(K){return(Math.exp(K)-Math.exp(-K))/2}h(A,"sinh");function k(K){return(Math.exp(K)+Math.exp(-K))/2}h(k,"cosh");function $(K){return A(K)/k(K)}h($,"tanh");let z=B(!1),P=h(function(K){return k(z)/k(z+C*K)},"w"),U=h(function(K){return E*((k(z)*$(z+C*K)-A(z))/D)/L},"u"),G=(B(!0)-z)/C;if(Math.abs(L)<1e-6||!isFinite(G)){if(Math.abs(E-T)<1e-6)return this.easeTo(e,t);let K=T<E?-1:1;G=Math.abs(Math.log(T/E))/C,U=h(function(){return 0},"u"),P=h(function(O){return Math.exp(K*C*O)},"w")}if("duration"in e)e.duration=+e.duration;else{let K="screenSpeed"in e?+e.screenSpeed/C:+e.speed;e.duration=1e3*G/K}return e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=o!==u,this._pitching=c!==s,this._padding=!n.isPaddingEqual(p),this._prepareEase(t,!1),this.terrain&&this._prepareElevation(_),this._ease(K=>{let O=K*G,V=1/P(O);n.zoom=K===1?y:a+n.scaleZoom(V),this._rotating&&(n.bearing=Wi.number(o,u,K)),this._pitching&&(n.pitch=Wi.number(s,c,K)),this._padding&&(n.interpolatePadding(l,p,K),m=n.centerPoint.add(d)),this.terrain&&!e.freezeElevation&&this._updateElevation(K);let j=K===1?_:n.unproject(w.add(b.mult(U(O))).mult(V));n.setLocationAtPoint(n.renderWorldCopies?j.wrap():j,m),this._applyUpdatedTransform(n),this._fireMoveEvents(t)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(t)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let r=this._onEaseEnd;delete this._onEaseEnd,r.call(this,t)}if(!e){let r=this.handlers;r&&r.stop(!1)}return this}_ease(e,t,r){r.animate===!1||r.duration===0?(e(1),t()):(this._easeStart=li.now(),this._easeOptions=r,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,t){e=Bu(e,-180,180);let r=Math.abs(e-t);return Math.abs(e-360-t)<r&&(e-=360),Math.abs(e+360-t)<r&&(e+=360),e}_normalizeCenter(e){let t=this.transform;if(!t.renderWorldCopies||t.lngRange)return;let r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(ei.convert(e),this.transform.tileZoom)-this.transform.elevation:null}};h(dW,"Camera");var Q1e=dW,Ys=kt(gi(),1);R();var fW={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'},mW=class{constructor(e=fW){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=t=>{t&&(t.sourceDataType==="metadata"||t.sourceDataType==="visibility"||t.dataType==="style"||t.type==="terrain")&&this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):!this._container.classList.contains("maplibregl-compact")&&!this._container.classList.contains("maplibregl-attrib-empty")&&(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=He.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=He.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=He.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){He.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){let r=this._map._getUIString(`AttributionControl.${t}`);e.title=r,e.setAttribute("aria-label",r)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(n=>typeof n!="string"?"":n)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let n=this._map.style.stylesheet;this.styleOwner=n.owner,this.styleId=n.id}let t=this._map.style.sourceCaches;for(let n in t){let a=t[n];if(a.used||a.usedForTerrain){let o=a.getSource();o.attribution&&e.indexOf(o.attribution)<0&&e.push(o.attribution)}}e=e.filter(n=>String(n).trim()),e.sort((n,a)=>n.length-a.length),e=e.filter((n,a)=>{for(let o=a+1;o<e.length;o++)if(e[o].indexOf(n)>=0)return!1;return!0});let r=e.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,e.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}};h(mW,"AttributionControl");var eye=mW;R();var gW=class{constructor(e={}){this._updateCompact=()=>{let t=this._container.children;if(t.length){let r=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&r.classList.add("maplibregl-compact"):r.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=He.create("div","maplibregl-ctrl");let t=He.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){He.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}};h(gW,"LogoControl");var tye=gW;R();var yW=class{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){let t=this._currentlyRunning,r=t?this._queue.concat(t):this._queue;for(let n of r)if(n.id===e){n.cancelled=!0;return}}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let t=this._currentlyRunning=this._queue;this._queue=[];for(let r of t)if(!r.cancelled&&(r.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}};h(yW,"TaskQueue");var iye=yW;R();var uS=(i=>(i.create="create",i.load="load",i.fullLoad="fullLoad",i))(uS||{}),y1=null,jd=[],rye=60,N2=1e3/rye,$2="loadTime",U2="fullLoadTime",Hd={mark(i){performance.mark(i)},frame(i){let e=i;if(y1!=null){let t=e-y1;jd.push(t)}y1=e},clearMetrics(){y1=null,jd=[],performance.clearMeasures($2),performance.clearMeasures(U2);for(let i in uS)performance.clearMarks(uS[i])},getPerformanceMetrics(){performance.measure($2,"create","load"),performance.measure(U2,"create","fullLoad");let i=performance.getEntriesByName($2)[0].duration,e=performance.getEntriesByName(U2)[0].duration,t=jd.length,r=1/(jd.reduce((o,s)=>o+s,0)/t/1e3),n=jd.filter(o=>o>N2).reduce((o,s)=>o+(s-N2)/N2,0),a=n/(t+n)*100;return{loadTime:i,fullLoadTime:e,fps:r,percentDroppedFrames:a,totalFrames:t}}};R();R();var nye=Yi([{name:"a_pos3d",type:"Int16",components:3}]);R();var vW=class extends mn{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,t){this.sourceCache.update(e,t),this._renderableTilesKeys=[];let r={};for(let n of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:t}))r[n.key]=!0,this._renderableTilesKeys.push(n.key),this._tiles[n.key]||(n.posMatrix=new Float64Array(16),ht.ortho(n.posMatrix,0,8192,0,8192,0,1),this._tiles[n.key]=new uj(n,this.tileSize));for(let n in this._tiles)r[n]||delete this._tiles[n]}freeRtt(e){for(let t in this._tiles){let r=this._tiles[t];(!e||r.tileID.equals(e)||r.tileID.isChildOf(e)||e.isChildOf(r.tileID))&&(r.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){let t={};for(let r of this._renderableTilesKeys){let n=this._tiles[r].tileID;if(n.canonical.equals(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16),ht.ortho(a.posMatrix,0,8192,0,8192,0,1),t[r]=a}else if(n.canonical.isChildOf(e.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=n.canonical.z-e.canonical.z,s=n.canonical.x-(n.canonical.x>>o<<o),l=n.canonical.y-(n.canonical.y>>o<<o),u=8192>>o;ht.ortho(a.posMatrix,0,u,0,u,0,1),ht.translate(a.posMatrix,a.posMatrix,[-s*u,-l*u,0]),t[r]=a}else if(e.canonical.isChildOf(n.canonical)){let a=e.clone();a.posMatrix=new Float64Array(16);let o=e.canonical.z-n.canonical.z,s=e.canonical.x-(e.canonical.x>>o<<o),l=e.canonical.y-(e.canonical.y>>o<<o),u=8192>>o;ht.ortho(a.posMatrix,0,8192,0,8192,0,1),ht.translate(a.posMatrix,a.posMatrix,[s*u,l*u,0]),ht.scale(a.posMatrix,a.posMatrix,[1/2**o,1/2**o,0]),t[r]=a}}return t}getSourceTile(e,t){let r=this.sourceCache._source,n=e.overscaledZ-this.deltaZoom;if(n>r.maxzoom&&(n=r.maxzoom),n<r.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(n).key);let a=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if(!(a&&a.dem)&&t)for(;n>=r.minzoom&&!(a&&a.dem);)a=this.sourceCache.getTileByID(e.scaledTo(n--).key);return a}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(t=>t.timeAdded>=e)}};h(vW,"TerrainSourceCache");var aye=vW,xW=class{constructor(e,t,r){this.painter=e,this.sourceCache=new aye(t),this.options=r,this.exaggeration=typeof r.exaggeration=="number"?r.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,t,r,n=8192){var a;if(!(t>=0&&t<n&&r>=0&&r<n))return 0;let o=this.getTerrainData(e),s=(a=o.tile)==null?void 0:a.dem;if(!s)return 0;let l=T5.transformMat4([],[t/n*8192,r/n*8192],o.u_terrain_matrix),u=[l[0]*s.dim,l[1]*s.dim],c=Math.floor(u[0]),p=Math.floor(u[1]),d=u[0]-c,m=u[1]-p;return s.get(c,p)*(1-d)*(1-m)+s.get(c+1,p)*d*(1-m)+s.get(c,p+1)*(1-d)*m+s.get(c+1,p+1)*d*m}getElevationForLngLatZoom(e,t){let{tileID:r,mercatorX:n,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,t);return this.getElevation(r,n%8192,a%8192,8192)}getElevation(e,t,r,n=8192){return this.getDEMElevation(e,t,r,n)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let n=this.painter.context,a=new rr({width:1,height:1},new Uint8Array(1*4));this._emptyDepthTexture=new zr(n,a,n.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new zr(n,new rr({width:1,height:1}),n.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=ht.identity([])}let t=this.sourceCache.getSourceTile(e,!0);if(t&&t.dem&&(!t.demTexture||t.needsTerrainPrepare)){let n=this.painter.context;t.demTexture=this.painter.getTileTexture(t.dem.stride),t.demTexture?t.demTexture.update(t.dem.getPixels(),{premultiply:!1}):t.demTexture=new zr(n,t.dem.getPixels(),n.gl.RGBA,{premultiply:!1}),t.demTexture.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),t.needsTerrainPrepare=!1}let r=t&&t+t.tileID.key+e.key;if(r&&!this._demMatrixCache[r]){let n=this.sourceCache.sourceCache._source.maxzoom,a=e.canonical.z-t.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=n?a=e.canonical.z-n:dn("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let o=e.canonical.x-(e.canonical.x>>a<<a),s=e.canonical.y-(e.canonical.y>>a<<a),l=ht.fromScaling(new Float64Array(16),[1/(8192<<a),1/(8192<<a),0]);ht.translate(l,l,[o*8192,s*8192,0]),this._demMatrixCache[e.key]={matrix:l,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:t&&t.dem&&t.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:t&&t.dem&&t.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(t&&t.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:t}}getFramebuffer(e){let t=this.painter,r=t.width/devicePixelRatio,n=t.height/devicePixelRatio;return this._fbo&&(this._fbo.width!==r||this._fbo.height!==n)&&(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new zr(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new zr(t.context,{width:r,height:n,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(r,n,!0,!1),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,r,n))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let t=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let a=0,o=0;a<this._coordsTextureSize;a++)for(let s=0;s<this._coordsTextureSize;s++,o+=4)t[o+0]=s&255,t[o+1]=a&255,t[o+2]=s>>8<<4|a>>8,t[o+3]=0;let r=new rr({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(t.buffer)),n=new zr(e,r,e.gl.RGBA,{premultiply:!1});return n.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=n,n}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let t=new Uint8Array(4),r=this.painter.context,n=r.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),n.readPixels(a,s-o-1,1,1,n.RGBA,n.UNSIGNED_BYTE,t),r.bindFramebuffer.set(null);let l=t[0]+(t[2]>>4<<8),u=t[1]+((t[2]&15)<<8),c=this.coordsIndex[255-t[3]],p=c&&this.sourceCache.getTileByID(c);if(!p)return null;let d=this._coordsTextureSize,m=(1<<p.tileID.canonical.z)*d;return new Qr((p.tileID.canonical.x*d+l)/m+p.tileID.wrap,(p.tileID.canonical.y*d+u)/m,this.getElevation(p.tileID,l,u,d))}depthAtPoint(e){let t=new Uint8Array(4),r=this.painter.context,n=r.gl;return r.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),n.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,n.RGBA,n.UNSIGNED_BYTE,t),r.bindFramebuffer.set(null),(t[0]/(256*256*256)+t[1]/(256*256)+t[2]/256+t[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;let e=this.painter.context,t=new oce,r=new Ch,n=this.meshSize,a=8192/n,o=n*n;for(let p=0;p<=n;p++)for(let d=0;d<=n;d++)t.emplaceBack(d*a,p*a,0);for(let p=0;p<o;p+=n+1)for(let d=0;d<n;d++)r.emplaceBack(d+p,n+d+p+1,n+d+p+2),r.emplaceBack(d+p,n+d+p+2,d+p+1);let s=t.length,l=s+(n+1)*2;for(let p of[0,1])for(let d=0;d<=n;d++)for(let m of[0,1])t.emplaceBack(d*a,p*8192,m);for(let p=0;p<n*2;p+=2)r.emplaceBack(l+p,l+p+1,l+p+3),r.emplaceBack(l+p,l+p+3,l+p+2),r.emplaceBack(s+p,s+p+3,s+p+1),r.emplaceBack(s+p,s+p+2,s+p+3);let u=t.length,c=u+(n+1)*2;for(let p of[0,1])for(let d=0;d<=n;d++)for(let m of[0,1])t.emplaceBack(p*8192,d*a,m);for(let p=0;p<n*2;p+=2)r.emplaceBack(u+p,u+p+1,u+p+3),r.emplaceBack(u+p,u+p+3,u+p+2),r.emplaceBack(c+p,c+p+3,c+p+1),r.emplaceBack(c+p,c+p+2,c+p+3);return this._mesh={indexBuffer:e.createIndexBuffer(r),vertexBuffer:e.createVertexBuffer(t,nye.members),segments:fr.simpleSegment(0,0,t.length,r.length)},this._mesh}getMeshFrameDelta(e){return 2*Math.PI*Z5/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,t){var r;let{tileID:n}=this._getOverscaledTileIDFromLngLatZoom(e,t);return(r=this.getMinMaxElevation(n).minElevation)!=null?r:0}getMinMaxElevation(e){let t=this.getTerrainData(e).tile,r={minElevation:null,maxElevation:null};return t&&t.dem&&(r.minElevation=t.dem.min*this.exaggeration,r.maxElevation=t.dem.max*this.exaggeration),r}_getOverscaledTileIDFromLngLatZoom(e,t){let r=Qr.fromLngLat(e.wrap()),n=(1<<t)*8192,a=r.x*n,o=r.y*n,s=Math.floor(a/8192),l=Math.floor(o/8192);return{tileID:new ha(t,0,t,s,l),mercatorX:a,mercatorY:o}}};h(xW,"Terrain");var oye=xW;R();R();var _W=class{constructor(e,t,r){this._context=e,this._size=t,this._tileSize=r,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let t=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),r=new zr(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return r.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),t.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),t.colorAttachment.set(r.texture),{id:e,fbo:t,texture:r,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(t=>e.id!==t),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return this._objects.length<this._size?!1:this._objects.some(e=>!e.inUse)===!1}};h(_W,"RenderPool");var sye=_W,Bh={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0},bW=class{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new sye(e.context,30,t.sourceCache.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(r=>!e._layers[r].isHidden(t)),this._coordsDescendingInv={};for(let r in e.sourceCaches){this._coordsDescendingInv[r]={};let n=e.sourceCaches[r].getVisibleCoordinates();for(let a of n){let o=this.terrain.sourceCache.getTerrainCoords(a);for(let s in o)this._coordsDescendingInv[r][s]||(this._coordsDescendingInv[r][s]=[]),this._coordsDescendingInv[r][s].push(o[s])}}this._coordsDescendingInvStr={};for(let r of e._order){let n=e._layers[r],a=n.source;if(Bh[n.type]&&!this._coordsDescendingInvStr[a]){this._coordsDescendingInvStr[a]={};for(let o in this._coordsDescendingInv[a])this._coordsDescendingInvStr[a][o]=this._coordsDescendingInv[a][o].map(s=>s.key).sort().join()}}for(let r of this._renderableTiles)for(let n in this._coordsDescendingInvStr){let a=this._coordsDescendingInvStr[n][r.tileID.key];a&&a!==r.rttCoords[n]&&(r.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;let t=e.type,r=this.painter,n=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Bh[t]&&((!this._prevType||!Bh[this._prevType])&&this._stacks.push([]),this._prevType=t,this._stacks[this._stacks.length-1].push(e.id),!n))return!0;if(Bh[this._prevType]||Bh[t]&&n){this._prevType=t;let a=this._stacks.length-1,o=this._stacks[a]||[];for(let s of this._renderableTiles){if(this.pool.isFull()&&(aS(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(s),s.rtt[a]){let u=this.pool.getObjectForId(s.rtt[a].id);if(u.stamp===s.rtt[a].stamp){this.pool.useObject(u);continue}}let l=this.pool.getOrCreateFreeObject();this.pool.useObject(l),this.pool.stampObject(l),s.rtt[a]={id:l.id,stamp:l.stamp},r.context.bindFramebuffer.set(l.fbo.framebuffer),r.context.clear({color:zt.transparent,stencil:0}),r.currentStencilSource=void 0;for(let u=0;u<o.length;u++){let c=r.style._layers[o[u]],p=c.source?this._coordsDescendingInv[c.source][s.tileID.key]:[s.tileID];r.context.viewport.set([0,0,l.fbo.width,l.fbo.height]),r._renderTileClippingMasks(c,p),r.renderLayer(r,r.style.sourceCaches[c.source],c,p),c.source&&(s.rttCoords[c.source]=this._coordsDescendingInvStr[c.source][s.tileID.key])}}return aS(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Bh[t]}return!1}};h(bW,"RenderToTexture");var lye=bW;R();var uye={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use ⌘ + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},hye=fD.version,Hy=-2,wW=22,ol=0,SW=80,v1=85,cye={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:Hy,maxZoom:wW,minPitch:ol,maxPitch:SW,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:fW,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:Co.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},MW=class extends Q1e{constructor(e){if(Hd.mark("create"),e=pt({},cye,e),e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<ol)throw new Error(`minPitch must be greater than or equal to ${ol}`);if(e.maxPitch!=null&&e.maxPitch>v1)throw new Error(`maxPitch must be less than or equal to ${v1}`);let t=new l1e(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies);if(super(t,{bearingSnap:e.bearingSnap}),this._contextLost=n=>{n.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new Ye("webglcontextlost",{originalEvent:n}))},this._contextRestored=n=>{this._setupPainter(),this.resize(),this._update(),this.fire(new Ye("webglcontextrestored",{originalEvent:n}))},this._onMapScroll=n=>{if(n.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=e.preserveDrawingBuffer,this._antialias=e.antialias,this._trackResize=e.trackResize,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=e.collectResourceTiming,this._renderTaskQueue=new iye,this._controls=[],this._mapId=FE(),this._locale=pt({},uye,e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this._imageQueueHandle=Zo.addThrottleControl(()=>this.isMoving()),this._requestManager=new Rue(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else if(e.container instanceof HTMLElement)this._container=e.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let n=!1,a=uT(o=>{this._trackResize&&!this._removed&&this.resize(o)._update()},50);this._resizeObserver=new ResizeObserver(o=>{if(!n){n=!0;return}a(o)}),this._resizeObserver.observe(this._container)}this.handlers=new K1e(this,e);let r=typeof e.hash=="string"&&e.hash||void 0;this._hash=e.hash&&new u1e(r).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,pt({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new eye(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new tye,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update(n.dataType==="style"),this.fire(new Ye(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new Ye(`${n.dataType}dataloading`,n))}),this.on("dataabort",n=>{this.fire(new Ye("sourcedataabort",n))})}_getMapId(){return this._mapId}addControl(e,t){if(t===void 0&&(e.getDefaultPosition?t=e.getDefaultPosition():t="top-right"),!e||!e.onAdd)return this.fire(new Et(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let r=e.onAdd(this);this._controls.push(e);let n=this._controlPositions[t];return t.indexOf("bottom")!==-1?n.insertBefore(r,n.firstChild):n.appendChild(r),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new Et(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let t=this._controls.indexOf(e);return t>-1&&this._controls.splice(t,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,t,r,n){return n==null&&this.terrain&&(n=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,r,n)}resize(e){var t;let r=this._containerDimensions(),n=r[0],a=r[1],o=this._getClampedPixelRatio(n,a);if(this._resizeCanvas(n,a,o),this.painter.resize(n,a,o),this.painter.overLimit()){let l=this.painter.context.gl;this._maxCanvasSize=[l.drawingBufferWidth,l.drawingBufferHeight];let u=this._getClampedPixelRatio(n,a);this._resizeCanvas(n,a,u),this.painter.resize(n,a,u)}this.transform.resize(n,a),(t=this._requestedCameraState)==null||t.resize(n,a);let s=!this._moving;return s&&(this.stop(),this.fire(new Ye("movestart",e)).fire(new Ye("move",e))),this.fire(new Ye("resize",e)),s&&this.fire(new Ye("moveend",e)),this}_getClampedPixelRatio(e,t){let{0:r,1:n}=this._maxCanvasSize,a=this.getPixelRatio(),o=e*a,s=t*a,l=o>r?r/o:1,u=s>n?n/s:1;return Math.min(l,u)*a}getPixelRatio(){var e;return(e=this._overridePixelRatio)!=null?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(Wl.convert(e)),this._update()}setMinZoom(e){if(e=e??Hy,e>=Hy&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error(`minZoom must be between ${Hy} and the current maxZoom, inclusive`)}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if(e=e??wW,e>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if(e=e??ol,e<ol)throw new Error(`minPitch must be greater than or equal to ${ol}`);if(e>=ol&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error(`minPitch must be between ${ol} and the current maxPitch, inclusive`)}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if(e=e??SW,e>v1)throw new Error(`maxPitch must be less than or equal to ${v1}`);if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(e){return this.transform.locationPoint(ei.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(Ys.default.convert(e),this.terrain)}isMoving(){var e;return this._moving||((e=this.handlers)==null?void 0:e.isMoving())}isZooming(){var e;return this._zooming||((e=this.handlers)==null?void 0:e.isZooming())}isRotating(){var e;return this._rotating||((e=this.handlers)==null?void 0:e.isRotating())}_createDelegatedListener(e,t,r){if(e==="mouseenter"||e==="mouseover"){let n=!1;return{layer:t,listener:r,delegates:{mousemove:h(a=>{let o=this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[];o.length?n||(n=!0,r.call(this,new Ba(e,this,a.originalEvent,{features:o}))):n=!1},"mousemove"),mouseout:h(()=>{n=!1},"mouseout")}}}else if(e==="mouseleave"||e==="mouseout"){let n=!1;return{layer:t,listener:r,delegates:{mousemove:h(a=>{(this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[]).length?n=!0:n&&(n=!1,r.call(this,new Ba(e,this,a.originalEvent)))},"mousemove"),mouseout:h(a=>{n&&(n=!1,r.call(this,new Ba(e,this,a.originalEvent)))},"mouseout")}}}else{let n=h(a=>{let o=this.getLayer(t)?this.queryRenderedFeatures(a.point,{layers:[t]}):[];o.length&&(a.features=o,r.call(this,a),delete a.features)},"delegate");return{layer:t,listener:r,delegates:{[e]:n}}}}on(e,t,r){if(r===void 0)return super.on(e,t);let n=this._createDelegatedListener(e,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(let a in n.delegates)this.on(a,n.delegates[a]);return this}once(e,t,r){if(r===void 0)return super.once(e,t);let n=this._createDelegatedListener(e,t,r);for(let a in n.delegates)this.once(a,n.delegates[a]);return this}off(e,t,r){if(r===void 0)return super.off(e,t);let n=h(a=>{let o=a[e];for(let s=0;s<o.length;s++){let l=o[s];if(l.layer===t&&l.listener===r){for(let u in l.delegates)this.off(u,l.delegates[u]);return o.splice(s,1),this}}},"removeDelegatedListener");return this._delegatedListeners&&this._delegatedListeners[e]&&n(this._delegatedListeners),this}queryRenderedFeatures(e,t){if(!this.style)return[];let r,n=e instanceof Ys.default||Array.isArray(e),a=n?e:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(n?{}:e)||{},a instanceof Ys.default||typeof a[0]=="number")r=[Ys.default.convert(a)];else{let o=Ys.default.convert(a[0]),s=Ys.default.convert(a[1]);r=[o,new Ys.default(s.x,o.y),s,new Ys.default(o.x,s.y),o]}return this.style.queryRenderedFeatures(r,t,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,t){return t=pt({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t),t.diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(e,t))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){let t=this._locale[e];if(t==null)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){if(t.transformStyle&&this.style&&!this.style._loaded){this.style.once("style.load",()=>this._updateStyle(e,t));return}let r=this.style&&t.transformStyle?this.style.serialize():void 0;if(this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e)this.style=new D6(this,t||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof e=="string"?this.style.loadURL(e,t,r):this.style.loadJSON(e,t,r),this}_lazyInitEmptyStyle(){this.style||(this.style=new D6(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,t){if(typeof e=="string"){let r=e,n=this._requestManager.transformRequest(r,"Style");Ux(n,new AbortController).then(a=>{this._updateDiff(a.data,t)}).catch(a=>{a&&this.fire(new Et(a))})}else typeof e=="object"&&this._updateDiff(e,t)}_updateDiff(e,t){try{this.style.setState(e,t)&&this._update(!0)}catch(r){dn(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(e,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():dn("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){let t=this.style&&this.style.sourceCaches[e];if(t===void 0){this.fire(new Et(new Error(`There is no source with ID '${e}'`)));return}return t.loaded()}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),!e)this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;else{let t=this.style.sourceCaches[e.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${e.source}`);this.terrain===null&&t.reload();for(let r in this.style._layers){let n=this.style._layers[r];n.type==="hillshade"&&n.source===e.source&&dn("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new oye(this.painter,t,e),this.painter.renderToTexture=new lye(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=r=>{r.dataType==="style"?this.terrain.sourceCache.freeRtt():r.dataType==="source"&&r.tile&&(r.sourceId===e.source&&!this._elevationFreeze&&(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(r.tile.tileID))},this.style.on("data",this._terrainDataCallback)}return this.fire(new Ye("terrain",{terrain:e})),this}getTerrain(){var e,t;return(t=(e=this.terrain)==null?void 0:e.options)!=null?t:null}areTilesLoaded(){let e=this.style&&this.style.sourceCaches;for(let t in e){let r=e[t]._tiles;for(let n in r){let a=r[n];if(!(a.state==="loaded"||a.state==="errored"))return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(e,t,r={}){let{pixelRatio:n=1,sdf:a=!1,stretchX:o,stretchY:s,content:l}=r;this._lazyInitEmptyStyle();let u=0;if(t instanceof HTMLImageElement||qo(t)){let{width:c,height:p,data:d}=li.getImageData(t);this.style.addImage(e,{data:new rr({width:c,height:p},d),pixelRatio:n,stretchX:o,stretchY:s,content:l,sdf:a,version:u})}else{if(t.width===void 0||t.height===void 0)return this.fire(new Et(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:c,height:p,data:d}=t,m=t;return this.style.addImage(e,{data:new rr({width:c,height:p},new Uint8Array(d)),pixelRatio:n,stretchX:o,stretchY:s,content:l,sdf:a,version:u,userImage:m}),m.onAdd&&m.onAdd(this,e),this}}}updateImage(e,t){let r=this.style.getImage(e);if(!r)return this.fire(new Et(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let n=t instanceof HTMLImageElement||qo(t)?li.getImageData(t):t,{width:a,height:o,data:s}=n;if(a===void 0||o===void 0)return this.fire(new Et(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(a!==r.data.width||o!==r.data.height)return this.fire(new Et(new Error("The width and height of the updated image must be that same as the previous version of the image")));let l=!(t instanceof HTMLImageElement||qo(t));return r.data.replace(s,l),this.style.updateImage(e,r),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new Et(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return Zo.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}setFilter(e,t,r={}){return this.style.setFilter(e,t,r),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,r,n={}){return this.style.setPaintProperty(e,t,r,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,r,n={}){return this.style.setLayoutProperty(e,t,r,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t,r={}){return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,r,n=>{n||this._update(!0)}),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,r=>{r||this._update(!0)}),this}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){let e=this._container;e.classList.add("maplibregl-map");let t=this._canvasContainer=He.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=He.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let r=this._containerDimensions(),n=this._getClampedPixelRatio(r[0],r[1]);this._resizeCanvas(r[0],r[1],n);let a=this._controlContainer=He.create("div","maplibregl-control-container",e),o=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(s=>{o[s]=He.create("div",`maplibregl-ctrl-${s} `,a)})}_resizeCanvas(e,t,r){this._canvas.width=Math.floor(r*e),this._canvas.height=Math.floor(r*t),this._canvas.style.width=`${e}px`,this._canvas.style.height=`${t}px`}_setupPainter(){let e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},t=null;this._canvas.addEventListener("webglcontextcreationerror",n=>{t={requestedAttributes:e},n&&(t.statusMessage=n.statusMessage,t.type=n.type)},{once:!0});let r=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!r){let n="Failed to initialize WebGL";throw t?(t.message=n,new Error(JSON.stringify(t))):new Error(n)}this.painter=new n1e(r,this.transform),UE.testSupport(r)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return!this.style||!this.style._loaded?this:(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this)}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){let t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let r=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let a=this.transform.zoom,o=li.now();this.style.zoomHistory.update(a,o);let s=new Dr(a,{now:o,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),l=s.crossFadingFactor();(l!==1||l!==this._crossFadingFactor)&&(r=!0,this._crossFadingFactor=l),this.style.update(s)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new Ye("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,Hd.mark("load"),this.fire(new Ye("load"))),this.style&&(this.style.hasTransitions()||r)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let n=this._sourcesDirty||this._styleDirty||this._placementDirty;return n||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new Ye("idle")),this._loaded&&!this._fullyLoaded&&!n&&(this._fullyLoaded=!0,Hd.mark("fullLoad")),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(let r of this._controls)r.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Zo.removeThrottleControl(this._imageQueueHandle),(e=this._resizeObserver)==null||e.disconnect();let t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),He.remove(this._canvasContainer),He.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),Hd.clearMetrics(),this._removed=!0,this.fire(new Ye("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,li.frameAsync(this._frameRequest).then(e=>{Hd.frame(e),this._frameRequest=null,this._render(e)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return hye}getCameraTargetElevation(){return this.transform.elevation}};h(MW,"Map");var TTe=MW;R();R();var CW=h(i=>{i.touchstart=i.dragStart,i.touchmoveWindow=i.dragMove,i.touchend=i.dragEnd},"assignEvents"),pye=h(({enable:i,clickTolerance:e,bearingDegreesPerPixelMoved:t=.8})=>{let r=new WG;return new Eg({clickTolerance:e,move:(n,a)=>({bearingDelta:(a.x-n.x)*t}),moveStateManager:r,enable:i,assignEvents:CW})},"generateOneFingerTouchRotationHandler"),dye=h(({enable:i,clickTolerance:e,pitchDegreesPerPixelMoved:t=-.5})=>{let r=new WG;return new Eg({clickTolerance:e,move:(n,a)=>({pitchDelta:(a.y-n.y)*t}),moveStateManager:r,enable:i,assignEvents:CW})},"generateOneFingerTouchPitchHandler"),fye={showCompass:!0,showZoom:!0,visualizePitch:!1},EW=class{constructor(e){this._updateZoomButtons=()=>{let t=this._map.getZoom(),r=t===this._map.getMaxZoom(),n=t===this._map.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},this._rotateCompassArrow=()=>{let t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=t},this._setButtonTitle=(t,r)=>{let n=this._map._getUIString(`NavigationControl.${r}`);t.title=n,t.setAttribute("aria-label",n)},this.options=pt({},fye,e),this._container=He.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),He.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),He.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=He.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new mye(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){He.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){let r=He.create("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}};h(EW,"NavigationControl");var ATe=EW,TW=class{constructor(e,t,r=!1){this.mousedown=o=>{this.startMouse(pt({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),He.mousePos(this.element,o)),He.addEventListener(window,"mousemove",this.mousemove),He.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=o=>{this.moveMouse(o,He.mousePos(this.element,o))},this.mouseup=o=>{this.mouseRotate.dragEnd(o),this.mousePitch&&this.mousePitch.dragEnd(o),this.offTemp()},this.touchstart=o=>{o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=He.touchPos(this.element,o.targetTouches)[0],this.startTouch(o,this._startPos),He.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),He.addEventListener(window,"touchend",this.touchend))},this.touchmove=o=>{o.targetTouches.length!==1?this.reset():(this._lastPos=He.touchPos(this.element,o.targetTouches)[0],this.moveTouch(o,this._lastPos))},this.touchend=o=>{o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;let n=e.dragRotate._mouseRotate.getClickTolerance(),a=e.dragRotate._mousePitch.getClickTolerance();this.element=t,this.mouseRotate=qG({clickTolerance:n,enable:!0}),this.touchRotate=pye({clickTolerance:n,enable:!0}),this.map=e,r&&(this.mousePitch=ZG({clickTolerance:a,enable:!0}),this.touchPitch=dye({clickTolerance:a,enable:!0})),He.addEventListener(t,"mousedown",this.mousedown),He.addEventListener(t,"touchstart",this.touchstart,{passive:!1}),He.addEventListener(t,"touchcancel",this.reset)}startMouse(e,t){this.mouseRotate.dragStart(e,t),this.mousePitch&&this.mousePitch.dragStart(e,t),He.disableDrag()}startTouch(e,t){this.touchRotate.dragStart(e,t),this.touchPitch&&this.touchPitch.dragStart(e,t),He.disableDrag()}moveMouse(e,t){let r=this.map,{bearingDelta:n}=this.mouseRotate.dragMove(e,t)||{};if(n&&r.setBearing(r.getBearing()+n),this.mousePitch){let{pitchDelta:a}=this.mousePitch.dragMove(e,t)||{};a&&r.setPitch(r.getPitch()+a)}}moveTouch(e,t){let r=this.map,{bearingDelta:n}=this.touchRotate.dragMove(e,t)||{};if(n&&r.setBearing(r.getBearing()+n),this.touchPitch){let{pitchDelta:a}=this.touchPitch.dragMove(e,t)||{};a&&r.setPitch(r.getPitch()+a)}}off(){let e=this.element;He.removeEventListener(e,"mousedown",this.mousedown),He.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),He.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),He.removeEventListener(window,"touchend",this.touchend),He.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){He.enableDrag(),He.removeEventListener(window,"mousemove",this.mousemove),He.removeEventListener(window,"mouseup",this.mouseup),He.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),He.removeEventListener(window,"touchend",this.touchend)}};h(TW,"MouseRotateWrapper");var mye=TW;R();R();var au;async function PW(i=!1){if(au!==void 0&&!i)return au;if(window.navigator.permissions===void 0)return au=!!window.navigator.geolocation,au;try{au=(await window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{au=!!window.navigator.geolocation}return au}h(PW,"checkGeolocationSupport");R();var x1=kt(gi(),1);R();function mT(i,e,t){let r=new ei(i.lng,i.lat);if(i=new ei(i.lng,i.lat),e){let n=new ei(i.lng-360,i.lat),a=new ei(i.lng+360,i.lat),o=t.locationPoint(i).distSqr(e);t.locationPoint(n).distSqr(e)<o?i=n:t.locationPoint(a).distSqr(e)<o&&(i=a)}for(;Math.abs(i.lng-t.center.lng)>180;){let n=t.locationPoint(i);if(n.x>=0&&n.y>=0&&n.x<=t.width&&n.y<=t.height)break;i.lng>t.center.lng?i.lng-=360:i.lng+=360}return i.lng!==r.lng&&t.locationPoint(i).y>t.height/2-t.getHorizon()?i:r}h(mT,"smartWrap");R();var gT={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function yT(i,e,t){let r=i.classList;for(let n in gT)r.remove(`maplibregl-${t}-anchor-${n}`);r.add(`maplibregl-${t}-anchor-${e}`)}h(yT,"applyAnchorClass");var AW=class extends mn{constructor(e){if(super(),this._onKeyPress=t=>{let r=t.code,n=t.charCode||t.keyCode;(r==="Space"||r==="Enter"||n===32||n===13)&&this.togglePopup()},this._onMapClick=t=>{let r=t.originalEvent.target,n=this._element;this._popup&&(r===n||n.contains(r))&&this.togglePopup()},this._update=t=>{var r;if(!this._map)return;let n=this._map.loaded()&&!this._map.isMoving();((t==null?void 0:t.type)==="terrain"||(t==null?void 0:t.type)==="render"&&!n)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies?this._lngLat=mT(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(r=this._lngLat)==null?void 0:r.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let a="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?a=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(a=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let o="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?o="rotateX(0deg)":this._pitchAlignment==="map"&&(o=`rotateX(${this._map.getPitch()}deg)`),(!t||t.type==="moveend")&&(this._pos=this._pos.round()),He.setTransform(this._element,`${gT[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${o} ${a}`),li.frameAsync(new AbortController).then(()=>{this._updateOpacity(t&&t.type==="moveend")}).catch(()=>{})},this._onMove=t=>{if(!this._isDragging){let r=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=r}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new Ye("dragstart"))),this.fire(new Ye("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new Ye("dragend")),this._state="inactive"},this._addDragHandler=t=>{this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),!e||!e.element){this._defaultMarker=!0,this._element=He.create("div"),this._element.setAttribute("aria-label","Map marker");let t=He.createNS("http://www.w3.org/2000/svg","svg"),r=41,n=27;t.setAttributeNS(null,"display","block"),t.setAttributeNS(null,"height",`${r}px`),t.setAttributeNS(null,"width",`${n}px`),t.setAttributeNS(null,"viewBox",`0 0 ${n} ${r}`);let a=He.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");let o=He.createNS("http://www.w3.org/2000/svg","g");o.setAttributeNS(null,"fill-rule","nonzero");let s=He.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"transform","translate(3.0, 29.0)"),s.setAttributeNS(null,"fill","#000000");let l=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let x of l){let w=He.createNS("http://www.w3.org/2000/svg","ellipse");w.setAttributeNS(null,"opacity","0.04"),w.setAttributeNS(null,"cx","10.5"),w.setAttributeNS(null,"cy","5.80029008"),w.setAttributeNS(null,"rx",x.rx),w.setAttributeNS(null,"ry",x.ry),s.appendChild(w)}let u=He.createNS("http://www.w3.org/2000/svg","g");u.setAttributeNS(null,"fill",this._color);let c=He.createNS("http://www.w3.org/2000/svg","path");c.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),u.appendChild(c);let p=He.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"opacity","0.25"),p.setAttributeNS(null,"fill","#000000");let d=He.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),p.appendChild(d);let m=He.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(6.0, 7.0)"),m.setAttributeNS(null,"fill","#FFFFFF");let g=He.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform","translate(8.0, 8.0)");let _=He.createNS("http://www.w3.org/2000/svg","circle");_.setAttributeNS(null,"fill","#000000"),_.setAttributeNS(null,"opacity","0.25"),_.setAttributeNS(null,"cx","5.5"),_.setAttributeNS(null,"cy","5.5"),_.setAttributeNS(null,"r","5.4999962");let y=He.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),g.appendChild(_),g.appendChild(y),o.appendChild(s),o.appendChild(u),o.appendChild(p),o.appendChild(m),o.appendChild(g),t.appendChild(o),t.setAttributeNS(null,"height",`${r*this._scale}px`),t.setAttributeNS(null,"width",`${n*this._scale}px`),this._element.appendChild(t),this._offset=x1.default.convert(e&&e.offset||[0,-14])}else this._element=e.element,this._offset=x1.default.convert(e&&e.offset||[0,0]);if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",t=>{t.preventDefault()}),this._element.addEventListener("mousedown",t=>{t.preventDefault()}),yT(this._element,this._anchor,"marker"),e&&e.className)for(let t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),He.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=ei.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){let t=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[t,(38.1-13.5+t)*-1],"bottom-right":[-t,(38.1-13.5+t)*-1],left:[13.5,(38.1-13.5)*-1],right:[-13.5,(38.1-13.5)*-1]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let e=this._popup;if(this._element.style.opacity===this._opacityWhenCovered)return this;if(e)e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map));else return this;return this}_updateOpacity(e=!1){var t,r;if(!((t=this._map)!=null&&t.terrain)){this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity);return}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let n=this._map,a=n.terrain.depthAtPoint(this._pos),o=n.terrain.getElevationForLngLatZoom(this._lngLat,n.transform.tileZoom),s=n.transform.lngLatToCameraDepth(this._lngLat,o),l=.006;if(s-a<l){this._element.style.opacity=this._opacity;return}let u=-this._offset.y/n.transform._pixelPerMeter,c=Math.sin(n.getPitch()*Math.PI/180)*u,p=n.terrain.depthAtPoint(new x1.default(this._pos.x,this._pos.y-this._offset.y)),d=n.transform.lngLatToCameraDepth(this._lngLat,o+c)-p>l;(r=this._popup)!=null&&r.isOpen()&&d&&this._popup.remove(),this._element.style.opacity=d?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=x1.default.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return e===void 0&&t===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),t!==void 0&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}};h(AW,"Marker");var B6=AW,gye={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},_1=0,Gd=!1,IW=class extends mn{constructor(e){super(),this._onSuccess=t=>{if(this._map){if(this._isOutOfMapMaxBounds(t)){this._setErrorState(),this.fire(new Ye("outofmaxbounds",t)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new Ye("geolocate",t)),this._finish()}},this._updateCamera=t=>{let r=new ei(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,a=this._map.getBearing(),o=pt({bearing:a},this.options.fitBoundsOptions),s=Wl.fromLngLat(r,n);this._map.fitBounds(s,o,{geolocateSource:!0})},this._updateMarker=t=>{if(t){let r=new ei(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=t=>{if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&Gd)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new Ye("error",t)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=t=>{if(this._map){if(this._container.addEventListener("contextmenu",r=>r.preventDefault()),this._geolocateButton=He.create("button","maplibregl-ctrl-geolocate",this._container),He.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){dn("Geolocation support is not available so the GeolocateControl will be disabled.");let r=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}else{let r=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=r,this._geolocateButton.setAttribute("aria-label",r)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=He.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new B6({element:this._dotElement}),this._circleElement=He.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new B6({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",r=>{let n=r.originalEvent&&r.originalEvent.type==="resize";!r.geolocateSource&&this._watchState==="ACTIVE_LOCK"&&!n&&(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new Ye("trackuserlocationend")))})}},this.options=pt({},gye,e)}onAdd(e){return this._map=e,this._container=He.create("div","maplibregl-ctrl maplibregl-ctrl-group"),PW().then(t=>this._setupUI(t)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),He.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,_1=0,Gd=!1}_isOutOfMapMaxBounds(e){let t=this._map.getMaxBounds(),r=e.coords;return t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let e=this._map.getBounds(),t=e.getSouthEast(),r=e.getNorthEast(),n=t.distanceTo(r),a=this._map._container.clientHeight,o=Math.ceil(2*(this._accuracy/(n/a)));this._circleElement.style.width=`${o}px`,this._circleElement.style.height=`${o}px`}trigger(){if(!this._setup)return dn("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Ye("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":_1--,Gd=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new Ye("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Ye("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),_1++;let e;_1>1?(e={maximumAge:6e5,timeout:0},Gd=!0):(e=this.options.positionOptions,Gd=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}};h(IW,"GeolocateControl");var kTe=IW;R();var yye={maxWidth:100,unit:"metric"},LW=class{constructor(e){this._onMove=()=>{hS(this._map,this._container,this.options)},this.setUnit=t=>{this.options.unit=t,hS(this._map,this._container,this.options)},this.options={...yye,...e}}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=He.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){He.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}};h(LW,"ScaleControl");var FTe=LW;function hS(i,e,t){let r=t&&t.maxWidth||100,n=i._container.clientHeight/2,a=i.unproject([0,n]),o=i.unproject([r,n]),s=a.distanceTo(o);if(t&&t.unit==="imperial"){let l=3.2808*s;if(l>5280){let u=l/5280;dc(e,r,u,i._getUIString("ScaleControl.Miles"))}else dc(e,r,l,i._getUIString("ScaleControl.Feet"))}else if(t&&t.unit==="nautical"){let l=s/1852;dc(e,r,l,i._getUIString("ScaleControl.NauticalMiles"))}else s>=1e3?dc(e,r,s/1e3,i._getUIString("ScaleControl.Kilometers")):dc(e,r,s,i._getUIString("ScaleControl.Meters"))}h(hS,"updateScale");function dc(i,e,t,r){let n=kW(t),a=n/t;i.style.width=`${e*a}px`,i.innerHTML=`${n}&nbsp;${r}`}h(dc,"setScale");function DW(i){let e=Math.pow(10,Math.ceil(-Math.log(i)/Math.LN10));return Math.round(i*e)/e}h(DW,"getDecimalRoundNum");function kW(i){let e=Math.pow(10,`${Math.floor(i)}`.length-1),t=i/e;return t=t>=10?10:t>=5?5:t>=3?3:t>=2?2:t>=1?1:DW(t),e*t}h(kW,"getRoundNum");R();var RW=class extends mn{constructor(e={}){super(),this._onFullscreenChange=()=>{var t;let r=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;(t=r==null?void 0:r.shadowRoot)!=null&&t.fullscreenElement;)r=r.shadowRoot.fullscreenElement;r===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:dn("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=He.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){He.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let e=this._fullscreenButton=He.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);He.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new Ye("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new Ye("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}};h(RW,"FullscreenControl");var BTe=RW;R();var FW=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=e}onAdd(e){return this._map=e,this._container=He.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=He.create("button","maplibregl-ctrl-terrain",this._container),He.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){He.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}};h(FW,"TerrainControl");var NTe=FW;R();var yr=kt(gi(),1),vye={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},xye=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),OW=class extends mn{constructor(e){super(),this.remove=()=>(this._content&&He.remove(this._content),this._container&&(He.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new Ye("close"))),this),this._onMouseUp=t=>{this._update(t.point)},this._onMouseMove=t=>{this._update(t.point)},this._onDrag=t=>{this._update(t.point)},this._update=t=>{var r;let n=this._lngLat||this._trackPointer;if(!this._map||!n||!this._content)return;if(!this._container){if(this._container=He.create("div","maplibregl-popup",this._map.getContainer()),this._tip=He.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let u of this.options.className.split(" "))this._container.classList.add(u);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer?this._lngLat=mT(this._lngLat,this._flatPos,this._map.transform):this._lngLat=(r=this._lngLat)==null?void 0:r.wrap(),this._trackPointer&&!t)return;let a=this._flatPos=this._pos=this._trackPointer&&t?t:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&t?t:this._map.transform.locationPoint(this._lngLat));let o=this.options.anchor,s=vT(this.options.offset);if(!o){let u=this._container.offsetWidth,c=this._container.offsetHeight,p;a.y+s.bottom.y<c?p=["top"]:a.y>this._map.transform.height-c?p=["bottom"]:p=[],a.x<u/2?p.push("left"):a.x>this._map.transform.width-u/2&&p.push("right"),p.length===0?o="bottom":o=p.join("-")}let l=a.add(s[o]);this.options.subpixelPositioning||(l=l.round()),He.setTransform(this._container,`${gT[o]} translate(${l.x}px,${l.y}px)`),yT(this._container,o,"popup")},this._onClose=()=>{this.remove()},this.options=pt(Object.create(vye),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new Ye("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=ei.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){let t=document.createDocumentFragment(),r=document.createElement("body"),n;for(r.innerHTML=e;n=r.firstChild,!!n;)t.appendChild(n);return this.setDOMContent(t)}getMaxWidth(){var e;return(e=this._container)==null?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=He.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){this._container&&this._container.classList.add(e)}removeClassName(e){this._container&&this._container.classList.remove(e)}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=He.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let e=this._container.querySelector(xye);e&&e.focus()}};h(OW,"Popup");var UTe=OW;function vT(i){if(i)if(typeof i=="number"){let e=Math.round(Math.abs(i)/Math.SQRT2);return{center:new yr.default(0,0),top:new yr.default(0,i),"top-left":new yr.default(e,e),"top-right":new yr.default(-e,e),bottom:new yr.default(0,-i),"bottom-left":new yr.default(e,-e),"bottom-right":new yr.default(-e,-e),left:new yr.default(i,0),right:new yr.default(-i,0)}}else if(i instanceof yr.default||Array.isArray(i)){let e=yr.default.convert(i);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}else return{center:yr.default.convert(i.center||[0,0]),top:yr.default.convert(i.top||[0,0]),"top-left":yr.default.convert(i["top-left"]||[0,0]),"top-right":yr.default.convert(i["top-right"]||[0,0]),bottom:yr.default.convert(i.bottom||[0,0]),"bottom-left":yr.default.convert(i["bottom-left"]||[0,0]),"bottom-right":yr.default.convert(i["bottom-right"]||[0,0]),left:yr.default.convert(i.left||[0,0]),right:yr.default.convert(i.right||[0,0])};else return vT(new yr.default(0,0))}h(vT,"normalizeOffset");var VTe=kt(gi(),1),_ye=fD.version;function bye(i,e){return Kp().setRTLTextPlugin(i,e)}h(bye,"setRTLTextPlugin");function wye(){return Kp().getRTLTextPluginStatus()}h(wye,"getRTLTextPluginStatus");function Sye(){return _ye}h(Sye,"getVersion");function Mye(){return m_.workerCount}h(Mye,"getWorkerCount");function Cye(i){m_.workerCount=i}h(Cye,"setWorkerCount");function Eye(){return Co.MAX_PARALLEL_IMAGE_REQUESTS}h(Eye,"getMaxParallelImageRequests");function Tye(i){Co.MAX_PARALLEL_IMAGE_REQUESTS=i}h(Tye,"setMaxParallelImageRequests");function Pye(){return Co.WORKER_URL}h(Pye,"getWorkerUrl");function Aye(i){Co.WORKER_URL=i}h(Aye,"setWorkerUrl");function Iye(i){return W5().broadcast("IS",i)}h(Iye,"importScriptInWorkers");R();var xT="162",V2={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Lye=0,z6=1,Dye=2,BW=1,kye=2,ms=3,Xl=0,Qn=1,Na=2,Nl=0,Tp=1,N6=2,$6=3,U6=4,Rye=5,Lu=100,Fye=101,Oye=102,V6=103,j6=104,Bye=200,zye=201,Nye=202,$ye=203,cS=204,pS=205,Uye=206,Vye=207,jye=208,Hye=209,Gye=210,Wye=211,Xye=212,qye=213,Zye=214,Yye=0,Jye=1,Kye=2,Gv=3,Qye=4,e0e=5,t0e=6,i0e=7,_T=0,r0e=1,n0e=2,$l=0,a0e=1,o0e=2,s0e=3,l0e=4,u0e=5,h0e=6,c0e=7,H6="attached",p0e="detached",zW=300,Qp=301,ed=302,dS=303,fS=304,w_=306,_o=1e3,vo=1001,mS=1002,Kr=1003,G6=1004,Wd=1005,$n=1006,j2=1007,Nu=1008,Ul=1009,d0e=1010,f0e=1011,bT=1012,NW=1013,Tl=1014,ca=1015,Jm=1016,$W=1017,UW=1018,Zu=1020,m0e=1021,Gn=1023,g0e=1024,y0e=1025,Yu=1026,td=1027,VW=1028,jW=1029,v0e=1030,HW=1031,GW=1033,H2=33776,G2=33777,W2=33778,X2=33779,W6=35840,X6=35841,q6=35842,Z6=35843,WW=36196,Y6=37492,J6=37496,K6=37808,Q6=37809,eI=37810,tI=37811,iI=37812,rI=37813,nI=37814,aI=37815,oI=37816,sI=37817,lI=37818,uI=37819,hI=37820,cI=37821,q2=36492,pI=36494,dI=36495,x0e=36283,fI=36284,mI=36285,gI=36286,Wv=2300,Xv=2301,Z2=2302,yI=2400,vI=2401,xI=2402,_0e=2500,b0e=0,w0e=1,_I=2,S0e=3200,M0e=3201,wT=0,C0e=1,bl="",Un="srgb",tu="srgb-linear",ST="display-p3",S_="display-p3-linear",qv="linear",Fi="srgb",Zv="rec709",Yv="p3",zh=7680,bI=519,E0e=512,T0e=513,P0e=514,XW=515,A0e=516,I0e=517,L0e=518,D0e=519,gS=35044,wI="300 es",yS=1035,Ds=2e3,Jv=2001,qW=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let n=r.indexOf(t);n!==-1&&r.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let n=0,a=r.length;n<a;n++)r[n].call(this,e);e.target=null}}};h(qW,"EventDispatcher");var bd=qW,on=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],SI=1234567,Pp=Math.PI/180,id=180/Math.PI;function va(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(on[i&255]+on[i>>8&255]+on[i>>16&255]+on[i>>24&255]+"-"+on[e&255]+on[e>>8&255]+"-"+on[e>>16&15|64]+on[e>>24&255]+"-"+on[t&63|128]+on[t>>8&255]+"-"+on[t>>16&255]+on[t>>24&255]+on[r&255]+on[r>>8&255]+on[r>>16&255]+on[r>>24&255]).toLowerCase()}h(va,"generateUUID");function Nr(i,e,t){return Math.max(e,Math.min(t,i))}h(Nr,"clamp");function M_(i,e){return(i%e+e)%e}h(M_,"euclideanModulo");function ZW(i,e,t,r,n){return r+(i-e)*(n-r)/(t-e)}h(ZW,"mapLinear");function YW(i,e,t){return i!==e?(t-i)/(e-i):0}h(YW,"inverseLerp");function Ap(i,e,t){return(1-t)*i+t*e}h(Ap,"lerp");function JW(i,e,t,r){return Ap(i,e,1-Math.exp(-t*r))}h(JW,"damp");function KW(i,e=1){return e-Math.abs(M_(i,e*2)-e)}h(KW,"pingpong");function QW(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}h(QW,"smoothstep");function eX(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}h(eX,"smootherstep");function tX(i,e){return i+Math.floor(Math.random()*(e-i+1))}h(tX,"randInt");function iX(i,e){return i+Math.random()*(e-i)}h(iX,"randFloat");function rX(i){return i*(.5-Math.random())}h(rX,"randFloatSpread");function nX(i){i!==void 0&&(SI=i);let e=SI+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}h(nX,"seededRandom");function aX(i){return i*Pp}h(aX,"degToRad");function oX(i){return i*id}h(oX,"radToDeg");function Kv(i){return(i&i-1)===0&&i!==0}h(Kv,"isPowerOfTwo");function sX(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}h(sX,"ceilPowerOfTwo");function Km(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}h(Km,"floorPowerOfTwo");function lX(i,e,t,r,n){let a=Math.cos,o=Math.sin,s=a(t/2),l=o(t/2),u=a((e+r)/2),c=o((e+r)/2),p=a((e-r)/2),d=o((e-r)/2),m=a((r-e)/2),g=o((r-e)/2);switch(n){case"XYX":i.set(s*c,l*p,l*d,s*u);break;case"YZY":i.set(l*d,s*c,l*p,s*u);break;case"ZXZ":i.set(l*p,l*d,s*c,s*u);break;case"XZX":i.set(s*c,l*g,l*m,s*u);break;case"YXY":i.set(l*m,s*c,l*g,s*u);break;case"ZYZ":i.set(l*g,l*m,s*c,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}h(lX,"setQuaternionFromProperEuler");function $a(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}h($a,"denormalize");function _i(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}h(_i,"normalize");var Oi={DEG2RAD:Pp,RAD2DEG:id,generateUUID:va,clamp:Nr,euclideanModulo:M_,mapLinear:ZW,inverseLerp:YW,lerp:Ap,damp:JW,pingpong:KW,smoothstep:QW,smootherstep:eX,randInt:tX,randFloat:iX,randFloatSpread:rX,seededRandom:nX,degToRad:aX,radToDeg:oX,isPowerOfTwo:Kv,ceilPowerOfTwo:sX,floorPowerOfTwo:Km,setQuaternionFromProperEuler:lX,normalize:_i,denormalize:$a},uX=class hX{constructor(e=0,t=0){hX.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(Nr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),n=Math.sin(t),a=this.x-e.x,o=this.y-e.y;return this.x=a*r-o*n+e.x,this.y=a*n+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}};h(uX,"Vector2");var Ne=uX,cX=class pX{constructor(e,t,r,n,a,o,s,l,u){pX.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,o,s,l,u)}set(e,t,r,n,a,o,s,l,u){let c=this.elements;return c[0]=e,c[1]=n,c[2]=s,c[3]=t,c[4]=a,c[5]=l,c[6]=r,c[7]=o,c[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,a=this.elements,o=r[0],s=r[3],l=r[6],u=r[1],c=r[4],p=r[7],d=r[2],m=r[5],g=r[8],_=n[0],y=n[3],x=n[6],w=n[1],b=n[4],C=n[7],E=n[2],T=n[5],L=n[8];return a[0]=o*_+s*w+l*E,a[3]=o*y+s*b+l*T,a[6]=o*x+s*C+l*L,a[1]=u*_+c*w+p*E,a[4]=u*y+c*b+p*T,a[7]=u*x+c*C+p*L,a[2]=d*_+m*w+g*E,a[5]=d*y+m*b+g*T,a[8]=d*x+m*C+g*L,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8];return t*o*c-t*s*u-r*a*c+r*s*l+n*a*u-n*o*l}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=c*o-s*u,d=s*l-c*a,m=u*a-o*l,g=t*p+r*d+n*m;if(g===0)return this.set(0,0,0,0,0,0,0,0,0);let _=1/g;return e[0]=p*_,e[1]=(n*u-c*r)*_,e[2]=(s*r-n*o)*_,e[3]=d*_,e[4]=(c*t-n*l)*_,e[5]=(n*a-s*t)*_,e[6]=m*_,e[7]=(r*l-u*t)*_,e[8]=(o*t-r*a)*_,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,a,o,s){let l=Math.cos(a),u=Math.sin(a);return this.set(r*l,r*u,-r*(l*o+u*s)+o+e,-n*u,n*l,-n*(-u*o+l*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(Y2.makeScale(e,t)),this}rotate(e){return this.premultiply(Y2.makeRotation(-e)),this}translate(e,t){return this.premultiply(Y2.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}};h(cX,"Matrix3");var ri=cX,Y2=new ri;function MT(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}h(MT,"arrayNeedsUint32");function rd(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}h(rd,"createElementNS");function dX(){let i=rd("canvas");return i.style.display="block",i}h(dX,"createCanvasElement");var MI={};function CT(i){i in MI||(MI[i]=!0,console.warn(i))}h(CT,"warnOnce");var CI=new ri().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),EI=new ri().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),b1={[tu]:{transfer:qv,primaries:Zv,toReference:i=>i,fromReference:i=>i},[Un]:{transfer:Fi,primaries:Zv,toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[S_]:{transfer:qv,primaries:Yv,toReference:i=>i.applyMatrix3(EI),fromReference:i=>i.applyMatrix3(CI)},[ST]:{transfer:Fi,primaries:Yv,toReference:i=>i.convertSRGBToLinear().applyMatrix3(EI),fromReference:i=>i.applyMatrix3(CI).convertLinearToSRGB()}},k0e=new Set([tu,S_]),Ei={enabled:!0,_workingColorSpace:tu,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!k0e.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,e,t){if(this.enabled===!1||e===t||!e||!t)return i;let r=b1[e].toReference,n=b1[t].fromReference;return n(r(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this._workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this._workingColorSpace)},getPrimaries:function(i){return b1[i].primaries},getTransfer:function(i){return i===bl?qv:b1[i].transfer}};function Ju(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}h(Ju,"SRGBToLinear");function Gy(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}h(Gy,"LinearToSRGB");var Nh,fX=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Nh===void 0&&(Nh=rd("canvas")),Nh.width=e.width,Nh.height=e.height;let r=Nh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Nh}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=rd("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let n=r.getImageData(0,0,e.width,e.height),a=n.data;for(let o=0;o<a.length;o++)a[o]=Ju(a[o]/255)*255;return r.putImageData(n,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Ju(t[r]/255)*255):t[r]=Ju(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}};h(fX,"ImageUtils");var mX=fX,R0e=0,gX=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:R0e++}),this.uuid=va(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},n=this.data;if(n!==null){let a;if(Array.isArray(n)){a=[];for(let o=0,s=n.length;o<s;o++)n[o].isDataTexture?a.push(Wy(n[o].image)):a.push(Wy(n[o]))}else a=Wy(n);r.url=a}return t||(e.images[this.uuid]=r),r}};h(gX,"Source");var yX=gX;function Wy(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?mX.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}h(Wy,"serializeImage");var F0e=0,vX=class Xy extends bd{constructor(e=Xy.DEFAULT_IMAGE,t=Xy.DEFAULT_MAPPING,r=vo,n=vo,a=$n,o=Nu,s=Gn,l=Ul,u=Xy.DEFAULT_ANISOTROPY,c=bl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:F0e++}),this.uuid=va(),this.name="",this.source=new yX(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=n,this.magFilter=a,this.minFilter=o,this.anisotropy=u,this.format=s,this.internalFormat=null,this.type=l,this.offset=new Ne(0,0),this.repeat=new Ne(1,1),this.center=new Ne(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ri,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==zW)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case _o:e.x=e.x-Math.floor(e.x);break;case vo:e.x=e.x<0?0:1;break;case mS:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case _o:e.y=e.y-Math.floor(e.y);break;case vo:e.y=e.y<0?0:1;break;case mS:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};h(vX,"Texture");var Ln=vX;Ln.DEFAULT_IMAGE=null;Ln.DEFAULT_MAPPING=zW;Ln.DEFAULT_ANISOTROPY=1;var xX=class _X{constructor(e=0,t=0,r=0,n=1){_X.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,a=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*a,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*a,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*a,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,a,o=e.elements,s=o[0],l=o[4],u=o[8],c=o[1],p=o[5],d=o[9],m=o[2],g=o[6],_=o[10];if(Math.abs(l-c)<.01&&Math.abs(u-m)<.01&&Math.abs(d-g)<.01){if(Math.abs(l+c)<.1&&Math.abs(u+m)<.1&&Math.abs(d+g)<.1&&Math.abs(s+p+_-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let x=(s+1)/2,w=(p+1)/2,b=(_+1)/2,C=(l+c)/4,E=(u+m)/4,T=(d+g)/4;return x>w&&x>b?x<.01?(r=0,n=.707106781,a=.707106781):(r=Math.sqrt(x),n=C/r,a=E/r):w>b?w<.01?(r=.707106781,n=0,a=.707106781):(n=Math.sqrt(w),r=C/n,a=T/n):b<.01?(r=.707106781,n=.707106781,a=0):(a=Math.sqrt(b),r=E/a,n=T/a),this.set(r,n,a,t),this}let y=Math.sqrt((g-d)*(g-d)+(u-m)*(u-m)+(c-l)*(c-l));return Math.abs(y)<.001&&(y=1),this.x=(g-d)/y,this.y=(u-m)/y,this.z=(c-l)/y,this.w=Math.acos((s+p+_-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}};h(xX,"Vector4");var Ai=xX,bX=class extends bd{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ai(0,0,e,t),this.scissorTest=!1,this.viewport=new Ai(0,0,e,t);let n={width:e,height:t,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:$n,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0,count:1},r);let a=new Ln(n,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);a.flipY=!1,a.generateMipmaps=r.generateMipmaps,a.internalFormat=r.internalFormat,this.textures=[];let o=r.count;for(let s=0;s<o;s++)this.textures[s]=a.clone(),this.textures[s].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let n=0,a=this.textures.length;n<a;n++)this.textures[n].image.width=e,this.textures[n].image.height=t,this.textures[n].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let r=0,n=e.textures.length;r<n;r++)this.textures[r]=e.textures[r].clone(),this.textures[r].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new yX(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}};h(bX,"RenderTarget");var O0e=bX,wX=class extends O0e{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}};h(wX,"WebGLRenderTarget");var dh=wX,SX=class extends Ln{constructor(e=null,t=1,r=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=Kr,this.minFilter=Kr,this.wrapR=vo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};h(SX,"DataArrayTexture");var MX=SX,CX=class extends Ln{constructor(e=null,t=1,r=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:n},this.magFilter=Kr,this.minFilter=Kr,this.wrapR=vo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};h(CX,"Data3DTexture");var B0e=CX,EX=class{constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}static slerpFlat(e,t,r,n,a,o,s){let l=r[n+0],u=r[n+1],c=r[n+2],p=r[n+3],d=a[o+0],m=a[o+1],g=a[o+2],_=a[o+3];if(s===0){e[t+0]=l,e[t+1]=u,e[t+2]=c,e[t+3]=p;return}if(s===1){e[t+0]=d,e[t+1]=m,e[t+2]=g,e[t+3]=_;return}if(p!==_||l!==d||u!==m||c!==g){let y=1-s,x=l*d+u*m+c*g+p*_,w=x>=0?1:-1,b=1-x*x;if(b>Number.EPSILON){let E=Math.sqrt(b),T=Math.atan2(E,x*w);y=Math.sin(y*T)/E,s=Math.sin(s*T)/E}let C=s*w;if(l=l*y+d*C,u=u*y+m*C,c=c*y+g*C,p=p*y+_*C,y===1-s){let E=1/Math.sqrt(l*l+u*u+c*c+p*p);l*=E,u*=E,c*=E,p*=E}}e[t]=l,e[t+1]=u,e[t+2]=c,e[t+3]=p}static multiplyQuaternionsFlat(e,t,r,n,a,o){let s=r[n],l=r[n+1],u=r[n+2],c=r[n+3],p=a[o],d=a[o+1],m=a[o+2],g=a[o+3];return e[t]=s*g+c*p+l*m-u*d,e[t+1]=l*g+c*d+u*p-s*m,e[t+2]=u*g+c*m+s*d-l*p,e[t+3]=c*g-s*p-l*d-u*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let r=e._x,n=e._y,a=e._z,o=e._order,s=Math.cos,l=Math.sin,u=s(r/2),c=s(n/2),p=s(a/2),d=l(r/2),m=l(n/2),g=l(a/2);switch(o){case"XYZ":this._x=d*c*p+u*m*g,this._y=u*m*p-d*c*g,this._z=u*c*g+d*m*p,this._w=u*c*p-d*m*g;break;case"YXZ":this._x=d*c*p+u*m*g,this._y=u*m*p-d*c*g,this._z=u*c*g-d*m*p,this._w=u*c*p+d*m*g;break;case"ZXY":this._x=d*c*p-u*m*g,this._y=u*m*p+d*c*g,this._z=u*c*g+d*m*p,this._w=u*c*p-d*m*g;break;case"ZYX":this._x=d*c*p-u*m*g,this._y=u*m*p+d*c*g,this._z=u*c*g-d*m*p,this._w=u*c*p+d*m*g;break;case"YZX":this._x=d*c*p+u*m*g,this._y=u*m*p+d*c*g,this._z=u*c*g-d*m*p,this._w=u*c*p-d*m*g;break;case"XZY":this._x=d*c*p-u*m*g,this._y=u*m*p-d*c*g,this._z=u*c*g+d*m*p,this._w=u*c*p+d*m*g;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],n=t[4],a=t[8],o=t[1],s=t[5],l=t[9],u=t[2],c=t[6],p=t[10],d=r+s+p;if(d>0){let m=.5/Math.sqrt(d+1);this._w=.25/m,this._x=(c-l)*m,this._y=(a-u)*m,this._z=(o-n)*m}else if(r>s&&r>p){let m=2*Math.sqrt(1+r-s-p);this._w=(c-l)/m,this._x=.25*m,this._y=(n+o)/m,this._z=(a+u)/m}else if(s>p){let m=2*Math.sqrt(1+s-r-p);this._w=(a-u)/m,this._x=(n+o)/m,this._y=.25*m,this._z=(l+c)/m}else{let m=2*Math.sqrt(1+p-r-s);this._w=(o-n)/m,this._x=(a+u)/m,this._y=(l+c)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Nr(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,n=e._y,a=e._z,o=e._w,s=t._x,l=t._y,u=t._z,c=t._w;return this._x=r*c+o*s+n*u-a*l,this._y=n*c+o*l+a*s-r*u,this._z=a*c+o*u+r*l-n*s,this._w=o*c-r*s-n*l-a*u,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,n=this._y,a=this._z,o=this._w,s=o*e._w+r*e._x+n*e._y+a*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=o,this._x=r,this._y=n,this._z=a,this;let l=1-s*s;if(l<=Number.EPSILON){let m=1-t;return this._w=m*o+t*this._w,this._x=m*r+t*this._x,this._y=m*n+t*this._y,this._z=m*a+t*this._z,this.normalize(),this}let u=Math.sqrt(l),c=Math.atan2(u,s),p=Math.sin((1-t)*c)/u,d=Math.sin(t*c)/u;return this._w=o*p+this._w*d,this._x=r*p+this._x*d,this._y=n*p+this._y*d,this._z=a*p+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),n=Math.sqrt(1-r),a=Math.sqrt(r);return this.set(n*Math.sin(e),n*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}};h(EX,"Quaternion");var Th=EX,TX=class PX{constructor(e=0,t=0,r=0){PX.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(TI.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(TI.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6]*n,this.y=a[1]*t+a[4]*r+a[7]*n,this.z=a[2]*t+a[5]*r+a[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,n=this.z,a=e.elements,o=1/(a[3]*t+a[7]*r+a[11]*n+a[15]);return this.x=(a[0]*t+a[4]*r+a[8]*n+a[12])*o,this.y=(a[1]*t+a[5]*r+a[9]*n+a[13])*o,this.z=(a[2]*t+a[6]*r+a[10]*n+a[14])*o,this}applyQuaternion(e){let t=this.x,r=this.y,n=this.z,a=e.x,o=e.y,s=e.z,l=e.w,u=2*(o*n-s*r),c=2*(s*t-a*n),p=2*(a*r-o*t);return this.x=t+l*u+o*p-s*c,this.y=r+l*c+s*u-a*p,this.z=n+l*p+a*c-o*u,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n,this.y=a[1]*t+a[5]*r+a[9]*n,this.z=a[2]*t+a[6]*r+a[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,n=e.y,a=e.z,o=t.x,s=t.y,l=t.z;return this.x=n*l-a*s,this.y=a*o-r*l,this.z=r*s-n*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return J2.copy(this).projectOnVector(e),this.sub(J2)}reflect(e){return this.sub(J2.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(Nr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}};h(TX,"Vector3");var le=TX,J2=new le,TI=new Th,AX=class{constructor(e=new le(1/0,1/0,1/0),t=new le(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(to.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(to.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=to.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0){let a=r.getAttribute("position");if(t===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let o=0,s=a.count;o<s;o++)e.isMesh===!0?e.getVertexPosition(o,to):to.fromBufferAttribute(a,o),to.applyMatrix4(e.matrixWorld),this.expandByPoint(to);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),w1.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),w1.copy(r.boundingBox)),w1.applyMatrix4(e.matrixWorld),this.union(w1)}let n=e.children;for(let a=0,o=n.length;a<o;a++)this.expandByObject(n[a],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,to),to.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Xd),S1.subVectors(this.max,Xd),$h.subVectors(e.a,Xd),Uh.subVectors(e.b,Xd),Vh.subVectors(e.c,Xd),Js.subVectors(Uh,$h),Ks.subVectors(Vh,Uh),ou.subVectors($h,Vh);let t=[0,-Js.z,Js.y,0,-Ks.z,Ks.y,0,-ou.z,ou.y,Js.z,0,-Js.x,Ks.z,0,-Ks.x,ou.z,0,-ou.x,-Js.y,Js.x,0,-Ks.y,Ks.x,0,-ou.y,ou.x,0];return!qy(t,$h,Uh,Vh,S1)||(t=[1,0,0,0,1,0,0,0,1],!qy(t,$h,Uh,Vh,S1))?!1:(M1.crossVectors(Js,Ks),t=[M1.x,M1.y,M1.z],qy(t,$h,Uh,Vh,S1))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,to).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(to).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ls[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ls[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ls[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ls[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ls[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ls[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ls[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ls[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ls),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};h(AX,"Box3");var tn=AX,ls=[new le,new le,new le,new le,new le,new le,new le,new le],to=new le,w1=new tn,$h=new le,Uh=new le,Vh=new le,Js=new le,Ks=new le,ou=new le,Xd=new le,S1=new le,M1=new le,su=new le;function qy(i,e,t,r,n){for(let a=0,o=i.length-3;a<=o;a+=3){su.fromArray(i,a);let s=n.x*Math.abs(su.x)+n.y*Math.abs(su.y)+n.z*Math.abs(su.z),l=e.dot(su),u=t.dot(su),c=r.dot(su);if(Math.max(-Math.max(l,u,c),Math.min(l,u,c))>s)return!1}return!0}h(qy,"satForAxes");var z0e=new tn,qd=new le,K2=new le,IX=class{constructor(e=new le,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):z0e.setFromPoints(e).getCenter(r);let n=0;for(let a=0,o=e.length;a<o;a++)n=Math.max(n,r.distanceToSquared(e[a]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;qd.subVectors(e,this.center);let t=qd.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),n=(r-this.radius)*.5;this.center.addScaledVector(qd,n/r),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(K2.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(qd.copy(e.center).add(K2)),this.expandByPoint(qd.copy(e.center).sub(K2))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}};h(IX,"Sphere");var ea=IX,us=new le,Q2=new le,C1=new le,Qs=new le,eb=new le,E1=new le,tb=new le,LX=class{constructor(e=new le,t=new le(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,us)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=us.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(us.copy(this.origin).addScaledVector(this.direction,t),us.distanceToSquared(e))}distanceSqToSegment(e,t,r,n){Q2.copy(e).add(t).multiplyScalar(.5),C1.copy(t).sub(e).normalize(),Qs.copy(this.origin).sub(Q2);let a=e.distanceTo(t)*.5,o=-this.direction.dot(C1),s=Qs.dot(this.direction),l=-Qs.dot(C1),u=Qs.lengthSq(),c=Math.abs(1-o*o),p,d,m,g;if(c>0)if(p=o*l-s,d=o*s-l,g=a*c,p>=0)if(d>=-g)if(d<=g){let _=1/c;p*=_,d*=_,m=p*(p+o*d+2*s)+d*(o*p+d+2*l)+u}else d=a,p=Math.max(0,-(o*d+s)),m=-p*p+d*(d+2*l)+u;else d=-a,p=Math.max(0,-(o*d+s)),m=-p*p+d*(d+2*l)+u;else d<=-g?(p=Math.max(0,-(-o*a+s)),d=p>0?-a:Math.min(Math.max(-a,-l),a),m=-p*p+d*(d+2*l)+u):d<=g?(p=0,d=Math.min(Math.max(-a,-l),a),m=d*(d+2*l)+u):(p=Math.max(0,-(o*a+s)),d=p>0?a:Math.min(Math.max(-a,-l),a),m=-p*p+d*(d+2*l)+u);else d=o>0?-a:a,p=Math.max(0,-(o*d+s)),m=-p*p+d*(d+2*l)+u;return r&&r.copy(this.origin).addScaledVector(this.direction,p),n&&n.copy(Q2).addScaledVector(C1,d),m}intersectSphere(e,t){us.subVectors(e.center,this.origin);let r=us.dot(this.direction),n=us.dot(us)-r*r,a=e.radius*e.radius;if(n>a)return null;let o=Math.sqrt(a-n),s=r-o,l=r+o;return l<0?null:s<0?this.at(l,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,n,a,o,s,l,u=1/this.direction.x,c=1/this.direction.y,p=1/this.direction.z,d=this.origin;return u>=0?(r=(e.min.x-d.x)*u,n=(e.max.x-d.x)*u):(r=(e.max.x-d.x)*u,n=(e.min.x-d.x)*u),c>=0?(a=(e.min.y-d.y)*c,o=(e.max.y-d.y)*c):(a=(e.max.y-d.y)*c,o=(e.min.y-d.y)*c),r>o||a>n||((a>r||isNaN(r))&&(r=a),(o<n||isNaN(n))&&(n=o),p>=0?(s=(e.min.z-d.z)*p,l=(e.max.z-d.z)*p):(s=(e.max.z-d.z)*p,l=(e.min.z-d.z)*p),r>l||s>n)||((s>r||r!==r)&&(r=s),(l<n||n!==n)&&(n=l),n<0)?null:this.at(r>=0?r:n,t)}intersectsBox(e){return this.intersectBox(e,us)!==null}intersectTriangle(e,t,r,n,a){eb.subVectors(t,e),E1.subVectors(r,e),tb.crossVectors(eb,E1);let o=this.direction.dot(tb),s;if(o>0){if(n)return null;s=1}else if(o<0)s=-1,o=-o;else return null;Qs.subVectors(this.origin,e);let l=s*this.direction.dot(E1.crossVectors(Qs,E1));if(l<0)return null;let u=s*this.direction.dot(eb.cross(Qs));if(u<0||l+u>o)return null;let c=-s*Qs.dot(tb);return c<0?null:this.at(c/o,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}};h(LX,"Ray");var Tg=LX,DX=class vS{constructor(e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y){vS.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y)}set(e,t,r,n,a,o,s,l,u,c,p,d,m,g,_,y){let x=this.elements;return x[0]=e,x[4]=t,x[8]=r,x[12]=n,x[1]=a,x[5]=o,x[9]=s,x[13]=l,x[2]=u,x[6]=c,x[10]=p,x[14]=d,x[3]=m,x[7]=g,x[11]=_,x[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new vS().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,n=1/jh.setFromMatrixColumn(e,0).length(),a=1/jh.setFromMatrixColumn(e,1).length(),o=1/jh.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,r=e.x,n=e.y,a=e.z,o=Math.cos(r),s=Math.sin(r),l=Math.cos(n),u=Math.sin(n),c=Math.cos(a),p=Math.sin(a);if(e.order==="XYZ"){let d=o*c,m=o*p,g=s*c,_=s*p;t[0]=l*c,t[4]=-l*p,t[8]=u,t[1]=m+g*u,t[5]=d-_*u,t[9]=-s*l,t[2]=_-d*u,t[6]=g+m*u,t[10]=o*l}else if(e.order==="YXZ"){let d=l*c,m=l*p,g=u*c,_=u*p;t[0]=d+_*s,t[4]=g*s-m,t[8]=o*u,t[1]=o*p,t[5]=o*c,t[9]=-s,t[2]=m*s-g,t[6]=_+d*s,t[10]=o*l}else if(e.order==="ZXY"){let d=l*c,m=l*p,g=u*c,_=u*p;t[0]=d-_*s,t[4]=-o*p,t[8]=g+m*s,t[1]=m+g*s,t[5]=o*c,t[9]=_-d*s,t[2]=-o*u,t[6]=s,t[10]=o*l}else if(e.order==="ZYX"){let d=o*c,m=o*p,g=s*c,_=s*p;t[0]=l*c,t[4]=g*u-m,t[8]=d*u+_,t[1]=l*p,t[5]=_*u+d,t[9]=m*u-g,t[2]=-u,t[6]=s*l,t[10]=o*l}else if(e.order==="YZX"){let d=o*l,m=o*u,g=s*l,_=s*u;t[0]=l*c,t[4]=_-d*p,t[8]=g*p+m,t[1]=p,t[5]=o*c,t[9]=-s*c,t[2]=-u*c,t[6]=m*p+g,t[10]=d-_*p}else if(e.order==="XZY"){let d=o*l,m=o*u,g=s*l,_=s*u;t[0]=l*c,t[4]=-p,t[8]=u*c,t[1]=d*p+_,t[5]=o*c,t[9]=m*p-g,t[2]=g*p-m,t[6]=s*c,t[10]=_*p+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(N0e,e,$0e)}lookAt(e,t,r){let n=this.elements;return aa.subVectors(e,t),aa.lengthSq()===0&&(aa.z=1),aa.normalize(),el.crossVectors(r,aa),el.lengthSq()===0&&(Math.abs(r.z)===1?aa.x+=1e-4:aa.z+=1e-4,aa.normalize(),el.crossVectors(r,aa)),el.normalize(),T1.crossVectors(aa,el),n[0]=el.x,n[4]=T1.x,n[8]=aa.x,n[1]=el.y,n[5]=T1.y,n[9]=aa.y,n[2]=el.z,n[6]=T1.z,n[10]=aa.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,n=t.elements,a=this.elements,o=r[0],s=r[4],l=r[8],u=r[12],c=r[1],p=r[5],d=r[9],m=r[13],g=r[2],_=r[6],y=r[10],x=r[14],w=r[3],b=r[7],C=r[11],E=r[15],T=n[0],L=n[4],D=n[8],B=n[12],A=n[1],k=n[5],$=n[9],z=n[13],P=n[2],U=n[6],G=n[10],K=n[14],O=n[3],V=n[7],j=n[11],q=n[15];return a[0]=o*T+s*A+l*P+u*O,a[4]=o*L+s*k+l*U+u*V,a[8]=o*D+s*$+l*G+u*j,a[12]=o*B+s*z+l*K+u*q,a[1]=c*T+p*A+d*P+m*O,a[5]=c*L+p*k+d*U+m*V,a[9]=c*D+p*$+d*G+m*j,a[13]=c*B+p*z+d*K+m*q,a[2]=g*T+_*A+y*P+x*O,a[6]=g*L+_*k+y*U+x*V,a[10]=g*D+_*$+y*G+x*j,a[14]=g*B+_*z+y*K+x*q,a[3]=w*T+b*A+C*P+E*O,a[7]=w*L+b*k+C*U+E*V,a[11]=w*D+b*$+C*G+E*j,a[15]=w*B+b*z+C*K+E*q,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],n=e[8],a=e[12],o=e[1],s=e[5],l=e[9],u=e[13],c=e[2],p=e[6],d=e[10],m=e[14],g=e[3],_=e[7],y=e[11],x=e[15];return g*(+a*l*p-n*u*p-a*s*d+r*u*d+n*s*m-r*l*m)+_*(+t*l*m-t*u*d+a*o*d-n*o*m+n*u*c-a*l*c)+y*(+t*u*p-t*s*m-a*o*p+r*o*m+a*s*c-r*u*c)+x*(-n*s*c-t*l*p+t*s*d+n*o*p-r*o*d+r*l*c)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],p=e[9],d=e[10],m=e[11],g=e[12],_=e[13],y=e[14],x=e[15],w=p*y*u-_*d*u+_*l*m-s*y*m-p*l*x+s*d*x,b=g*d*u-c*y*u-g*l*m+o*y*m+c*l*x-o*d*x,C=c*_*u-g*p*u+g*s*m-o*_*m-c*s*x+o*p*x,E=g*p*l-c*_*l-g*s*d+o*_*d+c*s*y-o*p*y,T=t*w+r*b+n*C+a*E;if(T===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let L=1/T;return e[0]=w*L,e[1]=(_*d*a-p*y*a-_*n*m+r*y*m+p*n*x-r*d*x)*L,e[2]=(s*y*a-_*l*a+_*n*u-r*y*u-s*n*x+r*l*x)*L,e[3]=(p*l*a-s*d*a-p*n*u+r*d*u+s*n*m-r*l*m)*L,e[4]=b*L,e[5]=(c*y*a-g*d*a+g*n*m-t*y*m-c*n*x+t*d*x)*L,e[6]=(g*l*a-o*y*a-g*n*u+t*y*u+o*n*x-t*l*x)*L,e[7]=(o*d*a-c*l*a+c*n*u-t*d*u-o*n*m+t*l*m)*L,e[8]=C*L,e[9]=(g*p*a-c*_*a-g*r*m+t*_*m+c*r*x-t*p*x)*L,e[10]=(o*_*a-g*s*a+g*r*u-t*_*u-o*r*x+t*s*x)*L,e[11]=(c*s*a-o*p*a-c*r*u+t*p*u+o*r*m-t*s*m)*L,e[12]=E*L,e[13]=(c*_*n-g*p*n+g*r*d-t*_*d-c*r*y+t*p*y)*L,e[14]=(g*s*n-o*_*n-g*r*l+t*_*l+o*r*y-t*s*y)*L,e[15]=(o*p*n-c*s*n+c*r*l-t*p*l-o*r*d+t*s*d)*L,this}scale(e){let t=this.elements,r=e.x,n=e.y,a=e.z;return t[0]*=r,t[4]*=n,t[8]*=a,t[1]*=r,t[5]*=n,t[9]*=a,t[2]*=r,t[6]*=n,t[10]*=a,t[3]*=r,t[7]*=n,t[11]*=a,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),n=Math.sin(t),a=1-r,o=e.x,s=e.y,l=e.z,u=a*o,c=a*s;return this.set(u*o+r,u*s-n*l,u*l+n*s,0,u*s+n*l,c*s+r,c*l-n*o,0,u*l-n*s,c*l+n*o,a*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,a,o){return this.set(1,r,a,0,e,1,o,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){let n=this.elements,a=t._x,o=t._y,s=t._z,l=t._w,u=a+a,c=o+o,p=s+s,d=a*u,m=a*c,g=a*p,_=o*c,y=o*p,x=s*p,w=l*u,b=l*c,C=l*p,E=r.x,T=r.y,L=r.z;return n[0]=(1-(_+x))*E,n[1]=(m+C)*E,n[2]=(g-b)*E,n[3]=0,n[4]=(m-C)*T,n[5]=(1-(d+x))*T,n[6]=(y+w)*T,n[7]=0,n[8]=(g+b)*L,n[9]=(y-w)*L,n[10]=(1-(d+_))*L,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){let n=this.elements,a=jh.set(n[0],n[1],n[2]).length(),o=jh.set(n[4],n[5],n[6]).length(),s=jh.set(n[8],n[9],n[10]).length();this.determinant()<0&&(a=-a),e.x=n[12],e.y=n[13],e.z=n[14],io.copy(this);let l=1/a,u=1/o,c=1/s;return io.elements[0]*=l,io.elements[1]*=l,io.elements[2]*=l,io.elements[4]*=u,io.elements[5]*=u,io.elements[6]*=u,io.elements[8]*=c,io.elements[9]*=c,io.elements[10]*=c,t.setFromRotationMatrix(io),r.x=a,r.y=o,r.z=s,this}makePerspective(e,t,r,n,a,o,s=Ds){let l=this.elements,u=2*a/(t-e),c=2*a/(r-n),p=(t+e)/(t-e),d=(r+n)/(r-n),m,g;if(s===Ds)m=-(o+a)/(o-a),g=-2*o*a/(o-a);else if(s===Jv)m=-o/(o-a),g=-o*a/(o-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return l[0]=u,l[4]=0,l[8]=p,l[12]=0,l[1]=0,l[5]=c,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=m,l[14]=g,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,n,a,o,s=Ds){let l=this.elements,u=1/(t-e),c=1/(r-n),p=1/(o-a),d=(t+e)*u,m=(r+n)*c,g,_;if(s===Ds)g=(o+a)*p,_=-2*p;else if(s===Jv)g=a*p,_=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*c,l[9]=0,l[13]=-m,l[2]=0,l[6]=0,l[10]=_,l[14]=-g,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}};h(DX,"Matrix4");var Gt=DX,jh=new le,io=new Gt,N0e=new le(0,0,0),$0e=new le(1,1,1),el=new le,T1=new le,aa=new le,PI=new Gt,AI=new Th,kX=class RX{constructor(e=0,t=0,r=0,n=RX.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let n=e.elements,a=n[0],o=n[4],s=n[8],l=n[1],u=n[5],c=n[9],p=n[2],d=n[6],m=n[10];switch(t){case"XYZ":this._y=Math.asin(Nr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,m),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Nr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(s,m),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-p,a),this._z=0);break;case"ZXY":this._x=Math.asin(Nr(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-p,m),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-Nr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Nr(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-c,u),this._y=Math.atan2(-p,a)):(this._x=0,this._y=Math.atan2(s,m));break;case"XZY":this._z=Math.asin(-Nr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-c,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return PI.makeRotationFromQuaternion(e),this.setFromRotationMatrix(PI,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return AI.setFromEuler(this),this.setFromQuaternion(AI,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};h(kX,"Euler");var Xa=kX;Xa.DEFAULT_ORDER="XYZ";var FX=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}};h(FX,"Layers");var ET=FX,U0e=0,II=new le,Hh=new Th,hs=new Gt,P1=new le,Zd=new le,V0e=new le,j0e=new Th,LI=new le(1,0,0),DI=new le(0,1,0),kI=new le(0,0,1),H0e={type:"added"},G0e={type:"removed"},ib={type:"childadded",child:null},rb={type:"childremoved",child:null},OX=class Zy extends bd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:U0e++}),this.uuid=va(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Zy.DEFAULT_UP.clone();let e=new le,t=new Xa,r=new Th,n=new le(1,1,1);function a(){r.setFromEuler(t,!1)}h(a,"onRotationChange");function o(){t.setFromQuaternion(r,void 0,!1)}h(o,"onQuaternionChange"),t._onChange(a),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Gt},normalMatrix:{value:new ri}}),this.matrix=new Gt,this.matrixWorld=new Gt,this.matrixAutoUpdate=Zy.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Zy.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new ET,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Hh.setFromAxisAngle(e,t),this.quaternion.multiply(Hh),this}rotateOnWorldAxis(e,t){return Hh.setFromAxisAngle(e,t),this.quaternion.premultiply(Hh),this}rotateX(e){return this.rotateOnAxis(LI,e)}rotateY(e){return this.rotateOnAxis(DI,e)}rotateZ(e){return this.rotateOnAxis(kI,e)}translateOnAxis(e,t){return II.copy(e).applyQuaternion(this.quaternion),this.position.add(II.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(LI,e)}translateY(e){return this.translateOnAxis(DI,e)}translateZ(e){return this.translateOnAxis(kI,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(hs.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?P1.copy(e):P1.set(e,t,r);let n=this.parent;this.updateWorldMatrix(!0,!1),Zd.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?hs.lookAt(Zd,P1,this.up):hs.lookAt(P1,Zd,this.up),this.quaternion.setFromRotationMatrix(hs),n&&(hs.extractRotation(n.matrixWorld),Hh.setFromRotationMatrix(hs),this.quaternion.premultiply(Hh.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(H0e),ib.child=e,this.dispatchEvent(ib),ib.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(G0e),rb.child=e,this.dispatchEvent(rb),rb.child=null),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),hs.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),hs.multiply(e.parent.matrixWorld)),e.applyMatrix4(hs),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){let a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);let n=this.children;for(let a=0,o=n.length;a<o;a++)n[a].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zd,e,V0e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Zd,j0e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,n=t.length;r<n;r++){let a=t[r];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let n=this.children;for(let a=0,o=n.length;a<o;a++){let s=n[a];s.matrixWorldAutoUpdate===!0&&s.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),n.maxGeometryCount=this._maxGeometryCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function a(s,l){return s[l.uuid]===void 0&&(s[l.uuid]=l.toJSON(e)),l.uuid}if(h(a,"serialize"),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=a(e.geometries,this.geometry);let s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){let l=s.shapes;if(Array.isArray(l))for(let u=0,c=l.length;u<c;u++){let p=l[u];a(e.shapes,p)}else a(e.shapes,l)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let s=[];for(let l=0,u=this.material.length;l<u;l++)s.push(a(e.materials,this.material[l]));n.material=s}else n.material=a(e.materials,this.material);if(this.children.length>0){n.children=[];for(let s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let s=0;s<this.animations.length;s++){let l=this.animations[s];n.animations.push(a(e.animations,l))}}if(t){let s=o(e.geometries),l=o(e.materials),u=o(e.textures),c=o(e.images),p=o(e.shapes),d=o(e.skeletons),m=o(e.animations),g=o(e.nodes);s.length>0&&(r.geometries=s),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),c.length>0&&(r.images=c),p.length>0&&(r.shapes=p),d.length>0&&(r.skeletons=d),m.length>0&&(r.animations=m),g.length>0&&(r.nodes=g)}return r.object=n,r;function o(s){let l=[];for(let u in s){let c=s[u];delete c.metadata,l.push(c)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let n=e.children[r];this.add(n.clone())}return this}};h(OX,"Object3D");var or=OX;or.DEFAULT_UP=new le(0,1,0);or.DEFAULT_MATRIX_AUTO_UPDATE=!0;or.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var ro=new le,cs=new le,nb=new le,ps=new le,Gh=new le,Wh=new le,RI=new le,ab=new le,ob=new le,sb=new le,BX=class fc{constructor(e=new le,t=new le,r=new le){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,n){n.subVectors(r,t),ro.subVectors(e,t),n.cross(ro);let a=n.lengthSq();return a>0?n.multiplyScalar(1/Math.sqrt(a)):n.set(0,0,0)}static getBarycoord(e,t,r,n,a){ro.subVectors(n,t),cs.subVectors(r,t),nb.subVectors(e,t);let o=ro.dot(ro),s=ro.dot(cs),l=ro.dot(nb),u=cs.dot(cs),c=cs.dot(nb),p=o*u-s*s;if(p===0)return a.set(0,0,0),null;let d=1/p,m=(u*l-s*c)*d,g=(o*c-s*l)*d;return a.set(1-m-g,g,m)}static containsPoint(e,t,r,n){return this.getBarycoord(e,t,r,n,ps)===null?!1:ps.x>=0&&ps.y>=0&&ps.x+ps.y<=1}static getInterpolation(e,t,r,n,a,o,s,l){return this.getBarycoord(e,t,r,n,ps)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(a,ps.x),l.addScaledVector(o,ps.y),l.addScaledVector(s,ps.z),l)}static isFrontFacing(e,t,r,n){return ro.subVectors(r,t),cs.subVectors(e,t),ro.cross(cs).dot(n)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,n){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,r,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ro.subVectors(this.c,this.b),cs.subVectors(this.a,this.b),ro.cross(cs).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return fc.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return fc.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,n,a){return fc.getInterpolation(e,this.a,this.b,this.c,t,r,n,a)}containsPoint(e){return fc.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return fc.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,n=this.b,a=this.c,o,s;Gh.subVectors(n,r),Wh.subVectors(a,r),ab.subVectors(e,r);let l=Gh.dot(ab),u=Wh.dot(ab);if(l<=0&&u<=0)return t.copy(r);ob.subVectors(e,n);let c=Gh.dot(ob),p=Wh.dot(ob);if(c>=0&&p<=c)return t.copy(n);let d=l*p-c*u;if(d<=0&&l>=0&&c<=0)return o=l/(l-c),t.copy(r).addScaledVector(Gh,o);sb.subVectors(e,a);let m=Gh.dot(sb),g=Wh.dot(sb);if(g>=0&&m<=g)return t.copy(a);let _=m*u-l*g;if(_<=0&&u>=0&&g<=0)return s=u/(u-g),t.copy(r).addScaledVector(Wh,s);let y=c*g-m*p;if(y<=0&&p-c>=0&&m-g>=0)return RI.subVectors(a,n),s=(p-c)/(p-c+(m-g)),t.copy(n).addScaledVector(RI,s);let x=1/(y+_+d);return o=_*x,s=d*x,t.copy(r).addScaledVector(Gh,o).addScaledVector(Wh,s)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};h(BX,"Triangle");var Tf=BX,zX={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},tl={h:0,s:0,l:0},A1={h:0,s:0,l:0};function Yy(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}h(Yy,"hue2rgb");var NX=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){let n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Un){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ei.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=Ei.workingColorSpace){return this.r=e,this.g=t,this.b=r,Ei.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=Ei.workingColorSpace){if(e=M_(e,1),t=Nr(t,0,1),r=Nr(r,0,1),t===0)this.r=this.g=this.b=r;else{let a=r<=.5?r*(1+t):r+t-r*t,o=2*r-a;this.r=Yy(o,a,e+1/3),this.g=Yy(o,a,e),this.b=Yy(o,a,e-1/3)}return Ei.toWorkingColorSpace(this,n),this}setStyle(e,t=Un){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}h(r,"handleAlpha");let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let a,o=n[1],s=n[2];switch(o){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){let a=n[1],o=a.length;if(o===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Un){let r=zX[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ju(e.r),this.g=Ju(e.g),this.b=Ju(e.b),this}copyLinearToSRGB(e){return this.r=Gy(e.r),this.g=Gy(e.g),this.b=Gy(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Un){return Ei.fromWorkingColorSpace(sn.copy(this),e),Math.round(Nr(sn.r*255,0,255))*65536+Math.round(Nr(sn.g*255,0,255))*256+Math.round(Nr(sn.b*255,0,255))}getHexString(e=Un){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ei.workingColorSpace){Ei.fromWorkingColorSpace(sn.copy(this),t);let r=sn.r,n=sn.g,a=sn.b,o=Math.max(r,n,a),s=Math.min(r,n,a),l,u,c=(s+o)/2;if(s===o)l=0,u=0;else{let p=o-s;switch(u=c<=.5?p/(o+s):p/(2-o-s),o){case r:l=(n-a)/p+(n<a?6:0);break;case n:l=(a-r)/p+2;break;case a:l=(r-n)/p+4;break}l/=6}return e.h=l,e.s=u,e.l=c,e}getRGB(e,t=Ei.workingColorSpace){return Ei.fromWorkingColorSpace(sn.copy(this),t),e.r=sn.r,e.g=sn.g,e.b=sn.b,e}getStyle(e=Un){Ei.fromWorkingColorSpace(sn.copy(this),e);let t=sn.r,r=sn.g,n=sn.b;return e!==Un?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(n*255)})`}offsetHSL(e,t,r){return this.getHSL(tl),this.setHSL(tl.h+e,tl.s+t,tl.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(tl),e.getHSL(A1);let r=Ap(tl.h,A1.h,t),n=Ap(tl.s,A1.s,t),a=Ap(tl.l,A1.l,t);return this.setHSL(r,n,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,r=this.g,n=this.b,a=e.elements;return this.r=a[0]*t+a[3]*r+a[6]*n,this.g=a[1]*t+a[4]*r+a[7]*n,this.b=a[2]*t+a[5]*r+a[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};h(NX,"Color");var Rt=NX,sn=new Rt;Rt.NAMES=zX;var W0e=0,$X=class extends bd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:W0e++}),this.uuid=va(),this.name="",this.type="Material",this.blending=Tp,this.side=Xl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=cS,this.blendDst=pS,this.blendEquation=Lu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Rt(0,0,0),this.blendAlpha=0,this.depthFunc=Gv,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=bI,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=zh,this.stencilZFail=zh,this.stencilZPass=zh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let n=this[t];if(n===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Tp&&(r.blending=this.blending),this.side!==Xl&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==cS&&(r.blendSrc=this.blendSrc),this.blendDst!==pS&&(r.blendDst=this.blendDst),this.blendEquation!==Lu&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==Gv&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==bI&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==zh&&(r.stencilFail=this.stencilFail),this.stencilZFail!==zh&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==zh&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function n(a){let o=[];for(let s in a){let l=a[s];delete l.metadata,o.push(l)}return o}if(h(n,"extractFromCache"),t){let a=n(e.textures),o=n(e.images);a.length>0&&(r.textures=a),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let n=t.length;r=new Array(n);for(let a=0;a!==n;++a)r[a]=t[a].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}};h($X,"Material");var iu=$X,UX=class extends iu{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Rt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xa,this.combine=_T,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};h(UX,"MeshBasicMaterial");var wd=UX,Tr=new le,I1=new Ne,VX=class{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=gS,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=ca,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return CT("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let n=0,a=this.itemSize;n<a;n++)this.array[e+n]=t.array[r+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)I1.fromBufferAttribute(this,t),I1.applyMatrix3(e),this.setXY(t,I1.x,I1.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Tr.fromBufferAttribute(this,t),Tr.applyMatrix3(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Tr.fromBufferAttribute(this,t),Tr.applyMatrix4(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Tr.fromBufferAttribute(this,t),Tr.applyNormalMatrix(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Tr.fromBufferAttribute(this,t),Tr.transformDirection(e),this.setXYZ(t,Tr.x,Tr.y,Tr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=$a(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=_i(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=$a(t,this.array)),t}setX(e,t){return this.normalized&&(t=_i(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=$a(t,this.array)),t}setY(e,t){return this.normalized&&(t=_i(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=$a(t,this.array)),t}setZ(e,t){return this.normalized&&(t=_i(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=$a(t,this.array)),t}setW(e,t){return this.normalized&&(t=_i(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=_i(t,this.array),r=_i(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,n){return e*=this.itemSize,this.normalized&&(t=_i(t,this.array),r=_i(r,this.array),n=_i(n,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,t,r,n,a){return e*=this.itemSize,this.normalized&&(t=_i(t,this.array),r=_i(r,this.array),n=_i(n,this.array),a=_i(a,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==gS&&(e.usage=this.usage),e}};h(VX,"BufferAttribute");var Ur=VX,jX=class extends Ur{constructor(e,t,r){super(new Uint16Array(e),t,r)}};h(jX,"Uint16BufferAttribute");var HX=jX,GX=class extends Ur{constructor(e,t,r){super(new Uint32Array(e),t,r)}};h(GX,"Uint32BufferAttribute");var WX=GX,XX=class extends Ur{constructor(e,t,r){super(new Float32Array(e),t,r)}};h(XX,"Float32BufferAttribute");var qr=XX,X0e=0,Ia=new Gt,lb=new or,Xh=new le,oa=new tn,Yd=new tn,Gr=new le,qX=class ZX extends bd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:X0e++}),this.uuid=va(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(MT(e)?WX:HX)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let a=new ri().getNormalMatrix(e);r.applyNormalMatrix(a),r.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ia.makeRotationFromQuaternion(e),this.applyMatrix4(Ia),this}rotateX(e){return Ia.makeRotationX(e),this.applyMatrix4(Ia),this}rotateY(e){return Ia.makeRotationY(e),this.applyMatrix4(Ia),this}rotateZ(e){return Ia.makeRotationZ(e),this.applyMatrix4(Ia),this}translate(e,t,r){return Ia.makeTranslation(e,t,r),this.applyMatrix4(Ia),this}scale(e,t,r){return Ia.makeScale(e,t,r),this.applyMatrix4(Ia),this}lookAt(e){return lb.lookAt(e),lb.updateMatrix(),this.applyMatrix4(lb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xh).negate(),this.translate(Xh.x,Xh.y,Xh.z),this}setFromPoints(e){let t=[];for(let r=0,n=e.length;r<n;r++){let a=e[r];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new qr(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new tn);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new le(-1/0,-1/0,-1/0),new le(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,n=t.length;r<n;r++){let a=t[r];oa.setFromBufferAttribute(a),this.morphTargetsRelative?(Gr.addVectors(this.boundingBox.min,oa.min),this.boundingBox.expandByPoint(Gr),Gr.addVectors(this.boundingBox.max,oa.max),this.boundingBox.expandByPoint(Gr)):(this.boundingBox.expandByPoint(oa.min),this.boundingBox.expandByPoint(oa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ea);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new le,1/0);return}if(e){let r=this.boundingSphere.center;if(oa.setFromBufferAttribute(e),t)for(let a=0,o=t.length;a<o;a++){let s=t[a];Yd.setFromBufferAttribute(s),this.morphTargetsRelative?(Gr.addVectors(oa.min,Yd.min),oa.expandByPoint(Gr),Gr.addVectors(oa.max,Yd.max),oa.expandByPoint(Gr)):(oa.expandByPoint(Yd.min),oa.expandByPoint(Yd.max))}oa.getCenter(r);let n=0;for(let a=0,o=e.count;a<o;a++)Gr.fromBufferAttribute(e,a),n=Math.max(n,r.distanceToSquared(Gr));if(t)for(let a=0,o=t.length;a<o;a++){let s=t[a],l=this.morphTargetsRelative;for(let u=0,c=s.count;u<c;u++)Gr.fromBufferAttribute(s,u),l&&(Xh.fromBufferAttribute(e,u),Gr.add(Xh)),n=Math.max(n,r.distanceToSquared(Gr))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=t.position,n=t.normal,a=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ur(new Float32Array(4*r.count),4));let o=this.getAttribute("tangent"),s=[],l=[];for(let D=0;D<r.count;D++)s[D]=new le,l[D]=new le;let u=new le,c=new le,p=new le,d=new Ne,m=new Ne,g=new Ne,_=new le,y=new le;function x(D,B,A){u.fromBufferAttribute(r,D),c.fromBufferAttribute(r,B),p.fromBufferAttribute(r,A),d.fromBufferAttribute(a,D),m.fromBufferAttribute(a,B),g.fromBufferAttribute(a,A),c.sub(u),p.sub(u),m.sub(d),g.sub(d);let k=1/(m.x*g.y-g.x*m.y);isFinite(k)&&(_.copy(c).multiplyScalar(g.y).addScaledVector(p,-m.y).multiplyScalar(k),y.copy(p).multiplyScalar(m.x).addScaledVector(c,-g.x).multiplyScalar(k),s[D].add(_),s[B].add(_),s[A].add(_),l[D].add(y),l[B].add(y),l[A].add(y))}h(x,"handleTriangle");let w=this.groups;w.length===0&&(w=[{start:0,count:e.count}]);for(let D=0,B=w.length;D<B;++D){let A=w[D],k=A.start,$=A.count;for(let z=k,P=k+$;z<P;z+=3)x(e.getX(z+0),e.getX(z+1),e.getX(z+2))}let b=new le,C=new le,E=new le,T=new le;function L(D){E.fromBufferAttribute(n,D),T.copy(E);let B=s[D];b.copy(B),b.sub(E.multiplyScalar(E.dot(B))).normalize(),C.crossVectors(T,B);let A=C.dot(l[D])<0?-1:1;o.setXYZW(D,b.x,b.y,b.z,A)}h(L,"handleVertex");for(let D=0,B=w.length;D<B;++D){let A=w[D],k=A.start,$=A.count;for(let z=k,P=k+$;z<P;z+=3)L(e.getX(z+0)),L(e.getX(z+1)),L(e.getX(z+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ur(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let d=0,m=r.count;d<m;d++)r.setXYZ(d,0,0,0);let n=new le,a=new le,o=new le,s=new le,l=new le,u=new le,c=new le,p=new le;if(e)for(let d=0,m=e.count;d<m;d+=3){let g=e.getX(d+0),_=e.getX(d+1),y=e.getX(d+2);n.fromBufferAttribute(t,g),a.fromBufferAttribute(t,_),o.fromBufferAttribute(t,y),c.subVectors(o,a),p.subVectors(n,a),c.cross(p),s.fromBufferAttribute(r,g),l.fromBufferAttribute(r,_),u.fromBufferAttribute(r,y),s.add(c),l.add(c),u.add(c),r.setXYZ(g,s.x,s.y,s.z),r.setXYZ(_,l.x,l.y,l.z),r.setXYZ(y,u.x,u.y,u.z)}else for(let d=0,m=t.count;d<m;d+=3)n.fromBufferAttribute(t,d+0),a.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),c.subVectors(o,a),p.subVectors(n,a),c.cross(p),r.setXYZ(d+0,c.x,c.y,c.z),r.setXYZ(d+1,c.x,c.y,c.z),r.setXYZ(d+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Gr.fromBufferAttribute(e,t),Gr.normalize(),e.setXYZ(t,Gr.x,Gr.y,Gr.z)}toNonIndexed(){function e(s,l){let u=s.array,c=s.itemSize,p=s.normalized,d=new u.constructor(l.length*c),m=0,g=0;for(let _=0,y=l.length;_<y;_++){s.isInterleavedBufferAttribute?m=l[_]*s.data.stride+s.offset:m=l[_]*c;for(let x=0;x<c;x++)d[g++]=u[m++]}return new Ur(d,c,p)}if(h(e,"convertBufferAttribute"),this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new ZX,r=this.index.array,n=this.attributes;for(let s in n){let l=n[s],u=e(l,r);t.setAttribute(s,u)}let a=this.morphAttributes;for(let s in a){let l=[],u=a[s];for(let c=0,p=u.length;c<p;c++){let d=u[c],m=e(d,r);l.push(m)}t.morphAttributes[s]=l}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let s=0,l=o.length;s<l;s++){let u=o[s];t.addGroup(u.start,u.count,u.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let u in l)l[u]!==void 0&&(e[u]=l[u]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let l in r){let u=r[l];e.data.attributes[l]=u.toJSON(e.data)}let n={},a=!1;for(let l in this.morphAttributes){let u=this.morphAttributes[l],c=[];for(let p=0,d=u.length;p<d;p++){let m=u[p];c.push(m.toJSON(e.data))}c.length>0&&(n[l]=c,a=!0)}a&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let s=this.boundingSphere;return s!==null&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let n=e.attributes;for(let u in n){let c=n[u];this.setAttribute(u,c.clone(t))}let a=e.morphAttributes;for(let u in a){let c=[],p=a[u];for(let d=0,m=p.length;d<m;d++)c.push(p[d].clone(t));this.morphAttributes[u]=c}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let u=0,c=o.length;u<c;u++){let p=o[u];this.addGroup(p.start,p.count,p.materialIndex)}let s=e.boundingBox;s!==null&&(this.boundingBox=s.clone());let l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}};h(qX,"BufferGeometry");var Sa=qX,FI=new Gt,lu=new Tg,L1=new ea,OI=new le,qh=new le,Zh=new le,Yh=new le,ub=new le,D1=new le,k1=new Ne,R1=new Ne,F1=new Ne,BI=new le,zI=new le,NI=new le,O1=new le,B1=new le,YX=class extends or{constructor(e=new Sa,t=new wd){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=r.length;n<a;n++){let o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}getVertexPosition(e,t){let r=this.geometry,n=r.attributes.position,a=r.morphAttributes.position,o=r.morphTargetsRelative;t.fromBufferAttribute(n,e);let s=this.morphTargetInfluences;if(a&&s){D1.set(0,0,0);for(let l=0,u=a.length;l<u;l++){let c=s[l],p=a[l];c!==0&&(ub.fromBufferAttribute(p,e),o?D1.addScaledVector(ub,c):D1.addScaledVector(ub.sub(t),c))}t.add(D1)}return t}raycast(e,t){let r=this.geometry,n=this.material,a=this.matrixWorld;n!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),L1.copy(r.boundingSphere),L1.applyMatrix4(a),lu.copy(e.ray).recast(e.near),!(L1.containsPoint(lu.origin)===!1&&(lu.intersectSphere(L1,OI)===null||lu.origin.distanceToSquared(OI)>(e.far-e.near)**2))&&(FI.copy(a).invert(),lu.copy(e.ray).applyMatrix4(FI),!(r.boundingBox!==null&&lu.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,lu)))}_computeIntersections(e,t,r){let n,a=this.geometry,o=this.material,s=a.index,l=a.attributes.position,u=a.attributes.uv,c=a.attributes.uv1,p=a.attributes.normal,d=a.groups,m=a.drawRange;if(s!==null)if(Array.isArray(o))for(let g=0,_=d.length;g<_;g++){let y=d[g],x=o[y.materialIndex],w=Math.max(y.start,m.start),b=Math.min(s.count,Math.min(y.start+y.count,m.start+m.count));for(let C=w,E=b;C<E;C+=3){let T=s.getX(C),L=s.getX(C+1),D=s.getX(C+2);n=Pf(this,x,e,r,u,c,p,T,L,D),n&&(n.faceIndex=Math.floor(C/3),n.face.materialIndex=y.materialIndex,t.push(n))}}else{let g=Math.max(0,m.start),_=Math.min(s.count,m.start+m.count);for(let y=g,x=_;y<x;y+=3){let w=s.getX(y),b=s.getX(y+1),C=s.getX(y+2);n=Pf(this,o,e,r,u,c,p,w,b,C),n&&(n.faceIndex=Math.floor(y/3),t.push(n))}}else if(l!==void 0)if(Array.isArray(o))for(let g=0,_=d.length;g<_;g++){let y=d[g],x=o[y.materialIndex],w=Math.max(y.start,m.start),b=Math.min(l.count,Math.min(y.start+y.count,m.start+m.count));for(let C=w,E=b;C<E;C+=3){let T=C,L=C+1,D=C+2;n=Pf(this,x,e,r,u,c,p,T,L,D),n&&(n.faceIndex=Math.floor(C/3),n.face.materialIndex=y.materialIndex,t.push(n))}}else{let g=Math.max(0,m.start),_=Math.min(l.count,m.start+m.count);for(let y=g,x=_;y<x;y+=3){let w=y,b=y+1,C=y+2;n=Pf(this,o,e,r,u,c,p,w,b,C),n&&(n.faceIndex=Math.floor(y/3),t.push(n))}}}};h(YX,"Mesh");var Zi=YX;function JX(i,e,t,r,n,a,o,s){let l;if(e.side===Qn?l=r.intersectTriangle(o,a,n,!0,s):l=r.intersectTriangle(n,a,o,e.side===Xl,s),l===null)return null;B1.copy(s),B1.applyMatrix4(i.matrixWorld);let u=t.ray.origin.distanceTo(B1);return u<t.near||u>t.far?null:{distance:u,point:B1.clone(),object:i}}h(JX,"checkIntersection");function Pf(i,e,t,r,n,a,o,s,l,u){i.getVertexPosition(s,qh),i.getVertexPosition(l,Zh),i.getVertexPosition(u,Yh);let c=JX(i,e,t,r,qh,Zh,Yh,O1);if(c){n&&(k1.fromBufferAttribute(n,s),R1.fromBufferAttribute(n,l),F1.fromBufferAttribute(n,u),c.uv=Tf.getInterpolation(O1,qh,Zh,Yh,k1,R1,F1,new Ne)),a&&(k1.fromBufferAttribute(a,s),R1.fromBufferAttribute(a,l),F1.fromBufferAttribute(a,u),c.uv1=Tf.getInterpolation(O1,qh,Zh,Yh,k1,R1,F1,new Ne)),o&&(BI.fromBufferAttribute(o,s),zI.fromBufferAttribute(o,l),NI.fromBufferAttribute(o,u),c.normal=Tf.getInterpolation(O1,qh,Zh,Yh,BI,zI,NI,new le),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));let p={a:s,b:l,c:u,normal:new le,materialIndex:0};Tf.getNormal(qh,Zh,Yh,p.normal),c.face=p}return c}h(Pf,"checkGeometryIntersection");var KX=class QX extends Sa{constructor(e=1,t=1,r=1,n=1,a=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:n,heightSegments:a,depthSegments:o};let s=this;n=Math.floor(n),a=Math.floor(a),o=Math.floor(o);let l=[],u=[],c=[],p=[],d=0,m=0;g("z","y","x",-1,-1,r,t,e,o,a,0),g("z","y","x",1,-1,r,t,-e,o,a,1),g("x","z","y",1,1,e,r,t,n,o,2),g("x","z","y",1,-1,e,r,-t,n,o,3),g("x","y","z",1,-1,e,t,r,n,a,4),g("x","y","z",-1,-1,e,t,-r,n,a,5),this.setIndex(l),this.setAttribute("position",new qr(u,3)),this.setAttribute("normal",new qr(c,3)),this.setAttribute("uv",new qr(p,2));function g(_,y,x,w,b,C,E,T,L,D,B){let A=C/L,k=E/D,$=C/2,z=E/2,P=T/2,U=L+1,G=D+1,K=0,O=0,V=new le;for(let j=0;j<G;j++){let q=j*k-z;for(let ee=0;ee<U;ee++){let ae=ee*A-$;V[_]=ae*w,V[y]=q*b,V[x]=P,u.push(V.x,V.y,V.z),V[_]=0,V[y]=0,V[x]=T>0?1:-1,c.push(V.x,V.y,V.z),p.push(ee/L),p.push(1-j/D),K+=1}}for(let j=0;j<D;j++)for(let q=0;q<L;q++){let ee=d+q+U*j,ae=d+q+U*(j+1),N=d+(q+1)+U*(j+1),J=d+(q+1)+U*j;l.push(ee,ae,J),l.push(ae,N,J),O+=6}s.addGroup(m,O,B),m+=O,d+=K}h(g,"buildPlane")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QX(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};h(KX,"BoxGeometry");var C_=KX;function fh(i){let e={};for(let t in i){e[t]={};for(let r in i[t]){let n=i[t][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=n.clone():Array.isArray(n)?e[t][r]=n.slice():e[t][r]=n}}return e}h(fh,"cloneUniforms");function hn(i){let e={};for(let t=0;t<i.length;t++){let r=fh(i[t]);for(let n in r)e[n]=r[n]}return e}h(hn,"mergeUniforms");function eq(i){let e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}h(eq,"cloneUniformsGroups");function TT(i){return i.getRenderTarget()===null?i.outputColorSpace:Ei.workingColorSpace}h(TT,"getUnlitUniformColorSpace");var q0e={clone:fh,merge:hn},Z0e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Y0e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,tq=class extends iu{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Z0e,this.fragmentShader=Y0e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=fh(e.uniforms),this.uniformsGroups=eq(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let n in this.uniforms){let a=this.uniforms[n].value;a&&a.isTexture?t.uniforms[n]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[n]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[n]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[n]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[n]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[n]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[n]={type:"m4",value:a.toArray()}:t.uniforms[n]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let r={};for(let n in this.extensions)this.extensions[n]===!0&&(r[n]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}};h(tq,"ShaderMaterial");var Eo=tq,iq=class extends or{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Gt,this.projectionMatrix=new Gt,this.projectionMatrixInverse=new Gt,this.coordinateSystem=Ds}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};h(iq,"Camera");var PT=iq,il=new le,$I=new Ne,UI=new Ne,rq=class extends PT{constructor(e=50,t=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=id*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Pp*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return id*2*Math.atan(Math.tan(Pp*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){il.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(il.x,il.y).multiplyScalar(-e/il.z),il.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(il.x,il.y).multiplyScalar(-e/il.z)}getViewSize(e,t){return this.getViewBounds(e,$I,UI),t.subVectors(UI,$I)}setViewOffset(e,t,r,n,a,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Pp*.5*this.fov)/this.zoom,r=2*t,n=this.aspect*r,a=-.5*n,o=this.view;if(this.view!==null&&this.view.enabled){let l=o.fullWidth,u=o.fullHeight;a+=o.offsetX*n/l,t-=o.offsetY*r/u,n*=o.width/l,r*=o.height/u}let s=this.filmOffset;s!==0&&(a+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+n,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};h(rq,"PerspectiveCamera");var jn=rq,Jh=-90,Kh=1,nq=class extends or{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;let n=new jn(Jh,Kh,e,t);n.layers=this.layers,this.add(n);let a=new jn(Jh,Kh,e,t);a.layers=this.layers,this.add(a);let o=new jn(Jh,Kh,e,t);o.layers=this.layers,this.add(o);let s=new jn(Jh,Kh,e,t);s.layers=this.layers,this.add(s);let l=new jn(Jh,Kh,e,t);l.layers=this.layers,this.add(l);let u=new jn(Jh,Kh,e,t);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[r,n,a,o,s,l]=t;for(let u of t)this.remove(u);if(e===Ds)r.up.set(0,1,0),r.lookAt(1,0,0),n.up.set(0,1,0),n.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Jv)r.up.set(0,-1,0),r.lookAt(-1,0,0),n.up.set(0,-1,0),n.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let u of t)this.add(u),u.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:r,activeMipmapLevel:n}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[a,o,s,l,u,c]=this.children,p=e.getRenderTarget(),d=e.getActiveCubeFace(),m=e.getActiveMipmapLevel(),g=e.xr.enabled;e.xr.enabled=!1;let _=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,n),e.render(t,a),e.setRenderTarget(r,1,n),e.render(t,o),e.setRenderTarget(r,2,n),e.render(t,s),e.setRenderTarget(r,3,n),e.render(t,l),e.setRenderTarget(r,4,n),e.render(t,u),r.texture.generateMipmaps=_,e.setRenderTarget(r,5,n),e.render(t,c),e.setRenderTarget(p,d,m),e.xr.enabled=g,r.texture.needsPMREMUpdate=!0}};h(nq,"CubeCamera");var J0e=nq,aq=class extends Ln{constructor(e,t,r,n,a,o,s,l,u,c){e=e!==void 0?e:[],t=t!==void 0?t:Qp,super(e,t,r,n,a,o,s,l,u,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}};h(aq,"CubeTexture");var oq=aq,sq=class extends dh{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},n=[r,r,r,r,r,r];this.texture=new oq(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:$n}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new C_(5,5,5),a=new Eo({name:"CubemapFromEquirect",uniforms:fh(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Qn,blending:Nl});a.uniforms.tEquirect.value=t;let o=new Zi(n,a),s=t.minFilter;return t.minFilter===Nu&&(t.minFilter=$n),new J0e(1,10,this).update(e,o),t.minFilter=s,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,n){let a=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,n);e.setRenderTarget(a)}};h(sq,"WebGLCubeRenderTarget");var K0e=sq,hb=new le,Q0e=new le,eve=new ri,lq=class{constructor(e=new le(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,n){return this.normal.set(e,t,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let n=hb.subVectors(r,t).cross(Q0e.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let r=e.delta(hb),n=this.normal.dot(r);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let a=-(e.start.dot(this.normal)+this.constant)/n;return a<0||a>1?null:t.copy(e.start).addScaledVector(r,a)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||eve.getNormalMatrix(e),n=this.coplanarPoint(hb).applyMatrix4(e),a=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};h(lq,"Plane");var yu=lq,uu=new ea,z1=new le,uq=class{constructor(e=new yu,t=new yu,r=new yu,n=new yu,a=new yu,o=new yu){this.planes=[e,t,r,n,a,o]}set(e,t,r,n,a,o){let s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(r),s[3].copy(n),s[4].copy(a),s[5].copy(o),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=Ds){let r=this.planes,n=e.elements,a=n[0],o=n[1],s=n[2],l=n[3],u=n[4],c=n[5],p=n[6],d=n[7],m=n[8],g=n[9],_=n[10],y=n[11],x=n[12],w=n[13],b=n[14],C=n[15];if(r[0].setComponents(l-a,d-u,y-m,C-x).normalize(),r[1].setComponents(l+a,d+u,y+m,C+x).normalize(),r[2].setComponents(l+o,d+c,y+g,C+w).normalize(),r[3].setComponents(l-o,d-c,y-g,C-w).normalize(),r[4].setComponents(l-s,d-p,y-_,C-b).normalize(),t===Ds)r[5].setComponents(l+s,d+p,y+_,C+b).normalize();else if(t===Jv)r[5].setComponents(s,p,_,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),uu.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),uu.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(uu)}intersectsSprite(e){return uu.center.set(0,0,0),uu.radius=.7071067811865476,uu.applyMatrix4(e.matrixWorld),this.intersectsSphere(uu)}intersectsSphere(e){let t=this.planes,r=e.center,n=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let n=t[r];if(z1.x=n.normal.x>0?e.max.x:e.min.x,z1.y=n.normal.y>0?e.max.y:e.min.y,z1.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(z1)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};h(uq,"Frustum");var Pg=uq;function AT(){let i=null,e=!1,t=null,r=null;function n(a,o){t(a,o),r=i.requestAnimationFrame(n)}return h(n,"onAnimationFrame"),{start:function(){e!==!0&&t!==null&&(r=i.requestAnimationFrame(n),e=!0)},stop:function(){i.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){i=a}}}h(AT,"WebGLAnimation");function hq(i,e){let t=e.isWebGL2,r=new WeakMap;function n(u,c){let p=u.array,d=u.usage,m=p.byteLength,g=i.createBuffer();i.bindBuffer(c,g),i.bufferData(c,p,d),u.onUploadCallback();let _;if(p instanceof Float32Array)_=i.FLOAT;else if(p instanceof Uint16Array)if(u.isFloat16BufferAttribute)if(t)_=i.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else _=i.UNSIGNED_SHORT;else if(p instanceof Int16Array)_=i.SHORT;else if(p instanceof Uint32Array)_=i.UNSIGNED_INT;else if(p instanceof Int32Array)_=i.INT;else if(p instanceof Int8Array)_=i.BYTE;else if(p instanceof Uint8Array)_=i.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)_=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:g,type:_,bytesPerElement:p.BYTES_PER_ELEMENT,version:u.version,size:m}}h(n,"createBuffer");function a(u,c,p){let d=c.array,m=c._updateRange,g=c.updateRanges;if(i.bindBuffer(p,u),m.count===-1&&g.length===0&&i.bufferSubData(p,0,d),g.length!==0){for(let _=0,y=g.length;_<y;_++){let x=g[_];t?i.bufferSubData(p,x.start*d.BYTES_PER_ELEMENT,d,x.start,x.count):i.bufferSubData(p,x.start*d.BYTES_PER_ELEMENT,d.subarray(x.start,x.start+x.count))}c.clearUpdateRanges()}m.count!==-1&&(t?i.bufferSubData(p,m.offset*d.BYTES_PER_ELEMENT,d,m.offset,m.count):i.bufferSubData(p,m.offset*d.BYTES_PER_ELEMENT,d.subarray(m.offset,m.offset+m.count)),m.count=-1),c.onUploadCallback()}h(a,"updateBuffer");function o(u){return u.isInterleavedBufferAttribute&&(u=u.data),r.get(u)}h(o,"get");function s(u){u.isInterleavedBufferAttribute&&(u=u.data);let c=r.get(u);c&&(i.deleteBuffer(c.buffer),r.delete(u))}h(s,"remove");function l(u,c){if(u.isGLBufferAttribute){let d=r.get(u);(!d||d.version<u.version)&&r.set(u,{buffer:u.buffer,type:u.type,bytesPerElement:u.elementSize,version:u.version});return}u.isInterleavedBufferAttribute&&(u=u.data);let p=r.get(u);if(p===void 0)r.set(u,n(u,c));else if(p.version<u.version){if(p.size!==u.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");a(p.buffer,u,c),p.version=u.version}}return h(l,"update"),{get:o,remove:s,update:l}}h(hq,"WebGLAttributes");var cq=class pq extends Sa{constructor(e=1,t=1,r=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:n};let a=e/2,o=t/2,s=Math.floor(r),l=Math.floor(n),u=s+1,c=l+1,p=e/s,d=t/l,m=[],g=[],_=[],y=[];for(let x=0;x<c;x++){let w=x*d-o;for(let b=0;b<u;b++){let C=b*p-a;g.push(C,-w,0),_.push(0,0,1),y.push(b/s),y.push(1-x/l)}}for(let x=0;x<l;x++)for(let w=0;w<s;w++){let b=w+u*x,C=w+u*(x+1),E=w+1+u*(x+1),T=w+1+u*x;m.push(b,C,T),m.push(C,E,T)}this.setIndex(m),this.setAttribute("position",new qr(g,3)),this.setAttribute("normal",new qr(_,3)),this.setAttribute("uv",new qr(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pq(e.width,e.height,e.widthSegments,e.heightSegments)}};h(cq,"PlaneGeometry");var Ag=cq,tve=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,ive=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,rve=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,nve=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ave=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,ove=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,sve=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,lve=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,uve=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,hve=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,cve=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,pve=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,dve=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,fve=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,mve=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,gve=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,yve=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,vve=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,xve=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,_ve=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,bve=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,wve=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Sve=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Mve=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Cve=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Eve=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Tve=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Pve=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Ave=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Ive=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Lve="gl_FragColor = linearToOutputTexel( gl_FragColor );",Dve=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,kve=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Rve=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Fve=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Ove=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Bve=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,zve=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Nve=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,$ve=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Uve=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Vve=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,jve=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Hve=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Gve=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Wve=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Xve=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,qve=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Zve=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Yve=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Jve=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Kve=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Qve=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,exe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,txe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,ixe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,rxe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,nxe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,axe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,oxe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,sxe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,lxe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,uxe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,hxe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,cxe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,pxe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,dxe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,fxe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,mxe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,gxe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,yxe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,vxe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,xxe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,_xe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,bxe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,wxe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Sxe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Mxe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Cxe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Exe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Txe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Pxe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Axe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Ixe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Lxe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Dxe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,kxe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Rxe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Fxe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Oxe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Bxe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,zxe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Nxe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,$xe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Uxe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Vxe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,jxe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Hxe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Gxe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Wxe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Xxe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,qxe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	float startCompression = 0.8 - 0.04;
	float desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min(color.r, min(color.g, color.b));
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max(color.r, max(color.g, color.b));
	if (peak < startCompression) return color;
	float d = 1. - startCompression;
	float newPeak = 1. - d * d / (peak + d - startCompression);
	color *= newPeak / peak;
	float g = 1. - 1. / (desaturation * (peak - newPeak) + 1.);
	return mix(color, vec3(1, 1, 1), g);
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Zxe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Yxe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Jxe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Kxe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Qxe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,e_e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,t_e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,i_e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,r_e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,n_e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,a_e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,o_e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,s_e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,l_e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,u_e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,h_e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,c_e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,p_e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,d_e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,f_e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,m_e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,g_e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,y_e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,v_e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,x_e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,__e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,b_e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,w_e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,S_e=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,M_e=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,C_e=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,E_e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,T_e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,P_e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,A_e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,I_e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,L_e=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,D_e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,k_e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,R_e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Qt={alphahash_fragment:tve,alphahash_pars_fragment:ive,alphamap_fragment:rve,alphamap_pars_fragment:nve,alphatest_fragment:ave,alphatest_pars_fragment:ove,aomap_fragment:sve,aomap_pars_fragment:lve,batching_pars_vertex:uve,batching_vertex:hve,begin_vertex:cve,beginnormal_vertex:pve,bsdfs:dve,iridescence_fragment:fve,bumpmap_pars_fragment:mve,clipping_planes_fragment:gve,clipping_planes_pars_fragment:yve,clipping_planes_pars_vertex:vve,clipping_planes_vertex:xve,color_fragment:_ve,color_pars_fragment:bve,color_pars_vertex:wve,color_vertex:Sve,common:Mve,cube_uv_reflection_fragment:Cve,defaultnormal_vertex:Eve,displacementmap_pars_vertex:Tve,displacementmap_vertex:Pve,emissivemap_fragment:Ave,emissivemap_pars_fragment:Ive,colorspace_fragment:Lve,colorspace_pars_fragment:Dve,envmap_fragment:kve,envmap_common_pars_fragment:Rve,envmap_pars_fragment:Fve,envmap_pars_vertex:Ove,envmap_physical_pars_fragment:qve,envmap_vertex:Bve,fog_vertex:zve,fog_pars_vertex:Nve,fog_fragment:$ve,fog_pars_fragment:Uve,gradientmap_pars_fragment:Vve,lightmap_fragment:jve,lightmap_pars_fragment:Hve,lights_lambert_fragment:Gve,lights_lambert_pars_fragment:Wve,lights_pars_begin:Xve,lights_toon_fragment:Zve,lights_toon_pars_fragment:Yve,lights_phong_fragment:Jve,lights_phong_pars_fragment:Kve,lights_physical_fragment:Qve,lights_physical_pars_fragment:exe,lights_fragment_begin:txe,lights_fragment_maps:ixe,lights_fragment_end:rxe,logdepthbuf_fragment:nxe,logdepthbuf_pars_fragment:axe,logdepthbuf_pars_vertex:oxe,logdepthbuf_vertex:sxe,map_fragment:lxe,map_pars_fragment:uxe,map_particle_fragment:hxe,map_particle_pars_fragment:cxe,metalnessmap_fragment:pxe,metalnessmap_pars_fragment:dxe,morphinstance_vertex:fxe,morphcolor_vertex:mxe,morphnormal_vertex:gxe,morphtarget_pars_vertex:yxe,morphtarget_vertex:vxe,normal_fragment_begin:xxe,normal_fragment_maps:_xe,normal_pars_fragment:bxe,normal_pars_vertex:wxe,normal_vertex:Sxe,normalmap_pars_fragment:Mxe,clearcoat_normal_fragment_begin:Cxe,clearcoat_normal_fragment_maps:Exe,clearcoat_pars_fragment:Txe,iridescence_pars_fragment:Pxe,opaque_fragment:Axe,packing:Ixe,premultiplied_alpha_fragment:Lxe,project_vertex:Dxe,dithering_fragment:kxe,dithering_pars_fragment:Rxe,roughnessmap_fragment:Fxe,roughnessmap_pars_fragment:Oxe,shadowmap_pars_fragment:Bxe,shadowmap_pars_vertex:zxe,shadowmap_vertex:Nxe,shadowmask_pars_fragment:$xe,skinbase_vertex:Uxe,skinning_pars_vertex:Vxe,skinning_vertex:jxe,skinnormal_vertex:Hxe,specularmap_fragment:Gxe,specularmap_pars_fragment:Wxe,tonemapping_fragment:Xxe,tonemapping_pars_fragment:qxe,transmission_fragment:Zxe,transmission_pars_fragment:Yxe,uv_pars_fragment:Jxe,uv_pars_vertex:Kxe,uv_vertex:Qxe,worldpos_vertex:e_e,background_vert:t_e,background_frag:i_e,backgroundCube_vert:r_e,backgroundCube_frag:n_e,cube_vert:a_e,cube_frag:o_e,depth_vert:s_e,depth_frag:l_e,distanceRGBA_vert:u_e,distanceRGBA_frag:h_e,equirect_vert:c_e,equirect_frag:p_e,linedashed_vert:d_e,linedashed_frag:f_e,meshbasic_vert:m_e,meshbasic_frag:g_e,meshlambert_vert:y_e,meshlambert_frag:v_e,meshmatcap_vert:x_e,meshmatcap_frag:__e,meshnormal_vert:b_e,meshnormal_frag:w_e,meshphong_vert:S_e,meshphong_frag:M_e,meshphysical_vert:C_e,meshphysical_frag:E_e,meshtoon_vert:T_e,meshtoon_frag:P_e,points_vert:A_e,points_frag:I_e,shadow_vert:L_e,shadow_frag:D_e,sprite_vert:k_e,sprite_frag:R_e},st={common:{diffuse:{value:new Rt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ri},alphaMap:{value:null},alphaMapTransform:{value:new ri},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ri}},envmap:{envMap:{value:null},envMapRotation:{value:new ri},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ri}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ri}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ri},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ri},normalScale:{value:new Ne(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ri},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ri}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ri}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ri}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Rt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Rt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new ri},alphaTest:{value:0},uvTransform:{value:new ri}},sprite:{diffuse:{value:new Rt(16777215)},opacity:{value:1},center:{value:new Ne(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ri},alphaMap:{value:null},alphaMapTransform:{value:new ri},alphaTest:{value:0}}},jo={basic:{uniforms:hn([st.common,st.specularmap,st.envmap,st.aomap,st.lightmap,st.fog]),vertexShader:Qt.meshbasic_vert,fragmentShader:Qt.meshbasic_frag},lambert:{uniforms:hn([st.common,st.specularmap,st.envmap,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.fog,st.lights,{emissive:{value:new Rt(0)}}]),vertexShader:Qt.meshlambert_vert,fragmentShader:Qt.meshlambert_frag},phong:{uniforms:hn([st.common,st.specularmap,st.envmap,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.fog,st.lights,{emissive:{value:new Rt(0)},specular:{value:new Rt(1118481)},shininess:{value:30}}]),vertexShader:Qt.meshphong_vert,fragmentShader:Qt.meshphong_frag},standard:{uniforms:hn([st.common,st.envmap,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.roughnessmap,st.metalnessmap,st.fog,st.lights,{emissive:{value:new Rt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qt.meshphysical_vert,fragmentShader:Qt.meshphysical_frag},toon:{uniforms:hn([st.common,st.aomap,st.lightmap,st.emissivemap,st.bumpmap,st.normalmap,st.displacementmap,st.gradientmap,st.fog,st.lights,{emissive:{value:new Rt(0)}}]),vertexShader:Qt.meshtoon_vert,fragmentShader:Qt.meshtoon_frag},matcap:{uniforms:hn([st.common,st.bumpmap,st.normalmap,st.displacementmap,st.fog,{matcap:{value:null}}]),vertexShader:Qt.meshmatcap_vert,fragmentShader:Qt.meshmatcap_frag},points:{uniforms:hn([st.points,st.fog]),vertexShader:Qt.points_vert,fragmentShader:Qt.points_frag},dashed:{uniforms:hn([st.common,st.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qt.linedashed_vert,fragmentShader:Qt.linedashed_frag},depth:{uniforms:hn([st.common,st.displacementmap]),vertexShader:Qt.depth_vert,fragmentShader:Qt.depth_frag},normal:{uniforms:hn([st.common,st.bumpmap,st.normalmap,st.displacementmap,{opacity:{value:1}}]),vertexShader:Qt.meshnormal_vert,fragmentShader:Qt.meshnormal_frag},sprite:{uniforms:hn([st.sprite,st.fog]),vertexShader:Qt.sprite_vert,fragmentShader:Qt.sprite_frag},background:{uniforms:{uvTransform:{value:new ri},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Qt.background_vert,fragmentShader:Qt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new ri}},vertexShader:Qt.backgroundCube_vert,fragmentShader:Qt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Qt.cube_vert,fragmentShader:Qt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qt.equirect_vert,fragmentShader:Qt.equirect_frag},distanceRGBA:{uniforms:hn([st.common,st.displacementmap,{referencePosition:{value:new le},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qt.distanceRGBA_vert,fragmentShader:Qt.distanceRGBA_frag},shadow:{uniforms:hn([st.lights,st.fog,{color:{value:new Rt(0)},opacity:{value:1}}]),vertexShader:Qt.shadow_vert,fragmentShader:Qt.shadow_frag}};jo.physical={uniforms:hn([jo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ri},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ri},clearcoatNormalScale:{value:new Ne(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ri},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ri},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ri},sheen:{value:0},sheenColor:{value:new Rt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ri},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ri},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ri},transmissionSamplerSize:{value:new Ne},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ri},attenuationDistance:{value:0},attenuationColor:{value:new Rt(0)},specularColor:{value:new Rt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ri},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ri},anisotropyVector:{value:new Ne},anisotropyMap:{value:null},anisotropyMapTransform:{value:new ri}}]),vertexShader:Qt.meshphysical_vert,fragmentShader:Qt.meshphysical_frag};var N1={r:0,b:0,g:0},hu=new Xa,F_e=new Gt;function dq(i,e,t,r,n,a,o){let s=new Rt(0),l=a===!0?0:1,u,c,p=null,d=0,m=null;function g(y,x){let w=!1,b=x.isScene===!0?x.background:null;b&&b.isTexture&&(b=(x.backgroundBlurriness>0?t:e).get(b)),b===null?_(s,l):b&&b.isColor&&(_(b,1),w=!0);let C=i.xr.getEnvironmentBlendMode();C==="additive"?r.buffers.color.setClear(0,0,0,1,o):C==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(i.autoClear||w)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil),b&&(b.isCubeTexture||b.mapping===w_)?(c===void 0&&(c=new Zi(new C_(1,1,1),new Eo({name:"BackgroundCubeMaterial",uniforms:fh(jo.backgroundCube.uniforms),vertexShader:jo.backgroundCube.vertexShader,fragmentShader:jo.backgroundCube.fragmentShader,side:Qn,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(E,T,L){this.matrixWorld.copyPosition(L.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(c)),hu.copy(x.backgroundRotation),hu.x*=-1,hu.y*=-1,hu.z*=-1,b.isCubeTexture&&b.isRenderTargetTexture===!1&&(hu.y*=-1,hu.z*=-1),c.material.uniforms.envMap.value=b,c.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,c.material.uniforms.backgroundBlurriness.value=x.backgroundBlurriness,c.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,c.material.uniforms.backgroundRotation.value.setFromMatrix4(F_e.makeRotationFromEuler(hu)),c.material.toneMapped=Ei.getTransfer(b.colorSpace)!==Fi,(p!==b||d!==b.version||m!==i.toneMapping)&&(c.material.needsUpdate=!0,p=b,d=b.version,m=i.toneMapping),c.layers.enableAll(),y.unshift(c,c.geometry,c.material,0,0,null)):b&&b.isTexture&&(u===void 0&&(u=new Zi(new Ag(2,2),new Eo({name:"BackgroundMaterial",uniforms:fh(jo.background.uniforms),vertexShader:jo.background.vertexShader,fragmentShader:jo.background.fragmentShader,side:Xl,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(u)),u.material.uniforms.t2D.value=b,u.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,u.material.toneMapped=Ei.getTransfer(b.colorSpace)!==Fi,b.matrixAutoUpdate===!0&&b.updateMatrix(),u.material.uniforms.uvTransform.value.copy(b.matrix),(p!==b||d!==b.version||m!==i.toneMapping)&&(u.material.needsUpdate=!0,p=b,d=b.version,m=i.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null))}h(g,"render");function _(y,x){y.getRGB(N1,TT(i)),r.buffers.color.setClear(N1.r,N1.g,N1.b,x,o)}return h(_,"setClear"),{getClearColor:function(){return s},setClearColor:function(y,x=1){s.set(y),l=x,_(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(y){l=y,_(s,l)},render:g}}h(dq,"WebGLBackground");function fq(i,e,t,r){let n=i.getParameter(i.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:e.get("OES_vertex_array_object"),o=r.isWebGL2||a!==null,s={},l=y(null),u=l,c=!1;function p(P,U,G,K,O){let V=!1;if(o){let j=_(K,G,U);u!==j&&(u=j,m(u.object)),V=x(P,K,G,O),V&&w(P,K,G,O)}else{let j=U.wireframe===!0;(u.geometry!==K.id||u.program!==G.id||u.wireframe!==j)&&(u.geometry=K.id,u.program=G.id,u.wireframe=j,V=!0)}O!==null&&t.update(O,i.ELEMENT_ARRAY_BUFFER),(V||c)&&(c=!1,D(P,U,G,K),O!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.get(O).buffer))}h(p,"setup");function d(){return r.isWebGL2?i.createVertexArray():a.createVertexArrayOES()}h(d,"createVertexArrayObject");function m(P){return r.isWebGL2?i.bindVertexArray(P):a.bindVertexArrayOES(P)}h(m,"bindVertexArrayObject");function g(P){return r.isWebGL2?i.deleteVertexArray(P):a.deleteVertexArrayOES(P)}h(g,"deleteVertexArrayObject");function _(P,U,G){let K=G.wireframe===!0,O=s[P.id];O===void 0&&(O={},s[P.id]=O);let V=O[U.id];V===void 0&&(V={},O[U.id]=V);let j=V[K];return j===void 0&&(j=y(d()),V[K]=j),j}h(_,"getBindingState");function y(P){let U=[],G=[],K=[];for(let O=0;O<n;O++)U[O]=0,G[O]=0,K[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:U,enabledAttributes:G,attributeDivisors:K,object:P,attributes:{},index:null}}h(y,"createBindingState");function x(P,U,G,K){let O=u.attributes,V=U.attributes,j=0,q=G.getAttributes();for(let ee in q)if(q[ee].location>=0){let ae=O[ee],N=V[ee];if(N===void 0&&(ee==="instanceMatrix"&&P.instanceMatrix&&(N=P.instanceMatrix),ee==="instanceColor"&&P.instanceColor&&(N=P.instanceColor)),ae===void 0||ae.attribute!==N||N&&ae.data!==N.data)return!0;j++}return u.attributesNum!==j||u.index!==K}h(x,"needsUpdate");function w(P,U,G,K){let O={},V=U.attributes,j=0,q=G.getAttributes();for(let ee in q)if(q[ee].location>=0){let ae=V[ee];ae===void 0&&(ee==="instanceMatrix"&&P.instanceMatrix&&(ae=P.instanceMatrix),ee==="instanceColor"&&P.instanceColor&&(ae=P.instanceColor));let N={};N.attribute=ae,ae&&ae.data&&(N.data=ae.data),O[ee]=N,j++}u.attributes=O,u.attributesNum=j,u.index=K}h(w,"saveCache");function b(){let P=u.newAttributes;for(let U=0,G=P.length;U<G;U++)P[U]=0}h(b,"initAttributes");function C(P){E(P,0)}h(C,"enableAttribute");function E(P,U){let G=u.newAttributes,K=u.enabledAttributes,O=u.attributeDivisors;G[P]=1,K[P]===0&&(i.enableVertexAttribArray(P),K[P]=1),O[P]!==U&&((r.isWebGL2?i:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](P,U),O[P]=U)}h(E,"enableAttributeAndDivisor");function T(){let P=u.newAttributes,U=u.enabledAttributes;for(let G=0,K=U.length;G<K;G++)U[G]!==P[G]&&(i.disableVertexAttribArray(G),U[G]=0)}h(T,"disableUnusedAttributes");function L(P,U,G,K,O,V,j){j===!0?i.vertexAttribIPointer(P,U,G,O,V):i.vertexAttribPointer(P,U,G,K,O,V)}h(L,"vertexAttribPointer");function D(P,U,G,K){if(r.isWebGL2===!1&&(P.isInstancedMesh||K.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;b();let O=K.attributes,V=G.getAttributes(),j=U.defaultAttributeValues;for(let q in V){let ee=V[q];if(ee.location>=0){let ae=O[q];if(ae===void 0&&(q==="instanceMatrix"&&P.instanceMatrix&&(ae=P.instanceMatrix),q==="instanceColor"&&P.instanceColor&&(ae=P.instanceColor)),ae!==void 0){let N=ae.normalized,J=ae.itemSize,Y=t.get(ae);if(Y===void 0)continue;let oe=Y.buffer,xe=Y.type,ge=Y.bytesPerElement,Te=r.isWebGL2===!0&&(xe===i.INT||xe===i.UNSIGNED_INT||ae.gpuType===NW);if(ae.isInterleavedBufferAttribute){let me=ae.data,Q=me.stride,Me=ae.offset;if(me.isInstancedInterleavedBuffer){for(let ve=0;ve<ee.locationSize;ve++)E(ee.location+ve,me.meshPerAttribute);P.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let ve=0;ve<ee.locationSize;ve++)C(ee.location+ve);i.bindBuffer(i.ARRAY_BUFFER,oe);for(let ve=0;ve<ee.locationSize;ve++)L(ee.location+ve,J/ee.locationSize,xe,N,Q*ge,(Me+J/ee.locationSize*ve)*ge,Te)}else{if(ae.isInstancedBufferAttribute){for(let me=0;me<ee.locationSize;me++)E(ee.location+me,ae.meshPerAttribute);P.isInstancedMesh!==!0&&K._maxInstanceCount===void 0&&(K._maxInstanceCount=ae.meshPerAttribute*ae.count)}else for(let me=0;me<ee.locationSize;me++)C(ee.location+me);i.bindBuffer(i.ARRAY_BUFFER,oe);for(let me=0;me<ee.locationSize;me++)L(ee.location+me,J/ee.locationSize,xe,N,J*ge,J/ee.locationSize*me*ge,Te)}}else if(j!==void 0){let N=j[q];if(N!==void 0)switch(N.length){case 2:i.vertexAttrib2fv(ee.location,N);break;case 3:i.vertexAttrib3fv(ee.location,N);break;case 4:i.vertexAttrib4fv(ee.location,N);break;default:i.vertexAttrib1fv(ee.location,N)}}}}T()}h(D,"setupVertexAttributes");function B(){$();for(let P in s){let U=s[P];for(let G in U){let K=U[G];for(let O in K)g(K[O].object),delete K[O];delete U[G]}delete s[P]}}h(B,"dispose");function A(P){if(s[P.id]===void 0)return;let U=s[P.id];for(let G in U){let K=U[G];for(let O in K)g(K[O].object),delete K[O];delete U[G]}delete s[P.id]}h(A,"releaseStatesOfGeometry");function k(P){for(let U in s){let G=s[U];if(G[P.id]===void 0)continue;let K=G[P.id];for(let O in K)g(K[O].object),delete K[O];delete G[P.id]}}h(k,"releaseStatesOfProgram");function $(){z(),c=!0,u!==l&&(u=l,m(u.object))}h($,"reset");function z(){l.geometry=null,l.program=null,l.wireframe=!1}return h(z,"resetDefaultState"),{setup:p,reset:$,resetDefaultState:z,dispose:B,releaseStatesOfGeometry:A,releaseStatesOfProgram:k,initAttributes:b,enableAttribute:C,disableUnusedAttributes:T}}h(fq,"WebGLBindingStates");function mq(i,e,t,r){let n=r.isWebGL2,a;function o(c){a=c}h(o,"setMode");function s(c,p){i.drawArrays(a,c,p),t.update(p,a,1)}h(s,"render");function l(c,p,d){if(d===0)return;let m,g;if(n)m=i,g="drawArraysInstanced";else if(m=e.get("ANGLE_instanced_arrays"),g="drawArraysInstancedANGLE",m===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](a,c,p,d),t.update(p,a,d)}h(l,"renderInstances");function u(c,p,d){if(d===0)return;let m=e.get("WEBGL_multi_draw");if(m===null)for(let g=0;g<d;g++)this.render(c[g],p[g]);else{m.multiDrawArraysWEBGL(a,c,0,p,0,d);let g=0;for(let _=0;_<d;_++)g+=p[_];t.update(g,a,1)}}h(u,"renderMultiDraw"),this.setMode=o,this.render=s,this.renderInstances=l,this.renderMultiDraw=u}h(mq,"WebGLBufferRenderer");function gq(i,e,t){let r;function n(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let L=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}h(n,"getMaxAnisotropy");function a(L){if(L==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";L="mediump"}return L==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}h(a,"getMaxPrecision");let o=typeof WebGL2RenderingContext<"u"&&i.constructor.name==="WebGL2RenderingContext",s=t.precision!==void 0?t.precision:"highp",l=a(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);let u=o||e.has("WEBGL_draw_buffers"),c=t.logarithmicDepthBuffer===!0,p=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),d=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),m=i.getParameter(i.MAX_TEXTURE_SIZE),g=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),_=i.getParameter(i.MAX_VERTEX_ATTRIBS),y=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),x=i.getParameter(i.MAX_VARYING_VECTORS),w=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),b=d>0,C=o||e.has("OES_texture_float"),E=b&&C,T=o?i.getParameter(i.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:u,getMaxAnisotropy:n,getMaxPrecision:a,precision:s,logarithmicDepthBuffer:c,maxTextures:p,maxVertexTextures:d,maxTextureSize:m,maxCubemapSize:g,maxAttributes:_,maxVertexUniforms:y,maxVaryings:x,maxFragmentUniforms:w,vertexTextures:b,floatFragmentTextures:C,floatVertexTextures:E,maxSamples:T}}h(gq,"WebGLCapabilities");function yq(i){let e=this,t=null,r=0,n=!1,a=!1,o=new yu,s=new ri,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(p,d){let m=p.length!==0||d||r!==0||n;return n=d,r=p.length,m},this.beginShadows=function(){a=!0,c(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(p,d){t=c(p,d,0)},this.setState=function(p,d,m){let g=p.clippingPlanes,_=p.clipIntersection,y=p.clipShadows,x=i.get(p);if(!n||g===null||g.length===0||a&&!y)a?c(null):u();else{let w=a?0:r,b=w*4,C=x.clippingState||null;l.value=C,C=c(g,d,b,m);for(let E=0;E!==b;++E)C[E]=t[E];x.clippingState=C,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=w}};function u(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}h(u,"resetGlobalState");function c(p,d,m,g){let _=p!==null?p.length:0,y=null;if(_!==0){if(y=l.value,g!==!0||y===null){let x=m+_*4,w=d.matrixWorldInverse;s.getNormalMatrix(w),(y===null||y.length<x)&&(y=new Float32Array(x));for(let b=0,C=m;b!==_;++b,C+=4)o.copy(p[b]).applyMatrix4(w,s),o.normal.toArray(y,C),y[C+3]=o.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,y}h(c,"projectPlanes")}h(yq,"WebGLClipping");function vq(i){let e=new WeakMap;function t(o,s){return s===dS?o.mapping=Qp:s===fS&&(o.mapping=ed),o}h(t,"mapTextureMapping");function r(o){if(o&&o.isTexture){let s=o.mapping;if(s===dS||s===fS)if(e.has(o)){let l=e.get(o).texture;return t(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let u=new K0e(l.height);return u.fromEquirectangularTexture(i,o),e.set(o,u),o.addEventListener("dispose",n),t(u.texture,o.mapping)}else return null}}return o}h(r,"get");function n(o){let s=o.target;s.removeEventListener("dispose",n);let l=e.get(s);l!==void 0&&(e.delete(s),l.dispose())}h(n,"onTextureDispose");function a(){e=new WeakMap}return h(a,"dispose"),{get:r,dispose:a}}h(vq,"WebGLCubeMaps");var xq=class extends PT{constructor(e=-1,t=1,r=1,n=-1,a=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=n,this.near=a,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,n,a,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=n,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,a=r-e,o=r+e,s=n+t,l=n-t;if(this.view!==null&&this.view.enabled){let u=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=u*this.view.offsetX,o=a+u*this.view.width,s-=c*this.view.offsetY,l=s-c*this.view.height}this.projectionMatrix.makeOrthographic(a,o,s,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};h(xq,"OrthographicCamera");var _q=xq,np=4,VI=[.125,.215,.35,.446,.526,.582],Du=20,cb=new _q,jI=new Rt,pb=null,db=0,fb=0,vu=(1+Math.sqrt(5))/2,Qh=1/vu,HI=[new le(1,1,1),new le(-1,1,1),new le(1,1,-1),new le(-1,1,-1),new le(0,vu,Qh),new le(0,vu,-Qh),new le(Qh,0,vu),new le(-Qh,0,vu),new le(vu,Qh,0),new le(-vu,Qh,0)],bq=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,n=100){pb=this._renderer.getRenderTarget(),db=this._renderer.getActiveCubeFace(),fb=this._renderer.getActiveMipmapLevel(),this._setSize(256);let a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,r,n,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=bS(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_S(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(pb,db,fb),e.scissorTest=!1,Af(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Qp||e.mapping===ed?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),pb=this._renderer.getRenderTarget(),db=this._renderer.getActiveCubeFace(),fb=this._renderer.getActiveMipmapLevel();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:$n,minFilter:$n,generateMipmaps:!1,type:Jm,format:Gn,colorSpace:tu,depthBuffer:!1},n=xS(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=xS(e,t,r);let{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=wq(a)),this._blurMaterial=Sq(a,e,t)}return n}_compileMaterial(e){let t=new Zi(this._lodPlanes[0],e);this._renderer.compile(t,cb)}_sceneToCubeUV(e,t,r,n){let a=new jn(90,1,t,r),o=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],l=this._renderer,u=l.autoClear,c=l.toneMapping;l.getClearColor(jI),l.toneMapping=$l,l.autoClear=!1;let p=new wd({name:"PMREM.Background",side:Qn,depthWrite:!1,depthTest:!1}),d=new Zi(new C_,p),m=!1,g=e.background;g?g.isColor&&(p.color.copy(g),e.background=null,m=!0):(p.color.copy(jI),m=!0);for(let _=0;_<6;_++){let y=_%3;y===0?(a.up.set(0,o[_],0),a.lookAt(s[_],0,0)):y===1?(a.up.set(0,0,o[_]),a.lookAt(0,s[_],0)):(a.up.set(0,o[_],0),a.lookAt(0,0,s[_]));let x=this._cubeSize;Af(n,y*x,_>2?x:0,x,x),l.setRenderTarget(n),m&&l.render(d,a),l.render(e,a)}d.geometry.dispose(),d.material.dispose(),l.toneMapping=c,l.autoClear=u,e.background=g}_textureToCubeUV(e,t){let r=this._renderer,n=e.mapping===Qp||e.mapping===ed;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=bS()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_S());let a=n?this._cubemapMaterial:this._equirectMaterial,o=new Zi(this._lodPlanes[0],a),s=a.uniforms;s.envMap.value=e;let l=this._cubeSize;Af(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(o,cb)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){let a=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),o=HI[(n-1)%HI.length];this._blur(e,n-1,n,a,o)}t.autoClear=r}_blur(e,t,r,n,a){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,n,"latitudinal",a),this._halfBlur(o,e,r,r,n,"longitudinal",a)}_halfBlur(e,t,r,n,a,o,s){let l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,p=new Zi(this._lodPlanes[n],u),d=u.uniforms,m=this._sizeLods[r]-1,g=isFinite(a)?Math.PI/(2*m):2*Math.PI/(2*Du-1),_=a/g,y=isFinite(a)?1+Math.floor(c*_):Du;y>Du&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${Du}`);let x=[],w=0;for(let L=0;L<Du;++L){let D=L/_,B=Math.exp(-D*D/2);x.push(B),L===0?w+=B:L<y&&(w+=2*B)}for(let L=0;L<x.length;L++)x[L]=x[L]/w;d.envMap.value=e.texture,d.samples.value=y,d.weights.value=x,d.latitudinal.value=o==="latitudinal",s&&(d.poleAxis.value=s);let{_lodMax:b}=this;d.dTheta.value=g,d.mipInt.value=b-r;let C=this._sizeLods[n],E=3*C*(n>b-np?n-b+np:0),T=4*(this._cubeSize-C);Af(t,E,T,3*C,2*C),l.setRenderTarget(t),l.render(p,cb)}};h(bq,"PMREMGenerator");var GI=bq;function wq(i){let e=[],t=[],r=[],n=i,a=i-np+1+VI.length;for(let o=0;o<a;o++){let s=Math.pow(2,n);t.push(s);let l=1/s;o>i-np?l=VI[o-i+np-1]:o===0&&(l=0),r.push(l);let u=1/(s-2),c=-u,p=1+u,d=[c,c,p,c,p,p,c,c,p,p,c,p],m=6,g=6,_=3,y=2,x=1,w=new Float32Array(_*g*m),b=new Float32Array(y*g*m),C=new Float32Array(x*g*m);for(let T=0;T<m;T++){let L=T%3*2/3-1,D=T>2?0:-1,B=[L,D,0,L+2/3,D,0,L+2/3,D+1,0,L,D,0,L+2/3,D+1,0,L,D+1,0];w.set(B,_*g*T),b.set(d,y*g*T);let A=[T,T,T,T,T,T];C.set(A,x*g*T)}let E=new Sa;E.setAttribute("position",new Ur(w,_)),E.setAttribute("uv",new Ur(b,y)),E.setAttribute("faceIndex",new Ur(C,x)),e.push(E),n>np&&n--}return{lodPlanes:e,sizeLods:t,sigmas:r}}h(wq,"_createPlanes");function xS(i,e,t){let r=new dh(i,e,t);return r.texture.mapping=w_,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}h(xS,"_createRenderTarget");function Af(i,e,t,r,n){i.viewport.set(e,t,r,n),i.scissor.set(e,t,r,n)}h(Af,"_setViewport");function Sq(i,e,t){let r=new Float32Array(Du),n=new le(0,1,0);return new Eo({name:"SphericalGaussianBlur",defines:{n:Du,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:E_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Nl,depthTest:!1,depthWrite:!1})}h(Sq,"_getBlurShader");function _S(){return new Eo({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:E_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Nl,depthTest:!1,depthWrite:!1})}h(_S,"_getEquirectMaterial");function bS(){return new Eo({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:E_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Nl,depthTest:!1,depthWrite:!1})}h(bS,"_getCubemapMaterial");function E_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}h(E_,"_getCommonVertexShader");function Mq(i){let e=new WeakMap,t=null;function r(s){if(s&&s.isTexture){let l=s.mapping,u=l===dS||l===fS,c=l===Qp||l===ed;if(u||c)if(s.isRenderTargetTexture&&s.needsPMREMUpdate===!0){s.needsPMREMUpdate=!1;let p=e.get(s);return t===null&&(t=new GI(i)),p=u?t.fromEquirectangular(s,p):t.fromCubemap(s,p),e.set(s,p),p.texture}else{if(e.has(s))return e.get(s).texture;{let p=s.image;if(u&&p&&p.height>0||c&&p&&n(p)){t===null&&(t=new GI(i));let d=u?t.fromEquirectangular(s):t.fromCubemap(s);return e.set(s,d),s.addEventListener("dispose",a),d.texture}else return null}}}return s}h(r,"get");function n(s){let l=0,u=6;for(let c=0;c<u;c++)s[c]!==void 0&&l++;return l===u}h(n,"isCubeTextureComplete");function a(s){let l=s.target;l.removeEventListener("dispose",a);let u=e.get(l);u!==void 0&&(e.delete(l),u.dispose())}h(a,"onTextureDispose");function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return h(o,"dispose"),{get:r,dispose:o}}h(Mq,"WebGLCubeUVMaps");function Cq(i){let e={};function t(r){if(e[r]!==void 0)return e[r];let n;switch(r){case"WEBGL_depth_texture":n=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=i.getExtension(r)}return e[r]=n,n}return h(t,"getExtension"),{has:function(r){return t(r)!==null},init:function(r){r.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(r){let n=t(r);return n===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),n}}}h(Cq,"WebGLExtensions");function Eq(i,e,t,r){let n={},a=new WeakMap;function o(p){let d=p.target;d.index!==null&&e.remove(d.index);for(let g in d.attributes)e.remove(d.attributes[g]);for(let g in d.morphAttributes){let _=d.morphAttributes[g];for(let y=0,x=_.length;y<x;y++)e.remove(_[y])}d.removeEventListener("dispose",o),delete n[d.id];let m=a.get(d);m&&(e.remove(m),a.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}h(o,"onGeometryDispose");function s(p,d){return n[d.id]===!0||(d.addEventListener("dispose",o),n[d.id]=!0,t.memory.geometries++),d}h(s,"get");function l(p){let d=p.attributes;for(let g in d)e.update(d[g],i.ARRAY_BUFFER);let m=p.morphAttributes;for(let g in m){let _=m[g];for(let y=0,x=_.length;y<x;y++)e.update(_[y],i.ARRAY_BUFFER)}}h(l,"update");function u(p){let d=[],m=p.index,g=p.attributes.position,_=0;if(m!==null){let w=m.array;_=m.version;for(let b=0,C=w.length;b<C;b+=3){let E=w[b+0],T=w[b+1],L=w[b+2];d.push(E,T,T,L,L,E)}}else if(g!==void 0){let w=g.array;_=g.version;for(let b=0,C=w.length/3-1;b<C;b+=3){let E=b+0,T=b+1,L=b+2;d.push(E,T,T,L,L,E)}}else return;let y=new(MT(d)?WX:HX)(d,1);y.version=_;let x=a.get(p);x&&e.remove(x),a.set(p,y)}h(u,"updateWireframeAttribute");function c(p){let d=a.get(p);if(d){let m=p.index;m!==null&&d.version<m.version&&u(p)}else u(p);return a.get(p)}return h(c,"getWireframeAttribute"),{get:s,update:l,getWireframeAttribute:c}}h(Eq,"WebGLGeometries");function Tq(i,e,t,r){let n=r.isWebGL2,a;function o(m){a=m}h(o,"setMode");let s,l;function u(m){s=m.type,l=m.bytesPerElement}h(u,"setIndex");function c(m,g){i.drawElements(a,g,s,m*l),t.update(g,a,1)}h(c,"render");function p(m,g,_){if(_===0)return;let y,x;if(n)y=i,x="drawElementsInstanced";else if(y=e.get("ANGLE_instanced_arrays"),x="drawElementsInstancedANGLE",y===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[x](a,g,s,m*l,_),t.update(g,a,_)}h(p,"renderInstances");function d(m,g,_){if(_===0)return;let y=e.get("WEBGL_multi_draw");if(y===null)for(let x=0;x<_;x++)this.render(m[x]/l,g[x]);else{y.multiDrawElementsWEBGL(a,g,0,s,m,0,_);let x=0;for(let w=0;w<_;w++)x+=g[w];t.update(x,a,1)}}h(d,"renderMultiDraw"),this.setMode=o,this.setIndex=u,this.render=c,this.renderInstances=p,this.renderMultiDraw=d}h(Tq,"WebGLIndexedBufferRenderer");function Pq(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(a,o,s){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=s*(a/3);break;case i.LINES:t.lines+=s*(a/2);break;case i.LINE_STRIP:t.lines+=s*(a-1);break;case i.LINE_LOOP:t.lines+=s*a;break;case i.POINTS:t.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}h(r,"update");function n(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return h(n,"reset"),{memory:e,render:t,programs:null,autoReset:!0,reset:n,update:r}}h(Pq,"WebGLInfo");function Aq(i,e){return i[0]-e[0]}h(Aq,"numericalSort");function Iq(i,e){return Math.abs(e[1])-Math.abs(i[1])}h(Iq,"absNumericalSort");function Lq(i,e,t){let r={},n=new Float32Array(8),a=new WeakMap,o=new Ai,s=[];for(let u=0;u<8;u++)s[u]=[u,0];function l(u,c,p){let d=u.morphTargetInfluences;if(e.isWebGL2===!0){let m=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,g=m!==void 0?m.length:0,_=a.get(c);if(_===void 0||_.count!==g){let y=function(){k.dispose(),a.delete(c),c.removeEventListener("dispose",y)};h(y,"disposeTexture"),_!==void 0&&_.texture.dispose();let x=c.morphAttributes.position!==void 0,w=c.morphAttributes.normal!==void 0,b=c.morphAttributes.color!==void 0,C=c.morphAttributes.position||[],E=c.morphAttributes.normal||[],T=c.morphAttributes.color||[],L=0;x===!0&&(L=1),w===!0&&(L=2),b===!0&&(L=3);let D=c.attributes.position.count*L,B=1;D>e.maxTextureSize&&(B=Math.ceil(D/e.maxTextureSize),D=e.maxTextureSize);let A=new Float32Array(D*B*4*g),k=new MX(A,D,B,g);k.type=ca,k.needsUpdate=!0;let $=L*4;for(let z=0;z<g;z++){let P=C[z],U=E[z],G=T[z],K=D*B*4*z;for(let O=0;O<P.count;O++){let V=O*$;x===!0&&(o.fromBufferAttribute(P,O),A[K+V+0]=o.x,A[K+V+1]=o.y,A[K+V+2]=o.z,A[K+V+3]=0),w===!0&&(o.fromBufferAttribute(U,O),A[K+V+4]=o.x,A[K+V+5]=o.y,A[K+V+6]=o.z,A[K+V+7]=0),b===!0&&(o.fromBufferAttribute(G,O),A[K+V+8]=o.x,A[K+V+9]=o.y,A[K+V+10]=o.z,A[K+V+11]=G.itemSize===4?o.w:1)}}_={count:g,texture:k,size:new Ne(D,B)},a.set(c,_),c.addEventListener("dispose",y)}if(u.isInstancedMesh===!0&&u.morphTexture!==null)p.getUniforms().setValue(i,"morphTexture",u.morphTexture,t);else{let y=0;for(let w=0;w<d.length;w++)y+=d[w];let x=c.morphTargetsRelative?1:1-y;p.getUniforms().setValue(i,"morphTargetBaseInfluence",x),p.getUniforms().setValue(i,"morphTargetInfluences",d)}p.getUniforms().setValue(i,"morphTargetsTexture",_.texture,t),p.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}else{let m=d===void 0?0:d.length,g=r[c.id];if(g===void 0||g.length!==m){g=[];for(let b=0;b<m;b++)g[b]=[b,0];r[c.id]=g}for(let b=0;b<m;b++){let C=g[b];C[0]=b,C[1]=d[b]}g.sort(Iq);for(let b=0;b<8;b++)b<m&&g[b][1]?(s[b][0]=g[b][0],s[b][1]=g[b][1]):(s[b][0]=Number.MAX_SAFE_INTEGER,s[b][1]=0);s.sort(Aq);let _=c.morphAttributes.position,y=c.morphAttributes.normal,x=0;for(let b=0;b<8;b++){let C=s[b],E=C[0],T=C[1];E!==Number.MAX_SAFE_INTEGER&&T?(_&&c.getAttribute("morphTarget"+b)!==_[E]&&c.setAttribute("morphTarget"+b,_[E]),y&&c.getAttribute("morphNormal"+b)!==y[E]&&c.setAttribute("morphNormal"+b,y[E]),n[b]=T,x+=T):(_&&c.hasAttribute("morphTarget"+b)===!0&&c.deleteAttribute("morphTarget"+b),y&&c.hasAttribute("morphNormal"+b)===!0&&c.deleteAttribute("morphNormal"+b),n[b]=0)}let w=c.morphTargetsRelative?1:1-x;p.getUniforms().setValue(i,"morphTargetBaseInfluence",w),p.getUniforms().setValue(i,"morphTargetInfluences",n)}}return h(l,"update"),{update:l}}h(Lq,"WebGLMorphtargets");function Dq(i,e,t,r){let n=new WeakMap;function a(l){let u=r.render.frame,c=l.geometry,p=e.get(l,c);if(n.get(p)!==u&&(e.update(p),n.set(p,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),n.get(l)!==u&&(t.update(l.instanceMatrix,i.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,i.ARRAY_BUFFER),n.set(l,u))),l.isSkinnedMesh){let d=l.skeleton;n.get(d)!==u&&(d.update(),n.set(d,u))}return p}h(a,"update");function o(){n=new WeakMap}h(o,"dispose");function s(l){let u=l.target;u.removeEventListener("dispose",s),t.remove(u.instanceMatrix),u.instanceColor!==null&&t.remove(u.instanceColor)}return h(s,"onInstancedMeshDispose"),{update:a,dispose:o}}h(Dq,"WebGLObjects");var kq=class extends Ln{constructor(e,t,r,n,a,o,s,l,u,c){if(c=c!==void 0?c:Yu,c!==Yu&&c!==td)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&c===Yu&&(r=Tl),r===void 0&&c===td&&(r=Zu),super(null,n,a,o,s,l,c,r,u),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=s!==void 0?s:Kr,this.minFilter=l!==void 0?l:Kr,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}};h(kq,"DepthTexture");var Rq=kq,Fq=new Ln,Oq=new Rq(1,1);Oq.compareFunction=XW;var Bq=new MX,zq=new B0e,Nq=new oq,WI=[],XI=[],qI=new Float32Array(16),ZI=new Float32Array(9),YI=new Float32Array(4);function Ph(i,e,t){let r=i[0];if(r<=0||r>0)return i;let n=e*t,a=WI[n];if(a===void 0&&(a=new Float32Array(n),WI[n]=a),e!==0){r.toArray(a,0);for(let o=1,s=0;o!==e;++o)s+=t,i[o].toArray(a,s)}return a}h(Ph,"flatten");function kr(i,e){if(i.length!==e.length)return!1;for(let t=0,r=i.length;t<r;t++)if(i[t]!==e[t])return!1;return!0}h(kr,"arraysEqual");function Rr(i,e){for(let t=0,r=e.length;t<r;t++)i[t]=e[t]}h(Rr,"copyArray");function Ig(i,e){let t=XI[e];t===void 0&&(t=new Int32Array(e),XI[e]=t);for(let r=0;r!==e;++r)t[r]=i.allocateTextureUnit();return t}h(Ig,"allocTexUnits");function $q(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}h($q,"setValueV1f");function Uq(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(kr(t,e))return;i.uniform2fv(this.addr,e),Rr(t,e)}}h(Uq,"setValueV2f");function Vq(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(kr(t,e))return;i.uniform3fv(this.addr,e),Rr(t,e)}}h(Vq,"setValueV3f");function jq(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(kr(t,e))return;i.uniform4fv(this.addr,e),Rr(t,e)}}h(jq,"setValueV4f");function Hq(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(kr(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Rr(t,e)}else{if(kr(t,r))return;YI.set(r),i.uniformMatrix2fv(this.addr,!1,YI),Rr(t,r)}}h(Hq,"setValueM2");function Gq(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(kr(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Rr(t,e)}else{if(kr(t,r))return;ZI.set(r),i.uniformMatrix3fv(this.addr,!1,ZI),Rr(t,r)}}h(Gq,"setValueM3");function Wq(i,e){let t=this.cache,r=e.elements;if(r===void 0){if(kr(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Rr(t,e)}else{if(kr(t,r))return;qI.set(r),i.uniformMatrix4fv(this.addr,!1,qI),Rr(t,r)}}h(Wq,"setValueM4");function Xq(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}h(Xq,"setValueV1i");function qq(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(kr(t,e))return;i.uniform2iv(this.addr,e),Rr(t,e)}}h(qq,"setValueV2i");function Zq(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(kr(t,e))return;i.uniform3iv(this.addr,e),Rr(t,e)}}h(Zq,"setValueV3i");function Yq(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(kr(t,e))return;i.uniform4iv(this.addr,e),Rr(t,e)}}h(Yq,"setValueV4i");function Jq(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}h(Jq,"setValueV1ui");function Kq(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(kr(t,e))return;i.uniform2uiv(this.addr,e),Rr(t,e)}}h(Kq,"setValueV2ui");function Qq(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(kr(t,e))return;i.uniform3uiv(this.addr,e),Rr(t,e)}}h(Qq,"setValueV3ui");function eZ(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(kr(t,e))return;i.uniform4uiv(this.addr,e),Rr(t,e)}}h(eZ,"setValueV4ui");function tZ(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n);let a=this.type===i.SAMPLER_2D_SHADOW?Oq:Fq;t.setTexture2D(e||a,n)}h(tZ,"setValueT1");function iZ(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture3D(e||zq,n)}h(iZ,"setValueT3D1");function rZ(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTextureCube(e||Nq,n)}h(rZ,"setValueT6");function nZ(i,e,t){let r=this.cache,n=t.allocateTextureUnit();r[0]!==n&&(i.uniform1i(this.addr,n),r[0]=n),t.setTexture2DArray(e||Bq,n)}h(nZ,"setValueT2DArray1");function aZ(i){switch(i){case 5126:return $q;case 35664:return Uq;case 35665:return Vq;case 35666:return jq;case 35674:return Hq;case 35675:return Gq;case 35676:return Wq;case 5124:case 35670:return Xq;case 35667:case 35671:return qq;case 35668:case 35672:return Zq;case 35669:case 35673:return Yq;case 5125:return Jq;case 36294:return Kq;case 36295:return Qq;case 36296:return eZ;case 35678:case 36198:case 36298:case 36306:case 35682:return tZ;case 35679:case 36299:case 36307:return iZ;case 35680:case 36300:case 36308:case 36293:return rZ;case 36289:case 36303:case 36311:case 36292:return nZ}}h(aZ,"getSingularSetter");function oZ(i,e){i.uniform1fv(this.addr,e)}h(oZ,"setValueV1fArray");function sZ(i,e){let t=Ph(e,this.size,2);i.uniform2fv(this.addr,t)}h(sZ,"setValueV2fArray");function lZ(i,e){let t=Ph(e,this.size,3);i.uniform3fv(this.addr,t)}h(lZ,"setValueV3fArray");function uZ(i,e){let t=Ph(e,this.size,4);i.uniform4fv(this.addr,t)}h(uZ,"setValueV4fArray");function hZ(i,e){let t=Ph(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}h(hZ,"setValueM2Array");function cZ(i,e){let t=Ph(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}h(cZ,"setValueM3Array");function pZ(i,e){let t=Ph(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}h(pZ,"setValueM4Array");function dZ(i,e){i.uniform1iv(this.addr,e)}h(dZ,"setValueV1iArray");function fZ(i,e){i.uniform2iv(this.addr,e)}h(fZ,"setValueV2iArray");function mZ(i,e){i.uniform3iv(this.addr,e)}h(mZ,"setValueV3iArray");function gZ(i,e){i.uniform4iv(this.addr,e)}h(gZ,"setValueV4iArray");function yZ(i,e){i.uniform1uiv(this.addr,e)}h(yZ,"setValueV1uiArray");function vZ(i,e){i.uniform2uiv(this.addr,e)}h(vZ,"setValueV2uiArray");function xZ(i,e){i.uniform3uiv(this.addr,e)}h(xZ,"setValueV3uiArray");function _Z(i,e){i.uniform4uiv(this.addr,e)}h(_Z,"setValueV4uiArray");function bZ(i,e,t){let r=this.cache,n=e.length,a=Ig(t,n);kr(r,a)||(i.uniform1iv(this.addr,a),Rr(r,a));for(let o=0;o!==n;++o)t.setTexture2D(e[o]||Fq,a[o])}h(bZ,"setValueT1Array");function wZ(i,e,t){let r=this.cache,n=e.length,a=Ig(t,n);kr(r,a)||(i.uniform1iv(this.addr,a),Rr(r,a));for(let o=0;o!==n;++o)t.setTexture3D(e[o]||zq,a[o])}h(wZ,"setValueT3DArray");function SZ(i,e,t){let r=this.cache,n=e.length,a=Ig(t,n);kr(r,a)||(i.uniform1iv(this.addr,a),Rr(r,a));for(let o=0;o!==n;++o)t.setTextureCube(e[o]||Nq,a[o])}h(SZ,"setValueT6Array");function MZ(i,e,t){let r=this.cache,n=e.length,a=Ig(t,n);kr(r,a)||(i.uniform1iv(this.addr,a),Rr(r,a));for(let o=0;o!==n;++o)t.setTexture2DArray(e[o]||Bq,a[o])}h(MZ,"setValueT2DArrayArray");function CZ(i){switch(i){case 5126:return oZ;case 35664:return sZ;case 35665:return lZ;case 35666:return uZ;case 35674:return hZ;case 35675:return cZ;case 35676:return pZ;case 5124:case 35670:return dZ;case 35667:case 35671:return fZ;case 35668:case 35672:return mZ;case 35669:case 35673:return gZ;case 5125:return yZ;case 36294:return vZ;case 36295:return xZ;case 36296:return _Z;case 35678:case 36198:case 36298:case 36306:case 35682:return bZ;case 35679:case 36299:case 36307:return wZ;case 35680:case 36300:case 36308:case 36293:return SZ;case 36289:case 36303:case 36311:case 36292:return MZ}}h(CZ,"getPureArraySetter");var EZ=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=aZ(t.type)}};h(EZ,"SingleUniform");var O_e=EZ,TZ=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=CZ(t.type)}};h(TZ,"PureArrayUniform");var B_e=TZ,PZ=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let n=this.seq;for(let a=0,o=n.length;a!==o;++a){let s=n[a];s.setValue(e,t[s.id],r)}}};h(PZ,"StructuredUniform");var z_e=PZ,mb=/(\w+)(\])?(\[|\.)?/g;function wS(i,e){i.seq.push(e),i.map[e.id]=e}h(wS,"addUniform");function AZ(i,e,t){let r=i.name,n=r.length;for(mb.lastIndex=0;;){let a=mb.exec(r),o=mb.lastIndex,s=a[1],l=a[2]==="]",u=a[3];if(l&&(s=s|0),u===void 0||u==="["&&o+2===n){wS(t,u===void 0?new O_e(s,i,e):new B_e(s,i,e));break}else{let c=t.map[s];c===void 0&&(c=new z_e(s),wS(t,c)),t=c}}}h(AZ,"parseUniform");var IZ=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let n=0;n<r;++n){let a=e.getActiveUniform(t,n),o=e.getUniformLocation(t,a.name);AZ(a,o,this)}}setValue(e,t,r,n){let a=this.map[t];a!==void 0&&a.setValue(e,r,n)}setOptional(e,t,r){let n=t[r];n!==void 0&&this.setValue(e,r,n)}static upload(e,t,r,n){for(let a=0,o=t.length;a!==o;++a){let s=t[a],l=r[s.id];l.needsUpdate!==!1&&s.setValue(e,l.value,n)}}static seqWithValue(e,t){let r=[];for(let n=0,a=e.length;n!==a;++n){let o=e[n];o.id in t&&r.push(o)}return r}};h(IZ,"WebGLUniforms");var Jy=IZ;function SS(i,e,t){let r=i.createShader(e);return i.shaderSource(r,t),i.compileShader(r),r}h(SS,"WebGLShader");var N_e=37297,$_e=0;function LZ(i,e){let t=i.split(`
`),r=[],n=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let o=n;o<a;o++){let s=o+1;r.push(`${s===e?">":" "} ${s}: ${t[o]}`)}return r.join(`
`)}h(LZ,"handleSource");function DZ(i){let e=Ei.getPrimaries(Ei.workingColorSpace),t=Ei.getPrimaries(i),r;switch(e===t?r="":e===Yv&&t===Zv?r="LinearDisplayP3ToLinearSRGB":e===Zv&&t===Yv&&(r="LinearSRGBToLinearDisplayP3"),i){case tu:case S_:return[r,"LinearTransferOETF"];case Un:case ST:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",i),[r,"LinearTransferOETF"]}}h(DZ,"getEncodingComponents");function MS(i,e,t){let r=i.getShaderParameter(e,i.COMPILE_STATUS),n=i.getShaderInfoLog(e).trim();if(r&&n==="")return"";let a=/ERROR: 0:(\d+)/.exec(n);if(a){let o=parseInt(a[1]);return t.toUpperCase()+`

`+n+`

`+LZ(i.getShaderSource(e),o)}else return n}h(MS,"getShaderErrors");function kZ(i,e){let t=DZ(e);return`vec4 ${i}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}h(kZ,"getTexelEncodingFunction");function RZ(i,e){let t;switch(e){case a0e:t="Linear";break;case o0e:t="Reinhard";break;case s0e:t="OptimizedCineon";break;case l0e:t="ACESFilmic";break;case h0e:t="AgX";break;case c0e:t="Neutral";break;case u0e:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}h(RZ,"getToneMappingFunction");function FZ(i){return[i.extensionDerivatives||i.envMapCubeUVHeight||i.bumpMap||i.normalMapTangentSpace||i.clearcoatNormalMap||i.flatShading||i.alphaToCoverage||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap||i.transmission)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter($u).join(`
`)}h(FZ,"generateExtensions");function OZ(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter($u).join(`
`)}h(OZ,"generateVertexExtensions");function BZ(i){let e=[];for(let t in i){let r=i[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}h(BZ,"generateDefines");function zZ(i,e){let t={},r=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let n=0;n<r;n++){let a=i.getActiveAttrib(e,n),o=a.name,s=1;a.type===i.FLOAT_MAT2&&(s=2),a.type===i.FLOAT_MAT3&&(s=3),a.type===i.FLOAT_MAT4&&(s=4),t[o]={type:a.type,location:i.getAttribLocation(e,o),locationSize:s}}return t}h(zZ,"fetchAttributeLocations");function $u(i){return i!==""}h($u,"filterEmptyLine");function CS(i,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}h(CS,"replaceLightNums");function ES(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}h(ES,"replaceClippingPlaneNums");var U_e=/^[ \t]*#include +<([\w\d./]+)>/gm;function Qv(i){return i.replace(U_e,NZ)}h(Qv,"resolveIncludes");var V_e=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function NZ(i,e){let t=Qt[e];if(t===void 0){let r=V_e.get(e);if(r!==void 0)t=Qt[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return Qv(t)}h(NZ,"includeReplacer");var j_e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function TS(i){return i.replace(j_e,$Z)}h(TS,"unrollLoops");function $Z(i,e,t,r){let n="";for(let a=parseInt(e);a<parseInt(t);a++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return n}h($Z,"loopReplacer");function PS(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	`;return i.isWebGL2&&(e+=`precision ${i.precision} sampler3D;
		precision ${i.precision} sampler2DArray;
		precision ${i.precision} sampler2DShadow;
		precision ${i.precision} samplerCubeShadow;
		precision ${i.precision} sampler2DArrayShadow;
		precision ${i.precision} isampler2D;
		precision ${i.precision} isampler3D;
		precision ${i.precision} isamplerCube;
		precision ${i.precision} isampler2DArray;
		precision ${i.precision} usampler2D;
		precision ${i.precision} usampler3D;
		precision ${i.precision} usamplerCube;
		precision ${i.precision} usampler2DArray;
		`),i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}h(PS,"generatePrecision");function UZ(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===BW?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===kye?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===ms&&(e="SHADOWMAP_TYPE_VSM"),e}h(UZ,"generateShadowMapTypeDefine");function VZ(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case Qp:case ed:e="ENVMAP_TYPE_CUBE";break;case w_:e="ENVMAP_TYPE_CUBE_UV";break}return e}h(VZ,"generateEnvMapTypeDefine");function jZ(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case ed:e="ENVMAP_MODE_REFRACTION";break}return e}h(jZ,"generateEnvMapModeDefine");function HZ(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case _T:e="ENVMAP_BLENDING_MULTIPLY";break;case r0e:e="ENVMAP_BLENDING_MIX";break;case n0e:e="ENVMAP_BLENDING_ADD";break}return e}h(HZ,"generateEnvMapBlendingDefine");function GZ(i){let e=i.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}h(GZ,"generateCubeUVSize");function WZ(i,e,t,r){let n=i.getContext(),a=t.defines,o=t.vertexShader,s=t.fragmentShader,l=UZ(t),u=VZ(t),c=jZ(t),p=HZ(t),d=GZ(t),m=t.isWebGL2?"":FZ(t),g=OZ(t),_=BZ(a),y=n.createProgram(),x,w,b=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(x=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter($u).join(`
`),x.length>0&&(x+=`
`),w=[m,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter($u).join(`
`),w.length>0&&(w+=`
`)):(x=[PS(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter($u).join(`
`),w=[m,PS(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.envMap?"#define "+c:"",t.envMap?"#define "+p:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==$l?"#define TONE_MAPPING":"",t.toneMapping!==$l?Qt.tonemapping_pars_fragment:"",t.toneMapping!==$l?RZ("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Qt.colorspace_pars_fragment,kZ("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter($u).join(`
`)),o=Qv(o),o=CS(o,t),o=ES(o,t),s=Qv(s),s=CS(s,t),s=ES(s,t),o=TS(o),s=TS(s),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,x=[g,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+x,w=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===wI?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===wI?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);let C=b+x+o,E=b+w+s,T=SS(n,n.VERTEX_SHADER,C),L=SS(n,n.FRAGMENT_SHADER,E);n.attachShader(y,T),n.attachShader(y,L),t.index0AttributeName!==void 0?n.bindAttribLocation(y,0,t.index0AttributeName):t.morphTargets===!0&&n.bindAttribLocation(y,0,"position"),n.linkProgram(y);function D($){if(i.debug.checkShaderErrors){let z=n.getProgramInfoLog(y).trim(),P=n.getShaderInfoLog(T).trim(),U=n.getShaderInfoLog(L).trim(),G=!0,K=!0;if(n.getProgramParameter(y,n.LINK_STATUS)===!1)if(G=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(n,y,T,L);else{let O=MS(n,T,"vertex"),V=MS(n,L,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(y,n.VALIDATE_STATUS)+`

Material Name: `+$.name+`
Material Type: `+$.type+`

Program Info Log: `+z+`
`+O+`
`+V)}else z!==""?console.warn("THREE.WebGLProgram: Program Info Log:",z):(P===""||U==="")&&(K=!1);K&&($.diagnostics={runnable:G,programLog:z,vertexShader:{log:P,prefix:x},fragmentShader:{log:U,prefix:w}})}n.deleteShader(T),n.deleteShader(L),B=new Jy(n,y),A=zZ(n,y)}h(D,"onFirstUse");let B;this.getUniforms=function(){return B===void 0&&D(this),B};let A;this.getAttributes=function(){return A===void 0&&D(this),A};let k=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return k===!1&&(k=n.getProgramParameter(y,N_e)),k},this.destroy=function(){r.releaseStatesOfProgram(this),n.deleteProgram(y),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=$_e++,this.cacheKey=e,this.usedTimes=1,this.program=y,this.vertexShader=T,this.fragmentShader=L,this}h(WZ,"WebGLProgram");var H_e=0,XZ=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,n=this._getShaderStage(t),a=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(n)===!1&&(o.add(n),n.usedTimes++),o.has(a)===!1&&(o.add(a),a.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){let t=this.shaderCache,r=t.get(e);return r===void 0&&(r=new W_e(e),t.set(e,r)),r}};h(XZ,"WebGLShaderCache");var G_e=XZ,qZ=class{constructor(e){this.id=H_e++,this.code=e,this.usedTimes=0}};h(qZ,"WebGLShaderStage");var W_e=qZ;function ZZ(i,e,t,r,n,a,o){let s=new ET,l=new G_e,u=new Set,c=[],p=n.isWebGL2,d=n.logarithmicDepthBuffer,m=n.vertexTextures,g=n.precision,_={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function y(A){return u.add(A),A===0?"uv":`uv${A}`}h(y,"getChannel");function x(A,k,$,z,P){let U=z.fog,G=P.geometry,K=A.isMeshStandardMaterial?z.environment:null,O=(A.isMeshStandardMaterial?t:e).get(A.envMap||K),V=O&&O.mapping===w_?O.image.height:null,j=_[A.type];A.precision!==null&&(g=n.getMaxPrecision(A.precision),g!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",g,"instead."));let q=G.morphAttributes.position||G.morphAttributes.normal||G.morphAttributes.color,ee=q!==void 0?q.length:0,ae=0;G.morphAttributes.position!==void 0&&(ae=1),G.morphAttributes.normal!==void 0&&(ae=2),G.morphAttributes.color!==void 0&&(ae=3);let N,J,Y,oe;if(j){let Ut=jo[j];N=Ut.vertexShader,J=Ut.fragmentShader}else N=A.vertexShader,J=A.fragmentShader,l.update(A),Y=l.getVertexShaderID(A),oe=l.getFragmentShaderID(A);let xe=i.getRenderTarget(),ge=P.isInstancedMesh===!0,Te=P.isBatchedMesh===!0,me=!!A.map,Q=!!A.matcap,Me=!!O,ve=!!A.aoMap,Ie=!!A.lightMap,ke=!!A.bumpMap,we=!!A.normalMap,Oe=!!A.displacementMap,Je=!!A.emissiveMap,xt=!!A.metalnessMap,ne=!!A.roughnessMap,W=A.anisotropy>0,_e=A.clearcoat>0,Fe=A.iridescence>0,Ue=A.sheen>0,Be=A.transmission>0,bt=W&&!!A.anisotropyMap,lt=_e&&!!A.clearcoatMap,Ge=_e&&!!A.clearcoatNormalMap,We=_e&&!!A.clearcoatRoughnessMap,St=Fe&&!!A.iridescenceMap,Ze=Fe&&!!A.iridescenceThicknessMap,ni=Ue&&!!A.sheenColorMap,Dt=Ue&&!!A.sheenRoughnessMap,ue=!!A.specularMap,he=!!A.specularColorMap,qe=!!A.specularIntensityMap,ft=Be&&!!A.transmissionMap,ct=Be&&!!A.thicknessMap,dt=!!A.gradientMap,ce=!!A.alphaMap,it=A.alphaTest>0,be=!!A.alphaHash,Xe=!!A.extensions,rt=$l;A.toneMapped&&(xe===null||xe.isXRRenderTarget===!0)&&(rt=i.toneMapping);let Wt={isWebGL2:p,shaderID:j,shaderType:A.type,shaderName:A.name,vertexShader:N,fragmentShader:J,defines:A.defines,customVertexShaderID:Y,customFragmentShaderID:oe,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:g,batching:Te,instancing:ge,instancingColor:ge&&P.instanceColor!==null,instancingMorph:ge&&P.morphTexture!==null,supportsVertexTextures:m,outputColorSpace:xe===null?i.outputColorSpace:xe.isXRRenderTarget===!0?xe.texture.colorSpace:tu,alphaToCoverage:!!A.alphaToCoverage,map:me,matcap:Q,envMap:Me,envMapMode:Me&&O.mapping,envMapCubeUVHeight:V,aoMap:ve,lightMap:Ie,bumpMap:ke,normalMap:we,displacementMap:m&&Oe,emissiveMap:Je,normalMapObjectSpace:we&&A.normalMapType===C0e,normalMapTangentSpace:we&&A.normalMapType===wT,metalnessMap:xt,roughnessMap:ne,anisotropy:W,anisotropyMap:bt,clearcoat:_e,clearcoatMap:lt,clearcoatNormalMap:Ge,clearcoatRoughnessMap:We,iridescence:Fe,iridescenceMap:St,iridescenceThicknessMap:Ze,sheen:Ue,sheenColorMap:ni,sheenRoughnessMap:Dt,specularMap:ue,specularColorMap:he,specularIntensityMap:qe,transmission:Be,transmissionMap:ft,thicknessMap:ct,gradientMap:dt,opaque:A.transparent===!1&&A.blending===Tp&&A.alphaToCoverage===!1,alphaMap:ce,alphaTest:it,alphaHash:be,combine:A.combine,mapUv:me&&y(A.map.channel),aoMapUv:ve&&y(A.aoMap.channel),lightMapUv:Ie&&y(A.lightMap.channel),bumpMapUv:ke&&y(A.bumpMap.channel),normalMapUv:we&&y(A.normalMap.channel),displacementMapUv:Oe&&y(A.displacementMap.channel),emissiveMapUv:Je&&y(A.emissiveMap.channel),metalnessMapUv:xt&&y(A.metalnessMap.channel),roughnessMapUv:ne&&y(A.roughnessMap.channel),anisotropyMapUv:bt&&y(A.anisotropyMap.channel),clearcoatMapUv:lt&&y(A.clearcoatMap.channel),clearcoatNormalMapUv:Ge&&y(A.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:We&&y(A.clearcoatRoughnessMap.channel),iridescenceMapUv:St&&y(A.iridescenceMap.channel),iridescenceThicknessMapUv:Ze&&y(A.iridescenceThicknessMap.channel),sheenColorMapUv:ni&&y(A.sheenColorMap.channel),sheenRoughnessMapUv:Dt&&y(A.sheenRoughnessMap.channel),specularMapUv:ue&&y(A.specularMap.channel),specularColorMapUv:he&&y(A.specularColorMap.channel),specularIntensityMapUv:qe&&y(A.specularIntensityMap.channel),transmissionMapUv:ft&&y(A.transmissionMap.channel),thicknessMapUv:ct&&y(A.thicknessMap.channel),alphaMapUv:ce&&y(A.alphaMap.channel),vertexTangents:!!G.attributes.tangent&&(we||W),vertexColors:A.vertexColors,vertexAlphas:A.vertexColors===!0&&!!G.attributes.color&&G.attributes.color.itemSize===4,pointsUvs:P.isPoints===!0&&!!G.attributes.uv&&(me||ce),fog:!!U,useFog:A.fog===!0,fogExp2:!!U&&U.isFogExp2,flatShading:A.flatShading===!0,sizeAttenuation:A.sizeAttenuation===!0,logarithmicDepthBuffer:d,skinning:P.isSkinnedMesh===!0,morphTargets:G.morphAttributes.position!==void 0,morphNormals:G.morphAttributes.normal!==void 0,morphColors:G.morphAttributes.color!==void 0,morphTargetsCount:ee,morphTextureStride:ae,numDirLights:k.directional.length,numPointLights:k.point.length,numSpotLights:k.spot.length,numSpotLightMaps:k.spotLightMap.length,numRectAreaLights:k.rectArea.length,numHemiLights:k.hemi.length,numDirLightShadows:k.directionalShadowMap.length,numPointLightShadows:k.pointShadowMap.length,numSpotLightShadows:k.spotShadowMap.length,numSpotLightShadowsWithMaps:k.numSpotLightShadowsWithMaps,numLightProbes:k.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:A.dithering,shadowMapEnabled:i.shadowMap.enabled&&$.length>0,shadowMapType:i.shadowMap.type,toneMapping:rt,useLegacyLights:i._useLegacyLights,decodeVideoTexture:me&&A.map.isVideoTexture===!0&&Ei.getTransfer(A.map.colorSpace)===Fi,premultipliedAlpha:A.premultipliedAlpha,doubleSided:A.side===Na,flipSided:A.side===Qn,useDepthPacking:A.depthPacking>=0,depthPacking:A.depthPacking||0,index0AttributeName:A.index0AttributeName,extensionDerivatives:Xe&&A.extensions.derivatives===!0,extensionFragDepth:Xe&&A.extensions.fragDepth===!0,extensionDrawBuffers:Xe&&A.extensions.drawBuffers===!0,extensionShaderTextureLOD:Xe&&A.extensions.shaderTextureLOD===!0,extensionClipCullDistance:Xe&&A.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:Xe&&A.extensions.multiDraw===!0&&r.has("WEBGL_multi_draw"),rendererExtensionFragDepth:p||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:A.customProgramCacheKey()};return Wt.vertexUv1s=u.has(1),Wt.vertexUv2s=u.has(2),Wt.vertexUv3s=u.has(3),u.clear(),Wt}h(x,"getParameters");function w(A){let k=[];if(A.shaderID?k.push(A.shaderID):(k.push(A.customVertexShaderID),k.push(A.customFragmentShaderID)),A.defines!==void 0)for(let $ in A.defines)k.push($),k.push(A.defines[$]);return A.isRawShaderMaterial===!1&&(b(k,A),C(k,A),k.push(i.outputColorSpace)),k.push(A.customProgramCacheKey),k.join()}h(w,"getProgramCacheKey");function b(A,k){A.push(k.precision),A.push(k.outputColorSpace),A.push(k.envMapMode),A.push(k.envMapCubeUVHeight),A.push(k.mapUv),A.push(k.alphaMapUv),A.push(k.lightMapUv),A.push(k.aoMapUv),A.push(k.bumpMapUv),A.push(k.normalMapUv),A.push(k.displacementMapUv),A.push(k.emissiveMapUv),A.push(k.metalnessMapUv),A.push(k.roughnessMapUv),A.push(k.anisotropyMapUv),A.push(k.clearcoatMapUv),A.push(k.clearcoatNormalMapUv),A.push(k.clearcoatRoughnessMapUv),A.push(k.iridescenceMapUv),A.push(k.iridescenceThicknessMapUv),A.push(k.sheenColorMapUv),A.push(k.sheenRoughnessMapUv),A.push(k.specularMapUv),A.push(k.specularColorMapUv),A.push(k.specularIntensityMapUv),A.push(k.transmissionMapUv),A.push(k.thicknessMapUv),A.push(k.combine),A.push(k.fogExp2),A.push(k.sizeAttenuation),A.push(k.morphTargetsCount),A.push(k.morphAttributeCount),A.push(k.numDirLights),A.push(k.numPointLights),A.push(k.numSpotLights),A.push(k.numSpotLightMaps),A.push(k.numHemiLights),A.push(k.numRectAreaLights),A.push(k.numDirLightShadows),A.push(k.numPointLightShadows),A.push(k.numSpotLightShadows),A.push(k.numSpotLightShadowsWithMaps),A.push(k.numLightProbes),A.push(k.shadowMapType),A.push(k.toneMapping),A.push(k.numClippingPlanes),A.push(k.numClipIntersection),A.push(k.depthPacking)}h(b,"getProgramCacheKeyParameters");function C(A,k){s.disableAll(),k.isWebGL2&&s.enable(0),k.supportsVertexTextures&&s.enable(1),k.instancing&&s.enable(2),k.instancingColor&&s.enable(3),k.instancingMorph&&s.enable(4),k.matcap&&s.enable(5),k.envMap&&s.enable(6),k.normalMapObjectSpace&&s.enable(7),k.normalMapTangentSpace&&s.enable(8),k.clearcoat&&s.enable(9),k.iridescence&&s.enable(10),k.alphaTest&&s.enable(11),k.vertexColors&&s.enable(12),k.vertexAlphas&&s.enable(13),k.vertexUv1s&&s.enable(14),k.vertexUv2s&&s.enable(15),k.vertexUv3s&&s.enable(16),k.vertexTangents&&s.enable(17),k.anisotropy&&s.enable(18),k.alphaHash&&s.enable(19),k.batching&&s.enable(20),A.push(s.mask),s.disableAll(),k.fog&&s.enable(0),k.useFog&&s.enable(1),k.flatShading&&s.enable(2),k.logarithmicDepthBuffer&&s.enable(3),k.skinning&&s.enable(4),k.morphTargets&&s.enable(5),k.morphNormals&&s.enable(6),k.morphColors&&s.enable(7),k.premultipliedAlpha&&s.enable(8),k.shadowMapEnabled&&s.enable(9),k.useLegacyLights&&s.enable(10),k.doubleSided&&s.enable(11),k.flipSided&&s.enable(12),k.useDepthPacking&&s.enable(13),k.dithering&&s.enable(14),k.transmission&&s.enable(15),k.sheen&&s.enable(16),k.opaque&&s.enable(17),k.pointsUvs&&s.enable(18),k.decodeVideoTexture&&s.enable(19),k.alphaToCoverage&&s.enable(20),A.push(s.mask)}h(C,"getProgramCacheKeyBooleans");function E(A){let k=_[A.type],$;if(k){let z=jo[k];$=q0e.clone(z.uniforms)}else $=A.uniforms;return $}h(E,"getUniforms");function T(A,k){let $;for(let z=0,P=c.length;z<P;z++){let U=c[z];if(U.cacheKey===k){$=U,++$.usedTimes;break}}return $===void 0&&($=new WZ(i,k,A,a),c.push($)),$}h(T,"acquireProgram");function L(A){if(--A.usedTimes===0){let k=c.indexOf(A);c[k]=c[c.length-1],c.pop(),A.destroy()}}h(L,"releaseProgram");function D(A){l.remove(A)}h(D,"releaseShaderCache");function B(){l.dispose()}return h(B,"dispose"),{getParameters:x,getProgramCacheKey:w,getUniforms:E,acquireProgram:T,releaseProgram:L,releaseShaderCache:D,programs:c,dispose:B}}h(ZZ,"WebGLPrograms");function YZ(){let i=new WeakMap;function e(a){let o=i.get(a);return o===void 0&&(o={},i.set(a,o)),o}h(e,"get");function t(a){i.delete(a)}h(t,"remove");function r(a,o,s){i.get(a)[o]=s}h(r,"update");function n(){i=new WeakMap}return h(n,"dispose"),{get:e,remove:t,update:r,dispose:n}}h(YZ,"WebGLProperties");function JZ(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}h(JZ,"painterSortStable");function AS(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}h(AS,"reversePainterSortStable");function IS(){let i=[],e=0,t=[],r=[],n=[];function a(){e=0,t.length=0,r.length=0,n.length=0}h(a,"init");function o(p,d,m,g,_,y){let x=i[e];return x===void 0?(x={id:p.id,object:p,geometry:d,material:m,groupOrder:g,renderOrder:p.renderOrder,z:_,group:y},i[e]=x):(x.id=p.id,x.object=p,x.geometry=d,x.material=m,x.groupOrder=g,x.renderOrder=p.renderOrder,x.z=_,x.group=y),e++,x}h(o,"getNextRenderItem");function s(p,d,m,g,_,y){let x=o(p,d,m,g,_,y);m.transmission>0?r.push(x):m.transparent===!0?n.push(x):t.push(x)}h(s,"push");function l(p,d,m,g,_,y){let x=o(p,d,m,g,_,y);m.transmission>0?r.unshift(x):m.transparent===!0?n.unshift(x):t.unshift(x)}h(l,"unshift");function u(p,d){t.length>1&&t.sort(p||JZ),r.length>1&&r.sort(d||AS),n.length>1&&n.sort(d||AS)}h(u,"sort");function c(){for(let p=e,d=i.length;p<d;p++){let m=i[p];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return h(c,"finish"),{opaque:t,transmissive:r,transparent:n,init:a,push:s,unshift:l,finish:c,sort:u}}h(IS,"WebGLRenderList");function KZ(){let i=new WeakMap;function e(r,n){let a=i.get(r),o;return a===void 0?(o=new IS,i.set(r,[o])):n>=a.length?(o=new IS,a.push(o)):o=a[n],o}h(e,"get");function t(){i=new WeakMap}return h(t,"dispose"),{get:e,dispose:t}}h(KZ,"WebGLRenderLists");function QZ(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new le,color:new Rt};break;case"SpotLight":t={position:new le,direction:new le,color:new Rt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new le,color:new Rt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new le,skyColor:new Rt,groundColor:new Rt};break;case"RectAreaLight":t={color:new Rt,position:new le,halfWidth:new le,halfHeight:new le};break}return i[e.id]=t,t}}}h(QZ,"UniformsCache");function eY(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ne};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ne};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ne,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}h(eY,"ShadowUniformsCache");var X_e=0;function tY(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}h(tY,"shadowCastingAndTexturingLightsFirst");function iY(i,e){let t=new QZ,r=eY(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new le);let a=new le,o=new Gt,s=new Gt;function l(c,p){let d=0,m=0,g=0;for(let $=0;$<9;$++)n.probe[$].set(0,0,0);let _=0,y=0,x=0,w=0,b=0,C=0,E=0,T=0,L=0,D=0,B=0;c.sort(tY);let A=p===!0?Math.PI:1;for(let $=0,z=c.length;$<z;$++){let P=c[$],U=P.color,G=P.intensity,K=P.distance,O=P.shadow&&P.shadow.map?P.shadow.map.texture:null;if(P.isAmbientLight)d+=U.r*G*A,m+=U.g*G*A,g+=U.b*G*A;else if(P.isLightProbe){for(let V=0;V<9;V++)n.probe[V].addScaledVector(P.sh.coefficients[V],G);B++}else if(P.isDirectionalLight){let V=t.get(P);if(V.color.copy(P.color).multiplyScalar(P.intensity*A),P.castShadow){let j=P.shadow,q=r.get(P);q.shadowBias=j.bias,q.shadowNormalBias=j.normalBias,q.shadowRadius=j.radius,q.shadowMapSize=j.mapSize,n.directionalShadow[_]=q,n.directionalShadowMap[_]=O,n.directionalShadowMatrix[_]=P.shadow.matrix,C++}n.directional[_]=V,_++}else if(P.isSpotLight){let V=t.get(P);V.position.setFromMatrixPosition(P.matrixWorld),V.color.copy(U).multiplyScalar(G*A),V.distance=K,V.coneCos=Math.cos(P.angle),V.penumbraCos=Math.cos(P.angle*(1-P.penumbra)),V.decay=P.decay,n.spot[x]=V;let j=P.shadow;if(P.map&&(n.spotLightMap[L]=P.map,L++,j.updateMatrices(P),P.castShadow&&D++),n.spotLightMatrix[x]=j.matrix,P.castShadow){let q=r.get(P);q.shadowBias=j.bias,q.shadowNormalBias=j.normalBias,q.shadowRadius=j.radius,q.shadowMapSize=j.mapSize,n.spotShadow[x]=q,n.spotShadowMap[x]=O,T++}x++}else if(P.isRectAreaLight){let V=t.get(P);V.color.copy(U).multiplyScalar(G),V.halfWidth.set(P.width*.5,0,0),V.halfHeight.set(0,P.height*.5,0),n.rectArea[w]=V,w++}else if(P.isPointLight){let V=t.get(P);if(V.color.copy(P.color).multiplyScalar(P.intensity*A),V.distance=P.distance,V.decay=P.decay,P.castShadow){let j=P.shadow,q=r.get(P);q.shadowBias=j.bias,q.shadowNormalBias=j.normalBias,q.shadowRadius=j.radius,q.shadowMapSize=j.mapSize,q.shadowCameraNear=j.camera.near,q.shadowCameraFar=j.camera.far,n.pointShadow[y]=q,n.pointShadowMap[y]=O,n.pointShadowMatrix[y]=P.shadow.matrix,E++}n.point[y]=V,y++}else if(P.isHemisphereLight){let V=t.get(P);V.skyColor.copy(P.color).multiplyScalar(G*A),V.groundColor.copy(P.groundColor).multiplyScalar(G*A),n.hemi[b]=V,b++}}w>0&&(e.isWebGL2?i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=st.LTC_FLOAT_1,n.rectAreaLTC2=st.LTC_FLOAT_2):(n.rectAreaLTC1=st.LTC_HALF_1,n.rectAreaLTC2=st.LTC_HALF_2):i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=st.LTC_FLOAT_1,n.rectAreaLTC2=st.LTC_FLOAT_2):i.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=st.LTC_HALF_1,n.rectAreaLTC2=st.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=m,n.ambient[2]=g;let k=n.hash;(k.directionalLength!==_||k.pointLength!==y||k.spotLength!==x||k.rectAreaLength!==w||k.hemiLength!==b||k.numDirectionalShadows!==C||k.numPointShadows!==E||k.numSpotShadows!==T||k.numSpotMaps!==L||k.numLightProbes!==B)&&(n.directional.length=_,n.spot.length=x,n.rectArea.length=w,n.point.length=y,n.hemi.length=b,n.directionalShadow.length=C,n.directionalShadowMap.length=C,n.pointShadow.length=E,n.pointShadowMap.length=E,n.spotShadow.length=T,n.spotShadowMap.length=T,n.directionalShadowMatrix.length=C,n.pointShadowMatrix.length=E,n.spotLightMatrix.length=T+L-D,n.spotLightMap.length=L,n.numSpotLightShadowsWithMaps=D,n.numLightProbes=B,k.directionalLength=_,k.pointLength=y,k.spotLength=x,k.rectAreaLength=w,k.hemiLength=b,k.numDirectionalShadows=C,k.numPointShadows=E,k.numSpotShadows=T,k.numSpotMaps=L,k.numLightProbes=B,n.version=X_e++)}h(l,"setup");function u(c,p){let d=0,m=0,g=0,_=0,y=0,x=p.matrixWorldInverse;for(let w=0,b=c.length;w<b;w++){let C=c[w];if(C.isDirectionalLight){let E=n.directional[d];E.direction.setFromMatrixPosition(C.matrixWorld),a.setFromMatrixPosition(C.target.matrixWorld),E.direction.sub(a),E.direction.transformDirection(x),d++}else if(C.isSpotLight){let E=n.spot[g];E.position.setFromMatrixPosition(C.matrixWorld),E.position.applyMatrix4(x),E.direction.setFromMatrixPosition(C.matrixWorld),a.setFromMatrixPosition(C.target.matrixWorld),E.direction.sub(a),E.direction.transformDirection(x),g++}else if(C.isRectAreaLight){let E=n.rectArea[_];E.position.setFromMatrixPosition(C.matrixWorld),E.position.applyMatrix4(x),s.identity(),o.copy(C.matrixWorld),o.premultiply(x),s.extractRotation(o),E.halfWidth.set(C.width*.5,0,0),E.halfHeight.set(0,C.height*.5,0),E.halfWidth.applyMatrix4(s),E.halfHeight.applyMatrix4(s),_++}else if(C.isPointLight){let E=n.point[m];E.position.setFromMatrixPosition(C.matrixWorld),E.position.applyMatrix4(x),m++}else if(C.isHemisphereLight){let E=n.hemi[y];E.direction.setFromMatrixPosition(C.matrixWorld),E.direction.transformDirection(x),y++}}}return h(u,"setupView"),{setup:l,setupView:u,state:n}}h(iY,"WebGLLights");function LS(i,e){let t=new iY(i,e),r=[],n=[];function a(){r.length=0,n.length=0}h(a,"init");function o(c){r.push(c)}h(o,"pushLight");function s(c){n.push(c)}h(s,"pushShadow");function l(c){t.setup(r,c)}h(l,"setupLights");function u(c){t.setupView(r,c)}return h(u,"setupLightsView"),{init:a,state:{lightsArray:r,shadowsArray:n,lights:t},setupLights:l,setupLightsView:u,pushLight:o,pushShadow:s}}h(LS,"WebGLRenderState");function rY(i,e){let t=new WeakMap;function r(a,o=0){let s=t.get(a),l;return s===void 0?(l=new LS(i,e),t.set(a,[l])):o>=s.length?(l=new LS(i,e),s.push(l)):l=s[o],l}h(r,"get");function n(){t=new WeakMap}return h(n,"dispose"),{get:r,dispose:n}}h(rY,"WebGLRenderStates");var nY=class extends iu{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=S0e,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}};h(nY,"MeshDepthMaterial");var q_e=nY,aY=class extends iu{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}};h(aY,"MeshDistanceMaterial");var Z_e=aY,Y_e=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,J_e=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function oY(i,e,t){let r=new Pg,n=new Ne,a=new Ne,o=new Ai,s=new q_e({depthPacking:M0e}),l=new Z_e,u={},c=t.maxTextureSize,p={[Xl]:Qn,[Qn]:Xl,[Na]:Na},d=new Eo({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ne},radius:{value:4}},vertexShader:Y_e,fragmentShader:J_e}),m=d.clone();m.defines.HORIZONTAL_PASS=1;let g=new Sa;g.setAttribute("position",new Ur(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let _=new Zi(g,d),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=BW;let x=this.type;this.render=function(T,L,D){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||T.length===0)return;let B=i.getRenderTarget(),A=i.getActiveCubeFace(),k=i.getActiveMipmapLevel(),$=i.state;$.setBlending(Nl),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);let z=x!==ms&&this.type===ms,P=x===ms&&this.type!==ms;for(let U=0,G=T.length;U<G;U++){let K=T[U],O=K.shadow;if(O===void 0){console.warn("THREE.WebGLShadowMap:",K,"has no shadow.");continue}if(O.autoUpdate===!1&&O.needsUpdate===!1)continue;n.copy(O.mapSize);let V=O.getFrameExtents();if(n.multiply(V),a.copy(O.mapSize),(n.x>c||n.y>c)&&(n.x>c&&(a.x=Math.floor(c/V.x),n.x=a.x*V.x,O.mapSize.x=a.x),n.y>c&&(a.y=Math.floor(c/V.y),n.y=a.y*V.y,O.mapSize.y=a.y)),O.map===null||z===!0||P===!0){let q=this.type!==ms?{minFilter:Kr,magFilter:Kr}:{};O.map!==null&&O.map.dispose(),O.map=new dh(n.x,n.y,q),O.map.texture.name=K.name+".shadowMap",O.camera.updateProjectionMatrix()}i.setRenderTarget(O.map),i.clear();let j=O.getViewportCount();for(let q=0;q<j;q++){let ee=O.getViewport(q);o.set(a.x*ee.x,a.y*ee.y,a.x*ee.z,a.y*ee.w),$.viewport(o),O.updateMatrices(K,q),r=O.getFrustum(),C(L,D,O.camera,K,this.type)}O.isPointLightShadow!==!0&&this.type===ms&&w(O,D),O.needsUpdate=!1}x=this.type,y.needsUpdate=!1,i.setRenderTarget(B,A,k)};function w(T,L){let D=e.update(_);d.defines.VSM_SAMPLES!==T.blurSamples&&(d.defines.VSM_SAMPLES=T.blurSamples,m.defines.VSM_SAMPLES=T.blurSamples,d.needsUpdate=!0,m.needsUpdate=!0),T.mapPass===null&&(T.mapPass=new dh(n.x,n.y)),d.uniforms.shadow_pass.value=T.map.texture,d.uniforms.resolution.value=T.mapSize,d.uniforms.radius.value=T.radius,i.setRenderTarget(T.mapPass),i.clear(),i.renderBufferDirect(L,null,D,d,_,null),m.uniforms.shadow_pass.value=T.mapPass.texture,m.uniforms.resolution.value=T.mapSize,m.uniforms.radius.value=T.radius,i.setRenderTarget(T.map),i.clear(),i.renderBufferDirect(L,null,D,m,_,null)}h(w,"VSMPass");function b(T,L,D,B){let A=null,k=D.isPointLight===!0?T.customDistanceMaterial:T.customDepthMaterial;if(k!==void 0)A=k;else if(A=D.isPointLight===!0?l:s,i.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0){let $=A.uuid,z=L.uuid,P=u[$];P===void 0&&(P={},u[$]=P);let U=P[z];U===void 0&&(U=A.clone(),P[z]=U,L.addEventListener("dispose",E)),A=U}if(A.visible=L.visible,A.wireframe=L.wireframe,B===ms?A.side=L.shadowSide!==null?L.shadowSide:L.side:A.side=L.shadowSide!==null?L.shadowSide:p[L.side],A.alphaMap=L.alphaMap,A.alphaTest=L.alphaTest,A.map=L.map,A.clipShadows=L.clipShadows,A.clippingPlanes=L.clippingPlanes,A.clipIntersection=L.clipIntersection,A.displacementMap=L.displacementMap,A.displacementScale=L.displacementScale,A.displacementBias=L.displacementBias,A.wireframeLinewidth=L.wireframeLinewidth,A.linewidth=L.linewidth,D.isPointLight===!0&&A.isMeshDistanceMaterial===!0){let $=i.properties.get(A);$.light=D}return A}h(b,"getDepthMaterial");function C(T,L,D,B,A){if(T.visible===!1)return;if(T.layers.test(L.layers)&&(T.isMesh||T.isLine||T.isPoints)&&(T.castShadow||T.receiveShadow&&A===ms)&&(!T.frustumCulled||r.intersectsObject(T))){T.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,T.matrixWorld);let $=e.update(T),z=T.material;if(Array.isArray(z)){let P=$.groups;for(let U=0,G=P.length;U<G;U++){let K=P[U],O=z[K.materialIndex];if(O&&O.visible){let V=b(T,O,B,A);T.onBeforeShadow(i,T,L,D,$,V,K),i.renderBufferDirect(D,null,$,V,T,K),T.onAfterShadow(i,T,L,D,$,V,K)}}}else if(z.visible){let P=b(T,z,B,A);T.onBeforeShadow(i,T,L,D,$,P,null),i.renderBufferDirect(D,null,$,P,T,null),T.onAfterShadow(i,T,L,D,$,P,null)}}let k=T.children;for(let $=0,z=k.length;$<z;$++)C(k[$],L,D,B,A)}h(C,"renderObject");function E(T){T.target.removeEventListener("dispose",E);for(let L in u){let D=u[L],B=T.target.uuid;B in D&&(D[B].dispose(),delete D[B])}}h(E,"onMaterialDispose")}h(oY,"WebGLShadowMap");function sY(i,e,t){let r=t.isWebGL2;function n(){let ce=!1,it=new Ai,be=null,Xe=new Ai(0,0,0,0);return{setMask:function(rt){be!==rt&&!ce&&(i.colorMask(rt,rt,rt,rt),be=rt)},setLocked:function(rt){ce=rt},setClear:function(rt,Wt,Ut,Ti,lr){lr===!0&&(rt*=Ti,Wt*=Ti,Ut*=Ti),it.set(rt,Wt,Ut,Ti),Xe.equals(it)===!1&&(i.clearColor(rt,Wt,Ut,Ti),Xe.copy(it))},reset:function(){ce=!1,be=null,Xe.set(-1,0,0,0)}}}h(n,"ColorBuffer");function a(){let ce=!1,it=null,be=null,Xe=null;return{setTest:function(rt){rt?ge(i.DEPTH_TEST):Te(i.DEPTH_TEST)},setMask:function(rt){it!==rt&&!ce&&(i.depthMask(rt),it=rt)},setFunc:function(rt){if(be!==rt){switch(rt){case Yye:i.depthFunc(i.NEVER);break;case Jye:i.depthFunc(i.ALWAYS);break;case Kye:i.depthFunc(i.LESS);break;case Gv:i.depthFunc(i.LEQUAL);break;case Qye:i.depthFunc(i.EQUAL);break;case e0e:i.depthFunc(i.GEQUAL);break;case t0e:i.depthFunc(i.GREATER);break;case i0e:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}be=rt}},setLocked:function(rt){ce=rt},setClear:function(rt){Xe!==rt&&(i.clearDepth(rt),Xe=rt)},reset:function(){ce=!1,it=null,be=null,Xe=null}}}h(a,"DepthBuffer");function o(){let ce=!1,it=null,be=null,Xe=null,rt=null,Wt=null,Ut=null,Ti=null,lr=null;return{setTest:function(jt){ce||(jt?ge(i.STENCIL_TEST):Te(i.STENCIL_TEST))},setMask:function(jt){it!==jt&&!ce&&(i.stencilMask(jt),it=jt)},setFunc:function(jt,Pi,mr){(be!==jt||Xe!==Pi||rt!==mr)&&(i.stencilFunc(jt,Pi,mr),be=jt,Xe=Pi,rt=mr)},setOp:function(jt,Pi,mr){(Wt!==jt||Ut!==Pi||Ti!==mr)&&(i.stencilOp(jt,Pi,mr),Wt=jt,Ut=Pi,Ti=mr)},setLocked:function(jt){ce=jt},setClear:function(jt){lr!==jt&&(i.clearStencil(jt),lr=jt)},reset:function(){ce=!1,it=null,be=null,Xe=null,rt=null,Wt=null,Ut=null,Ti=null,lr=null}}}h(o,"StencilBuffer");let s=new n,l=new a,u=new o,c=new WeakMap,p=new WeakMap,d={},m={},g=new WeakMap,_=[],y=null,x=!1,w=null,b=null,C=null,E=null,T=null,L=null,D=null,B=new Rt(0,0,0),A=0,k=!1,$=null,z=null,P=null,U=null,G=null,K=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),O=!1,V=0,j=i.getParameter(i.VERSION);j.indexOf("WebGL")!==-1?(V=parseFloat(/^WebGL (\d)/.exec(j)[1]),O=V>=1):j.indexOf("OpenGL ES")!==-1&&(V=parseFloat(/^OpenGL ES (\d)/.exec(j)[1]),O=V>=2);let q=null,ee={},ae=i.getParameter(i.SCISSOR_BOX),N=i.getParameter(i.VIEWPORT),J=new Ai().fromArray(ae),Y=new Ai().fromArray(N);function oe(ce,it,be,Xe){let rt=new Uint8Array(4),Wt=i.createTexture();i.bindTexture(ce,Wt),i.texParameteri(ce,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(ce,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let Ut=0;Ut<be;Ut++)r&&(ce===i.TEXTURE_3D||ce===i.TEXTURE_2D_ARRAY)?i.texImage3D(it,0,i.RGBA,1,1,Xe,0,i.RGBA,i.UNSIGNED_BYTE,rt):i.texImage2D(it+Ut,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,rt);return Wt}h(oe,"createTexture");let xe={};xe[i.TEXTURE_2D]=oe(i.TEXTURE_2D,i.TEXTURE_2D,1),xe[i.TEXTURE_CUBE_MAP]=oe(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(xe[i.TEXTURE_2D_ARRAY]=oe(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),xe[i.TEXTURE_3D]=oe(i.TEXTURE_3D,i.TEXTURE_3D,1,1)),s.setClear(0,0,0,1),l.setClear(1),u.setClear(0),ge(i.DEPTH_TEST),l.setFunc(Gv),Oe(!1),Je(z6),ge(i.CULL_FACE),ke(Nl);function ge(ce){d[ce]!==!0&&(i.enable(ce),d[ce]=!0)}h(ge,"enable");function Te(ce){d[ce]!==!1&&(i.disable(ce),d[ce]=!1)}h(Te,"disable");function me(ce,it){return m[ce]!==it?(i.bindFramebuffer(ce,it),m[ce]=it,r&&(ce===i.DRAW_FRAMEBUFFER&&(m[i.FRAMEBUFFER]=it),ce===i.FRAMEBUFFER&&(m[i.DRAW_FRAMEBUFFER]=it)),!0):!1}h(me,"bindFramebuffer");function Q(ce,it){let be=_,Xe=!1;if(ce){be=g.get(it),be===void 0&&(be=[],g.set(it,be));let rt=ce.textures;if(be.length!==rt.length||be[0]!==i.COLOR_ATTACHMENT0){for(let Wt=0,Ut=rt.length;Wt<Ut;Wt++)be[Wt]=i.COLOR_ATTACHMENT0+Wt;be.length=rt.length,Xe=!0}}else be[0]!==i.BACK&&(be[0]=i.BACK,Xe=!0);if(Xe)if(t.isWebGL2)i.drawBuffers(be);else if(e.has("WEBGL_draw_buffers")===!0)e.get("WEBGL_draw_buffers").drawBuffersWEBGL(be);else throw new Error("THREE.WebGLState: Usage of gl.drawBuffers() require WebGL2 or WEBGL_draw_buffers extension")}h(Q,"drawBuffers");function Me(ce){return y!==ce?(i.useProgram(ce),y=ce,!0):!1}h(Me,"useProgram");let ve={[Lu]:i.FUNC_ADD,[Fye]:i.FUNC_SUBTRACT,[Oye]:i.FUNC_REVERSE_SUBTRACT};if(r)ve[V6]=i.MIN,ve[j6]=i.MAX;else{let ce=e.get("EXT_blend_minmax");ce!==null&&(ve[V6]=ce.MIN_EXT,ve[j6]=ce.MAX_EXT)}let Ie={[Bye]:i.ZERO,[zye]:i.ONE,[Nye]:i.SRC_COLOR,[cS]:i.SRC_ALPHA,[Gye]:i.SRC_ALPHA_SATURATE,[jye]:i.DST_COLOR,[Uye]:i.DST_ALPHA,[$ye]:i.ONE_MINUS_SRC_COLOR,[pS]:i.ONE_MINUS_SRC_ALPHA,[Hye]:i.ONE_MINUS_DST_COLOR,[Vye]:i.ONE_MINUS_DST_ALPHA,[Wye]:i.CONSTANT_COLOR,[Xye]:i.ONE_MINUS_CONSTANT_COLOR,[qye]:i.CONSTANT_ALPHA,[Zye]:i.ONE_MINUS_CONSTANT_ALPHA};function ke(ce,it,be,Xe,rt,Wt,Ut,Ti,lr,jt){if(ce===Nl){x===!0&&(Te(i.BLEND),x=!1);return}if(x===!1&&(ge(i.BLEND),x=!0),ce!==Rye){if(ce!==w||jt!==k){if((b!==Lu||T!==Lu)&&(i.blendEquation(i.FUNC_ADD),b=Lu,T=Lu),jt)switch(ce){case Tp:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case N6:i.blendFunc(i.ONE,i.ONE);break;case $6:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case U6:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}else switch(ce){case Tp:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case N6:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case $6:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case U6:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce);break}C=null,E=null,L=null,D=null,B.set(0,0,0),A=0,w=ce,k=jt}return}rt=rt||it,Wt=Wt||be,Ut=Ut||Xe,(it!==b||rt!==T)&&(i.blendEquationSeparate(ve[it],ve[rt]),b=it,T=rt),(be!==C||Xe!==E||Wt!==L||Ut!==D)&&(i.blendFuncSeparate(Ie[be],Ie[Xe],Ie[Wt],Ie[Ut]),C=be,E=Xe,L=Wt,D=Ut),(Ti.equals(B)===!1||lr!==A)&&(i.blendColor(Ti.r,Ti.g,Ti.b,lr),B.copy(Ti),A=lr),w=ce,k=!1}h(ke,"setBlending");function we(ce,it){ce.side===Na?Te(i.CULL_FACE):ge(i.CULL_FACE);let be=ce.side===Qn;it&&(be=!be),Oe(be),ce.blending===Tp&&ce.transparent===!1?ke(Nl):ke(ce.blending,ce.blendEquation,ce.blendSrc,ce.blendDst,ce.blendEquationAlpha,ce.blendSrcAlpha,ce.blendDstAlpha,ce.blendColor,ce.blendAlpha,ce.premultipliedAlpha),l.setFunc(ce.depthFunc),l.setTest(ce.depthTest),l.setMask(ce.depthWrite),s.setMask(ce.colorWrite);let Xe=ce.stencilWrite;u.setTest(Xe),Xe&&(u.setMask(ce.stencilWriteMask),u.setFunc(ce.stencilFunc,ce.stencilRef,ce.stencilFuncMask),u.setOp(ce.stencilFail,ce.stencilZFail,ce.stencilZPass)),ne(ce.polygonOffset,ce.polygonOffsetFactor,ce.polygonOffsetUnits),ce.alphaToCoverage===!0?ge(i.SAMPLE_ALPHA_TO_COVERAGE):Te(i.SAMPLE_ALPHA_TO_COVERAGE)}h(we,"setMaterial");function Oe(ce){$!==ce&&(ce?i.frontFace(i.CW):i.frontFace(i.CCW),$=ce)}h(Oe,"setFlipSided");function Je(ce){ce!==Lye?(ge(i.CULL_FACE),ce!==z&&(ce===z6?i.cullFace(i.BACK):ce===Dye?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):Te(i.CULL_FACE),z=ce}h(Je,"setCullFace");function xt(ce){ce!==P&&(O&&i.lineWidth(ce),P=ce)}h(xt,"setLineWidth");function ne(ce,it,be){ce?(ge(i.POLYGON_OFFSET_FILL),(U!==it||G!==be)&&(i.polygonOffset(it,be),U=it,G=be)):Te(i.POLYGON_OFFSET_FILL)}h(ne,"setPolygonOffset");function W(ce){ce?ge(i.SCISSOR_TEST):Te(i.SCISSOR_TEST)}h(W,"setScissorTest");function _e(ce){ce===void 0&&(ce=i.TEXTURE0+K-1),q!==ce&&(i.activeTexture(ce),q=ce)}h(_e,"activeTexture");function Fe(ce,it,be){be===void 0&&(q===null?be=i.TEXTURE0+K-1:be=q);let Xe=ee[be];Xe===void 0&&(Xe={type:void 0,texture:void 0},ee[be]=Xe),(Xe.type!==ce||Xe.texture!==it)&&(q!==be&&(i.activeTexture(be),q=be),i.bindTexture(ce,it||xe[ce]),Xe.type=ce,Xe.texture=it)}h(Fe,"bindTexture");function Ue(){let ce=ee[q];ce!==void 0&&ce.type!==void 0&&(i.bindTexture(ce.type,null),ce.type=void 0,ce.texture=void 0)}h(Ue,"unbindTexture");function Be(){try{i.compressedTexImage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(Be,"compressedTexImage2D");function bt(){try{i.compressedTexImage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(bt,"compressedTexImage3D");function lt(){try{i.texSubImage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(lt,"texSubImage2D");function Ge(){try{i.texSubImage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(Ge,"texSubImage3D");function We(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(We,"compressedTexSubImage2D");function St(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(St,"compressedTexSubImage3D");function Ze(){try{i.texStorage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(Ze,"texStorage2D");function ni(){try{i.texStorage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(ni,"texStorage3D");function Dt(){try{i.texImage2D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(Dt,"texImage2D");function ue(){try{i.texImage3D.apply(i,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}}h(ue,"texImage3D");function he(ce){J.equals(ce)===!1&&(i.scissor(ce.x,ce.y,ce.z,ce.w),J.copy(ce))}h(he,"scissor");function qe(ce){Y.equals(ce)===!1&&(i.viewport(ce.x,ce.y,ce.z,ce.w),Y.copy(ce))}h(qe,"viewport");function ft(ce,it){let be=p.get(it);be===void 0&&(be=new WeakMap,p.set(it,be));let Xe=be.get(ce);Xe===void 0&&(Xe=i.getUniformBlockIndex(it,ce.name),be.set(ce,Xe))}h(ft,"updateUBOMapping");function ct(ce,it){let be=p.get(it).get(ce);c.get(it)!==be&&(i.uniformBlockBinding(it,be,ce.__bindingPointIndex),c.set(it,be))}h(ct,"uniformBlockBinding");function dt(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),r===!0&&(i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null)),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),d={},q=null,ee={},m={},g=new WeakMap,_=[],y=null,x=!1,w=null,b=null,C=null,E=null,T=null,L=null,D=null,B=new Rt(0,0,0),A=0,k=!1,$=null,z=null,P=null,U=null,G=null,J.set(0,0,i.canvas.width,i.canvas.height),Y.set(0,0,i.canvas.width,i.canvas.height),s.reset(),l.reset(),u.reset()}return h(dt,"reset"),{buffers:{color:s,depth:l,stencil:u},enable:ge,disable:Te,bindFramebuffer:me,drawBuffers:Q,useProgram:Me,setBlending:ke,setMaterial:we,setFlipSided:Oe,setCullFace:Je,setLineWidth:xt,setPolygonOffset:ne,setScissorTest:W,activeTexture:_e,bindTexture:Fe,unbindTexture:Ue,compressedTexImage2D:Be,compressedTexImage3D:bt,texImage2D:Dt,texImage3D:ue,updateUBOMapping:ft,uniformBlockBinding:ct,texStorage2D:Ze,texStorage3D:ni,texSubImage2D:lt,texSubImage3D:Ge,compressedTexSubImage2D:We,compressedTexSubImage3D:St,scissor:he,viewport:qe,reset:dt}}h(sY,"WebGLState");function lY(i,e,t,r,n,a,o){let s=n.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new Ne,p=new WeakMap,d,m=new WeakMap,g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(ne,W){return g?new OffscreenCanvas(ne,W):rd("canvas")}h(_,"createCanvas");function y(ne,W,_e,Fe){let Ue=1,Be=xt(ne);if((Be.width>Fe||Be.height>Fe)&&(Ue=Fe/Math.max(Be.width,Be.height)),Ue<1||W===!0)if(typeof HTMLImageElement<"u"&&ne instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ne instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ne instanceof ImageBitmap||typeof VideoFrame<"u"&&ne instanceof VideoFrame){let bt=W?Km:Math.floor,lt=bt(Ue*Be.width),Ge=bt(Ue*Be.height);d===void 0&&(d=_(lt,Ge));let We=_e?_(lt,Ge):d;return We.width=lt,We.height=Ge,We.getContext("2d").drawImage(ne,0,0,lt,Ge),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Be.width+"x"+Be.height+") to ("+lt+"x"+Ge+")."),We}else return"data"in ne&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Be.width+"x"+Be.height+")."),ne;return ne}h(y,"resizeImage");function x(ne){let W=xt(ne);return Kv(W.width)&&Kv(W.height)}h(x,"isPowerOfTwo$1");function w(ne){return s?!1:ne.wrapS!==vo||ne.wrapT!==vo||ne.minFilter!==Kr&&ne.minFilter!==$n}h(w,"textureNeedsPowerOfTwo");function b(ne,W){return ne.generateMipmaps&&W&&ne.minFilter!==Kr&&ne.minFilter!==$n}h(b,"textureNeedsGenerateMipmaps");function C(ne){i.generateMipmap(ne)}h(C,"generateMipmap");function E(ne,W,_e,Fe,Ue=!1){if(s===!1)return W;if(ne!==null){if(i[ne]!==void 0)return i[ne];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ne+"'")}let Be=W;if(W===i.RED&&(_e===i.FLOAT&&(Be=i.R32F),_e===i.HALF_FLOAT&&(Be=i.R16F),_e===i.UNSIGNED_BYTE&&(Be=i.R8)),W===i.RED_INTEGER&&(_e===i.UNSIGNED_BYTE&&(Be=i.R8UI),_e===i.UNSIGNED_SHORT&&(Be=i.R16UI),_e===i.UNSIGNED_INT&&(Be=i.R32UI),_e===i.BYTE&&(Be=i.R8I),_e===i.SHORT&&(Be=i.R16I),_e===i.INT&&(Be=i.R32I)),W===i.RG&&(_e===i.FLOAT&&(Be=i.RG32F),_e===i.HALF_FLOAT&&(Be=i.RG16F),_e===i.UNSIGNED_BYTE&&(Be=i.RG8)),W===i.RG_INTEGER&&(_e===i.UNSIGNED_BYTE&&(Be=i.RG8UI),_e===i.UNSIGNED_SHORT&&(Be=i.RG16UI),_e===i.UNSIGNED_INT&&(Be=i.RG32UI),_e===i.BYTE&&(Be=i.RG8I),_e===i.SHORT&&(Be=i.RG16I),_e===i.INT&&(Be=i.RG32I)),W===i.RGBA){let bt=Ue?qv:Ei.getTransfer(Fe);_e===i.FLOAT&&(Be=i.RGBA32F),_e===i.HALF_FLOAT&&(Be=i.RGBA16F),_e===i.UNSIGNED_BYTE&&(Be=bt===Fi?i.SRGB8_ALPHA8:i.RGBA8),_e===i.UNSIGNED_SHORT_4_4_4_4&&(Be=i.RGBA4),_e===i.UNSIGNED_SHORT_5_5_5_1&&(Be=i.RGB5_A1)}return(Be===i.R16F||Be===i.R32F||Be===i.RG16F||Be===i.RG32F||Be===i.RGBA16F||Be===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Be}h(E,"getInternalFormat");function T(ne,W,_e){return b(ne,_e)===!0||ne.isFramebufferTexture&&ne.minFilter!==Kr&&ne.minFilter!==$n?Math.log2(Math.max(W.width,W.height))+1:ne.mipmaps!==void 0&&ne.mipmaps.length>0?ne.mipmaps.length:ne.isCompressedTexture&&Array.isArray(ne.image)?W.mipmaps.length:1}h(T,"getMipLevels");function L(ne){return ne===Kr||ne===G6||ne===Wd?i.NEAREST:i.LINEAR}h(L,"filterFallback");function D(ne){let W=ne.target;W.removeEventListener("dispose",D),A(W),W.isVideoTexture&&p.delete(W)}h(D,"onTextureDispose");function B(ne){let W=ne.target;W.removeEventListener("dispose",B),$(W)}h(B,"onRenderTargetDispose");function A(ne){let W=r.get(ne);if(W.__webglInit===void 0)return;let _e=ne.source,Fe=m.get(_e);if(Fe){let Ue=Fe[W.__cacheKey];Ue.usedTimes--,Ue.usedTimes===0&&k(ne),Object.keys(Fe).length===0&&m.delete(_e)}r.remove(ne)}h(A,"deallocateTexture");function k(ne){let W=r.get(ne);i.deleteTexture(W.__webglTexture);let _e=ne.source,Fe=m.get(_e);delete Fe[W.__cacheKey],o.memory.textures--}h(k,"deleteTexture");function $(ne){let W=r.get(ne);if(ne.depthTexture&&ne.depthTexture.dispose(),ne.isWebGLCubeRenderTarget)for(let Fe=0;Fe<6;Fe++){if(Array.isArray(W.__webglFramebuffer[Fe]))for(let Ue=0;Ue<W.__webglFramebuffer[Fe].length;Ue++)i.deleteFramebuffer(W.__webglFramebuffer[Fe][Ue]);else i.deleteFramebuffer(W.__webglFramebuffer[Fe]);W.__webglDepthbuffer&&i.deleteRenderbuffer(W.__webglDepthbuffer[Fe])}else{if(Array.isArray(W.__webglFramebuffer))for(let Fe=0;Fe<W.__webglFramebuffer.length;Fe++)i.deleteFramebuffer(W.__webglFramebuffer[Fe]);else i.deleteFramebuffer(W.__webglFramebuffer);if(W.__webglDepthbuffer&&i.deleteRenderbuffer(W.__webglDepthbuffer),W.__webglMultisampledFramebuffer&&i.deleteFramebuffer(W.__webglMultisampledFramebuffer),W.__webglColorRenderbuffer)for(let Fe=0;Fe<W.__webglColorRenderbuffer.length;Fe++)W.__webglColorRenderbuffer[Fe]&&i.deleteRenderbuffer(W.__webglColorRenderbuffer[Fe]);W.__webglDepthRenderbuffer&&i.deleteRenderbuffer(W.__webglDepthRenderbuffer)}let _e=ne.textures;for(let Fe=0,Ue=_e.length;Fe<Ue;Fe++){let Be=r.get(_e[Fe]);Be.__webglTexture&&(i.deleteTexture(Be.__webglTexture),o.memory.textures--),r.remove(_e[Fe])}r.remove(ne)}h($,"deallocateRenderTarget");let z=0;function P(){z=0}h(P,"resetTextureUnits");function U(){let ne=z;return ne>=n.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ne+" texture units while this GPU supports only "+n.maxTextures),z+=1,ne}h(U,"allocateTextureUnit");function G(ne){let W=[];return W.push(ne.wrapS),W.push(ne.wrapT),W.push(ne.wrapR||0),W.push(ne.magFilter),W.push(ne.minFilter),W.push(ne.anisotropy),W.push(ne.internalFormat),W.push(ne.format),W.push(ne.type),W.push(ne.generateMipmaps),W.push(ne.premultiplyAlpha),W.push(ne.flipY),W.push(ne.unpackAlignment),W.push(ne.colorSpace),W.join()}h(G,"getTextureCacheKey");function K(ne,W){let _e=r.get(ne);if(ne.isVideoTexture&&Oe(ne),ne.isRenderTargetTexture===!1&&ne.version>0&&_e.__version!==ne.version){let Fe=ne.image;if(Fe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Fe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Y(_e,ne,W);return}}t.bindTexture(i.TEXTURE_2D,_e.__webglTexture,i.TEXTURE0+W)}h(K,"setTexture2D");function O(ne,W){let _e=r.get(ne);if(ne.version>0&&_e.__version!==ne.version){Y(_e,ne,W);return}t.bindTexture(i.TEXTURE_2D_ARRAY,_e.__webglTexture,i.TEXTURE0+W)}h(O,"setTexture2DArray");function V(ne,W){let _e=r.get(ne);if(ne.version>0&&_e.__version!==ne.version){Y(_e,ne,W);return}t.bindTexture(i.TEXTURE_3D,_e.__webglTexture,i.TEXTURE0+W)}h(V,"setTexture3D");function j(ne,W){let _e=r.get(ne);if(ne.version>0&&_e.__version!==ne.version){oe(_e,ne,W);return}t.bindTexture(i.TEXTURE_CUBE_MAP,_e.__webglTexture,i.TEXTURE0+W)}h(j,"setTextureCube");let q={[_o]:i.REPEAT,[vo]:i.CLAMP_TO_EDGE,[mS]:i.MIRRORED_REPEAT},ee={[Kr]:i.NEAREST,[G6]:i.NEAREST_MIPMAP_NEAREST,[Wd]:i.NEAREST_MIPMAP_LINEAR,[$n]:i.LINEAR,[j2]:i.LINEAR_MIPMAP_NEAREST,[Nu]:i.LINEAR_MIPMAP_LINEAR},ae={[E0e]:i.NEVER,[D0e]:i.ALWAYS,[T0e]:i.LESS,[XW]:i.LEQUAL,[P0e]:i.EQUAL,[L0e]:i.GEQUAL,[A0e]:i.GREATER,[I0e]:i.NOTEQUAL};function N(ne,W,_e){if(W.type===ca&&e.has("OES_texture_float_linear")===!1&&(W.magFilter===$n||W.magFilter===j2||W.magFilter===Wd||W.magFilter===Nu||W.minFilter===$n||W.minFilter===j2||W.minFilter===Wd||W.minFilter===Nu)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),_e?(i.texParameteri(ne,i.TEXTURE_WRAP_S,q[W.wrapS]),i.texParameteri(ne,i.TEXTURE_WRAP_T,q[W.wrapT]),(ne===i.TEXTURE_3D||ne===i.TEXTURE_2D_ARRAY)&&i.texParameteri(ne,i.TEXTURE_WRAP_R,q[W.wrapR]),i.texParameteri(ne,i.TEXTURE_MAG_FILTER,ee[W.magFilter]),i.texParameteri(ne,i.TEXTURE_MIN_FILTER,ee[W.minFilter])):(i.texParameteri(ne,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(ne,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),(ne===i.TEXTURE_3D||ne===i.TEXTURE_2D_ARRAY)&&i.texParameteri(ne,i.TEXTURE_WRAP_R,i.CLAMP_TO_EDGE),(W.wrapS!==vo||W.wrapT!==vo)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),i.texParameteri(ne,i.TEXTURE_MAG_FILTER,L(W.magFilter)),i.texParameteri(ne,i.TEXTURE_MIN_FILTER,L(W.minFilter)),W.minFilter!==Kr&&W.minFilter!==$n&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),W.compareFunction&&(i.texParameteri(ne,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(ne,i.TEXTURE_COMPARE_FUNC,ae[W.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(W.magFilter===Kr||W.minFilter!==Wd&&W.minFilter!==Nu||W.type===ca&&e.has("OES_texture_float_linear")===!1||s===!1&&W.type===Jm&&e.has("OES_texture_half_float_linear")===!1)return;if(W.anisotropy>1||r.get(W).__currentAnisotropy){let Fe=e.get("EXT_texture_filter_anisotropic");i.texParameterf(ne,Fe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(W.anisotropy,n.getMaxAnisotropy())),r.get(W).__currentAnisotropy=W.anisotropy}}}h(N,"setTextureParameters");function J(ne,W){let _e=!1;ne.__webglInit===void 0&&(ne.__webglInit=!0,W.addEventListener("dispose",D));let Fe=W.source,Ue=m.get(Fe);Ue===void 0&&(Ue={},m.set(Fe,Ue));let Be=G(W);if(Be!==ne.__cacheKey){Ue[Be]===void 0&&(Ue[Be]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,_e=!0),Ue[Be].usedTimes++;let bt=Ue[ne.__cacheKey];bt!==void 0&&(Ue[ne.__cacheKey].usedTimes--,bt.usedTimes===0&&k(W)),ne.__cacheKey=Be,ne.__webglTexture=Ue[Be].texture}return _e}h(J,"initTexture");function Y(ne,W,_e){let Fe=i.TEXTURE_2D;(W.isDataArrayTexture||W.isCompressedArrayTexture)&&(Fe=i.TEXTURE_2D_ARRAY),W.isData3DTexture&&(Fe=i.TEXTURE_3D);let Ue=J(ne,W),Be=W.source;t.bindTexture(Fe,ne.__webglTexture,i.TEXTURE0+_e);let bt=r.get(Be);if(Be.version!==bt.__version||Ue===!0){t.activeTexture(i.TEXTURE0+_e);let lt=Ei.getPrimaries(Ei.workingColorSpace),Ge=W.colorSpace===bl?null:Ei.getPrimaries(W.colorSpace),We=W.colorSpace===bl||lt===Ge?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,W.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,W.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,We);let St=w(W)&&x(W.image)===!1,Ze=y(W.image,St,!1,n.maxTextureSize);Ze=Je(W,Ze);let ni=x(Ze)||s,Dt=a.convert(W.format,W.colorSpace),ue=a.convert(W.type),he=E(W.internalFormat,Dt,ue,W.colorSpace,W.isVideoTexture);N(Fe,W,ni);let qe,ft=W.mipmaps,ct=s&&W.isVideoTexture!==!0&&he!==WW,dt=bt.__version===void 0||Ue===!0,ce=Be.dataReady,it=T(W,Ze,ni);if(W.isDepthTexture)he=i.DEPTH_COMPONENT,s?W.type===ca?he=i.DEPTH_COMPONENT32F:W.type===Tl?he=i.DEPTH_COMPONENT24:W.type===Zu?he=i.DEPTH24_STENCIL8:he=i.DEPTH_COMPONENT16:W.type===ca&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),W.format===Yu&&he===i.DEPTH_COMPONENT&&W.type!==bT&&W.type!==Tl&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),W.type=Tl,ue=a.convert(W.type)),W.format===td&&he===i.DEPTH_COMPONENT&&(he=i.DEPTH_STENCIL,W.type!==Zu&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),W.type=Zu,ue=a.convert(W.type))),dt&&(ct?t.texStorage2D(i.TEXTURE_2D,1,he,Ze.width,Ze.height):t.texImage2D(i.TEXTURE_2D,0,he,Ze.width,Ze.height,0,Dt,ue,null));else if(W.isDataTexture)if(ft.length>0&&ni){ct&&dt&&t.texStorage2D(i.TEXTURE_2D,it,he,ft[0].width,ft[0].height);for(let be=0,Xe=ft.length;be<Xe;be++)qe=ft[be],ct?ce&&t.texSubImage2D(i.TEXTURE_2D,be,0,0,qe.width,qe.height,Dt,ue,qe.data):t.texImage2D(i.TEXTURE_2D,be,he,qe.width,qe.height,0,Dt,ue,qe.data);W.generateMipmaps=!1}else ct?(dt&&t.texStorage2D(i.TEXTURE_2D,it,he,Ze.width,Ze.height),ce&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Ze.width,Ze.height,Dt,ue,Ze.data)):t.texImage2D(i.TEXTURE_2D,0,he,Ze.width,Ze.height,0,Dt,ue,Ze.data);else if(W.isCompressedTexture)if(W.isCompressedArrayTexture){ct&&dt&&t.texStorage3D(i.TEXTURE_2D_ARRAY,it,he,ft[0].width,ft[0].height,Ze.depth);for(let be=0,Xe=ft.length;be<Xe;be++)qe=ft[be],W.format!==Gn?Dt!==null?ct?ce&&t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,be,0,0,0,qe.width,qe.height,Ze.depth,Dt,qe.data,0,0):t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,be,he,qe.width,qe.height,Ze.depth,0,qe.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ct?ce&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,be,0,0,0,qe.width,qe.height,Ze.depth,Dt,ue,qe.data):t.texImage3D(i.TEXTURE_2D_ARRAY,be,he,qe.width,qe.height,Ze.depth,0,Dt,ue,qe.data)}else{ct&&dt&&t.texStorage2D(i.TEXTURE_2D,it,he,ft[0].width,ft[0].height);for(let be=0,Xe=ft.length;be<Xe;be++)qe=ft[be],W.format!==Gn?Dt!==null?ct?ce&&t.compressedTexSubImage2D(i.TEXTURE_2D,be,0,0,qe.width,qe.height,Dt,qe.data):t.compressedTexImage2D(i.TEXTURE_2D,be,he,qe.width,qe.height,0,qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ct?ce&&t.texSubImage2D(i.TEXTURE_2D,be,0,0,qe.width,qe.height,Dt,ue,qe.data):t.texImage2D(i.TEXTURE_2D,be,he,qe.width,qe.height,0,Dt,ue,qe.data)}else if(W.isDataArrayTexture)ct?(dt&&t.texStorage3D(i.TEXTURE_2D_ARRAY,it,he,Ze.width,Ze.height,Ze.depth),ce&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Ze.width,Ze.height,Ze.depth,Dt,ue,Ze.data)):t.texImage3D(i.TEXTURE_2D_ARRAY,0,he,Ze.width,Ze.height,Ze.depth,0,Dt,ue,Ze.data);else if(W.isData3DTexture)ct?(dt&&t.texStorage3D(i.TEXTURE_3D,it,he,Ze.width,Ze.height,Ze.depth),ce&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Ze.width,Ze.height,Ze.depth,Dt,ue,Ze.data)):t.texImage3D(i.TEXTURE_3D,0,he,Ze.width,Ze.height,Ze.depth,0,Dt,ue,Ze.data);else if(W.isFramebufferTexture){if(dt)if(ct)t.texStorage2D(i.TEXTURE_2D,it,he,Ze.width,Ze.height);else{let be=Ze.width,Xe=Ze.height;for(let rt=0;rt<it;rt++)t.texImage2D(i.TEXTURE_2D,rt,he,be,Xe,0,Dt,ue,null),be>>=1,Xe>>=1}}else if(ft.length>0&&ni){if(ct&&dt){let be=xt(ft[0]);t.texStorage2D(i.TEXTURE_2D,it,he,be.width,be.height)}for(let be=0,Xe=ft.length;be<Xe;be++)qe=ft[be],ct?ce&&t.texSubImage2D(i.TEXTURE_2D,be,0,0,Dt,ue,qe):t.texImage2D(i.TEXTURE_2D,be,he,Dt,ue,qe);W.generateMipmaps=!1}else if(ct){if(dt){let be=xt(Ze);t.texStorage2D(i.TEXTURE_2D,it,he,be.width,be.height)}ce&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Dt,ue,Ze)}else t.texImage2D(i.TEXTURE_2D,0,he,Dt,ue,Ze);b(W,ni)&&C(Fe),bt.__version=Be.version,W.onUpdate&&W.onUpdate(W)}ne.__version=W.version}h(Y,"uploadTexture");function oe(ne,W,_e){if(W.image.length!==6)return;let Fe=J(ne,W),Ue=W.source;t.bindTexture(i.TEXTURE_CUBE_MAP,ne.__webglTexture,i.TEXTURE0+_e);let Be=r.get(Ue);if(Ue.version!==Be.__version||Fe===!0){t.activeTexture(i.TEXTURE0+_e);let bt=Ei.getPrimaries(Ei.workingColorSpace),lt=W.colorSpace===bl?null:Ei.getPrimaries(W.colorSpace),Ge=W.colorSpace===bl||bt===lt?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,W.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,W.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ge);let We=W.isCompressedTexture||W.image[0].isCompressedTexture,St=W.image[0]&&W.image[0].isDataTexture,Ze=[];for(let be=0;be<6;be++)!We&&!St?Ze[be]=y(W.image[be],!1,!0,n.maxCubemapSize):Ze[be]=St?W.image[be].image:W.image[be],Ze[be]=Je(W,Ze[be]);let ni=Ze[0],Dt=x(ni)||s,ue=a.convert(W.format,W.colorSpace),he=a.convert(W.type),qe=E(W.internalFormat,ue,he,W.colorSpace),ft=s&&W.isVideoTexture!==!0,ct=Be.__version===void 0||Fe===!0,dt=Ue.dataReady,ce=T(W,ni,Dt);N(i.TEXTURE_CUBE_MAP,W,Dt);let it;if(We){ft&&ct&&t.texStorage2D(i.TEXTURE_CUBE_MAP,ce,qe,ni.width,ni.height);for(let be=0;be<6;be++){it=Ze[be].mipmaps;for(let Xe=0;Xe<it.length;Xe++){let rt=it[Xe];W.format!==Gn?ue!==null?ft?dt&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Xe,0,0,rt.width,rt.height,ue,rt.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Xe,qe,rt.width,rt.height,0,rt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ft?dt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Xe,0,0,rt.width,rt.height,ue,he,rt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Xe,qe,rt.width,rt.height,0,ue,he,rt.data)}}}else{if(it=W.mipmaps,ft&&ct){it.length>0&&ce++;let be=xt(Ze[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,ce,qe,be.width,be.height)}for(let be=0;be<6;be++)if(St){ft?dt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,0,0,Ze[be].width,Ze[be].height,ue,he,Ze[be].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,qe,Ze[be].width,Ze[be].height,0,ue,he,Ze[be].data);for(let Xe=0;Xe<it.length;Xe++){let rt=it[Xe].image[be].image;ft?dt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Xe+1,0,0,rt.width,rt.height,ue,he,rt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Xe+1,qe,rt.width,rt.height,0,ue,he,rt.data)}}else{ft?dt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,0,0,ue,he,Ze[be]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,0,qe,ue,he,Ze[be]);for(let Xe=0;Xe<it.length;Xe++){let rt=it[Xe];ft?dt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Xe+1,0,0,ue,he,rt.image[be]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+be,Xe+1,qe,ue,he,rt.image[be])}}}b(W,Dt)&&C(i.TEXTURE_CUBE_MAP),Be.__version=Ue.version,W.onUpdate&&W.onUpdate(W)}ne.__version=W.version}h(oe,"uploadCubeTexture");function xe(ne,W,_e,Fe,Ue,Be){let bt=a.convert(_e.format,_e.colorSpace),lt=a.convert(_e.type),Ge=E(_e.internalFormat,bt,lt,_e.colorSpace);if(!r.get(W).__hasExternalTextures){let We=Math.max(1,W.width>>Be),St=Math.max(1,W.height>>Be);Ue===i.TEXTURE_3D||Ue===i.TEXTURE_2D_ARRAY?t.texImage3D(Ue,Be,Ge,We,St,W.depth,0,bt,lt,null):t.texImage2D(Ue,Be,Ge,We,St,0,bt,lt,null)}t.bindFramebuffer(i.FRAMEBUFFER,ne),we(W)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Fe,Ue,r.get(_e).__webglTexture,0,ke(W)):(Ue===i.TEXTURE_2D||Ue>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&Ue<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,Fe,Ue,r.get(_e).__webglTexture,Be),t.bindFramebuffer(i.FRAMEBUFFER,null)}h(xe,"setupFrameBufferTexture");function ge(ne,W,_e){if(i.bindRenderbuffer(i.RENDERBUFFER,ne),W.depthBuffer&&!W.stencilBuffer){let Fe=s===!0?i.DEPTH_COMPONENT24:i.DEPTH_COMPONENT16;if(_e||we(W)){let Ue=W.depthTexture;Ue&&Ue.isDepthTexture&&(Ue.type===ca?Fe=i.DEPTH_COMPONENT32F:Ue.type===Tl&&(Fe=i.DEPTH_COMPONENT24));let Be=ke(W);we(W)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Be,Fe,W.width,W.height):i.renderbufferStorageMultisample(i.RENDERBUFFER,Be,Fe,W.width,W.height)}else i.renderbufferStorage(i.RENDERBUFFER,Fe,W.width,W.height);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,ne)}else if(W.depthBuffer&&W.stencilBuffer){let Fe=ke(W);_e&&we(W)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,Fe,i.DEPTH24_STENCIL8,W.width,W.height):we(W)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,Fe,i.DEPTH24_STENCIL8,W.width,W.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,W.width,W.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,ne)}else{let Fe=W.textures;for(let Ue=0;Ue<Fe.length;Ue++){let Be=Fe[Ue],bt=a.convert(Be.format,Be.colorSpace),lt=a.convert(Be.type),Ge=E(Be.internalFormat,bt,lt,Be.colorSpace),We=ke(W);_e&&we(W)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,We,Ge,W.width,W.height):we(W)?l.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,We,Ge,W.width,W.height):i.renderbufferStorage(i.RENDERBUFFER,Ge,W.width,W.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}h(ge,"setupRenderBufferStorage");function Te(ne,W){if(W&&W.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,ne),!(W.depthTexture&&W.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(W.depthTexture).__webglTexture||W.depthTexture.image.width!==W.width||W.depthTexture.image.height!==W.height)&&(W.depthTexture.image.width=W.width,W.depthTexture.image.height=W.height,W.depthTexture.needsUpdate=!0),K(W.depthTexture,0);let _e=r.get(W.depthTexture).__webglTexture,Fe=ke(W);if(W.depthTexture.format===Yu)we(W)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,_e,0,Fe):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,_e,0);else if(W.depthTexture.format===td)we(W)?l.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,_e,0,Fe):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,_e,0);else throw new Error("Unknown depthTexture format")}h(Te,"setupDepthTexture");function me(ne){let W=r.get(ne),_e=ne.isWebGLCubeRenderTarget===!0;if(ne.depthTexture&&!W.__autoAllocateDepthBuffer){if(_e)throw new Error("target.depthTexture not supported in Cube render targets");Te(W.__webglFramebuffer,ne)}else if(_e){W.__webglDepthbuffer=[];for(let Fe=0;Fe<6;Fe++)t.bindFramebuffer(i.FRAMEBUFFER,W.__webglFramebuffer[Fe]),W.__webglDepthbuffer[Fe]=i.createRenderbuffer(),ge(W.__webglDepthbuffer[Fe],ne,!1)}else t.bindFramebuffer(i.FRAMEBUFFER,W.__webglFramebuffer),W.__webglDepthbuffer=i.createRenderbuffer(),ge(W.__webglDepthbuffer,ne,!1);t.bindFramebuffer(i.FRAMEBUFFER,null)}h(me,"setupDepthRenderbuffer");function Q(ne,W,_e){let Fe=r.get(ne);W!==void 0&&xe(Fe.__webglFramebuffer,ne,ne.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),_e!==void 0&&me(ne)}h(Q,"rebindTextures");function Me(ne){let W=ne.texture,_e=r.get(ne),Fe=r.get(W);ne.addEventListener("dispose",B);let Ue=ne.textures,Be=ne.isWebGLCubeRenderTarget===!0,bt=Ue.length>1,lt=x(ne)||s;if(bt||(Fe.__webglTexture===void 0&&(Fe.__webglTexture=i.createTexture()),Fe.__version=W.version,o.memory.textures++),Be){_e.__webglFramebuffer=[];for(let Ge=0;Ge<6;Ge++)if(s&&W.mipmaps&&W.mipmaps.length>0){_e.__webglFramebuffer[Ge]=[];for(let We=0;We<W.mipmaps.length;We++)_e.__webglFramebuffer[Ge][We]=i.createFramebuffer()}else _e.__webglFramebuffer[Ge]=i.createFramebuffer()}else{if(s&&W.mipmaps&&W.mipmaps.length>0){_e.__webglFramebuffer=[];for(let Ge=0;Ge<W.mipmaps.length;Ge++)_e.__webglFramebuffer[Ge]=i.createFramebuffer()}else _e.__webglFramebuffer=i.createFramebuffer();if(bt)if(n.drawBuffers)for(let Ge=0,We=Ue.length;Ge<We;Ge++){let St=r.get(Ue[Ge]);St.__webglTexture===void 0&&(St.__webglTexture=i.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(s&&ne.samples>0&&we(ne)===!1){_e.__webglMultisampledFramebuffer=i.createFramebuffer(),_e.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,_e.__webglMultisampledFramebuffer);for(let Ge=0;Ge<Ue.length;Ge++){let We=Ue[Ge];_e.__webglColorRenderbuffer[Ge]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,_e.__webglColorRenderbuffer[Ge]);let St=a.convert(We.format,We.colorSpace),Ze=a.convert(We.type),ni=E(We.internalFormat,St,Ze,We.colorSpace,ne.isXRRenderTarget===!0),Dt=ke(ne);i.renderbufferStorageMultisample(i.RENDERBUFFER,Dt,ni,ne.width,ne.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ge,i.RENDERBUFFER,_e.__webglColorRenderbuffer[Ge])}i.bindRenderbuffer(i.RENDERBUFFER,null),ne.depthBuffer&&(_e.__webglDepthRenderbuffer=i.createRenderbuffer(),ge(_e.__webglDepthRenderbuffer,ne,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Be){t.bindTexture(i.TEXTURE_CUBE_MAP,Fe.__webglTexture),N(i.TEXTURE_CUBE_MAP,W,lt);for(let Ge=0;Ge<6;Ge++)if(s&&W.mipmaps&&W.mipmaps.length>0)for(let We=0;We<W.mipmaps.length;We++)xe(_e.__webglFramebuffer[Ge][We],ne,W,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,We);else xe(_e.__webglFramebuffer[Ge],ne,W,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0);b(W,lt)&&C(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(bt){for(let Ge=0,We=Ue.length;Ge<We;Ge++){let St=Ue[Ge],Ze=r.get(St);t.bindTexture(i.TEXTURE_2D,Ze.__webglTexture),N(i.TEXTURE_2D,St,lt),xe(_e.__webglFramebuffer,ne,St,i.COLOR_ATTACHMENT0+Ge,i.TEXTURE_2D,0),b(St,lt)&&C(i.TEXTURE_2D)}t.unbindTexture()}else{let Ge=i.TEXTURE_2D;if((ne.isWebGL3DRenderTarget||ne.isWebGLArrayRenderTarget)&&(s?Ge=ne.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ge,Fe.__webglTexture),N(Ge,W,lt),s&&W.mipmaps&&W.mipmaps.length>0)for(let We=0;We<W.mipmaps.length;We++)xe(_e.__webglFramebuffer[We],ne,W,i.COLOR_ATTACHMENT0,Ge,We);else xe(_e.__webglFramebuffer,ne,W,i.COLOR_ATTACHMENT0,Ge,0);b(W,lt)&&C(Ge),t.unbindTexture()}ne.depthBuffer&&me(ne)}h(Me,"setupRenderTarget");function ve(ne){let W=x(ne)||s,_e=ne.textures;for(let Fe=0,Ue=_e.length;Fe<Ue;Fe++){let Be=_e[Fe];if(b(Be,W)){let bt=ne.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D,lt=r.get(Be).__webglTexture;t.bindTexture(bt,lt),C(bt),t.unbindTexture()}}}h(ve,"updateRenderTargetMipmap");function Ie(ne){if(s&&ne.samples>0&&we(ne)===!1){let W=ne.textures,_e=ne.width,Fe=ne.height,Ue=i.COLOR_BUFFER_BIT,Be=[],bt=ne.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,lt=r.get(ne),Ge=W.length>1;if(Ge)for(let We=0;We<W.length;We++)t.bindFramebuffer(i.FRAMEBUFFER,lt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+We,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,lt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+We,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,lt.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,lt.__webglFramebuffer);for(let We=0;We<W.length;We++){Be.push(i.COLOR_ATTACHMENT0+We),ne.depthBuffer&&Be.push(bt);let St=lt.__ignoreDepthValues!==void 0?lt.__ignoreDepthValues:!1;if(St===!1&&(ne.depthBuffer&&(Ue|=i.DEPTH_BUFFER_BIT),ne.stencilBuffer&&(Ue|=i.STENCIL_BUFFER_BIT)),Ge&&i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,lt.__webglColorRenderbuffer[We]),St===!0&&(i.invalidateFramebuffer(i.READ_FRAMEBUFFER,[bt]),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[bt])),Ge){let Ze=r.get(W[We]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Ze,0)}i.blitFramebuffer(0,0,_e,Fe,0,0,_e,Fe,Ue,i.NEAREST),u&&i.invalidateFramebuffer(i.READ_FRAMEBUFFER,Be)}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Ge)for(let We=0;We<W.length;We++){t.bindFramebuffer(i.FRAMEBUFFER,lt.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+We,i.RENDERBUFFER,lt.__webglColorRenderbuffer[We]);let St=r.get(W[We]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,lt.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+We,i.TEXTURE_2D,St,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,lt.__webglMultisampledFramebuffer)}}h(Ie,"updateMultisampleRenderTarget");function ke(ne){return Math.min(n.maxSamples,ne.samples)}h(ke,"getRenderTargetSamples");function we(ne){let W=r.get(ne);return s&&ne.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&W.__useRenderToTexture!==!1}h(we,"useMultisampledRTT");function Oe(ne){let W=o.render.frame;p.get(ne)!==W&&(p.set(ne,W),ne.update())}h(Oe,"updateVideoTexture");function Je(ne,W){let _e=ne.colorSpace,Fe=ne.format,Ue=ne.type;return ne.isCompressedTexture===!0||ne.isVideoTexture===!0||ne.format===yS||_e!==tu&&_e!==bl&&(Ei.getTransfer(_e)===Fi?s===!1?e.has("EXT_sRGB")===!0&&Fe===Gn?(ne.format=yS,ne.minFilter=$n,ne.generateMipmaps=!1):W=mX.sRGBToLinear(W):(Fe!==Gn||Ue!==Ul)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",_e)),W}h(Je,"verifyColorSpace");function xt(ne){return typeof HTMLImageElement<"u"&&ne instanceof HTMLImageElement?(c.width=ne.naturalWidth||ne.width,c.height=ne.naturalHeight||ne.height):typeof VideoFrame<"u"&&ne instanceof VideoFrame?(c.width=ne.displayWidth,c.height=ne.displayHeight):(c.width=ne.width,c.height=ne.height),c}h(xt,"getDimensions"),this.allocateTextureUnit=U,this.resetTextureUnits=P,this.setTexture2D=K,this.setTexture2DArray=O,this.setTexture3D=V,this.setTextureCube=j,this.rebindTextures=Q,this.setupRenderTarget=Me,this.updateRenderTargetMipmap=ve,this.updateMultisampleRenderTarget=Ie,this.setupDepthRenderbuffer=me,this.setupFrameBufferTexture=xe,this.useMultisampledRTT=we}h(lY,"WebGLTextures");function uY(i,e,t){let r=t.isWebGL2;function n(a,o=bl){let s,l=Ei.getTransfer(o);if(a===Ul)return i.UNSIGNED_BYTE;if(a===$W)return i.UNSIGNED_SHORT_4_4_4_4;if(a===UW)return i.UNSIGNED_SHORT_5_5_5_1;if(a===d0e)return i.BYTE;if(a===f0e)return i.SHORT;if(a===bT)return i.UNSIGNED_SHORT;if(a===NW)return i.INT;if(a===Tl)return i.UNSIGNED_INT;if(a===ca)return i.FLOAT;if(a===Jm)return r?i.HALF_FLOAT:(s=e.get("OES_texture_half_float"),s!==null?s.HALF_FLOAT_OES:null);if(a===m0e)return i.ALPHA;if(a===Gn)return i.RGBA;if(a===g0e)return i.LUMINANCE;if(a===y0e)return i.LUMINANCE_ALPHA;if(a===Yu)return i.DEPTH_COMPONENT;if(a===td)return i.DEPTH_STENCIL;if(a===yS)return s=e.get("EXT_sRGB"),s!==null?s.SRGB_ALPHA_EXT:null;if(a===VW)return i.RED;if(a===jW)return i.RED_INTEGER;if(a===v0e)return i.RG;if(a===HW)return i.RG_INTEGER;if(a===GW)return i.RGBA_INTEGER;if(a===H2||a===G2||a===W2||a===X2)if(l===Fi)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(a===H2)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===G2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===W2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===X2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(a===H2)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===G2)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===W2)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===X2)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===W6||a===X6||a===q6||a===Z6)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(a===W6)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===X6)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===q6)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===Z6)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===WW)return s=e.get("WEBGL_compressed_texture_etc1"),s!==null?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===Y6||a===J6)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(a===Y6)return l===Fi?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(a===J6)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===K6||a===Q6||a===eI||a===tI||a===iI||a===rI||a===nI||a===aI||a===oI||a===sI||a===lI||a===uI||a===hI||a===cI)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(a===K6)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===Q6)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===eI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===tI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===iI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===rI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===nI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===aI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===oI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===sI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===lI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===uI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===hI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===cI)return l===Fi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===q2||a===pI||a===dI)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(a===q2)return l===Fi?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(a===pI)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(a===dI)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(a===x0e||a===fI||a===mI||a===gI)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(a===q2)return s.COMPRESSED_RED_RGTC1_EXT;if(a===fI)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(a===mI)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(a===gI)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return a===Zu?r?i.UNSIGNED_INT_24_8:(s=e.get("WEBGL_depth_texture"),s!==null?s.UNSIGNED_INT_24_8_WEBGL:null):i[a]!==void 0?i[a]:null}return h(n,"convert"),{convert:n}}h(uY,"WebGLUtils");var hY=class extends jn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}};h(hY,"ArrayCamera");var K_e=hY,cY=class extends or{constructor(){super(),this.isGroup=!0,this.type="Group"}};h(cY,"Group");var $1=cY,Q_e={type:"move"},pY=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new $1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new $1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new le,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new le),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new $1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new le,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new le),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let n=null,a=null,o=null,s=this._targetRay,l=this._grip,u=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(u&&e.hand){o=!0;for(let _ of e.hand.values()){let y=t.getJointPose(_,r),x=this._getHandJoint(u,_);y!==null&&(x.matrix.fromArray(y.transform.matrix),x.matrix.decompose(x.position,x.rotation,x.scale),x.matrixWorldNeedsUpdate=!0,x.jointRadius=y.radius),x.visible=y!==null}let c=u.joints["index-finger-tip"],p=u.joints["thumb-tip"],d=c.position.distanceTo(p.position),m=.02,g=.005;u.inputState.pinching&&d>m+g?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&d<=m-g&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(a=t.getPose(e.gripSpace,r),a!==null&&(l.matrix.fromArray(a.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,a.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(a.linearVelocity)):l.hasLinearVelocity=!1,a.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(a.angularVelocity)):l.hasAngularVelocity=!1));s!==null&&(n=t.getPose(e.targetRaySpace,r),n===null&&a!==null&&(n=a),n!==null&&(s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,n.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(n.linearVelocity)):s.hasLinearVelocity=!1,n.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(n.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Q_e)))}return s!==null&&(s.visible=n!==null),l!==null&&(l.visible=a!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let r=new $1;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}};h(pY,"WebXRController");var gb=pY,e2e=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,t2e=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,dY=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){let n=new Ln,a=e.properties.get(n);a.__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=n}}render(e,t){if(this.texture!==null){if(this.mesh===null){let r=t.cameras[0].viewport,n=new Eo({extensions:{fragDepth:!0},vertexShader:e2e,fragmentShader:t2e,uniforms:{depthColor:{value:this.texture},depthWidth:{value:r.z},depthHeight:{value:r.w}}});this.mesh=new Zi(new Ag(20,20),n)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}};h(dY,"WebXRDepthSensing");var i2e=dY,fY=class extends bd{constructor(e,t){super();let r=this,n=null,a=1,o=null,s="local-floor",l=1,u=null,c=null,p=null,d=null,m=null,g=null,_=new i2e,y=t.getContextAttributes(),x=null,w=null,b=[],C=[],E=new Ne,T=null,L=new jn;L.layers.enable(1),L.viewport=new Ai;let D=new jn;D.layers.enable(2),D.viewport=new Ai;let B=[L,D],A=new K_e;A.layers.enable(1),A.layers.enable(2);let k=null,$=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(N){let J=b[N];return J===void 0&&(J=new gb,b[N]=J),J.getTargetRaySpace()},this.getControllerGrip=function(N){let J=b[N];return J===void 0&&(J=new gb,b[N]=J),J.getGripSpace()},this.getHand=function(N){let J=b[N];return J===void 0&&(J=new gb,b[N]=J),J.getHandSpace()};function z(N){let J=C.indexOf(N.inputSource);if(J===-1)return;let Y=b[J];Y!==void 0&&(Y.update(N.inputSource,N.frame,u||o),Y.dispatchEvent({type:N.type,data:N.inputSource}))}h(z,"onSessionEvent");function P(){n.removeEventListener("select",z),n.removeEventListener("selectstart",z),n.removeEventListener("selectend",z),n.removeEventListener("squeeze",z),n.removeEventListener("squeezestart",z),n.removeEventListener("squeezeend",z),n.removeEventListener("end",P),n.removeEventListener("inputsourceschange",U);for(let N=0;N<b.length;N++){let J=C[N];J!==null&&(C[N]=null,b[N].disconnect(J))}k=null,$=null,_.reset(),e.setRenderTarget(x),m=null,d=null,p=null,n=null,w=null,ae.stop(),r.isPresenting=!1,e.setPixelRatio(T),e.setSize(E.width,E.height,!1),r.dispatchEvent({type:"sessionend"})}h(P,"onSessionEnd"),this.setFramebufferScaleFactor=function(N){a=N,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(N){s=N,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(N){u=N},this.getBaseLayer=function(){return d!==null?d:m},this.getBinding=function(){return p},this.getFrame=function(){return g},this.getSession=function(){return n},this.setSession=async function(N){if(n=N,n!==null){if(x=e.getRenderTarget(),n.addEventListener("select",z),n.addEventListener("selectstart",z),n.addEventListener("selectend",z),n.addEventListener("squeeze",z),n.addEventListener("squeezestart",z),n.addEventListener("squeezeend",z),n.addEventListener("end",P),n.addEventListener("inputsourceschange",U),y.xrCompatible!==!0&&await t.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(E),n.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let J={antialias:n.renderState.layers===void 0?y.antialias:!0,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:a};m=new XRWebGLLayer(n,t,J),n.updateRenderState({baseLayer:m}),e.setPixelRatio(1),e.setSize(m.framebufferWidth,m.framebufferHeight,!1),w=new dh(m.framebufferWidth,m.framebufferHeight,{format:Gn,type:Ul,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil})}else{let J=null,Y=null,oe=null;y.depth&&(oe=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,J=y.stencil?td:Yu,Y=y.stencil?Zu:Tl);let xe={colorFormat:t.RGBA8,depthFormat:oe,scaleFactor:a};p=new XRWebGLBinding(n,t),d=p.createProjectionLayer(xe),n.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),w=new dh(d.textureWidth,d.textureHeight,{format:Gn,type:Ul,depthTexture:new Rq(d.textureWidth,d.textureHeight,Y,void 0,void 0,void 0,void 0,void 0,void 0,J),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0});let ge=e.properties.get(w);ge.__ignoreDepthValues=d.ignoreDepthValues}w.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await n.requestReferenceSpace(s),ae.setContext(n),ae.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(n!==null)return n.environmentBlendMode};function U(N){for(let J=0;J<N.removed.length;J++){let Y=N.removed[J],oe=C.indexOf(Y);oe>=0&&(C[oe]=null,b[oe].disconnect(Y))}for(let J=0;J<N.added.length;J++){let Y=N.added[J],oe=C.indexOf(Y);if(oe===-1){for(let ge=0;ge<b.length;ge++)if(ge>=C.length){C.push(Y),oe=ge;break}else if(C[ge]===null){C[ge]=Y,oe=ge;break}if(oe===-1)break}let xe=b[oe];xe&&xe.connect(Y)}}h(U,"onInputSourcesChange");let G=new le,K=new le;function O(N,J,Y){G.setFromMatrixPosition(J.matrixWorld),K.setFromMatrixPosition(Y.matrixWorld);let oe=G.distanceTo(K),xe=J.projectionMatrix.elements,ge=Y.projectionMatrix.elements,Te=xe[14]/(xe[10]-1),me=xe[14]/(xe[10]+1),Q=(xe[9]+1)/xe[5],Me=(xe[9]-1)/xe[5],ve=(xe[8]-1)/xe[0],Ie=(ge[8]+1)/ge[0],ke=Te*ve,we=Te*Ie,Oe=oe/(-ve+Ie),Je=Oe*-ve;J.matrixWorld.decompose(N.position,N.quaternion,N.scale),N.translateX(Je),N.translateZ(Oe),N.matrixWorld.compose(N.position,N.quaternion,N.scale),N.matrixWorldInverse.copy(N.matrixWorld).invert();let xt=Te+Oe,ne=me+Oe,W=ke-Je,_e=we+(oe-Je),Fe=Q*me/ne*xt,Ue=Me*me/ne*xt;N.projectionMatrix.makePerspective(W,_e,Fe,Ue,xt,ne),N.projectionMatrixInverse.copy(N.projectionMatrix).invert()}h(O,"setProjectionFromUnion");function V(N,J){J===null?N.matrixWorld.copy(N.matrix):N.matrixWorld.multiplyMatrices(J.matrixWorld,N.matrix),N.matrixWorldInverse.copy(N.matrixWorld).invert()}h(V,"updateCamera"),this.updateCamera=function(N){if(n===null)return;_.texture!==null&&(N.near=_.depthNear,N.far=_.depthFar),A.near=D.near=L.near=N.near,A.far=D.far=L.far=N.far,(k!==A.near||$!==A.far)&&(n.updateRenderState({depthNear:A.near,depthFar:A.far}),k=A.near,$=A.far,L.near=k,L.far=$,D.near=k,D.far=$,L.updateProjectionMatrix(),D.updateProjectionMatrix(),N.updateProjectionMatrix());let J=N.parent,Y=A.cameras;V(A,J);for(let oe=0;oe<Y.length;oe++)V(Y[oe],J);Y.length===2?O(A,L,D):A.projectionMatrix.copy(L.projectionMatrix),j(N,A,J)};function j(N,J,Y){Y===null?N.matrix.copy(J.matrixWorld):(N.matrix.copy(Y.matrixWorld),N.matrix.invert(),N.matrix.multiply(J.matrixWorld)),N.matrix.decompose(N.position,N.quaternion,N.scale),N.updateMatrixWorld(!0),N.projectionMatrix.copy(J.projectionMatrix),N.projectionMatrixInverse.copy(J.projectionMatrixInverse),N.isPerspectiveCamera&&(N.fov=id*2*Math.atan(1/N.projectionMatrix.elements[5]),N.zoom=1)}h(j,"updateUserCamera"),this.getCamera=function(){return A},this.getFoveation=function(){if(!(d===null&&m===null))return l},this.setFoveation=function(N){l=N,d!==null&&(d.fixedFoveation=N),m!==null&&m.fixedFoveation!==void 0&&(m.fixedFoveation=N)},this.hasDepthSensing=function(){return _.texture!==null};let q=null;function ee(N,J){if(c=J.getViewerPose(u||o),g=J,c!==null){let Y=c.views;m!==null&&(e.setRenderTargetFramebuffer(w,m.framebuffer),e.setRenderTarget(w));let oe=!1;Y.length!==A.cameras.length&&(A.cameras.length=0,oe=!0);for(let ge=0;ge<Y.length;ge++){let Te=Y[ge],me=null;if(m!==null)me=m.getViewport(Te);else{let Me=p.getViewSubImage(d,Te);me=Me.viewport,ge===0&&(e.setRenderTargetTextures(w,Me.colorTexture,d.ignoreDepthValues?void 0:Me.depthStencilTexture),e.setRenderTarget(w))}let Q=B[ge];Q===void 0&&(Q=new jn,Q.layers.enable(ge),Q.viewport=new Ai,B[ge]=Q),Q.matrix.fromArray(Te.transform.matrix),Q.matrix.decompose(Q.position,Q.quaternion,Q.scale),Q.projectionMatrix.fromArray(Te.projectionMatrix),Q.projectionMatrixInverse.copy(Q.projectionMatrix).invert(),Q.viewport.set(me.x,me.y,me.width,me.height),ge===0&&(A.matrix.copy(Q.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),oe===!0&&A.cameras.push(Q)}let xe=n.enabledFeatures;if(xe&&xe.includes("depth-sensing")){let ge=p.getDepthInformation(Y[0]);ge&&ge.isValid&&ge.texture&&_.init(e,ge,n.renderState)}}for(let Y=0;Y<b.length;Y++){let oe=C[Y],xe=b[Y];oe!==null&&xe!==void 0&&xe.update(oe,J,u||o)}_.render(e,A),q&&q(N,J),J.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:J}),g=null}h(ee,"onAnimationFrame");let ae=new AT;ae.setAnimationLoop(ee),this.setAnimationLoop=function(N){q=N},this.dispose=function(){}}};h(fY,"WebXRManager");var r2e=fY,cu=new Xa,n2e=new Gt;function mY(i,e){function t(y,x){y.matrixAutoUpdate===!0&&y.updateMatrix(),x.value.copy(y.matrix)}h(t,"refreshTransformUniform");function r(y,x){x.color.getRGB(y.fogColor.value,TT(i)),x.isFog?(y.fogNear.value=x.near,y.fogFar.value=x.far):x.isFogExp2&&(y.fogDensity.value=x.density)}h(r,"refreshFogUniforms");function n(y,x,w,b,C){x.isMeshBasicMaterial||x.isMeshLambertMaterial?a(y,x):x.isMeshToonMaterial?(a(y,x),p(y,x)):x.isMeshPhongMaterial?(a(y,x),c(y,x)):x.isMeshStandardMaterial?(a(y,x),d(y,x),x.isMeshPhysicalMaterial&&m(y,x,C)):x.isMeshMatcapMaterial?(a(y,x),g(y,x)):x.isMeshDepthMaterial?a(y,x):x.isMeshDistanceMaterial?(a(y,x),_(y,x)):x.isMeshNormalMaterial?a(y,x):x.isLineBasicMaterial?(o(y,x),x.isLineDashedMaterial&&s(y,x)):x.isPointsMaterial?l(y,x,w,b):x.isSpriteMaterial?u(y,x):x.isShadowMaterial?(y.color.value.copy(x.color),y.opacity.value=x.opacity):x.isShaderMaterial&&(x.uniformsNeedUpdate=!1)}h(n,"refreshMaterialUniforms");function a(y,x){y.opacity.value=x.opacity,x.color&&y.diffuse.value.copy(x.color),x.emissive&&y.emissive.value.copy(x.emissive).multiplyScalar(x.emissiveIntensity),x.map&&(y.map.value=x.map,t(x.map,y.mapTransform)),x.alphaMap&&(y.alphaMap.value=x.alphaMap,t(x.alphaMap,y.alphaMapTransform)),x.bumpMap&&(y.bumpMap.value=x.bumpMap,t(x.bumpMap,y.bumpMapTransform),y.bumpScale.value=x.bumpScale,x.side===Qn&&(y.bumpScale.value*=-1)),x.normalMap&&(y.normalMap.value=x.normalMap,t(x.normalMap,y.normalMapTransform),y.normalScale.value.copy(x.normalScale),x.side===Qn&&y.normalScale.value.negate()),x.displacementMap&&(y.displacementMap.value=x.displacementMap,t(x.displacementMap,y.displacementMapTransform),y.displacementScale.value=x.displacementScale,y.displacementBias.value=x.displacementBias),x.emissiveMap&&(y.emissiveMap.value=x.emissiveMap,t(x.emissiveMap,y.emissiveMapTransform)),x.specularMap&&(y.specularMap.value=x.specularMap,t(x.specularMap,y.specularMapTransform)),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest);let w=e.get(x),b=w.envMap,C=w.envMapRotation;if(b&&(y.envMap.value=b,cu.copy(C),cu.x*=-1,cu.y*=-1,cu.z*=-1,b.isCubeTexture&&b.isRenderTargetTexture===!1&&(cu.y*=-1,cu.z*=-1),y.envMapRotation.value.setFromMatrix4(n2e.makeRotationFromEuler(cu)),y.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=x.reflectivity,y.ior.value=x.ior,y.refractionRatio.value=x.refractionRatio),x.lightMap){y.lightMap.value=x.lightMap;let E=i._useLegacyLights===!0?Math.PI:1;y.lightMapIntensity.value=x.lightMapIntensity*E,t(x.lightMap,y.lightMapTransform)}x.aoMap&&(y.aoMap.value=x.aoMap,y.aoMapIntensity.value=x.aoMapIntensity,t(x.aoMap,y.aoMapTransform))}h(a,"refreshUniformsCommon");function o(y,x){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity,x.map&&(y.map.value=x.map,t(x.map,y.mapTransform))}h(o,"refreshUniformsLine");function s(y,x){y.dashSize.value=x.dashSize,y.totalSize.value=x.dashSize+x.gapSize,y.scale.value=x.scale}h(s,"refreshUniformsDash");function l(y,x,w,b){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity,y.size.value=x.size*w,y.scale.value=b*.5,x.map&&(y.map.value=x.map,t(x.map,y.uvTransform)),x.alphaMap&&(y.alphaMap.value=x.alphaMap,t(x.alphaMap,y.alphaMapTransform)),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest)}h(l,"refreshUniformsPoints");function u(y,x){y.diffuse.value.copy(x.color),y.opacity.value=x.opacity,y.rotation.value=x.rotation,x.map&&(y.map.value=x.map,t(x.map,y.mapTransform)),x.alphaMap&&(y.alphaMap.value=x.alphaMap,t(x.alphaMap,y.alphaMapTransform)),x.alphaTest>0&&(y.alphaTest.value=x.alphaTest)}h(u,"refreshUniformsSprites");function c(y,x){y.specular.value.copy(x.specular),y.shininess.value=Math.max(x.shininess,1e-4)}h(c,"refreshUniformsPhong");function p(y,x){x.gradientMap&&(y.gradientMap.value=x.gradientMap)}h(p,"refreshUniformsToon");function d(y,x){y.metalness.value=x.metalness,x.metalnessMap&&(y.metalnessMap.value=x.metalnessMap,t(x.metalnessMap,y.metalnessMapTransform)),y.roughness.value=x.roughness,x.roughnessMap&&(y.roughnessMap.value=x.roughnessMap,t(x.roughnessMap,y.roughnessMapTransform)),e.get(x).envMap&&(y.envMapIntensity.value=x.envMapIntensity)}h(d,"refreshUniformsStandard");function m(y,x,w){y.ior.value=x.ior,x.sheen>0&&(y.sheenColor.value.copy(x.sheenColor).multiplyScalar(x.sheen),y.sheenRoughness.value=x.sheenRoughness,x.sheenColorMap&&(y.sheenColorMap.value=x.sheenColorMap,t(x.sheenColorMap,y.sheenColorMapTransform)),x.sheenRoughnessMap&&(y.sheenRoughnessMap.value=x.sheenRoughnessMap,t(x.sheenRoughnessMap,y.sheenRoughnessMapTransform))),x.clearcoat>0&&(y.clearcoat.value=x.clearcoat,y.clearcoatRoughness.value=x.clearcoatRoughness,x.clearcoatMap&&(y.clearcoatMap.value=x.clearcoatMap,t(x.clearcoatMap,y.clearcoatMapTransform)),x.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=x.clearcoatRoughnessMap,t(x.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),x.clearcoatNormalMap&&(y.clearcoatNormalMap.value=x.clearcoatNormalMap,t(x.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(x.clearcoatNormalScale),x.side===Qn&&y.clearcoatNormalScale.value.negate())),x.iridescence>0&&(y.iridescence.value=x.iridescence,y.iridescenceIOR.value=x.iridescenceIOR,y.iridescenceThicknessMinimum.value=x.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=x.iridescenceThicknessRange[1],x.iridescenceMap&&(y.iridescenceMap.value=x.iridescenceMap,t(x.iridescenceMap,y.iridescenceMapTransform)),x.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=x.iridescenceThicknessMap,t(x.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),x.transmission>0&&(y.transmission.value=x.transmission,y.transmissionSamplerMap.value=w.texture,y.transmissionSamplerSize.value.set(w.width,w.height),x.transmissionMap&&(y.transmissionMap.value=x.transmissionMap,t(x.transmissionMap,y.transmissionMapTransform)),y.thickness.value=x.thickness,x.thicknessMap&&(y.thicknessMap.value=x.thicknessMap,t(x.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=x.attenuationDistance,y.attenuationColor.value.copy(x.attenuationColor)),x.anisotropy>0&&(y.anisotropyVector.value.set(x.anisotropy*Math.cos(x.anisotropyRotation),x.anisotropy*Math.sin(x.anisotropyRotation)),x.anisotropyMap&&(y.anisotropyMap.value=x.anisotropyMap,t(x.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=x.specularIntensity,y.specularColor.value.copy(x.specularColor),x.specularColorMap&&(y.specularColorMap.value=x.specularColorMap,t(x.specularColorMap,y.specularColorMapTransform)),x.specularIntensityMap&&(y.specularIntensityMap.value=x.specularIntensityMap,t(x.specularIntensityMap,y.specularIntensityMapTransform))}h(m,"refreshUniformsPhysical");function g(y,x){x.matcap&&(y.matcap.value=x.matcap)}h(g,"refreshUniformsMatcap");function _(y,x){let w=e.get(x).light;y.referencePosition.value.setFromMatrixPosition(w.matrixWorld),y.nearDistance.value=w.shadow.camera.near,y.farDistance.value=w.shadow.camera.far}return h(_,"refreshUniformsDistance"),{refreshFogUniforms:r,refreshMaterialUniforms:n}}h(mY,"WebGLMaterials");function gY(i,e,t,r){let n={},a={},o=[],s=t.isWebGL2?i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(w,b){let C=b.program;r.uniformBlockBinding(w,C)}h(l,"bind");function u(w,b){let C=n[w.id];C===void 0&&(g(w),C=c(w),n[w.id]=C,w.addEventListener("dispose",y));let E=b.program;r.updateUBOMapping(w,E);let T=e.render.frame;a[w.id]!==T&&(d(w),a[w.id]=T)}h(u,"update");function c(w){let b=p();w.__bindingPointIndex=b;let C=i.createBuffer(),E=w.__size,T=w.usage;return i.bindBuffer(i.UNIFORM_BUFFER,C),i.bufferData(i.UNIFORM_BUFFER,E,T),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,b,C),C}h(c,"createBuffer");function p(){for(let w=0;w<s;w++)if(o.indexOf(w)===-1)return o.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}h(p,"allocateBindingPointIndex");function d(w){let b=n[w.id],C=w.uniforms,E=w.__cache;i.bindBuffer(i.UNIFORM_BUFFER,b);for(let T=0,L=C.length;T<L;T++){let D=Array.isArray(C[T])?C[T]:[C[T]];for(let B=0,A=D.length;B<A;B++){let k=D[B];if(m(k,T,B,E)===!0){let $=k.__offset,z=Array.isArray(k.value)?k.value:[k.value],P=0;for(let U=0;U<z.length;U++){let G=z[U],K=_(G);typeof G=="number"||typeof G=="boolean"?(k.__data[0]=G,i.bufferSubData(i.UNIFORM_BUFFER,$+P,k.__data)):G.isMatrix3?(k.__data[0]=G.elements[0],k.__data[1]=G.elements[1],k.__data[2]=G.elements[2],k.__data[3]=0,k.__data[4]=G.elements[3],k.__data[5]=G.elements[4],k.__data[6]=G.elements[5],k.__data[7]=0,k.__data[8]=G.elements[6],k.__data[9]=G.elements[7],k.__data[10]=G.elements[8],k.__data[11]=0):(G.toArray(k.__data,P),P+=K.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,$,k.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}h(d,"updateBufferData");function m(w,b,C,E){let T=w.value,L=b+"_"+C;if(E[L]===void 0)return typeof T=="number"||typeof T=="boolean"?E[L]=T:E[L]=T.clone(),!0;{let D=E[L];if(typeof T=="number"||typeof T=="boolean"){if(D!==T)return E[L]=T,!0}else if(D.equals(T)===!1)return D.copy(T),!0}return!1}h(m,"hasUniformChanged");function g(w){let b=w.uniforms,C=0,E=16;for(let L=0,D=b.length;L<D;L++){let B=Array.isArray(b[L])?b[L]:[b[L]];for(let A=0,k=B.length;A<k;A++){let $=B[A],z=Array.isArray($.value)?$.value:[$.value];for(let P=0,U=z.length;P<U;P++){let G=z[P],K=_(G),O=C%E;O!==0&&E-O<K.boundary&&(C+=E-O),$.__data=new Float32Array(K.storage/Float32Array.BYTES_PER_ELEMENT),$.__offset=C,C+=K.storage}}}let T=C%E;return T>0&&(C+=E-T),w.__size=C,w.__cache={},this}h(g,"prepareUniformsGroup");function _(w){let b={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(b.boundary=4,b.storage=4):w.isVector2?(b.boundary=8,b.storage=8):w.isVector3||w.isColor?(b.boundary=16,b.storage=12):w.isVector4?(b.boundary=16,b.storage=16):w.isMatrix3?(b.boundary=48,b.storage=48):w.isMatrix4?(b.boundary=64,b.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),b}h(_,"getUniformSize");function y(w){let b=w.target;b.removeEventListener("dispose",y);let C=o.indexOf(b.__bindingPointIndex);o.splice(C,1),i.deleteBuffer(n[b.id]),delete n[b.id],delete a[b.id]}h(y,"onUniformsGroupsDispose");function x(){for(let w in n)i.deleteBuffer(n[w]);o=[],n={},a={}}return h(x,"dispose"),{bind:l,update:u,dispose:x}}h(gY,"WebGLUniformsGroups");var yY=class{constructor(e={}){let{canvas:t=dX(),context:r=null,depth:n=!0,stencil:a=!0,alpha:o=!1,antialias:s=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:c="default",failIfMajorPerformanceCaveat:p=!1}=e;this.isWebGLRenderer=!0;let d;r!==null?d=r.getContextAttributes().alpha:d=o;let m=new Uint32Array(4),g=new Int32Array(4),_=null,y=null,x=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Un,this._useLegacyLights=!1,this.toneMapping=$l,this.toneMappingExposure=1;let b=this,C=!1,E=0,T=0,L=null,D=-1,B=null,A=new Ai,k=new Ai,$=null,z=new Rt(0),P=0,U=t.width,G=t.height,K=1,O=null,V=null,j=new Ai(0,0,U,G),q=new Ai(0,0,U,G),ee=!1,ae=new Pg,N=!1,J=!1,Y=null,oe=new Gt,xe=new Ne,ge=new le,Te={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function me(){return L===null?K:1}h(me,"getTargetPixelRatio");let Q=r;function Me(te,ye){for(let Ce=0;Ce<te.length;Ce++){let Pe=te[Ce],Se=t.getContext(Pe,ye);if(Se!==null)return Se}return null}h(Me,"getContext");try{let te={alpha:!0,depth:n,stencil:a,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:c,failIfMajorPerformanceCaveat:p};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${xT}`),t.addEventListener("webglcontextlost",dt,!1),t.addEventListener("webglcontextrestored",ce,!1),t.addEventListener("webglcontextcreationerror",it,!1),Q===null){let ye=["webgl2","webgl","experimental-webgl"];if(b.isWebGL1Renderer===!0&&ye.shift(),Q=Me(ye,te),Q===null)throw Me(ye)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Q instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Q.getShaderPrecisionFormat===void 0&&(Q.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(te){throw console.error("THREE.WebGLRenderer: "+te.message),te}let ve,Ie,ke,we,Oe,Je,xt,ne,W,_e,Fe,Ue,Be,bt,lt,Ge,We,St,Ze,ni,Dt,ue,he,qe;function ft(){ve=new Cq(Q),Ie=new gq(Q,ve,e),ve.init(Ie),ue=new uY(Q,ve,Ie),ke=new sY(Q,ve,Ie),we=new Pq(Q),Oe=new YZ,Je=new lY(Q,ve,ke,Oe,Ie,ue,we),xt=new vq(b),ne=new Mq(b),W=new hq(Q,Ie),he=new fq(Q,ve,W,Ie),_e=new Eq(Q,W,we,he),Fe=new Dq(Q,_e,W,we),Ze=new Lq(Q,Ie,Je),Ge=new yq(Oe),Ue=new ZZ(b,xt,ne,ve,Ie,he,Ge),Be=new mY(b,Oe),bt=new KZ,lt=new rY(ve,Ie),St=new dq(b,xt,ne,ke,Fe,d,l),We=new oY(b,Fe,Ie),qe=new gY(Q,we,Ie,ke),ni=new mq(Q,ve,we,Ie),Dt=new Tq(Q,ve,we,Ie),we.programs=Ue.programs,b.capabilities=Ie,b.extensions=ve,b.properties=Oe,b.renderLists=bt,b.shadowMap=We,b.state=ke,b.info=we}h(ft,"initGLContext"),ft();let ct=new r2e(b,Q);this.xr=ct,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){let te=ve.get("WEBGL_lose_context");te&&te.loseContext()},this.forceContextRestore=function(){let te=ve.get("WEBGL_lose_context");te&&te.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(te){te!==void 0&&(K=te,this.setSize(U,G,!1))},this.getSize=function(te){return te.set(U,G)},this.setSize=function(te,ye,Ce=!0){if(ct.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}U=te,G=ye,t.width=Math.floor(te*K),t.height=Math.floor(ye*K),Ce===!0&&(t.style.width=te+"px",t.style.height=ye+"px"),this.setViewport(0,0,te,ye)},this.getDrawingBufferSize=function(te){return te.set(U*K,G*K).floor()},this.setDrawingBufferSize=function(te,ye,Ce){U=te,G=ye,K=Ce,t.width=Math.floor(te*Ce),t.height=Math.floor(ye*Ce),this.setViewport(0,0,te,ye)},this.getCurrentViewport=function(te){return te.copy(A)},this.getViewport=function(te){return te.copy(j)},this.setViewport=function(te,ye,Ce,Pe){te.isVector4?j.set(te.x,te.y,te.z,te.w):j.set(te,ye,Ce,Pe),ke.viewport(A.copy(j).multiplyScalar(K).round())},this.getScissor=function(te){return te.copy(q)},this.setScissor=function(te,ye,Ce,Pe){te.isVector4?q.set(te.x,te.y,te.z,te.w):q.set(te,ye,Ce,Pe),ke.scissor(k.copy(q).multiplyScalar(K).round())},this.getScissorTest=function(){return ee},this.setScissorTest=function(te){ke.setScissorTest(ee=te)},this.setOpaqueSort=function(te){O=te},this.setTransparentSort=function(te){V=te},this.getClearColor=function(te){return te.copy(St.getClearColor())},this.setClearColor=function(){St.setClearColor.apply(St,arguments)},this.getClearAlpha=function(){return St.getClearAlpha()},this.setClearAlpha=function(){St.setClearAlpha.apply(St,arguments)},this.clear=function(te=!0,ye=!0,Ce=!0){let Pe=0;if(te){let Se=!1;if(L!==null){let at=L.texture.format;Se=at===GW||at===HW||at===jW}if(Se){let at=L.texture.type,wt=at===Ul||at===Tl||at===bT||at===Zu||at===$W||at===UW,Pt=St.getClearColor(),It=St.getClearAlpha(),Ft=Pt.r,Ht=Pt.g,Ot=Pt.b;wt?(m[0]=Ft,m[1]=Ht,m[2]=Ot,m[3]=It,Q.clearBufferuiv(Q.COLOR,0,m)):(g[0]=Ft,g[1]=Ht,g[2]=Ot,g[3]=It,Q.clearBufferiv(Q.COLOR,0,g))}else Pe|=Q.COLOR_BUFFER_BIT}ye&&(Pe|=Q.DEPTH_BUFFER_BIT),Ce&&(Pe|=Q.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Q.clear(Pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",dt,!1),t.removeEventListener("webglcontextrestored",ce,!1),t.removeEventListener("webglcontextcreationerror",it,!1),bt.dispose(),lt.dispose(),Oe.dispose(),xt.dispose(),ne.dispose(),Fe.dispose(),he.dispose(),qe.dispose(),Ue.dispose(),ct.dispose(),ct.removeEventListener("sessionstart",lr),ct.removeEventListener("sessionend",jt),Y&&(Y.dispose(),Y=null),Pi.stop()};function dt(te){te.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),C=!0}h(dt,"onContextLost");function ce(){console.log("THREE.WebGLRenderer: Context Restored."),C=!1;let te=we.autoReset,ye=We.enabled,Ce=We.autoUpdate,Pe=We.needsUpdate,Se=We.type;ft(),we.autoReset=te,We.enabled=ye,We.autoUpdate=Ce,We.needsUpdate=Pe,We.type=Se}h(ce,"onContextRestore");function it(te){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",te.statusMessage)}h(it,"onContextCreationError");function be(te){let ye=te.target;ye.removeEventListener("dispose",be),Xe(ye)}h(be,"onMaterialDispose");function Xe(te){rt(te),Oe.remove(te)}h(Xe,"deallocateMaterial");function rt(te){let ye=Oe.get(te).programs;ye!==void 0&&(ye.forEach(function(Ce){Ue.releaseProgram(Ce)}),te.isShaderMaterial&&Ue.releaseShaderCache(te))}h(rt,"releaseMaterialProgramReferences"),this.renderBufferDirect=function(te,ye,Ce,Pe,Se,at){ye===null&&(ye=Te);let wt=Se.isMesh&&Se.matrixWorld.determinant()<0,Pt=Ea(te,ye,Ce,Pe,Se);ke.setMaterial(Pe,wt);let It=Ce.index,Ft=1;if(Pe.wireframe===!0){if(It=_e.getWireframeAttribute(Ce),It===void 0)return;Ft=2}let Ht=Ce.drawRange,Ot=Ce.attributes.position,Ji=Ht.start*Ft,Di=(Ht.start+Ht.count)*Ft;at!==null&&(Ji=Math.max(Ji,at.start*Ft),Di=Math.min(Di,(at.start+at.count)*Ft)),It!==null?(Ji=Math.max(Ji,0),Di=Math.min(Di,It.count)):Ot!=null&&(Ji=Math.max(Ji,0),Di=Math.min(Di,Ot.count));let jr=Di-Ji;if(jr<0||jr===1/0)return;he.setup(Se,Pe,Pt,Ce,It);let vn,bi=ni;if(It!==null&&(vn=W.get(It),bi=Dt,bi.setIndex(vn)),Se.isMesh)Pe.wireframe===!0?(ke.setLineWidth(Pe.wireframeLinewidth*me()),bi.setMode(Q.LINES)):bi.setMode(Q.TRIANGLES);else if(Se.isLine){let Nt=Pe.linewidth;Nt===void 0&&(Nt=1),ke.setLineWidth(Nt*me()),Se.isLineSegments?bi.setMode(Q.LINES):Se.isLineLoop?bi.setMode(Q.LINE_LOOP):bi.setMode(Q.LINE_STRIP)}else Se.isPoints?bi.setMode(Q.POINTS):Se.isSprite&&bi.setMode(Q.TRIANGLES);if(Se.isBatchedMesh)bi.renderMultiDraw(Se._multiDrawStarts,Se._multiDrawCounts,Se._multiDrawCount);else if(Se.isInstancedMesh)bi.renderInstances(Ji,jr,Se.count);else if(Ce.isInstancedBufferGeometry){let Nt=Ce._maxInstanceCount!==void 0?Ce._maxInstanceCount:1/0,Io=Math.min(Ce.instanceCount,Nt);bi.renderInstances(Ji,jr,Io)}else bi.render(Ji,jr)};function Wt(te,ye,Ce){te.transparent===!0&&te.side===Na&&te.forceSinglePass===!1?(te.side=Qn,te.needsUpdate=!0,Rn(te,ye,Ce),te.side=Xl,te.needsUpdate=!0,Rn(te,ye,Ce),te.side=Na):Rn(te,ye,Ce)}h(Wt,"prepareMaterial"),this.compile=function(te,ye,Ce=null){Ce===null&&(Ce=te),y=lt.get(Ce),y.init(),w.push(y),Ce.traverseVisible(function(Se){Se.isLight&&Se.layers.test(ye.layers)&&(y.pushLight(Se),Se.castShadow&&y.pushShadow(Se))}),te!==Ce&&te.traverseVisible(function(Se){Se.isLight&&Se.layers.test(ye.layers)&&(y.pushLight(Se),Se.castShadow&&y.pushShadow(Se))}),y.setupLights(b._useLegacyLights);let Pe=new Set;return te.traverse(function(Se){let at=Se.material;if(at)if(Array.isArray(at))for(let wt=0;wt<at.length;wt++){let Pt=at[wt];Wt(Pt,Ce,Se),Pe.add(Pt)}else Wt(at,Ce,Se),Pe.add(at)}),w.pop(),y=null,Pe},this.compileAsync=function(te,ye,Ce=null){let Pe=this.compile(te,ye,Ce);return new Promise(Se=>{function at(){if(Pe.forEach(function(wt){Oe.get(wt).currentProgram.isReady()&&Pe.delete(wt)}),Pe.size===0){Se(te);return}setTimeout(at,10)}h(at,"checkMaterialsReady"),ve.get("KHR_parallel_shader_compile")!==null?at():setTimeout(at,10)})};let Ut=null;function Ti(te){Ut&&Ut(te)}h(Ti,"onAnimationFrame");function lr(){Pi.stop()}h(lr,"onXRSessionStart");function jt(){Pi.start()}h(jt,"onXRSessionEnd");let Pi=new AT;Pi.setAnimationLoop(Ti),typeof self<"u"&&Pi.setContext(self),this.setAnimationLoop=function(te){Ut=te,ct.setAnimationLoop(te),te===null?Pi.stop():Pi.start()},ct.addEventListener("sessionstart",lr),ct.addEventListener("sessionend",jt),this.render=function(te,ye){if(ye!==void 0&&ye.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(C===!0)return;te.matrixWorldAutoUpdate===!0&&te.updateMatrixWorld(),ye.parent===null&&ye.matrixWorldAutoUpdate===!0&&ye.updateMatrixWorld(),ct.enabled===!0&&ct.isPresenting===!0&&(ct.cameraAutoUpdate===!0&&ct.updateCamera(ye),ye=ct.getCamera()),te.isScene===!0&&te.onBeforeRender(b,te,ye,L),y=lt.get(te,w.length),y.init(),w.push(y),oe.multiplyMatrices(ye.projectionMatrix,ye.matrixWorldInverse),ae.setFromProjectionMatrix(oe),J=this.localClippingEnabled,N=Ge.init(this.clippingPlanes,J),_=bt.get(te,x.length),_.init(),x.push(_),mr(te,ye,0,b.sortObjects),_.finish(),b.sortObjects===!0&&_.sort(O,V),this.info.render.frame++,N===!0&&Ge.beginShadows();let Ce=y.state.shadowsArray;if(We.render(Ce,te,ye),N===!0&&Ge.endShadows(),this.info.autoReset===!0&&this.info.reset(),(ct.enabled===!1||ct.isPresenting===!1||ct.hasDepthSensing()===!1)&&St.render(_,te),y.setupLights(b._useLegacyLights),ye.isArrayCamera){let Pe=ye.cameras;for(let Se=0,at=Pe.length;Se<at;Se++){let wt=Pe[Se];kn(_,te,wt,wt.viewport)}}else kn(_,te,ye);L!==null&&(Je.updateMultisampleRenderTarget(L),Je.updateRenderTargetMipmap(L)),te.isScene===!0&&te.onAfterRender(b,te,ye),he.resetDefaultState(),D=-1,B=null,w.pop(),w.length>0?y=w[w.length-1]:y=null,x.pop(),x.length>0?_=x[x.length-1]:_=null};function mr(te,ye,Ce,Pe){if(te.visible===!1)return;if(te.layers.test(ye.layers)){if(te.isGroup)Ce=te.renderOrder;else if(te.isLOD)te.autoUpdate===!0&&te.update(ye);else if(te.isLight)y.pushLight(te),te.castShadow&&y.pushShadow(te);else if(te.isSprite){if(!te.frustumCulled||ae.intersectsSprite(te)){Pe&&ge.setFromMatrixPosition(te.matrixWorld).applyMatrix4(oe);let at=Fe.update(te),wt=te.material;wt.visible&&_.push(te,at,wt,Ce,ge.z,null)}}else if((te.isMesh||te.isLine||te.isPoints)&&(!te.frustumCulled||ae.intersectsObject(te))){let at=Fe.update(te),wt=te.material;if(Pe&&(te.boundingSphere!==void 0?(te.boundingSphere===null&&te.computeBoundingSphere(),ge.copy(te.boundingSphere.center)):(at.boundingSphere===null&&at.computeBoundingSphere(),ge.copy(at.boundingSphere.center)),ge.applyMatrix4(te.matrixWorld).applyMatrix4(oe)),Array.isArray(wt)){let Pt=at.groups;for(let It=0,Ft=Pt.length;It<Ft;It++){let Ht=Pt[It],Ot=wt[Ht.materialIndex];Ot&&Ot.visible&&_.push(te,at,Ot,Ce,ge.z,Ht)}}else wt.visible&&_.push(te,at,wt,Ce,ge.z,null)}}let Se=te.children;for(let at=0,wt=Se.length;at<wt;at++)mr(Se[at],ye,Ce,Pe)}h(mr,"projectObject");function kn(te,ye,Ce,Pe){let Se=te.opaque,at=te.transmissive,wt=te.transparent;y.setupLightsView(Ce),N===!0&&Ge.setGlobalState(b.clippingPlanes,Ce),at.length>0&&Ma(Se,at,ye,Ce),Pe&&ke.viewport(A.copy(Pe)),Se.length>0&&gn(Se,ye,Ce),at.length>0&&gn(at,ye,Ce),wt.length>0&&gn(wt,ye,Ce),ke.buffers.depth.setTest(!0),ke.buffers.depth.setMask(!0),ke.buffers.color.setMask(!0),ke.setPolygonOffset(!1)}h(kn,"renderScene");function Ma(te,ye,Ce,Pe){if((Ce.isScene===!0?Ce.overrideMaterial:null)!==null)return;let Se=Ie.isWebGL2;Y===null&&(Y=new dh(1,1,{generateMipmaps:!0,type:ve.has("EXT_color_buffer_half_float")?Jm:Ul,minFilter:Nu,samples:Se?4:0})),b.getDrawingBufferSize(xe),Se?Y.setSize(xe.x,xe.y):Y.setSize(Km(xe.x),Km(xe.y));let at=b.getRenderTarget();b.setRenderTarget(Y),b.getClearColor(z),P=b.getClearAlpha(),P<1&&b.setClearColor(16777215,.5),b.clear();let wt=b.toneMapping;b.toneMapping=$l,gn(te,Ce,Pe),Je.updateMultisampleRenderTarget(Y),Je.updateRenderTargetMipmap(Y);let Pt=!1;for(let It=0,Ft=ye.length;It<Ft;It++){let Ht=ye[It],Ot=Ht.object,Ji=Ht.geometry,Di=Ht.material,jr=Ht.group;if(Di.side===Na&&Ot.layers.test(Pe.layers)){let vn=Di.side;Di.side=Qn,Di.needsUpdate=!0,Yr(Ot,Ce,Pe,Ji,Di,jr),Di.side=vn,Di.needsUpdate=!0,Pt=!0}}Pt===!0&&(Je.updateMultisampleRenderTarget(Y),Je.updateRenderTargetMipmap(Y)),b.setRenderTarget(at),b.setClearColor(z,P),b.toneMapping=wt}h(Ma,"renderTransmissionPass");function gn(te,ye,Ce){let Pe=ye.isScene===!0?ye.overrideMaterial:null;for(let Se=0,at=te.length;Se<at;Se++){let wt=te[Se],Pt=wt.object,It=wt.geometry,Ft=Pe===null?wt.material:Pe,Ht=wt.group;Pt.layers.test(Ce.layers)&&Yr(Pt,ye,Ce,It,Ft,Ht)}}h(gn,"renderObjects");function Yr(te,ye,Ce,Pe,Se,at){te.onBeforeRender(b,ye,Ce,Pe,Se,at),te.modelViewMatrix.multiplyMatrices(Ce.matrixWorldInverse,te.matrixWorld),te.normalMatrix.getNormalMatrix(te.modelViewMatrix),Se.onBeforeRender(b,ye,Ce,Pe,te,at),Se.transparent===!0&&Se.side===Na&&Se.forceSinglePass===!1?(Se.side=Qn,Se.needsUpdate=!0,b.renderBufferDirect(Ce,ye,Pe,Se,te,at),Se.side=Xl,Se.needsUpdate=!0,b.renderBufferDirect(Ce,ye,Pe,Se,te,at),Se.side=Na):b.renderBufferDirect(Ce,ye,Pe,Se,te,at),te.onAfterRender(b,ye,Ce,Pe,Se,at)}h(Yr,"renderObject");function Rn(te,ye,Ce){ye.isScene!==!0&&(ye=Te);let Pe=Oe.get(te),Se=y.state.lights,at=y.state.shadowsArray,wt=Se.state.version,Pt=Ue.getParameters(te,Se.state,at,ye,Ce),It=Ue.getProgramCacheKey(Pt),Ft=Pe.programs;Pe.environment=te.isMeshStandardMaterial?ye.environment:null,Pe.fog=ye.fog,Pe.envMap=(te.isMeshStandardMaterial?ne:xt).get(te.envMap||Pe.environment),Pe.envMapRotation=Pe.environment!==null&&te.envMap===null?ye.environmentRotation:te.envMapRotation,Ft===void 0&&(te.addEventListener("dispose",be),Ft=new Map,Pe.programs=Ft);let Ht=Ft.get(It);if(Ht!==void 0){if(Pe.currentProgram===Ht&&Pe.lightsStateVersion===wt)return Ca(te,Pt),Ht}else Pt.uniforms=Ue.getUniforms(te),te.onBuild(Ce,Pt,b),te.onBeforeCompile(Pt,b),Ht=Ue.acquireProgram(Pt,It),Ft.set(It,Ht),Pe.uniforms=Pt.uniforms;let Ot=Pe.uniforms;return(!te.isShaderMaterial&&!te.isRawShaderMaterial||te.clipping===!0)&&(Ot.clippingPlanes=Ge.uniform),Ca(te,Pt),Pe.needsLights=yn(te),Pe.lightsStateVersion=wt,Pe.needsLights&&(Ot.ambientLightColor.value=Se.state.ambient,Ot.lightProbe.value=Se.state.probe,Ot.directionalLights.value=Se.state.directional,Ot.directionalLightShadows.value=Se.state.directionalShadow,Ot.spotLights.value=Se.state.spot,Ot.spotLightShadows.value=Se.state.spotShadow,Ot.rectAreaLights.value=Se.state.rectArea,Ot.ltc_1.value=Se.state.rectAreaLTC1,Ot.ltc_2.value=Se.state.rectAreaLTC2,Ot.pointLights.value=Se.state.point,Ot.pointLightShadows.value=Se.state.pointShadow,Ot.hemisphereLights.value=Se.state.hemi,Ot.directionalShadowMap.value=Se.state.directionalShadowMap,Ot.directionalShadowMatrix.value=Se.state.directionalShadowMatrix,Ot.spotShadowMap.value=Se.state.spotShadowMap,Ot.spotLightMatrix.value=Se.state.spotLightMatrix,Ot.spotLightMap.value=Se.state.spotLightMap,Ot.pointShadowMap.value=Se.state.pointShadowMap,Ot.pointShadowMatrix.value=Se.state.pointShadowMatrix),Pe.currentProgram=Ht,Pe.uniformsList=null,Ht}h(Rn,"getProgram");function ra(te){if(te.uniformsList===null){let ye=te.currentProgram.getUniforms();te.uniformsList=Jy.seqWithValue(ye.seq,te.uniforms)}return te.uniformsList}h(ra,"getUniformList");function Ca(te,ye){let Ce=Oe.get(te);Ce.outputColorSpace=ye.outputColorSpace,Ce.batching=ye.batching,Ce.instancing=ye.instancing,Ce.instancingColor=ye.instancingColor,Ce.instancingMorph=ye.instancingMorph,Ce.skinning=ye.skinning,Ce.morphTargets=ye.morphTargets,Ce.morphNormals=ye.morphNormals,Ce.morphColors=ye.morphColors,Ce.morphTargetsCount=ye.morphTargetsCount,Ce.numClippingPlanes=ye.numClippingPlanes,Ce.numIntersection=ye.numClipIntersection,Ce.vertexAlphas=ye.vertexAlphas,Ce.vertexTangents=ye.vertexTangents,Ce.toneMapping=ye.toneMapping}h(Ca,"updateCommonMaterialProperties");function Ea(te,ye,Ce,Pe,Se){ye.isScene!==!0&&(ye=Te),Je.resetTextureUnits();let at=ye.fog,wt=Pe.isMeshStandardMaterial?ye.environment:null,Pt=L===null?b.outputColorSpace:L.isXRRenderTarget===!0?L.texture.colorSpace:tu,It=(Pe.isMeshStandardMaterial?ne:xt).get(Pe.envMap||wt),Ft=Pe.vertexColors===!0&&!!Ce.attributes.color&&Ce.attributes.color.itemSize===4,Ht=!!Ce.attributes.tangent&&(!!Pe.normalMap||Pe.anisotropy>0),Ot=!!Ce.morphAttributes.position,Ji=!!Ce.morphAttributes.normal,Di=!!Ce.morphAttributes.color,jr=$l;Pe.toneMapped&&(L===null||L.isXRRenderTarget===!0)&&(jr=b.toneMapping);let vn=Ce.morphAttributes.position||Ce.morphAttributes.normal||Ce.morphAttributes.color,bi=vn!==void 0?vn.length:0,Nt=Oe.get(Pe),Io=y.state.lights;if(N===!0&&(J===!0||te!==B)){let Hr=te===B&&Pe.id===D;Ge.setState(Pe,te,Hr)}let gr=!1;Pe.version===Nt.__version?(Nt.needsLights&&Nt.lightsStateVersion!==Io.state.version||Nt.outputColorSpace!==Pt||Se.isBatchedMesh&&Nt.batching===!1||!Se.isBatchedMesh&&Nt.batching===!0||Se.isInstancedMesh&&Nt.instancing===!1||!Se.isInstancedMesh&&Nt.instancing===!0||Se.isSkinnedMesh&&Nt.skinning===!1||!Se.isSkinnedMesh&&Nt.skinning===!0||Se.isInstancedMesh&&Nt.instancingColor===!0&&Se.instanceColor===null||Se.isInstancedMesh&&Nt.instancingColor===!1&&Se.instanceColor!==null||Se.isInstancedMesh&&Nt.instancingMorph===!0&&Se.morphTexture===null||Se.isInstancedMesh&&Nt.instancingMorph===!1&&Se.morphTexture!==null||Nt.envMap!==It||Pe.fog===!0&&Nt.fog!==at||Nt.numClippingPlanes!==void 0&&(Nt.numClippingPlanes!==Ge.numPlanes||Nt.numIntersection!==Ge.numIntersection)||Nt.vertexAlphas!==Ft||Nt.vertexTangents!==Ht||Nt.morphTargets!==Ot||Nt.morphNormals!==Ji||Nt.morphColors!==Di||Nt.toneMapping!==jr||Ie.isWebGL2===!0&&Nt.morphTargetsCount!==bi)&&(gr=!0):(gr=!0,Nt.__version=Pe.version);let Ta=Nt.currentProgram;gr===!0&&(Ta=Rn(Pe,ye,Se));let Gs=!1,Ja=!1,Vt=!1,Ui=Ta.getUniforms(),Pa=Nt.uniforms;if(ke.useProgram(Ta.program)&&(Gs=!0,Ja=!0,Vt=!0),Pe.id!==D&&(D=Pe.id,Ja=!0),Gs||B!==te){Ui.setValue(Q,"projectionMatrix",te.projectionMatrix),Ui.setValue(Q,"viewMatrix",te.matrixWorldInverse);let Hr=Ui.map.cameraPosition;Hr!==void 0&&Hr.setValue(Q,ge.setFromMatrixPosition(te.matrixWorld)),Ie.logarithmicDepthBuffer&&Ui.setValue(Q,"logDepthBufFC",2/(Math.log(te.far+1)/Math.LN2)),(Pe.isMeshPhongMaterial||Pe.isMeshToonMaterial||Pe.isMeshLambertMaterial||Pe.isMeshBasicMaterial||Pe.isMeshStandardMaterial||Pe.isShaderMaterial)&&Ui.setValue(Q,"isOrthographic",te.isOrthographicCamera===!0),B!==te&&(B=te,Ja=!0,Vt=!0)}if(Se.isSkinnedMesh){Ui.setOptional(Q,Se,"bindMatrix"),Ui.setOptional(Q,Se,"bindMatrixInverse");let Hr=Se.skeleton;Hr&&(Ie.floatVertexTextures?(Hr.boneTexture===null&&Hr.computeBoneTexture(),Ui.setValue(Q,"boneTexture",Hr.boneTexture,Je)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Se.isBatchedMesh&&(Ui.setOptional(Q,Se,"batchingTexture"),Ui.setValue(Q,"batchingTexture",Se._matricesTexture,Je));let Ws=Ce.morphAttributes;if((Ws.position!==void 0||Ws.normal!==void 0||Ws.color!==void 0&&Ie.isWebGL2===!0)&&Ze.update(Se,Ce,Ta),(Ja||Nt.receiveShadow!==Se.receiveShadow)&&(Nt.receiveShadow=Se.receiveShadow,Ui.setValue(Q,"receiveShadow",Se.receiveShadow)),Pe.isMeshGouraudMaterial&&Pe.envMap!==null&&(Pa.envMap.value=It,Pa.flipEnvMap.value=It.isCubeTexture&&It.isRenderTargetTexture===!1?-1:1),Ja&&(Ui.setValue(Q,"toneMappingExposure",b.toneMappingExposure),Nt.needsLights&&Ya(Pa,Vt),at&&Pe.fog===!0&&Be.refreshFogUniforms(Pa,at),Be.refreshMaterialUniforms(Pa,Pe,K,G,Y),Jy.upload(Q,ra(Nt),Pa,Je)),Pe.isShaderMaterial&&Pe.uniformsNeedUpdate===!0&&(Jy.upload(Q,ra(Nt),Pa,Je),Pe.uniformsNeedUpdate=!1),Pe.isSpriteMaterial&&Ui.setValue(Q,"center",Se.center),Ui.setValue(Q,"modelViewMatrix",Se.modelViewMatrix),Ui.setValue(Q,"normalMatrix",Se.normalMatrix),Ui.setValue(Q,"modelMatrix",Se.matrixWorld),Pe.isShaderMaterial||Pe.isRawShaderMaterial){let Hr=Pe.uniformsGroups;for(let Ka=0,f=Hr.length;Ka<f;Ka++)if(Ie.isWebGL2){let v=Hr[Ka];qe.update(v,Ta),qe.bind(v,Ta)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ta}h(Ea,"setProgram");function Ya(te,ye){te.ambientLightColor.needsUpdate=ye,te.lightProbe.needsUpdate=ye,te.directionalLights.needsUpdate=ye,te.directionalLightShadows.needsUpdate=ye,te.pointLights.needsUpdate=ye,te.pointLightShadows.needsUpdate=ye,te.spotLights.needsUpdate=ye,te.spotLightShadows.needsUpdate=ye,te.rectAreaLights.needsUpdate=ye,te.hemisphereLights.needsUpdate=ye}h(Ya,"markUniformsLightsNeedsUpdate");function yn(te){return te.isMeshLambertMaterial||te.isMeshToonMaterial||te.isMeshPhongMaterial||te.isMeshStandardMaterial||te.isShadowMaterial||te.isShaderMaterial&&te.lights===!0}h(yn,"materialNeedsLights"),this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(te,ye,Ce){Oe.get(te.texture).__webglTexture=ye,Oe.get(te.depthTexture).__webglTexture=Ce;let Pe=Oe.get(te);Pe.__hasExternalTextures=!0,Pe.__autoAllocateDepthBuffer=Ce===void 0,Pe.__autoAllocateDepthBuffer||ve.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Pe.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(te,ye){let Ce=Oe.get(te);Ce.__webglFramebuffer=ye,Ce.__useDefaultFramebuffer=ye===void 0},this.setRenderTarget=function(te,ye=0,Ce=0){L=te,E=ye,T=Ce;let Pe=!0,Se=null,at=!1,wt=!1;if(te){let Pt=Oe.get(te);Pt.__useDefaultFramebuffer!==void 0?(ke.bindFramebuffer(Q.FRAMEBUFFER,null),Pe=!1):Pt.__webglFramebuffer===void 0?Je.setupRenderTarget(te):Pt.__hasExternalTextures&&Je.rebindTextures(te,Oe.get(te.texture).__webglTexture,Oe.get(te.depthTexture).__webglTexture);let It=te.texture;(It.isData3DTexture||It.isDataArrayTexture||It.isCompressedArrayTexture)&&(wt=!0);let Ft=Oe.get(te).__webglFramebuffer;te.isWebGLCubeRenderTarget?(Array.isArray(Ft[ye])?Se=Ft[ye][Ce]:Se=Ft[ye],at=!0):Ie.isWebGL2&&te.samples>0&&Je.useMultisampledRTT(te)===!1?Se=Oe.get(te).__webglMultisampledFramebuffer:Array.isArray(Ft)?Se=Ft[Ce]:Se=Ft,A.copy(te.viewport),k.copy(te.scissor),$=te.scissorTest}else A.copy(j).multiplyScalar(K).floor(),k.copy(q).multiplyScalar(K).floor(),$=ee;if(ke.bindFramebuffer(Q.FRAMEBUFFER,Se)&&Ie.drawBuffers&&Pe&&ke.drawBuffers(te,Se),ke.viewport(A),ke.scissor(k),ke.setScissorTest($),at){let Pt=Oe.get(te.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_CUBE_MAP_POSITIVE_X+ye,Pt.__webglTexture,Ce)}else if(wt){let Pt=Oe.get(te.texture),It=ye||0;Q.framebufferTextureLayer(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Pt.__webglTexture,Ce||0,It)}D=-1},this.readRenderTargetPixels=function(te,ye,Ce,Pe,Se,at,wt){if(!(te&&te.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Pt=Oe.get(te).__webglFramebuffer;if(te.isWebGLCubeRenderTarget&&wt!==void 0&&(Pt=Pt[wt]),Pt){ke.bindFramebuffer(Q.FRAMEBUFFER,Pt);try{let It=te.texture,Ft=It.format,Ht=It.type;if(Ft!==Gn&&ue.convert(Ft)!==Q.getParameter(Q.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Ot=Ht===Jm&&(ve.has("EXT_color_buffer_half_float")||Ie.isWebGL2&&ve.has("EXT_color_buffer_float"));if(Ht!==Ul&&ue.convert(Ht)!==Q.getParameter(Q.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Ht===ca&&(Ie.isWebGL2||ve.has("OES_texture_float")||ve.has("WEBGL_color_buffer_float")))&&!Ot){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ye>=0&&ye<=te.width-Pe&&Ce>=0&&Ce<=te.height-Se&&Q.readPixels(ye,Ce,Pe,Se,ue.convert(Ft),ue.convert(Ht),at)}finally{let It=L!==null?Oe.get(L).__webglFramebuffer:null;ke.bindFramebuffer(Q.FRAMEBUFFER,It)}}},this.copyFramebufferToTexture=function(te,ye,Ce=0){let Pe=Math.pow(2,-Ce),Se=Math.floor(ye.image.width*Pe),at=Math.floor(ye.image.height*Pe);Je.setTexture2D(ye,0),Q.copyTexSubImage2D(Q.TEXTURE_2D,Ce,0,0,te.x,te.y,Se,at),ke.unbindTexture()},this.copyTextureToTexture=function(te,ye,Ce,Pe=0){let Se=ye.image.width,at=ye.image.height,wt=ue.convert(Ce.format),Pt=ue.convert(Ce.type);Je.setTexture2D(Ce,0),Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,Ce.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ce.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,Ce.unpackAlignment),ye.isDataTexture?Q.texSubImage2D(Q.TEXTURE_2D,Pe,te.x,te.y,Se,at,wt,Pt,ye.image.data):ye.isCompressedTexture?Q.compressedTexSubImage2D(Q.TEXTURE_2D,Pe,te.x,te.y,ye.mipmaps[0].width,ye.mipmaps[0].height,wt,ye.mipmaps[0].data):Q.texSubImage2D(Q.TEXTURE_2D,Pe,te.x,te.y,wt,Pt,ye.image),Pe===0&&Ce.generateMipmaps&&Q.generateMipmap(Q.TEXTURE_2D),ke.unbindTexture()},this.copyTextureToTexture3D=function(te,ye,Ce,Pe,Se=0){if(b.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let at=Math.round(te.max.x-te.min.x),wt=Math.round(te.max.y-te.min.y),Pt=te.max.z-te.min.z+1,It=ue.convert(Pe.format),Ft=ue.convert(Pe.type),Ht;if(Pe.isData3DTexture)Je.setTexture3D(Pe,0),Ht=Q.TEXTURE_3D;else if(Pe.isDataArrayTexture||Pe.isCompressedArrayTexture)Je.setTexture2DArray(Pe,0),Ht=Q.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,Pe.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Pe.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,Pe.unpackAlignment);let Ot=Q.getParameter(Q.UNPACK_ROW_LENGTH),Ji=Q.getParameter(Q.UNPACK_IMAGE_HEIGHT),Di=Q.getParameter(Q.UNPACK_SKIP_PIXELS),jr=Q.getParameter(Q.UNPACK_SKIP_ROWS),vn=Q.getParameter(Q.UNPACK_SKIP_IMAGES),bi=Ce.isCompressedTexture?Ce.mipmaps[Se]:Ce.image;Q.pixelStorei(Q.UNPACK_ROW_LENGTH,bi.width),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,bi.height),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,te.min.x),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,te.min.y),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,te.min.z),Ce.isDataTexture||Ce.isData3DTexture?Q.texSubImage3D(Ht,Se,ye.x,ye.y,ye.z,at,wt,Pt,It,Ft,bi.data):Pe.isCompressedArrayTexture?Q.compressedTexSubImage3D(Ht,Se,ye.x,ye.y,ye.z,at,wt,Pt,It,bi.data):Q.texSubImage3D(Ht,Se,ye.x,ye.y,ye.z,at,wt,Pt,It,Ft,bi),Q.pixelStorei(Q.UNPACK_ROW_LENGTH,Ot),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,Ji),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,Di),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,jr),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,vn),Se===0&&Pe.generateMipmaps&&Q.generateMipmap(Ht),ke.unbindTexture()},this.initTexture=function(te){te.isCubeTexture?Je.setTextureCube(te,0):te.isData3DTexture?Je.setTexture3D(te,0):te.isDataArrayTexture||te.isCompressedArrayTexture?Je.setTexture2DArray(te,0):Je.setTexture2D(te,0),ke.unbindTexture()},this.resetState=function(){E=0,T=0,L=null,ke.reset(),he.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ds}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=e===ST?"display-p3":"srgb",t.unpackColorSpace=Ei.workingColorSpace===S_?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}};h(yY,"WebGLRenderer");var vY=yY,xY=class extends vY{};h(xY,"WebGL1Renderer");var _Y=xY;_Y.prototype.isWebGL1Renderer=!0;var bY=class extends or{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Xa,this.environmentRotation=new Xa,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),t.object.environmentRotation=this.environmentRotation.toArray(),t}};h(bY,"Scene");var wY=bY,SY=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=gS,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=va()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return CT("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let n=0,a=this.stride;n<a;n++)this.array[e+n]=t.array[r+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=va()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=va()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}};h(SY,"InterleavedBuffer");var BPe=SY,_n=new le,MY=class CY{constructor(e,t,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)_n.fromBufferAttribute(this,t),_n.applyMatrix4(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)_n.fromBufferAttribute(this,t),_n.applyNormalMatrix(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)_n.fromBufferAttribute(this,t),_n.transformDirection(e),this.setXYZ(t,_n.x,_n.y,_n.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=$a(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=_i(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=_i(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=_i(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=_i(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=_i(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=$a(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=$a(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=$a(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=$a(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=_i(t,this.array),r=_i(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=_i(t,this.array),r=_i(r,this.array),n=_i(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,t,r,n,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=_i(t,this.array),r=_i(r,this.array),n=_i(n,this.array),a=_i(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=a,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[n+a])}return new Ur(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new CY(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let n=r*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[n+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}};h(MY,"InterleavedBufferAttribute");var zPe=MY,JI=new le,KI=new Ai,QI=new Ai,a2e=new le,e8=new Gt,U1=new le,yb=new ea,t8=new Gt,vb=new Tg,EY=class extends Zi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=H6,this.bindMatrix=new Gt,this.bindMatrixInverse=new Gt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;this.boundingBox===null&&(this.boundingBox=new tn),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,U1),this.boundingBox.expandByPoint(U1)}computeBoundingSphere(){let e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new ea),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,U1),this.boundingSphere.expandByPoint(U1)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let r=this.material,n=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),yb.copy(this.boundingSphere),yb.applyMatrix4(n),e.ray.intersectsSphere(yb)!==!1&&(t8.copy(n).invert(),vb.copy(e.ray).applyMatrix4(t8),!(this.boundingBox!==null&&vb.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,vb)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new Ai,t=this.geometry.attributes.skinWeight;for(let r=0,n=t.count;r<n;r++){e.fromBufferAttribute(t,r);let a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===H6?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===p0e?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let r=this.skeleton,n=this.geometry;KI.fromBufferAttribute(n.attributes.skinIndex,e),QI.fromBufferAttribute(n.attributes.skinWeight,e),JI.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){let o=QI.getComponent(a);if(o!==0){let s=KI.getComponent(a);e8.multiplyMatrices(r.bones[s].matrixWorld,r.boneInverses[s]),t.addScaledVector(a2e.copy(JI).applyMatrix4(e8),o)}}return t.applyMatrix4(this.bindMatrixInverse)}};h(EY,"SkinnedMesh");var $Pe=EY,TY=class extends or{constructor(){super(),this.isBone=!0,this.type="Bone"}};h(TY,"Bone");var o2e=TY,PY=class extends Ln{constructor(e=null,t=1,r=1,n,a,o,s,l,u=Kr,c=Kr,p,d){super(null,o,s,l,u,c,n,a,p,d),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};h(PY,"DataTexture");var T_=PY,i8=new Gt,s2e=new Gt,AY=class IY{constructor(e=[],t=[]){this.uuid=va(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new Gt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let r=new Gt;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){let e=this.bones,t=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let a=0,o=e.length;a<o;a++){let s=e[a]?e[a].matrixWorld:s2e;i8.multiplyMatrices(s,t[a]),i8.toArray(r,a*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new IY(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let r=new T_(t,e,e,Gn,ca);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){let n=this.bones[t];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let a=e.bones[r],o=t[a];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),o=new o2e),this.bones.push(o),this.boneInverses.push(new Gt().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,r=this.boneInverses;for(let n=0,a=t.length;n<a;n++){let o=t[n];e.bones.push(o.uuid);let s=r[n];e.boneInverses.push(s.toArray())}return e}};h(AY,"Skeleton");var jPe=AY,LY=class extends Ur{constructor(e,t,r,n=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}};h(LY,"InstancedBufferAttribute");var r8=LY,ec=new Gt,n8=new Gt,V1=[],a8=new tn,l2e=new Gt,Jd=new Zi,Kd=new ea,DY=class extends Zi{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new r8(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let n=0;n<r;n++)this.setMatrixAt(n,l2e)}computeBoundingBox(){let e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new tn),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,ec),a8.copy(e.boundingBox).applyMatrix4(ec),this.boundingBox.union(a8)}computeBoundingSphere(){let e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new ea),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,ec),Kd.copy(e.boundingSphere).applyMatrix4(ec),this.boundingSphere.union(Kd)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){let r=t.morphTargetInfluences,n=this.morphTexture.source.data.data,a=r.length+1,o=e*a+1;for(let s=0;s<r.length;s++)r[s]=n[o+s]}raycast(e,t){let r=this.matrixWorld,n=this.count;if(Jd.geometry=this.geometry,Jd.material=this.material,Jd.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Kd.copy(this.boundingSphere),Kd.applyMatrix4(r),e.ray.intersectsSphere(Kd)!==!1))for(let a=0;a<n;a++){this.getMatrixAt(a,ec),n8.multiplyMatrices(r,ec),Jd.matrixWorld=n8,Jd.raycast(e,V1);for(let o=0,s=V1.length;o<s;o++){let l=V1[o];l.instanceId=a,l.object=this,t.push(l)}V1.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new r8(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){let r=t.morphTargetInfluences,n=r.length+1;this.morphTexture===null&&(this.morphTexture=new T_(new Float32Array(n*this.count),n,this.count,VW,ca));let a=this.morphTexture.source.data.data,o=0;for(let u=0;u<r.length;u++)o+=r[u];let s=this.geometry.morphTargetsRelative?1:1-o,l=n*e;a[l]=s,a.set(r,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}};h(DY,"InstancedMesh");var kY=DY;function RY(i,e){return i.z-e.z}h(RY,"sortOpaque");function FY(i,e){return e.z-i.z}h(FY,"sortTransparent");var OY=class{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){let r=this.pool,n=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1});let a=r[this.index];n.push(a),this.index++,a.start=e.start,a.count=e.count,a.z=t}reset(){this.list.length=0,this.index=0}};h(OY,"MultiDrawRenderList");var u2e=OY,tc="batchId",rl=new Gt,o8=new Gt,h2e=new Gt,s8=new Gt,xb=new Pg,j1=new tn,pu=new ea,Qd=new le,_b=new u2e,ln=new Zi,H1=[];function BY(i,e,t=0){let r=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){let n=i.count;for(let a=0;a<n;a++)for(let o=0;o<r;o++)e.setComponent(a+t,o,i.getComponent(a,o))}else e.array.set(i.array,t*r);e.needsUpdate=!0}h(BY,"copyAttributeData");var zY=class extends Zi{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,r=t*2,n){super(new Sa,n),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);let t=new Float32Array(e*e*4),r=new T_(t,e,e,Gn,ca);this._matricesTexture=r}_initializeGeometry(e){let t=this.geometry,r=this._maxVertexCount,n=this._maxGeometryCount,a=this._maxIndexCount;if(this._geometryInitialized===!1){for(let s in e.attributes){let l=e.getAttribute(s),{array:u,itemSize:c,normalized:p}=l,d=new u.constructor(r*c),m=new l.constructor(d,c,p);m.setUsage(l.usage),t.setAttribute(s,m)}if(e.getIndex()!==null){let s=r>65536?new Uint32Array(a):new Uint16Array(a);t.setIndex(new Ur(s,1))}let o=n>65536?new Uint32Array(r):new Uint16Array(r);t.setAttribute(tc,new Ur(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(tc))throw new Error(`BatchedMesh: Geometry cannot use attribute "${tc}"`);let t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(let r in t.attributes){if(r===tc)continue;if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);let n=e.getAttribute(r),a=t.getAttribute(r);if(n.itemSize!==a.itemSize||n.normalized!==a.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new tn);let e=this._geometryCount,t=this.boundingBox,r=this._active;t.makeEmpty();for(let n=0;n<e;n++)r[n]!==!1&&(this.getMatrixAt(n,rl),this.getBoundingBoxAt(n,j1).applyMatrix4(rl),t.union(j1))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ea);let e=this._geometryCount,t=this.boundingSphere,r=this._active;t.makeEmpty();for(let n=0;n<e;n++)r[n]!==!1&&(this.getMatrixAt(n,rl),this.getBoundingSphereAt(n,pu).applyMatrix4(rl),t.union(pu))}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");let n={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1},a=null,o=this._reservedRanges,s=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(a=o[o.length-1]),t===-1?n.vertexCount=e.getAttribute("position").count:n.vertexCount=t,a===null?n.vertexStart=0:n.vertexStart=a.vertexStart+a.vertexCount;let u=e.getIndex(),c=u!==null;if(c&&(r===-1?n.indexCount=u.count:n.indexCount=r,a===null?n.indexStart=0:n.indexStart=a.indexStart+a.indexCount),n.indexStart!==-1&&n.indexStart+n.indexCount>this._maxIndexCount||n.vertexStart+n.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");let p=this._visibility,d=this._active,m=this._matricesTexture,g=this._matricesTexture.image.data;p.push(!0),d.push(!0);let _=this._geometryCount;this._geometryCount++,h2e.toArray(g,_*16),m.needsUpdate=!0,o.push(n),s.push({start:c?n.indexStart:n.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new tn,sphereInitialized:!1,sphere:new ea});let y=this.geometry.getAttribute(tc);for(let x=0;x<n.vertexCount;x++)y.setX(n.vertexStart+x,_);return y.needsUpdate=!0,this.setGeometryAt(_,e),_}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);let r=this.geometry,n=r.getIndex()!==null,a=r.getIndex(),o=t.getIndex(),s=this._reservedRanges[e];if(n&&o.count>s.indexCount||t.attributes.position.count>s.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");let l=s.vertexStart,u=s.vertexCount;for(let m in r.attributes){if(m===tc)continue;let g=t.getAttribute(m),_=r.getAttribute(m);BY(g,_,l);let y=g.itemSize;for(let x=g.count,w=u;x<w;x++){let b=l+x;for(let C=0;C<y;C++)_.setComponent(b,C,0)}_.needsUpdate=!0}if(n){let m=s.indexStart;for(let g=0;g<o.count;g++)a.setX(m+g,l+o.getX(g));for(let g=o.count,_=s.indexCount;g<_;g++)a.setX(m+g,l);a.needsUpdate=!0}let c=this._bounds[e];t.boundingBox!==null?(c.box.copy(t.boundingBox),c.boxInitialized=!0):c.boxInitialized=!1,t.boundingSphere!==null?(c.sphere.copy(t.boundingSphere),c.sphereInitialized=!0):c.sphereInitialized=!1;let p=this._drawRanges[e],d=t.getAttribute("position");return p.count=n?o.count:d.count,this._visibilityChanged=!0,e}deleteGeometry(e){let t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(this._active[e]===!1)return null;let r=this._bounds[e],n=r.box,a=this.geometry;if(r.boxInitialized===!1){n.makeEmpty();let o=a.index,s=a.attributes.position,l=this._drawRanges[e];for(let u=l.start,c=l.start+l.count;u<c;u++){let p=u;o&&(p=o.getX(p)),n.expandByPoint(Qd.fromBufferAttribute(s,p))}r.boxInitialized=!0}return t.copy(n),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return null;let r=this._bounds[e],n=r.sphere,a=this.geometry;if(r.sphereInitialized===!1){n.makeEmpty(),this.getBoundingBoxAt(e,j1),j1.getCenter(n.center);let o=a.index,s=a.attributes.position,l=this._drawRanges[e],u=0;for(let c=l.start,p=l.start+l.count;c<p;c++){let d=c;o&&(d=o.getX(d)),Qd.fromBufferAttribute(s,d),u=Math.max(u,n.center.distanceToSquared(Qd))}n.radius=Math.sqrt(u),r.sphereInitialized=!0}return t.copy(n),t}setMatrixAt(e,t){let r=this._active,n=this._matricesTexture,a=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||r[e]===!1?this:(t.toArray(a,e*16),n.needsUpdate=!0,this)}getMatrixAt(e,t){let r=this._active,n=this._matricesTexture.image.data,a=this._geometryCount;return e>=a||r[e]===!1?null:t.fromArray(n,e*16)}setVisibleAt(e,t){let r=this._visibility,n=this._active,a=this._geometryCount;return e>=a||n[e]===!1||r[e]===t?this:(r[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){let t=this._visibility,r=this._active,n=this._geometryCount;return e>=n||r[e]===!1?!1:t[e]}raycast(e,t){let r=this._visibility,n=this._active,a=this._drawRanges,o=this._geometryCount,s=this.matrixWorld,l=this.geometry;ln.material=this.material,ln.geometry.index=l.index,ln.geometry.attributes=l.attributes,ln.geometry.boundingBox===null&&(ln.geometry.boundingBox=new tn),ln.geometry.boundingSphere===null&&(ln.geometry.boundingSphere=new ea);for(let u=0;u<o;u++){if(!r[u]||!n[u])continue;let c=a[u];ln.geometry.setDrawRange(c.start,c.count),this.getMatrixAt(u,ln.matrixWorld).premultiply(s),this.getBoundingBoxAt(u,ln.geometry.boundingBox),this.getBoundingSphereAt(u,ln.geometry.boundingSphere),ln.raycast(e,H1);for(let p=0,d=H1.length;p<d;p++){let m=H1[p];m.object=this,m.batchId=u,t.push(m)}H1.length=0}ln.material=null,ln.geometry.index=null,ln.geometry.attributes={},ln.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,r,n,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;let o=n.getIndex(),s=o===null?1:o.array.BYTES_PER_ELEMENT,l=this._active,u=this._visibility,c=this._multiDrawStarts,p=this._multiDrawCounts,d=this._drawRanges,m=this.perObjectFrustumCulled;m&&(s8.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),xb.setFromProjectionMatrix(s8,e.coordinateSystem));let g=0;if(this.sortObjects){o8.copy(this.matrixWorld).invert(),Qd.setFromMatrixPosition(r.matrixWorld).applyMatrix4(o8);for(let x=0,w=u.length;x<w;x++)if(u[x]&&l[x]){this.getMatrixAt(x,rl),this.getBoundingSphereAt(x,pu).applyMatrix4(rl);let b=!1;if(m&&(b=!xb.intersectsSphere(pu)),!b){let C=Qd.distanceTo(pu.center);_b.push(d[x],C)}}let _=_b.list,y=this.customSort;y===null?_.sort(a.transparent?FY:RY):y.call(this,_,r);for(let x=0,w=_.length;x<w;x++){let b=_[x];c[g]=b.start*s,p[g]=b.count,g++}_b.reset()}else for(let _=0,y=u.length;_<y;_++)if(u[_]&&l[_]){let x=!1;if(m&&(this.getMatrixAt(_,rl),this.getBoundingSphereAt(_,pu).applyMatrix4(rl),x=!xb.intersectsSphere(pu)),!x){let w=d[_];c[g]=w.start*s,p[g]=w.count,g++}}this._multiDrawCount=g,this._visibilityChanged=!1}onBeforeShadow(e,t,r,n,a,o){this.onBeforeRender(e,null,n,a,o)}};h(zY,"BatchedMesh");var IT=zY,NY=class extends iu{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Rt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}};h(NY,"LineBasicMaterial");var $Y=NY,l8=new le,u8=new le,h8=new Gt,bb=new Tg,G1=new ea,UY=class extends or{constructor(e=new Sa,t=new $Y){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let n=1,a=t.count;n<a;n++)l8.fromBufferAttribute(t,n-1),u8.fromBufferAttribute(t,n),r[n]=r[n-1],r[n]+=l8.distanceTo(u8);e.setAttribute("lineDistance",new qr(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,a=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),G1.copy(r.boundingSphere),G1.applyMatrix4(n),G1.radius+=a,e.ray.intersectsSphere(G1)===!1)return;h8.copy(n).invert(),bb.copy(e.ray).applyMatrix4(h8);let s=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,u=new le,c=new le,p=new le,d=new le,m=this.isLineSegments?2:1,g=r.index,_=r.attributes.position;if(g!==null){let y=Math.max(0,o.start),x=Math.min(g.count,o.start+o.count);for(let w=y,b=x-1;w<b;w+=m){let C=g.getX(w),E=g.getX(w+1);if(u.fromBufferAttribute(_,C),c.fromBufferAttribute(_,E),bb.distanceSqToSegment(u,c,d,p)>l)continue;d.applyMatrix4(this.matrixWorld);let T=e.ray.origin.distanceTo(d);T<e.near||T>e.far||t.push({distance:T,point:p.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{let y=Math.max(0,o.start),x=Math.min(_.count,o.start+o.count);for(let w=y,b=x-1;w<b;w+=m){if(u.fromBufferAttribute(_,w),c.fromBufferAttribute(_,w+1),bb.distanceSqToSegment(u,c,d,p)>l)continue;d.applyMatrix4(this.matrixWorld);let C=e.ray.origin.distanceTo(d);C<e.near||C>e.far||t.push({distance:C,point:p.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=r.length;n<a;n++){let o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}};h(UY,"Line");var VY=UY,c8=new le,p8=new le,jY=class extends VY{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let n=0,a=t.count;n<a;n+=2)c8.fromBufferAttribute(t,n),p8.fromBufferAttribute(t,n+1),r[n]=n===0?0:r[n-1],r[n+1]=r[n]+c8.distanceTo(p8);e.setAttribute("lineDistance",new qr(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};h(jY,"LineSegments");var P_=jY,HY=class extends VY{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}};h(HY,"LineLoop");var KPe=HY,GY=class extends iu{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Rt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}};h(GY,"PointsMaterial");var c2e=GY,d8=new Gt,DS=new Tg,W1=new ea,X1=new le,WY=class extends or{constructor(e=new Sa,t=new c2e){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let r=this.geometry,n=this.matrixWorld,a=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),W1.copy(r.boundingSphere),W1.applyMatrix4(n),W1.radius+=a,e.ray.intersectsSphere(W1)===!1)return;d8.copy(n).invert(),DS.copy(e.ray).applyMatrix4(d8);let s=a/((this.scale.x+this.scale.y+this.scale.z)/3),l=s*s,u=r.index,c=r.attributes.position;if(u!==null){let p=Math.max(0,o.start),d=Math.min(u.count,o.start+o.count);for(let m=p,g=d;m<g;m++){let _=u.getX(m);X1.fromBufferAttribute(c,_),kS(X1,_,l,n,e,t,this)}}else{let p=Math.max(0,o.start),d=Math.min(c.count,o.start+o.count);for(let m=p,g=d;m<g;m++)X1.fromBufferAttribute(c,m),kS(X1,m,l,n,e,t,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,a=r.length;n<a;n++){let o=r[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=n}}}}};h(WY,"Points");var tAe=WY;function kS(i,e,t,r,n,a,o){let s=DS.distanceSqToPoint(i);if(s<t){let l=new le;DS.closestPointToPoint(i,l),l.applyMatrix4(r);let u=n.ray.origin.distanceTo(l);if(u<n.near||u>n.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,object:o})}}h(kS,"testPoint");var XY=class extends Ln{constructor(e,t,r,n,a,o,s,l,u,c,p,d){super(null,o,s,l,u,c,n,a,p,d),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}};h(XY,"CompressedTexture");var rAe=XY,qY=class extends Ln{constructor(e,t,r,n,a,o,s,l,u){super(e,t,r,n,a,o,s,l,u),this.isCanvasTexture=!0,this.needsUpdate=!0}};h(qY,"CanvasTexture");var aAe=qY,ZY=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,n=this.getPoint(0),a=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),a+=r.distanceTo(n),t.push(a),n=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),n=0,a=r.length,o;t?o=t:o=e*r[a-1];let s=0,l=a-1,u;for(;s<=l;)if(n=Math.floor(s+(l-s)/2),u=r[n]-o,u<0)s=n+1;else if(u>0)l=n-1;else{l=n;break}if(n=l,r[n]===o)return n/(a-1);let c=r[n],p=r[n+1]-c,d=(o-c)/p;return(n+d)/(a-1)}getTangent(e,t){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);let a=this.getPoint(r),o=this.getPoint(n),s=t||(a.isVector2?new Ne:new le);return s.copy(o).sub(a).normalize(),s}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new le,n=[],a=[],o=[],s=new le,l=new Gt;for(let m=0;m<=e;m++){let g=m/e;n[m]=this.getTangentAt(g,new le)}a[0]=new le,o[0]=new le;let u=Number.MAX_VALUE,c=Math.abs(n[0].x),p=Math.abs(n[0].y),d=Math.abs(n[0].z);c<=u&&(u=c,r.set(1,0,0)),p<=u&&(u=p,r.set(0,1,0)),d<=u&&r.set(0,0,1),s.crossVectors(n[0],r).normalize(),a[0].crossVectors(n[0],s),o[0].crossVectors(n[0],a[0]);for(let m=1;m<=e;m++){if(a[m]=a[m-1].clone(),o[m]=o[m-1].clone(),s.crossVectors(n[m-1],n[m]),s.length()>Number.EPSILON){s.normalize();let g=Math.acos(Nr(n[m-1].dot(n[m]),-1,1));a[m].applyMatrix4(l.makeRotationAxis(s,g))}o[m].crossVectors(n[m],a[m])}if(t===!0){let m=Math.acos(Nr(a[0].dot(a[e]),-1,1));m/=e,n[0].dot(s.crossVectors(a[0],a[e]))>0&&(m=-m);for(let g=1;g<=e;g++)a[g].applyMatrix4(l.makeRotationAxis(n[g],m*g)),o[g].crossVectors(n[g],a[g])}return{tangents:n,normals:a,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}};h(ZY,"Curve");var rs=ZY,YY=class extends rs{constructor(e=0,t=0,r=1,n=1,a=0,o=Math.PI*2,s=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=n,this.aStartAngle=a,this.aEndAngle=o,this.aClockwise=s,this.aRotation=l}getPoint(e,t=new Ne){let r=t,n=Math.PI*2,a=this.aEndAngle-this.aStartAngle,o=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=n;for(;a>n;)a-=n;a<Number.EPSILON&&(o?a=0:a=n),this.aClockwise===!0&&!o&&(a===n?a=-n:a=a-n);let s=this.aStartAngle+e*a,l=this.aX+this.xRadius*Math.cos(s),u=this.aY+this.yRadius*Math.sin(s);if(this.aRotation!==0){let c=Math.cos(this.aRotation),p=Math.sin(this.aRotation),d=l-this.aX,m=u-this.aY;l=d*c-m*p+this.aX,u=d*p+m*c+this.aY}return r.set(l,u)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};h(YY,"EllipseCurve");var LT=YY,JY=class extends LT{constructor(e,t,r,n,a,o){super(e,t,r,r,n,a,o),this.isArcCurve=!0,this.type="ArcCurve"}};h(JY,"ArcCurve");var p2e=JY;function A_(){let i=0,e=0,t=0,r=0;function n(a,o,s,l){i=a,e=s,t=-3*a+3*o-2*s-l,r=2*a-2*o+s+l}return h(n,"init"),{initCatmullRom:function(a,o,s,l,u){n(o,s,u*(s-a),u*(l-o))},initNonuniformCatmullRom:function(a,o,s,l,u,c,p){let d=(o-a)/u-(s-a)/(u+c)+(s-o)/c,m=(s-o)/c-(l-o)/(c+p)+(l-s)/p;d*=c,m*=c,n(o,s,d,m)},calc:function(a){let o=a*a,s=o*a;return i+e*a+t*o+r*s}}}h(A_,"CubicPoly");var q1=new le,wb=new A_,Sb=new A_,Mb=new A_,KY=class extends rs{constructor(e=[],t=!1,r="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=n}getPoint(e,t=new le){let r=t,n=this.points,a=n.length,o=(a-(this.closed?0:1))*e,s=Math.floor(o),l=o-s;this.closed?s+=s>0?0:(Math.floor(Math.abs(s)/a)+1)*a:l===0&&s===a-1&&(s=a-2,l=1);let u,c;this.closed||s>0?u=n[(s-1)%a]:(q1.subVectors(n[0],n[1]).add(n[0]),u=q1);let p=n[s%a],d=n[(s+1)%a];if(this.closed||s+2<a?c=n[(s+2)%a]:(q1.subVectors(n[a-1],n[a-2]).add(n[a-1]),c=q1),this.curveType==="centripetal"||this.curveType==="chordal"){let m=this.curveType==="chordal"?.5:.25,g=Math.pow(u.distanceToSquared(p),m),_=Math.pow(p.distanceToSquared(d),m),y=Math.pow(d.distanceToSquared(c),m);_<1e-4&&(_=1),g<1e-4&&(g=_),y<1e-4&&(y=_),wb.initNonuniformCatmullRom(u.x,p.x,d.x,c.x,g,_,y),Sb.initNonuniformCatmullRom(u.y,p.y,d.y,c.y,g,_,y),Mb.initNonuniformCatmullRom(u.z,p.z,d.z,c.z,g,_,y)}else this.curveType==="catmullrom"&&(wb.initCatmullRom(u.x,p.x,d.x,c.x,this.tension),Sb.initCatmullRom(u.y,p.y,d.y,c.y,this.tension),Mb.initCatmullRom(u.z,p.z,d.z,c.z,this.tension));return r.set(wb.calc(l),Sb.calc(l),Mb.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(new le().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};h(KY,"CatmullRomCurve3");var QY=KY;function RS(i,e,t,r,n){let a=(r-e)*.5,o=(n-t)*.5,s=i*i,l=i*s;return(2*t-2*r+a+o)*l+(-3*t+3*r-2*a-o)*s+a*i+t}h(RS,"CatmullRom");function eJ(i,e){let t=1-i;return t*t*e}h(eJ,"QuadraticBezierP0");function tJ(i,e){return 2*(1-i)*i*e}h(tJ,"QuadraticBezierP1");function iJ(i,e){return i*i*e}h(iJ,"QuadraticBezierP2");function Ip(i,e,t,r){return eJ(i,e)+tJ(i,t)+iJ(i,r)}h(Ip,"QuadraticBezier");function rJ(i,e){let t=1-i;return t*t*t*e}h(rJ,"CubicBezierP0");function nJ(i,e){let t=1-i;return 3*t*t*i*e}h(nJ,"CubicBezierP1");function aJ(i,e){return 3*(1-i)*i*i*e}h(aJ,"CubicBezierP2");function oJ(i,e){return i*i*i*e}h(oJ,"CubicBezierP3");function Lp(i,e,t,r,n){return rJ(i,e)+nJ(i,t)+aJ(i,r)+oJ(i,n)}h(Lp,"CubicBezier");var sJ=class extends rs{constructor(e=new Ne,t=new Ne,r=new Ne,n=new Ne){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new Ne){let r=t,n=this.v0,a=this.v1,o=this.v2,s=this.v3;return r.set(Lp(e,n.x,a.x,o.x,s.x),Lp(e,n.y,a.y,o.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};h(sJ,"CubicBezierCurve");var lJ=sJ,uJ=class extends rs{constructor(e=new le,t=new le,r=new le,n=new le){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=n}getPoint(e,t=new le){let r=t,n=this.v0,a=this.v1,o=this.v2,s=this.v3;return r.set(Lp(e,n.x,a.x,o.x,s.x),Lp(e,n.y,a.y,o.y,s.y),Lp(e,n.z,a.z,o.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}};h(uJ,"CubicBezierCurve3");var d2e=uJ,hJ=class extends rs{constructor(e=new Ne,t=new Ne){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ne){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ne){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};h(hJ,"LineCurve");var cJ=hJ,pJ=class extends rs{constructor(e=new le,t=new le){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new le){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new le){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};h(pJ,"LineCurve3");var f2e=pJ,dJ=class extends rs{constructor(e=new Ne,t=new Ne,r=new Ne){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Ne){let r=t,n=this.v0,a=this.v1,o=this.v2;return r.set(Ip(e,n.x,a.x,o.x),Ip(e,n.y,a.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};h(dJ,"QuadraticBezierCurve");var fJ=dJ,mJ=class extends rs{constructor(e=new le,t=new le,r=new le){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new le){let r=t,n=this.v0,a=this.v1,o=this.v2;return r.set(Ip(e,n.x,a.x,o.x),Ip(e,n.y,a.y,o.y),Ip(e,n.z,a.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}};h(mJ,"QuadraticBezierCurve3");var gJ=mJ,yJ=class extends rs{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ne){let r=t,n=this.points,a=(n.length-1)*e,o=Math.floor(a),s=a-o,l=n[o===0?o:o-1],u=n[o],c=n[o>n.length-2?n.length-1:o+1],p=n[o>n.length-3?n.length-1:o+2];return r.set(RS(s,l.x,u.x,c.x,p.x),RS(s,l.y,u.y,c.y,p.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let n=e.points[t];this.points.push(new Ne().fromArray(n))}return this}};h(yJ,"SplineCurve");var vJ=yJ,ex=Object.freeze({__proto__:null,ArcCurve:p2e,CatmullRomCurve3:QY,CubicBezierCurve:lJ,CubicBezierCurve3:d2e,EllipseCurve:LT,LineCurve:cJ,LineCurve3:f2e,QuadraticBezierCurve:fJ,QuadraticBezierCurve3:gJ,SplineCurve:vJ}),xJ=class extends rs{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){let r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new ex[r](t,e))}return this}getPoint(e,t){let r=e*this.getLength(),n=this.getCurveLengths(),a=0;for(;a<n.length;){if(n[a]>=r){let o=n[a]-r,s=this.curves[a],l=s.getLength(),u=l===0?0:1-o/l;return s.getPointAt(u,t)}a++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,n=this.curves.length;r<n;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let n=0,a=this.curves;n<a.length;n++){let o=a[n],s=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(s);for(let u=0;u<l.length;u++){let c=l[u];r&&r.equals(c)||(t.push(c),r=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let n=e.curves[t];this.curves.push(new ex[n.type]().fromJSON(n))}return this}};h(xJ,"CurvePath");var m2e=xJ,_J=class extends m2e{constructor(e){super(),this.type="Path",this.currentPoint=new Ne,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new cJ(this.currentPoint.clone(),new Ne(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,n){let a=new fJ(this.currentPoint.clone(),new Ne(e,t),new Ne(r,n));return this.curves.push(a),this.currentPoint.set(r,n),this}bezierCurveTo(e,t,r,n,a,o){let s=new lJ(this.currentPoint.clone(),new Ne(e,t),new Ne(r,n),new Ne(a,o));return this.curves.push(s),this.currentPoint.set(a,o),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new vJ(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,n,a,o){let s=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+s,t+l,r,n,a,o),this}absarc(e,t,r,n,a,o){return this.absellipse(e,t,r,r,n,a,o),this}ellipse(e,t,r,n,a,o,s,l){let u=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+u,t+c,r,n,a,o,s,l),this}absellipse(e,t,r,n,a,o,s,l){let u=new LT(e,t,r,n,a,o,s,l);if(this.curves.length>0){let p=u.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(u);let c=u.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};h(_J,"Path");var nd=_J,bJ=class wJ extends Sa{constructor(e=1,t=1,r=1,n=32,a=1,o=!1,s=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:n,heightSegments:a,openEnded:o,thetaStart:s,thetaLength:l};let u=this;n=Math.floor(n),a=Math.floor(a);let c=[],p=[],d=[],m=[],g=0,_=[],y=r/2,x=0;w(),o===!1&&(e>0&&b(!0),t>0&&b(!1)),this.setIndex(c),this.setAttribute("position",new qr(p,3)),this.setAttribute("normal",new qr(d,3)),this.setAttribute("uv",new qr(m,2));function w(){let C=new le,E=new le,T=0,L=(t-e)/r;for(let D=0;D<=a;D++){let B=[],A=D/a,k=A*(t-e)+e;for(let $=0;$<=n;$++){let z=$/n,P=z*l+s,U=Math.sin(P),G=Math.cos(P);E.x=k*U,E.y=-A*r+y,E.z=k*G,p.push(E.x,E.y,E.z),C.set(U,L,G).normalize(),d.push(C.x,C.y,C.z),m.push(z,1-A),B.push(g++)}_.push(B)}for(let D=0;D<n;D++)for(let B=0;B<a;B++){let A=_[B][D],k=_[B+1][D],$=_[B+1][D+1],z=_[B][D+1];c.push(A,k,z),c.push(k,$,z),T+=6}u.addGroup(x,T,0),x+=T}h(w,"generateTorso");function b(C){let E=g,T=new Ne,L=new le,D=0,B=C===!0?e:t,A=C===!0?1:-1;for(let $=1;$<=n;$++)p.push(0,y*A,0),d.push(0,A,0),m.push(.5,.5),g++;let k=g;for(let $=0;$<=n;$++){let z=$/n*l+s,P=Math.cos(z),U=Math.sin(z);L.x=B*U,L.y=y*A,L.z=B*P,p.push(L.x,L.y,L.z),d.push(0,A,0),T.x=P*.5+.5,T.y=U*.5*A+.5,m.push(T.x,T.y),g++}for(let $=0;$<n;$++){let z=E+$,P=k+$;C===!0?c.push(P,P+1,z):c.push(P+1,P,z),D+=3}u.addGroup(x,D,C===!0?1:2),x+=D}h(b,"generateCap")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wJ(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}};h(bJ,"CylinderGeometry");var f8=bJ,Z1=new le,Y1=new le,Cb=new le,J1=new Tf,SJ=class extends Sa{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){let r=Math.pow(10,4),n=Math.cos(Pp*t),a=e.getIndex(),o=e.getAttribute("position"),s=a?a.count:o.count,l=[0,0,0],u=["a","b","c"],c=new Array(3),p={},d=[];for(let m=0;m<s;m+=3){a?(l[0]=a.getX(m),l[1]=a.getX(m+1),l[2]=a.getX(m+2)):(l[0]=m,l[1]=m+1,l[2]=m+2);let{a:g,b:_,c:y}=J1;if(g.fromBufferAttribute(o,l[0]),_.fromBufferAttribute(o,l[1]),y.fromBufferAttribute(o,l[2]),J1.getNormal(Cb),c[0]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,c[1]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,c[2]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,!(c[0]===c[1]||c[1]===c[2]||c[2]===c[0]))for(let x=0;x<3;x++){let w=(x+1)%3,b=c[x],C=c[w],E=J1[u[x]],T=J1[u[w]],L=`${b}_${C}`,D=`${C}_${b}`;D in p&&p[D]?(Cb.dot(p[D].normal)<=n&&(d.push(E.x,E.y,E.z),d.push(T.x,T.y,T.z)),p[D]=null):L in p||(p[L]={index0:l[x],index1:l[w],normal:Cb.clone()})}}for(let m in p)if(p[m]){let{index0:g,index1:_}=p[m];Z1.fromBufferAttribute(o,g),Y1.fromBufferAttribute(o,_),d.push(Z1.x,Z1.y,Z1.z),d.push(Y1.x,Y1.y,Y1.z)}this.setAttribute("position",new qr(d,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}};h(SJ,"EdgesGeometry");var g2e=SJ,MJ=class extends nd{constructor(e){super(e),this.uuid=va(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,n=this.holes.length;r<n;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let n=e.holes[t];this.holes.push(new nd().fromJSON(n))}return this}};h(MJ,"Shape");var Sd=MJ,y2e={triangulate:function(i,e,t=2){let r=e&&e.length,n=r?e[0]*t:i.length,a=DT(i,0,n,t,!0),o=[];if(!a||a.next===a.prev)return o;let s,l,u,c,p,d,m;if(r&&(a=AJ(i,e,a,t)),i.length>80*t){s=u=i[0],l=c=i[1];for(let g=t;g<n;g+=t)p=i[g],d=i[g+1],p<s&&(s=p),d<l&&(l=d),p>u&&(u=p),d>c&&(c=d);m=Math.max(u-s,c-l),m=m!==0?32767/m:0}return ad(a,o,t,s,l,m,0),o}};function DT(i,e,t,r,n){let a,o;if(n===$J(i,e,t,r)>0)for(a=e;a<t;a+=r)o=FS(a,i[a],i[a+1],o);else for(a=t-r;a>=e;a-=r)o=FS(a,i[a],i[a+1],o);return o&&Lg(o,o.next)&&(sd(o),o=o.next),o}h(DT,"linkedList");function ql(i,e){if(!i)return i;e||(e=i);let t=i,r;do if(r=!1,!t.steiner&&(Lg(t,t.next)||qi(t.prev,t,t.next)===0)){if(sd(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}h(ql,"filterPoints");function ad(i,e,t,r,n,a,o){if(!i)return;!o&&a&&RJ(i,r,n,a);let s=i,l,u;for(;i.prev!==i.next;){if(l=i.prev,u=i.next,a?EJ(i,r,n,a):CJ(i)){e.push(l.i/t|0),e.push(i.i/t|0),e.push(u.i/t|0),sd(i),i=u.next,s=u.next;continue}if(i=u,i===s){o?o===1?(i=TJ(ql(i),e,t),ad(i,e,t,r,n,a,2)):o===2&&PJ(i,e,t,r,n,a):ad(ql(i),e,t,r,n,a,1);break}}}h(ad,"earcutLinked");function CJ(i){let e=i.prev,t=i,r=i.next;if(qi(e,t,r)>=0)return!1;let n=e.x,a=t.x,o=r.x,s=e.y,l=t.y,u=r.y,c=n<a?n<o?n:o:a<o?a:o,p=s<l?s<u?s:u:l<u?l:u,d=n>a?n>o?n:o:a>o?a:o,m=s>l?s>u?s:u:l>u?l:u,g=r.next;for(;g!==e;){if(g.x>=c&&g.x<=d&&g.y>=p&&g.y<=m&&Uu(n,s,a,l,o,u,g.x,g.y)&&qi(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}h(CJ,"isEar");function EJ(i,e,t,r){let n=i.prev,a=i,o=i.next;if(qi(n,a,o)>=0)return!1;let s=n.x,l=a.x,u=o.x,c=n.y,p=a.y,d=o.y,m=s<l?s<u?s:u:l<u?l:u,g=c<p?c<d?c:d:p<d?p:d,_=s>l?s>u?s:u:l>u?l:u,y=c>p?c>d?c:d:p>d?p:d,x=tx(m,g,e,t,r),w=tx(_,y,e,t,r),b=i.prevZ,C=i.nextZ;for(;b&&b.z>=x&&C&&C.z<=w;){if(b.x>=m&&b.x<=_&&b.y>=g&&b.y<=y&&b!==n&&b!==o&&Uu(s,c,l,p,u,d,b.x,b.y)&&qi(b.prev,b,b.next)>=0||(b=b.prevZ,C.x>=m&&C.x<=_&&C.y>=g&&C.y<=y&&C!==n&&C!==o&&Uu(s,c,l,p,u,d,C.x,C.y)&&qi(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;b&&b.z>=x;){if(b.x>=m&&b.x<=_&&b.y>=g&&b.y<=y&&b!==n&&b!==o&&Uu(s,c,l,p,u,d,b.x,b.y)&&qi(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;C&&C.z<=w;){if(C.x>=m&&C.x<=_&&C.y>=g&&C.y<=y&&C!==n&&C!==o&&Uu(s,c,l,p,u,d,C.x,C.y)&&qi(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}h(EJ,"isEarHashed");function TJ(i,e,t){let r=i;do{let n=r.prev,a=r.next.next;!Lg(n,a)&&kT(n,r,r.next,a)&&od(n,a)&&od(a,n)&&(e.push(n.i/t|0),e.push(r.i/t|0),e.push(a.i/t|0),sd(r),sd(r.next),r=i=a),r=r.next}while(r!==i);return ql(r)}h(TJ,"cureLocalIntersections");function PJ(i,e,t,r,n,a){let o=i;do{let s=o.next.next;for(;s!==o.prev;){if(o.i!==s.i&&BJ(o,s)){let l=RT(o,s);o=ql(o,o.next),l=ql(l,l.next),ad(o,e,t,r,n,a,0),ad(l,e,t,r,n,a,0);return}s=s.next}o=o.next}while(o!==i)}h(PJ,"splitEarcut");function AJ(i,e,t,r){let n=[],a,o,s,l,u;for(a=0,o=e.length;a<o;a++)s=e[a]*r,l=a<o-1?e[a+1]*r:i.length,u=DT(i,s,l,r,!1),u===u.next&&(u.steiner=!0),n.push(OJ(u));for(n.sort(IJ),a=0;a<n.length;a++)t=LJ(n[a],t);return t}h(AJ,"eliminateHoles");function IJ(i,e){return i.x-e.x}h(IJ,"compareX");function LJ(i,e){let t=DJ(i,e);if(!t)return e;let r=RT(t,i);return ql(r,r.next),ql(t,t.next)}h(LJ,"eliminateHole");function DJ(i,e){let t=e,r=-1/0,n,a=i.x,o=i.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){let d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=a&&d>r&&(r=d,n=t.x<t.next.x?t:t.next,d===a))return n}t=t.next}while(t!==e);if(!n)return null;let s=n,l=n.x,u=n.y,c=1/0,p;t=n;do a>=t.x&&t.x>=l&&a!==t.x&&Uu(o<u?a:r,o,l,u,o<u?r:a,o,t.x,t.y)&&(p=Math.abs(o-t.y)/(a-t.x),od(t,i)&&(p<c||p===c&&(t.x>n.x||t.x===n.x&&kJ(n,t)))&&(n=t,c=p)),t=t.next;while(t!==s);return n}h(DJ,"findHoleBridge");function kJ(i,e){return qi(i.prev,i,e.prev)<0&&qi(e.next,i,i.next)<0}h(kJ,"sectorContainsSector");function RJ(i,e,t,r){let n=i;do n.z===0&&(n.z=tx(n.x,n.y,e,t,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==i);n.prevZ.nextZ=null,n.prevZ=null,FJ(n)}h(RJ,"indexCurve");function FJ(i){let e,t,r,n,a,o,s,l,u=1;do{for(t=i,i=null,a=null,o=0;t;){for(o++,r=t,s=0,e=0;e<u&&(s++,r=r.nextZ,!!r);e++);for(l=u;s>0||l>0&&r;)s!==0&&(l===0||!r||t.z<=r.z)?(n=t,t=t.nextZ,s--):(n=r,r=r.nextZ,l--),a?a.nextZ=n:i=n,n.prevZ=a,a=n;t=r}a.nextZ=null,u*=2}while(o>1);return i}h(FJ,"sortLinked");function tx(i,e,t,r,n){return i=(i-t)*n|0,e=(e-r)*n|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}h(tx,"zOrder");function OJ(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}h(OJ,"getLeftmost");function Uu(i,e,t,r,n,a,o,s){return(n-o)*(e-s)>=(i-o)*(a-s)&&(i-o)*(r-s)>=(t-o)*(e-s)&&(t-o)*(a-s)>=(n-o)*(r-s)}h(Uu,"pointInTriangle");function BJ(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!zJ(i,e)&&(od(i,e)&&od(e,i)&&NJ(i,e)&&(qi(i.prev,i,e.prev)||qi(i,e.prev,e))||Lg(i,e)&&qi(i.prev,i,i.next)>0&&qi(e.prev,e,e.next)>0)}h(BJ,"isValidDiagonal");function qi(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}h(qi,"area");function Lg(i,e){return i.x===e.x&&i.y===e.y}h(Lg,"equals");function kT(i,e,t,r){let n=Lf(qi(i,e,t)),a=Lf(qi(i,e,r)),o=Lf(qi(t,r,i)),s=Lf(qi(t,r,e));return!!(n!==a&&o!==s||n===0&&If(i,t,e)||a===0&&If(i,r,e)||o===0&&If(t,i,r)||s===0&&If(t,e,r))}h(kT,"intersects");function If(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}h(If,"onSegment");function Lf(i){return i>0?1:i<0?-1:0}h(Lf,"sign");function zJ(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&kT(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}h(zJ,"intersectsPolygon");function od(i,e){return qi(i.prev,i,i.next)<0?qi(i,e,i.next)>=0&&qi(i,i.prev,e)>=0:qi(i,e,i.prev)<0||qi(i,i.next,e)<0}h(od,"locallyInside");function NJ(i,e){let t=i,r=!1,n=(i.x+e.x)/2,a=(i.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&n<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==i);return r}h(NJ,"middleInside");function RT(i,e){let t=new ix(i.i,i.x,i.y),r=new ix(e.i,e.x,e.y),n=i.next,a=e.prev;return i.next=e,e.prev=i,t.next=n,n.prev=t,r.next=t,t.prev=r,a.next=r,r.prev=a,r}h(RT,"splitPolygon");function FS(i,e,t,r){let n=new ix(i,e,t);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}h(FS,"insertNode");function sd(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}h(sd,"removeNode");function ix(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}h(ix,"Node");function $J(i,e,t,r){let n=0;for(let a=e,o=t-r;a<t;a+=r)n+=(i[o]-i[a])*(i[a+1]+i[o+1]),o=a;return n}h($J,"signedArea");var UJ=class VJ{static area(e){let t=e.length,r=0;for(let n=t-1,a=0;a<t;n=a++)r+=e[n].x*e[a].y-e[a].x*e[n].y;return r*.5}static isClockWise(e){return VJ.area(e)<0}static triangulateShape(e,t){let r=[],n=[],a=[];OS(e),BS(r,e);let o=e.length;t.forEach(OS);for(let l=0;l<t.length;l++)n.push(o),o+=t[l].length,BS(r,t[l]);let s=y2e.triangulate(r,n);for(let l=0;l<s.length;l+=3)a.push(s.slice(l,l+3));return a}};h(UJ,"ShapeUtils");var Eb=UJ;function OS(i){let e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}h(OS,"removeDupEndPts");function BS(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}h(BS,"addContour");var jJ=class HJ extends Sa{constructor(e=new Sd([new Ne(.5,.5),new Ne(-.5,.5),new Ne(-.5,-.5),new Ne(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let r=this,n=[],a=[];for(let s=0,l=e.length;s<l;s++){let u=e[s];o(u)}this.setAttribute("position",new qr(n,3)),this.setAttribute("uv",new qr(a,2)),this.computeVertexNormals();function o(s){let l=[],u=t.curveSegments!==void 0?t.curveSegments:12,c=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1,d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,m=t.bevelThickness!==void 0?t.bevelThickness:.2,g=t.bevelSize!==void 0?t.bevelSize:m-.1,_=t.bevelOffset!==void 0?t.bevelOffset:0,y=t.bevelSegments!==void 0?t.bevelSegments:3,x=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:v2e,b,C=!1,E,T,L,D;x&&(b=x.getSpacedPoints(c),C=!0,d=!1,E=x.computeFrenetFrames(c,!1),T=new le,L=new le,D=new le),d||(y=0,m=0,g=0,_=0);let B=s.extractPoints(u),A=B.shape,k=B.holes;if(!Eb.isClockWise(A)){A=A.reverse();for(let me=0,Q=k.length;me<Q;me++){let Me=k[me];Eb.isClockWise(Me)&&(k[me]=Me.reverse())}}let $=Eb.triangulateShape(A,k),z=A;for(let me=0,Q=k.length;me<Q;me++){let Me=k[me];A=A.concat(Me)}function P(me,Q,Me){return Q||console.error("THREE.ExtrudeGeometry: vec does not exist"),me.clone().addScaledVector(Q,Me)}h(P,"scalePt2");let U=A.length,G=$.length;function K(me,Q,Me){let ve,Ie,ke,we=me.x-Q.x,Oe=me.y-Q.y,Je=Me.x-me.x,xt=Me.y-me.y,ne=we*we+Oe*Oe,W=we*xt-Oe*Je;if(Math.abs(W)>Number.EPSILON){let _e=Math.sqrt(ne),Fe=Math.sqrt(Je*Je+xt*xt),Ue=Q.x-Oe/_e,Be=Q.y+we/_e,bt=Me.x-xt/Fe,lt=Me.y+Je/Fe,Ge=((bt-Ue)*xt-(lt-Be)*Je)/(we*xt-Oe*Je);ve=Ue+we*Ge-me.x,Ie=Be+Oe*Ge-me.y;let We=ve*ve+Ie*Ie;if(We<=2)return new Ne(ve,Ie);ke=Math.sqrt(We/2)}else{let _e=!1;we>Number.EPSILON?Je>Number.EPSILON&&(_e=!0):we<-Number.EPSILON?Je<-Number.EPSILON&&(_e=!0):Math.sign(Oe)===Math.sign(xt)&&(_e=!0),_e?(ve=-Oe,Ie=we,ke=Math.sqrt(ne)):(ve=we,Ie=Oe,ke=Math.sqrt(ne/2))}return new Ne(ve/ke,Ie/ke)}h(K,"getBevelVec");let O=[];for(let me=0,Q=z.length,Me=Q-1,ve=me+1;me<Q;me++,Me++,ve++)Me===Q&&(Me=0),ve===Q&&(ve=0),O[me]=K(z[me],z[Me],z[ve]);let V=[],j,q=O.concat();for(let me=0,Q=k.length;me<Q;me++){let Me=k[me];j=[];for(let ve=0,Ie=Me.length,ke=Ie-1,we=ve+1;ve<Ie;ve++,ke++,we++)ke===Ie&&(ke=0),we===Ie&&(we=0),j[ve]=K(Me[ve],Me[ke],Me[we]);V.push(j),q=q.concat(j)}for(let me=0;me<y;me++){let Q=me/y,Me=m*Math.cos(Q*Math.PI/2),ve=g*Math.sin(Q*Math.PI/2)+_;for(let Ie=0,ke=z.length;Ie<ke;Ie++){let we=P(z[Ie],O[Ie],ve);Y(we.x,we.y,-Me)}for(let Ie=0,ke=k.length;Ie<ke;Ie++){let we=k[Ie];j=V[Ie];for(let Oe=0,Je=we.length;Oe<Je;Oe++){let xt=P(we[Oe],j[Oe],ve);Y(xt.x,xt.y,-Me)}}}let ee=g+_;for(let me=0;me<U;me++){let Q=d?P(A[me],q[me],ee):A[me];C?(L.copy(E.normals[0]).multiplyScalar(Q.x),T.copy(E.binormals[0]).multiplyScalar(Q.y),D.copy(b[0]).add(L).add(T),Y(D.x,D.y,D.z)):Y(Q.x,Q.y,0)}for(let me=1;me<=c;me++)for(let Q=0;Q<U;Q++){let Me=d?P(A[Q],q[Q],ee):A[Q];C?(L.copy(E.normals[me]).multiplyScalar(Me.x),T.copy(E.binormals[me]).multiplyScalar(Me.y),D.copy(b[me]).add(L).add(T),Y(D.x,D.y,D.z)):Y(Me.x,Me.y,p/c*me)}for(let me=y-1;me>=0;me--){let Q=me/y,Me=m*Math.cos(Q*Math.PI/2),ve=g*Math.sin(Q*Math.PI/2)+_;for(let Ie=0,ke=z.length;Ie<ke;Ie++){let we=P(z[Ie],O[Ie],ve);Y(we.x,we.y,p+Me)}for(let Ie=0,ke=k.length;Ie<ke;Ie++){let we=k[Ie];j=V[Ie];for(let Oe=0,Je=we.length;Oe<Je;Oe++){let xt=P(we[Oe],j[Oe],ve);C?Y(xt.x,xt.y+b[c-1].y,b[c-1].x+Me):Y(xt.x,xt.y,p+Me)}}}ae(),N();function ae(){let me=n.length/3;if(d){let Q=0,Me=U*Q;for(let ve=0;ve<G;ve++){let Ie=$[ve];oe(Ie[2]+Me,Ie[1]+Me,Ie[0]+Me)}Q=c+y*2,Me=U*Q;for(let ve=0;ve<G;ve++){let Ie=$[ve];oe(Ie[0]+Me,Ie[1]+Me,Ie[2]+Me)}}else{for(let Q=0;Q<G;Q++){let Me=$[Q];oe(Me[2],Me[1],Me[0])}for(let Q=0;Q<G;Q++){let Me=$[Q];oe(Me[0]+U*c,Me[1]+U*c,Me[2]+U*c)}}r.addGroup(me,n.length/3-me,0)}h(ae,"buildLidFaces");function N(){let me=n.length/3,Q=0;J(z,Q),Q+=z.length;for(let Me=0,ve=k.length;Me<ve;Me++){let Ie=k[Me];J(Ie,Q),Q+=Ie.length}r.addGroup(me,n.length/3-me,1)}h(N,"buildSideFaces");function J(me,Q){let Me=me.length;for(;--Me>=0;){let ve=Me,Ie=Me-1;Ie<0&&(Ie=me.length-1);for(let ke=0,we=c+y*2;ke<we;ke++){let Oe=U*ke,Je=U*(ke+1),xt=Q+ve+Oe,ne=Q+Ie+Oe,W=Q+Ie+Je,_e=Q+ve+Je;xe(xt,ne,W,_e)}}}h(J,"sidewalls");function Y(me,Q,Me){l.push(me),l.push(Q),l.push(Me)}h(Y,"v");function oe(me,Q,Me){ge(me),ge(Q),ge(Me);let ve=n.length/3,Ie=w.generateTopUV(r,n,ve-3,ve-2,ve-1);Te(Ie[0]),Te(Ie[1]),Te(Ie[2])}h(oe,"f3");function xe(me,Q,Me,ve){ge(me),ge(Q),ge(ve),ge(Q),ge(Me),ge(ve);let Ie=n.length/3,ke=w.generateSideWallUV(r,n,Ie-6,Ie-3,Ie-2,Ie-1);Te(ke[0]),Te(ke[1]),Te(ke[3]),Te(ke[1]),Te(ke[2]),Te(ke[3])}h(xe,"f4");function ge(me){n.push(l[me*3+0]),n.push(l[me*3+1]),n.push(l[me*3+2])}h(ge,"addVertex");function Te(me){a.push(me.x),a.push(me.y)}h(Te,"addUV")}h(o,"addShape")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return GJ(t,r,e)}static fromJSON(e,t){let r=[];for(let a=0,o=e.shapes.length;a<o;a++){let s=t[e.shapes[a]];r.push(s)}let n=e.options.extrudePath;return n!==void 0&&(e.options.extrudePath=new ex[n.type]().fromJSON(n)),new HJ(r,e.options)}};h(jJ,"ExtrudeGeometry");var Dg=jJ,v2e={generateTopUV:function(i,e,t,r,n){let a=e[t*3],o=e[t*3+1],s=e[r*3],l=e[r*3+1],u=e[n*3],c=e[n*3+1];return[new Ne(a,o),new Ne(s,l),new Ne(u,c)]},generateSideWallUV:function(i,e,t,r,n,a){let o=e[t*3],s=e[t*3+1],l=e[t*3+2],u=e[r*3],c=e[r*3+1],p=e[r*3+2],d=e[n*3],m=e[n*3+1],g=e[n*3+2],_=e[a*3],y=e[a*3+1],x=e[a*3+2];return Math.abs(s-c)<Math.abs(o-u)?[new Ne(o,1-l),new Ne(u,1-p),new Ne(d,1-g),new Ne(_,1-x)]:[new Ne(s,1-l),new Ne(c,1-p),new Ne(m,1-g),new Ne(y,1-x)]}};function GJ(i,e,t){if(t.shapes=[],Array.isArray(i))for(let r=0,n=i.length;r<n;r++){let a=i[r];t.shapes.push(a.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}h(GJ,"toJSON$1");var WJ=class XJ extends Sa{constructor(e=new gJ(new le(-1,-1,0),new le(-1,1,0),new le(1,1,0)),t=64,r=1,n=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:n,closed:a};let o=e.computeFrenetFrames(t,a);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;let s=new le,l=new le,u=new Ne,c=new le,p=[],d=[],m=[],g=[];_(),this.setIndex(g),this.setAttribute("position",new qr(p,3)),this.setAttribute("normal",new qr(d,3)),this.setAttribute("uv",new qr(m,2));function _(){for(let b=0;b<t;b++)y(b);y(a===!1?t:0),w(),x()}h(_,"generateBufferData");function y(b){c=e.getPointAt(b/t,c);let C=o.normals[b],E=o.binormals[b];for(let T=0;T<=n;T++){let L=T/n*Math.PI*2,D=Math.sin(L),B=-Math.cos(L);l.x=B*C.x+D*E.x,l.y=B*C.y+D*E.y,l.z=B*C.z+D*E.z,l.normalize(),d.push(l.x,l.y,l.z),s.x=c.x+r*l.x,s.y=c.y+r*l.y,s.z=c.z+r*l.z,p.push(s.x,s.y,s.z)}}h(y,"generateSegment");function x(){for(let b=1;b<=t;b++)for(let C=1;C<=n;C++){let E=(n+1)*(b-1)+(C-1),T=(n+1)*b+(C-1),L=(n+1)*b+C,D=(n+1)*(b-1)+C;g.push(E,T,D),g.push(T,L,D)}}h(x,"generateIndices");function w(){for(let b=0;b<=t;b++)for(let C=0;C<=n;C++)u.x=b/t,u.y=C/n,m.push(u.x,u.y)}h(w,"generateUVs")}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new XJ(new ex[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}};h(WJ,"TubeGeometry");var x2e=WJ,qJ=class extends iu{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Rt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Rt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wT,this.normalScale=new Ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xa,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};h(qJ,"MeshStandardMaterial");var ZJ=qJ,YJ=class extends ZJ{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ne(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Nr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Rt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Rt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Rt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};h(YJ,"MeshPhysicalMaterial");var SAe=YJ,JJ=class extends iu{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Rt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Rt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wT,this.normalScale=new Ne(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xa,this.combine=_T,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};h(JJ,"MeshLambertMaterial");var rx=JJ;function Df(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}h(Df,"convertArray");function KJ(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}h(KJ,"isTypedArray");function QJ(i){function e(n,a){return i[n]-i[a]}h(e,"compareTime");let t=i.length,r=new Array(t);for(let n=0;n!==t;++n)r[n]=n;return r.sort(e),r}h(QJ,"getKeyframeOrder");function zS(i,e,t){let r=i.length,n=new i.constructor(r);for(let a=0,o=0;o!==r;++a){let s=t[a]*e;for(let l=0;l!==e;++l)n[o++]=i[s+l]}return n}h(zS,"sortedArray");function FT(i,e,t,r){let n=1,a=i[0];for(;a!==void 0&&a[r]===void 0;)a=i[n++];if(a===void 0)return;let o=a[r];if(o!==void 0)if(Array.isArray(o))do o=a[r],o!==void 0&&(e.push(a.time),t.push.apply(t,o)),a=i[n++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[r],o!==void 0&&(e.push(a.time),o.toArray(t,t.length)),a=i[n++];while(a!==void 0);else do o=a[r],o!==void 0&&(e.push(a.time),t.push(o)),a=i[n++];while(a!==void 0)}h(FT,"flattenJSON");var eK=class{constructor(e,t,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,r=this._cachedIndex,n=t[r],a=t[r-1];e:{t:{let o;i:{r:if(!(e<n)){for(let s=r+2;;){if(n===void 0){if(e<a)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===s)break;if(a=n,n=t[++r],e<n)break t}o=t.length;break i}if(!(e>=a)){let s=t[1];e<s&&(r=2,a=s);for(let l=r-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(n=a,a=t[--r-1],e>=a)break t}o=r,r=0;break i}break e}for(;r<o;){let s=r+o>>>1;e<t[s]?o=s:r=s+1}if(n=t[r],a=t[r-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,a,n)}return this.interpolate_(r,a,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,a=e*n;for(let o=0;o!==n;++o)t[o]=r[a+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}};h(eK,"Interpolant");var I_=eK,tK=class extends I_{constructor(e,t,r,n){super(e,t,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:yI,endingEnd:yI}}intervalChanged_(e,t,r){let n=this.parameterPositions,a=e-2,o=e+1,s=n[a],l=n[o];if(s===void 0)switch(this.getSettings_().endingStart){case vI:a=e,s=2*t-r;break;case xI:a=n.length-2,s=t+n[a]-n[a+1];break;default:a=e,s=r}if(l===void 0)switch(this.getSettings_().endingEnd){case vI:o=e,l=2*r-t;break;case xI:o=1,l=r+n[1]-n[0];break;default:o=e-1,l=t}let u=(r-t)*.5,c=this.valueSize;this._weightPrev=u/(t-s),this._weightNext=u/(l-r),this._offsetPrev=a*c,this._offsetNext=o*c}interpolate_(e,t,r,n){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=e*s,u=l-s,c=this._offsetPrev,p=this._offsetNext,d=this._weightPrev,m=this._weightNext,g=(r-t)/(n-t),_=g*g,y=_*g,x=-d*y+2*d*_-d*g,w=(1+d)*y+(-1.5-2*d)*_+(-.5+d)*g+1,b=(-1-m)*y+(1.5+m)*_+.5*g,C=m*y-m*_;for(let E=0;E!==s;++E)a[E]=x*o[c+E]+w*o[u+E]+b*o[l+E]+C*o[p+E];return a}};h(tK,"CubicInterpolant");var _2e=tK,iK=class extends I_{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=e*s,u=l-s,c=(r-t)/(n-t),p=1-c;for(let d=0;d!==s;++d)a[d]=o[u+d]*p+o[l+d]*c;return a}};h(iK,"LinearInterpolant");var b2e=iK,rK=class extends I_{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}};h(rK,"DiscreteInterpolant");var w2e=rK,nK=class{constructor(e,t,r,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Df(t,this.TimeBufferType),this.values=Df(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Df(e.times,Array),values:Df(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(r.interpolation=n)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new w2e(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new b2e(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new _2e(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Wv:t=this.InterpolantFactoryMethodDiscrete;break;case Xv:t=this.InterpolantFactoryMethodLinear;break;case Z2:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Wv;case this.InterpolantFactoryMethodLinear:return Xv;case this.InterpolantFactoryMethodSmooth:return Z2}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let r=0,n=t.length;r!==n;++r)t[r]*=e}return this}trim(e,t){let r=this.times,n=r.length,a=0,o=n-1;for(;a!==n&&r[a]<e;)++a;for(;o!==-1&&r[o]>t;)--o;if(++o,a!==0||o!==n){a>=o&&(o=Math.max(o,1),a=o-1);let s=this.getValueSize();this.times=r.slice(a,o),this.values=this.values.slice(a*s,o*s)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let r=this.times,n=this.values,a=r.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let s=0;s!==a;s++){let l=r[s];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,l,o),e=!1;break}o=l}if(n!==void 0&&KJ(n))for(let s=0,l=n.length;s!==l;++s){let u=n[s];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,u),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),n=this.getInterpolation()===Z2,a=e.length-1,o=1;for(let s=1;s<a;++s){let l=!1,u=e[s],c=e[s+1];if(u!==c&&(s!==1||u!==e[0]))if(n)l=!0;else{let p=s*r,d=p-r,m=p+r;for(let g=0;g!==r;++g){let _=t[p+g];if(_!==t[d+g]||_!==t[m+g]){l=!0;break}}}if(l){if(s!==o){e[o]=e[s];let p=s*r,d=o*r;for(let m=0;m!==r;++m)t[d+m]=t[p+m]}++o}}if(a>0){e[o]=e[a];for(let s=a*r,l=o*r,u=0;u!==r;++u)t[l+u]=t[s+u];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*r)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),r=this.constructor,n=new r(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}};h(nK,"KeyframeTrack");var ns=nK;ns.prototype.TimeBufferType=Float32Array;ns.prototype.ValueBufferType=Float32Array;ns.prototype.DefaultInterpolation=Xv;var aK=class extends ns{};h(aK,"BooleanKeyframeTrack");var Md=aK;Md.prototype.ValueTypeName="bool";Md.prototype.ValueBufferType=Array;Md.prototype.DefaultInterpolation=Wv;Md.prototype.InterpolantFactoryMethodLinear=void 0;Md.prototype.InterpolantFactoryMethodSmooth=void 0;var oK=class extends ns{};h(oK,"ColorKeyframeTrack");var sK=oK;sK.prototype.ValueTypeName="color";var lK=class extends ns{};h(lK,"NumberKeyframeTrack");var nx=lK;nx.prototype.ValueTypeName="number";var uK=class extends I_{constructor(e,t,r,n){super(e,t,r,n)}interpolate_(e,t,r,n){let a=this.resultBuffer,o=this.sampleValues,s=this.valueSize,l=(r-t)/(n-t),u=e*s;for(let c=u+s;u!==c;u+=4)Th.slerpFlat(a,0,o,u-s,o,u,l);return a}};h(uK,"QuaternionLinearInterpolant");var S2e=uK,hK=class extends ns{InterpolantFactoryMethodLinear(e){return new S2e(this.times,this.values,this.getValueSize(),e)}};h(hK,"QuaternionKeyframeTrack");var kg=hK;kg.prototype.ValueTypeName="quaternion";kg.prototype.DefaultInterpolation=Xv;kg.prototype.InterpolantFactoryMethodSmooth=void 0;var cK=class extends ns{};h(cK,"StringKeyframeTrack");var Cd=cK;Cd.prototype.ValueTypeName="string";Cd.prototype.ValueBufferType=Array;Cd.prototype.DefaultInterpolation=Wv;Cd.prototype.InterpolantFactoryMethodLinear=void 0;Cd.prototype.InterpolantFactoryMethodSmooth=void 0;var pK=class extends ns{};h(pK,"VectorKeyframeTrack");var ax=pK;ax.prototype.ValueTypeName="vector";var dK=class{constructor(e,t=-1,r,n=_0e){this.name=e,this.tracks=r,this.duration=t,this.blendMode=n,this.uuid=va(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],r=e.tracks,n=1/(e.fps||1);for(let o=0,s=r.length;o!==s;++o)t.push(mK(r[o]).scale(n));let a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){let t=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,o=r.length;a!==o;++a)t.push(ns.toJSON(r[a]));return n}static CreateFromMorphTargetSequence(e,t,r,n){let a=t.length,o=[];for(let s=0;s<a;s++){let l=[],u=[];l.push((s+a-1)%a,s,(s+1)%a),u.push(0,1,0);let c=QJ(l);l=zS(l,1,c),u=zS(u,1,c),!n&&l[0]===0&&(l.push(a),u.push(u[0])),o.push(new nx(".morphTargetInfluences["+t[s].name+"]",l,u).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){let n=e;r=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<r.length;n++)if(r[n].name===t)return r[n];return null}static CreateClipsFromMorphTargetSequences(e,t,r){let n={},a=/^([\w-]*?)([\d]+)$/;for(let s=0,l=e.length;s<l;s++){let u=e[s],c=u.name.match(a);if(c&&c.length>1){let p=c[1],d=n[p];d||(n[p]=d=[]),d.push(u)}}let o=[];for(let s in n)o.push(this.CreateFromMorphTargetSequence(s,n[s],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=h(function(c,p,d,m,g){if(d.length!==0){let _=[],y=[];FT(d,_,y,m),_.length!==0&&g.push(new c(p,_,y))}},"addNonemptyTrack"),n=[],a=e.name||"default",o=e.fps||30,s=e.blendMode,l=e.length||-1,u=e.hierarchy||[];for(let c=0;c<u.length;c++){let p=u[c].keys;if(!(!p||p.length===0))if(p[0].morphTargets){let d={},m;for(m=0;m<p.length;m++)if(p[m].morphTargets)for(let g=0;g<p[m].morphTargets.length;g++)d[p[m].morphTargets[g]]=-1;for(let g in d){let _=[],y=[];for(let x=0;x!==p[m].morphTargets.length;++x){let w=p[m];_.push(w.time),y.push(w.morphTarget===g?1:0)}n.push(new nx(".morphTargetInfluence["+g+"]",_,y))}l=d.length*o}else{let d=".bones["+t[c].name+"]";r(ax,d+".position",p,"pos",n),r(kg,d+".quaternion",p,"rot",n),r(ax,d+".scale",p,"scl",n)}}return n.length===0?null:new this(a,l,n,s)}resetDuration(){let e=this.tracks,t=0;for(let r=0,n=e.length;r!==n;++r){let a=this.tracks[r];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};h(dK,"AnimationClip");var zAe=dK;function fK(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return nx;case"vector":case"vector2":case"vector3":case"vector4":return ax;case"color":return sK;case"quaternion":return kg;case"bool":case"boolean":return Md;case"string":return Cd}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}h(fK,"getTrackTypeForValueTypeName");function mK(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let e=fK(i.type);if(i.times===void 0){let t=[],r=[];FT(i.keys,t,r,"value"),i.times=t,i.values=r}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}h(mK,"parseKeyframeTrack");var Pl={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},gK=class{constructor(e,t,r){let n=this,a=!1,o=0,s=0,l,u=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(c){s++,a===!1&&n.onStart!==void 0&&n.onStart(c,o,s),a=!0},this.itemEnd=function(c){o++,n.onProgress!==void 0&&n.onProgress(c,o,s),o===s&&(a=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(c){n.onError!==void 0&&n.onError(c)},this.resolveURL=function(c){return l?l(c):c},this.setURLModifier=function(c){return l=c,this},this.addHandler=function(c,p){return u.push(c,p),this},this.removeHandler=function(c){let p=u.indexOf(c);return p!==-1&&u.splice(p,2),this},this.getHandler=function(c){for(let p=0,d=u.length;p<d;p+=2){let m=u[p],g=u[p+1];if(m.global&&(m.lastIndex=0),m.test(c))return g}return null}}};h(gK,"LoadingManager");var M2e=gK,C2e=new M2e,yK=class{constructor(e){this.manager=e!==void 0?e:C2e,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(n,a){r.load(e,n,t,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};h(yK,"Loader");var Rg=yK;Rg.DEFAULT_MATERIAL_NAME="__DEFAULT";var ds={},vK=class extends Error{constructor(e,t){super(e),this.response=t}};h(vK,"HttpError");var E2e=vK,xK=class extends Rg{constructor(e){super(e)}load(e,t,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=Pl.get(e);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(ds[e]!==void 0){ds[e].push({onLoad:t,onProgress:r,onError:n});return}ds[e]=[],ds[e].push({onLoad:t,onProgress:r,onError:n});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,l=this.responseType;fetch(o).then(u=>{if(u.status===200||u.status===0){if(u.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||u.body===void 0||u.body.getReader===void 0)return u;let c=ds[e],p=u.body.getReader(),d=u.headers.get("Content-Length")||u.headers.get("X-File-Size"),m=d?parseInt(d):0,g=m!==0,_=0,y=new ReadableStream({start(x){w();function w(){p.read().then(({done:b,value:C})=>{if(b)x.close();else{_+=C.byteLength;let E=new ProgressEvent("progress",{lengthComputable:g,loaded:_,total:m});for(let T=0,L=c.length;T<L;T++){let D=c[T];D.onProgress&&D.onProgress(E)}x.enqueue(C),w()}})}h(w,"readData")}});return new Response(y)}else throw new E2e(`fetch for "${u.url}" responded with ${u.status}: ${u.statusText}`,u)}).then(u=>{switch(l){case"arraybuffer":return u.arrayBuffer();case"blob":return u.blob();case"document":return u.text().then(c=>new DOMParser().parseFromString(c,s));case"json":return u.json();default:if(s===void 0)return u.text();{let c=/charset="?([^;"\s]*)"?/i.exec(s),p=c&&c[1]?c[1].toLowerCase():void 0,d=new TextDecoder(p);return u.arrayBuffer().then(m=>d.decode(m))}}}).then(u=>{Pl.add(e,u);let c=ds[e];delete ds[e];for(let p=0,d=c.length;p<d;p++){let m=c[p];m.onLoad&&m.onLoad(u)}}).catch(u=>{let c=ds[e];if(c===void 0)throw this.manager.itemError(e),u;delete ds[e];for(let p=0,d=c.length;p<d;p++){let m=c[p];m.onError&&m.onError(u)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}};h(xK,"FileLoader");var jAe=xK,_K=class extends Rg{constructor(e){super(e)}load(e,t,r,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Pl.get(e);if(o!==void 0)return a.manager.itemStart(e),setTimeout(function(){t&&t(o),a.manager.itemEnd(e)},0),o;let s=rd("img");function l(){c(),Pl.add(e,this),t&&t(this),a.manager.itemEnd(e)}h(l,"onImageLoad");function u(p){c(),n&&n(p),a.manager.itemError(e),a.manager.itemEnd(e)}h(u,"onImageError");function c(){s.removeEventListener("load",l,!1),s.removeEventListener("error",u,!1)}return h(c,"removeEventListeners"),s.addEventListener("load",l,!1),s.addEventListener("error",u,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(s.crossOrigin=this.crossOrigin),a.manager.itemStart(e),s.src=e,s}};h(_K,"ImageLoader");var T2e=_K,bK=class extends Rg{constructor(e){super(e)}load(e,t,r,n){let a=new Ln,o=new T2e(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(s){a.image=s,a.needsUpdate=!0,t!==void 0&&t(a)},r,n),a}};h(bK,"TextureLoader");var OT=bK,wK=class extends or{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Rt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}};h(wK,"Light");var L_=wK,Tb=new Gt,m8=new le,g8=new le,SK=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ne(512,512),this.map=null,this.mapPass=null,this.matrix=new Gt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Pg,this._frameExtents=new Ne(1,1),this._viewportCount=1,this._viewports=[new Ai(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;m8.setFromMatrixPosition(e.matrixWorld),t.position.copy(m8),g8.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(g8),t.updateMatrixWorld(),Tb.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Tb),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(Tb)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};h(SK,"LightShadow");var BT=SK,MK=class extends BT{constructor(){super(new jn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=id*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;(r!==t.fov||n!==t.aspect||a!==t.far)&&(t.fov=r,t.aspect=n,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}};h(MK,"SpotLightShadow");var P2e=MK,CK=class extends L_{constructor(e,t,r=0,n=Math.PI/3,a=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(or.DEFAULT_UP),this.updateMatrix(),this.target=new or,this.distance=r,this.angle=n,this.penumbra=a,this.decay=o,this.map=null,this.shadow=new P2e}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};h(CK,"SpotLight");var YAe=CK,y8=new Gt,ef=new le,Pb=new le,EK=class extends BT{constructor(){super(new jn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ne(4,2),this._viewportCount=6,this._viewports=[new Ai(2,1,1,1),new Ai(0,1,1,1),new Ai(3,1,1,1),new Ai(1,1,1,1),new Ai(3,0,1,1),new Ai(1,0,1,1)],this._cubeDirections=[new le(1,0,0),new le(-1,0,0),new le(0,0,1),new le(0,0,-1),new le(0,1,0),new le(0,-1,0)],this._cubeUps=[new le(0,1,0),new le(0,1,0),new le(0,1,0),new le(0,1,0),new le(0,0,1),new le(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,n=this.matrix,a=e.distance||r.far;a!==r.far&&(r.far=a,r.updateProjectionMatrix()),ef.setFromMatrixPosition(e.matrixWorld),r.position.copy(ef),Pb.copy(r.position),Pb.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(Pb),r.updateMatrixWorld(),n.makeTranslation(-ef.x,-ef.y,-ef.z),y8.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(y8)}};h(EK,"PointLightShadow");var A2e=EK,TK=class extends L_{constructor(e,t,r=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new A2e}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};h(TK,"PointLight");var QAe=TK,PK=class extends BT{constructor(){super(new _q(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}};h(PK,"DirectionalLightShadow");var I2e=PK,AK=class extends L_{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(or.DEFAULT_UP),this.updateMatrix(),this.target=new or,this.shadow=new I2e}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}};h(AK,"DirectionalLight");var IK=AK,LK=class extends L_{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}};h(LK,"AmbientLight");var L2e=LK,DK=class{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,n=e.length;r<n;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}};h(DK,"LoaderUtils");var n6e=DK,kK=class extends Rg{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let a=this,o=Pl.get(e);if(o!==void 0){if(a.manager.itemStart(e),o.then){o.then(u=>{t&&t(u),a.manager.itemEnd(e)}).catch(u=>{n&&n(u)});return}return setTimeout(function(){t&&t(o),a.manager.itemEnd(e)},0),o}let s={};s.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",s.headers=this.requestHeader;let l=fetch(e,s).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(u){return Pl.add(e,u),t&&t(u),a.manager.itemEnd(e),u}).catch(function(u){n&&n(u),Pl.remove(e),a.manager.itemError(e),a.manager.itemEnd(e)});Pl.add(e,l),a.manager.itemStart(e)}};h(kK,"ImageBitmapLoader");var o6e=kK,RK=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=NS(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=NS();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};h(RK,"Clock");var D2e=RK;function NS(){return(typeof performance>"u"?Date:performance).now()}h(NS,"now");var zT="\\[\\]\\.:\\/",k2e=new RegExp("["+zT+"]","g"),NT="[^"+zT+"]",R2e="[^"+zT.replace("\\.","")+"]",F2e=/((?:WC+[\/:])*)/.source.replace("WC",NT),O2e=/(WCOD+)?/.source.replace("WCOD",R2e),B2e=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",NT),z2e=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",NT),N2e=new RegExp("^"+F2e+O2e+B2e+z2e+"$"),$2e=["material","materials","bones","map"],FK=class{constructor(e,t,r){let n=r||cr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();let r=this._targetGroup.nCachedObjects_,n=this._bindings[r];n!==void 0&&n.getValue(e,t)}setValue(e,t){let r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,a=r.length;n!==a;++n)r[n].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}};h(FK,"Composite");var U2e=FK,OK=class mc{constructor(e,t,r){this.path=t,this.parsedPath=r||mc.parseTrackName(t),this.node=mc.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new mc.Composite(e,t,r):new mc(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(k2e,"")}static parseTrackName(e){let t=N2e.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let a=r.nodeName.substring(n+1);$2e.indexOf(a)!==-1&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=a)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){let r=h(function(a){for(let o=0;o<a.length;o++){let s=a[o];if(s.name===t||s.uuid===t)return s;let l=r(s.children);if(l)return l}return null},"searchNodeSubtree"),n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let r=this.resolvedProperty;for(let n=0,a=r.length;n!==a;++n)e[t++]=r[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let r=this.resolvedProperty;for(let n=0,a=r.length;n!==a;++n)r[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,a=r.length;n!==a;++n)r[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let r=this.resolvedProperty;for(let n=0,a=r.length;n!==a;++n)r[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,r=t.objectName,n=t.propertyName,a=t.propertyIndex;if(e||(e=mc.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===u){u=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(u!==void 0){if(e[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[u]}}let o=e[n];if(o===void 0){let u=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+n+" but it wasn't found.",e);return}let s=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?s=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(s=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(a!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=n;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};h(OK,"PropertyBinding");var cr=OK;cr.Composite=U2e;cr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};cr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};cr.prototype.GetterByBindingType=[cr.prototype._getValue_direct,cr.prototype._getValue_array,cr.prototype._getValue_arrayElement,cr.prototype._getValue_toArray];cr.prototype.SetterByBindingTypeAndVersioning=[[cr.prototype._setValue_direct,cr.prototype._setValue_direct_setNeedsUpdate,cr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[cr.prototype._setValue_array,cr.prototype._setValue_array_setNeedsUpdate,cr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[cr.prototype._setValue_arrayElement,cr.prototype._setValue_arrayElement_setNeedsUpdate,cr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[cr.prototype._setValue_fromArray,cr.prototype._setValue_fromArray_setNeedsUpdate,cr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var BK=class zK{constructor(e){this.value=e}clone(){return new zK(this.value.clone===void 0?this.value:this.value.clone())}};h(BK,"Uniform");var u6e=BK,v8=new Gt,NK=class{constructor(e,t,r=0,n=1/0){this.ray=new Tg(e,t),this.near=r,this.far=n,this.camera=null,this.layers=new ET,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return v8.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(v8),this}intersectObject(e,t=!0,r=[]){return ox(e,this,r,t),r.sort($S),r}intersectObjects(e,t=!0,r=[]){for(let n=0,a=e.length;n<a;n++)ox(e[n],this,r,t);return r.sort($S),r}};h(NK,"Raycaster");var Fg=NK;function $S(i,e){return i.distance-e.distance}h($S,"ascSort");function ox(i,e,t,r){if(i.layers.test(e.layers)&&i.raycast(e,t),r===!0){let n=i.children;for(let a=0,o=n.length;a<o;a++)ox(n[a],e,t,!0)}}h(ox,"intersect");var x8=new Ne,$K=class{constructor(e=new Ne(1/0,1/0),t=new Ne(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=x8.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,x8).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}};h($K,"Box2");var V2e=$K;typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:xT}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=xT);R();function Ed(i,e=!1){let t=i[0].index!==null,r=new Set(Object.keys(i[0].attributes)),n=new Set(Object.keys(i[0].morphAttributes)),a={},o={},s=i[0].morphTargetsRelative,l=new Sa,u=0;for(let c=0;c<i.length;++c){let p=i[c],d=0;if(t!==(p.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let m in p.attributes){if(!r.has(m))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;a[m]===void 0&&(a[m]=[]),a[m].push(p.attributes[m]),d++}if(d!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". Make sure all geometries have the same number of attributes."),null;if(s!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let m in p.morphAttributes){if(!n.has(m))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+".  .morphAttributes must be consistent throughout all geometries."),null;o[m]===void 0&&(o[m]=[]),o[m].push(p.morphAttributes[m])}if(e){let m;if(t)m=p.index.count;else if(p.attributes.position!==void 0)m=p.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+c+". The geometry must have either an index or a position attribute"),null;l.addGroup(u,m,c),u+=m}}if(t){let c=0,p=[];for(let d=0;d<i.length;++d){let m=i[d].index;for(let g=0;g<m.count;++g)p.push(m.getX(g)+c);c+=i[d].attributes.position.count}l.setIndex(p)}for(let c in a){let p=US(a[c]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" attribute."),null;l.setAttribute(c,p)}for(let c in o){let p=o[c][0].length;if(p===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[c]=[];for(let d=0;d<p;++d){let m=[];for(let _=0;_<o[c].length;++_)m.push(o[c][_][d]);let g=US(m);if(!g)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+c+" morphAttribute."),null;l.morphAttributes[c].push(g)}}return l}h(Ed,"mergeGeometries");function US(i){let e,t,r,n=-1,a=0;for(let u=0;u<i.length;++u){let c=i[u];if(e===void 0&&(e=c.array.constructor),e!==c.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=c.itemSize),t!==c.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=c.normalized),r!==c.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(n===-1&&(n=c.gpuType),n!==c.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;a+=c.count*t}let o=new e(a),s=new Ur(o,t,r),l=0;for(let u=0;u<i.length;++u){let c=i[u];if(c.isInterleavedBufferAttribute){let p=l/t;for(let d=0,m=c.count;d<m;d++)for(let g=0;g<t;g++){let _=c.getComponent(d,g);s.setComponent(d+p,g,_)}}else o.set(c.array,l);l+=c.count*t}return n!==void 0&&(s.gpuType=n),s}h(US,"mergeAttributes");function j2e(i,e){if(e===b0e)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),i;if(e===_I||e===w0e){let t=i.getIndex();if(t===null){let o=[],s=i.getAttribute("position");if(s!==void 0){for(let l=0;l<s.count;l++)o.push(l);i.setIndex(o),t=i.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),i}let r=t.count-2,n=[];if(e===_I)for(let o=1;o<=r;o++)n.push(t.getX(0)),n.push(t.getX(o)),n.push(t.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(n.push(t.getX(o)),n.push(t.getX(o+1)),n.push(t.getX(o+2))):(n.push(t.getX(o+2)),n.push(t.getX(o+1)),n.push(t.getX(o)));n.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=i.clone();return a.setIndex(n),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),i}h(j2e,"toTrianglesDrawMode");var H2e=tt((i,e)=>{R(),function(t,r){typeof i=="object"&&typeof e<"u"?e.exports=r():typeof define=="function"&&define.amd?define(r):(t=t||self).RBush=r()}(i,function(){function t(w,b,C,E,T){h(function L(D,B,A,k,$){for(;k>A;){if(k-A>600){var z=k-A+1,P=B-A+1,U=Math.log(z),G=.5*Math.exp(2*U/3),K=.5*Math.sqrt(U*G*(z-G)/z)*(P-z/2<0?-1:1),O=Math.max(A,Math.floor(B-P*G/z+K)),V=Math.min(k,Math.floor(B+(z-P)*G/z+K));L(D,B,O,V,$)}var j=D[B],q=A,ee=k;for(r(D,A,B),$(D[k],j)>0&&r(D,A,k);q<ee;){for(r(D,q,ee),q++,ee--;$(D[q],j)<0;)q++;for(;$(D[ee],j)>0;)ee--}$(D[A],j)===0?r(D,A,ee):r(D,++ee,k),ee<=B&&(A=ee+1),B<=ee&&(k=ee-1)}},"t")(w,b,C||0,E||w.length-1,T||n)}h(t,"t");function r(w,b,C){var E=w[b];w[b]=w[C],w[C]=E}h(r,"i");function n(w,b){return w<b?-1:w>b?1:0}h(n,"n");var a=h(function(w){w===void 0&&(w=9),this._maxEntries=Math.max(4,w),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()},"r");function o(w,b,C){if(!C)return b.indexOf(w);for(var E=0;E<b.length;E++)if(C(w,b[E]))return E;return-1}h(o,"e");function s(w,b){l(w,0,w.children.length,b,w)}h(s,"a");function l(w,b,C,E,T){T||(T=y(null)),T.minX=1/0,T.minY=1/0,T.maxX=-1/0,T.maxY=-1/0;for(var L=b;L<C;L++){var D=w.children[L];u(T,w.leaf?E(D):D)}return T}h(l,"h");function u(w,b){return w.minX=Math.min(w.minX,b.minX),w.minY=Math.min(w.minY,b.minY),w.maxX=Math.max(w.maxX,b.maxX),w.maxY=Math.max(w.maxY,b.maxY),w}h(u,"o");function c(w,b){return w.minX-b.minX}h(c,"s");function p(w,b){return w.minY-b.minY}h(p,"l");function d(w){return(w.maxX-w.minX)*(w.maxY-w.minY)}h(d,"f");function m(w){return w.maxX-w.minX+(w.maxY-w.minY)}h(m,"u");function g(w,b){return w.minX<=b.minX&&w.minY<=b.minY&&b.maxX<=w.maxX&&b.maxY<=w.maxY}h(g,"m");function _(w,b){return b.minX<=w.maxX&&b.minY<=w.maxY&&b.maxX>=w.minX&&b.maxY>=w.minY}h(_,"c");function y(w){return{children:w,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}h(y,"p");function x(w,b,C,E,T){for(var L=[b,C];L.length;)if(!((C=L.pop())-(b=L.pop())<=E)){var D=b+Math.ceil((C-b)/E/2)*E;t(w,D,b,C,T),L.push(b,D,D,C)}}return h(x,"d"),a.prototype.all=function(){return this._all(this.data,[])},a.prototype.search=function(w){var b=this.data,C=[];if(!_(w,b))return C;for(var E=this.toBBox,T=[];b;){for(var L=0;L<b.children.length;L++){var D=b.children[L],B=b.leaf?E(D):D;_(w,B)&&(b.leaf?C.push(D):g(w,B)?this._all(D,C):T.push(D))}b=T.pop()}return C},a.prototype.collides=function(w){var b=this.data;if(!_(w,b))return!1;for(var C=[];b;){for(var E=0;E<b.children.length;E++){var T=b.children[E],L=b.leaf?this.toBBox(T):T;if(_(w,L)){if(b.leaf||g(w,L))return!0;C.push(T)}}b=C.pop()}return!1},a.prototype.load=function(w){if(!w||!w.length)return this;if(w.length<this._minEntries){for(var b=0;b<w.length;b++)this.insert(w[b]);return this}var C=this._build(w.slice(),0,w.length-1,0);if(this.data.children.length)if(this.data.height===C.height)this._splitRoot(this.data,C);else{if(this.data.height<C.height){var E=this.data;this.data=C,C=E}this._insert(C,this.data.height-C.height-1,!0)}else this.data=C;return this},a.prototype.insert=function(w){return w&&this._insert(w,this.data.height-1),this},a.prototype.clear=function(){return this.data=y([]),this},a.prototype.remove=function(w,b){if(!w)return this;for(var C,E,T,L=this.data,D=this.toBBox(w),B=[],A=[];L||B.length;){if(L||(L=B.pop(),E=B[B.length-1],C=A.pop(),T=!0),L.leaf){var k=o(w,L.children,b);if(k!==-1)return L.children.splice(k,1),B.push(L),this._condense(B),this}T||L.leaf||!g(L,D)?E?(C++,L=E.children[C],T=!1):L=null:(B.push(L),A.push(C),C=0,E=L,L=L.children[0])}return this},a.prototype.toBBox=function(w){return w},a.prototype.compareMinX=function(w,b){return w.minX-b.minX},a.prototype.compareMinY=function(w,b){return w.minY-b.minY},a.prototype.toJSON=function(){return this.data},a.prototype.fromJSON=function(w){return this.data=w,this},a.prototype._all=function(w,b){for(var C=[];w;)w.leaf?b.push.apply(b,w.children):C.push.apply(C,w.children),w=C.pop();return b},a.prototype._build=function(w,b,C,E){var T,L=C-b+1,D=this._maxEntries;if(L<=D)return s(T=y(w.slice(b,C+1)),this.toBBox),T;E||(E=Math.ceil(Math.log(L)/Math.log(D)),D=Math.ceil(L/Math.pow(D,E-1))),(T=y([])).leaf=!1,T.height=E;var B=Math.ceil(L/D),A=B*Math.ceil(Math.sqrt(D));x(w,b,C,A,this.compareMinX);for(var k=b;k<=C;k+=A){var $=Math.min(k+A-1,C);x(w,k,$,B,this.compareMinY);for(var z=k;z<=$;z+=B){var P=Math.min(z+B-1,$);T.children.push(this._build(w,z,P,E-1))}}return s(T,this.toBBox),T},a.prototype._chooseSubtree=function(w,b,C,E){for(;E.push(b),!b.leaf&&E.length-1!==C;){for(var T=1/0,L=1/0,D=void 0,B=0;B<b.children.length;B++){var A=b.children[B],k=d(A),$=(z=w,P=A,(Math.max(P.maxX,z.maxX)-Math.min(P.minX,z.minX))*(Math.max(P.maxY,z.maxY)-Math.min(P.minY,z.minY))-k);$<L?(L=$,T=k<T?k:T,D=A):$===L&&k<T&&(T=k,D=A)}b=D||b.children[0]}var z,P;return b},a.prototype._insert=function(w,b,C){var E=C?w:this.toBBox(w),T=[],L=this._chooseSubtree(E,this.data,b,T);for(L.children.push(w),u(L,E);b>=0&&T[b].children.length>this._maxEntries;)this._split(T,b),b--;this._adjustParentBBoxes(E,T,b)},a.prototype._split=function(w,b){var C=w[b],E=C.children.length,T=this._minEntries;this._chooseSplitAxis(C,T,E);var L=this._chooseSplitIndex(C,T,E),D=y(C.children.splice(L,C.children.length-L));D.height=C.height,D.leaf=C.leaf,s(C,this.toBBox),s(D,this.toBBox),b?w[b-1].children.push(D):this._splitRoot(C,D)},a.prototype._splitRoot=function(w,b){this.data=y([w,b]),this.data.height=w.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},a.prototype._chooseSplitIndex=function(w,b,C){for(var E,T,L,D,B,A,k,$=1/0,z=1/0,P=b;P<=C-b;P++){var U=l(w,0,P,this.toBBox),G=l(w,P,C,this.toBBox),K=(T=U,L=G,D=void 0,B=void 0,A=void 0,k=void 0,D=Math.max(T.minX,L.minX),B=Math.max(T.minY,L.minY),A=Math.min(T.maxX,L.maxX),k=Math.min(T.maxY,L.maxY),Math.max(0,A-D)*Math.max(0,k-B)),O=d(U)+d(G);K<$?($=K,E=P,z=O<z?O:z):K===$&&O<z&&(z=O,E=P)}return E||C-b},a.prototype._chooseSplitAxis=function(w,b,C){var E=w.leaf?this.compareMinX:c,T=w.leaf?this.compareMinY:p;this._allDistMargin(w,b,C,E)<this._allDistMargin(w,b,C,T)&&w.children.sort(E)},a.prototype._allDistMargin=function(w,b,C,E){w.children.sort(E);for(var T=this.toBBox,L=l(w,0,b,T),D=l(w,C-b,C,T),B=m(L)+m(D),A=b;A<C-b;A++){var k=w.children[A];u(L,w.leaf?T(k):k),B+=m(L)}for(var $=C-b-1;$>=b;$--){var z=w.children[$];u(D,w.leaf?T(z):z),B+=m(D)}return B},a.prototype._adjustParentBBoxes=function(w,b,C){for(var E=C;E>=0;E--)u(b[E],w)},a.prototype._condense=function(w){for(var b=w.length-1,C=void 0;b>=0;b--)w[b].children.length===0?b>0?(C=w[b-1].children).splice(C.indexOf(w[b]),1):this.clear():s(w[b],this.toBBox)},a})}),UK=tt(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0}),i.earthRadius=63710088e-1,i.factors={centimeters:i.earthRadius*100,centimetres:i.earthRadius*100,degrees:i.earthRadius/111325,feet:i.earthRadius*3.28084,inches:i.earthRadius*39.37,kilometers:i.earthRadius/1e3,kilometres:i.earthRadius/1e3,meters:i.earthRadius,metres:i.earthRadius,miles:i.earthRadius/1609.344,millimeters:i.earthRadius*1e3,millimetres:i.earthRadius*1e3,nauticalmiles:i.earthRadius/1852,radians:1,yards:i.earthRadius*1.0936},i.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/i.earthRadius,yards:1.0936133},i.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function e(k,$,z){z===void 0&&(z={});var P={type:"Feature"};return(z.id===0||z.id)&&(P.id=z.id),z.bbox&&(P.bbox=z.bbox),P.properties=$||{},P.geometry=k,P}h(e,"feature"),i.feature=e;function t(k,$,z){switch(k){case"Point":return r($).geometry;case"LineString":return s($).geometry;case"Polygon":return a($).geometry;case"MultiPoint":return p($).geometry;case"MultiLineString":return c($).geometry;case"MultiPolygon":return d($).geometry;default:throw new Error(k+" is invalid")}}h(t,"geometry"),i.geometry=t;function r(k,$,z){if(z===void 0&&(z={}),!k)throw new Error("coordinates is required");if(!Array.isArray(k))throw new Error("coordinates must be an Array");if(k.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!L(k[0])||!L(k[1]))throw new Error("coordinates must contain numbers");var P={type:"Point",coordinates:k};return e(P,$,z)}h(r,"point"),i.point=r;function n(k,$,z){return z===void 0&&(z={}),u(k.map(function(P){return r(P,$)}),z)}h(n,"points"),i.points=n;function a(k,$,z){z===void 0&&(z={});for(var P=0,U=k;P<U.length;P++){var G=U[P];if(G.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var K=0;K<G[G.length-1].length;K++)if(G[G.length-1][K]!==G[0][K])throw new Error("First and last Position are not equivalent.")}var O={type:"Polygon",coordinates:k};return e(O,$,z)}h(a,"polygon"),i.polygon=a;function o(k,$,z){return z===void 0&&(z={}),u(k.map(function(P){return a(P,$)}),z)}h(o,"polygons"),i.polygons=o;function s(k,$,z){if(z===void 0&&(z={}),k.length<2)throw new Error("coordinates must be an array of two or more positions");var P={type:"LineString",coordinates:k};return e(P,$,z)}h(s,"lineString"),i.lineString=s;function l(k,$,z){return z===void 0&&(z={}),u(k.map(function(P){return s(P,$)}),z)}h(l,"lineStrings"),i.lineStrings=l;function u(k,$){$===void 0&&($={});var z={type:"FeatureCollection"};return $.id&&(z.id=$.id),$.bbox&&(z.bbox=$.bbox),z.features=k,z}h(u,"featureCollection"),i.featureCollection=u;function c(k,$,z){z===void 0&&(z={});var P={type:"MultiLineString",coordinates:k};return e(P,$,z)}h(c,"multiLineString"),i.multiLineString=c;function p(k,$,z){z===void 0&&(z={});var P={type:"MultiPoint",coordinates:k};return e(P,$,z)}h(p,"multiPoint"),i.multiPoint=p;function d(k,$,z){z===void 0&&(z={});var P={type:"MultiPolygon",coordinates:k};return e(P,$,z)}h(d,"multiPolygon"),i.multiPolygon=d;function m(k,$,z){z===void 0&&(z={});var P={type:"GeometryCollection",geometries:k};return e(P,$,z)}h(m,"geometryCollection"),i.geometryCollection=m;function g(k,$){if($===void 0&&($=0),$&&!($>=0))throw new Error("precision must be a positive number");var z=Math.pow(10,$||0);return Math.round(k*z)/z}h(g,"round"),i.round=g;function _(k,$){$===void 0&&($="kilometers");var z=i.factors[$];if(!z)throw new Error($+" units is invalid");return k*z}h(_,"radiansToLength"),i.radiansToLength=_;function y(k,$){$===void 0&&($="kilometers");var z=i.factors[$];if(!z)throw new Error($+" units is invalid");return k/z}h(y,"lengthToRadians"),i.lengthToRadians=y;function x(k,$){return b(y(k,$))}h(x,"lengthToDegrees"),i.lengthToDegrees=x;function w(k){var $=k%360;return $<0&&($+=360),$}h(w,"bearingToAzimuth"),i.bearingToAzimuth=w;function b(k){var $=k%(2*Math.PI);return $*180/Math.PI}h(b,"radiansToDegrees"),i.radiansToDegrees=b;function C(k){var $=k%360;return $*Math.PI/180}h(C,"degreesToRadians"),i.degreesToRadians=C;function E(k,$,z){if($===void 0&&($="kilometers"),z===void 0&&(z="kilometers"),!(k>=0))throw new Error("length must be a positive number");return _(y(k,$),z)}h(E,"convertLength"),i.convertLength=E;function T(k,$,z){if($===void 0&&($="meters"),z===void 0&&(z="kilometers"),!(k>=0))throw new Error("area must be a positive number");var P=i.areaFactors[$];if(!P)throw new Error("invalid original units");var U=i.areaFactors[z];if(!U)throw new Error("invalid final units");return k/P*U}h(T,"convertArea"),i.convertArea=T;function L(k){return!isNaN(k)&&k!==null&&!Array.isArray(k)}h(L,"isNumber"),i.isNumber=L;function D(k){return!!k&&k.constructor===Object}h(D,"isObject"),i.isObject=D;function B(k){if(!k)throw new Error("bbox is required");if(!Array.isArray(k))throw new Error("bbox must be an Array");if(k.length!==4&&k.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");k.forEach(function($){if(!L($))throw new Error("bbox must only contain numbers")})}h(B,"validateBBox"),i.validateBBox=B;function A(k){if(!k)throw new Error("id is required");if(["string","number"].indexOf(typeof k)===-1)throw new Error("id must be a number or a string")}h(A,"validateId"),i.validateId=A}),G2e=tt(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});var e=UK();function t(b,C,E){if(b!==null)for(var T,L,D,B,A,k,$,z=0,P=0,U,G=b.type,K=G==="FeatureCollection",O=G==="Feature",V=K?b.features.length:1,j=0;j<V;j++){$=K?b.features[j].geometry:O?b.geometry:b,U=$?$.type==="GeometryCollection":!1,A=U?$.geometries.length:1;for(var q=0;q<A;q++){var ee=0,ae=0;if(B=U?$.geometries[q]:$,B!==null){k=B.coordinates;var N=B.type;switch(z=E&&(N==="Polygon"||N==="MultiPolygon")?1:0,N){case null:break;case"Point":if(C(k,P,j,ee,ae)===!1)return!1;P++,ee++;break;case"LineString":case"MultiPoint":for(T=0;T<k.length;T++){if(C(k[T],P,j,ee,ae)===!1)return!1;P++,N==="MultiPoint"&&ee++}N==="LineString"&&ee++;break;case"Polygon":case"MultiLineString":for(T=0;T<k.length;T++){for(L=0;L<k[T].length-z;L++){if(C(k[T][L],P,j,ee,ae)===!1)return!1;P++}N==="MultiLineString"&&ee++,N==="Polygon"&&ae++}N==="Polygon"&&ee++;break;case"MultiPolygon":for(T=0;T<k.length;T++){for(ae=0,L=0;L<k[T].length;L++){for(D=0;D<k[T][L].length-z;D++){if(C(k[T][L][D],P,j,ee,ae)===!1)return!1;P++}ae++}ee++}break;case"GeometryCollection":for(T=0;T<B.geometries.length;T++)if(t(B.geometries[T],C,E)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}h(t,"coordEach");function r(b,C,E,T){var L=E;return t(b,function(D,B,A,k,$){B===0&&E===void 0?L=D:L=C(L,D,B,A,k,$)},T),L}h(r,"coordReduce");function n(b,C){var E;switch(b.type){case"FeatureCollection":for(E=0;E<b.features.length&&C(b.features[E].properties,E)!==!1;E++);break;case"Feature":C(b.properties,0);break}}h(n,"propEach");function a(b,C,E){var T=E;return n(b,function(L,D){D===0&&E===void 0?T=L:T=C(T,L,D)}),T}h(a,"propReduce");function o(b,C){if(b.type==="Feature")C(b,0);else if(b.type==="FeatureCollection")for(var E=0;E<b.features.length&&C(b.features[E],E)!==!1;E++);}h(o,"featureEach");function s(b,C,E){var T=E;return o(b,function(L,D){D===0&&E===void 0?T=L:T=C(T,L,D)}),T}h(s,"featureReduce");function l(b){var C=[];return t(b,function(E){C.push(E)}),C}h(l,"coordAll");function u(b,C){var E,T,L,D,B,A,k,$,z,P,U=0,G=b.type==="FeatureCollection",K=b.type==="Feature",O=G?b.features.length:1;for(E=0;E<O;E++){for(A=G?b.features[E].geometry:K?b.geometry:b,$=G?b.features[E].properties:K?b.properties:{},z=G?b.features[E].bbox:K?b.bbox:void 0,P=G?b.features[E].id:K?b.id:void 0,k=A?A.type==="GeometryCollection":!1,B=k?A.geometries.length:1,L=0;L<B;L++){if(D=k?A.geometries[L]:A,D===null){if(C(null,U,$,z,P)===!1)return!1;continue}switch(D.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(C(D,U,$,z,P)===!1)return!1;break}case"GeometryCollection":{for(T=0;T<D.geometries.length;T++)if(C(D.geometries[T],U,$,z,P)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}U++}}h(u,"geomEach");function c(b,C,E){var T=E;return u(b,function(L,D,B,A,k){D===0&&E===void 0?T=L:T=C(T,L,D,B,A,k)}),T}h(c,"geomReduce");function p(b,C){u(b,function(E,T,L,D,B){var A=E===null?null:E.type;switch(A){case null:case"Point":case"LineString":case"Polygon":return C(e.feature(E,L,{bbox:D,id:B}),T,0)===!1?!1:void 0}var k;switch(A){case"MultiPoint":k="Point";break;case"MultiLineString":k="LineString";break;case"MultiPolygon":k="Polygon";break}for(var $=0;$<E.coordinates.length;$++){var z=E.coordinates[$],P={type:k,coordinates:z};if(C(e.feature(P,L),T,$)===!1)return!1}})}h(p,"flattenEach");function d(b,C,E){var T=E;return p(b,function(L,D,B){D===0&&B===0&&E===void 0?T=L:T=C(T,L,D,B)}),T}h(d,"flattenReduce");function m(b,C){p(b,function(E,T,L){var D=0;if(E.geometry){var B=E.geometry.type;if(!(B==="Point"||B==="MultiPoint")){var A,k=0,$=0,z=0;if(t(E,function(P,U,G,K,O){if(A===void 0||T>k||K>$||O>z){A=P,k=T,$=K,z=O,D=0;return}var V=e.lineString([A,P],E.properties);if(C(V,T,L,O,D)===!1)return!1;D++,A=P})===!1)return!1}}})}h(m,"segmentEach");function g(b,C,E){var T=E,L=!1;return m(b,function(D,B,A,k,$){L===!1&&E===void 0?T=D:T=C(T,D,B,A,k,$),L=!0}),T}h(g,"segmentReduce");function _(b,C){if(!b)throw new Error("geojson is required");p(b,function(E,T,L){if(E.geometry!==null){var D=E.geometry.type,B=E.geometry.coordinates;switch(D){case"LineString":if(C(E,T,L,0,0)===!1)return!1;break;case"Polygon":for(var A=0;A<B.length;A++)if(C(e.lineString(B[A],E.properties),T,L,A)===!1)return!1;break}}})}h(_,"lineEach");function y(b,C,E){var T=E;return _(b,function(L,D,B,A){D===0&&E===void 0?T=L:T=C(T,L,D,B,A)}),T}h(y,"lineReduce");function x(b,C){if(C=C||{},!e.isObject(C))throw new Error("options is invalid");var E=C.featureIndex||0,T=C.multiFeatureIndex||0,L=C.geometryIndex||0,D=C.segmentIndex||0,B=C.properties,A;switch(b.type){case"FeatureCollection":E<0&&(E=b.features.length+E),B=B||b.features[E].properties,A=b.features[E].geometry;break;case"Feature":B=B||b.properties,A=b.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":A=b;break;default:throw new Error("geojson is invalid")}if(A===null)return null;var k=A.coordinates;switch(A.type){case"Point":case"MultiPoint":return null;case"LineString":return D<0&&(D=k.length+D-1),e.lineString([k[D],k[D+1]],B,C);case"Polygon":return L<0&&(L=k.length+L),D<0&&(D=k[L].length+D-1),e.lineString([k[L][D],k[L][D+1]],B,C);case"MultiLineString":return T<0&&(T=k.length+T),D<0&&(D=k[T].length+D-1),e.lineString([k[T][D],k[T][D+1]],B,C);case"MultiPolygon":return T<0&&(T=k.length+T),L<0&&(L=k[T].length+L),D<0&&(D=k[T][L].length-D-1),e.lineString([k[T][L][D],k[T][L][D+1]],B,C)}throw new Error("geojson is invalid")}h(x,"findSegment");function w(b,C){if(C=C||{},!e.isObject(C))throw new Error("options is invalid");var E=C.featureIndex||0,T=C.multiFeatureIndex||0,L=C.geometryIndex||0,D=C.coordIndex||0,B=C.properties,A;switch(b.type){case"FeatureCollection":E<0&&(E=b.features.length+E),B=B||b.features[E].properties,A=b.features[E].geometry;break;case"Feature":B=B||b.properties,A=b.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":A=b;break;default:throw new Error("geojson is invalid")}if(A===null)return null;var k=A.coordinates;switch(A.type){case"Point":return e.point(k,B,C);case"MultiPoint":return T<0&&(T=k.length+T),e.point(k[T],B,C);case"LineString":return D<0&&(D=k.length+D),e.point(k[D],B,C);case"Polygon":return L<0&&(L=k.length+L),D<0&&(D=k[L].length+D),e.point(k[L][D],B,C);case"MultiLineString":return T<0&&(T=k.length+T),D<0&&(D=k[T].length+D),e.point(k[T][D],B,C);case"MultiPolygon":return T<0&&(T=k.length+T),L<0&&(L=k[T].length+L),D<0&&(D=k[T][L].length-D),e.point(k[T][L][D],B,C)}throw new Error("geojson is invalid")}h(w,"findPoint"),i.coordAll=l,i.coordEach=t,i.coordReduce=r,i.featureEach=o,i.featureReduce=s,i.findPoint=w,i.findSegment=x,i.flattenEach=p,i.flattenReduce=d,i.geomEach=u,i.geomReduce=c,i.lineEach=_,i.lineReduce=y,i.propEach=n,i.propReduce=a,i.segmentEach=m,i.segmentReduce=g}),VK=tt((i,e)=>{R();var t=Object.prototype.toString;e.exports=h(function(r){var n=t.call(r),a=n==="[object Arguments]";return a||(a=n!=="[object Array]"&&r!==null&&typeof r=="object"&&typeof r.length=="number"&&r.length>=0&&t.call(r.callee)==="[object Function]"),a},"isArguments")}),W2e=tt((i,e)=>{R();var t;Object.keys||(r=Object.prototype.hasOwnProperty,n=Object.prototype.toString,a=VK(),o=Object.prototype.propertyIsEnumerable,s=!o.call({toString:null},"toString"),l=o.call(function(){},"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],c=h(function(g){var _=g.constructor;return _&&_.prototype===g},"equalsConstructorPrototype"),p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if(typeof window>"u")return!1;for(var g in window)try{if(!p["$"+g]&&r.call(window,g)&&window[g]!==null&&typeof window[g]=="object")try{c(window[g])}catch{return!0}}catch{return!0}return!1}(),m=h(function(g){if(typeof window>"u"||!d)return c(g);try{return c(g)}catch{return!1}},"equalsConstructorPrototypeIfNotBuggy"),t=h(function(g){var _=g!==null&&typeof g=="object",y=n.call(g)==="[object Function]",x=a(g),w=_&&n.call(g)==="[object String]",b=[];if(!_&&!y&&!x)throw new TypeError("Object.keys called on a non-object");var C=l&&y;if(w&&g.length>0&&!r.call(g,0))for(var E=0;E<g.length;++E)b.push(String(E));if(x&&g.length>0)for(var T=0;T<g.length;++T)b.push(String(T));else for(var L in g)!(C&&L==="prototype")&&r.call(g,L)&&b.push(String(L));if(s)for(var D=m(g),B=0;B<u.length;++B)!(D&&u[B]==="constructor")&&r.call(g,u[B])&&b.push(u[B]);return b},"keys"));var r,n,a,o,s,l,u,c,p,d,m;e.exports=t}),$T=tt((i,e)=>{R();var t=Array.prototype.slice,r=VK(),n=Object.keys,a=n?h(function(s){return n(s)},"keys"):W2e(),o=Object.keys;a.shim=h(function(){if(Object.keys){var s=function(){var l=Object.keys(arguments);return l&&l.length===arguments.length}(1,2);s||(Object.keys=h(function(l){return r(l)?o(t.call(l)):o(l)},"keys"))}else Object.keys=a;return Object.keys||a},"shimObjectKeys"),e.exports=a}),X2e=tt((i,e)=>{R(),e.exports=Error}),q2e=tt((i,e)=>{R(),e.exports=EvalError}),Z2e=tt((i,e)=>{R(),e.exports=RangeError}),Y2e=tt((i,e)=>{R(),e.exports=ReferenceError}),jK=tt((i,e)=>{R(),e.exports=SyntaxError}),ru=tt((i,e)=>{R(),e.exports=TypeError}),J2e=tt((i,e)=>{R(),e.exports=URIError}),D_=tt((i,e)=>{R(),e.exports=h(function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;t[r]=a;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var o=Object.getOwnPropertySymbols(t);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(t,r);if(s.value!==a||s.enumerable!==!0)return!1}return!0},"hasSymbols")}),UT=tt((i,e)=>{R();var t=typeof Symbol<"u"&&Symbol,r=D_();e.exports=h(function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:r()},"hasNativeSymbols")}),K2e=tt((i,e)=>{R();var t={__proto__:null,foo:{}},r=Object;e.exports=h(function(){return{__proto__:t}.foo===t.foo&&!(t instanceof r)},"hasProto")}),Q2e=tt((i,e)=>{R();var t="Function.prototype.bind called on incompatible ",r=Object.prototype.toString,n=Math.max,a="[object Function]",o=h(function(u,c){for(var p=[],d=0;d<u.length;d+=1)p[d]=u[d];for(var m=0;m<c.length;m+=1)p[m+u.length]=c[m];return p},"concatty"),s=h(function(u,c){for(var p=[],d=c||0,m=0;d<u.length;d+=1,m+=1)p[m]=u[d];return p},"slicy"),l=h(function(u,c){for(var p="",d=0;d<u.length;d+=1)p+=u[d],d+1<u.length&&(p+=c);return p},"joiny");e.exports=h(function(u){var c=this;if(typeof c!="function"||r.apply(c)!==a)throw new TypeError(t+c);for(var p=s(arguments,1),d,m=h(function(){if(this instanceof d){var w=c.apply(this,o(p,arguments));return Object(w)===w?w:this}return c.apply(u,o(p,arguments))},"binder"),g=n(0,c.length-p.length),_=[],y=0;y<g;y++)_[y]="$"+y;if(d=Function("binder","return function ("+l(_,",")+"){ return binder.apply(this,arguments); }")(m),c.prototype){var x=h(function(){},"Empty");x.prototype=c.prototype,d.prototype=new x,x.prototype=null}return d},"bind")}),VT=tt((i,e)=>{R();var t=Q2e();e.exports=Function.prototype.bind||t}),HK=tt((i,e)=>{R();var t=Function.prototype.call,r=Object.prototype.hasOwnProperty,n=VT();e.exports=n.call(t,r)}),as=tt((i,e)=>{R();var t,r=X2e(),n=q2e(),a=Z2e(),o=Y2e(),s=jK(),l=ru(),u=J2e(),c=Function,p=h(function(V){try{return c('"use strict"; return ('+V+").constructor;")()}catch{}},"getEvalledConstructor"),d=Object.getOwnPropertyDescriptor;if(d)try{d({},"")}catch{d=null}var m=h(function(){throw new l},"throwTypeError"),g=d?function(){try{return arguments.callee,m}catch{try{return d(arguments,"callee").get}catch{return m}}}():m,_=UT()(),y=K2e()(),x=Object.getPrototypeOf||(y?function(V){return V.__proto__}:null),w={},b=typeof Uint8Array>"u"||!x?t:x(Uint8Array),C={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":_&&x?x([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":w,"%AsyncGenerator%":w,"%AsyncGeneratorFunction%":w,"%AsyncIteratorPrototype%":w,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":r,"%eval%":eval,"%EvalError%":n,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":c,"%GeneratorFunction%":w,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":_&&x?x(x([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!_||!x?t:x(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":a,"%ReferenceError%":o,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!_||!x?t:x(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":_&&x?x(""[Symbol.iterator]()):t,"%Symbol%":_?Symbol:t,"%SyntaxError%":s,"%ThrowTypeError%":g,"%TypedArray%":b,"%TypeError%":l,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":u,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet};if(x)try{null.error}catch(V){E=x(x(V)),C["%Error.prototype%"]=E}var E,T=h(function V(j){var q;if(j==="%AsyncFunction%")q=p("async function () {}");else if(j==="%GeneratorFunction%")q=p("function* () {}");else if(j==="%AsyncGeneratorFunction%")q=p("async function* () {}");else if(j==="%AsyncGenerator%"){var ee=V("%AsyncGeneratorFunction%");ee&&(q=ee.prototype)}else if(j==="%AsyncIteratorPrototype%"){var ae=V("%AsyncGenerator%");ae&&x&&(q=x(ae.prototype))}return C[j]=q,q},"doEval"),L={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},D=VT(),B=HK(),A=D.call(Function.call,Array.prototype.concat),k=D.call(Function.apply,Array.prototype.splice),$=D.call(Function.call,String.prototype.replace),z=D.call(Function.call,String.prototype.slice),P=D.call(Function.call,RegExp.prototype.exec),U=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,G=/\\(\\)?/g,K=h(function(V){var j=z(V,0,1),q=z(V,-1);if(j==="%"&&q!=="%")throw new s("invalid intrinsic syntax, expected closing `%`");if(q==="%"&&j!=="%")throw new s("invalid intrinsic syntax, expected opening `%`");var ee=[];return $(V,U,function(ae,N,J,Y){ee[ee.length]=J?$(Y,G,"$1"):N||ae}),ee},"stringToPath"),O=h(function(V,j){var q=V,ee;if(B(L,q)&&(ee=L[q],q="%"+ee[0]+"%"),B(C,q)){var ae=C[q];if(ae===w&&(ae=T(q)),typeof ae>"u"&&!j)throw new l("intrinsic "+V+" exists, but is not available. Please file an issue!");return{alias:ee,name:q,value:ae}}throw new s("intrinsic "+V+" does not exist!")},"getBaseIntrinsic");e.exports=h(function(V,j){if(typeof V!="string"||V.length===0)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof j!="boolean")throw new l('"allowMissing" argument must be a boolean');if(P(/^%?[^%]*%?$/,V)===null)throw new s("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var q=K(V),ee=q.length>0?q[0]:"",ae=O("%"+ee+"%",j),N=ae.name,J=ae.value,Y=!1,oe=ae.alias;oe&&(ee=oe[0],k(q,A([0,1],oe)));for(var xe=1,ge=!0;xe<q.length;xe+=1){var Te=q[xe],me=z(Te,0,1),Q=z(Te,-1);if((me==='"'||me==="'"||me==="`"||Q==='"'||Q==="'"||Q==="`")&&me!==Q)throw new s("property names with quotes must have matching quotes");if((Te==="constructor"||!ge)&&(Y=!0),ee+="."+Te,N="%"+ee+"%",B(C,N))J=C[N];else if(J!=null){if(!(Te in J)){if(!j)throw new l("base intrinsic for "+V+" exists, but the property is not available.");return}if(d&&xe+1>=q.length){var Me=d(J,Te);ge=!!Me,ge&&"get"in Me&&!("originalValue"in Me.get)?J=Me.get:J=J[Te]}else ge=B(J,Te),J=J[Te];ge&&!Y&&(C[N]=J)}}return J},"GetIntrinsic")}),jT=tt((i,e)=>{R();var t=as(),r=t("%Object.defineProperty%",!0)||!1;if(r)try{r({},"a",{value:1})}catch{r=!1}e.exports=r}),HT=tt((i,e)=>{R();var t=as(),r=t("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch{r=null}e.exports=r}),GT=tt((i,e)=>{R();var t=jT(),r=jK(),n=ru(),a=HT();e.exports=h(function(o,s,l){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`obj` must be an object or a function`");if(typeof s!="string"&&typeof s!="symbol")throw new n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new n("`loose`, if provided, must be a boolean");var u=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,p=arguments.length>5?arguments[5]:null,d=arguments.length>6?arguments[6]:!1,m=!!a&&a(o,s);if(t)t(o,s,{configurable:p===null&&m?m.configurable:!p,enumerable:u===null&&m?m.enumerable:!u,value:l,writable:c===null&&m?m.writable:!c});else if(d||!u&&!c&&!p)o[s]=l;else throw new r("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},"defineDataProperty")}),WT=tt((i,e)=>{R();var t=jT(),r=h(function(){return!!t},"hasPropertyDescriptors");r.hasArrayLengthDefineBug=h(function(){if(!t)return null;try{return t([],"length",{value:1}).length!==1}catch{return!0}},"hasArrayLengthDefineBug"),e.exports=r}),Ah=tt((i,e)=>{R();var t=$T(),r=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",n=Object.prototype.toString,a=Array.prototype.concat,o=GT(),s=h(function(p){return typeof p=="function"&&n.call(p)==="[object Function]"},"isFunction"),l=WT()(),u=h(function(p,d,m,g){if(d in p){if(g===!0){if(p[d]===m)return}else if(!s(g)||!g())return}l?o(p,d,m,!0):o(p,d,m)},"defineProperty"),c=h(function(p,d){var m=arguments.length>2?arguments[2]:{},g=t(d);r&&(g=a.call(g,Object.getOwnPropertySymbols(d)));for(var _=0;_<g.length;_+=1)u(p,g[_],d[g[_]],m[g[_]])},"defineProperties");c.supportsDescriptors=!!l,e.exports=c}),ebe=tt((i,e)=>{R();var t=as(),r=GT(),n=WT()(),a=HT(),o=ru(),s=t("%Math.floor%");e.exports=h(function(l,u){if(typeof l!="function")throw new o("`fn` is not a function");if(typeof u!="number"||u<0||u>4294967295||s(u)!==u)throw new o("`length` must be a positive 32-bit integer");var c=arguments.length>2&&!!arguments[2],p=!0,d=!0;if("length"in l&&a){var m=a(l,"length");m&&!m.configurable&&(p=!1),m&&!m.writable&&(d=!1)}return(p||d||!c)&&(n?r(l,"length",u,!0,!0):r(l,"length",u)),l},"setFunctionLength")}),Td=tt((i,e)=>{R();var t=VT(),r=as(),n=ebe(),a=ru(),o=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),l=r("%Reflect.apply%",!0)||t.call(s,o),u=jT(),c=r("%Math.max%");e.exports=h(function(d){if(typeof d!="function")throw new a("a function is required");var m=l(t,s,arguments);return n(m,1+c(0,d.length-(arguments.length-1)),!0)},"callBind");var p=h(function(){return l(t,o,arguments)},"applyBind");u?u(e.exports,"apply",{value:p}):e.exports.apply=p}),Za=tt((i,e)=>{R();var t=as(),r=Td(),n=r(t("String.prototype.indexOf"));e.exports=h(function(a,o){var s=t(a,!!o);return typeof s=="function"&&n(a,".prototype.")>-1?r(s):s},"callBoundIntrinsic")}),GK=tt((i,e)=>{R();var t=$T(),r=D_()(),n=Za(),a=Object,o=n("Array.prototype.push"),s=n("Object.prototype.propertyIsEnumerable"),l=r?Object.getOwnPropertySymbols:null;e.exports=h(function(u,c){if(u==null)throw new TypeError("target must be an object");var p=a(u);if(arguments.length===1)return p;for(var d=1;d<arguments.length;++d){var m=a(arguments[d]),g=t(m),_=r&&(Object.getOwnPropertySymbols||l);if(_)for(var y=_(m),x=0;x<y.length;++x){var w=y[x];s(m,w)&&o(g,w)}for(var b=0;b<g.length;++b){var C=g[b];if(s(m,C)){var E=m[C];p[C]=E}}}return p},"assign")}),WK=tt((i,e)=>{R();var t=GK(),r=h(function(){if(!Object.assign)return!1;for(var a="abcdefghijklmnopqrst",o=a.split(""),s={},l=0;l<o.length;++l)s[o[l]]=o[l];var u=Object.assign({},s),c="";for(var p in u)c+=p;return a!==c},"lacksProperEnumerationOrder"),n=h(function(){if(!Object.assign||!Object.preventExtensions)return!1;var a=Object.preventExtensions({1:2});try{Object.assign(a,"xy")}catch{return a[1]==="y"}return!1},"assignHasPendingExceptions");e.exports=h(function(){return!Object.assign||r()||n()?t:Object.assign},"getPolyfill")}),tbe=tt((i,e)=>{R();var t=Ah(),r=WK();e.exports=h(function(){var n=r();return t(Object,{assign:n},{assign:function(){return Object.assign!==n}}),n},"shimAssign")}),ibe=tt((i,e)=>{R();var t=Ah(),r=Td(),n=GK(),a=WK(),o=tbe(),s=r.apply(a()),l=h(function(u,c){return s(Object,arguments)},"assign");t(l,{getPolyfill:a,implementation:n,shim:o}),e.exports=l}),rbe=tt((i,e)=>{R();var t=h(function(){return typeof h(function(){},"f").name=="string"},"functionsHaveNames"),r=Object.getOwnPropertyDescriptor;if(r)try{r([],"length")}catch{r=null}t.functionsHaveConfigurableNames=h(function(){if(!t()||!r)return!1;var a=r(function(){},"name");return!!a&&!!a.configurable},"functionsHaveConfigurableNames");var n=Function.prototype.bind;t.boundFunctionsHaveNames=h(function(){return t()&&typeof n=="function"&&h(function(){},"f").bind().name!==""},"boundFunctionsHaveNames"),e.exports=t}),nbe=tt((i,e)=>{R();var t=GT(),r=WT()(),n=rbe().functionsHaveConfigurableNames(),a=ru();e.exports=h(function(o,s){if(typeof o!="function")throw new a("`fn` is not a function");var l=arguments.length>2&&!!arguments[2];return(!l||n)&&(r?t(o,"name",s,!0,!0):t(o,"name",s)),o},"setFunctionName")}),XK=tt((i,e)=>{R();var t=nbe(),r=ru(),n=Object;e.exports=t(h(function(){if(this==null||this!==n(this))throw new r("RegExp.prototype.flags getter called on non-object");var a="";return this.hasIndices&&(a+="d"),this.global&&(a+="g"),this.ignoreCase&&(a+="i"),this.multiline&&(a+="m"),this.dotAll&&(a+="s"),this.unicode&&(a+="u"),this.unicodeSets&&(a+="v"),this.sticky&&(a+="y"),a},"flags"),"get flags",!0)}),qK=tt((i,e)=>{R();var t=XK(),r=Ah().supportsDescriptors,n=Object.getOwnPropertyDescriptor;e.exports=h(function(){if(r&&/a/mig.flags==="gim"){var a=n(RegExp.prototype,"flags");if(a&&typeof a.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var o="",s={};if(Object.defineProperty(s,"hasIndices",{get:function(){o+="d"}}),Object.defineProperty(s,"sticky",{get:function(){o+="y"}}),o==="dy")return a.get}}return t},"getPolyfill")}),abe=tt((i,e)=>{R();var t=Ah().supportsDescriptors,r=qK(),n=Object.getOwnPropertyDescriptor,a=Object.defineProperty,o=TypeError,s=Object.getPrototypeOf,l=/a/;e.exports=h(function(){if(!t||!s)throw new o("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var u=r(),c=s(l),p=n(c,"flags");return(!p||p.get!==u)&&a(c,"flags",{configurable:!0,enumerable:!1,get:u}),u},"shimFlags")}),obe=tt((i,e)=>{R();var t=Ah(),r=Td(),n=XK(),a=qK(),o=abe(),s=r(a());t(s,{getPolyfill:a,implementation:n,shim:o}),e.exports=s}),Ih=tt((i,e)=>{R();var t=D_();e.exports=h(function(){return t()&&!!Symbol.toStringTag},"hasToStringTagShams")}),ZK=tt((i,e)=>{R();var t=Ih()(),r=Za(),n=r("Object.prototype.toString"),a=h(function(l){return t&&l&&typeof l=="object"&&Symbol.toStringTag in l?!1:n(l)==="[object Arguments]"},"isArguments"),o=h(function(l){return a(l)?!0:l!==null&&typeof l=="object"&&typeof l.length=="number"&&l.length>=0&&n(l)!=="[object Array]"&&n(l.callee)==="[object Function]"},"isArguments"),s=function(){return a(arguments)}();a.isLegacyArguments=o,e.exports=s?a:o}),sbe=tt(()=>{R()}),lbe=tt((i,e)=>{R();var t=typeof Map=="function"&&Map.prototype,r=Object.getOwnPropertyDescriptor&&t?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,n=t&&r&&typeof r.get=="function"?r.get:null,a=t&&Map.prototype.forEach,o=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&o?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=o&&s&&typeof s.get=="function"?s.get:null,u=o&&Set.prototype.forEach,c=typeof WeakMap=="function"&&WeakMap.prototype,p=c?WeakMap.prototype.has:null,d=typeof WeakSet=="function"&&WeakSet.prototype,m=d?WeakSet.prototype.has:null,g=typeof WeakRef=="function"&&WeakRef.prototype,_=g?WeakRef.prototype.deref:null,y=Boolean.prototype.valueOf,x=Object.prototype.toString,w=Function.prototype.toString,b=String.prototype.match,C=String.prototype.slice,E=String.prototype.replace,T=String.prototype.toUpperCase,L=String.prototype.toLowerCase,D=RegExp.prototype.test,B=Array.prototype.concat,A=Array.prototype.join,k=Array.prototype.slice,$=Math.floor,z=typeof BigInt=="function"?BigInt.prototype.valueOf:null,P=Object.getOwnPropertySymbols,U=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,G=typeof Symbol=="function"&&typeof Symbol.iterator=="object",K=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===G||!0)?Symbol.toStringTag:null,O=Object.prototype.propertyIsEnumerable,V=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(ue){return ue.__proto__}:null);function j(ue,he){if(ue===1/0||ue===-1/0||ue!==ue||ue&&ue>-1e3&&ue<1e3||D.call(/e/,he))return he;var qe=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof ue=="number"){var ft=ue<0?-$(-ue):$(ue);if(ft!==ue){var ct=String(ft),dt=C.call(he,ct.length+1);return E.call(ct,qe,"$&_")+"."+E.call(E.call(dt,/([0-9]{3})/g,"$&_"),/_$/,"")}}return E.call(he,qe,"$&_")}h(j,"addNumericSeparator");var q=sbe(),ee=q.custom,ae=Me(ee)?ee:null;e.exports=h(function ue(he,qe,ft,ct){var dt=qe||{};if(ke(dt,"quoteStyle")&&dt.quoteStyle!=="single"&&dt.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(ke(dt,"maxStringLength")&&(typeof dt.maxStringLength=="number"?dt.maxStringLength<0&&dt.maxStringLength!==1/0:dt.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var ce=ke(dt,"customInspect")?dt.customInspect:!0;if(typeof ce!="boolean"&&ce!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(ke(dt,"indent")&&dt.indent!==null&&dt.indent!=="	"&&!(parseInt(dt.indent,10)===dt.indent&&dt.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(ke(dt,"numericSeparator")&&typeof dt.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var it=dt.numericSeparator;if(typeof he>"u")return"undefined";if(he===null)return"null";if(typeof he=="boolean")return he?"true":"false";if(typeof he=="string")return Be(he,dt);if(typeof he=="number"){if(he===0)return 1/0/he>0?"0":"-0";var be=String(he);return it?j(he,be):be}if(typeof he=="bigint"){var Xe=String(he)+"n";return it?j(he,Xe):Xe}var rt=typeof dt.depth>"u"?5:dt.depth;if(typeof ft>"u"&&(ft=0),ft>=rt&&rt>0&&typeof he=="object")return Y(he)?"[Array]":"[Object]";var Wt=Ze(dt,ft);if(typeof ct>"u")ct=[];else if(Je(ct,he)>=0)return"[Circular]";function Ut(ye,Ce,Pe){if(Ce&&(ct=k.call(ct),ct.push(Ce)),Pe){var Se={depth:dt.depth};return ke(dt,"quoteStyle")&&(Se.quoteStyle=dt.quoteStyle),ue(ye,Se,ft+1,ct)}return ue(ye,dt,ft+1,ct)}if(h(Ut,"inspect"),typeof he=="function"&&!xe(he)){var Ti=Oe(he),lr=Dt(he,Ut);return"[Function"+(Ti?": "+Ti:" (anonymous)")+"]"+(lr.length>0?" { "+A.call(lr,", ")+" }":"")}if(Me(he)){var jt=G?E.call(String(he),/^(Symbol\(.*\))_[^)]*$/,"$1"):U.call(he);return typeof he=="object"&&!G?lt(jt):jt}if(Ue(he)){for(var Pi="<"+L.call(String(he.nodeName)),mr=he.attributes||[],kn=0;kn<mr.length;kn++)Pi+=" "+mr[kn].name+"="+N(J(mr[kn].value),"double",dt);return Pi+=">",he.childNodes&&he.childNodes.length&&(Pi+="..."),Pi+="</"+L.call(String(he.nodeName))+">",Pi}if(Y(he)){if(he.length===0)return"[]";var Ma=Dt(he,Ut);return Wt&&!St(Ma)?"["+ni(Ma,Wt)+"]":"[ "+A.call(Ma,", ")+" ]"}if(ge(he)){var gn=Dt(he,Ut);return!("cause"in Error.prototype)&&"cause"in he&&!O.call(he,"cause")?"{ ["+String(he)+"] "+A.call(B.call("[cause]: "+Ut(he.cause),gn),", ")+" }":gn.length===0?"["+String(he)+"]":"{ ["+String(he)+"] "+A.call(gn,", ")+" }"}if(typeof he=="object"&&ce){if(ae&&typeof he[ae]=="function"&&q)return q(he,{depth:rt-ft});if(ce!=="symbol"&&typeof he.inspect=="function")return he.inspect()}if(xt(he)){var Yr=[];return a&&a.call(he,function(ye,Ce){Yr.push(Ut(Ce,he,!0)+" => "+Ut(ye,he))}),We("Map",n.call(he),Yr,Wt)}if(_e(he)){var Rn=[];return u&&u.call(he,function(ye){Rn.push(Ut(ye,he))}),We("Set",l.call(he),Rn,Wt)}if(ne(he))return Ge("WeakMap");if(Fe(he))return Ge("WeakSet");if(W(he))return Ge("WeakRef");if(me(he))return lt(Ut(Number(he)));if(ve(he))return lt(Ut(z.call(he)));if(Q(he))return lt(y.call(he));if(Te(he))return lt(Ut(String(he)));if(typeof window<"u"&&he===window)return"{ [object Window] }";if(he===global)return"{ [object globalThis] }";if(!oe(he)&&!xe(he)){var ra=Dt(he,Ut),Ca=V?V(he)===Object.prototype:he instanceof Object||he.constructor===Object,Ea=he instanceof Object?"":"null prototype",Ya=!Ca&&K&&Object(he)===he&&K in he?C.call(we(he),8,-1):Ea?"Object":"",yn=Ca||typeof he.constructor!="function"?"":he.constructor.name?he.constructor.name+" ":"",te=yn+(Ya||Ea?"["+A.call(B.call([],Ya||[],Ea||[]),": ")+"] ":"");return ra.length===0?te+"{}":Wt?te+"{"+ni(ra,Wt)+"}":te+"{ "+A.call(ra,", ")+" }"}return String(he)},"inspect_");function N(ue,he,qe){var ft=(qe.quoteStyle||he)==="double"?'"':"'";return ft+ue+ft}h(N,"wrapQuotes");function J(ue){return E.call(String(ue),/"/g,"&quot;")}h(J,"quote");function Y(ue){return we(ue)==="[object Array]"&&(!K||!(typeof ue=="object"&&K in ue))}h(Y,"isArray");function oe(ue){return we(ue)==="[object Date]"&&(!K||!(typeof ue=="object"&&K in ue))}h(oe,"isDate");function xe(ue){return we(ue)==="[object RegExp]"&&(!K||!(typeof ue=="object"&&K in ue))}h(xe,"isRegExp");function ge(ue){return we(ue)==="[object Error]"&&(!K||!(typeof ue=="object"&&K in ue))}h(ge,"isError");function Te(ue){return we(ue)==="[object String]"&&(!K||!(typeof ue=="object"&&K in ue))}h(Te,"isString");function me(ue){return we(ue)==="[object Number]"&&(!K||!(typeof ue=="object"&&K in ue))}h(me,"isNumber");function Q(ue){return we(ue)==="[object Boolean]"&&(!K||!(typeof ue=="object"&&K in ue))}h(Q,"isBoolean");function Me(ue){if(G)return ue&&typeof ue=="object"&&ue instanceof Symbol;if(typeof ue=="symbol")return!0;if(!ue||typeof ue!="object"||!U)return!1;try{return U.call(ue),!0}catch{}return!1}h(Me,"isSymbol");function ve(ue){if(!ue||typeof ue!="object"||!z)return!1;try{return z.call(ue),!0}catch{}return!1}h(ve,"isBigInt");var Ie=Object.prototype.hasOwnProperty||function(ue){return ue in this};function ke(ue,he){return Ie.call(ue,he)}h(ke,"has");function we(ue){return x.call(ue)}h(we,"toStr");function Oe(ue){if(ue.name)return ue.name;var he=b.call(w.call(ue),/^function\s*([\w$]+)/);return he?he[1]:null}h(Oe,"nameOf");function Je(ue,he){if(ue.indexOf)return ue.indexOf(he);for(var qe=0,ft=ue.length;qe<ft;qe++)if(ue[qe]===he)return qe;return-1}h(Je,"indexOf");function xt(ue){if(!n||!ue||typeof ue!="object")return!1;try{n.call(ue);try{l.call(ue)}catch{return!0}return ue instanceof Map}catch{}return!1}h(xt,"isMap");function ne(ue){if(!p||!ue||typeof ue!="object")return!1;try{p.call(ue,p);try{m.call(ue,m)}catch{return!0}return ue instanceof WeakMap}catch{}return!1}h(ne,"isWeakMap");function W(ue){if(!_||!ue||typeof ue!="object")return!1;try{return _.call(ue),!0}catch{}return!1}h(W,"isWeakRef");function _e(ue){if(!l||!ue||typeof ue!="object")return!1;try{l.call(ue);try{n.call(ue)}catch{return!0}return ue instanceof Set}catch{}return!1}h(_e,"isSet");function Fe(ue){if(!m||!ue||typeof ue!="object")return!1;try{m.call(ue,m);try{p.call(ue,p)}catch{return!0}return ue instanceof WeakSet}catch{}return!1}h(Fe,"isWeakSet");function Ue(ue){return!ue||typeof ue!="object"?!1:typeof HTMLElement<"u"&&ue instanceof HTMLElement?!0:typeof ue.nodeName=="string"&&typeof ue.getAttribute=="function"}h(Ue,"isElement");function Be(ue,he){if(ue.length>he.maxStringLength){var qe=ue.length-he.maxStringLength,ft="... "+qe+" more character"+(qe>1?"s":"");return Be(C.call(ue,0,he.maxStringLength),he)+ft}var ct=E.call(E.call(ue,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,bt);return N(ct,"single",he)}h(Be,"inspectString");function bt(ue){var he=ue.charCodeAt(0),qe={8:"b",9:"t",10:"n",12:"f",13:"r"}[he];return qe?"\\"+qe:"\\x"+(he<16?"0":"")+T.call(he.toString(16))}h(bt,"lowbyte");function lt(ue){return"Object("+ue+")"}h(lt,"markBoxed");function Ge(ue){return ue+" { ? }"}h(Ge,"weakCollectionOf");function We(ue,he,qe,ft){var ct=ft?ni(qe,ft):A.call(qe,", ");return ue+" ("+he+") {"+ct+"}"}h(We,"collectionOf");function St(ue){for(var he=0;he<ue.length;he++)if(Je(ue[he],`
`)>=0)return!1;return!0}h(St,"singleLineValues");function Ze(ue,he){var qe;if(ue.indent==="	")qe="	";else if(typeof ue.indent=="number"&&ue.indent>0)qe=A.call(Array(ue.indent+1)," ");else return null;return{base:qe,prev:A.call(Array(he+1),qe)}}h(Ze,"getIndent");function ni(ue,he){if(ue.length===0)return"";var qe=`
`+he.prev+he.base;return qe+A.call(ue,","+qe)+`
`+he.prev}h(ni,"indentedJoin");function Dt(ue,he){var qe=Y(ue),ft=[];if(qe){ft.length=ue.length;for(var ct=0;ct<ue.length;ct++)ft[ct]=ke(ue,ct)?he(ue[ct],ue):""}var dt=typeof P=="function"?P(ue):[],ce;if(G){ce={};for(var it=0;it<dt.length;it++)ce["$"+dt[it]]=dt[it]}for(var be in ue)ke(ue,be)&&(qe&&String(Number(be))===be&&be<ue.length||G&&ce["$"+be]instanceof Symbol||(D.call(/[^\w$]/,be)?ft.push(he(be,ue)+": "+he(ue[be],ue)):ft.push(be+": "+he(ue[be],ue))));if(typeof P=="function")for(var Xe=0;Xe<dt.length;Xe++)O.call(ue,dt[Xe])&&ft.push("["+he(dt[Xe])+"]: "+he(ue[dt[Xe]],ue));return ft}h(Dt,"arrObjKeys")}),YK=tt((i,e)=>{R();var t=as(),r=Za(),n=lbe(),a=ru(),o=t("%WeakMap%",!0),s=t("%Map%",!0),l=r("WeakMap.prototype.get",!0),u=r("WeakMap.prototype.set",!0),c=r("WeakMap.prototype.has",!0),p=r("Map.prototype.get",!0),d=r("Map.prototype.set",!0),m=r("Map.prototype.has",!0),g=h(function(w,b){for(var C=w,E;(E=C.next)!==null;C=E)if(E.key===b)return C.next=E.next,E.next=w.next,w.next=E,E},"listGetNode"),_=h(function(w,b){var C=g(w,b);return C&&C.value},"listGet"),y=h(function(w,b,C){var E=g(w,b);E?E.value=C:w.next={key:b,next:w.next,value:C}},"listSet"),x=h(function(w,b){return!!g(w,b)},"listHas");e.exports=h(function(){var w,b,C,E={assert:function(T){if(!E.has(T))throw new a("Side channel does not contain "+n(T))},get:function(T){if(o&&T&&(typeof T=="object"||typeof T=="function")){if(w)return l(w,T)}else if(s){if(b)return p(b,T)}else if(C)return _(C,T)},has:function(T){if(o&&T&&(typeof T=="object"||typeof T=="function")){if(w)return c(w,T)}else if(s){if(b)return m(b,T)}else if(C)return x(C,T);return!1},set:function(T,L){o&&T&&(typeof T=="object"||typeof T=="function")?(w||(w=new o),u(w,T,L)):s?(b||(b=new s),d(b,T,L)):(C||(C={key:{},next:null}),y(C,T,L))}};return E},"getSideChannel")}),ube=tt((i,e)=>{R();var t=HK(),r=YK()(),n=ru(),a={assert:function(o,s){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof s!="string")throw new n("`slot` must be a string");if(r.assert(o),!a.has(o,s))throw new n("`"+s+"` is not present on `O`")},get:function(o,s){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof s!="string")throw new n("`slot` must be a string");var l=r.get(o);return l&&l["$"+s]},has:function(o,s){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof s!="string")throw new n("`slot` must be a string");var l=r.get(o);return!!l&&t(l,"$"+s)},set:function(o,s,l){if(!o||typeof o!="object"&&typeof o!="function")throw new n("`O` is not an object");if(typeof s!="string")throw new n("`slot` must be a string");var u=r.get(o);u||(u={},r.set(o,u)),u["$"+s]=l}};Object.freeze&&Object.freeze(a),e.exports=a}),hbe=tt((i,e)=>{R();var t=ube(),r=SyntaxError,n=typeof StopIteration=="object"?StopIteration:null;e.exports=h(function(a){if(!n)throw new r("this environment lacks StopIteration");t.set(a,"[[Done]]",!1);var o={next:h(function(){var s=t.get(this,"[[Iterator]]"),l=t.get(s,"[[Done]]");try{return{done:l,value:l?void 0:s.next()}}catch(u){if(t.set(s,"[[Done]]",!0),u!==n)throw u;return{done:!0,value:void 0}}},"next")};return t.set(o,"[[Iterator]]",a),o},"getStopIterationIterator")}),JK=tt((i,e)=>{R();var t={}.toString;e.exports=Array.isArray||function(r){return t.call(r)=="[object Array]"}}),KK=tt((i,e)=>{R();var t=String.prototype.valueOf,r=h(function(s){try{return t.call(s),!0}catch{return!1}},"tryStringObject"),n=Object.prototype.toString,a="[object String]",o=Ih()();e.exports=h(function(s){return typeof s=="string"?!0:typeof s!="object"?!1:o?r(s):n.call(s)===a},"isString")}),QK=tt((i,e)=>{R();var t=typeof Map=="function"&&Map.prototype?Map:null,r=typeof Set=="function"&&Set.prototype?Set:null,n;t||(n=h(function(s){return!1},"isMap"));var a=t?Map.prototype.has:null,o=r?Set.prototype.has:null;!n&&!a&&(n=h(function(s){return!1},"isMap")),e.exports=n||h(function(s){if(!s||typeof s!="object")return!1;try{if(a.call(s),o)try{o.call(s)}catch{return!0}return s instanceof t}catch{}return!1},"isMap")}),eQ=tt((i,e)=>{R();var t=typeof Map=="function"&&Map.prototype?Map:null,r=typeof Set=="function"&&Set.prototype?Set:null,n;r||(n=h(function(s){return!1},"isSet"));var a=t?Map.prototype.has:null,o=r?Set.prototype.has:null;!n&&!o&&(n=h(function(s){return!1},"isSet")),e.exports=n||h(function(s){if(!s||typeof s!="object")return!1;try{if(o.call(s),a)try{a.call(s)}catch{return!0}return s instanceof r}catch{}return!1},"isSet")}),cbe=tt((i,e)=>{R();var t=ZK(),r=hbe();UT()()||D_()()?(n=Symbol.iterator,e.exports=h(function(A){if(A!=null&&typeof A[n]<"u")return A[n]();if(t(A))return Array.prototype[n].call(A)},"getIterator")):(a=JK(),o=KK(),s=as(),l=s("%Map%",!0),u=s("%Set%",!0),c=Za(),p=c("Array.prototype.push"),d=c("String.prototype.charCodeAt"),m=c("String.prototype.slice"),g=h(function(A,k){var $=A.length;if(k+1>=$)return k+1;var z=d(A,k);if(z<55296||z>56319)return k+1;var P=d(A,k+1);return P<56320||P>57343?k+1:k+2},"advanceStringIndex"),_=h(function(A){var k=0;return{next:h(function(){var $=k>=A.length,z;return $||(z=A[k],k+=1),{done:$,value:z}},"next")}},"getArrayIterator"),y=h(function(A,k){if(a(A)||t(A))return _(A);if(o(A)){var $=0;return{next:h(function(){var z=g(A,$),P=m(A,$,z);return $=z,{done:z>A.length,value:P}},"next")}}if(k&&typeof A["_es6-shim iterator_"]<"u")return A["_es6-shim iterator_"]()},"getNonCollectionIterator"),!l&&!u?e.exports=h(function(A){if(A!=null)return y(A,!0)},"getIterator"):(x=QK(),w=eQ(),b=c("Map.prototype.forEach",!0),C=c("Set.prototype.forEach",!0),(typeof dr>"u"||!dr.versions||!dr.versions.node)&&(E=c("Map.prototype.iterator",!0),T=c("Set.prototype.iterator",!0)),L=c("Map.prototype.@@iterator",!0)||c("Map.prototype._es6-shim iterator_",!0),D=c("Set.prototype.@@iterator",!0)||c("Set.prototype._es6-shim iterator_",!0),B=h(function(A){if(x(A)){if(E)return r(E(A));if(L)return L(A);if(b){var k=[];return b(A,function(z,P){p(k,[P,z])}),_(k)}}if(w(A)){if(T)return r(T(A));if(D)return D(A);if(C){var $=[];return C(A,function(z){p($,z)}),_($)}}},"getCollectionIterator"),e.exports=h(function(A){return B(A)||y(A)},"getIterator")));var n,a,o,s,l,u,c,p,d,m,g,_,y,x,w,b,C,E,T,L,D,B}),tQ=tt((i,e)=>{R();var t=h(function(r){return r!==r},"numberIsNaN");e.exports=h(function(r,n){return r===0&&n===0?1/r===1/n:!!(r===n||t(r)&&t(n))},"is")}),iQ=tt((i,e)=>{R();var t=tQ();e.exports=h(function(){return typeof Object.is=="function"?Object.is:t},"getPolyfill")}),pbe=tt((i,e)=>{R();var t=iQ(),r=Ah();e.exports=h(function(){var n=t();return r(Object,{is:n},{is:h(function(){return Object.is!==n},"testObjectIs")}),n},"shimObjectIs")}),dbe=tt((i,e)=>{R();var t=Ah(),r=Td(),n=tQ(),a=iQ(),o=pbe(),s=r(a(),Object);t(s,{getPolyfill:a,implementation:n,shim:o}),e.exports=s}),rQ=tt((i,e)=>{R();var t=Td(),r=Za(),n=as(),a=n("%ArrayBuffer%",!0),o=r("ArrayBuffer.prototype.byteLength",!0),s=r("Object.prototype.toString"),l=!!a&&!o&&new a(0).slice,u=!!l&&t(l);e.exports=h(o||u?function(c){if(!c||typeof c!="object")return!1;try{return o?o(c):u(c,0),!0}catch{return!1}}:a?function(c){return s(c)==="[object ArrayBuffer]"}:function(c){return!1},"isArrayBuffer")}),fbe=tt((i,e)=>{R();var t=Date.prototype.getDay,r=h(function(s){try{return t.call(s),!0}catch{return!1}},"tryDateGetDayCall"),n=Object.prototype.toString,a="[object Date]",o=Ih()();e.exports=h(function(s){return typeof s!="object"||s===null?!1:o?r(s):n.call(s)===a},"isDateObject")}),mbe=tt((i,e)=>{R();var t=Za(),r=Ih()(),n,a,o,s;r&&(n=t("Object.prototype.hasOwnProperty"),a=t("RegExp.prototype.exec"),o={},l=h(function(){throw o},"throwRegexMarker"),s={toString:l,valueOf:l},typeof Symbol.toPrimitive=="symbol"&&(s[Symbol.toPrimitive]=l));var l,u=t("Object.prototype.toString"),c=Object.getOwnPropertyDescriptor,p="[object RegExp]";e.exports=h(r?function(d){if(!d||typeof d!="object")return!1;var m=c(d,"lastIndex"),g=m&&n(m,"value");if(!g)return!1;try{a(d,s)}catch(_){return _===o}}:function(d){return!d||typeof d!="object"&&typeof d!="function"?!1:u(d)===p},"isRegex")}),gbe=tt((i,e)=>{R();var t=Za(),r=t("SharedArrayBuffer.prototype.byteLength",!0);e.exports=h(r?function(n){if(!n||typeof n!="object")return!1;try{return r(n),!0}catch{return!1}}:function(n){return!1},"isSharedArrayBuffer")}),ybe=tt((i,e)=>{R();var t=Number.prototype.toString,r=h(function(s){try{return t.call(s),!0}catch{return!1}},"tryNumberObject"),n=Object.prototype.toString,a="[object Number]",o=Ih()();e.exports=h(function(s){return typeof s=="number"?!0:typeof s!="object"?!1:o?r(s):n.call(s)===a},"isNumberObject")}),vbe=tt((i,e)=>{R();var t=Za(),r=t("Boolean.prototype.toString"),n=t("Object.prototype.toString"),a=h(function(l){try{return r(l),!0}catch{return!1}},"booleanBrandCheck"),o="[object Boolean]",s=Ih()();e.exports=h(function(l){return typeof l=="boolean"?!0:l===null||typeof l!="object"?!1:s&&Symbol.toStringTag in l?a(l):n(l)===o},"isBoolean")}),xbe=tt((i,e)=>{R();var t=Object.prototype.toString,r=UT()();r?(n=Symbol.prototype.toString,a=/^Symbol\(.*\)$/,o=h(function(s){return typeof s.valueOf()!="symbol"?!1:a.test(n.call(s))},"isRealSymbolObject"),e.exports=h(function(s){if(typeof s=="symbol")return!0;if(t.call(s)!=="[object Symbol]")return!1;try{return o(s)}catch{return!1}},"isSymbol")):e.exports=h(function(s){return!1},"isSymbol");var n,a,o}),_be=tt((i,e)=>{R();var t=typeof BigInt<"u"&&BigInt;e.exports=h(function(){return typeof t=="function"&&typeof BigInt=="function"&&typeof t(42)=="bigint"&&typeof BigInt(42)=="bigint"},"hasNativeBigInts")}),bbe=tt((i,e)=>{R();var t=_be()();t?(r=BigInt.prototype.valueOf,n=h(function(a){try{return r.call(a),!0}catch{}return!1},"tryBigIntObject"),e.exports=h(function(a){return a===null||typeof a>"u"||typeof a=="boolean"||typeof a=="string"||typeof a=="number"||typeof a=="symbol"||typeof a=="function"?!1:typeof a=="bigint"?!0:n(a)},"isBigInt")):e.exports=h(function(a){return!1},"isBigInt");var r,n}),wbe=tt((i,e)=>{R();var t=KK(),r=ybe(),n=vbe(),a=xbe(),o=bbe();e.exports=h(function(s){if(s==null||typeof s!="object"&&typeof s!="function")return null;if(t(s))return"String";if(r(s))return"Number";if(n(s))return"Boolean";if(a(s))return"Symbol";if(o(s))return"BigInt"},"whichBoxedPrimitive")}),Sbe=tt((i,e)=>{R();var t=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,r=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,n;t||(n=h(function(s){return!1},"isWeakMap"));var a=t?t.prototype.has:null,o=r?r.prototype.has:null;!n&&!a&&(n=h(function(s){return!1},"isWeakMap")),e.exports=n||h(function(s){if(!s||typeof s!="object")return!1;try{if(a.call(s,a),o)try{o.call(s,o)}catch{return!0}return s instanceof t}catch{}return!1},"isWeakMap")}),Mbe=tt((i,e)=>{R();var t=as(),r=Za(),n=t("%WeakSet%",!0),a=r("WeakSet.prototype.has",!0);a?(o=r("WeakMap.prototype.has",!0),e.exports=h(function(s){if(!s||typeof s!="object")return!1;try{if(a(s,a),o)try{o(s,o)}catch{return!0}return s instanceof n}catch{}return!1},"isWeakSet")):e.exports=h(function(s){return!1},"isWeakSet");var o}),Cbe=tt((i,e)=>{R();var t=QK(),r=eQ(),n=Sbe(),a=Mbe();e.exports=h(function(o){if(o&&typeof o=="object"){if(t(o))return"Map";if(r(o))return"Set";if(n(o))return"WeakMap";if(a(o))return"WeakSet"}return!1},"whichCollection")}),Ebe=tt((i,e)=>{R();var t=Function.prototype.toString,r=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,n,a;if(typeof r=="function"&&typeof Object.defineProperty=="function")try{n=Object.defineProperty({},"length",{get:function(){throw a}}),a={},r(function(){throw 42},null,n)}catch(C){C!==a&&(r=null)}else r=null;var o=/^\s*class\b/,s=h(function(C){try{var E=t.call(C);return o.test(E)}catch{return!1}},"isES6ClassFunction"),l=h(function(C){try{return s(C)?!1:(t.call(C),!0)}catch{return!1}},"tryFunctionToStr"),u=Object.prototype.toString,c="[object Object]",p="[object Function]",d="[object GeneratorFunction]",m="[object HTMLAllCollection]",g="[object HTML document.all class]",_="[object HTMLCollection]",y=typeof Symbol=="function"&&!!Symbol.toStringTag,x=!(0 in[,]),w=h(function(){return!1},"isDocumentDotAll");typeof document=="object"&&(b=document.all,u.call(b)===u.call(document.all)&&(w=h(function(C){if((x||!C)&&(typeof C>"u"||typeof C=="object"))try{var E=u.call(C);return(E===m||E===g||E===_||E===c)&&C("")==null}catch{}return!1},"isDocumentDotAll")));var b;e.exports=h(r?function(C){if(w(C))return!0;if(!C||typeof C!="function"&&typeof C!="object")return!1;try{r(C,null,n)}catch(E){if(E!==a)return!1}return!s(C)&&l(C)}:function(C){if(w(C))return!0;if(!C||typeof C!="function"&&typeof C!="object")return!1;if(y)return l(C);if(s(C))return!1;var E=u.call(C);return E!==p&&E!==d&&!/^\[object HTML/.test(E)?!1:l(C)},"isCallable")}),Tbe=tt((i,e)=>{R();var t=Ebe(),r=Object.prototype.toString,n=Object.prototype.hasOwnProperty,a=h(function(u,c,p){for(var d=0,m=u.length;d<m;d++)n.call(u,d)&&(p==null?c(u[d],d,u):c.call(p,u[d],d,u))},"forEachArray"),o=h(function(u,c,p){for(var d=0,m=u.length;d<m;d++)p==null?c(u.charAt(d),d,u):c.call(p,u.charAt(d),d,u)},"forEachString"),s=h(function(u,c,p){for(var d in u)n.call(u,d)&&(p==null?c(u[d],d,u):c.call(p,u[d],d,u))},"forEachObject"),l=h(function(u,c,p){if(!t(c))throw new TypeError("iterator must be a function");var d;arguments.length>=3&&(d=p),r.call(u)==="[object Array]"?a(u,c,d):typeof u=="string"?o(u,c,d):s(u,c,d)},"forEach");e.exports=l}),Pbe=tt((i,e)=>{R(),e.exports=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"]}),Abe=tt((i,e)=>{R();var t=Pbe(),r=typeof globalThis>"u"?global:globalThis;e.exports=h(function(){for(var n=[],a=0;a<t.length;a++)typeof r[t[a]]=="function"&&(n[n.length]=t[a]);return n},"availableTypedArrays")}),Ibe=tt((i,e)=>{R();var t=Tbe(),r=Abe(),n=Td(),a=Za(),o=HT(),s=a("Object.prototype.toString"),l=Ih()(),u=typeof globalThis>"u"?global:globalThis,c=r(),p=a("String.prototype.slice"),d=Object.getPrototypeOf,m=a("Array.prototype.indexOf",!0)||h(function(x,w){for(var b=0;b<x.length;b+=1)if(x[b]===w)return b;return-1},"indexOf"),g={__proto__:null};l&&o&&d?t(c,function(x){var w=new u[x];if(Symbol.toStringTag in w){var b=d(w),C=o(b,Symbol.toStringTag);if(!C){var E=d(b);C=o(E,Symbol.toStringTag)}g["$"+x]=n(C.get)}}):t(c,function(x){var w=new u[x],b=w.slice||w.set;b&&(g["$"+x]=n(b))});var _=h(function(x){var w=!1;return t(g,function(b,C){if(!w)try{"$"+b(x)===C&&(w=p(C,1))}catch{}}),w},"tryAllTypedArrays"),y=h(function(x){var w=!1;return t(g,function(b,C){if(!w)try{b(x),w=p(C,1)}catch{}}),w},"tryAllSlices");e.exports=h(function(x){if(!x||typeof x!="object")return!1;if(!l){var w=p(s(x),8,-1);return m(c,w)>-1?w:w!=="Object"?!1:y(x)}return o?_(x):null},"whichTypedArray")}),Lbe=tt((i,e)=>{R();var t=Za(),r=t("ArrayBuffer.prototype.byteLength",!0),n=rQ();e.exports=h(function(a){return n(a)?r?r(a):a.byteLength:NaN},"byteLength")}),Dbe=tt((i,e)=>{R();var t=ibe(),r=Za(),n=obe(),a=as(),o=cbe(),s=YK(),l=dbe(),u=ZK(),c=JK(),p=rQ(),d=fbe(),m=mbe(),g=gbe(),_=$T(),y=wbe(),x=Cbe(),w=Ibe(),b=Lbe(),C=r("SharedArrayBuffer.prototype.byteLength",!0),E=r("Date.prototype.getTime"),T=Object.getPrototypeOf,L=r("Object.prototype.toString"),D=a("%Set%",!0),B=r("Map.prototype.has",!0),A=r("Map.prototype.get",!0),k=r("Map.prototype.size",!0),$=r("Set.prototype.add",!0),z=r("Set.prototype.delete",!0),P=r("Set.prototype.has",!0),U=r("Set.prototype.size",!0);function G(Y,oe,xe,ge){for(var Te=o(Y),me;(me=Te.next())&&!me.done;)if(q(oe,me.value,xe,ge))return z(Y,me.value),!0;return!1}h(G,"setHasEqualElement");function K(Y){if(typeof Y>"u")return null;if(typeof Y!="object")return typeof Y=="symbol"?!1:typeof Y=="string"||typeof Y=="number"?+Y==+Y:!0}h(K,"findLooseMatchingPrimitives");function O(Y,oe,xe,ge,Te,me){var Q=K(xe);if(Q!=null)return Q;var Me=A(oe,Q),ve=t({},Te,{strict:!1});return typeof Me>"u"&&!B(oe,Q)||!q(ge,Me,ve,me)?!1:!B(Y,Q)&&q(ge,Me,ve,me)}h(O,"mapMightHaveLoosePrim");function V(Y,oe,xe){var ge=K(xe);return ge??(P(oe,ge)&&!P(Y,ge))}h(V,"setMightHaveLoosePrim");function j(Y,oe,xe,ge,Te,me){for(var Q=o(Y),Me,ve;(Me=Q.next())&&!Me.done;)if(ve=Me.value,q(xe,ve,Te,me)&&q(ge,A(oe,ve),Te,me))return z(Y,ve),!0;return!1}h(j,"mapHasEqualEntry");function q(Y,oe,xe,ge){var Te=xe||{};if(Te.strict?l(Y,oe):Y===oe)return!0;var me=y(Y),Q=y(oe);if(me!==Q)return!1;if(!Y||!oe||typeof Y!="object"&&typeof oe!="object")return Te.strict?l(Y,oe):Y==oe;var Me=ge.has(Y),ve=ge.has(oe),Ie;if(Me&&ve){if(ge.get(Y)===ge.get(oe))return!0}else Ie={};return Me||ge.set(Y,Ie),ve||ge.set(oe,Ie),J(Y,oe,Te,ge)}h(q,"internalDeepEqual");function ee(Y){return!Y||typeof Y!="object"||typeof Y.length!="number"||typeof Y.copy!="function"||typeof Y.slice!="function"||Y.length>0&&typeof Y[0]!="number"?!1:!!(Y.constructor&&Y.constructor.isBuffer&&Y.constructor.isBuffer(Y))}h(ee,"isBuffer");function ae(Y,oe,xe,ge){if(U(Y)!==U(oe))return!1;for(var Te=o(Y),me=o(oe),Q,Me,ve;(Q=Te.next())&&!Q.done;)if(Q.value&&typeof Q.value=="object")ve||(ve=new D),$(ve,Q.value);else if(!P(oe,Q.value)){if(xe.strict||!V(Y,oe,Q.value))return!1;ve||(ve=new D),$(ve,Q.value)}if(ve){for(;(Me=me.next())&&!Me.done;)if(Me.value&&typeof Me.value=="object"){if(!G(ve,Me.value,xe.strict,ge))return!1}else if(!xe.strict&&!P(Y,Me.value)&&!G(ve,Me.value,xe.strict,ge))return!1;return U(ve)===0}return!0}h(ae,"setEquiv");function N(Y,oe,xe,ge){if(k(Y)!==k(oe))return!1;for(var Te=o(Y),me=o(oe),Q,Me,ve,Ie,ke,we;(Q=Te.next())&&!Q.done;)if(Ie=Q.value[0],ke=Q.value[1],Ie&&typeof Ie=="object")ve||(ve=new D),$(ve,Ie);else if(we=A(oe,Ie),typeof we>"u"&&!B(oe,Ie)||!q(ke,we,xe,ge)){if(xe.strict||!O(Y,oe,Ie,ke,xe,ge))return!1;ve||(ve=new D),$(ve,Ie)}if(ve){for(;(Me=me.next())&&!Me.done;)if(Ie=Me.value[0],we=Me.value[1],Ie&&typeof Ie=="object"){if(!j(ve,Y,Ie,we,xe,ge))return!1}else if(!xe.strict&&(!Y.has(Ie)||!q(A(Y,Ie),we,xe,ge))&&!j(ve,Y,Ie,we,t({},xe,{strict:!1}),ge))return!1;return U(ve)===0}return!0}h(N,"mapEquiv");function J(Y,oe,xe,ge){var Te,me;if(typeof Y!=typeof oe||Y==null||oe==null||L(Y)!==L(oe)||u(Y)!==u(oe))return!1;var Q=c(Y),Me=c(oe);if(Q!==Me)return!1;var ve=Y instanceof Error,Ie=oe instanceof Error;if(ve!==Ie||(ve||Ie)&&(Y.name!==oe.name||Y.message!==oe.message))return!1;var ke=m(Y),we=m(oe);if(ke!==we||(ke||we)&&(Y.source!==oe.source||n(Y)!==n(oe)))return!1;var Oe=d(Y),Je=d(oe);if(Oe!==Je||(Oe||Je)&&E(Y)!==E(oe)||xe.strict&&T&&T(Y)!==T(oe))return!1;var xt=w(Y),ne=w(oe);if(xt!==ne)return!1;if(xt||ne){if(Y.length!==oe.length)return!1;for(Te=0;Te<Y.length;Te++)if(Y[Te]!==oe[Te])return!1;return!0}var W=ee(Y),_e=ee(oe);if(W!==_e)return!1;if(W||_e){if(Y.length!==oe.length)return!1;for(Te=0;Te<Y.length;Te++)if(Y[Te]!==oe[Te])return!1;return!0}var Fe=p(Y),Ue=p(oe);if(Fe!==Ue)return!1;if(Fe||Ue)return b(Y)!==b(oe)?!1:typeof Uint8Array=="function"&&q(new Uint8Array(Y),new Uint8Array(oe),xe,ge);var Be=g(Y),bt=g(oe);if(Be!==bt)return!1;if(Be||bt)return C(Y)!==C(oe)?!1:typeof Uint8Array=="function"&&q(new Uint8Array(Y),new Uint8Array(oe),xe,ge);if(typeof Y!=typeof oe)return!1;var lt=_(Y),Ge=_(oe);if(lt.length!==Ge.length)return!1;for(lt.sort(),Ge.sort(),Te=lt.length-1;Te>=0;Te--)if(lt[Te]!=Ge[Te])return!1;for(Te=lt.length-1;Te>=0;Te--)if(me=lt[Te],!q(Y[me],oe[me],xe,ge))return!1;var We=x(Y),St=x(oe);return We!==St?!1:We==="Set"||St==="Set"?ae(Y,oe,xe,ge):We==="Map"?N(Y,oe,xe,ge):!0}h(J,"objEquiv"),e.exports=h(function(Y,oe,xe){return q(Y,oe,xe,s())},"deepEqual")}),kbe=tt(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});function e(N){return N&&N.__esModule?N:{default:N}}h(e,"_interopRequireDefault");var t=Object.defineProperty,r=h((N,J)=>t(N,"name",{value:J,configurable:!0}),"__name"),n=Dbe(),a=e(n),o,s=(o=class{constructor(N){this.direction=!1,this.compareProperties=!0;var J,Y,oe;this.precision=10**-((J=N==null?void 0:N.precision)!=null?J:17),this.direction=(Y=N==null?void 0:N.direction)!=null?Y:!1,this.compareProperties=(oe=N==null?void 0:N.compareProperties)!=null?oe:!0}compare(N,J){if(N.type!==J.type||!u(N,J))return!1;switch(N.type){case"Point":return this.compareCoord(N.coordinates,J.coordinates);case"LineString":return this.compareLine(N.coordinates,J.coordinates);case"Polygon":return this.comparePolygon(N,J);case"GeometryCollection":return this.compareGeometryCollection(N,J);case"Feature":return this.compareFeature(N,J);case"FeatureCollection":return this.compareFeatureCollection(N,J);default:if(N.type.startsWith("Multi")){let Y=c(N),oe=c(J);return Y.every(xe=>oe.some(ge=>this.compare(xe,ge)))}}return!1}compareCoord(N,J){return N.length===J.length&&N.every((Y,oe)=>Math.abs(Y-J[oe])<this.precision)}compareLine(N,J,Y=0,oe=!1){if(!u(N,J))return!1;let xe=N,ge=J;if(oe&&!this.compareCoord(xe[0],ge[0])){let me=this.fixStartIndex(ge,xe);if(me)ge=me;else return!1}let Te=this.compareCoord(xe[Y],ge[Y]);return this.direction||Te?this.comparePath(xe,ge):this.compareCoord(xe[Y],ge[ge.length-(1+Y)])?this.comparePath(xe.slice().reverse(),ge):!1}fixStartIndex(N,J){let Y,oe=-1;for(let xe=0;xe<N.length;xe++)if(this.compareCoord(N[xe],J[0])){oe=xe;break}return oe>=0&&(Y=[].concat(N.slice(oe,N.length),N.slice(1,oe+1))),Y}comparePath(N,J){return N.every((Y,oe)=>this.compareCoord(Y,J[oe]))}comparePolygon(N,J){if(this.compareLine(N.coordinates[0],J.coordinates[0],1,!0)){let Y=N.coordinates.slice(1,N.coordinates.length),oe=J.coordinates.slice(1,J.coordinates.length);return Y.every(xe=>oe.some(ge=>this.compareLine(xe,ge,1,!0)))}return!1}compareGeometryCollection(N,J){return u(N.geometries,J.geometries)&&this.compareBBox(N,J)&&N.geometries.every((Y,oe)=>this.compare(Y,J.geometries[oe]))}compareFeature(N,J){return N.id===J.id&&(this.compareProperties?a.default.call(void 0,N.properties,J.properties):!0)&&this.compareBBox(N,J)&&this.compare(N.geometry,J.geometry)}compareFeatureCollection(N,J){return u(N.features,J.features)&&this.compareBBox(N,J)&&N.features.every((Y,oe)=>this.compare(Y,J.features[oe]))}compareBBox(N,J){return!N.bbox&&!J.bbox||(N.bbox&&J.bbox?this.compareCoord(N.bbox,J.bbox):!1)}},h(o,"_GeojsonEquality"),o);r(s,"GeojsonEquality");var l=s;function u(N,J){return N.coordinates?N.coordinates.length===J.coordinates.length:N.length===J.length}h(u,"sameLength"),r(u,"sameLength");function c(N){return N.coordinates.map(J=>({type:N.type.replace("Multi",""),coordinates:J}))}h(c,"explode"),r(c,"explode");var p=63710088e-1,d={centimeters:p*100,centimetres:p*100,degrees:360/(2*Math.PI),feet:p*3.28084,inches:p*39.37,kilometers:p/1e3,kilometres:p/1e3,meters:p,metres:p,miles:p/1609.344,millimeters:p*1e3,millimetres:p*1e3,nauticalmiles:p/1852,radians:1,yards:p*1.0936},m={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function g(N,J,Y={}){let oe={type:"Feature"};return(Y.id===0||Y.id)&&(oe.id=Y.id),Y.bbox&&(oe.bbox=Y.bbox),oe.properties=J||{},oe.geometry=N,oe}h(g,"feature"),r(g,"feature");function _(N,J,Y={}){switch(N){case"Point":return y(J).geometry;case"LineString":return C(J).geometry;case"Polygon":return w(J).geometry;case"MultiPoint":return D(J).geometry;case"MultiLineString":return L(J).geometry;case"MultiPolygon":return B(J).geometry;default:throw new Error(N+" is invalid")}}h(_,"geometry"),r(_,"geometry");function y(N,J,Y={}){if(!N)throw new Error("coordinates is required");if(!Array.isArray(N))throw new Error("coordinates must be an Array");if(N.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!j(N[0])||!j(N[1]))throw new Error("coordinates must contain numbers");return g({type:"Point",coordinates:N},J,Y)}h(y,"point"),r(y,"point");function x(N,J,Y={}){return T(N.map(oe=>y(oe,J)),Y)}h(x,"points"),r(x,"points");function w(N,J,Y={}){for(let oe of N){if(oe.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(oe[oe.length-1].length!==oe[0].length)throw new Error("First and last Position are not equivalent.");for(let xe=0;xe<oe[oe.length-1].length;xe++)if(oe[oe.length-1][xe]!==oe[0][xe])throw new Error("First and last Position are not equivalent.")}return g({type:"Polygon",coordinates:N},J,Y)}h(w,"polygon"),r(w,"polygon");function b(N,J,Y={}){return T(N.map(oe=>w(oe,J)),Y)}h(b,"polygons"),r(b,"polygons");function C(N,J,Y={}){if(N.length<2)throw new Error("coordinates must be an array of two or more positions");return g({type:"LineString",coordinates:N},J,Y)}h(C,"lineString"),r(C,"lineString");function E(N,J,Y={}){return T(N.map(oe=>C(oe,J)),Y)}h(E,"lineStrings"),r(E,"lineStrings");function T(N,J={}){let Y={type:"FeatureCollection"};return J.id&&(Y.id=J.id),J.bbox&&(Y.bbox=J.bbox),Y.features=N,Y}h(T,"featureCollection"),r(T,"featureCollection");function L(N,J,Y={}){return g({type:"MultiLineString",coordinates:N},J,Y)}h(L,"multiLineString"),r(L,"multiLineString");function D(N,J,Y={}){return g({type:"MultiPoint",coordinates:N},J,Y)}h(D,"multiPoint"),r(D,"multiPoint");function B(N,J,Y={}){return g({type:"MultiPolygon",coordinates:N},J,Y)}h(B,"multiPolygon"),r(B,"multiPolygon");function A(N,J,Y={}){return g({type:"GeometryCollection",geometries:N},J,Y)}h(A,"geometryCollection"),r(A,"geometryCollection");function k(N,J=0){if(J&&!(J>=0))throw new Error("precision must be a positive number");let Y=Math.pow(10,J||0);return Math.round(N*Y)/Y}h(k,"round"),r(k,"round");function $(N,J="kilometers"){let Y=d[J];if(!Y)throw new Error(J+" units is invalid");return N*Y}h($,"radiansToLength"),r($,"radiansToLength");function z(N,J="kilometers"){let Y=d[J];if(!Y)throw new Error(J+" units is invalid");return N/Y}h(z,"lengthToRadians"),r(z,"lengthToRadians");function P(N,J){return G(z(N,J))}h(P,"lengthToDegrees"),r(P,"lengthToDegrees");function U(N){let J=N%360;return J<0&&(J+=360),J}h(U,"bearingToAzimuth"),r(U,"bearingToAzimuth");function G(N){return N%(2*Math.PI)*180/Math.PI}h(G,"radiansToDegrees"),r(G,"radiansToDegrees");function K(N){return N%360*Math.PI/180}h(K,"degreesToRadians"),r(K,"degreesToRadians");function O(N,J="kilometers",Y="kilometers"){if(!(N>=0))throw new Error("length must be a positive number");return $(z(N,J),Y)}h(O,"convertLength"),r(O,"convertLength");function V(N,J="meters",Y="kilometers"){if(!(N>=0))throw new Error("area must be a positive number");let oe=m[J];if(!oe)throw new Error("invalid original units");let xe=m[Y];if(!xe)throw new Error("invalid final units");return N/oe*xe}h(V,"convertArea"),r(V,"convertArea");function j(N){return!isNaN(N)&&N!==null&&!Array.isArray(N)}h(j,"isNumber"),r(j,"isNumber");function q(N){return N!==null&&typeof N=="object"&&!Array.isArray(N)}h(q,"isObject"),r(q,"isObject");function ee(N){if(!N)throw new Error("bbox is required");if(!Array.isArray(N))throw new Error("bbox must be an Array");if(N.length!==4&&N.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");N.forEach(J=>{if(!j(J))throw new Error("bbox must only contain numbers")})}h(ee,"validateBBox"),r(ee,"validateBBox");function ae(N){if(!N)throw new Error("id is required");if(["string","number"].indexOf(typeof N)===-1)throw new Error("id must be a number or a string")}h(ae,"validateId"),r(ae,"validateId"),i.GeojsonEquality=l,i.areaFactors=m,i.bearingToAzimuth=U,i.convertArea=V,i.convertLength=O,i.degreesToRadians=K,i.earthRadius=p,i.factors=d,i.feature=g,i.featureCollection=T,i.geometry=_,i.geometryCollection=A,i.isNumber=j,i.isObject=q,i.lengthToDegrees=P,i.lengthToRadians=z,i.lineString=C,i.lineStrings=E,i.multiLineString=L,i.multiPoint=D,i.multiPolygon=B,i.point=y,i.points=x,i.polygon=w,i.polygons=b,i.radiansToDegrees=G,i.radiansToLength=$,i.round=k,i.validateBBox=ee,i.validateId=ae}),Rbe=tt(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});var e=Object.defineProperty,t=h((E,T)=>e(E,"name",{value:T,configurable:!0}),"__name"),r=kbe();function n(E,T,L){if(E!==null)for(var D,B,A,k,$,z,P,U=0,G=0,K,O=E.type,V=O==="FeatureCollection",j=O==="Feature",q=V?E.features.length:1,ee=0;ee<q;ee++){P=V?E.features[ee].geometry:j?E.geometry:E,K=P?P.type==="GeometryCollection":!1,$=K?P.geometries.length:1;for(var ae=0;ae<$;ae++){var N=0,J=0;if(k=K?P.geometries[ae]:P,k!==null){z=k.coordinates;var Y=k.type;switch(U=L&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(T(z,G,ee,N,J)===!1)return!1;G++,N++;break;case"LineString":case"MultiPoint":for(D=0;D<z.length;D++){if(T(z[D],G,ee,N,J)===!1)return!1;G++,Y==="MultiPoint"&&N++}Y==="LineString"&&N++;break;case"Polygon":case"MultiLineString":for(D=0;D<z.length;D++){for(B=0;B<z[D].length-U;B++){if(T(z[D][B],G,ee,N,J)===!1)return!1;G++}Y==="MultiLineString"&&N++,Y==="Polygon"&&J++}Y==="Polygon"&&N++;break;case"MultiPolygon":for(D=0;D<z.length;D++){for(J=0,B=0;B<z[D].length;B++){for(A=0;A<z[D][B].length-U;A++){if(T(z[D][B][A],G,ee,N,J)===!1)return!1;G++}J++}N++}break;case"GeometryCollection":for(D=0;D<k.geometries.length;D++)if(n(k.geometries[D],T,L)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}h(n,"coordEach"),t(n,"coordEach");function a(E,T,L,D){var B=L;return n(E,function(A,k,$,z,P){k===0&&L===void 0?B=A:B=T(B,A,k,$,z,P)},D),B}h(a,"coordReduce"),t(a,"coordReduce");function o(E,T){var L;switch(E.type){case"FeatureCollection":for(L=0;L<E.features.length&&T(E.features[L].properties,L)!==!1;L++);break;case"Feature":T(E.properties,0);break}}h(o,"propEach"),t(o,"propEach");function s(E,T,L){var D=L;return o(E,function(B,A){A===0&&L===void 0?D=B:D=T(D,B,A)}),D}h(s,"propReduce"),t(s,"propReduce");function l(E,T){if(E.type==="Feature")T(E,0);else if(E.type==="FeatureCollection")for(var L=0;L<E.features.length&&T(E.features[L],L)!==!1;L++);}h(l,"featureEach"),t(l,"featureEach");function u(E,T,L){var D=L;return l(E,function(B,A){A===0&&L===void 0?D=B:D=T(D,B,A)}),D}h(u,"featureReduce"),t(u,"featureReduce");function c(E){var T=[];return n(E,function(L){T.push(L)}),T}h(c,"coordAll"),t(c,"coordAll");function p(E,T){var L,D,B,A,k,$,z,P,U,G,K=0,O=E.type==="FeatureCollection",V=E.type==="Feature",j=O?E.features.length:1;for(L=0;L<j;L++){for($=O?E.features[L].geometry:V?E.geometry:E,P=O?E.features[L].properties:V?E.properties:{},U=O?E.features[L].bbox:V?E.bbox:void 0,G=O?E.features[L].id:V?E.id:void 0,z=$?$.type==="GeometryCollection":!1,k=z?$.geometries.length:1,B=0;B<k;B++){if(A=z?$.geometries[B]:$,A===null){if(T(null,K,P,U,G)===!1)return!1;continue}switch(A.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(T(A,K,P,U,G)===!1)return!1;break}case"GeometryCollection":{for(D=0;D<A.geometries.length;D++)if(T(A.geometries[D],K,P,U,G)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}K++}}h(p,"geomEach"),t(p,"geomEach");function d(E,T,L){var D=L;return p(E,function(B,A,k,$,z){A===0&&L===void 0?D=B:D=T(D,B,A,k,$,z)}),D}h(d,"geomReduce"),t(d,"geomReduce");function m(E,T){p(E,function(L,D,B,A,k){var $=L===null?null:L.type;switch($){case null:case"Point":case"LineString":case"Polygon":return T(r.feature.call(void 0,L,B,{bbox:A,id:k}),D,0)===!1?!1:void 0}var z;switch($){case"MultiPoint":z="Point";break;case"MultiLineString":z="LineString";break;case"MultiPolygon":z="Polygon";break}for(var P=0;P<L.coordinates.length;P++){var U=L.coordinates[P],G={type:z,coordinates:U};if(T(r.feature.call(void 0,G,B),D,P)===!1)return!1}})}h(m,"flattenEach"),t(m,"flattenEach");function g(E,T,L){var D=L;return m(E,function(B,A,k){A===0&&k===0&&L===void 0?D=B:D=T(D,B,A,k)}),D}h(g,"flattenReduce"),t(g,"flattenReduce");function _(E,T){m(E,function(L,D,B){var A=0;if(L.geometry){var k=L.geometry.type;if(!(k==="Point"||k==="MultiPoint")){var $,z=0,P=0,U=0;if(n(L,function(G,K,O,V,j){if($===void 0||D>z||V>P||j>U){$=G,z=D,P=V,U=j,A=0;return}var q=r.lineString.call(void 0,[$,G],L.properties);if(T(q,D,B,j,A)===!1)return!1;A++,$=G})===!1)return!1}}})}h(_,"segmentEach"),t(_,"segmentEach");function y(E,T,L){var D=L,B=!1;return _(E,function(A,k,$,z,P){B===!1&&L===void 0?D=A:D=T(D,A,k,$,z,P),B=!0}),D}h(y,"segmentReduce"),t(y,"segmentReduce");function x(E,T){if(!E)throw new Error("geojson is required");m(E,function(L,D,B){if(L.geometry!==null){var A=L.geometry.type,k=L.geometry.coordinates;switch(A){case"LineString":if(T(L,D,B,0,0)===!1)return!1;break;case"Polygon":for(var $=0;$<k.length;$++)if(T(r.lineString.call(void 0,k[$],L.properties),D,B,$)===!1)return!1;break}}})}h(x,"lineEach"),t(x,"lineEach");function w(E,T,L){var D=L;return x(E,function(B,A,k,$){A===0&&L===void 0?D=B:D=T(D,B,A,k,$)}),D}h(w,"lineReduce"),t(w,"lineReduce");function b(E,T){if(T=T||{},!r.isObject.call(void 0,T))throw new Error("options is invalid");var L=T.featureIndex||0,D=T.multiFeatureIndex||0,B=T.geometryIndex||0,A=T.segmentIndex||0,k=T.properties,$;switch(E.type){case"FeatureCollection":L<0&&(L=E.features.length+L),k=k||E.features[L].properties,$=E.features[L].geometry;break;case"Feature":k=k||E.properties,$=E.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":$=E;break;default:throw new Error("geojson is invalid")}if($===null)return null;var z=$.coordinates;switch($.type){case"Point":case"MultiPoint":return null;case"LineString":return A<0&&(A=z.length+A-1),r.lineString.call(void 0,[z[A],z[A+1]],k,T);case"Polygon":return B<0&&(B=z.length+B),A<0&&(A=z[B].length+A-1),r.lineString.call(void 0,[z[B][A],z[B][A+1]],k,T);case"MultiLineString":return D<0&&(D=z.length+D),A<0&&(A=z[D].length+A-1),r.lineString.call(void 0,[z[D][A],z[D][A+1]],k,T);case"MultiPolygon":return D<0&&(D=z.length+D),B<0&&(B=z[D].length+B),A<0&&(A=z[D][B].length-A-1),r.lineString.call(void 0,[z[D][B][A],z[D][B][A+1]],k,T)}throw new Error("geojson is invalid")}h(b,"findSegment"),t(b,"findSegment");function C(E,T){if(T=T||{},!r.isObject.call(void 0,T))throw new Error("options is invalid");var L=T.featureIndex||0,D=T.multiFeatureIndex||0,B=T.geometryIndex||0,A=T.coordIndex||0,k=T.properties,$;switch(E.type){case"FeatureCollection":L<0&&(L=E.features.length+L),k=k||E.features[L].properties,$=E.features[L].geometry;break;case"Feature":k=k||E.properties,$=E.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":$=E;break;default:throw new Error("geojson is invalid")}if($===null)return null;var z=$.coordinates;switch($.type){case"Point":return r.point.call(void 0,z,k,T);case"MultiPoint":return D<0&&(D=z.length+D),r.point.call(void 0,z[D],k,T);case"LineString":return A<0&&(A=z.length+A),r.point.call(void 0,z[A],k,T);case"Polygon":return B<0&&(B=z.length+B),A<0&&(A=z[B].length+A),r.point.call(void 0,z[B][A],k,T);case"MultiLineString":return D<0&&(D=z.length+D),A<0&&(A=z[D].length+A),r.point.call(void 0,z[D][A],k,T);case"MultiPolygon":return D<0&&(D=z.length+D),B<0&&(B=z[D].length+B),A<0&&(A=z[D][B].length-A),r.point.call(void 0,z[D][B][A],k,T)}throw new Error("geojson is invalid")}h(C,"findPoint"),t(C,"findPoint"),i.coordAll=c,i.coordEach=n,i.coordReduce=a,i.featureEach=l,i.featureReduce=u,i.findPoint=C,i.findSegment=b,i.flattenEach=m,i.flattenReduce=g,i.geomEach=p,i.geomReduce=d,i.lineEach=x,i.lineReduce=w,i.propEach=o,i.propReduce=s,i.segmentEach=_,i.segmentReduce=y}),Fbe=tt(i=>{R(),Object.defineProperty(i,"__esModule",{value:!0});var e=Object.defineProperty,t=h((o,s)=>e(o,"name",{value:s,configurable:!0}),"__name"),r=Rbe();function n(o,s={}){if(o.bbox!=null&&s.recompute!==!0)return o.bbox;let l=[1/0,1/0,-1/0,-1/0];return r.coordEach.call(void 0,o,u=>{l[0]>u[0]&&(l[0]=u[0]),l[1]>u[1]&&(l[1]=u[1]),l[2]<u[0]&&(l[2]=u[0]),l[3]<u[1]&&(l[3]=u[1])}),l}h(n,"bbox"),t(n,"bbox");var a=n;i.bbox=n,i.default=a}),Obe=tt((i,e)=>{R();var t=H2e(),r=UK(),n=G2e(),a=Fbe().default,o=n.featureEach;n.coordEach,r.polygon;var s=r.featureCollection;function l(u){var c=new t(u);return c.insert=function(p){if(p.type!=="Feature")throw new Error("invalid feature");return p.bbox=p.bbox?p.bbox:a(p),t.prototype.insert.call(this,p)},c.load=function(p){var d=[];return Array.isArray(p)?p.forEach(function(m){if(m.type!=="Feature")throw new Error("invalid features");m.bbox=m.bbox?m.bbox:a(m),d.push(m)}):o(p,function(m){if(m.type!=="Feature")throw new Error("invalid features");m.bbox=m.bbox?m.bbox:a(m),d.push(m)}),t.prototype.load.call(this,d)},c.remove=function(p,d){if(p.type!=="Feature")throw new Error("invalid feature");return p.bbox=p.bbox?p.bbox:a(p),t.prototype.remove.call(this,p,d)},c.clear=function(){return t.prototype.clear.call(this)},c.search=function(p){var d=t.prototype.search.call(this,this.toBBox(p));return s(d)},c.collides=function(p){return t.prototype.collides.call(this,this.toBBox(p))},c.all=function(){var p=t.prototype.all.call(this);return s(p)},c.toJSON=function(){return t.prototype.toJSON.call(this)},c.fromJSON=function(p){return t.prototype.fromJSON.call(this,p)},c.toBBox=function(p){var d;if(p.bbox)d=p.bbox;else if(Array.isArray(p)&&p.length===4)d=p;else if(Array.isArray(p)&&p.length===6)d=[p[0],p[1],p[3],p[4]];else if(p.type==="Feature")d=a(p);else if(p.type==="FeatureCollection")d=a(p);else throw new Error("invalid geojson");return{minX:d[0],minY:d[1],maxX:d[2],maxY:d[3]}},c}h(l,"geojsonRbush"),e.exports=l,e.exports.default=l}),Og=tt((i,e)=>{R();var t=h(function(){this._tweens={},this._tweensAddedDuringUpdate={}},"_Group");t.prototype={getAll:function(){return Object.keys(this._tweens).map((function(n){return this._tweens[n]}).bind(this))},removeAll:function(){this._tweens={}},add:function(n){this._tweens[n.getId()]=n,this._tweensAddedDuringUpdate[n.getId()]=n},remove:function(n){delete this._tweens[n.getId()],delete this._tweensAddedDuringUpdate[n.getId()]},update:function(n,a){var o=Object.keys(this._tweens);if(o.length===0)return!1;for(n=n!==void 0?n:r.now();o.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<o.length;s++){var l=this._tweens[o[s]];l&&l.update(n)===!1&&(l._isPlaying=!1,a||delete this._tweens[o[s]])}o=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var r=new t;r.Group=t,r._nextId=0,r.nextId=function(){return r._nextId++},typeof self>"u"&&typeof dr<"u"&&dr.hrtime?r.now=function(){var n=dr.hrtime();return n[0]*1e3+n[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?r.now=self.performance.now.bind(self.performance):Date.now!==void 0?r.now=Date.now:r.now=function(){return new Date().getTime()},r.Tween=function(n,a){this._object=n,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=r.Easing.Linear.None,this._interpolationFunction=r.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=a||r,this._id=r.nextId()},r.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(n,a){return this._valuesEnd=n,a!==void 0&&(this._duration=a),this},duration:h(function(n){return this._duration=n,this},"duration"),start:function(n){this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=n!==void 0?typeof n=="string"?r.now()+parseFloat(n):n:r.now(),this._startTime+=this._delayTime;for(var a in this._valuesEnd){if(this._valuesEnd[a]instanceof Array){if(this._valuesEnd[a].length===0)continue;this._valuesEnd[a]=[this._object[a]].concat(this._valuesEnd[a])}this._object[a]!==void 0&&(this._valuesStart[a]=this._object[a],this._valuesStart[a]instanceof Array||(this._valuesStart[a]*=1),this._valuesStartRepeat[a]=this._valuesStart[a]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._onStopCallback!==null&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},stopChainedTweens:function(){for(var n=0,a=this._chainedTweens.length;n<a;n++)this._chainedTweens[n].stop()},group:function(n){return this._group=n,this},delay:function(n){return this._delayTime=n,this},repeat:function(n){return this._repeat=n,this},repeatDelay:function(n){return this._repeatDelayTime=n,this},yoyo:function(n){return this._yoyo=n,this},easing:function(n){return this._easingFunction=n,this},interpolation:function(n){return this._interpolationFunction=n,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(n){return this._onStartCallback=n,this},onUpdate:function(n){return this._onUpdateCallback=n,this},onRepeat:h(function(n){return this._onRepeatCallback=n,this},"onRepeat"),onComplete:function(n){return this._onCompleteCallback=n,this},onStop:function(n){return this._onStopCallback=n,this},update:function(n){var a,o,s;if(n<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback!==null&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),o=(n-this._startTime)/this._duration,o=this._duration===0||o>1?1:o,s=this._easingFunction(o);for(a in this._valuesEnd)if(this._valuesStart[a]!==void 0){var l=this._valuesStart[a]||0,u=this._valuesEnd[a];u instanceof Array?this._object[a]=this._interpolationFunction(u,s):(typeof u=="string"&&(u.charAt(0)==="+"||u.charAt(0)==="-"?u=l+parseFloat(u):u=parseFloat(u)),typeof u=="number"&&(this._object[a]=l+(u-l)*s))}if(this._onUpdateCallback!==null&&this._onUpdateCallback(this._object,o),o===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(a in this._valuesStartRepeat){if(typeof this._valuesEnd[a]=="string"&&(this._valuesStartRepeat[a]=this._valuesStartRepeat[a]+parseFloat(this._valuesEnd[a])),this._yoyo){var c=this._valuesStartRepeat[a];this._valuesStartRepeat[a]=this._valuesEnd[a],this._valuesEnd[a]=c}this._valuesStart[a]=this._valuesStartRepeat[a]}return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=n+this._repeatDelayTime:this._startTime=n+this._delayTime,this._onRepeatCallback!==null&&this._onRepeatCallback(this._object),!0}else{this._onCompleteCallback!==null&&this._onCompleteCallback(this._object);for(var p=0,d=this._chainedTweens.length;p<d;p++)this._chainedTweens[p].start(this._startTime+this._duration);return!1}return!0}},r.Easing={Linear:{None:function(n){return n}},Quadratic:{In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}},Cubic:{In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}},Quartic:{In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}},Quintic:{In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}},Sinusoidal:{In:function(n){return 1-Math.cos(n*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.cos(Math.PI*n))}},Exponential:{In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}},Circular:{In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}},Elastic:{In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}},Back:{In:function(n){var a=1.70158;return n*n*((a+1)*n-a)},Out:function(n){var a=1.70158;return--n*n*((a+1)*n+a)+1},InOut:function(n){var a=2.5949095;return(n*=2)<1?.5*(n*n*((a+1)*n-a)):.5*((n-=2)*n*((a+1)*n+a)+2)}},Bounce:{In:function(n){return 1-r.Easing.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?r.Easing.Bounce.In(n*2)*.5:r.Easing.Bounce.Out(n*2-1)*.5+.5}}},r.Interpolation={Linear:function(n,a){var o=n.length-1,s=o*a,l=Math.floor(s),u=r.Interpolation.Utils.Linear;return a<0?u(n[0],n[1],s):a>1?u(n[o],n[o-1],o-s):u(n[l],n[l+1>o?o:l+1],s-l)},Bezier:function(n,a){for(var o=0,s=n.length-1,l=Math.pow,u=r.Interpolation.Utils.Bernstein,c=0;c<=s;c++)o+=l(1-a,s-c)*l(a,c)*n[c]*u(s,c);return o},CatmullRom:function(n,a){var o=n.length-1,s=o*a,l=Math.floor(s),u=r.Interpolation.Utils.CatmullRom;return n[0]===n[o]?(a<0&&(l=Math.floor(s=o*(1+a))),u(n[(l-1+o)%o],n[l],n[(l+1)%o],n[(l+2)%o],s-l)):a<0?n[0]-(u(n[0],n[0],n[1],n[1],-s)-n[0]):a>1?n[o]-(u(n[o],n[o],n[o-1],n[o-1],s-o)-n[o]):u(n[l?l-1:0],n[l],n[o<l+1?o:l+1],n[o<l+2?o:l+2],s-l)},Utils:{Linear:function(n,a,o){return(a-n)*o+n},Bernstein:function(n,a){var o=r.Interpolation.Utils.Factorial;return o(n)/o(a)/o(n-a)},Factorial:function(){var n=[1];return function(a){var o=1;if(n[a])return n[a];for(var s=a;s>1;s--)o*=s;return n[a]=o,o}}(),CatmullRom:function(n,a,o,s,l){var u=(o-n)*.5,c=(s-a)*.5,p=l*l,d=l*p;return(2*a-2*o+u+c)*d+(-3*a+3*o-2*u-c)*p+u*l+a}}},function(n){typeof define=="function"&&define.amd?define([],function(){return r}):typeof e<"u"&&typeof i=="object"?e.exports=r:n!==void 0&&(n.TWEEN=r)}(i)}),Bbe=tt((i,e)=>{R();var t=200,r="__lodash_hash_undefined__",n=800,a=16,o=9007199254740991,s="[object Arguments]",l="[object Array]",u="[object AsyncFunction]",c="[object Boolean]",p="[object Date]",d="[object Error]",m="[object Function]",g="[object GeneratorFunction]",_="[object Map]",y="[object Number]",x="[object Null]",w="[object Object]",b="[object Proxy]",C="[object RegExp]",E="[object Set]",T="[object String]",L="[object Undefined]",D="[object WeakMap]",B="[object ArrayBuffer]",A="[object DataView]",k="[object Float32Array]",$="[object Float64Array]",z="[object Int8Array]",P="[object Int16Array]",U="[object Int32Array]",G="[object Uint8Array]",K="[object Uint8ClampedArray]",O="[object Uint16Array]",V="[object Uint32Array]",j=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,ee=/^(?:0|[1-9]\d*)$/,ae={};ae[k]=ae[$]=ae[z]=ae[P]=ae[U]=ae[G]=ae[K]=ae[O]=ae[V]=!0,ae[s]=ae[l]=ae[B]=ae[c]=ae[A]=ae[p]=ae[d]=ae[m]=ae[_]=ae[y]=ae[w]=ae[C]=ae[E]=ae[T]=ae[D]=!1;var N=typeof global=="object"&&global&&global.Object===Object&&global,J=typeof self=="object"&&self&&self.Object===Object&&self,Y=N||J||Function("return this")(),oe=typeof i=="object"&&i&&!i.nodeType&&i,xe=oe&&typeof e=="object"&&e&&!e.nodeType&&e,ge=xe&&xe.exports===oe,Te=ge&&N.process,me=function(){try{var re=xe&&xe.require&&xe.require("util").types;return re||Te&&Te.binding&&Te.binding("util")}catch{}}(),Q=me&&me.isTypedArray;function Me(re,pe,Ae){switch(Ae.length){case 0:return re.call(pe);case 1:return re.call(pe,Ae[0]);case 2:return re.call(pe,Ae[0],Ae[1]);case 3:return re.call(pe,Ae[0],Ae[1],Ae[2])}return re.apply(pe,Ae)}h(Me,"apply");function ve(re,pe){for(var Ae=-1,gt=Array(re);++Ae<re;)gt[Ae]=pe(Ae);return gt}h(ve,"baseTimes");function Ie(re){return function(pe){return re(pe)}}h(Ie,"baseUnary");function ke(re,pe){return re==null?void 0:re[pe]}h(ke,"getValue");function we(re,pe){return function(Ae){return re(pe(Ae))}}h(we,"overArg");var Oe=Array.prototype,Je=Function.prototype,xt=Object.prototype,ne=Y["__core-js_shared__"],W=Je.toString,_e=xt.hasOwnProperty,Fe=function(){var re=/[^.]+$/.exec(ne&&ne.keys&&ne.keys.IE_PROTO||"");return re?"Symbol(src)_1."+re:""}(),Ue=xt.toString,Be=W.call(Object),bt=RegExp("^"+W.call(_e).replace(j,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),lt=ge?Y.Buffer:void 0,Ge=Y.Symbol,We=Y.Uint8Array,St=lt?lt.allocUnsafe:void 0,Ze=we(Object.getPrototypeOf,Object),ni=Object.create,Dt=xt.propertyIsEnumerable,ue=Oe.splice,he=Ge?Ge.toStringTag:void 0,qe=function(){try{var re=f(Object,"defineProperty");return re({},"",{}),re}catch{}}(),ft=lt?lt.isBuffer:void 0,ct=Math.max,dt=Date.now,ce=f(Y,"Map"),it=f(Object,"create"),be=function(){function re(){}return h(re,"object"),function(pe){if(!Lo(pe))return{};if(ni)return ni(pe);re.prototype=pe;var Ae=new re;return re.prototype=void 0,Ae}}();function Xe(re){var pe=-1,Ae=re==null?0:re.length;for(this.clear();++pe<Ae;){var gt=re[pe];this.set(gt[0],gt[1])}}h(Xe,"Hash");function rt(){this.__data__=it?it(null):{},this.size=0}h(rt,"hashClear");function Wt(re){var pe=this.has(re)&&delete this.__data__[re];return this.size-=pe?1:0,pe}h(Wt,"hashDelete");function Ut(re){var pe=this.__data__;if(it){var Ae=pe[re];return Ae===r?void 0:Ae}return _e.call(pe,re)?pe[re]:void 0}h(Ut,"hashGet");function Ti(re){var pe=this.__data__;return it?pe[re]!==void 0:_e.call(pe,re)}h(Ti,"hashHas");function lr(re,pe){var Ae=this.__data__;return this.size+=this.has(re)?0:1,Ae[re]=it&&pe===void 0?r:pe,this}h(lr,"hashSet"),Xe.prototype.clear=rt,Xe.prototype.delete=Wt,Xe.prototype.get=Ut,Xe.prototype.has=Ti,Xe.prototype.set=lr;function jt(re){var pe=-1,Ae=re==null?0:re.length;for(this.clear();++pe<Ae;){var gt=re[pe];this.set(gt[0],gt[1])}}h(jt,"ListCache");function Pi(){this.__data__=[],this.size=0}h(Pi,"listCacheClear");function mr(re){var pe=this.__data__,Ae=It(pe,re);if(Ae<0)return!1;var gt=pe.length-1;return Ae==gt?pe.pop():ue.call(pe,Ae,1),--this.size,!0}h(mr,"listCacheDelete");function kn(re){var pe=this.__data__,Ae=It(pe,re);return Ae<0?void 0:pe[Ae][1]}h(kn,"listCacheGet");function Ma(re){return It(this.__data__,re)>-1}h(Ma,"listCacheHas");function gn(re,pe){var Ae=this.__data__,gt=It(Ae,re);return gt<0?(++this.size,Ae.push([re,pe])):Ae[gt][1]=pe,this}h(gn,"listCacheSet"),jt.prototype.clear=Pi,jt.prototype.delete=mr,jt.prototype.get=kn,jt.prototype.has=Ma,jt.prototype.set=gn;function Yr(re){var pe=-1,Ae=re==null?0:re.length;for(this.clear();++pe<Ae;){var gt=re[pe];this.set(gt[0],gt[1])}}h(Yr,"MapCache");function Rn(){this.size=0,this.__data__={hash:new Xe,map:new(ce||jt),string:new Xe}}h(Rn,"mapCacheClear");function ra(re){var pe=Ka(this,re).delete(re);return this.size-=pe?1:0,pe}h(ra,"mapCacheDelete");function Ca(re){return Ka(this,re).get(re)}h(Ca,"mapCacheGet");function Ea(re){return Ka(this,re).has(re)}h(Ea,"mapCacheHas");function Ya(re,pe){var Ae=Ka(this,re),gt=Ae.size;return Ae.set(re,pe),this.size+=Ae.size==gt?0:1,this}h(Ya,"mapCacheSet"),Yr.prototype.clear=Rn,Yr.prototype.delete=ra,Yr.prototype.get=Ca,Yr.prototype.has=Ea,Yr.prototype.set=Ya;function yn(re){var pe=this.__data__=new jt(re);this.size=pe.size}h(yn,"Stack");function te(){this.__data__=new jt,this.size=0}h(te,"stackClear");function ye(re){var pe=this.__data__,Ae=pe.delete(re);return this.size=pe.size,Ae}h(ye,"stackDelete");function Ce(re){return this.__data__.get(re)}h(Ce,"stackGet");function Pe(re){return this.__data__.has(re)}h(Pe,"stackHas");function Se(re,pe){var Ae=this.__data__;if(Ae instanceof jt){var gt=Ae.__data__;if(!ce||gt.length<t-1)return gt.push([re,pe]),this.size=++Ae.size,this;Ae=this.__data__=new Yr(gt)}return Ae.set(re,pe),this.size=Ae.size,this}h(Se,"stackSet"),yn.prototype.clear=te,yn.prototype.delete=ye,yn.prototype.get=Ce,yn.prototype.has=Pe,yn.prototype.set=Se;function at(re,pe){var Ae=Fr(re),gt=!Ae&&ki(re),hi=!Ae&&!gt&&Ng(re),vi=!Ae&&!gt&&!hi&&pP(re),Vi=Ae||gt||hi||vi,ci=Vi?ve(re.length,String):[],ji=ci.length;for(var Aa in re)(pe||_e.call(re,Aa))&&!(Vi&&(Aa=="length"||hi&&(Aa=="offset"||Aa=="parent")||vi&&(Aa=="buffer"||Aa=="byteLength"||Aa=="byteOffset")||I(Aa,ji)))&&ci.push(Aa);return ci}h(at,"arrayLikeKeys");function wt(re,pe,Ae){(Ae!==void 0&&!qt(re[pe],Ae)||Ae===void 0&&!(pe in re))&&Ft(re,pe,Ae)}h(wt,"assignMergeValue");function Pt(re,pe,Ae){var gt=re[pe];(!(_e.call(re,pe)&&qt(gt,Ae))||Ae===void 0&&!(pe in re))&&Ft(re,pe,Ae)}h(Pt,"assignValue");function It(re,pe){for(var Ae=re.length;Ae--;)if(qt(re[Ae][0],pe))return Ae;return-1}h(It,"assocIndexOf");function Ft(re,pe,Ae){pe=="__proto__"&&qe?qe(re,pe,{configurable:!0,enumerable:!0,value:Ae,writable:!0}):re[pe]=Ae}h(Ft,"baseAssignValue");var Ht=Ws();function Ot(re){return re==null?re===void 0?L:x:he&&he in Object(re)?v(re):Ee(re)}h(Ot,"baseGetTag");function Ji(re){return Rh(re)&&Ot(re)==s}h(Ji,"baseIsArguments");function Di(re){if(!Lo(re)||X(re))return!1;var pe=Qa(re)?bt:q;return pe.test(Tt(re))}h(Di,"baseIsNative");function jr(re){return Rh(re)&&H_(re.length)&&!!ae[Ot(re)]}h(jr,"baseIsTypedArray");function vn(re){if(!Lo(re))return de(re);var pe=se(re),Ae=[];for(var gt in re)gt=="constructor"&&(pe||!_e.call(re,gt))||Ae.push(gt);return Ae}h(vn,"baseKeysIn");function bi(re,pe,Ae,gt,hi){re!==pe&&Ht(pe,function(vi,Vi){if(hi||(hi=new yn),Lo(vi))Nt(re,pe,Vi,Ae,bi,gt,hi);else{var ci=gt?gt(Ke(re,Vi),vi,Vi+"",re,pe,hi):void 0;ci===void 0&&(ci=vi),wt(re,Vi,ci)}},G_)}h(bi,"baseMerge");function Nt(re,pe,Ae,gt,hi,vi,Vi){var ci=Ke(re,Ae),ji=Ke(pe,Ae),Aa=Vi.get(ji);if(Aa){wt(re,Ae,Aa);return}var na=vi?vi(ci,ji,Ae+"",re,pe,Vi):void 0,Ad=na===void 0;if(Ad){var X_=Fr(ji),q_=!X_&&Ng(ji),gP=!X_&&!q_&&pP(ji);na=ji,X_||q_||gP?Fr(ci)?na=ci:zg(ci)?na=Vt(ci):q_?(Ad=!1,na=Ta(ji,!0)):gP?(Ad=!1,na=Ja(ji,!0)):na=[]:cP(ji)||ki(ji)?(na=ci,ki(ci)?na=dP(ci):(!Lo(ci)||Qa(ci))&&(na=S(ji))):Ad=!1}Ad&&(Vi.set(ji,na),hi(na,ji,gt,vi,Vi),Vi.delete(ji)),wt(re,Ae,na)}h(Nt,"baseMergeDeep");function Io(re,pe){return mt(je(re,pe,W_),re+"")}h(Io,"baseRest");var gr=qe?function(re,pe){return qe(re,"toString",{configurable:!0,enumerable:!1,value:fP(pe),writable:!0})}:W_;function Ta(re,pe){if(pe)return re.slice();var Ae=re.length,gt=St?St(Ae):new re.constructor(Ae);return re.copy(gt),gt}h(Ta,"cloneBuffer");function Gs(re){var pe=new re.constructor(re.byteLength);return new We(pe).set(new We(re)),pe}h(Gs,"cloneArrayBuffer");function Ja(re,pe){var Ae=pe?Gs(re.buffer):re.buffer;return new re.constructor(Ae,re.byteOffset,re.length)}h(Ja,"cloneTypedArray");function Vt(re,pe){var Ae=-1,gt=re.length;for(pe||(pe=Array(gt));++Ae<gt;)pe[Ae]=re[Ae];return pe}h(Vt,"copyArray");function Ui(re,pe,Ae,gt){var hi=!Ae;Ae||(Ae={});for(var vi=-1,Vi=pe.length;++vi<Vi;){var ci=pe[vi],ji=gt?gt(Ae[ci],re[ci],ci,Ae,re):void 0;ji===void 0&&(ji=re[ci]),hi?Ft(Ae,ci,ji):Pt(Ae,ci,ji)}return Ae}h(Ui,"copyObject");function Pa(re){return Io(function(pe,Ae){var gt=-1,hi=Ae.length,vi=hi>1?Ae[hi-1]:void 0,Vi=hi>2?Ae[2]:void 0;for(vi=re.length>3&&typeof vi=="function"?(hi--,vi):void 0,Vi&&F(Ae[0],Ae[1],Vi)&&(vi=hi<3?void 0:vi,hi=1),pe=Object(pe);++gt<hi;){var ci=Ae[gt];ci&&re(pe,ci,gt,vi)}return pe})}h(Pa,"createAssigner");function Ws(re){return function(pe,Ae,gt){for(var hi=-1,vi=Object(pe),Vi=gt(pe),ci=Vi.length;ci--;){var ji=Vi[re?ci:++hi];if(Ae(vi[ji],ji,vi)===!1)break}return pe}}h(Ws,"createBaseFor");function Hr(re,pe,Ae,gt,hi,vi){return Lo(re)&&Lo(pe)&&(vi.set(pe,re),bi(re,pe,void 0,Hr,vi),vi.delete(pe)),re}h(Hr,"customDefaultsMerge");function Ka(re,pe){var Ae=re.__data__;return H(pe)?Ae[typeof pe=="string"?"string":"hash"]:Ae.map}h(Ka,"getMapData");function f(re,pe){var Ae=ke(re,pe);return Di(Ae)?Ae:void 0}h(f,"getNative");function v(re){var pe=_e.call(re,he),Ae=re[he];try{re[he]=void 0;var gt=!0}catch{}var hi=Ue.call(re);return gt&&(pe?re[he]=Ae:delete re[he]),hi}h(v,"getRawTag");function S(re){return typeof re.constructor=="function"&&!se(re)?be(Ze(re)):{}}h(S,"initCloneObject");function I(re,pe){var Ae=typeof re;return pe=pe??o,!!pe&&(Ae=="number"||Ae!="symbol"&&ee.test(re))&&re>-1&&re%1==0&&re<pe}h(I,"isIndex");function F(re,pe,Ae){if(!Lo(Ae))return!1;var gt=typeof pe;return(gt=="number"?xn(Ae)&&I(pe,Ae.length):gt=="string"&&pe in Ae)?qt(Ae[pe],re):!1}h(F,"isIterateeCall");function H(re){var pe=typeof re;return pe=="string"||pe=="number"||pe=="symbol"||pe=="boolean"?re!=="__proto__":re===null}h(H,"isKeyable");function X(re){return!!Fe&&Fe in re}h(X,"isMasked");function se(re){var pe=re&&re.constructor,Ae=typeof pe=="function"&&pe.prototype||xt;return re===Ae}h(se,"isPrototype");function de(re){var pe=[];if(re!=null)for(var Ae in Object(re))pe.push(Ae);return pe}h(de,"nativeKeysIn");function Ee(re){return Ue.call(re)}h(Ee,"objectToString");function je(re,pe,Ae){return pe=ct(pe===void 0?re.length-1:pe,0),function(){for(var gt=arguments,hi=-1,vi=ct(gt.length-pe,0),Vi=Array(vi);++hi<vi;)Vi[hi]=gt[pe+hi];hi=-1;for(var ci=Array(pe+1);++hi<pe;)ci[hi]=gt[hi];return ci[pe]=Ae(Vi),Me(re,this,ci)}}h(je,"overRest");function Ke(re,pe){if(!(pe==="constructor"&&typeof re[pe]=="function")&&pe!="__proto__")return re[pe]}h(Ke,"safeGet");var mt=Lt(gr);function Lt(re){var pe=0,Ae=0;return function(){var gt=dt(),hi=a-(gt-Ae);if(Ae=gt,hi>0){if(++pe>=n)return arguments[0]}else pe=0;return re.apply(void 0,arguments)}}h(Lt,"shortOut");function Tt(re){if(re!=null){try{return W.call(re)}catch{}try{return re+""}catch{}}return""}h(Tt,"toSource");function qt(re,pe){return re===pe||re!==re&&pe!==pe}h(qt,"eq");var ki=Ji(function(){return arguments}())?Ji:function(re){return Rh(re)&&_e.call(re,"callee")&&!Dt.call(re,"callee")},Fr=Array.isArray;function xn(re){return re!=null&&H_(re.length)&&!Qa(re)}h(xn,"isArrayLike");function zg(re){return Rh(re)&&xn(re)}h(zg,"isArrayLikeObject");var Ng=ft||mP;function Qa(re){if(!Lo(re))return!1;var pe=Ot(re);return pe==m||pe==g||pe==u||pe==b}h(Qa,"isFunction");function H_(re){return typeof re=="number"&&re>-1&&re%1==0&&re<=o}h(H_,"isLength");function Lo(re){var pe=typeof re;return re!=null&&(pe=="object"||pe=="function")}h(Lo,"isObject");function Rh(re){return re!=null&&typeof re=="object"}h(Rh,"isObjectLike");function cP(re){if(!Rh(re)||Ot(re)!=w)return!1;var pe=Ze(re);if(pe===null)return!0;var Ae=_e.call(pe,"constructor")&&pe.constructor;return typeof Ae=="function"&&Ae instanceof Ae&&W.call(Ae)==Be}h(cP,"isPlainObject");var pP=Q?Ie(Q):jr;function dP(re){return Ui(re,G_(re))}h(dP,"toPlainObject");var Yre=Io(function(re){return re.push(void 0,Hr),Me(Jre,void 0,re)});function G_(re){return xn(re)?at(re,!0):vn(re)}h(G_,"keysIn");var Jre=Pa(function(re,pe,Ae,gt){bi(re,pe,Ae,gt)});function fP(re){return function(){return re}}h(fP,"constant");function W_(re){return re}h(W_,"identity");function mP(){return!1}h(mP,"stubFalse"),e.exports=Yre}),zbe=tt((i,e)=>{R();var t=!1,r={},n=!1;typeof e<"u"&&e.exports?(e.exports=r,n=!0):typeof document<"u"?window.ClipperLib=r:self.ClipperLib=r;var a;n?(o="chrome",a="Netscape"):(o=navigator.userAgent.toString().toLowerCase(),a=navigator.appName);var o,s={};o.indexOf("chrome")!=-1&&o.indexOf("chromium")==-1?s.chrome=1:s.chrome=0,o.indexOf("chromium")!=-1?s.chromium=1:s.chromium=0,o.indexOf("safari")!=-1&&o.indexOf("chrome")==-1&&o.indexOf("chromium")==-1?s.safari=1:s.safari=0,o.indexOf("firefox")!=-1?s.firefox=1:s.firefox=0,o.indexOf("firefox/17")!=-1?s.firefox17=1:s.firefox17=0,o.indexOf("firefox/15")!=-1?s.firefox15=1:s.firefox15=0,o.indexOf("firefox/3")!=-1?s.firefox3=1:s.firefox3=0,o.indexOf("opera")!=-1?s.opera=1:s.opera=0,o.indexOf("msie 10")!=-1?s.msie10=1:s.msie10=0,o.indexOf("msie 9")!=-1?s.msie9=1:s.msie9=0,o.indexOf("msie 8")!=-1?s.msie8=1:s.msie8=0,o.indexOf("msie 7")!=-1?s.msie7=1:s.msie7=0,o.indexOf("msie ")!=-1?s.msie=1:s.msie=0,r.biginteger_used=null;var l;function u(f,v,S){r.biginteger_used=1,f!=null&&(typeof f=="number"&&typeof v>"u"?this.fromInt(f):typeof f=="number"?this.fromNumber(f,v,S):v==null&&typeof f!="string"?this.fromString(f,256):this.fromString(f,v))}h(u,"BigInteger");function c(){return new u(null)}h(c,"nbi");function p(f,v,S,I,F,H){for(;--H>=0;){var X=v*this[f++]+S[I]+F;F=Math.floor(X/67108864),S[I++]=X&67108863}return F}h(p,"am1");function d(f,v,S,I,F,H){for(var X=v&32767,se=v>>15;--H>=0;){var de=this[f]&32767,Ee=this[f++]>>15,je=se*de+Ee*X;de=X*de+((je&32767)<<15)+S[I]+(F&1073741823),F=(de>>>30)+(je>>>15)+se*Ee+(F>>>30),S[I++]=de&1073741823}return F}h(d,"am2");function m(f,v,S,I,F,H){for(var X=v&16383,se=v>>14;--H>=0;){var de=this[f]&16383,Ee=this[f++]>>14,je=se*de+Ee*X;de=X*de+((je&16383)<<14)+S[I]+F,F=(de>>28)+(je>>14)+se*Ee,S[I++]=de&268435455}return F}h(m,"am3"),a=="Microsoft Internet Explorer"?(u.prototype.am=d,l=30):a!="Netscape"?(u.prototype.am=p,l=26):(u.prototype.am=m,l=28),u.prototype.DB=l,u.prototype.DM=(1<<l)-1,u.prototype.DV=1<<l;var g=52;u.prototype.FV=Math.pow(2,g),u.prototype.F1=g-l,u.prototype.F2=2*l-g;var _="0123456789abcdefghijklmnopqrstuvwxyz",y=new Array,x,w;for(x=48,w=0;w<=9;++w)y[x++]=w;for(x=97,w=10;w<36;++w)y[x++]=w;for(x=65,w=10;w<36;++w)y[x++]=w;function b(f){return _.charAt(f)}h(b,"int2char");function C(f,v){var S=y[f.charCodeAt(v)];return S??-1}h(C,"intAt");function E(f){for(var v=this.t-1;v>=0;--v)f[v]=this[v];f.t=this.t,f.s=this.s}h(E,"bnpCopyTo");function T(f){this.t=1,this.s=f<0?-1:0,f>0?this[0]=f:f<-1?this[0]=f+this.DV:this.t=0}h(T,"bnpFromInt");function L(f){var v=c();return v.fromInt(f),v}h(L,"nbv");function D(f,v){var S;if(v==16)S=4;else if(v==8)S=3;else if(v==256)S=8;else if(v==2)S=1;else if(v==32)S=5;else if(v==4)S=2;else{this.fromRadix(f,v);return}this.t=0,this.s=0;for(var I=f.length,F=!1,H=0;--I>=0;){var X=S==8?f[I]&255:C(f,I);if(X<0){f.charAt(I)=="-"&&(F=!0);continue}F=!1,H==0?this[this.t++]=X:H+S>this.DB?(this[this.t-1]|=(X&(1<<this.DB-H)-1)<<H,this[this.t++]=X>>this.DB-H):this[this.t-1]|=X<<H,H+=S,H>=this.DB&&(H-=this.DB)}S==8&&f[0]&128&&(this.s=-1,H>0&&(this[this.t-1]|=(1<<this.DB-H)-1<<H)),this.clamp(),F&&u.ZERO.subTo(this,this)}h(D,"bnpFromString");function B(){for(var f=this.s&this.DM;this.t>0&&this[this.t-1]==f;)--this.t}h(B,"bnpClamp");function A(f){if(this.s<0)return"-"+this.negate().toString(f);var v;if(f==16)v=4;else if(f==8)v=3;else if(f==2)v=1;else if(f==32)v=5;else if(f==4)v=2;else return this.toRadix(f);var S=(1<<v)-1,I,F=!1,H="",X=this.t,se=this.DB-X*this.DB%v;if(X-- >0)for(se<this.DB&&(I=this[X]>>se)>0&&(F=!0,H=b(I));X>=0;)se<v?(I=(this[X]&(1<<se)-1)<<v-se,I|=this[--X]>>(se+=this.DB-v)):(I=this[X]>>(se-=v)&S,se<=0&&(se+=this.DB,--X)),I>0&&(F=!0),F&&(H+=b(I));return F?H:"0"}h(A,"bnToString");function k(){var f=c();return u.ZERO.subTo(this,f),f}h(k,"bnNegate");function $(){return this.s<0?this.negate():this}h($,"bnAbs");function z(f){var v=this.s-f.s;if(v!=0)return v;var S=this.t;if(v=S-f.t,v!=0)return this.s<0?-v:v;for(;--S>=0;)if((v=this[S]-f[S])!=0)return v;return 0}h(z,"bnCompareTo");function P(f){var v=1,S;return(S=f>>>16)!=0&&(f=S,v+=16),(S=f>>8)!=0&&(f=S,v+=8),(S=f>>4)!=0&&(f=S,v+=4),(S=f>>2)!=0&&(f=S,v+=2),(S=f>>1)!=0&&(f=S,v+=1),v}h(P,"nbits");function U(){return this.t<=0?0:this.DB*(this.t-1)+P(this[this.t-1]^this.s&this.DM)}h(U,"bnBitLength");function G(f,v){var S;for(S=this.t-1;S>=0;--S)v[S+f]=this[S];for(S=f-1;S>=0;--S)v[S]=0;v.t=this.t+f,v.s=this.s}h(G,"bnpDLShiftTo");function K(f,v){for(var S=f;S<this.t;++S)v[S-f]=this[S];v.t=Math.max(this.t-f,0),v.s=this.s}h(K,"bnpDRShiftTo");function O(f,v){var S=f%this.DB,I=this.DB-S,F=(1<<I)-1,H=Math.floor(f/this.DB),X=this.s<<S&this.DM,se;for(se=this.t-1;se>=0;--se)v[se+H+1]=this[se]>>I|X,X=(this[se]&F)<<S;for(se=H-1;se>=0;--se)v[se]=0;v[H]=X,v.t=this.t+H+1,v.s=this.s,v.clamp()}h(O,"bnpLShiftTo");function V(f,v){v.s=this.s;var S=Math.floor(f/this.DB);if(S>=this.t){v.t=0;return}var I=f%this.DB,F=this.DB-I,H=(1<<I)-1;v[0]=this[S]>>I;for(var X=S+1;X<this.t;++X)v[X-S-1]|=(this[X]&H)<<F,v[X-S]=this[X]>>I;I>0&&(v[this.t-S-1]|=(this.s&H)<<F),v.t=this.t-S,v.clamp()}h(V,"bnpRShiftTo");function j(f,v){for(var S=0,I=0,F=Math.min(f.t,this.t);S<F;)I+=this[S]-f[S],v[S++]=I&this.DM,I>>=this.DB;if(f.t<this.t){for(I-=f.s;S<this.t;)I+=this[S],v[S++]=I&this.DM,I>>=this.DB;I+=this.s}else{for(I+=this.s;S<f.t;)I-=f[S],v[S++]=I&this.DM,I>>=this.DB;I-=f.s}v.s=I<0?-1:0,I<-1?v[S++]=this.DV+I:I>0&&(v[S++]=I),v.t=S,v.clamp()}h(j,"bnpSubTo");function q(f,v){var S=this.abs(),I=f.abs(),F=S.t;for(v.t=F+I.t;--F>=0;)v[F]=0;for(F=0;F<I.t;++F)v[F+S.t]=S.am(0,I[F],v,F,0,S.t);v.s=0,v.clamp(),this.s!=f.s&&u.ZERO.subTo(v,v)}h(q,"bnpMultiplyTo");function ee(f){for(var v=this.abs(),S=f.t=2*v.t;--S>=0;)f[S]=0;for(S=0;S<v.t-1;++S){var I=v.am(S,v[S],f,2*S,0,1);(f[S+v.t]+=v.am(S+1,2*v[S],f,2*S+1,I,v.t-S-1))>=v.DV&&(f[S+v.t]-=v.DV,f[S+v.t+1]=1)}f.t>0&&(f[f.t-1]+=v.am(S,v[S],f,2*S,0,1)),f.s=0,f.clamp()}h(ee,"bnpSquareTo");function ae(f,v,S){var I=f.abs();if(!(I.t<=0)){var F=this.abs();if(F.t<I.t){v!=null&&v.fromInt(0),S!=null&&this.copyTo(S);return}S==null&&(S=c());var H=c(),X=this.s,se=f.s,de=this.DB-P(I[I.t-1]);de>0?(I.lShiftTo(de,H),F.lShiftTo(de,S)):(I.copyTo(H),F.copyTo(S));var Ee=H.t,je=H[Ee-1];if(je!=0){var Ke=je*(1<<this.F1)+(Ee>1?H[Ee-2]>>this.F2:0),mt=this.FV/Ke,Lt=(1<<this.F1)/Ke,Tt=1<<this.F2,qt=S.t,ki=qt-Ee,Fr=v??c();for(H.dlShiftTo(ki,Fr),S.compareTo(Fr)>=0&&(S[S.t++]=1,S.subTo(Fr,S)),u.ONE.dlShiftTo(Ee,Fr),Fr.subTo(H,H);H.t<Ee;)H[H.t++]=0;for(;--ki>=0;){var xn=S[--qt]==je?this.DM:Math.floor(S[qt]*mt+(S[qt-1]+Tt)*Lt);if((S[qt]+=H.am(0,xn,S,ki,0,Ee))<xn)for(H.dlShiftTo(ki,Fr),S.subTo(Fr,S);S[qt]<--xn;)S.subTo(Fr,S)}v!=null&&(S.drShiftTo(Ee,v),X!=se&&u.ZERO.subTo(v,v)),S.t=Ee,S.clamp(),de>0&&S.rShiftTo(de,S),X<0&&u.ZERO.subTo(S,S)}}}h(ae,"bnpDivRemTo");function N(f){var v=c();return this.abs().divRemTo(f,null,v),this.s<0&&v.compareTo(u.ZERO)>0&&f.subTo(v,v),v}h(N,"bnMod");function J(f){this.m=f}h(J,"Classic");function Y(f){return f.s<0||f.compareTo(this.m)>=0?f.mod(this.m):f}h(Y,"cConvert");function oe(f){return f}h(oe,"cRevert");function xe(f){f.divRemTo(this.m,null,f)}h(xe,"cReduce");function ge(f,v,S){f.multiplyTo(v,S),this.reduce(S)}h(ge,"cMulTo");function Te(f,v){f.squareTo(v),this.reduce(v)}h(Te,"cSqrTo"),J.prototype.convert=Y,J.prototype.revert=oe,J.prototype.reduce=xe,J.prototype.mulTo=ge,J.prototype.sqrTo=Te;function me(){if(this.t<1)return 0;var f=this[0];if(!(f&1))return 0;var v=f&3;return v=v*(2-(f&15)*v)&15,v=v*(2-(f&255)*v)&255,v=v*(2-((f&65535)*v&65535))&65535,v=v*(2-f*v%this.DV)%this.DV,v>0?this.DV-v:-v}h(me,"bnpInvDigit");function Q(f){this.m=f,this.mp=f.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<f.DB-15)-1,this.mt2=2*f.t}h(Q,"Montgomery");function Me(f){var v=c();return f.abs().dlShiftTo(this.m.t,v),v.divRemTo(this.m,null,v),f.s<0&&v.compareTo(u.ZERO)>0&&this.m.subTo(v,v),v}h(Me,"montConvert");function ve(f){var v=c();return f.copyTo(v),this.reduce(v),v}h(ve,"montRevert");function Ie(f){for(;f.t<=this.mt2;)f[f.t++]=0;for(var v=0;v<this.m.t;++v){var S=f[v]&32767,I=S*this.mpl+((S*this.mph+(f[v]>>15)*this.mpl&this.um)<<15)&f.DM;for(S=v+this.m.t,f[S]+=this.m.am(0,I,f,v,0,this.m.t);f[S]>=f.DV;)f[S]-=f.DV,f[++S]++}f.clamp(),f.drShiftTo(this.m.t,f),f.compareTo(this.m)>=0&&f.subTo(this.m,f)}h(Ie,"montReduce");function ke(f,v){f.squareTo(v),this.reduce(v)}h(ke,"montSqrTo");function we(f,v,S){f.multiplyTo(v,S),this.reduce(S)}h(we,"montMulTo"),Q.prototype.convert=Me,Q.prototype.revert=ve,Q.prototype.reduce=Ie,Q.prototype.mulTo=we,Q.prototype.sqrTo=ke;function Oe(){return(this.t>0?this[0]&1:this.s)==0}h(Oe,"bnpIsEven");function Je(f,v){if(f>4294967295||f<1)return u.ONE;var S=c(),I=c(),F=v.convert(this),H=P(f)-1;for(F.copyTo(S);--H>=0;)if(v.sqrTo(S,I),(f&1<<H)>0)v.mulTo(I,F,S);else{var X=S;S=I,I=X}return v.revert(S)}h(Je,"bnpExp");function xt(f,v){var S;return f<256||v.isEven()?S=new J(v):S=new Q(v),this.exp(f,S)}h(xt,"bnModPowInt"),u.prototype.copyTo=E,u.prototype.fromInt=T,u.prototype.fromString=D,u.prototype.clamp=B,u.prototype.dlShiftTo=G,u.prototype.drShiftTo=K,u.prototype.lShiftTo=O,u.prototype.rShiftTo=V,u.prototype.subTo=j,u.prototype.multiplyTo=q,u.prototype.squareTo=ee,u.prototype.divRemTo=ae,u.prototype.invDigit=me,u.prototype.isEven=Oe,u.prototype.exp=Je,u.prototype.toString=A,u.prototype.negate=k,u.prototype.abs=$,u.prototype.compareTo=z,u.prototype.bitLength=U,u.prototype.mod=N,u.prototype.modPowInt=xt,u.ZERO=L(0),u.ONE=L(1);function ne(){var f=c();return this.copyTo(f),f}h(ne,"bnClone");function W(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}h(W,"bnIntValue");function _e(){return this.t==0?this.s:this[0]<<24>>24}h(_e,"bnByteValue");function Fe(){return this.t==0?this.s:this[0]<<16>>16}h(Fe,"bnShortValue");function Ue(f){return Math.floor(Math.LN2*this.DB/Math.log(f))}h(Ue,"bnpChunkSize");function Be(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}h(Be,"bnSigNum");function bt(f){if(f==null&&(f=10),this.signum()==0||f<2||f>36)return"0";var v=this.chunkSize(f),S=Math.pow(f,v),I=L(S),F=c(),H=c(),X="";for(this.divRemTo(I,F,H);F.signum()>0;)X=(S+H.intValue()).toString(f).substr(1)+X,F.divRemTo(I,F,H);return H.intValue().toString(f)+X}h(bt,"bnpToRadix");function lt(f,v){this.fromInt(0),v==null&&(v=10);for(var S=this.chunkSize(v),I=Math.pow(v,S),F=!1,H=0,X=0,se=0;se<f.length;++se){var de=C(f,se);if(de<0){f.charAt(se)=="-"&&this.signum()==0&&(F=!0);continue}X=v*X+de,++H>=S&&(this.dMultiply(I),this.dAddOffset(X,0),H=0,X=0)}H>0&&(this.dMultiply(Math.pow(v,H)),this.dAddOffset(X,0)),F&&u.ZERO.subTo(this,this)}h(lt,"bnpFromRadix");function Ge(f,v,S){if(typeof v=="number")if(f<2)this.fromInt(1);else for(this.fromNumber(f,S),this.testBit(f-1)||this.bitwiseTo(u.ONE.shiftLeft(f-1),qe,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(v);)this.dAddOffset(2,0),this.bitLength()>f&&this.subTo(u.ONE.shiftLeft(f-1),this);else{var I=new Array,F=f&7;I.length=(f>>3)+1,v.nextBytes(I),F>0?I[0]&=(1<<F)-1:I[0]=0,this.fromString(I,256)}}h(Ge,"bnpFromNumber");function We(){var f=this.t,v=new Array;v[0]=this.s;var S=this.DB-f*this.DB%8,I,F=0;if(f-- >0)for(S<this.DB&&(I=this[f]>>S)!=(this.s&this.DM)>>S&&(v[F++]=I|this.s<<this.DB-S);f>=0;)S<8?(I=(this[f]&(1<<S)-1)<<8-S,I|=this[--f]>>(S+=this.DB-8)):(I=this[f]>>(S-=8)&255,S<=0&&(S+=this.DB,--f)),I&128&&(I|=-256),F==0&&(this.s&128)!=(I&128)&&++F,(F>0||I!=this.s)&&(v[F++]=I);return v}h(We,"bnToByteArray");function St(f){return this.compareTo(f)==0}h(St,"bnEquals");function Ze(f){return this.compareTo(f)<0?this:f}h(Ze,"bnMin");function ni(f){return this.compareTo(f)>0?this:f}h(ni,"bnMax");function Dt(f,v,S){var I,F,H=Math.min(f.t,this.t);for(I=0;I<H;++I)S[I]=v(this[I],f[I]);if(f.t<this.t){for(F=f.s&this.DM,I=H;I<this.t;++I)S[I]=v(this[I],F);S.t=this.t}else{for(F=this.s&this.DM,I=H;I<f.t;++I)S[I]=v(F,f[I]);S.t=f.t}S.s=v(this.s,f.s),S.clamp()}h(Dt,"bnpBitwiseTo");function ue(f,v){return f&v}h(ue,"op_and");function he(f){var v=c();return this.bitwiseTo(f,ue,v),v}h(he,"bnAnd");function qe(f,v){return f|v}h(qe,"op_or");function ft(f){var v=c();return this.bitwiseTo(f,qe,v),v}h(ft,"bnOr");function ct(f,v){return f^v}h(ct,"op_xor");function dt(f){var v=c();return this.bitwiseTo(f,ct,v),v}h(dt,"bnXor");function ce(f,v){return f&~v}h(ce,"op_andnot");function it(f){var v=c();return this.bitwiseTo(f,ce,v),v}h(it,"bnAndNot");function be(){for(var f=c(),v=0;v<this.t;++v)f[v]=this.DM&~this[v];return f.t=this.t,f.s=~this.s,f}h(be,"bnNot");function Xe(f){var v=c();return f<0?this.rShiftTo(-f,v):this.lShiftTo(f,v),v}h(Xe,"bnShiftLeft");function rt(f){var v=c();return f<0?this.lShiftTo(-f,v):this.rShiftTo(f,v),v}h(rt,"bnShiftRight");function Wt(f){if(f==0)return-1;var v=0;return f&65535||(f>>=16,v+=16),f&255||(f>>=8,v+=8),f&15||(f>>=4,v+=4),f&3||(f>>=2,v+=2),f&1||++v,v}h(Wt,"lbit");function Ut(){for(var f=0;f<this.t;++f)if(this[f]!=0)return f*this.DB+Wt(this[f]);return this.s<0?this.t*this.DB:-1}h(Ut,"bnGetLowestSetBit");function Ti(f){for(var v=0;f!=0;)f&=f-1,++v;return v}h(Ti,"cbit");function lr(){for(var f=0,v=this.s&this.DM,S=0;S<this.t;++S)f+=Ti(this[S]^v);return f}h(lr,"bnBitCount");function jt(f){var v=Math.floor(f/this.DB);return v>=this.t?this.s!=0:(this[v]&1<<f%this.DB)!=0}h(jt,"bnTestBit");function Pi(f,v){var S=u.ONE.shiftLeft(f);return this.bitwiseTo(S,v,S),S}h(Pi,"bnpChangeBit");function mr(f){return this.changeBit(f,qe)}h(mr,"bnSetBit");function kn(f){return this.changeBit(f,ce)}h(kn,"bnClearBit");function Ma(f){return this.changeBit(f,ct)}h(Ma,"bnFlipBit");function gn(f,v){for(var S=0,I=0,F=Math.min(f.t,this.t);S<F;)I+=this[S]+f[S],v[S++]=I&this.DM,I>>=this.DB;if(f.t<this.t){for(I+=f.s;S<this.t;)I+=this[S],v[S++]=I&this.DM,I>>=this.DB;I+=this.s}else{for(I+=this.s;S<f.t;)I+=f[S],v[S++]=I&this.DM,I>>=this.DB;I+=f.s}v.s=I<0?-1:0,I>0?v[S++]=I:I<-1&&(v[S++]=this.DV+I),v.t=S,v.clamp()}h(gn,"bnpAddTo");function Yr(f){var v=c();return this.addTo(f,v),v}h(Yr,"bnAdd");function Rn(f){var v=c();return this.subTo(f,v),v}h(Rn,"bnSubtract");function ra(f){var v=c();return this.multiplyTo(f,v),v}h(ra,"bnMultiply");function Ca(){var f=c();return this.squareTo(f),f}h(Ca,"bnSquare");function Ea(f){var v=c();return this.divRemTo(f,v,null),v}h(Ea,"bnDivide");function Ya(f){var v=c();return this.divRemTo(f,null,v),v}h(Ya,"bnRemainder");function yn(f){var v=c(),S=c();return this.divRemTo(f,v,S),new Array(v,S)}h(yn,"bnDivideAndRemainder");function te(f){this[this.t]=this.am(0,f-1,this,0,0,this.t),++this.t,this.clamp()}h(te,"bnpDMultiply");function ye(f,v){if(f!=0){for(;this.t<=v;)this[this.t++]=0;for(this[v]+=f;this[v]>=this.DV;)this[v]-=this.DV,++v>=this.t&&(this[this.t++]=0),++this[v]}}h(ye,"bnpDAddOffset");function Ce(){}h(Ce,"NullExp");function Pe(f){return f}h(Pe,"nNop");function Se(f,v,S){f.multiplyTo(v,S)}h(Se,"nMulTo");function at(f,v){f.squareTo(v)}h(at,"nSqrTo"),Ce.prototype.convert=Pe,Ce.prototype.revert=Pe,Ce.prototype.mulTo=Se,Ce.prototype.sqrTo=at;function wt(f){return this.exp(f,new Ce)}h(wt,"bnPow");function Pt(f,v,S){var I=Math.min(this.t+f.t,v);for(S.s=0,S.t=I;I>0;)S[--I]=0;var F;for(F=S.t-this.t;I<F;++I)S[I+this.t]=this.am(0,f[I],S,I,0,this.t);for(F=Math.min(f.t,v);I<F;++I)this.am(0,f[I],S,I,0,v-I);S.clamp()}h(Pt,"bnpMultiplyLowerTo");function It(f,v,S){--v;var I=S.t=this.t+f.t-v;for(S.s=0;--I>=0;)S[I]=0;for(I=Math.max(v-this.t,0);I<f.t;++I)S[this.t+I-v]=this.am(v-I,f[I],S,0,0,this.t+I-v);S.clamp(),S.drShiftTo(1,S)}h(It,"bnpMultiplyUpperTo");function Ft(f){this.r2=c(),this.q3=c(),u.ONE.dlShiftTo(2*f.t,this.r2),this.mu=this.r2.divide(f),this.m=f}h(Ft,"Barrett");function Ht(f){if(f.s<0||f.t>2*this.m.t)return f.mod(this.m);if(f.compareTo(this.m)<0)return f;var v=c();return f.copyTo(v),this.reduce(v),v}h(Ht,"barrettConvert");function Ot(f){return f}h(Ot,"barrettRevert");function Ji(f){for(f.drShiftTo(this.m.t-1,this.r2),f.t>this.m.t+1&&(f.t=this.m.t+1,f.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);f.compareTo(this.r2)<0;)f.dAddOffset(1,this.m.t+1);for(f.subTo(this.r2,f);f.compareTo(this.m)>=0;)f.subTo(this.m,f)}h(Ji,"barrettReduce");function Di(f,v){f.squareTo(v),this.reduce(v)}h(Di,"barrettSqrTo");function jr(f,v,S){f.multiplyTo(v,S),this.reduce(S)}h(jr,"barrettMulTo"),Ft.prototype.convert=Ht,Ft.prototype.revert=Ot,Ft.prototype.reduce=Ji,Ft.prototype.mulTo=jr,Ft.prototype.sqrTo=Di;function vn(f,v){var S=f.bitLength(),I,F=L(1),H;if(S<=0)return F;S<18?I=1:S<48?I=3:S<144?I=4:S<768?I=5:I=6,S<8?H=new J(v):v.isEven()?H=new Ft(v):H=new Q(v);var X=new Array,se=3,de=I-1,Ee=(1<<I)-1;if(X[1]=H.convert(this),I>1){var je=c();for(H.sqrTo(X[1],je);se<=Ee;)X[se]=c(),H.mulTo(je,X[se-2],X[se]),se+=2}var Ke=f.t-1,mt,Lt=!0,Tt=c(),qt;for(S=P(f[Ke])-1;Ke>=0;){for(S>=de?mt=f[Ke]>>S-de&Ee:(mt=(f[Ke]&(1<<S+1)-1)<<de-S,Ke>0&&(mt|=f[Ke-1]>>this.DB+S-de)),se=I;!(mt&1);)mt>>=1,--se;if((S-=se)<0&&(S+=this.DB,--Ke),Lt)X[mt].copyTo(F),Lt=!1;else{for(;se>1;)H.sqrTo(F,Tt),H.sqrTo(Tt,F),se-=2;se>0?H.sqrTo(F,Tt):(qt=F,F=Tt,Tt=qt),H.mulTo(Tt,X[mt],F)}for(;Ke>=0&&!(f[Ke]&1<<S);)H.sqrTo(F,Tt),qt=F,F=Tt,Tt=qt,--S<0&&(S=this.DB-1,--Ke)}return H.revert(F)}h(vn,"bnModPow");function bi(f){var v=this.s<0?this.negate():this.clone(),S=f.s<0?f.negate():f.clone();if(v.compareTo(S)<0){var I=v;v=S,S=I}var F=v.getLowestSetBit(),H=S.getLowestSetBit();if(H<0)return v;for(F<H&&(H=F),H>0&&(v.rShiftTo(H,v),S.rShiftTo(H,S));v.signum()>0;)(F=v.getLowestSetBit())>0&&v.rShiftTo(F,v),(F=S.getLowestSetBit())>0&&S.rShiftTo(F,S),v.compareTo(S)>=0?(v.subTo(S,v),v.rShiftTo(1,v)):(S.subTo(v,S),S.rShiftTo(1,S));return H>0&&S.lShiftTo(H,S),S}h(bi,"bnGCD");function Nt(f){if(f<=0)return 0;var v=this.DV%f,S=this.s<0?f-1:0;if(this.t>0)if(v==0)S=this[0]%f;else for(var I=this.t-1;I>=0;--I)S=(v*S+this[I])%f;return S}h(Nt,"bnpModInt");function Io(f){var v=f.isEven();if(this.isEven()&&v||f.signum()==0)return u.ZERO;for(var S=f.clone(),I=this.clone(),F=L(1),H=L(0),X=L(0),se=L(1);S.signum()!=0;){for(;S.isEven();)S.rShiftTo(1,S),v?((!F.isEven()||!H.isEven())&&(F.addTo(this,F),H.subTo(f,H)),F.rShiftTo(1,F)):H.isEven()||H.subTo(f,H),H.rShiftTo(1,H);for(;I.isEven();)I.rShiftTo(1,I),v?((!X.isEven()||!se.isEven())&&(X.addTo(this,X),se.subTo(f,se)),X.rShiftTo(1,X)):se.isEven()||se.subTo(f,se),se.rShiftTo(1,se);S.compareTo(I)>=0?(S.subTo(I,S),v&&F.subTo(X,F),H.subTo(se,H)):(I.subTo(S,I),v&&X.subTo(F,X),se.subTo(H,se))}if(I.compareTo(u.ONE)!=0)return u.ZERO;if(se.compareTo(f)>=0)return se.subtract(f);if(se.signum()<0)se.addTo(f,se);else return se;return se.signum()<0?se.add(f):se}h(Io,"bnModInverse");var gr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Ta=(1<<26)/gr[gr.length-1];function Gs(f){var v,S=this.abs();if(S.t==1&&S[0]<=gr[gr.length-1]){for(v=0;v<gr.length;++v)if(S[0]==gr[v])return!0;return!1}if(S.isEven())return!1;for(v=1;v<gr.length;){for(var I=gr[v],F=v+1;F<gr.length&&I<Ta;)I*=gr[F++];for(I=S.modInt(I);v<F;)if(I%gr[v++]==0)return!1}return S.millerRabin(f)}h(Gs,"bnIsProbablePrime");function Ja(f){var v=this.subtract(u.ONE),S=v.getLowestSetBit();if(S<=0)return!1;var I=v.shiftRight(S);f=f+1>>1,f>gr.length&&(f=gr.length);for(var F=c(),H=0;H<f;++H){F.fromInt(gr[Math.floor(Math.random()*gr.length)]);var X=F.modPow(I,this);if(X.compareTo(u.ONE)!=0&&X.compareTo(v)!=0){for(var se=1;se++<S&&X.compareTo(v)!=0;)if(X=X.modPowInt(2,this),X.compareTo(u.ONE)==0)return!1;if(X.compareTo(v)!=0)return!1}}return!0}h(Ja,"bnpMillerRabin"),u.prototype.chunkSize=Ue,u.prototype.toRadix=bt,u.prototype.fromRadix=lt,u.prototype.fromNumber=Ge,u.prototype.bitwiseTo=Dt,u.prototype.changeBit=Pi,u.prototype.addTo=gn,u.prototype.dMultiply=te,u.prototype.dAddOffset=ye,u.prototype.multiplyLowerTo=Pt,u.prototype.multiplyUpperTo=It,u.prototype.modInt=Nt,u.prototype.millerRabin=Ja,u.prototype.clone=ne,u.prototype.intValue=W,u.prototype.byteValue=_e,u.prototype.shortValue=Fe,u.prototype.signum=Be,u.prototype.toByteArray=We,u.prototype.equals=St,u.prototype.min=Ze,u.prototype.max=ni,u.prototype.and=he,u.prototype.or=ft,u.prototype.xor=dt,u.prototype.andNot=it,u.prototype.not=be,u.prototype.shiftLeft=Xe,u.prototype.shiftRight=rt,u.prototype.getLowestSetBit=Ut,u.prototype.bitCount=lr,u.prototype.testBit=jt,u.prototype.setBit=mr,u.prototype.clearBit=kn,u.prototype.flipBit=Ma,u.prototype.add=Yr,u.prototype.subtract=Rn,u.prototype.multiply=ra,u.prototype.divide=Ea,u.prototype.remainder=Ya,u.prototype.divideAndRemainder=yn,u.prototype.modPow=vn,u.prototype.modInverse=Io,u.prototype.pow=wt,u.prototype.gcd=bi,u.prototype.isProbablePrime=Gs,u.prototype.square=Ca;var Vt=u;Vt.prototype.IsNegative=function(){return this.compareTo(Vt.ZERO)==-1},Vt.op_Equality=function(f,v){return f.compareTo(v)==0},Vt.op_Inequality=function(f,v){return f.compareTo(v)!=0},Vt.op_GreaterThan=function(f,v){return f.compareTo(v)>0},Vt.op_LessThan=function(f,v){return f.compareTo(v)<0},Vt.op_Addition=function(f,v){return new Vt(f).add(new Vt(v))},Vt.op_Subtraction=function(f,v){return new Vt(f).subtract(new Vt(v))},Vt.Int128Mul=function(f,v){return new Vt(f).multiply(new Vt(v))},Vt.op_Division=function(f,v){return f.divide(v)},Vt.prototype.ToDouble=function(){return parseFloat(this.toString())},typeof Ui>"u"&&(Ui=h(function(f,v){var S;if(typeof Object.getOwnPropertyNames>"u"){for(S in v.prototype)(typeof f.prototype[S]>"u"||f.prototype[S]==Object.prototype[S])&&(f.prototype[S]=v.prototype[S]);for(S in v)typeof f[S]>"u"&&(f[S]=v[S]);f.$baseCtor=v}else{for(var I=Object.getOwnPropertyNames(v.prototype),F=0;F<I.length;F++)typeof Object.getOwnPropertyDescriptor(f.prototype,I[F])>"u"&&Object.defineProperty(f.prototype,I[F],Object.getOwnPropertyDescriptor(v.prototype,I[F]));for(S in v)typeof f[S]>"u"&&(f[S]=v[S]);f.$baseCtor=v}},"Inherit"));var Ui;r.Path=function(){return[]},r.Paths=function(){return[]},r.DoublePoint=function(){var f=arguments;this.X=0,this.Y=0,f.length==1?(this.X=f[0].X,this.Y=f[0].Y):f.length==2&&(this.X=f[0],this.Y=f[1])},r.DoublePoint0=function(){this.X=0,this.Y=0},r.DoublePoint1=function(f){this.X=f.X,this.Y=f.Y},r.DoublePoint2=function(f,v){this.X=f,this.Y=v},r.PolyNode=function(){this.m_Parent=null,this.m_polygon=new r.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},r.PolyNode.prototype.IsHoleNode=function(){for(var f=!0,v=this.m_Parent;v!==null;)f=!f,v=v.m_Parent;return f},r.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},r.PolyNode.prototype.Contour=function(){return this.m_polygon},r.PolyNode.prototype.AddChild=function(f){var v=this.m_Childs.length;this.m_Childs.push(f),f.m_Parent=this,f.m_Index=v},r.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},r.PolyNode.prototype.GetNextSiblingUp=function(){return this.m_Parent===null?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},r.PolyNode.prototype.Childs=function(){return this.m_Childs},r.PolyNode.prototype.Parent=function(){return this.m_Parent},r.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},r.PolyTree=function(){this.m_AllPolys=[],r.PolyNode.call(this)},r.PolyTree.prototype.Clear=function(){for(var f=0,v=this.m_AllPolys.length;f<v;f++)this.m_AllPolys[f]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},r.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},r.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},Ui(r.PolyTree,r.PolyNode),r.Math_Abs_Int64=r.Math_Abs_Int32=r.Math_Abs_Double=function(f){return Math.abs(f)},r.Math_Max_Int32_Int32=function(f,v){return Math.max(f,v)},s.msie||s.opera||s.safari?r.Cast_Int32=function(f){return f|0}:r.Cast_Int32=function(f){return~~f},s.chrome?r.Cast_Int64=function(f){return f<-2147483648||f>2147483647?f<0?Math.ceil(f):Math.floor(f):~~f}:s.firefox&&typeof Number.toInteger=="function"?r.Cast_Int64=function(f){return Number.toInteger(f)}:s.msie7||s.msie8?r.Cast_Int64=function(f){return parseInt(f,10)}:s.msie?r.Cast_Int64=function(f){return f<-2147483648||f>2147483647?f<0?Math.ceil(f):Math.floor(f):f|0}:r.Cast_Int64=function(f){return f<0?Math.ceil(f):Math.floor(f)},r.Clear=function(f){f.length=0},r.PI=3.141592653589793,r.PI2=2*3.141592653589793,r.IntPoint=function(){var f=arguments,v=f.length,S,I;if(this.X=0,this.Y=0,!t)if(v==2)this.X=f[0],this.Y=f[1];else if(v==1)if(f[0]instanceof r.DoublePoint){var S=f[0];this.X=r.Clipper.Round(S.X),this.Y=r.Clipper.Round(S.Y)}else{var I=f[0];this.X=I.X,this.Y=I.Y}else this.X=0,this.Y=0},r.IntPoint.op_Equality=function(f,v){return f.X==v.X&&f.Y==v.Y},r.IntPoint.op_Inequality=function(f,v){return f.X!=v.X||f.Y!=v.Y},r.IntPoint0=function(){this.X=0,this.Y=0},r.IntPoint1=function(f){this.X=f.X,this.Y=f.Y},r.IntPoint1dp=function(f){this.X=r.Clipper.Round(f.X),this.Y=r.Clipper.Round(f.Y)},r.IntPoint2=function(f,v){this.X=f,this.Y=v},r.IntRect=function(){var f=arguments,v=f.length;v==4?(this.left=f[0],this.top=f[1],this.right=f[2],this.bottom=f[3]):v==1?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},r.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},r.IntRect1=function(f){this.left=f.left,this.top=f.top,this.right=f.right,this.bottom=f.bottom},r.IntRect4=function(f,v,S,I){this.left=f,this.top=v,this.right=S,this.bottom=I},r.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},r.PolyType={ptSubject:0,ptClip:1},r.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},r.JoinType={jtSquare:0,jtRound:1,jtMiter:2},r.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},r.EdgeSide={esLeft:0,esRight:1},r.Direction={dRightToLeft:0,dLeftToRight:1},r.TEdge=function(){this.Bot=new r.IntPoint,this.Curr=new r.IntPoint,this.Top=new r.IntPoint,this.Delta=new r.IntPoint,this.Dx=0,this.PolyTyp=r.PolyType.ptSubject,this.Side=r.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},r.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new r.IntPoint},r.MyIntersectNodeSort=function(){},r.MyIntersectNodeSort.Compare=function(f,v){return v.Pt.Y-f.Pt.Y},r.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},r.Scanbeam=function(){this.Y=0,this.Next=null},r.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},r.OutPt=function(){this.Idx=0,this.Pt=new r.IntPoint,this.Next=null,this.Prev=null},r.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new r.IntPoint},r.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},r.ClipperBase.horizontal=-9007199254740992,r.ClipperBase.Skip=-2,r.ClipperBase.Unassigned=-1,r.ClipperBase.tolerance=1e-20,r.ClipperBase.loRange=47453132,r.ClipperBase.hiRange=0xfffffffffffff,r.ClipperBase.near_zero=function(f){return f>-r.ClipperBase.tolerance&&f<r.ClipperBase.tolerance},r.ClipperBase.IsHorizontal=function(f){return f.Delta.Y===0},r.ClipperBase.prototype.PointIsVertex=function(f,v){var S=v;do{if(r.IntPoint.op_Equality(S.Pt,f))return!0;S=S.Next}while(S!=v);return!1},r.ClipperBase.prototype.PointOnLineSegment=function(f,v,S,I){return I?f.X==v.X&&f.Y==v.Y||f.X==S.X&&f.Y==S.Y||f.X>v.X==f.X<S.X&&f.Y>v.Y==f.Y<S.Y&&Vt.op_Equality(Vt.Int128Mul(f.X-v.X,S.Y-v.Y),Vt.Int128Mul(S.X-v.X,f.Y-v.Y)):f.X==v.X&&f.Y==v.Y||f.X==S.X&&f.Y==S.Y||f.X>v.X==f.X<S.X&&f.Y>v.Y==f.Y<S.Y&&(f.X-v.X)*(S.Y-v.Y)==(S.X-v.X)*(f.Y-v.Y)},r.ClipperBase.prototype.PointOnPolygon=function(f,v,S){for(var I=v;;){if(this.PointOnLineSegment(f,I.Pt,I.Next.Pt,S))return!0;if(I=I.Next,I==v)break}return!1},r.ClipperBase.prototype.SlopesEqual=r.ClipperBase.SlopesEqual=function(){var f=arguments,v=f.length,S,I,F,H,X,se,de;return v==3?(S=f[0],I=f[1],de=f[2],de?Vt.op_Equality(Vt.Int128Mul(S.Delta.Y,I.Delta.X),Vt.Int128Mul(S.Delta.X,I.Delta.Y)):r.Cast_Int64(S.Delta.Y*I.Delta.X)==r.Cast_Int64(S.Delta.X*I.Delta.Y)):v==4?(F=f[0],H=f[1],X=f[2],de=f[3],de?Vt.op_Equality(Vt.Int128Mul(F.Y-H.Y,H.X-X.X),Vt.Int128Mul(F.X-H.X,H.Y-X.Y)):r.Cast_Int64((F.Y-H.Y)*(H.X-X.X))-r.Cast_Int64((F.X-H.X)*(H.Y-X.Y))===0):(F=f[0],H=f[1],X=f[2],se=f[3],de=f[4],de?Vt.op_Equality(Vt.Int128Mul(F.Y-H.Y,X.X-se.X),Vt.Int128Mul(F.X-H.X,X.Y-se.Y)):r.Cast_Int64((F.Y-H.Y)*(X.X-se.X))-r.Cast_Int64((F.X-H.X)*(X.Y-se.Y))===0)},r.ClipperBase.SlopesEqual3=function(f,v,S){return S?Vt.op_Equality(Vt.Int128Mul(f.Delta.Y,v.Delta.X),Vt.Int128Mul(f.Delta.X,v.Delta.Y)):r.Cast_Int64(f.Delta.Y*v.Delta.X)==r.Cast_Int64(f.Delta.X*v.Delta.Y)},r.ClipperBase.SlopesEqual4=function(f,v,S,I){return I?Vt.op_Equality(Vt.Int128Mul(f.Y-v.Y,v.X-S.X),Vt.Int128Mul(f.X-v.X,v.Y-S.Y)):r.Cast_Int64((f.Y-v.Y)*(v.X-S.X))-r.Cast_Int64((f.X-v.X)*(v.Y-S.Y))===0},r.ClipperBase.SlopesEqual5=function(f,v,S,I,F){return F?Vt.op_Equality(Vt.Int128Mul(f.Y-v.Y,S.X-I.X),Vt.Int128Mul(f.X-v.X,S.Y-I.Y)):r.Cast_Int64((f.Y-v.Y)*(S.X-I.X))-r.Cast_Int64((f.X-v.X)*(S.Y-I.Y))===0},r.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var f=0,v=this.m_edges.length;f<v;++f){for(var S=0,I=this.m_edges[f].length;S<I;++S)this.m_edges[f][S]=null;r.Clear(this.m_edges[f])}r.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},r.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;this.m_MinimaList!==null;){var f=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=f}this.m_CurrentLM=null},r.ClipperBase.prototype.RangeTest=function(f,v){v.Value?(f.X>r.ClipperBase.hiRange||f.Y>r.ClipperBase.hiRange||-f.X>r.ClipperBase.hiRange||-f.Y>r.ClipperBase.hiRange)&&r.Error("Coordinate outside allowed range in RangeTest()."):(f.X>r.ClipperBase.loRange||f.Y>r.ClipperBase.loRange||-f.X>r.ClipperBase.loRange||-f.Y>r.ClipperBase.loRange)&&(v.Value=!0,this.RangeTest(f,v))},r.ClipperBase.prototype.InitEdge=function(f,v,S,I){f.Next=v,f.Prev=S,f.Curr.X=I.X,f.Curr.Y=I.Y,f.OutIdx=-1},r.ClipperBase.prototype.InitEdge2=function(f,v){f.Curr.Y>=f.Next.Curr.Y?(f.Bot.X=f.Curr.X,f.Bot.Y=f.Curr.Y,f.Top.X=f.Next.Curr.X,f.Top.Y=f.Next.Curr.Y):(f.Top.X=f.Curr.X,f.Top.Y=f.Curr.Y,f.Bot.X=f.Next.Curr.X,f.Bot.Y=f.Next.Curr.Y),this.SetDx(f),f.PolyTyp=v},r.ClipperBase.prototype.FindNextLocMin=function(f){for(var v;;){for(;r.IntPoint.op_Inequality(f.Bot,f.Prev.Bot)||r.IntPoint.op_Equality(f.Curr,f.Top);)f=f.Next;if(f.Dx!=r.ClipperBase.horizontal&&f.Prev.Dx!=r.ClipperBase.horizontal)break;for(;f.Prev.Dx==r.ClipperBase.horizontal;)f=f.Prev;for(v=f;f.Dx==r.ClipperBase.horizontal;)f=f.Next;if(f.Top.Y!=f.Prev.Bot.Y){v.Prev.Bot.X<f.Bot.X&&(f=v);break}}return f},r.ClipperBase.prototype.ProcessBound=function(f,v){var S=f,I=f,F,H;if(f.Dx==r.ClipperBase.horizontal&&(v?H=f.Prev.Bot.X:H=f.Next.Bot.X,f.Bot.X!=H&&this.ReverseHorizontal(f)),I.OutIdx!=r.ClipperBase.Skip)if(v){for(;I.Top.Y==I.Next.Bot.Y&&I.Next.OutIdx!=r.ClipperBase.Skip;)I=I.Next;if(I.Dx==r.ClipperBase.horizontal&&I.Next.OutIdx!=r.ClipperBase.Skip){for(F=I;F.Prev.Dx==r.ClipperBase.horizontal;)F=F.Prev;F.Prev.Top.X==I.Next.Top.X?v||(I=F.Prev):F.Prev.Top.X>I.Next.Top.X&&(I=F.Prev)}for(;f!=I;)f.NextInLML=f.Next,f.Dx==r.ClipperBase.horizontal&&f!=S&&f.Bot.X!=f.Prev.Top.X&&this.ReverseHorizontal(f),f=f.Next;f.Dx==r.ClipperBase.horizontal&&f!=S&&f.Bot.X!=f.Prev.Top.X&&this.ReverseHorizontal(f),I=I.Next}else{for(;I.Top.Y==I.Prev.Bot.Y&&I.Prev.OutIdx!=r.ClipperBase.Skip;)I=I.Prev;if(I.Dx==r.ClipperBase.horizontal&&I.Prev.OutIdx!=r.ClipperBase.Skip){for(F=I;F.Next.Dx==r.ClipperBase.horizontal;)F=F.Next;F.Next.Top.X==I.Prev.Top.X?v||(I=F.Next):F.Next.Top.X>I.Prev.Top.X&&(I=F.Next)}for(;f!=I;)f.NextInLML=f.Prev,f.Dx==r.ClipperBase.horizontal&&f!=S&&f.Bot.X!=f.Next.Top.X&&this.ReverseHorizontal(f),f=f.Prev;f.Dx==r.ClipperBase.horizontal&&f!=S&&f.Bot.X!=f.Next.Top.X&&this.ReverseHorizontal(f),I=I.Prev}if(I.OutIdx==r.ClipperBase.Skip){if(f=I,v){for(;f.Top.Y==f.Next.Bot.Y;)f=f.Next;for(;f!=I&&f.Dx==r.ClipperBase.horizontal;)f=f.Prev}else{for(;f.Top.Y==f.Prev.Bot.Y;)f=f.Prev;for(;f!=I&&f.Dx==r.ClipperBase.horizontal;)f=f.Next}if(f==I)v?I=f.Next:I=f.Prev;else{v?f=I.Next:f=I.Prev;var X=new r.LocalMinima;X.Next=null,X.Y=f.Bot.Y,X.LeftBound=null,X.RightBound=f,X.RightBound.WindDelta=0,I=this.ProcessBound(X.RightBound,v),this.InsertLocalMinima(X)}}return I},r.ClipperBase.prototype.AddPath=function(f,v,S){!S&&v==r.PolyType.ptClip&&r.Error("AddPath: Open paths must be subject.");var I=f.length-1;if(S)for(;I>0&&r.IntPoint.op_Equality(f[I],f[0]);)--I;for(;I>0&&r.IntPoint.op_Equality(f[I],f[I-1]);)--I;if(S&&I<2||!S&&I<1)return!1;for(var F=new Array,H=0;H<=I;H++)F.push(new r.TEdge);var X=!0;F[1].Curr.X=f[1].X,F[1].Curr.Y=f[1].Y;var se={Value:this.m_UseFullRange};this.RangeTest(f[0],se),this.m_UseFullRange=se.Value,se.Value=this.m_UseFullRange,this.RangeTest(f[I],se),this.m_UseFullRange=se.Value,this.InitEdge(F[0],F[1],F[I],f[0]),this.InitEdge(F[I],F[0],F[I-1],f[I]);for(var H=I-1;H>=1;--H)se.Value=this.m_UseFullRange,this.RangeTest(f[H],se),this.m_UseFullRange=se.Value,this.InitEdge(F[H],F[H+1],F[H-1],f[H]);for(var de=F[0],Ee=de,je=de;;){if(r.IntPoint.op_Equality(Ee.Curr,Ee.Next.Curr)){if(Ee==Ee.Next)break;Ee==de&&(de=Ee.Next),Ee=this.RemoveEdge(Ee),je=Ee;continue}if(Ee.Prev==Ee.Next)break;if(S&&r.ClipperBase.SlopesEqual(Ee.Prev.Curr,Ee.Curr,Ee.Next.Curr,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(Ee.Prev.Curr,Ee.Curr,Ee.Next.Curr))){Ee==de&&(de=Ee.Next),Ee=this.RemoveEdge(Ee),Ee=Ee.Prev,je=Ee;continue}if(Ee=Ee.Next,Ee==je)break}if(!S&&Ee==Ee.Next||S&&Ee.Prev==Ee.Next)return!1;S||(this.m_HasOpenPaths=!0,de.Prev.OutIdx=r.ClipperBase.Skip),Ee=de;do this.InitEdge2(Ee,v),Ee=Ee.Next,X&&Ee.Curr.Y!=de.Curr.Y&&(X=!1);while(Ee!=de);if(X){if(S)return!1;Ee.Prev.OutIdx=r.ClipperBase.Skip,Ee.Prev.Bot.X<Ee.Prev.Top.X&&this.ReverseHorizontal(Ee.Prev);var Ke=new r.LocalMinima;for(Ke.Next=null,Ke.Y=Ee.Bot.Y,Ke.LeftBound=null,Ke.RightBound=Ee,Ke.RightBound.Side=r.EdgeSide.esRight,Ke.RightBound.WindDelta=0;Ee.Next.OutIdx!=r.ClipperBase.Skip;)Ee.NextInLML=Ee.Next,Ee.Bot.X!=Ee.Prev.Top.X&&this.ReverseHorizontal(Ee),Ee=Ee.Next;return this.InsertLocalMinima(Ke),this.m_edges.push(F),!0}this.m_edges.push(F);for(var mt,Lt=null;Ee=this.FindNextLocMin(Ee),Ee!=Lt;){Lt==null&&(Lt=Ee);var Ke=new r.LocalMinima;Ke.Next=null,Ke.Y=Ee.Bot.Y,Ee.Dx<Ee.Prev.Dx?(Ke.LeftBound=Ee.Prev,Ke.RightBound=Ee,mt=!1):(Ke.LeftBound=Ee,Ke.RightBound=Ee.Prev,mt=!0),Ke.LeftBound.Side=r.EdgeSide.esLeft,Ke.RightBound.Side=r.EdgeSide.esRight,S?Ke.LeftBound.Next==Ke.RightBound?Ke.LeftBound.WindDelta=-1:Ke.LeftBound.WindDelta=1:Ke.LeftBound.WindDelta=0,Ke.RightBound.WindDelta=-Ke.LeftBound.WindDelta,Ee=this.ProcessBound(Ke.LeftBound,mt);var Tt=this.ProcessBound(Ke.RightBound,!mt);Ke.LeftBound.OutIdx==r.ClipperBase.Skip?Ke.LeftBound=null:Ke.RightBound.OutIdx==r.ClipperBase.Skip&&(Ke.RightBound=null),this.InsertLocalMinima(Ke),mt||(Ee=Tt)}return!0},r.ClipperBase.prototype.AddPaths=function(f,v,S){for(var I=!1,F=0,H=f.length;F<H;++F)this.AddPath(f[F],v,S)&&(I=!0);return I},r.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(f,v,S){return r.IntPoint.op_Equality(f,S)||r.IntPoint.op_Equality(f,v)||r.IntPoint.op_Equality(S,v)?!1:f.X!=S.X?v.X>f.X==v.X<S.X:v.Y>f.Y==v.Y<S.Y},r.ClipperBase.prototype.RemoveEdge=function(f){f.Prev.Next=f.Next,f.Next.Prev=f.Prev;var v=f.Next;return f.Prev=null,v},r.ClipperBase.prototype.SetDx=function(f){f.Delta.X=f.Top.X-f.Bot.X,f.Delta.Y=f.Top.Y-f.Bot.Y,f.Delta.Y===0?f.Dx=r.ClipperBase.horizontal:f.Dx=f.Delta.X/f.Delta.Y},r.ClipperBase.prototype.InsertLocalMinima=function(f){if(this.m_MinimaList===null)this.m_MinimaList=f;else if(f.Y>=this.m_MinimaList.Y)f.Next=this.m_MinimaList,this.m_MinimaList=f;else{for(var v=this.m_MinimaList;v.Next!==null&&f.Y<v.Next.Y;)v=v.Next;f.Next=v.Next,v.Next=f}},r.ClipperBase.prototype.PopLocalMinima=function(){this.m_CurrentLM!==null&&(this.m_CurrentLM=this.m_CurrentLM.Next)},r.ClipperBase.prototype.ReverseHorizontal=function(f){var v=f.Top.X;f.Top.X=f.Bot.X,f.Bot.X=v},r.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,this.m_CurrentLM!=null)for(var f=this.m_MinimaList;f!=null;){var v=f.LeftBound;v!=null&&(v.Curr.X=v.Bot.X,v.Curr.Y=v.Bot.Y,v.Side=r.EdgeSide.esLeft,v.OutIdx=r.ClipperBase.Unassigned),v=f.RightBound,v!=null&&(v.Curr.X=v.Bot.X,v.Curr.Y=v.Bot.Y,v.Side=r.EdgeSide.esRight,v.OutIdx=r.ClipperBase.Unassigned),f=f.Next}},r.Clipper=function(f){typeof f>"u"&&(f=0),this.m_PolyOuts=null,this.m_ClipType=r.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=r.PolyFillType.pftEvenOdd,this.m_SubjFillType=r.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,r.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=r.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=(1&f)!==0,this.StrictlySimple=(2&f)!==0,this.PreserveCollinear=(4&f)!==0},r.Clipper.ioReverseSolution=1,r.Clipper.ioStrictlySimple=2,r.Clipper.ioPreserveCollinear=4,r.Clipper.prototype.Clear=function(){this.m_edges.length!==0&&(this.DisposeAllPolyPts(),r.ClipperBase.prototype.Clear.call(this))},r.Clipper.prototype.DisposeScanbeamList=function(){for(;this.m_Scanbeam!==null;){var f=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=f}},r.Clipper.prototype.Reset=function(){r.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var f=this.m_MinimaList;f!==null;)this.InsertScanbeam(f.Y),f=f.Next},r.Clipper.prototype.InsertScanbeam=function(f){if(this.m_Scanbeam===null)this.m_Scanbeam=new r.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=f;else if(f>this.m_Scanbeam.Y){var v=new r.Scanbeam;v.Y=f,v.Next=this.m_Scanbeam,this.m_Scanbeam=v}else{for(var S=this.m_Scanbeam;S.Next!==null&&f<=S.Next.Y;)S=S.Next;if(f==S.Y)return;var v=new r.Scanbeam;v.Y=f,v.Next=S.Next,S.Next=v}},r.Clipper.prototype.Execute=function(){var f=arguments,v=f.length,S=f[1]instanceof r.PolyTree;if(v==4&&!S){var I=f[0],F=f[1],H=f[2],X=f[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&r.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,r.Clear(F),this.m_SubjFillType=H,this.m_ClipFillType=X,this.m_ClipType=I,this.m_UsingPolyTree=!1;try{var se=this.ExecuteInternal();se&&this.BuildResult(F)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return se}else if(v==4&&S){var I=f[0],de=f[1],H=f[2],X=f[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=H,this.m_ClipFillType=X,this.m_ClipType=I,this.m_UsingPolyTree=!0;try{var se=this.ExecuteInternal();se&&this.BuildResult2(de)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return se}else if(v==2&&!S){var I=f[0],F=f[1];return this.Execute(I,F,r.PolyFillType.pftEvenOdd,r.PolyFillType.pftEvenOdd)}else if(v==2&&S){var I=f[0],de=f[1];return this.Execute(I,de,r.PolyFillType.pftEvenOdd,r.PolyFillType.pftEvenOdd)}},r.Clipper.prototype.FixHoleLinkage=function(f){if(!(f.FirstLeft===null||f.IsHole!=f.FirstLeft.IsHole&&f.FirstLeft.Pts!==null)){for(var v=f.FirstLeft;v!==null&&(v.IsHole==f.IsHole||v.Pts===null);)v=v.FirstLeft;f.FirstLeft=v}},r.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),this.m_CurrentLM===null)return!1;var f=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(f),r.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),this.m_Scanbeam===null)break;var v=this.PopScanbeam();if(!this.ProcessIntersections(f,v))return!1;this.ProcessEdgesAtTopOfScanbeam(v),f=v}while(this.m_Scanbeam!==null||this.m_CurrentLM!==null);for(var S=0,I=this.m_PolyOuts.length;S<I;S++){var F=this.m_PolyOuts[S];F.Pts===null||F.IsOpen||(F.IsHole^this.ReverseSolution)==this.Area(F)>0&&this.ReversePolyPtLinks(F.Pts)}this.JoinCommonEdges();for(var S=0,I=this.m_PolyOuts.length;S<I;S++){var F=this.m_PolyOuts[S];F.Pts!==null&&!F.IsOpen&&this.FixupOutPolygon(F)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{r.Clear(this.m_Joins),r.Clear(this.m_GhostJoins)}},r.Clipper.prototype.PopScanbeam=function(){var f=this.m_Scanbeam.Y;return this.m_Scanbeam,this.m_Scanbeam=this.m_Scanbeam.Next,f},r.Clipper.prototype.DisposeAllPolyPts=function(){for(var f=0,v=this.m_PolyOuts.length;f<v;++f)this.DisposeOutRec(f);r.Clear(this.m_PolyOuts)},r.Clipper.prototype.DisposeOutRec=function(f){var v=this.m_PolyOuts[f];v.Pts!==null&&this.DisposeOutPts(v.Pts),v=null,this.m_PolyOuts[f]=null},r.Clipper.prototype.DisposeOutPts=function(f){if(f!==null)for(f.Prev.Next=null;f!==null;)f=f.Next},r.Clipper.prototype.AddJoin=function(f,v,S){var I=new r.Join;I.OutPt1=f,I.OutPt2=v,I.OffPt.X=S.X,I.OffPt.Y=S.Y,this.m_Joins.push(I)},r.Clipper.prototype.AddGhostJoin=function(f,v){var S=new r.Join;S.OutPt1=f,S.OffPt.X=v.X,S.OffPt.Y=v.Y,this.m_GhostJoins.push(S)},r.Clipper.prototype.InsertLocalMinimaIntoAEL=function(f){for(;this.m_CurrentLM!==null&&this.m_CurrentLM.Y==f;){var v=this.m_CurrentLM.LeftBound,S=this.m_CurrentLM.RightBound;this.PopLocalMinima();var I=null;if(v===null?(this.InsertEdgeIntoAEL(S,null),this.SetWindingCount(S),this.IsContributing(S)&&(I=this.AddOutPt(S,S.Bot))):S==null?(this.InsertEdgeIntoAEL(v,null),this.SetWindingCount(v),this.IsContributing(v)&&(I=this.AddOutPt(v,v.Bot)),this.InsertScanbeam(v.Top.Y)):(this.InsertEdgeIntoAEL(v,null),this.InsertEdgeIntoAEL(S,v),this.SetWindingCount(v),S.WindCnt=v.WindCnt,S.WindCnt2=v.WindCnt2,this.IsContributing(v)&&(I=this.AddLocalMinPoly(v,S,v.Bot)),this.InsertScanbeam(v.Top.Y)),S!=null&&(r.ClipperBase.IsHorizontal(S)?this.AddEdgeToSEL(S):this.InsertScanbeam(S.Top.Y)),!(v==null||S==null)){if(I!==null&&r.ClipperBase.IsHorizontal(S)&&this.m_GhostJoins.length>0&&S.WindDelta!==0)for(var F=0,H=this.m_GhostJoins.length;F<H;F++){var X=this.m_GhostJoins[F];this.HorzSegmentsOverlap(X.OutPt1.Pt,X.OffPt,S.Bot,S.Top)&&this.AddJoin(X.OutPt1,I,X.OffPt)}if(v.OutIdx>=0&&v.PrevInAEL!==null&&v.PrevInAEL.Curr.X==v.Bot.X&&v.PrevInAEL.OutIdx>=0&&r.ClipperBase.SlopesEqual(v.PrevInAEL,v,this.m_UseFullRange)&&v.WindDelta!==0&&v.PrevInAEL.WindDelta!==0){var se=this.AddOutPt(v.PrevInAEL,v.Bot);this.AddJoin(I,se,v.Top)}if(v.NextInAEL!=S){if(S.OutIdx>=0&&S.PrevInAEL.OutIdx>=0&&r.ClipperBase.SlopesEqual(S.PrevInAEL,S,this.m_UseFullRange)&&S.WindDelta!==0&&S.PrevInAEL.WindDelta!==0){var se=this.AddOutPt(S.PrevInAEL,S.Bot);this.AddJoin(I,se,S.Top)}var de=v.NextInAEL;if(de!==null)for(;de!=S;)this.IntersectEdges(S,de,v.Curr,!1),de=de.NextInAEL}}}},r.Clipper.prototype.InsertEdgeIntoAEL=function(f,v){if(this.m_ActiveEdges===null)f.PrevInAEL=null,f.NextInAEL=null,this.m_ActiveEdges=f;else if(v===null&&this.E2InsertsBeforeE1(this.m_ActiveEdges,f))f.PrevInAEL=null,f.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=f,this.m_ActiveEdges=f;else{for(v===null&&(v=this.m_ActiveEdges);v.NextInAEL!==null&&!this.E2InsertsBeforeE1(v.NextInAEL,f);)v=v.NextInAEL;f.NextInAEL=v.NextInAEL,v.NextInAEL!==null&&(v.NextInAEL.PrevInAEL=f),f.PrevInAEL=v,v.NextInAEL=f}},r.Clipper.prototype.E2InsertsBeforeE1=function(f,v){return v.Curr.X==f.Curr.X?v.Top.Y>f.Top.Y?v.Top.X<r.Clipper.TopX(f,v.Top.Y):f.Top.X>r.Clipper.TopX(v,f.Top.Y):v.Curr.X<f.Curr.X},r.Clipper.prototype.IsEvenOddFillType=function(f){return f.PolyTyp==r.PolyType.ptSubject?this.m_SubjFillType==r.PolyFillType.pftEvenOdd:this.m_ClipFillType==r.PolyFillType.pftEvenOdd},r.Clipper.prototype.IsEvenOddAltFillType=function(f){return f.PolyTyp==r.PolyType.ptSubject?this.m_ClipFillType==r.PolyFillType.pftEvenOdd:this.m_SubjFillType==r.PolyFillType.pftEvenOdd},r.Clipper.prototype.IsContributing=function(f){var v,S;switch(f.PolyTyp==r.PolyType.ptSubject?(v=this.m_SubjFillType,S=this.m_ClipFillType):(v=this.m_ClipFillType,S=this.m_SubjFillType),v){case r.PolyFillType.pftEvenOdd:if(f.WindDelta===0&&f.WindCnt!=1)return!1;break;case r.PolyFillType.pftNonZero:if(Math.abs(f.WindCnt)!=1)return!1;break;case r.PolyFillType.pftPositive:if(f.WindCnt!=1)return!1;break;default:if(f.WindCnt!=-1)return!1;break}switch(this.m_ClipType){case r.ClipType.ctIntersection:switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2!==0;case r.PolyFillType.pftPositive:return f.WindCnt2>0;default:return f.WindCnt2<0}case r.ClipType.ctUnion:switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2===0;case r.PolyFillType.pftPositive:return f.WindCnt2<=0;default:return f.WindCnt2>=0}case r.ClipType.ctDifference:if(f.PolyTyp==r.PolyType.ptSubject)switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2===0;case r.PolyFillType.pftPositive:return f.WindCnt2<=0;default:return f.WindCnt2>=0}else switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2!==0;case r.PolyFillType.pftPositive:return f.WindCnt2>0;default:return f.WindCnt2<0}case r.ClipType.ctXor:if(f.WindDelta===0)switch(S){case r.PolyFillType.pftEvenOdd:case r.PolyFillType.pftNonZero:return f.WindCnt2===0;case r.PolyFillType.pftPositive:return f.WindCnt2<=0;default:return f.WindCnt2>=0}else return!0}return!0},r.Clipper.prototype.SetWindingCount=function(f){for(var v=f.PrevInAEL;v!==null&&(v.PolyTyp!=f.PolyTyp||v.WindDelta===0);)v=v.PrevInAEL;if(v===null)f.WindCnt=f.WindDelta===0?1:f.WindDelta,f.WindCnt2=0,v=this.m_ActiveEdges;else if(f.WindDelta===0&&this.m_ClipType!=r.ClipType.ctUnion)f.WindCnt=1,f.WindCnt2=v.WindCnt2,v=v.NextInAEL;else if(this.IsEvenOddFillType(f)){if(f.WindDelta===0){for(var S=!0,I=v.PrevInAEL;I!==null;)I.PolyTyp==v.PolyTyp&&I.WindDelta!==0&&(S=!S),I=I.PrevInAEL;f.WindCnt=S?0:1}else f.WindCnt=f.WindDelta;f.WindCnt2=v.WindCnt2,v=v.NextInAEL}else v.WindCnt*v.WindDelta<0?Math.abs(v.WindCnt)>1?v.WindDelta*f.WindDelta<0?f.WindCnt=v.WindCnt:f.WindCnt=v.WindCnt+f.WindDelta:f.WindCnt=f.WindDelta===0?1:f.WindDelta:f.WindDelta===0?f.WindCnt=v.WindCnt<0?v.WindCnt-1:v.WindCnt+1:v.WindDelta*f.WindDelta<0?f.WindCnt=v.WindCnt:f.WindCnt=v.WindCnt+f.WindDelta,f.WindCnt2=v.WindCnt2,v=v.NextInAEL;if(this.IsEvenOddAltFillType(f))for(;v!=f;)v.WindDelta!==0&&(f.WindCnt2=f.WindCnt2===0?1:0),v=v.NextInAEL;else for(;v!=f;)f.WindCnt2+=v.WindDelta,v=v.NextInAEL},r.Clipper.prototype.AddEdgeToSEL=function(f){this.m_SortedEdges===null?(this.m_SortedEdges=f,f.PrevInSEL=null,f.NextInSEL=null):(f.NextInSEL=this.m_SortedEdges,f.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=f,this.m_SortedEdges=f)},r.Clipper.prototype.CopyAELToSEL=function(){var f=this.m_ActiveEdges;for(this.m_SortedEdges=f;f!==null;)f.PrevInSEL=f.PrevInAEL,f.NextInSEL=f.NextInAEL,f=f.NextInAEL},r.Clipper.prototype.SwapPositionsInAEL=function(f,v){if(!(f.NextInAEL==f.PrevInAEL||v.NextInAEL==v.PrevInAEL)){if(f.NextInAEL==v){var S=v.NextInAEL;S!==null&&(S.PrevInAEL=f);var I=f.PrevInAEL;I!==null&&(I.NextInAEL=v),v.PrevInAEL=I,v.NextInAEL=f,f.PrevInAEL=v,f.NextInAEL=S}else if(v.NextInAEL==f){var S=f.NextInAEL;S!==null&&(S.PrevInAEL=v);var I=v.PrevInAEL;I!==null&&(I.NextInAEL=f),f.PrevInAEL=I,f.NextInAEL=v,v.PrevInAEL=f,v.NextInAEL=S}else{var S=f.NextInAEL,I=f.PrevInAEL;f.NextInAEL=v.NextInAEL,f.NextInAEL!==null&&(f.NextInAEL.PrevInAEL=f),f.PrevInAEL=v.PrevInAEL,f.PrevInAEL!==null&&(f.PrevInAEL.NextInAEL=f),v.NextInAEL=S,v.NextInAEL!==null&&(v.NextInAEL.PrevInAEL=v),v.PrevInAEL=I,v.PrevInAEL!==null&&(v.PrevInAEL.NextInAEL=v)}f.PrevInAEL===null?this.m_ActiveEdges=f:v.PrevInAEL===null&&(this.m_ActiveEdges=v)}},r.Clipper.prototype.SwapPositionsInSEL=function(f,v){if(!(f.NextInSEL===null&&f.PrevInSEL===null)&&!(v.NextInSEL===null&&v.PrevInSEL===null)){if(f.NextInSEL==v){var S=v.NextInSEL;S!==null&&(S.PrevInSEL=f);var I=f.PrevInSEL;I!==null&&(I.NextInSEL=v),v.PrevInSEL=I,v.NextInSEL=f,f.PrevInSEL=v,f.NextInSEL=S}else if(v.NextInSEL==f){var S=f.NextInSEL;S!==null&&(S.PrevInSEL=v);var I=v.PrevInSEL;I!==null&&(I.NextInSEL=f),f.PrevInSEL=I,f.NextInSEL=v,v.PrevInSEL=f,v.NextInSEL=S}else{var S=f.NextInSEL,I=f.PrevInSEL;f.NextInSEL=v.NextInSEL,f.NextInSEL!==null&&(f.NextInSEL.PrevInSEL=f),f.PrevInSEL=v.PrevInSEL,f.PrevInSEL!==null&&(f.PrevInSEL.NextInSEL=f),v.NextInSEL=S,v.NextInSEL!==null&&(v.NextInSEL.PrevInSEL=v),v.PrevInSEL=I,v.PrevInSEL!==null&&(v.PrevInSEL.NextInSEL=v)}f.PrevInSEL===null?this.m_SortedEdges=f:v.PrevInSEL===null&&(this.m_SortedEdges=v)}},r.Clipper.prototype.AddLocalMaxPoly=function(f,v,S){this.AddOutPt(f,S),v.WindDelta==0&&this.AddOutPt(v,S),f.OutIdx==v.OutIdx?(f.OutIdx=-1,v.OutIdx=-1):f.OutIdx<v.OutIdx?this.AppendPolygon(f,v):this.AppendPolygon(v,f)},r.Clipper.prototype.AddLocalMinPoly=function(f,v,S){var I,F,H;if(r.ClipperBase.IsHorizontal(v)||f.Dx>v.Dx?(I=this.AddOutPt(f,S),v.OutIdx=f.OutIdx,f.Side=r.EdgeSide.esLeft,v.Side=r.EdgeSide.esRight,F=f,F.PrevInAEL==v?H=v.PrevInAEL:H=F.PrevInAEL):(I=this.AddOutPt(v,S),f.OutIdx=v.OutIdx,f.Side=r.EdgeSide.esRight,v.Side=r.EdgeSide.esLeft,F=v,F.PrevInAEL==f?H=f.PrevInAEL:H=F.PrevInAEL),H!==null&&H.OutIdx>=0&&r.Clipper.TopX(H,S.Y)==r.Clipper.TopX(F,S.Y)&&r.ClipperBase.SlopesEqual(F,H,this.m_UseFullRange)&&F.WindDelta!==0&&H.WindDelta!==0){var X=this.AddOutPt(H,S);this.AddJoin(I,X,F.Top)}return I},r.Clipper.prototype.CreateOutRec=function(){var f=new r.OutRec;return f.Idx=-1,f.IsHole=!1,f.IsOpen=!1,f.FirstLeft=null,f.Pts=null,f.BottomPt=null,f.PolyNode=null,this.m_PolyOuts.push(f),f.Idx=this.m_PolyOuts.length-1,f},r.Clipper.prototype.AddOutPt=function(f,v){var S=f.Side==r.EdgeSide.esLeft;if(f.OutIdx<0){var I=this.CreateOutRec();I.IsOpen=f.WindDelta===0;var F=new r.OutPt;return I.Pts=F,F.Idx=I.Idx,F.Pt.X=v.X,F.Pt.Y=v.Y,F.Next=F,F.Prev=F,I.IsOpen||this.SetHoleState(f,I),f.OutIdx=I.Idx,F}else{var I=this.m_PolyOuts[f.OutIdx],H=I.Pts;if(S&&r.IntPoint.op_Equality(v,H.Pt))return H;if(!S&&r.IntPoint.op_Equality(v,H.Prev.Pt))return H.Prev;var F=new r.OutPt;return F.Idx=I.Idx,F.Pt.X=v.X,F.Pt.Y=v.Y,F.Next=H,F.Prev=H.Prev,F.Prev.Next=F,H.Prev=F,S&&(I.Pts=F),F}},r.Clipper.prototype.SwapPoints=function(f,v){var S=new r.IntPoint(f.Value);f.Value.X=v.Value.X,f.Value.Y=v.Value.Y,v.Value.X=S.X,v.Value.Y=S.Y},r.Clipper.prototype.HorzSegmentsOverlap=function(f,v,S,I){return f.X>S.X==f.X<I.X||v.X>S.X==v.X<I.X||S.X>f.X==S.X<v.X||I.X>f.X==I.X<v.X||f.X==S.X&&v.X==I.X?!0:f.X==I.X&&v.X==S.X},r.Clipper.prototype.InsertPolyPtBetween=function(f,v,S){var I=new r.OutPt;return I.Pt.X=S.X,I.Pt.Y=S.Y,v==f.Next?(f.Next=I,v.Prev=I,I.Next=v,I.Prev=f):(v.Next=I,f.Prev=I,I.Next=f,I.Prev=v),I},r.Clipper.prototype.SetHoleState=function(f,v){for(var S=!1,I=f.PrevInAEL;I!==null;)I.OutIdx>=0&&I.WindDelta!=0&&(S=!S,v.FirstLeft===null&&(v.FirstLeft=this.m_PolyOuts[I.OutIdx])),I=I.PrevInAEL;S&&(v.IsHole=!0)},r.Clipper.prototype.GetDx=function(f,v){return f.Y==v.Y?r.ClipperBase.horizontal:(v.X-f.X)/(v.Y-f.Y)},r.Clipper.prototype.FirstIsBottomPt=function(f,v){for(var S=f.Prev;r.IntPoint.op_Equality(S.Pt,f.Pt)&&S!=f;)S=S.Prev;var I=Math.abs(this.GetDx(f.Pt,S.Pt));for(S=f.Next;r.IntPoint.op_Equality(S.Pt,f.Pt)&&S!=f;)S=S.Next;var F=Math.abs(this.GetDx(f.Pt,S.Pt));for(S=v.Prev;r.IntPoint.op_Equality(S.Pt,v.Pt)&&S!=v;)S=S.Prev;var H=Math.abs(this.GetDx(v.Pt,S.Pt));for(S=v.Next;r.IntPoint.op_Equality(S.Pt,v.Pt)&&S!=v;)S=S.Next;var X=Math.abs(this.GetDx(v.Pt,S.Pt));return I>=H&&I>=X||F>=H&&F>=X},r.Clipper.prototype.GetBottomPt=function(f){for(var v=null,S=f.Next;S!=f;)S.Pt.Y>f.Pt.Y?(f=S,v=null):S.Pt.Y==f.Pt.Y&&S.Pt.X<=f.Pt.X&&(S.Pt.X<f.Pt.X?(v=null,f=S):S.Next!=f&&S.Prev!=f&&(v=S)),S=S.Next;if(v!==null)for(;v!=S;)for(this.FirstIsBottomPt(S,v)||(f=v),v=v.Next;r.IntPoint.op_Inequality(v.Pt,f.Pt);)v=v.Next;return f},r.Clipper.prototype.GetLowermostRec=function(f,v){f.BottomPt===null&&(f.BottomPt=this.GetBottomPt(f.Pts)),v.BottomPt===null&&(v.BottomPt=this.GetBottomPt(v.Pts));var S=f.BottomPt,I=v.BottomPt;return S.Pt.Y>I.Pt.Y?f:S.Pt.Y<I.Pt.Y?v:S.Pt.X<I.Pt.X?f:S.Pt.X>I.Pt.X||S.Next==S?v:I.Next==I||this.FirstIsBottomPt(S,I)?f:v},r.Clipper.prototype.Param1RightOfParam2=function(f,v){do if(f=f.FirstLeft,f==v)return!0;while(f!==null);return!1},r.Clipper.prototype.GetOutRec=function(f){for(var v=this.m_PolyOuts[f];v!=this.m_PolyOuts[v.Idx];)v=this.m_PolyOuts[v.Idx];return v},r.Clipper.prototype.AppendPolygon=function(f,v){var S=this.m_PolyOuts[f.OutIdx],I=this.m_PolyOuts[v.OutIdx],F;this.Param1RightOfParam2(S,I)?F=I:this.Param1RightOfParam2(I,S)?F=S:F=this.GetLowermostRec(S,I);var H=S.Pts,X=H.Prev,se=I.Pts,de=se.Prev,Ee;f.Side==r.EdgeSide.esLeft?(v.Side==r.EdgeSide.esLeft?(this.ReversePolyPtLinks(se),se.Next=H,H.Prev=se,X.Next=de,de.Prev=X,S.Pts=de):(de.Next=H,H.Prev=de,se.Prev=X,X.Next=se,S.Pts=se),Ee=r.EdgeSide.esLeft):(v.Side==r.EdgeSide.esRight?(this.ReversePolyPtLinks(se),X.Next=de,de.Prev=X,se.Next=H,H.Prev=se):(X.Next=se,se.Prev=X,H.Prev=de,de.Next=H),Ee=r.EdgeSide.esRight),S.BottomPt=null,F==I&&(I.FirstLeft!=S&&(S.FirstLeft=I.FirstLeft),S.IsHole=I.IsHole),I.Pts=null,I.BottomPt=null,I.FirstLeft=S;var je=f.OutIdx,Ke=v.OutIdx;f.OutIdx=-1,v.OutIdx=-1;for(var mt=this.m_ActiveEdges;mt!==null;){if(mt.OutIdx==Ke){mt.OutIdx=je,mt.Side=Ee;break}mt=mt.NextInAEL}I.Idx=S.Idx},r.Clipper.prototype.ReversePolyPtLinks=function(f){if(f!==null){var v,S;v=f;do S=v.Next,v.Next=v.Prev,v.Prev=S,v=S;while(v!=f)}},r.Clipper.SwapSides=function(f,v){var S=f.Side;f.Side=v.Side,v.Side=S},r.Clipper.SwapPolyIndexes=function(f,v){var S=f.OutIdx;f.OutIdx=v.OutIdx,v.OutIdx=S},r.Clipper.prototype.IntersectEdges=function(f,v,S,I){var F=!I&&f.NextInLML===null&&f.Top.X==S.X&&f.Top.Y==S.Y,H=!I&&v.NextInLML===null&&v.Top.X==S.X&&v.Top.Y==S.Y,X=f.OutIdx>=0,se=v.OutIdx>=0;if(f.WindDelta===0||v.WindDelta===0){f.WindDelta===0&&v.WindDelta===0?(F||H)&&X&&se&&this.AddLocalMaxPoly(f,v,S):f.PolyTyp==v.PolyTyp&&f.WindDelta!=v.WindDelta&&this.m_ClipType==r.ClipType.ctUnion?f.WindDelta===0?se&&(this.AddOutPt(f,S),X&&(f.OutIdx=-1)):X&&(this.AddOutPt(v,S),se&&(v.OutIdx=-1)):f.PolyTyp!=v.PolyTyp&&(f.WindDelta===0&&Math.abs(v.WindCnt)==1&&(this.m_ClipType!=r.ClipType.ctUnion||v.WindCnt2===0)?(this.AddOutPt(f,S),X&&(f.OutIdx=-1)):v.WindDelta===0&&Math.abs(f.WindCnt)==1&&(this.m_ClipType!=r.ClipType.ctUnion||f.WindCnt2===0)&&(this.AddOutPt(v,S),se&&(v.OutIdx=-1))),F&&(f.OutIdx<0?this.DeleteFromAEL(f):r.Error("Error intersecting polylines")),H&&(v.OutIdx<0?this.DeleteFromAEL(v):r.Error("Error intersecting polylines"));return}if(f.PolyTyp==v.PolyTyp)if(this.IsEvenOddFillType(f)){var de=f.WindCnt;f.WindCnt=v.WindCnt,v.WindCnt=de}else f.WindCnt+v.WindDelta===0?f.WindCnt=-f.WindCnt:f.WindCnt+=v.WindDelta,v.WindCnt-f.WindDelta===0?v.WindCnt=-v.WindCnt:v.WindCnt-=f.WindDelta;else this.IsEvenOddFillType(v)?f.WindCnt2=f.WindCnt2===0?1:0:f.WindCnt2+=v.WindDelta,this.IsEvenOddFillType(f)?v.WindCnt2=v.WindCnt2===0?1:0:v.WindCnt2-=f.WindDelta;var Ee,je,Ke,mt;f.PolyTyp==r.PolyType.ptSubject?(Ee=this.m_SubjFillType,Ke=this.m_ClipFillType):(Ee=this.m_ClipFillType,Ke=this.m_SubjFillType),v.PolyTyp==r.PolyType.ptSubject?(je=this.m_SubjFillType,mt=this.m_ClipFillType):(je=this.m_ClipFillType,mt=this.m_SubjFillType);var Lt,Tt;switch(Ee){case r.PolyFillType.pftPositive:Lt=f.WindCnt;break;case r.PolyFillType.pftNegative:Lt=-f.WindCnt;break;default:Lt=Math.abs(f.WindCnt);break}switch(je){case r.PolyFillType.pftPositive:Tt=v.WindCnt;break;case r.PolyFillType.pftNegative:Tt=-v.WindCnt;break;default:Tt=Math.abs(v.WindCnt);break}if(X&&se)F||H||Lt!==0&&Lt!=1||Tt!==0&&Tt!=1||f.PolyTyp!=v.PolyTyp&&this.m_ClipType!=r.ClipType.ctXor?this.AddLocalMaxPoly(f,v,S):(this.AddOutPt(f,S),this.AddOutPt(v,S),r.Clipper.SwapSides(f,v),r.Clipper.SwapPolyIndexes(f,v));else if(X)(Tt===0||Tt==1)&&(this.AddOutPt(f,S),r.Clipper.SwapSides(f,v),r.Clipper.SwapPolyIndexes(f,v));else if(se)(Lt===0||Lt==1)&&(this.AddOutPt(v,S),r.Clipper.SwapSides(f,v),r.Clipper.SwapPolyIndexes(f,v));else if((Lt===0||Lt==1)&&(Tt===0||Tt==1)&&!F&&!H){var qt,ki;switch(Ke){case r.PolyFillType.pftPositive:qt=f.WindCnt2;break;case r.PolyFillType.pftNegative:qt=-f.WindCnt2;break;default:qt=Math.abs(f.WindCnt2);break}switch(mt){case r.PolyFillType.pftPositive:ki=v.WindCnt2;break;case r.PolyFillType.pftNegative:ki=-v.WindCnt2;break;default:ki=Math.abs(v.WindCnt2);break}if(f.PolyTyp!=v.PolyTyp)this.AddLocalMinPoly(f,v,S);else if(Lt==1&&Tt==1)switch(this.m_ClipType){case r.ClipType.ctIntersection:qt>0&&ki>0&&this.AddLocalMinPoly(f,v,S);break;case r.ClipType.ctUnion:qt<=0&&ki<=0&&this.AddLocalMinPoly(f,v,S);break;case r.ClipType.ctDifference:(f.PolyTyp==r.PolyType.ptClip&&qt>0&&ki>0||f.PolyTyp==r.PolyType.ptSubject&&qt<=0&&ki<=0)&&this.AddLocalMinPoly(f,v,S);break;case r.ClipType.ctXor:this.AddLocalMinPoly(f,v,S);break}else r.Clipper.SwapSides(f,v)}F!=H&&(F&&f.OutIdx>=0||H&&v.OutIdx>=0)&&(r.Clipper.SwapSides(f,v),r.Clipper.SwapPolyIndexes(f,v)),F&&this.DeleteFromAEL(f),H&&this.DeleteFromAEL(v)},r.Clipper.prototype.DeleteFromAEL=function(f){var v=f.PrevInAEL,S=f.NextInAEL;v===null&&S===null&&f!=this.m_ActiveEdges||(v!==null?v.NextInAEL=S:this.m_ActiveEdges=S,S!==null&&(S.PrevInAEL=v),f.NextInAEL=null,f.PrevInAEL=null)},r.Clipper.prototype.DeleteFromSEL=function(f){var v=f.PrevInSEL,S=f.NextInSEL;v===null&&S===null&&f!=this.m_SortedEdges||(v!==null?v.NextInSEL=S:this.m_SortedEdges=S,S!==null&&(S.PrevInSEL=v),f.NextInSEL=null,f.PrevInSEL=null)},r.Clipper.prototype.UpdateEdgeIntoAEL=function(f){f.NextInLML===null&&r.Error("UpdateEdgeIntoAEL: invalid call");var v=f.PrevInAEL,S=f.NextInAEL;return f.NextInLML.OutIdx=f.OutIdx,v!==null?v.NextInAEL=f.NextInLML:this.m_ActiveEdges=f.NextInLML,S!==null&&(S.PrevInAEL=f.NextInLML),f.NextInLML.Side=f.Side,f.NextInLML.WindDelta=f.WindDelta,f.NextInLML.WindCnt=f.WindCnt,f.NextInLML.WindCnt2=f.WindCnt2,f=f.NextInLML,f.Curr.X=f.Bot.X,f.Curr.Y=f.Bot.Y,f.PrevInAEL=v,f.NextInAEL=S,r.ClipperBase.IsHorizontal(f)||this.InsertScanbeam(f.Top.Y),f},r.Clipper.prototype.ProcessHorizontals=function(f){for(var v=this.m_SortedEdges;v!==null;)this.DeleteFromSEL(v),this.ProcessHorizontal(v,f),v=this.m_SortedEdges},r.Clipper.prototype.GetHorzDirection=function(f,v){f.Bot.X<f.Top.X?(v.Left=f.Bot.X,v.Right=f.Top.X,v.Dir=r.Direction.dLeftToRight):(v.Left=f.Top.X,v.Right=f.Bot.X,v.Dir=r.Direction.dRightToLeft)},r.Clipper.prototype.PrepareHorzJoins=function(f,v){var S=this.m_PolyOuts[f.OutIdx].Pts;f.Side!=r.EdgeSide.esLeft&&(S=S.Prev),v&&(r.IntPoint.op_Equality(S.Pt,f.Top)?this.AddGhostJoin(S,f.Bot):this.AddGhostJoin(S,f.Top))},r.Clipper.prototype.ProcessHorizontal=function(f,v){var S={Dir:null,Left:null,Right:null};this.GetHorzDirection(f,S);for(var I=S.Dir,F=S.Left,H=S.Right,X=f,se=null;X.NextInLML!==null&&r.ClipperBase.IsHorizontal(X.NextInLML);)X=X.NextInLML;for(X.NextInLML===null&&(se=this.GetMaximaPair(X));;){for(var de=f==X,Ee=this.GetNextInAEL(f,I);Ee!==null&&!(Ee.Curr.X==f.Top.X&&f.NextInLML!==null&&Ee.Dx<f.NextInLML.Dx);){var je=this.GetNextInAEL(Ee,I);if(I==r.Direction.dLeftToRight&&Ee.Curr.X<=H||I==r.Direction.dRightToLeft&&Ee.Curr.X>=F){if(f.OutIdx>=0&&f.WindDelta!=0&&this.PrepareHorzJoins(f,v),Ee==se&&de){I==r.Direction.dLeftToRight?this.IntersectEdges(f,Ee,Ee.Top,!1):this.IntersectEdges(Ee,f,Ee.Top,!1),se.OutIdx>=0&&r.Error("ProcessHorizontal error");return}else if(I==r.Direction.dLeftToRight){var Ke=new r.IntPoint(Ee.Curr.X,f.Curr.Y);this.IntersectEdges(f,Ee,Ke,!0)}else{var Ke=new r.IntPoint(Ee.Curr.X,f.Curr.Y);this.IntersectEdges(Ee,f,Ke,!0)}this.SwapPositionsInAEL(f,Ee)}else if(I==r.Direction.dLeftToRight&&Ee.Curr.X>=H||I==r.Direction.dRightToLeft&&Ee.Curr.X<=F)break;Ee=je}if(f.OutIdx>=0&&f.WindDelta!==0&&this.PrepareHorzJoins(f,v),f.NextInLML!==null&&r.ClipperBase.IsHorizontal(f.NextInLML)){f=this.UpdateEdgeIntoAEL(f),f.OutIdx>=0&&this.AddOutPt(f,f.Bot);var S={Dir:I,Left:F,Right:H};this.GetHorzDirection(f,S),I=S.Dir,F=S.Left,H=S.Right}else break}if(f.NextInLML!==null)if(f.OutIdx>=0){var mt=this.AddOutPt(f,f.Top);if(f=this.UpdateEdgeIntoAEL(f),f.WindDelta===0)return;var Lt=f.PrevInAEL,je=f.NextInAEL;if(Lt!==null&&Lt.Curr.X==f.Bot.X&&Lt.Curr.Y==f.Bot.Y&&Lt.WindDelta!==0&&Lt.OutIdx>=0&&Lt.Curr.Y>Lt.Top.Y&&r.ClipperBase.SlopesEqual(f,Lt,this.m_UseFullRange)){var Tt=this.AddOutPt(Lt,f.Bot);this.AddJoin(mt,Tt,f.Top)}else if(je!==null&&je.Curr.X==f.Bot.X&&je.Curr.Y==f.Bot.Y&&je.WindDelta!==0&&je.OutIdx>=0&&je.Curr.Y>je.Top.Y&&r.ClipperBase.SlopesEqual(f,je,this.m_UseFullRange)){var Tt=this.AddOutPt(je,f.Bot);this.AddJoin(mt,Tt,f.Top)}}else f=this.UpdateEdgeIntoAEL(f);else se!==null?se.OutIdx>=0?(I==r.Direction.dLeftToRight?this.IntersectEdges(f,se,f.Top,!1):this.IntersectEdges(se,f,f.Top,!1),se.OutIdx>=0&&r.Error("ProcessHorizontal error")):(this.DeleteFromAEL(f),this.DeleteFromAEL(se)):(f.OutIdx>=0&&this.AddOutPt(f,f.Top),this.DeleteFromAEL(f))},r.Clipper.prototype.GetNextInAEL=function(f,v){return v==r.Direction.dLeftToRight?f.NextInAEL:f.PrevInAEL},r.Clipper.prototype.IsMinima=function(f){return f!==null&&f.Prev.NextInLML!=f&&f.Next.NextInLML!=f},r.Clipper.prototype.IsMaxima=function(f,v){return f!==null&&f.Top.Y==v&&f.NextInLML===null},r.Clipper.prototype.IsIntermediate=function(f,v){return f.Top.Y==v&&f.NextInLML!==null},r.Clipper.prototype.GetMaximaPair=function(f){var v=null;return r.IntPoint.op_Equality(f.Next.Top,f.Top)&&f.Next.NextInLML===null?v=f.Next:r.IntPoint.op_Equality(f.Prev.Top,f.Top)&&f.Prev.NextInLML===null&&(v=f.Prev),v!==null&&(v.OutIdx==-2||v.NextInAEL==v.PrevInAEL&&!r.ClipperBase.IsHorizontal(v))?null:v},r.Clipper.prototype.ProcessIntersections=function(f,v){if(this.m_ActiveEdges==null)return!0;try{if(this.BuildIntersectList(f,v),this.m_IntersectList.length==0)return!0;if(this.m_IntersectList.length==1||this.FixupIntersectionOrder())this.ProcessIntersectList();else return!1}catch{this.m_SortedEdges=null,this.m_IntersectList.length=0,r.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},r.Clipper.prototype.BuildIntersectList=function(f,v){if(this.m_ActiveEdges!==null){var S=this.m_ActiveEdges;for(this.m_SortedEdges=S;S!==null;)S.PrevInSEL=S.PrevInAEL,S.NextInSEL=S.NextInAEL,S.Curr.X=r.Clipper.TopX(S,v),S=S.NextInAEL;for(var I=!0;I&&this.m_SortedEdges!==null;){for(I=!1,S=this.m_SortedEdges;S.NextInSEL!==null;){var F=S.NextInSEL,H=new r.IntPoint;if(S.Curr.X>F.Curr.X){!this.IntersectPoint(S,F,H)&&S.Curr.X>F.Curr.X+1&&r.Error("Intersection error"),H.Y>f&&(H.Y=f,Math.abs(S.Dx)>Math.abs(F.Dx)?H.X=r.Clipper.TopX(F,f):H.X=r.Clipper.TopX(S,f));var X=new r.IntersectNode;X.Edge1=S,X.Edge2=F,X.Pt.X=H.X,X.Pt.Y=H.Y,this.m_IntersectList.push(X),this.SwapPositionsInSEL(S,F),I=!0}else S=F}if(S.PrevInSEL!==null)S.PrevInSEL.NextInSEL=null;else break}this.m_SortedEdges=null}},r.Clipper.prototype.EdgesAdjacent=function(f){return f.Edge1.NextInSEL==f.Edge2||f.Edge1.PrevInSEL==f.Edge2},r.Clipper.IntersectNodeSort=function(f,v){return v.Pt.Y-f.Pt.Y},r.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var f=this.m_IntersectList.length,v=0;v<f;v++){if(!this.EdgesAdjacent(this.m_IntersectList[v])){for(var S=v+1;S<f&&!this.EdgesAdjacent(this.m_IntersectList[S]);)S++;if(S==f)return!1;var I=this.m_IntersectList[v];this.m_IntersectList[v]=this.m_IntersectList[S],this.m_IntersectList[S]=I}this.SwapPositionsInSEL(this.m_IntersectList[v].Edge1,this.m_IntersectList[v].Edge2)}return!0},r.Clipper.prototype.ProcessIntersectList=function(){for(var f=0,v=this.m_IntersectList.length;f<v;f++){var S=this.m_IntersectList[f];this.IntersectEdges(S.Edge1,S.Edge2,S.Pt,!0),this.SwapPositionsInAEL(S.Edge1,S.Edge2)}this.m_IntersectList.length=0};var Pa=h(function(f){return f<0?Math.ceil(f-.5):Math.round(f)},"R1"),Ws=h(function(f){return f<0?Math.ceil(f-.5):Math.floor(f+.5)},"R2"),Hr=h(function(f){return f<0?-Math.round(Math.abs(f)):Math.round(f)},"R3"),Ka=h(function(f){return f<0?(f-=.5,f<-2147483648?Math.ceil(f):f|0):(f+=.5,f>2147483647?Math.floor(f):f|0)},"R4");s.msie?r.Clipper.Round=Pa:s.chromium?r.Clipper.Round=Hr:s.safari?r.Clipper.Round=Ka:r.Clipper.Round=Ws,r.Clipper.TopX=function(f,v){return v==f.Top.Y?f.Top.X:f.Bot.X+r.Clipper.Round(f.Dx*(v-f.Bot.Y))},r.Clipper.prototype.IntersectPoint=function(f,v,S){S.X=0,S.Y=0;var I,F;if(r.ClipperBase.SlopesEqual(f,v,this.m_UseFullRange)||f.Dx==v.Dx)return v.Bot.Y>f.Bot.Y?(S.X=v.Bot.X,S.Y=v.Bot.Y):(S.X=f.Bot.X,S.Y=f.Bot.Y),!1;if(f.Delta.X===0)S.X=f.Bot.X,r.ClipperBase.IsHorizontal(v)?S.Y=v.Bot.Y:(F=v.Bot.Y-v.Bot.X/v.Dx,S.Y=r.Clipper.Round(S.X/v.Dx+F));else if(v.Delta.X===0)S.X=v.Bot.X,r.ClipperBase.IsHorizontal(f)?S.Y=f.Bot.Y:(I=f.Bot.Y-f.Bot.X/f.Dx,S.Y=r.Clipper.Round(S.X/f.Dx+I));else{I=f.Bot.X-f.Bot.Y*f.Dx,F=v.Bot.X-v.Bot.Y*v.Dx;var H=(F-I)/(f.Dx-v.Dx);S.Y=r.Clipper.Round(H),Math.abs(f.Dx)<Math.abs(v.Dx)?S.X=r.Clipper.Round(f.Dx*H+I):S.X=r.Clipper.Round(v.Dx*H+F)}if(S.Y<f.Top.Y||S.Y<v.Top.Y){if(f.Top.Y>v.Top.Y)return S.Y=f.Top.Y,S.X=r.Clipper.TopX(v,f.Top.Y),S.X<f.Top.X;S.Y=v.Top.Y,Math.abs(f.Dx)<Math.abs(v.Dx)?S.X=r.Clipper.TopX(f,S.Y):S.X=r.Clipper.TopX(v,S.Y)}return!0},r.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(f){for(var v=this.m_ActiveEdges;v!==null;){var S=this.IsMaxima(v,f);if(S){var I=this.GetMaximaPair(v);S=I===null||!r.ClipperBase.IsHorizontal(I)}if(S){var F=v.PrevInAEL;this.DoMaxima(v),F===null?v=this.m_ActiveEdges:v=F.NextInAEL}else{if(this.IsIntermediate(v,f)&&r.ClipperBase.IsHorizontal(v.NextInLML)?(v=this.UpdateEdgeIntoAEL(v),v.OutIdx>=0&&this.AddOutPt(v,v.Bot),this.AddEdgeToSEL(v)):(v.Curr.X=r.Clipper.TopX(v,f),v.Curr.Y=f),this.StrictlySimple){var F=v.PrevInAEL;if(v.OutIdx>=0&&v.WindDelta!==0&&F!==null&&F.OutIdx>=0&&F.Curr.X==v.Curr.X&&F.WindDelta!==0){var H=this.AddOutPt(F,v.Curr),X=this.AddOutPt(v,v.Curr);this.AddJoin(H,X,v.Curr)}}v=v.NextInAEL}}for(this.ProcessHorizontals(!0),v=this.m_ActiveEdges;v!==null;){if(this.IsIntermediate(v,f)){var H=null;v.OutIdx>=0&&(H=this.AddOutPt(v,v.Top)),v=this.UpdateEdgeIntoAEL(v);var F=v.PrevInAEL,se=v.NextInAEL;if(F!==null&&F.Curr.X==v.Bot.X&&F.Curr.Y==v.Bot.Y&&H!==null&&F.OutIdx>=0&&F.Curr.Y>F.Top.Y&&r.ClipperBase.SlopesEqual(v,F,this.m_UseFullRange)&&v.WindDelta!==0&&F.WindDelta!==0){var X=this.AddOutPt(F,v.Bot);this.AddJoin(H,X,v.Top)}else if(se!==null&&se.Curr.X==v.Bot.X&&se.Curr.Y==v.Bot.Y&&H!==null&&se.OutIdx>=0&&se.Curr.Y>se.Top.Y&&r.ClipperBase.SlopesEqual(v,se,this.m_UseFullRange)&&v.WindDelta!==0&&se.WindDelta!==0){var X=this.AddOutPt(se,v.Bot);this.AddJoin(H,X,v.Top)}}v=v.NextInAEL}},r.Clipper.prototype.DoMaxima=function(f){var v=this.GetMaximaPair(f);if(v===null){f.OutIdx>=0&&this.AddOutPt(f,f.Top),this.DeleteFromAEL(f);return}for(var S=f.NextInAEL,I=!0;S!==null&&S!=v;)this.IntersectEdges(f,S,f.Top,!0),this.SwapPositionsInAEL(f,S),S=f.NextInAEL;f.OutIdx==-1&&v.OutIdx==-1?(this.DeleteFromAEL(f),this.DeleteFromAEL(v)):f.OutIdx>=0&&v.OutIdx>=0?this.IntersectEdges(f,v,f.Top,!1):I&&f.WindDelta===0?(f.OutIdx>=0&&(this.AddOutPt(f,f.Top),f.OutIdx=-1),this.DeleteFromAEL(f),v.OutIdx>=0&&(this.AddOutPt(v,f.Top),v.OutIdx=-1),this.DeleteFromAEL(v)):r.Error("DoMaxima error")},r.Clipper.ReversePaths=function(f){for(var v=0,S=f.length;v<S;v++)f[v].reverse()},r.Clipper.Orientation=function(f){return r.Clipper.Area(f)>=0},r.Clipper.prototype.PointCount=function(f){if(f===null)return 0;var v=0,S=f;do v++,S=S.Next;while(S!=f);return v},r.Clipper.prototype.BuildResult=function(f){r.Clear(f);for(var v=0,S=this.m_PolyOuts.length;v<S;v++){var I=this.m_PolyOuts[v];if(I.Pts!==null){var F=I.Pts.Prev,H=this.PointCount(F);if(!(H<2)){for(var X=new Array(H),se=0;se<H;se++)X[se]=F.Pt,F=F.Prev;f.push(X)}}}},r.Clipper.prototype.BuildResult2=function(f){f.Clear();for(var v=0,S=this.m_PolyOuts.length;v<S;v++){var I=this.m_PolyOuts[v],F=this.PointCount(I.Pts);if(!(I.IsOpen&&F<2||!I.IsOpen&&F<3)){this.FixHoleLinkage(I);var H=new r.PolyNode;f.m_AllPolys.push(H),I.PolyNode=H,H.m_polygon.length=F;for(var X=I.Pts.Prev,se=0;se<F;se++)H.m_polygon[se]=X.Pt,X=X.Prev}}for(var v=0,S=this.m_PolyOuts.length;v<S;v++){var I=this.m_PolyOuts[v];I.PolyNode!==null&&(I.IsOpen?(I.PolyNode.IsOpen=!0,f.AddChild(I.PolyNode)):I.FirstLeft!==null&&I.FirstLeft.PolyNode!=null?I.FirstLeft.PolyNode.AddChild(I.PolyNode):f.AddChild(I.PolyNode))}},r.Clipper.prototype.FixupOutPolygon=function(f){var v=null;f.BottomPt=null;for(var S=f.Pts;;){if(S.Prev==S||S.Prev==S.Next){this.DisposeOutPts(S),f.Pts=null;return}if(r.IntPoint.op_Equality(S.Pt,S.Next.Pt)||r.IntPoint.op_Equality(S.Pt,S.Prev.Pt)||r.ClipperBase.SlopesEqual(S.Prev.Pt,S.Pt,S.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(S.Prev.Pt,S.Pt,S.Next.Pt)))v=null,S.Prev.Next=S.Next,S.Next.Prev=S.Prev,S=S.Prev;else{if(S==v)break;v===null&&(v=S),S=S.Next}}f.Pts=S},r.Clipper.prototype.DupOutPt=function(f,v){var S=new r.OutPt;return S.Pt.X=f.Pt.X,S.Pt.Y=f.Pt.Y,S.Idx=f.Idx,v?(S.Next=f.Next,S.Prev=f,f.Next.Prev=S,f.Next=S):(S.Prev=f.Prev,S.Next=f,f.Prev.Next=S,f.Prev=S),S},r.Clipper.prototype.GetOverlap=function(f,v,S,I,F){return f<v?S<I?(F.Left=Math.max(f,S),F.Right=Math.min(v,I)):(F.Left=Math.max(f,I),F.Right=Math.min(v,S)):S<I?(F.Left=Math.max(v,S),F.Right=Math.min(f,I)):(F.Left=Math.max(v,I),F.Right=Math.min(f,S)),F.Left<F.Right},r.Clipper.prototype.JoinHorz=function(f,v,S,I,F,H){var X=f.Pt.X>v.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight,se=S.Pt.X>I.Pt.X?r.Direction.dRightToLeft:r.Direction.dLeftToRight;if(X==se)return!1;if(X==r.Direction.dLeftToRight){for(;f.Next.Pt.X<=F.X&&f.Next.Pt.X>=f.Pt.X&&f.Next.Pt.Y==F.Y;)f=f.Next;H&&f.Pt.X!=F.X&&(f=f.Next),v=this.DupOutPt(f,!H),r.IntPoint.op_Inequality(v.Pt,F)&&(f=v,f.Pt.X=F.X,f.Pt.Y=F.Y,v=this.DupOutPt(f,!H))}else{for(;f.Next.Pt.X>=F.X&&f.Next.Pt.X<=f.Pt.X&&f.Next.Pt.Y==F.Y;)f=f.Next;!H&&f.Pt.X!=F.X&&(f=f.Next),v=this.DupOutPt(f,H),r.IntPoint.op_Inequality(v.Pt,F)&&(f=v,f.Pt.X=F.X,f.Pt.Y=F.Y,v=this.DupOutPt(f,H))}if(se==r.Direction.dLeftToRight){for(;S.Next.Pt.X<=F.X&&S.Next.Pt.X>=S.Pt.X&&S.Next.Pt.Y==F.Y;)S=S.Next;H&&S.Pt.X!=F.X&&(S=S.Next),I=this.DupOutPt(S,!H),r.IntPoint.op_Inequality(I.Pt,F)&&(S=I,S.Pt.X=F.X,S.Pt.Y=F.Y,I=this.DupOutPt(S,!H))}else{for(;S.Next.Pt.X>=F.X&&S.Next.Pt.X<=S.Pt.X&&S.Next.Pt.Y==F.Y;)S=S.Next;!H&&S.Pt.X!=F.X&&(S=S.Next),I=this.DupOutPt(S,H),r.IntPoint.op_Inequality(I.Pt,F)&&(S=I,S.Pt.X=F.X,S.Pt.Y=F.Y,I=this.DupOutPt(S,H))}return X==r.Direction.dLeftToRight==H?(f.Prev=S,S.Next=f,v.Next=I,I.Prev=v):(f.Next=S,S.Prev=f,v.Prev=I,I.Next=v),!0},r.Clipper.prototype.JoinPoints=function(f,v,S){var I=f.OutPt1,F=new r.OutPt,H=f.OutPt2,X=new r.OutPt,se=f.OutPt1.Pt.Y==f.OffPt.Y;if(se&&r.IntPoint.op_Equality(f.OffPt,f.OutPt1.Pt)&&r.IntPoint.op_Equality(f.OffPt,f.OutPt2.Pt)){for(F=f.OutPt1.Next;F!=I&&r.IntPoint.op_Equality(F.Pt,f.OffPt);)F=F.Next;var de=F.Pt.Y>f.OffPt.Y;for(X=f.OutPt2.Next;X!=H&&r.IntPoint.op_Equality(X.Pt,f.OffPt);)X=X.Next;var Ee=X.Pt.Y>f.OffPt.Y;return de==Ee?!1:de?(F=this.DupOutPt(I,!1),X=this.DupOutPt(H,!0),I.Prev=H,H.Next=I,F.Next=X,X.Prev=F,f.OutPt1=I,f.OutPt2=F,!0):(F=this.DupOutPt(I,!0),X=this.DupOutPt(H,!1),I.Next=H,H.Prev=I,F.Prev=X,X.Next=F,f.OutPt1=I,f.OutPt2=F,!0)}else if(se){for(F=I;I.Prev.Pt.Y==I.Pt.Y&&I.Prev!=F&&I.Prev!=H;)I=I.Prev;for(;F.Next.Pt.Y==F.Pt.Y&&F.Next!=I&&F.Next!=H;)F=F.Next;if(F.Next==I||F.Next==H)return!1;for(X=H;H.Prev.Pt.Y==H.Pt.Y&&H.Prev!=X&&H.Prev!=F;)H=H.Prev;for(;X.Next.Pt.Y==X.Pt.Y&&X.Next!=H&&X.Next!=I;)X=X.Next;if(X.Next==H||X.Next==I)return!1;var je={Left:null,Right:null};if(!this.GetOverlap(I.Pt.X,F.Pt.X,H.Pt.X,X.Pt.X,je))return!1;var Ke=je.Left,mt=je.Right,Lt=new r.IntPoint,Tt;return I.Pt.X>=Ke&&I.Pt.X<=mt?(Lt.X=I.Pt.X,Lt.Y=I.Pt.Y,Tt=I.Pt.X>F.Pt.X):H.Pt.X>=Ke&&H.Pt.X<=mt?(Lt.X=H.Pt.X,Lt.Y=H.Pt.Y,Tt=H.Pt.X>X.Pt.X):F.Pt.X>=Ke&&F.Pt.X<=mt?(Lt.X=F.Pt.X,Lt.Y=F.Pt.Y,Tt=F.Pt.X>I.Pt.X):(Lt.X=X.Pt.X,Lt.Y=X.Pt.Y,Tt=X.Pt.X>H.Pt.X),f.OutPt1=I,f.OutPt2=H,this.JoinHorz(I,F,H,X,Lt,Tt)}else{for(F=I.Next;r.IntPoint.op_Equality(F.Pt,I.Pt)&&F!=I;)F=F.Next;var qt=F.Pt.Y>I.Pt.Y||!r.ClipperBase.SlopesEqual(I.Pt,F.Pt,f.OffPt,this.m_UseFullRange);if(qt){for(F=I.Prev;r.IntPoint.op_Equality(F.Pt,I.Pt)&&F!=I;)F=F.Prev;if(F.Pt.Y>I.Pt.Y||!r.ClipperBase.SlopesEqual(I.Pt,F.Pt,f.OffPt,this.m_UseFullRange))return!1}for(X=H.Next;r.IntPoint.op_Equality(X.Pt,H.Pt)&&X!=H;)X=X.Next;var ki=X.Pt.Y>H.Pt.Y||!r.ClipperBase.SlopesEqual(H.Pt,X.Pt,f.OffPt,this.m_UseFullRange);if(ki){for(X=H.Prev;r.IntPoint.op_Equality(X.Pt,H.Pt)&&X!=H;)X=X.Prev;if(X.Pt.Y>H.Pt.Y||!r.ClipperBase.SlopesEqual(H.Pt,X.Pt,f.OffPt,this.m_UseFullRange))return!1}return F==I||X==H||F==X||v==S&&qt==ki?!1:qt?(F=this.DupOutPt(I,!1),X=this.DupOutPt(H,!0),I.Prev=H,H.Next=I,F.Next=X,X.Prev=F,f.OutPt1=I,f.OutPt2=F,!0):(F=this.DupOutPt(I,!0),X=this.DupOutPt(H,!1),I.Next=H,H.Prev=I,F.Prev=X,X.Next=F,f.OutPt1=I,f.OutPt2=F,!0)}},r.Clipper.GetBounds=function(f){for(var v=0,S=f.length;v<S&&f[v].length==0;)v++;if(v==S)return new r.IntRect(0,0,0,0);var I=new r.IntRect;for(I.left=f[v][0].X,I.right=I.left,I.top=f[v][0].Y,I.bottom=I.top;v<S;v++)for(var F=0,H=f[v].length;F<H;F++)f[v][F].X<I.left?I.left=f[v][F].X:f[v][F].X>I.right&&(I.right=f[v][F].X),f[v][F].Y<I.top?I.top=f[v][F].Y:f[v][F].Y>I.bottom&&(I.bottom=f[v][F].Y);return I},r.Clipper.prototype.GetBounds2=function(f){var v=f,S=new r.IntRect;for(S.left=f.Pt.X,S.right=f.Pt.X,S.top=f.Pt.Y,S.bottom=f.Pt.Y,f=f.Next;f!=v;)f.Pt.X<S.left&&(S.left=f.Pt.X),f.Pt.X>S.right&&(S.right=f.Pt.X),f.Pt.Y<S.top&&(S.top=f.Pt.Y),f.Pt.Y>S.bottom&&(S.bottom=f.Pt.Y),f=f.Next;return S},r.Clipper.PointInPolygon=function(f,v){var S=0,I=v.length;if(I<3)return 0;for(var F=v[0],H=1;H<=I;++H){var X=H==I?v[0]:v[H];if(X.Y==f.Y&&(X.X==f.X||F.Y==f.Y&&X.X>f.X==F.X<f.X))return-1;if(F.Y<f.Y!=X.Y<f.Y){if(F.X>=f.X)if(X.X>f.X)S=1-S;else{var se=(F.X-f.X)*(X.Y-f.Y)-(X.X-f.X)*(F.Y-f.Y);if(se==0)return-1;se>0==X.Y>F.Y&&(S=1-S)}else if(X.X>f.X){var se=(F.X-f.X)*(X.Y-f.Y)-(X.X-f.X)*(F.Y-f.Y);if(se==0)return-1;se>0==X.Y>F.Y&&(S=1-S)}}F=X}return S},r.Clipper.prototype.PointInPolygon=function(f,v){for(var S=0,I=v;;){var F=v.Pt.X,H=v.Pt.Y,X=v.Next.Pt.X,se=v.Next.Pt.Y;if(se==f.Y&&(X==f.X||H==f.Y&&X>f.X==F<f.X))return-1;if(H<f.Y!=se<f.Y){if(F>=f.X)if(X>f.X)S=1-S;else{var de=(F-f.X)*(se-f.Y)-(X-f.X)*(H-f.Y);if(de==0)return-1;de>0==se>H&&(S=1-S)}else if(X>f.X){var de=(F-f.X)*(se-f.Y)-(X-f.X)*(H-f.Y);if(de==0)return-1;de>0==se>H&&(S=1-S)}}if(v=v.Next,I==v)break}return S},r.Clipper.prototype.Poly2ContainsPoly1=function(f,v){var S=f;do{var I=this.PointInPolygon(S.Pt,v);if(I>=0)return I!=0;S=S.Next}while(S!=f);return!0},r.Clipper.prototype.FixupFirstLefts1=function(f,v){for(var S=0,I=this.m_PolyOuts.length;S<I;S++){var F=this.m_PolyOuts[S];F.Pts!==null&&F.FirstLeft==f&&this.Poly2ContainsPoly1(F.Pts,v.Pts)&&(F.FirstLeft=v)}},r.Clipper.prototype.FixupFirstLefts2=function(f,v){for(var S=0,I=this.m_PolyOuts,F=I.length,H=I[S];S<F;S++,H=I[S])H.FirstLeft==f&&(H.FirstLeft=v)},r.Clipper.ParseFirstLeft=function(f){for(;f!=null&&f.Pts==null;)f=f.FirstLeft;return f},r.Clipper.prototype.JoinCommonEdges=function(){for(var f=0,v=this.m_Joins.length;f<v;f++){var S=this.m_Joins[f],I=this.GetOutRec(S.OutPt1.Idx),F=this.GetOutRec(S.OutPt2.Idx);if(!(I.Pts==null||F.Pts==null)){var H;if(I==F?H=I:this.Param1RightOfParam2(I,F)?H=F:this.Param1RightOfParam2(F,I)?H=I:H=this.GetLowermostRec(I,F),!!this.JoinPoints(S,I,F))if(I==F){if(I.Pts=S.OutPt1,I.BottomPt=null,F=this.CreateOutRec(),F.Pts=S.OutPt2,this.UpdateOutPtIdxs(F),this.m_UsingPolyTree)for(var X=0,se=this.m_PolyOuts.length;X<se-1;X++){var de=this.m_PolyOuts[X];de.Pts==null||r.Clipper.ParseFirstLeft(de.FirstLeft)!=I||de.IsHole==I.IsHole||this.Poly2ContainsPoly1(de.Pts,S.OutPt2)&&(de.FirstLeft=F)}this.Poly2ContainsPoly1(F.Pts,I.Pts)?(F.IsHole=!I.IsHole,F.FirstLeft=I,this.m_UsingPolyTree&&this.FixupFirstLefts2(F,I),(F.IsHole^this.ReverseSolution)==this.Area(F)>0&&this.ReversePolyPtLinks(F.Pts)):this.Poly2ContainsPoly1(I.Pts,F.Pts)?(F.IsHole=I.IsHole,I.IsHole=!F.IsHole,F.FirstLeft=I.FirstLeft,I.FirstLeft=F,this.m_UsingPolyTree&&this.FixupFirstLefts2(I,F),(I.IsHole^this.ReverseSolution)==this.Area(I)>0&&this.ReversePolyPtLinks(I.Pts)):(F.IsHole=I.IsHole,F.FirstLeft=I.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(I,F))}else F.Pts=null,F.BottomPt=null,F.Idx=I.Idx,I.IsHole=H.IsHole,H==F&&(I.FirstLeft=F.FirstLeft),F.FirstLeft=I,this.m_UsingPolyTree&&this.FixupFirstLefts2(F,I)}}},r.Clipper.prototype.UpdateOutPtIdxs=function(f){var v=f.Pts;do v.Idx=f.Idx,v=v.Prev;while(v!=f.Pts)},r.Clipper.prototype.DoSimplePolygons=function(){for(var f=0;f<this.m_PolyOuts.length;){var v=this.m_PolyOuts[f++],S=v.Pts;if(S!==null)do{for(var I=S.Next;I!=v.Pts;){if(r.IntPoint.op_Equality(S.Pt,I.Pt)&&I.Next!=S&&I.Prev!=S){var F=S.Prev,H=I.Prev;S.Prev=H,H.Next=S,I.Prev=F,F.Next=I,v.Pts=S;var X=this.CreateOutRec();X.Pts=I,this.UpdateOutPtIdxs(X),this.Poly2ContainsPoly1(X.Pts,v.Pts)?(X.IsHole=!v.IsHole,X.FirstLeft=v):this.Poly2ContainsPoly1(v.Pts,X.Pts)?(X.IsHole=v.IsHole,v.IsHole=!X.IsHole,X.FirstLeft=v.FirstLeft,v.FirstLeft=X):(X.IsHole=v.IsHole,X.FirstLeft=v.FirstLeft),I=S}I=I.Next}S=S.Next}while(S!=v.Pts)}},r.Clipper.Area=function(f){var v=f.length;if(v<3)return 0;for(var S=0,I=0,F=v-1;I<v;++I)S+=(f[F].X+f[I].X)*(f[F].Y-f[I].Y),F=I;return-S*.5},r.Clipper.prototype.Area=function(f){var v=f.Pts;if(v==null)return 0;var S=0;do S=S+(v.Prev.Pt.X+v.Pt.X)*(v.Prev.Pt.Y-v.Pt.Y),v=v.Next;while(v!=f.Pts);return S*.5},r.Clipper.SimplifyPolygon=function(f,v){var S=new Array,I=new r.Clipper(0);return I.StrictlySimple=!0,I.AddPath(f,r.PolyType.ptSubject,!0),I.Execute(r.ClipType.ctUnion,S,v,v),S},r.Clipper.SimplifyPolygons=function(f,v){typeof v>"u"&&(v=r.PolyFillType.pftEvenOdd);var S=new Array,I=new r.Clipper(0);return I.StrictlySimple=!0,I.AddPaths(f,r.PolyType.ptSubject,!0),I.Execute(r.ClipType.ctUnion,S,v,v),S},r.Clipper.DistanceSqrd=function(f,v){var S=f.X-v.X,I=f.Y-v.Y;return S*S+I*I},r.Clipper.DistanceFromLineSqrd=function(f,v,S){var I=v.Y-S.Y,F=S.X-v.X,H=I*v.X+F*v.Y;return H=I*f.X+F*f.Y-H,H*H/(I*I+F*F)},r.Clipper.SlopesNearCollinear=function(f,v,S,I){return r.Clipper.DistanceFromLineSqrd(v,f,S)<I},r.Clipper.PointsAreClose=function(f,v,S){var I=f.X-v.X,F=f.Y-v.Y;return I*I+F*F<=S},r.Clipper.ExcludeOp=function(f){var v=f.Prev;return v.Next=f.Next,f.Next.Prev=v,v.Idx=0,v},r.Clipper.CleanPolygon=function(f,v){typeof v>"u"&&(v=1.415);var S=f.length;if(S==0)return new Array;for(var I=new Array(S),F=0;F<S;++F)I[F]=new r.OutPt;for(var F=0;F<S;++F)I[F].Pt=f[F],I[F].Next=I[(F+1)%S],I[F].Next.Prev=I[F],I[F].Idx=0;for(var H=v*v,X=I[0];X.Idx==0&&X.Next!=X.Prev;)r.Clipper.PointsAreClose(X.Pt,X.Prev.Pt,H)?(X=r.Clipper.ExcludeOp(X),S--):r.Clipper.PointsAreClose(X.Prev.Pt,X.Next.Pt,H)?(r.Clipper.ExcludeOp(X.Next),X=r.Clipper.ExcludeOp(X),S-=2):r.Clipper.SlopesNearCollinear(X.Prev.Pt,X.Pt,X.Next.Pt,H)?(X=r.Clipper.ExcludeOp(X),S--):(X.Idx=1,X=X.Next);S<3&&(S=0);for(var se=new Array(S),F=0;F<S;++F)se[F]=new r.IntPoint(X.Pt),X=X.Next;return I=null,se},r.Clipper.CleanPolygons=function(f,v){for(var S=new Array(f.length),I=0,F=f.length;I<F;I++)S[I]=r.Clipper.CleanPolygon(f[I],v);return S},r.Clipper.Minkowski=function(f,v,S,I){var F=I?1:0,H=f.length,X=v.length,se=new Array;if(S)for(var de=0;de<X;de++){for(var Ee=new Array(H),je=0,Ke=f.length,mt=f[je];je<Ke;je++,mt=f[je])Ee[je]=new r.IntPoint(v[de].X+mt.X,v[de].Y+mt.Y);se.push(Ee)}else for(var de=0;de<X;de++){for(var Ee=new Array(H),je=0,Ke=f.length,mt=f[je];je<Ke;je++,mt=f[je])Ee[je]=new r.IntPoint(v[de].X-mt.X,v[de].Y-mt.Y);se.push(Ee)}for(var Lt=new Array,de=0;de<X-1+F;de++)for(var je=0;je<H;je++){var Tt=new Array;Tt.push(se[de%X][je%H]),Tt.push(se[(de+1)%X][je%H]),Tt.push(se[(de+1)%X][(je+1)%H]),Tt.push(se[de%X][(je+1)%H]),r.Clipper.Orientation(Tt)||Tt.reverse(),Lt.push(Tt)}var qt=new r.Clipper(0);return qt.AddPaths(Lt,r.PolyType.ptSubject,!0),qt.Execute(r.ClipType.ctUnion,se,r.PolyFillType.pftNonZero,r.PolyFillType.pftNonZero),se},r.Clipper.MinkowskiSum=function(){var f=arguments,v=f.length;if(v==3){var S=f[0],I=f[1],F=f[2];return r.Clipper.Minkowski(S,I,!0,F)}else if(v==4){for(var S=f[0],H=f[1],X=f[2],F=f[3],se=new r.Clipper,de,Ee=0,je=H.length;Ee<je;++Ee){var de=r.Clipper.Minkowski(S,H[Ee],!0,F);se.AddPaths(de,r.PolyType.ptSubject,!0)}F&&se.AddPaths(H,r.PolyType.ptClip,!0);var Ke=new r.Paths;return se.Execute(r.ClipType.ctUnion,Ke,X,X),Ke}},r.Clipper.MinkowskiDiff=function(f,v,S){return r.Clipper.Minkowski(f,v,!1,S)},r.Clipper.PolyTreeToPaths=function(f){var v=new Array;return r.Clipper.AddPolyNodeToPaths(f,r.Clipper.NodeType.ntAny,v),v},r.Clipper.AddPolyNodeToPaths=function(f,v,S){var I=!0;switch(v){case r.Clipper.NodeType.ntOpen:return;case r.Clipper.NodeType.ntClosed:I=!f.IsOpen;break}f.m_polygon.length>0&&I&&S.push(f.m_polygon);for(var F=0,H=f.Childs(),X=H.length,se=H[F];F<X;F++,se=H[F])r.Clipper.AddPolyNodeToPaths(se,v,S)},r.Clipper.OpenPathsFromPolyTree=function(f){for(var v=new r.Paths,S=0,I=f.ChildCount();S<I;S++)f.Childs()[S].IsOpen&&v.push(f.Childs()[S].m_polygon);return v},r.Clipper.ClosedPathsFromPolyTree=function(f){var v=new r.Paths;return r.Clipper.AddPolyNodeToPaths(f,r.Clipper.NodeType.ntClosed,v),v},Ui(r.Clipper,r.ClipperBase),r.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},r.ClipperOffset=function(f,v){typeof f>"u"&&(f=2),typeof v>"u"&&(v=r.ClipperOffset.def_arc_tolerance),this.m_destPolys=new r.Paths,this.m_srcPoly=new r.Path,this.m_destPoly=new r.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new r.IntPoint,this.m_polyNodes=new r.PolyNode,this.MiterLimit=f,this.ArcTolerance=v,this.m_lowest.X=-1},r.ClipperOffset.two_pi=6.28318530717959,r.ClipperOffset.def_arc_tolerance=.25,r.ClipperOffset.prototype.Clear=function(){r.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},r.ClipperOffset.Round=r.Clipper.Round,r.ClipperOffset.prototype.AddPath=function(f,v,S){var I=f.length-1;if(!(I<0)){var F=new r.PolyNode;if(F.m_jointype=v,F.m_endtype=S,S==r.EndType.etClosedLine||S==r.EndType.etClosedPolygon)for(;I>0&&r.IntPoint.op_Equality(f[0],f[I]);)I--;F.m_polygon.push(f[0]);for(var H=0,X=0,se=1;se<=I;se++)r.IntPoint.op_Inequality(F.m_polygon[H],f[se])&&(H++,F.m_polygon.push(f[se]),(f[se].Y>F.m_polygon[X].Y||f[se].Y==F.m_polygon[X].Y&&f[se].X<F.m_polygon[X].X)&&(X=H));if(!(S==r.EndType.etClosedPolygon&&H<2||S!=r.EndType.etClosedPolygon&&H<0)&&(this.m_polyNodes.AddChild(F),S==r.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new r.IntPoint(0,X);else{var de=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(F.m_polygon[X].Y>de.Y||F.m_polygon[X].Y==de.Y&&F.m_polygon[X].X<de.X)&&(this.m_lowest=new r.IntPoint(this.m_polyNodes.ChildCount()-1,X))}}},r.ClipperOffset.prototype.AddPaths=function(f,v,S){for(var I=0,F=f.length;I<F;I++)this.AddPath(f[I],v,S)},r.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!r.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var f=0;f<this.m_polyNodes.ChildCount();f++){var v=this.m_polyNodes.Childs()[f];(v.m_endtype==r.EndType.etClosedPolygon||v.m_endtype==r.EndType.etClosedLine&&r.Clipper.Orientation(v.m_polygon))&&v.m_polygon.reverse()}else for(var f=0;f<this.m_polyNodes.ChildCount();f++){var v=this.m_polyNodes.Childs()[f];v.m_endtype==r.EndType.etClosedLine&&!r.Clipper.Orientation(v.m_polygon)&&v.m_polygon.reverse()}},r.ClipperOffset.GetUnitNormal=function(f,v){var S=v.X-f.X,I=v.Y-f.Y;if(S==0&&I==0)return new r.DoublePoint(0,0);var F=1/Math.sqrt(S*S+I*I);return S*=F,I*=F,new r.DoublePoint(I,-S)},r.ClipperOffset.prototype.DoOffset=function(f){if(this.m_destPolys=new Array,this.m_delta=f,r.ClipperBase.near_zero(f)){for(var v=0;v<this.m_polyNodes.ChildCount();v++){var S=this.m_polyNodes.Childs()[v];S.m_endtype==r.EndType.etClosedPolygon&&this.m_destPolys.push(S.m_polygon)}return}this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var I;this.ArcTolerance<=0?I=r.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(f)*r.ClipperOffset.def_arc_tolerance?I=Math.abs(f)*r.ClipperOffset.def_arc_tolerance:I=this.ArcTolerance;var F=3.14159265358979/Math.acos(1-I/Math.abs(f));this.m_sin=Math.sin(r.ClipperOffset.two_pi/F),this.m_cos=Math.cos(r.ClipperOffset.two_pi/F),this.m_StepsPerRad=F/r.ClipperOffset.two_pi,f<0&&(this.m_sin=-this.m_sin);for(var v=0;v<this.m_polyNodes.ChildCount();v++){var S=this.m_polyNodes.Childs()[v];this.m_srcPoly=S.m_polygon;var H=this.m_srcPoly.length;if(!(H==0||f<=0&&(H<3||S.m_endtype!=r.EndType.etClosedPolygon))){if(this.m_destPoly=new Array,H==1){if(S.m_jointype==r.JoinType.jtRound)for(var X=1,se=0,de=1;de<=F;de++){this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+X*f),r.ClipperOffset.Round(this.m_srcPoly[0].Y+se*f)));var Ee=X;X=X*this.m_cos-this.m_sin*se,se=Ee*this.m_sin+se*this.m_cos}else for(var X=-1,se=-1,de=0;de<4;++de)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+X*f),r.ClipperOffset.Round(this.m_srcPoly[0].Y+se*f))),X<0?X=1:se<0?se=1:X=-1;this.m_destPolys.push(this.m_destPoly);continue}this.m_normals.length=0;for(var de=0;de<H-1;de++)this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[de],this.m_srcPoly[de+1]));if(S.m_endtype==r.EndType.etClosedLine||S.m_endtype==r.EndType.etClosedPolygon?this.m_normals.push(r.ClipperOffset.GetUnitNormal(this.m_srcPoly[H-1],this.m_srcPoly[0])):this.m_normals.push(new r.DoublePoint(this.m_normals[H-2])),S.m_endtype==r.EndType.etClosedPolygon){for(var je=H-1,de=0;de<H;de++)je=this.OffsetPoint(de,je,S.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(S.m_endtype==r.EndType.etClosedLine){for(var je=H-1,de=0;de<H;de++)je=this.OffsetPoint(de,je,S.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var Ke=this.m_normals[H-1],de=H-1;de>0;de--)this.m_normals[de]=new r.DoublePoint(-this.m_normals[de-1].X,-this.m_normals[de-1].Y);this.m_normals[0]=new r.DoublePoint(-Ke.X,-Ke.Y),je=0;for(var de=H-1;de>=0;de--)je=this.OffsetPoint(de,je,S.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var je=0,de=1;de<H-1;++de)je=this.OffsetPoint(de,je,S.m_jointype);var mt;if(S.m_endtype==r.EndType.etOpenButt){var de=H-1;mt=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[de].X+this.m_normals[de].X*f),r.ClipperOffset.Round(this.m_srcPoly[de].Y+this.m_normals[de].Y*f)),this.m_destPoly.push(mt),mt=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[de].X-this.m_normals[de].X*f),r.ClipperOffset.Round(this.m_srcPoly[de].Y-this.m_normals[de].Y*f)),this.m_destPoly.push(mt)}else{var de=H-1;je=H-2,this.m_sinA=0,this.m_normals[de]=new r.DoublePoint(-this.m_normals[de].X,-this.m_normals[de].Y),S.m_endtype==r.EndType.etOpenSquare?this.DoSquare(de,je):this.DoRound(de,je)}for(var de=H-1;de>0;de--)this.m_normals[de]=new r.DoublePoint(-this.m_normals[de-1].X,-this.m_normals[de-1].Y);this.m_normals[0]=new r.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),je=H-1;for(var de=je-1;de>0;--de)je=this.OffsetPoint(de,je,S.m_jointype);S.m_endtype==r.EndType.etOpenButt?(mt=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*f),r.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*f)),this.m_destPoly.push(mt),mt=new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*f),r.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*f)),this.m_destPoly.push(mt)):(je=1,this.m_sinA=0,S.m_endtype==r.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}}},r.ClipperOffset.prototype.Execute=function(){var f=arguments,v=f[0]instanceof r.PolyTree;if(v){var S=f[0],I=f[1];S.Clear(),this.FixOrientations(),this.DoOffset(I);var F=new r.Clipper(0);if(F.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0),I>0)F.Execute(r.ClipType.ctUnion,S,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else{var H=r.Clipper.GetBounds(this.m_destPolys),X=new r.Path;if(X.push(new r.IntPoint(H.left-10,H.bottom+10)),X.push(new r.IntPoint(H.right+10,H.bottom+10)),X.push(new r.IntPoint(H.right+10,H.top-10)),X.push(new r.IntPoint(H.left-10,H.top-10)),F.AddPath(X,r.PolyType.ptSubject,!0),F.ReverseSolution=!0,F.Execute(r.ClipType.ctUnion,S,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative),S.ChildCount()==1&&S.Childs()[0].ChildCount()>0){var se=S.Childs()[0];S.Childs()[0]=se.Childs()[0];for(var de=1;de<se.ChildCount();de++)S.AddChild(se.Childs()[de])}else S.Clear()}}else{var S=f[0],I=f[1];r.Clear(S),this.FixOrientations(),this.DoOffset(I);var F=new r.Clipper(0);if(F.AddPaths(this.m_destPolys,r.PolyType.ptSubject,!0),I>0)F.Execute(r.ClipType.ctUnion,S,r.PolyFillType.pftPositive,r.PolyFillType.pftPositive);else{var H=r.Clipper.GetBounds(this.m_destPolys),X=new r.Path;X.push(new r.IntPoint(H.left-10,H.bottom+10)),X.push(new r.IntPoint(H.right+10,H.bottom+10)),X.push(new r.IntPoint(H.right+10,H.top-10)),X.push(new r.IntPoint(H.left-10,H.top-10)),F.AddPath(X,r.PolyType.ptSubject,!0),F.ReverseSolution=!0,F.Execute(r.ClipType.ctUnion,S,r.PolyFillType.pftNegative,r.PolyFillType.pftNegative),S.length>0&&S.splice(0,1)}}},r.ClipperOffset.prototype.OffsetPoint=function(f,v,S){if(this.m_sinA=this.m_normals[v].X*this.m_normals[f].Y-this.m_normals[f].X*this.m_normals[v].Y,this.m_sinA<5e-5&&this.m_sinA>-5e-5)return v;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_normals[v].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_normals[v].Y*this.m_delta))),this.m_destPoly.push(new r.IntPoint(this.m_srcPoly[f])),this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_normals[f].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_normals[f].Y*this.m_delta)));else switch(S){case r.JoinType.jtMiter:{var I=1+(this.m_normals[f].X*this.m_normals[v].X+this.m_normals[f].Y*this.m_normals[v].Y);I>=this.m_miterLim?this.DoMiter(f,v,I):this.DoSquare(f,v);break}case r.JoinType.jtSquare:this.DoSquare(f,v);break;case r.JoinType.jtRound:this.DoRound(f,v);break}return v=f,v},r.ClipperOffset.prototype.DoSquare=function(f,v){var S=Math.tan(Math.atan2(this.m_sinA,this.m_normals[v].X*this.m_normals[f].X+this.m_normals[v].Y*this.m_normals[f].Y)/4);this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_delta*(this.m_normals[v].X-this.m_normals[v].Y*S)),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_delta*(this.m_normals[v].Y+this.m_normals[v].X*S)))),this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_delta*(this.m_normals[f].X+this.m_normals[f].Y*S)),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_delta*(this.m_normals[f].Y-this.m_normals[f].X*S))))},r.ClipperOffset.prototype.DoMiter=function(f,v,S){var I=this.m_delta/S;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+(this.m_normals[v].X+this.m_normals[f].X)*I),r.ClipperOffset.Round(this.m_srcPoly[f].Y+(this.m_normals[v].Y+this.m_normals[f].Y)*I)))},r.ClipperOffset.prototype.DoRound=function(f,v){for(var S=Math.atan2(this.m_sinA,this.m_normals[v].X*this.m_normals[f].X+this.m_normals[v].Y*this.m_normals[f].Y),I=r.Cast_Int32(r.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(S))),F=this.m_normals[v].X,H=this.m_normals[v].Y,X,se=0;se<I;++se)this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+F*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[f].Y+H*this.m_delta))),X=F,F=F*this.m_cos-this.m_sin*H,H=X*this.m_sin+H*this.m_cos;this.m_destPoly.push(new r.IntPoint(r.ClipperOffset.Round(this.m_srcPoly[f].X+this.m_normals[f].X*this.m_delta),r.ClipperOffset.Round(this.m_srcPoly[f].Y+this.m_normals[f].Y*this.m_delta)))},r.Error=function(f){try{throw new Error(f)}catch(v){alert(v.message)}},r.JS={},r.JS.AreaOfPolygon=function(f,v){return v||(v=1),r.Clipper.Area(f)/(v*v)},r.JS.AreaOfPolygons=function(f,v){v||(v=1);for(var S=0,I=0;I<f.length;I++)S+=r.Clipper.Area(f[I]);return S/(v*v)},r.JS.BoundsOfPath=function(f,v){return r.JS.BoundsOfPaths([f],v)},r.JS.BoundsOfPaths=function(f,v){v||(v=1);var S=r.Clipper.GetBounds(f);return S.left/=v,S.bottom/=v,S.right/=v,S.top/=v,S},r.JS.Clean=function(I,v){if(!(I instanceof Array))return[];var S=I[0]instanceof Array,I=r.JS.Clone(I);if(typeof v!="number"||v===null)return r.Error("Delta is not a number in Clean()."),I;if(I.length===0||I.length==1&&I[0].length===0||v<0)return I;S||(I=[I]);for(var F=I.length,H,X,se,de,Ee,je,Ke,mt=[],Lt=0;Lt<F;Lt++)if(X=I[Lt],H=X.length,H!==0){if(H<3){se=X,mt.push(se);continue}for(se=X,de=v*v,Ee=X[0],je=1,Ke=1;Ke<H;Ke++)(X[Ke].X-Ee.X)*(X[Ke].X-Ee.X)+(X[Ke].Y-Ee.Y)*(X[Ke].Y-Ee.Y)<=de||(se[je]=X[Ke],Ee=X[Ke],je++);Ee=X[je-1],(X[0].X-Ee.X)*(X[0].X-Ee.X)+(X[0].Y-Ee.Y)*(X[0].Y-Ee.Y)<=de&&je--,je<H&&se.splice(je,H-je),se.length&&mt.push(se)}return!S&&mt.length?mt=mt[0]:!S&&mt.length===0?mt=[]:S&&mt.length===0&&(mt=[[]]),mt},r.JS.Clone=function(f){if(!(f instanceof Array))return[];if(f.length===0)return[];if(f.length==1&&f[0].length===0)return[[]];var v=f[0]instanceof Array;v||(f=[f]);var S=f.length,I,F,H,X,se=new Array(S);for(F=0;F<S;F++){for(I=f[F].length,X=new Array(I),H=0;H<I;H++)X[H]={X:f[F][H].X,Y:f[F][H].Y};se[F]=X}return v||(se=se[0]),se},r.JS.Lighten=function(f,v){if(!(f instanceof Array))return[];if(typeof v!="number"||v===null)return r.Error("Tolerance is not a number in Lighten()."),r.JS.Clone(f);if(f.length===0||f.length==1&&f[0].length===0||v<0)return r.JS.Clone(f);f[0]instanceof Array||(f=[f]);var S,I,F,H,X,se,de,Ee,je,Ke,mt,Lt,Tt,qt,ki,Fr,xn,zg=f.length,Ng=v*v,Qa=[];for(S=0;S<zg;S++)if(F=f[S],se=F.length,se!=0){for(H=0;H<1e6;H++){for(X=[],se=F.length,F[se-1].X!=F[0].X||F[se-1].Y!=F[0].Y?(Lt=1,F.push({X:F[0].X,Y:F[0].Y}),se=F.length):Lt=0,mt=[],I=0;I<se-2;I++)de=F[I],je=F[I+1],Ee=F[I+2],Fr=de.X,xn=de.Y,Tt=Ee.X-Fr,qt=Ee.Y-xn,(Tt!==0||qt!==0)&&(ki=((je.X-Fr)*Tt+(je.Y-xn)*qt)/(Tt*Tt+qt*qt),ki>1?(Fr=Ee.X,xn=Ee.Y):ki>0&&(Fr+=Tt*ki,xn+=qt*ki)),Tt=je.X-Fr,qt=je.Y-xn,Ke=Tt*Tt+qt*qt,Ke<=Ng&&(mt[I+1]=1,I++);for(X.push({X:F[0].X,Y:F[0].Y}),I=1;I<se-1;I++)mt[I]||X.push({X:F[I].X,Y:F[I].Y});if(X.push({X:F[se-1].X,Y:F[se-1].Y}),Lt&&F.pop(),mt.length)F=X;else break}se=X.length,X[se-1].X==X[0].X&&X[se-1].Y==X[0].Y&&X.pop(),X.length>2&&Qa.push(X)}return!f[0]instanceof Array&&(Qa=Qa[0]),typeof Qa>"u"&&(Qa=[[]]),Qa},r.JS.PerimeterOfPath=function(f,v,S){if(typeof f>"u")return 0;var I=Math.sqrt,F=0,H,X,se=0,de=0,Ee=0,je=0,Ke=f.length;if(Ke<2)return 0;for(v&&(f[Ke]=f[0],Ke++);--Ke;)H=f[Ke],se=H.X,de=H.Y,X=f[Ke-1],Ee=X.X,je=X.Y,F+=I((se-Ee)*(se-Ee)+(de-je)*(de-je));return v&&f.pop(),F/S},r.JS.PerimeterOfPaths=function(f,v,S){S||(S=1);for(var I=0,F=0;F<f.length;F++)I+=r.JS.PerimeterOfPath(f[F],v,S);return I},r.JS.ScaleDownPath=function(f,v){var S,I;for(v||(v=1),S=f.length;S--;)I=f[S],I.X=I.X/v,I.Y=I.Y/v},r.JS.ScaleDownPaths=function(f,v){var S,I,F;for(v||(v=1),S=f.length;S--;)for(I=f[S].length;I--;)F=f[S][I],F.X=F.X/v,F.Y=F.Y/v},r.JS.ScaleUpPath=function(f,v){var S,I,F=Math.round;for(v||(v=1),S=f.length;S--;)I=f[S],I.X=F(I.X*v),I.Y=F(I.Y*v)},r.JS.ScaleUpPaths=function(f,v){var S,I,F,H=Math.round;for(v||(v=1),S=f.length;S--;)for(I=f[S].length;I--;)F=f[S][I],F.X=H(F.X*v),F.Y=H(F.Y*v)},r.ExPolygons=function(){return[]},r.ExPolygon=function(){this.outer=null,this.holes=null},r.JS.AddOuterPolyNodeToExPolygons=function(f,v){var S=new r.ExPolygon;S.outer=f.Contour();var I=f.Childs(),F=I.length;S.holes=new Array(F);var H,X,se,de,Ee,je;for(se=0;se<F;se++)for(H=I[se],S.holes[se]=H.Contour(),de=0,Ee=H.Childs(),je=Ee.length;de<je;de++)X=Ee[de],r.JS.AddOuterPolyNodeToExPolygons(X,v);v.push(S)},r.JS.ExPolygonsToPaths=function(f){var v,S,I,F,H=new r.Paths;for(v=0,I=f.length;v<I;v++)for(H.push(f[v].outer),S=0,F=f[v].holes.length;S<F;S++)H.push(f[v].holes[S]);return H},r.JS.PolyTreeToExPolygons=function(f){var v=new r.ExPolygons,S,I,F,H;for(I=0,F=f.Childs(),H=F.length;I<H;I++)S=F[I],r.JS.AddOuterPolyNodeToExPolygons(S,v);return v},e.exports=r}),Nbe={};_h(Nbe,{Annotation:()=>JT,Connection:()=>N_,Coordinate:()=>br,Door:()=>B_,E_SDK_LOG_LEVEL:()=>aQ,Floor:()=>z_,Hyperlink:()=>HQ,Image:()=>QQ,MapObject:()=>yh,PointOfInterest:()=>$_,Space:()=>gh,analytics:()=>KSe,createMapLibreOverlay:()=>gMe,enableTestMode:()=>cte,getMapData:()=>Wre,getMapDataEnterprise:()=>jre,hydrateMapDataFromMVF:()=>mMe,parseMVF:()=>k_,setLoggerLevel:()=>oQ,setUseEnterpriseAPI:()=>Gre,show3dMap:()=>qre,show3dMapGeojson:()=>Xre,unzipMVF:()=>R_});R();R();var VS=new WeakMap,Sn,nQ=class{constructor(e){fe(this,Sn,void 0),Re(this,Sn,e),VS.set(this,e)}get mapName(){return M(this,Sn).mapName}get mapCenter(){return M(this,Sn).mapCenter}get organizationId(){return M(this,Sn).organizationId}get outdoorViewToken(){return M(this,Sn).outdoorViewToken}getByType(e){switch(e){case"space":return M(this,Sn).spaces;case"door":return M(this,Sn).doors;case"floor":return M(this,Sn).floors;case"connection":return M(this,Sn).connections;case"object":return M(this,Sn).objects;case"point-of-interest":return M(this,Sn).pointsOfInterest;case"annotation":return M(this,Sn).annotations;default:return[]}}getById(e,t){return M(this,Sn).getById(e,t)}};Sn=new WeakMap,h(nQ,"MapData");var $be=nQ,XT=$be;R();R();R();var aQ=(i=>(i[i.LOG=0]="LOG",i[i.WARN=1]="WARN",i[i.ERROR=2]="ERROR",i[i.SILENT=3]="SILENT",i))(aQ||{});function oQ(i){0<=i&&i<=3&&(sQ.logState=i)}h(oQ,"setLoggerLevel");var sQ={logState:dr.env.NODE_ENV==="test"?3:0,log(...i){this.logState<=0&&console.log("[MappedinJS]",...i)},warn(...i){this.logState<=1&&console.warn("[MappedinJS]",...i)},error(...i){this.logState<=2&&console.error("[MappedinJS]",...i)},assert(...i){console.assert(...i)},time(i){console.time(i)},timeEnd(i){console.timeEnd(i)}},Bt=sQ,_8=globalThis.fetch,b8,Ube=(b8=dr==null?void 0:dr.env)==null?void 0:b8.npm_package_version,lQ="https://app.mappedin.com/";function Pd(){if(_8==null)throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return _8}h(Pd,"isomorphicFetch");var uQ={supplementaryUrl:"https://api-gateway.mappedin.com/analytics/",headers:{},accessToken:"",clientId:"",noAuth:!1,includeHidden:!0,clientSecret:"",apiGateway:"",authorization:"",perspective:"Website",language:"",venue:""};function hQ(i){var e;let t={...uQ,...i};return t.headers={...t.headers,"mappedin-sdk-version":Ube},t.things=[],"platformString"in i&&(t.headers={...t.headers,"mappedin-platform-version":i.platformString}),t.noAuth||(t.accessToken?t.authorization=`Bearer ${t.accessToken}`:t.clientId&&t.clientSecret&&(t.authorization=`Basic ${globalThis.btoa(`${t.clientId}:${t.clientSecret}`)}`)),t.language=(e=t.language)==null?void 0:e.toLowerCase(),t}h(hQ,"parseOptions");function cQ(i,e,t=!1){let r={language:i.language,clientId:i.clientId,clientSecret:i.clientSecret};t&&delete r.language,r.language&&(e+=`&lang=${encodeURIComponent(r.language)}`);let{headers:n}=i;n["Content-Type"]=n["Content-Type"]||"text/json",i.accessToken?n.Authorization=`Bearer ${i.accessToken}`:i.noAuth||i.clientId&&i.clientSecret&&(n["x-mappedin-key"]=btoa(i.clientId),n["x-mappedin-secret"]=btoa(i.clientSecret)),r.language&&(n["Accept-Language"]=r.language);let a={method:"GET",headers:n};return i.secure&&(e+="&withcdntoken"),{req:a,url:e}}h(cQ,"constructParamsForRequest");async function pQ(i,e,t=!1){let r=cQ(i,e,t),n=await Pd()(r.url,r.req);if(!n.ok)throw new Error(`${n.status} ${n.statusText}`);return n.json()}h(pQ,"generateAPIRequest");async function dQ(i,e="exports/mvf/1/bundle"){var t;let r=hQ({baseUri:"https://api-gateway.mappedin.com/",...uQ,...i}),n=`${r.baseUri+e}?venue=${r.venue}&version=${(t=r.version)!=null?t:"2.0.0"}`;return r.headers["Content-Type"]="application/zip",await pQ(r,n)}h(dQ,"getVenueMVFURL");async function fQ(i){return new Promise(async(e,t)=>{try{let{url:r}=await dQ(i,"exports/mvf2/1/bundle"),n=await Pd()(r).then(o=>o.arrayBuffer()),a=new Uint8Array(n);e(a)}catch(r){t(r)}})}h(fQ,"downloadVenueBundleMVFAPIGateway");async function mQ(i,e){return new Promise(async(t,r)=>{try{let{url:n}=await gQ(i,e),a=await Pd()(n).then(s=>s.arrayBuffer()),o=new Uint8Array(a);t(o)}catch(n){r(n)}})}h(mQ,"downloadMVF");function qT(i){return i.endsWith("/")?i:`${i}/`}h(qT,"normalizeUrl");async function gQ(i,e){let t=`${i.baseUri?qT(i.baseUri):lQ}api/venue/${i.mapId}/mvf${i.viewId?`?configId=${i.viewId}`:""}`,r=await Pd()(t,{headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw new Error(`${r.status} ${r.statusText}`);return r.json()}h(gQ,"getMakerBundleURL");async function ZT(i){let e=`${i.baseUri?qT(i.baseUri):lQ}api/api-key/token`,t=await Pd()(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:i.key,secret:i.secret})});if(!t.ok)throw new Error(`${t.status} ${t.statusText}`);return t.json()}h(ZT,"getAccessToken");function k_(i){let e=new TextDecoder,t=e.decode.bind(e);try{let r={"connection.json":JSON.parse(t(i["connection.json"])),"manifest.geojson":JSON.parse(t(i["manifest.geojson"])),"map.geojson":JSON.parse(t(i["map.geojson"])),"mapstack.geojson":i["mapstack.geojson"]?JSON.parse(t(i["mapstack.geojson"])):void 0,"node.geojson":JSON.parse(t(i["node.geojson"])),obstruction:{},space:{},entrance:{}};if((r["mapstack.geojson"]==null||"mapstack.json"in i)&&(r["mapstack.json"]=JSON.parse(t(i["mapstack.json"]))),"styles.json"in i&&(r["styles.json"]=JSON.parse(t(i["styles.json"]))),"shapes.json"in i&&(r["shapes.json"]=JSON.parse(t(i["shapes.json"]))),i.annotation!=null){r.annotation={};let a=Object.keys(i.annotation);for(let o of a){let s=o.replace(/\.json|\.geojson/g,"");r.annotation[s]=JSON.parse(t(i.annotation[o]))}}let n=Object.keys(i.space);for(let a of n){let o=a.replace(/\.json|\.geojson/g,"");r.space[o]=JSON.parse(t(i.space[a]))}if(i.obstruction!=null){let a=Object.keys(i.obstruction);for(let o of a){let s=o.replace(/\.json|\.geojson/g,"");r.obstruction[s]=JSON.parse(t(i.obstruction[o]))}}else r.obstruction={};if(i.entrance!=null){let a=Object.keys(i.entrance);for(let o of a){let s=o.replace(/\.json|\.geojson/g,"");r.entrance[s]=JSON.parse(t(i.entrance[o]))}}else r.entrance={};return r}catch(r){throw Bt.error(r),new Error("MVF parsing failed! Probably encountered a bad file.")}}h(k_,"parseMVF");function yQ(i){if(i==null||typeof i!="object")return!1;let e=["connection.json","manifest.geojson","map.geojson","node.geojson","mapstack.json"in i?"mapstack.json":"mapstack.geojson"];"styles.json"in i&&e.push("styles.json"),"shapes.json"in i&&e.push("shapes.json");for(let t of e)if(i[t]==null||i[t][Symbol.toStringTag]!=="Uint8Array")return!1;return!0}h(yQ,"validateStaticMVFFiles");async function R_(i){return new Promise(async(e,t)=>{try{if(i==null||typeof i!="object")throw new Error("Error parsing data! Unzipping failed.");if(i[Symbol.toStringTag]!=="Uint8Array")throw new Error("Unexpected file type! Unzipping failed.");let r=(await lg(async()=>{const{unzipSync:o}=await import("./browser-VJJYXKCR-BduVXZdK.js");return{unzipSync:o}},[])).unzipSync(i);if(!yQ(r))throw new Error("MVF is missing some expect static files. Unzipping failed.");let n={},a=Object.keys(r);for(let o of a){if(r[o].length===0)continue;let s=o.split("/");if(s.length<0)throw new Error("Encounted a file with no name! Unzipping failed.");if(s.length>2)throw new Error("Encountered unexpected nesting in MVF! Unzipping failed.");if(s.length===1){n[s[0]]=r[o];continue}if(s[0]==="image"){Bt.warn("MVF unzipping encountered an image. Ignoring as this case has not been implemented.");continue}else n[s[0]]==null&&(n[s[0]]={}),n[s[0]][s[1]]=r[o]}e(n)}catch(r){t(r)}})}h(R_,"unzipMVF");R();R();R();R();var Fn=63710088e-1,vQ={centimeters:Fn*100,centimetres:Fn*100,degrees:Fn/111325,feet:Fn*3.28084,inches:Fn*39.37,kilometers:Fn/1e3,kilometres:Fn/1e3,meters:Fn,metres:Fn,miles:Fn/1609.344,millimeters:Fn*1e3,millimetres:Fn*1e3,nauticalmiles:Fn/1852,radians:1,yards:Fn*1.0936};function mh(i,e,t){t===void 0&&(t={});var r={type:"Feature"};return(t.id===0||t.id)&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.properties=e||{},r.geometry=i,r}h(mh,"feature");function Ku(i,e,t){if(t===void 0&&(t={}),!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!jS(i[0])||!jS(i[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:i};return mh(r,e,t)}h(Ku,"point");function ld(i,e,t){if(t===void 0&&(t={}),i.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:i};return mh(r,e,t)}h(ld,"lineString");function sx(i,e){e===void 0&&(e={});var t={type:"FeatureCollection"};return e.id&&(t.id=e.id),e.bbox&&(t.bbox=e.bbox),t.features=i,t}h(sx,"featureCollection");function xQ(i,e){e===void 0&&(e="kilometers");var t=vQ[e];if(!t)throw new Error(e+" units is invalid");return i*t}h(xQ,"radiansToLength");function _Q(i,e){e===void 0&&(e="kilometers");var t=vQ[e];if(!t)throw new Error(e+" units is invalid");return i/t}h(_Q,"lengthToRadians");function lx(i){var e=i%(2*Math.PI);return e*180/Math.PI}h(lx,"radiansToDegrees");function Va(i){var e=i%360;return e*Math.PI/180}h(Va,"degreesToRadians");function jS(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}h(jS,"isNumber");function Zl(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return i.geometry.coordinates;if(i.type==="Point")return i.coordinates}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return i;throw new Error("coord must be GeoJSON Point or an Array of numbers")}h(Zl,"getCoord");function $s(i){if(Array.isArray(i))return i;if(i.type==="Feature"){if(i.geometry!==null)return i.geometry.coordinates}else if(i.coordinates)return i.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}h($s,"getCoords");function bQ(i){return i.type==="Feature"?i.geometry:i}h(bQ,"getGeom");function wQ(i,e){return i.type==="FeatureCollection"?"FeatureCollection":i.type==="GeometryCollection"?"GeometryCollection":i.type==="Feature"&&i.geometry!==null?i.geometry.type:i.type}h(wQ,"getType");function SQ(i,e,t){t===void 0&&(t={});for(var r=Zl(i),n=$s(e),a=0;a<n.length-1;a++){var o=!1;if(t.ignoreEndVertices&&(a===0&&(o="start"),a===n.length-2&&(o="end"),a===0&&a+1===n.length-1&&(o="both")),MQ(n[a],n[a+1],r,o,typeof t.epsilon>"u"?null:t.epsilon))return!0}return!1}h(SQ,"booleanPointOnLine");function MQ(i,e,t,r,n){var a=t[0],o=t[1],s=i[0],l=i[1],u=e[0],c=e[1],p=t[0]-s,d=t[1]-l,m=u-s,g=c-l,_=p*g-d*m;if(n!==null){if(Math.abs(_)>n)return!1}else if(_!==0)return!1;if(r){if(r==="start")return Math.abs(m)>=Math.abs(g)?m>0?s<a&&a<=u:u<=a&&a<s:g>0?l<o&&o<=c:c<=o&&o<l;if(r==="end")return Math.abs(m)>=Math.abs(g)?m>0?s<=a&&a<u:u<a&&a<=s:g>0?l<=o&&o<c:c<o&&o<=l;if(r==="both")return Math.abs(m)>=Math.abs(g)?m>0?s<a&&a<u:u<a&&a<s:g>0?l<o&&o<c:c<o&&o<l}else return Math.abs(m)>=Math.abs(g)?m>0?s<=a&&a<=u:u<=a&&a<=s:g>0?l<=o&&o<=c:c<=o&&o<=l;return!1}h(MQ,"isPointOnLineSegment");var Vbe=SQ;R();R();R();function F_(i,e,t){if(i!==null)for(var r,n,a,o,s,l,u,c=0,p=0,d,m=i.type,g=m==="FeatureCollection",_=m==="Feature",y=g?i.features.length:1,x=0;x<y;x++){u=g?i.features[x].geometry:_?i.geometry:i,d=u?u.type==="GeometryCollection":!1,s=d?u.geometries.length:1;for(var w=0;w<s;w++){var b=0,C=0;if(o=d?u.geometries[w]:u,o!==null){l=o.coordinates;var E=o.type;switch(c=t&&(E==="Polygon"||E==="MultiPolygon")?1:0,E){case null:break;case"Point":if(e(l,p,x,b,C)===!1)return!1;p++,b++;break;case"LineString":case"MultiPoint":for(r=0;r<l.length;r++){if(e(l[r],p,x,b,C)===!1)return!1;p++,E==="MultiPoint"&&b++}E==="LineString"&&b++;break;case"Polygon":case"MultiLineString":for(r=0;r<l.length;r++){for(n=0;n<l[r].length-c;n++){if(e(l[r][n],p,x,b,C)===!1)return!1;p++}E==="MultiLineString"&&b++,E==="Polygon"&&C++}E==="Polygon"&&b++;break;case"MultiPolygon":for(r=0;r<l.length;r++){for(C=0,n=0;n<l[r].length;n++){for(a=0;a<l[r][n].length-c;a++){if(e(l[r][n][a],p,x,b,C)===!1)return!1;p++}C++}b++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(F_(o.geometries[r],e,t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}h(F_,"coordEach");function HS(i,e){if(i.type==="Feature")e(i,0);else if(i.type==="FeatureCollection")for(var t=0;t<i.features.length&&e(i.features[t],t)!==!1;t++);}h(HS,"featureEach");function CQ(i,e){var t,r,n,a,o,s,l,u,c,p,d=0,m=i.type==="FeatureCollection",g=i.type==="Feature",_=m?i.features.length:1;for(t=0;t<_;t++){for(s=m?i.features[t].geometry:g?i.geometry:i,u=m?i.features[t].properties:g?i.properties:{},c=m?i.features[t].bbox:g?i.bbox:void 0,p=m?i.features[t].id:g?i.id:void 0,l=s?s.type==="GeometryCollection":!1,o=l?s.geometries.length:1,n=0;n<o;n++){if(a=l?s.geometries[n]:s,a===null){if(e(null,d,u,c,p)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(a,d,u,c,p)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<a.geometries.length;r++)if(e(a.geometries[r],d,u,c,p)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}d++}}h(CQ,"geomEach");function O_(i,e){CQ(i,function(t,r,n,a,o){var s=t===null?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(mh(t,n,{bbox:a,id:o}),r,0)===!1?!1:void 0}var l;switch(s){case"MultiPoint":l="Point";break;case"MultiLineString":l="LineString";break;case"MultiPolygon":l="Polygon";break}for(var u=0;u<t.coordinates.length;u++){var c=t.coordinates[u],p={type:l,coordinates:c};if(e(mh(p,n),r,u)===!1)return!1}})}h(O_,"flattenEach");function EQ(i,e){O_(i,function(t,r,n){var a=0;if(t.geometry){var o=t.geometry.type;if(!(o==="Point"||o==="MultiPoint")){var s,l=0,u=0,c=0;if(F_(t,function(p,d,m,g,_){if(s===void 0||r>l||g>u||_>c){s=p,l=r,u=g,c=_,a=0;return}var y=ld([s,p],t.properties);if(e(y,r,n,_,a)===!1)return!1;a++,s=p})===!1)return!1}}})}h(EQ,"segmentEach");function TQ(i,e,t){var r=t,n=!1;return EQ(i,function(a,o,s,l,u){n===!1&&t===void 0?r=a:r=e(r,a,o,s,l,u),n=!0}),r}h(TQ,"segmentReduce");function ux(i){var e=[1/0,1/0,-1/0,-1/0];return F_(i,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}h(ux,"bbox");ux.default=ux;var PQ=ux;function AQ(i,e){e===void 0&&(e={});var t=PQ(i),r=(t[0]+t[2])/2,n=(t[1]+t[3])/2;return Ku([r,n],e.properties,e)}h(AQ,"center");var jbe=AQ;R();R();function IQ(i,e,t){t===void 0&&(t={});var r=Zl(i),n=Zl(e),a=Va(n[1]-r[1]),o=Va(n[0]-r[0]),s=Va(r[1]),l=Va(n[1]),u=Math.pow(Math.sin(a/2),2)+Math.pow(Math.sin(o/2),2)*Math.cos(s)*Math.cos(l);return xQ(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),t.units)}h(IQ,"distance");var gc=IQ;function GS(i,e){return e===void 0&&(e={}),TQ(i,function(t,r){var n=r.geometry.coordinates;return t+gc(n[0],n[1],e)},0)}h(GS,"length");R();R();R();function YT(i,e,t){if(t===void 0&&(t={}),t.final===!0)return LQ(i,e);var r=Zl(i),n=Zl(e),a=Va(r[0]),o=Va(n[0]),s=Va(r[1]),l=Va(n[1]),u=Math.sin(o-a)*Math.cos(l),c=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(o-a);return lx(Math.atan2(u,c))}h(YT,"bearing");function LQ(i,e){var t=YT(e,i);return t=(t+180)%360,t}h(LQ,"calculateFinalBearing");R();function Qm(i,e,t,r){r===void 0&&(r={});var n=Zl(i),a=Va(n[0]),o=Va(n[1]),s=Va(t),l=_Q(e,r.units),u=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(s)),c=a+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(u)),p=lx(c),d=lx(u);return Ku([p,d],r.properties)}h(Qm,"destination");R();R();function DQ(i){if(!i)throw new Error("geojson is required");var e=[];return O_(i,function(t){kQ(t,e)}),sx(e)}h(DQ,"lineSegment");function kQ(i,e){var t=[],r=i.geometry;if(r!==null){switch(r.type){case"Polygon":t=$s(r);break;case"LineString":t=[$s(r)]}t.forEach(function(n){var a=RQ(n,i.properties);a.forEach(function(o){o.id=e.length,e.push(o)})})}}h(kQ,"lineSegmentFeature");function RQ(i,e){var t=[];return i.reduce(function(r,n){var a=ld([r,n],e);return a.bbox=FQ(r,n),t.push(a),n}),t}h(RQ,"createSegments");function FQ(i,e){var t=i[0],r=i[1],n=e[0],a=e[1],o=t<n?t:n,s=r<a?r:a,l=t>n?t:n,u=r>a?r:a;return[o,s,l,u]}h(FQ,"bbox");var w8=DQ,Hbe=kt(Obe(),1);function OQ(i,e){var t={},r=[];if(i.type==="LineString"&&(i=mh(i)),e.type==="LineString"&&(e=mh(e)),i.type==="Feature"&&e.type==="Feature"&&i.geometry!==null&&e.geometry!==null&&i.geometry.type==="LineString"&&e.geometry.type==="LineString"&&i.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var n=WS(i,e);return n&&r.push(n),sx(r)}var a=(0,Hbe.default)();return a.load(w8(e)),HS(w8(i),function(o){HS(a.search(o),function(s){var l=WS(o,s);if(l){var u=$s(l).join(",");t[u]||(t[u]=!0,r.push(l))}})}),sx(r)}h(OQ,"lineIntersect");function WS(i,e){var t=$s(i),r=$s(e);if(t.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var n=t[0][0],a=t[0][1],o=t[1][0],s=t[1][1],l=r[0][0],u=r[0][1],c=r[1][0],p=r[1][1],d=(p-u)*(o-n)-(c-l)*(s-a),m=(c-l)*(a-u)-(p-u)*(n-l),g=(o-n)*(a-u)-(s-a)*(n-l);if(d===0)return null;var _=m/d,y=g/d;if(_>=0&&_<=1&&y>=0&&y<=1){var x=n+_*(o-n),w=a+_*(s-a);return Ku([x,w])}return null}h(WS,"intersects");var Gbe=OQ;function BQ(i,e,t){t===void 0&&(t={});var r=Ku([1/0,1/0],{dist:1/0}),n=0;return O_(i,function(a){for(var o=$s(a),s=0;s<o.length-1;s++){var l=Ku(o[s]);l.properties.dist=gc(e,l,t);var u=Ku(o[s+1]);u.properties.dist=gc(e,u,t);var c=gc(l,u,t),p=Math.max(l.properties.dist,u.properties.dist),d=YT(l,u),m=Qm(e,p,d+90,t),g=Qm(e,p,d-90,t),_=Gbe(ld([m.geometry.coordinates,g.geometry.coordinates]),ld([l.geometry.coordinates,u.geometry.coordinates])),y=null;_.features.length>0&&(y=_.features[0],y.properties.dist=gc(e,y,t),y.properties.location=n+gc(l,y,t)),l.properties.dist<r.properties.dist&&(r=l,r.properties.index=s,r.properties.location=n),u.properties.dist<r.properties.dist&&(r=u,r.properties.index=s+1,r.properties.location=n+c),y&&y.properties.dist<r.properties.dist&&(r=y,r.properties.index=s),n+=c}}),r}h(BQ,"nearestPointOnLine");var XS=BQ;function zQ(i,e,t){var r=$s(t);if(wQ(t)!=="LineString")throw new Error("line must be a LineString");var n=XS(t,i),a=XS(t,e),o;n.properties.index<=a.properties.index?o=[n,a]:o=[a,n];for(var s=[o[0].geometry.coordinates],l=o[0].properties.index+1;l<o[1].properties.index+1;l++)s.push(r[l]);return s.push(o[1].geometry.coordinates),ld(s,t.properties)}h(zQ,"lineSlice");var S8=zQ,Wbe=1e-7;function Ky(i){return{type:"Point",coordinates:i}}h(Ky,"point");function NQ(i,e){let{coordinates:t}=e.geometry,{coordinates:r}=i.geometry,n=t.map(a=>XS(i,Ky(a)));return r.reduce((a,o)=>{let s=S8(Ky(o),n[0],i),l=S8(Ky(o),n[1],i),u=GS(s)<GS(l)?s:l;return u.properties={...i.properties,entrances:[]},a.concat([u])},[])}h(NQ,"splitObstructionByEntrance");function $Q(i,e){return e.reduce((t,r)=>{let n={epsilon:Wbe},a=t.findIndex(s=>Vbe(jbe(r),s,n)),o=t[a];if(o){let[s,l]=NQ(o,r);t.splice(a,1,s,l)}return t},[i])}h($Q,"splitObstructionByAllEntrances");R();R();R();R();var Ab=[0,4,6,8,10],Ar=h(()=>{let i=new Array(16).fill(0),e=Math.random()*4294967296;for(let r=0;r<i.length;r++)r>0&&!(r&3)&&(e=Math.random()*4294967296),i[r]=e>>>((r&3)<<3)&255;let t=i.map(r=>r.toString(16).padStart(2,"0"));return t[6]="4"+t[6][1],t[8]=["8","9","a","b"].includes(t[7][0])?t[7]:"a"+t[7][1],Ab.map((r,n)=>t.slice(r,n===Ab.length-1?void 0:Ab[n+1]).join("")).join("-")},"randomId"),qS=class ZS{constructor(e,t,r){Z(this,"__type",ZS.__type);Z(this,"id",Ar());Z(this,"latitude");Z(this,"longitude");Z(this,"floorId");this.latitude=e,this.longitude=t,this.floorId=r}static is(e){return e.__type===ZS.__type}isEqual(e){return this.latitude===e.latitude&&this.longitude===e.longitude&&this.floorId===e.floorId}toJSON(){return{latitude:this.latitude,longitude:this.longitude,floor:this.floorId}}destroy(){}};h(qS,"Coordinate"),ie(qS,"__type","coordinate");var Xbe=qS,br=Xbe;R();R();R();R();var UQ=class{constructor(e){Z(this,"id");this.id=e}};h(UQ,"BaseMetaData");var VQ=UQ,Qy,kf,YS=class jQ extends VQ{constructor(e){super(String(Ar())),fe(this,Qy,{}),fe(this,kf,void 0),Re(this,kf,e.mvfData)}static is(e){return e.__type===jQ.__type}get url(){return M(this,kf).url}get name(){return M(this,kf).displayName}toJSON(){return{id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(M(this,Qy)))delete M(this,Qy)[e]}};Qy=new WeakMap,kf=new WeakMap,h(YS,"Hyperlink"),ie(YS,"__type","hyperlink");var qbe=YS,HQ=qbe,GQ=class{constructor(e,t){Z(this,"id");Z(this,"links",[]);var r;this.id=e;let n=(r=t==null?void 0:t.links)!=null?r:[];n.length>0&&(this.links=n.map(a=>new HQ({mvfData:a})))}};h(GQ,"BaseMapData");var nu=GQ,yc,sl,vc,xu,JS=class KS extends nu{constructor(e,t){super(t.mvfData.properties.id,t.mvfData.properties.details),ie(this,"__type",KS.__type),fe(this,yc,void 0),fe(this,sl,void 0),fe(this,vc,void 0),fe(this,xu,void 0),Re(this,sl,{}),Re(this,xu,t.mvfData),Re(this,yc,e),Re(this,vc,t.floorId)}static is(e){return e.__type===KS.__type}get name(){var e,t;return(t=(e=M(this,xu).properties.details)==null?void 0:e.name)!=null?t:""}get description(){var e,t;return(t=(e=M(this,xu).properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;return(t=(e=M(this,xu).properties.details)==null?void 0:e.images)!=null?t:[]}get floor(){let e=M(this,yc).getById("floor",M(this,vc));if(e==null)throw new Error(`Floor ${M(this,vc)} not found!`);return e}get center(){if(M(this,sl).center==null){let[[e,t],[r,n]]=M(this,xu).geometry.coordinates,a=(e+r)/2,o=(t+n)/2;M(this,sl).center=new br(o,a,M(this,vc))}return M(this,sl).center}get isExterior(){var e;let t=M(this,yc).obstructionIdByEntranceId[this.id],r=M(this,yc).getMVFFeatureById("obstruction",t);return(e=r==null?void 0:r.properties.footprintComponent)!=null?e:!1}toJSON(){return{id:this.id,name:this.name,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(M(this,sl)))delete M(this,sl)[e]}};yc=new WeakMap,sl=new WeakMap,vc=new WeakMap,xu=new WeakMap,h(JS,"Door"),ie(JS,"__type","door");var Zbe=JS,B_=Zbe;R();var Rf,xc,_u,gs,QS=class eM extends nu{constructor(e,t){super(t.mvfData.properties.id,t.mvfData.properties.details),ie(this,"__type",eM.__type),fe(this,Rf,void 0),fe(this,xc,void 0),fe(this,_u,{}),fe(this,gs,void 0),Re(this,Rf,e),Re(this,xc,t.floorId),Re(this,gs,t.mvfData)}static is(e){return e.__type===eM.__type}get name(){var e,t;let{properties:r}=M(this,gs);return(t=(e=r.details)==null?void 0:e.name)!=null?t:r.externalId}get type(){return WQ(M(this,gs).properties.kind)}get description(){var e,t;return(t=(e=M(this,gs).properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;return(t=(e=M(this,gs).properties.details)==null?void 0:e.images)!=null?t:[]}get floor(){let e=M(this,Rf).getById("floor",M(this,xc));if(e==null)throw new Error(`Floor ${M(this,xc)} not found!`);return e}get doors(){return M(this,gs).properties.destinationNodes.reduce((e,t)=>{let r=M(this,Rf).doorsByNodeId[t];return r&&e.push(r),e},[])}get center(){var e;if(M(this,_u).center==null){let[t,r]=(e=M(this,gs).properties.center)!=null?e:[0,0];M(this,_u).center=new br(r,t,M(this,xc))}return M(this,_u).center}toJSON(){return{id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of Object.keys(M(this,_u)))delete M(this,_u)[e]}};Rf=new WeakMap,xc=new WeakMap,_u=new WeakMap,gs=new WeakMap,h(QS,"Space"),ie(QS,"__type","space");var Ybe=QS,Jbe=["room","hallway","exterior","void","connection.stairs","connection.elevator","poi"];function WQ(i){if(i==null||i==="default")return"room";let e=i.toLowerCase();return Jbe.includes(e)?e:"room"}h(WQ,"validateSpaceType");var gh=Ybe;R();var ys,ur,Ff,tM=class iM extends nu{constructor(e,t){super(t.mvfData.id),ie(this,"__type",iM.__type),fe(this,ys,void 0),fe(this,ur,{}),fe(this,Ff,void 0),Re(this,ys,e),Re(this,Ff,t.mvfData)}static is(e){return e.__type===iM.__type}get name(){return M(this,Ff).externalId}get elevation(){return M(this,Ff).elevation}get spaces(){if(M(this,ur).spaces==null){let e=M(this,ys).spaces.filter(t=>t.floor.id===this.id);M(this,ur).spaces=e}return M(this,ur).spaces}get objects(){if(M(this,ur).objects==null){let e=M(this,ys).objects.filter(t=>t.floor.id===this.id);M(this,ur).objects=e}return M(this,ur).objects}get connections(){if(M(this,ur).connections==null){let e=M(this,ys).connections.filter(t=>t.floors.includes(this));M(this,ur).connections=e}return M(this,ur).connections}get doors(){if(M(this,ur).doors==null){let e=M(this,ys).doors.filter(t=>t.floor.id===this.id);M(this,ur).doors=e}return M(this,ur).doors}get annotations(){if(M(this,ur).annotations==null){let e=M(this,ys).annotations.filter(t=>t.floor.id===this.id);M(this,ur).annotations=e}return M(this,ur).annotations}get pois(){if(M(this,ur).pois==null){let e=M(this,ys).pointsOfInterest.filter(t=>t.floor.id===this.id);M(this,ur).pois=e}return M(this,ur).pois}toJSON(){return{id:this.id,name:this.name,elevation:this.elevation,spaces:this.spaces.map(e=>e.id),objects:this.objects.map(e=>e.id),connections:this.connections.map(e=>e.id),doors:this.doors.map(e=>e.id),annotations:this.annotations.map(e=>e.id),pois:this.pois.map(e=>e.id)}}destroy(){for(let e of globalThis.Object.keys(M(this,ur)))delete M(this,ur)[e]}};ys=new WeakMap,ur=new WeakMap,Ff=new WeakMap,h(tM,"Floor"),ie(tM,"__type","floor");var Kbe=tM,z_=Kbe;R();R();R();var XQ=h(i=>i!=null,"notNull");R();function qQ(i){return typeof i=="string"?i:i.id}h(qQ,"getId");R();function Qu(i){let e;if(gh.is(i)||B_.is(i)||yh.is(i))e=i.center;else if($_.is(i)||JT.is(i))e=i.coordinate;else if(br.is(i))e=i;else return;return e}h(Qu,"getCoordinateFromStuffs");R();R();var rM={auto:!0,debug:!1,pitch:45,bearing:0,antialiasing:{enabled:!0},shadingAndOutlines:!0,outdoorView:{layersHiddenByGeometry:["building","building-top"]}},hx="ExteriorWalls",ZQ="Walls",Qbe=0;function YQ(i){var e,t;if((e=i.outdoorView)!=null&&e.enabled&&!((t=i.outdoorView)!=null&&t.token)){let r=new Error("Missing outdoorView token");throw r.name="MissingOutdoorViewToken",r}}h(YQ,"validateOptions");function JQ(i,e){var t,r,n,a;let o=((t=i==null?void 0:i.outdoorView)==null?void 0:t.token)||e.outdoorViewToken,s={...rM,...i??{},outdoorView:{enabled:((r=i==null?void 0:i.outdoorView)==null?void 0:r.enabled)===void 0?!!o:(n=i==null?void 0:i.outdoorView)==null?void 0:n.enabled,layersHiddenByGeometry:(a=rM.outdoorView)==null?void 0:a.layersHiddenByGeometry,...i==null?void 0:i.outdoorView}};return o&&s.outdoorView&&(s.outdoorView.token=o),s}h(JQ,"handleDefault");var e0,ll,ul,nM=class aM extends nu{constructor(e,t){let r=Object.values(t.mvfDataByFloorId)[0];super(r.properties.id,r.properties.details),ie(this,"__type",aM.__type),fe(this,e0,void 0),fe(this,ll,void 0),fe(this,ul,void 0),Re(this,ll,{}),Re(this,e0,e),Re(this,ul,t.mvfDataByFloorId)}static is(e){return e.__type===aM.__type}get name(){var e,t;return(t=(e=Object.values(M(this,ul))[0].properties.details)==null?void 0:e.name)!=null?t:""}get description(){var e,t;return(t=(e=Object.values(M(this,ul))[0].properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;return(t=(e=Object.values(M(this,ul))[0].properties.details)==null?void 0:e.images)!=null?t:[]}get type(){var e,t;return(t=(e=Object.values(M(this,ul))[0].properties.kind)==null?void 0:e.split(".")[1])!=null?t:"unknown"}get coordinates(){return M(this,ll).coordinates==null&&(M(this,ll).coordinates=Object.entries(M(this,ul)).map(([e,t])=>new br(t.geometry.coordinates[1],t.geometry.coordinates[0],e))),M(this,ll).coordinates}get floors(){return this.coordinates.map(e=>e.floorId?M(this,e0).getById("floor",e.floorId):void 0).filter(XQ)}toJSON(){return{id:this.id,name:this.name,type:this.type,coordinates:this.coordinates.map(e=>e.toJSON()),floors:this.floors.map(e=>e.id)}}destroy(){for(let e of Object.keys(M(this,ll)))delete M(this,ll)[e]}};e0=new WeakMap,ll=new WeakMap,ul=new WeakMap,h(nM,"Connection"),ie(nM,"__type","connection");var ewe=nM,N_=ewe;R();var t0,_c,bu,hl,oM=class sM extends nu{constructor(e,t){super(t.mvfData.properties.id,t.mvfData.properties.details),ie(this,"__type",sM.__type),fe(this,t0,void 0),fe(this,_c,void 0),fe(this,bu,{}),fe(this,hl,void 0),Re(this,t0,e),Re(this,_c,t.floorId),Re(this,hl,t.mvfData)}static is(e){return e.__type===sM.__type}get name(){var e,t;return(t=(e=M(this,hl).properties.details)==null?void 0:e.name)!=null?t:""}get description(){var e,t;return(t=(e=M(this,hl).properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;return(t=(e=M(this,hl).properties.details)==null?void 0:e.images)!=null?t:[]}get type(){let e=M(this,hl).properties.kind;return e==null&&(e="object"),e==="Desks"&&(e="desk"),e.toLowerCase()}get floor(){let e=M(this,t0).getById("floor",M(this,_c));if(e==null)throw new Error(`Floor ${M(this,_c)} not found!`);return e}get center(){var e;if(M(this,bu).center==null){let[t,r]=(e=M(this,hl).properties.center)!=null?e:[0,0];M(this,bu).center=new br(r,t,M(this,_c))}return M(this,bu).center}toJSON(){return{id:this.id,name:this.name,type:this.type,floor:this.floor.id,center:this.center.toJSON()}}destroy(){for(let e of globalThis.Object.keys(M(this,bu)))M(this,bu)[e]=null}};t0=new WeakMap,_c=new WeakMap,bu=new WeakMap,hl=new WeakMap,h(oM,"MapObject"),ie(oM,"__type","object");var twe=oM,yh=twe;R();R();var i0,Of,lM=class KQ extends VQ{constructor(e){super(String(Ar())),fe(this,i0,{}),fe(this,Of,void 0),Re(this,Of,e.mvfData)}static is(e){return e.__type===KQ.__type}get url(){return M(this,Of).url}get name(){return M(this,Of).altText}toJSON(){return{id:this.id,url:this.url,name:this.name}}destroy(){for(let e of globalThis.Object.keys(M(this,i0)))delete M(this,i0)[e]}};i0=new WeakMap,Of=new WeakMap,h(lM,"Image"),ie(lM,"__type","image");var iwe=lM,QQ=iwe,r0,bc,ko,wu,uM=class hM extends nu{constructor(e,t){super(t.mvfData.properties.id,t.mvfData.properties.details),ie(this,"__type",hM.__type),fe(this,r0,void 0),fe(this,bc,void 0),fe(this,ko,{}),fe(this,wu,void 0),Re(this,r0,e),Re(this,wu,t.mvfData),Re(this,bc,t.floorId)}static is(e){return e.__type===hM.__type}get name(){var e,t;return(t=(e=M(this,wu).properties.details)==null?void 0:e.name)!=null?t:""}get description(){var e,t;return(t=(e=M(this,wu).properties.details)==null?void 0:e.description)!=null?t:""}get images(){var e,t;if(M(this,ko).images==null){let r=(t=(e=M(this,wu).properties.details)==null?void 0:e.images)!=null?t:[];M(this,ko).images=r.map(n=>new QQ({mvfData:n}))}return M(this,ko).images}get floor(){let e=M(this,r0).getById("floor",M(this,bc));if(e==null)throw new Error(`Floor ${M(this,bc)} not found!`);return e}get coordinate(){var e;if(M(this,ko).coordinate==null){let[t,r]=(e=M(this,wu).geometry.coordinates)!=null?e:[0,0];M(this,ko).coordinate=new br(r,t,M(this,bc))}return M(this,ko).coordinate}toJSON(){return{id:this.id,name:this.name,floor:this.floor.id,coordinate:this.coordinate.toJSON()}}destroy(){for(let e in M(this,ko))M(this,ko)[e]=null}};r0=new WeakMap,bc=new WeakMap,ko=new WeakMap,wu=new WeakMap,h(uM,"PointOfInterest"),ie(uM,"__type","point-of-interest");var rwe=uM,$_=rwe;R();var n0,wc,Su,mm,a0,cM,pM=class dM extends nu{constructor(e,t){super(t.mvfData.properties.id),fe(this,a0),ie(this,"__type",dM.__type),fe(this,n0,void 0),fe(this,wc,void 0),fe(this,Su,{}),fe(this,mm,void 0),Re(this,n0,e),Re(this,wc,t.floorId),Re(this,mm,t.mvfData)}static is(e){return e.__type===dM.__type}get group(){return $t(this,a0,cM).call(this).group}get type(){return $t(this,a0,cM).call(this).type}get coordinate(){if(M(this,Su).coordinate==null){let[e,t]=M(this,mm).geometry.coordinates;M(this,Su).coordinate=new br(t,e,M(this,wc))}return M(this,Su).coordinate}get floor(){let e=M(this,n0).getById("floor",M(this,wc));if(e==null)throw new Error(`Floor ${M(this,wc)} not found!`);return e}toJSON(){return{id:this.id,group:this.group,type:this.type,coordinate:this.coordinate.toJSON()}}destroy(){for(let e of Object.keys(M(this,Su)))delete M(this,Su)[e]}};n0=new WeakMap,wc=new WeakMap,Su=new WeakMap,mm=new WeakMap,a0=new WeakSet,cM=h(function(){let[i,e]=M(this,mm).properties.symbolId.split("--");return{group:i,type:e}},"#getGroupAndTypeFromSymbolId"),h(pM,"Annotation"),ie(pM,"__type","annotation");var nwe=pM,JT=nwe;R();R();var Bf,Ro,Sc,zf,fM=class mM extends nu{constructor(e,t){super(t.mvfData.properties.id),ie(this,"__type",mM.__type),fe(this,Bf,void 0),fe(this,Ro,{}),fe(this,Sc,void 0),fe(this,zf,void 0),Re(this,Bf,e),Re(this,Sc,t.floorId),Re(this,zf,t.mvfData)}static is(e){return e.__type===mM.__type}get floor(){let e=M(this,Bf).getById("floor",M(this,Sc));if(e==null)throw new Error(`Floor ${M(this,Sc)} not found!`);return e}get coordinate(){if(M(this,Ro).coordinate==null){let[e,t]=M(this,zf).geometry.coordinates;M(this,Ro).coordinate=new br(t,e,M(this,Sc))}return M(this,Ro).coordinate}get neighbors(){if(M(this,Ro).neighbours==null){let e=M(this,zf).properties.neighbors.map(t=>{let r=M(this,Bf).getById("node",t.id);if(r==null)throw new Error(`Node ${t.id} not found!`);return r});M(this,Ro).neighbours=e}return M(this,Ro).neighbours}toJSON(){return{id:this.id,floor:this.floor.id,coordinate:this.coordinate.toJSON(),neighbors:this.neighbors.map(e=>e.id)}}destroy(){for(let e of Object.keys(M(this,Ro)))delete M(this,Ro)[e]}};Bf=new WeakMap,Ro=new WeakMap,Sc=new WeakMap,zf=new WeakMap,h(fM,"Node"),ie(fM,"__type","node");var awe=fM,owe=awe,swe=h((i,e)=>{var t,r;let n={},a={},o={},s={},l={},u={},c={},p={},d=globalThis.Object.keys(i.space);for(let m of d){let g=i.space[m];if(g!=null)for(let _ of g.features){p[_.properties.id]=m,l[_.properties.id]=_;for(let y of _.properties.destinationNodes)o[y]==null&&(o[y]=[]),o[y].push(_.properties.id);if(_.properties.kind==="desk-entrance"&&(s[_.properties.externalId]==null&&(s[_.properties.externalId]=[]),s[_.properties.externalId].push(..._.properties.destinationNodes)),!["void","desk-entrance"].includes((t=_.properties.kind)!=null?t:"")){if((r=_.properties.kind)!=null&&r.includes("connection")){let y=`${_.geometry.coordinates[1]}-${_.geometry.coordinates[0]}`;u[y]==null&&(u[y]=[]),u[y].push(_.properties.id);continue}if(_.properties.kind==="poi"){let y=new $_(e,{floorId:m,mvfData:_});a[_.properties.id]=y}else{let y=new gh(e,{floorId:m,mvfData:_});n[_.properties.id]=y}}}}for(let m in u){let g=u[m],_={};for(let x of g){let w=p[x],b=l[x];_[w]=b}let y=new N_(e,{mvfDataByFloorId:_});c[y.id]=y}return{spacesById:n,poisById:a,connectionsById:c,spaceIdsByDestinationNodeId:o,objectEntranceNodeIdsByObstructionId:s,mvfSpacesById:l,connectionIdsByLatLon:u}},"processMVFSpaces"),lwe=h((i,e)=>{let t={},r={};for(let n of i["node.geojson"].features){r[n.properties.id]=n;let a=new owe(e,{mvfData:n,floorId:n.properties.map});t[n.properties.id]=a}return{nodesById:t,mvfNodesById:r}},"processMVFNodes"),uwe=h((i,e)=>{let t={},r={},n={},a=globalThis.Object.keys(i.obstruction);for(let o of a){let s=i.obstruction[o];if(s!=null)for(let l of s.features){r[l.properties.id]=l;for(let c of l.properties.entrances)n[c]=l.properties.id;if(l.properties.kind==="Wall")continue;let u=new yh(e,{floorId:o,mvfData:l});t[l.properties.id]=u}}return{objectsById:t,mvfObstructionById:r,obstructionIdByEntranceId:n}},"processMVFObstructions"),hwe=h((i,e)=>{let t={},r={};for(let n of i["map.geojson"]){r[n.id]=n;let a=new z_(e,{mvfData:n});t[n.id]=a}return{floorsById:t,mvfMapsById:r}},"processMVFMaps"),cwe=h((i,e)=>{let t={},r=i["connection.json"].reduce((n,a)=>(a.nodes.forEach(o=>n[o]=a),t[a.id]=a,n),{});return{mvfConnectionsById:t,mvfConnectionsByNodeId:r}},"processMVFConnections"),pwe=h((i,e)=>{let t={},r={},n={},a=globalThis.Object.keys(i.entrance);for(let o of a){let s=i.entrance[o];if(s!=null)for(let l of s.features){n[l.properties.id]=l;let u=new B_(e,{floorId:o,mvfData:l});l.properties.node&&(r[l.properties.node]=u),t[l.properties.id]=u}}return{doorsById:t,doorsByNodeId:r,mvfEntrancesById:n}},"processMVFEntrances"),dwe=h((i,e)=>{let t={},r={};if(i.annotation==null)return{annotationsById:t,mvfAnnotationsById:r};let n=globalThis.Object.keys(i.annotation);for(let a of n){let o=i.annotation[a];if(o!=null)for(let s of o.features){r[s.properties.id]=s;let l=new JT(e,{floorId:a,mvfData:s});t[s.properties.id]=l}}return{annotationsById:t,mvfAnnotationsById:r}},"processMVFAnnotations"),fwe=h((i,e)=>{let{spacesById:t,spaceIdsByDestinationNodeId:r,poisById:n,mvfSpacesById:a,objectEntranceNodeIdsByObstructionId:o,connectionsById:s,connectionIdsByLatLon:l}=swe(i,e),{nodesById:u,mvfNodesById:c}=lwe(i,e),{objectsById:p,mvfObstructionById:d,obstructionIdByEntranceId:m}=uwe(i,e),{floorsById:g,mvfMapsById:_}=hwe(i,e),{mvfConnectionsById:y,mvfConnectionsByNodeId:x}=cwe(i,e),{doorsById:w,doorsByNodeId:b,mvfEntrancesById:C}=pwe(i,e),{annotationsById:E,mvfAnnotationsById:T}=dwe(i,e);return{spacesById:t,nodesById:u,objectsById:p,floorsById:g,connectionsById:s,doorsById:w,doorsByNodeId:b,poisById:n,annotationsById:E,spaceIdsByDestinationNodeId:r,objectEntranceNodeIdsByObstructionId:o,obstructionIdByEntranceId:m,connectionIdsByLatLon:l,mvfSpacesById:a,mvfNodesById:c,mvfObstructionById:d,mvfMapsById:_,mvfConnectionsById:y,mvfConnectionsByNodeId:x,mvfEntrancesById:C,mvfAnnotationsById:T}},"createDataFromMVF"),Mi,Mc,Cc,Ec,Tc,Pc,Ac,Ic,Lc,o0,s0,l0,u0,h0,c0,p0,d0,eee=class{constructor(e,t){fe(this,Mi,{}),ie(this,"mvf"),ie(this,"outdoorViewToken"),ie(this,"spaceIdsByDestinationNodeId"),ie(this,"objectEntranceNodeIdsByObstructionId"),ie(this,"obstructionIdByEntranceId"),fe(this,Mc,void 0),fe(this,Cc,void 0),fe(this,Ec,void 0),fe(this,Tc,void 0),fe(this,Pc,void 0),fe(this,Ac,void 0),ie(this,"doorsByNodeId"),fe(this,Ic,void 0),fe(this,Lc,void 0),fe(this,o0,void 0),fe(this,s0,void 0),fe(this,l0,void 0),fe(this,u0,void 0),fe(this,h0,void 0),fe(this,c0,void 0),fe(this,p0,void 0),fe(this,d0,void 0),this.mvf=e,this.outdoorViewToken=t;let r=fwe(e,this);Re(this,Mc,r.nodesById),Re(this,Cc,r.spacesById),Re(this,Ec,r.floorsById),Re(this,Tc,r.connectionsById),Re(this,Pc,r.objectsById),Re(this,Ac,r.doorsById),Re(this,Ic,r.poisById),Re(this,Lc,r.annotationsById),Re(this,o0,r.mvfAnnotationsById),Re(this,s0,r.mvfConnectionsById),Re(this,l0,r.mvfConnectionsByNodeId),Re(this,u0,r.mvfEntrancesById),Re(this,h0,r.mvfNodesById),Re(this,c0,r.mvfObstructionById),Re(this,p0,r.mvfSpacesById),Re(this,d0,r.mvfMapsById),this.doorsByNodeId=r.doorsByNodeId,this.spaceIdsByDestinationNodeId=r.spaceIdsByDestinationNodeId,this.objectEntranceNodeIdsByObstructionId=r.objectEntranceNodeIdsByObstructionId,this.obstructionIdByEntranceId=r.obstructionIdByEntranceId}get mapName(){return this.mvf["manifest.geojson"].features[0].properties.name}get organizationId(){var e;return(e=this.mvf["manifest.geojson"].features[0].properties.org_id)!=null?e:""}get mapCenter(){return new br(this.mvf["manifest.geojson"].features[0].geometry.coordinates[1],this.mvf["manifest.geojson"].features[0].geometry.coordinates[0])}get spaces(){return M(this,Mi).spaces==null&&(M(this,Mi).spaces=globalThis.Object.values(M(this,Cc))),M(this,Mi).spaces}get objects(){return M(this,Mi).objects==null&&(M(this,Mi).objects=globalThis.Object.values(M(this,Pc))),M(this,Mi).objects}get connections(){return M(this,Mi).connections==null&&(M(this,Mi).connections=globalThis.Object.values(M(this,Tc))),M(this,Mi).connections}get floors(){return M(this,Mi).floors==null&&(M(this,Mi).floors=globalThis.Object.values(M(this,Ec))),M(this,Mi).floors}get doors(){return M(this,Mi).doors==null&&(M(this,Mi).doors=globalThis.Object.values(M(this,Ac))),M(this,Mi).doors}get pointsOfInterest(){return M(this,Mi).pointsOfInterest==null&&(M(this,Mi).pointsOfInterest=globalThis.Object.values(M(this,Ic))),M(this,Mi).pointsOfInterest}get annotations(){return M(this,Mi).annotations==null&&(M(this,Mi).annotations=globalThis.Object.values(M(this,Lc))),M(this,Mi).annotations}get nodes(){return M(this,Mi).nodes==null&&(M(this,Mi).nodes=globalThis.Object.values(M(this,Mc))),M(this,Mi).nodes}getById(e,t){switch(e){case"space":return M(this,Cc)[t];case"floor":return M(this,Ec)[t];case"node":return M(this,Mc)[t];case"door":return M(this,Ac)[t];case"connection":return M(this,Tc)[t];case"object":return M(this,Pc)[t];case"point-of-interest":return M(this,Ic)[t];case"annotation":return M(this,Lc)[t];default:throw new Error(`Unknown type: ${e}`)}}getMapDataById(e){var t,r,n,a,o,s,l;return(l=(s=(o=(a=(n=(r=(t=M(this,Cc)[e])!=null?t:M(this,Ec)[e])!=null?r:M(this,Mc)[e])!=null?n:M(this,Ac)[e])!=null?a:M(this,Tc)[e])!=null?o:M(this,Pc)[e])!=null?s:M(this,Ic)[e])!=null?l:M(this,Lc)[e]}getMVFFeatureById(e,t){switch(e){case"space":return M(this,p0)[t];case"node":return M(this,h0)[t];case"obstruction":return M(this,c0)[t];case"map":return M(this,d0)[t];case"connection":return M(this,s0)[t];case"entrance":return M(this,u0)[t];case"annotation":return M(this,o0)[t];default:throw new Error(`Unknown MVF feature type: ${e}`)}}getMVFFeatureByNodeId(e,t){switch(e){case"connection":return M(this,l0)[t];default:throw new Error(`Unsupported MVF feature type: ${e}`)}}destroy(){for(let e of globalThis.Object.keys(M(this,Mi)))M(this,Mi)[e]=null}};Mi=new WeakMap,Mc=new WeakMap,Cc=new WeakMap,Ec=new WeakMap,Tc=new WeakMap,Pc=new WeakMap,Ac=new WeakMap,Ic=new WeakMap,Lc=new WeakMap,o0=new WeakMap,s0=new WeakMap,l0=new WeakMap,u0=new WeakMap,h0=new WeakMap,c0=new WeakMap,p0=new WeakMap,d0=new WeakMap,h(eee,"MapDataInternal");var KT=eee;R();R();R();R();var tee=class{constructor(){Z(this,"_subscribers",{})}publish(e,t){!this._subscribers||!this._subscribers[e]||this._subscribers[e].forEach(function(r){typeof r=="function"&&r(t)})}on(e,t){this._subscribers||(this._subscribers={}),this._subscribers[e]=this._subscribers[e]||[],this._subscribers[e].push(t)}off(e,t){if(!this._subscribers||this._subscribers[e]==null)return;let r=this._subscribers[e].indexOf(t);r!==-1&&this._subscribers[e].splice(r,1)}destroy(){this._subscribers={}}};h(tee,"PubSub");var Zr=tee;R();var M8="mi-session-data",C8="mi-local-data",ap,Fo,Oo,gM=class iee{constructor(){fe(this,Fo,void 0),fe(this,Oo,void 0);try{let e=sessionStorage.getItem(M8);e?Re(this,Fo,JSON.parse(e)):Re(this,Fo,{id:Ar()})}catch{Re(this,Fo,{id:Ar()})}try{let e=localStorage.getItem(C8);e?Re(this,Oo,JSON.parse(e)):Re(this,Oo,{deviceId:Ar()})}catch{Re(this,Oo,{deviceId:Ar()})}M(this,Fo).id||(M(this,Fo).id=Ar()),M(this,Oo).deviceId||(M(this,Oo).deviceId=Ar())}static getInstance(){return M(this,ap)||Re(this,ap,new iee),M(this,ap)}static ___clearInstance(){Re(this,ap,void 0)}saveSessionData(e,t){M(this,Fo)[e]=t;try{return sessionStorage.setItem(M8,JSON.stringify(M(this,Fo))),!0}catch{return!1}}loadSessionData(e){let t=M(this,Fo)[e];if(t!=null)return t}saveLocalData(e,t){M(this,Oo)[e]=t;try{return localStorage.setItem(C8,JSON.stringify(M(this,Oo))),!0}catch{return!1}}loadLocalData(e){let t=M(this,Oo)[e];if(t!=null)return t}};ap=new WeakMap,Fo=new WeakMap,Oo=new WeakMap,h(gM,"SafeStorage"),fe(gM,ap,void 0);var ree=gM;R();R();R();R();var yM=class vM{constructor(e,t){Z(this,"id");Z(this,"text");Z(this,"__type",vM.__type);this.id=e,this.text=t}static is(e){return e.__type===vM.__type}};h(yM,"Label"),ie(yM,"__type","Label");var xM=yM;R();var _M=class bM{constructor(e,t){Z(this,"id");Z(this,"__type",bM.__type);Z(this,"contentEl");this.id=e,this.contentEl=t}static is(e){return e.__type===bM.__type}};h(_M,"Marker"),ie(_M,"__type","Marker");var nee=_M;R();var wM=class SM{constructor(e,t){Z(this,"id");Z(this,"groupId");Z(this,"__type",SM.__type);this.id=e,this.groupId=t}static is(e){return e.__type===SM.__type}};h(wM,"Model"),ie(wM,"__type","Model");var mwe=wM;R();var aee=class{constructor(e){Z(this,"id");Z(this,"__type");this.id=e,this.__type="Path"}};h(aee,"Path");var gwe=aee;R();var Mu,oee=class{constructor(e){fe(this,Mu,void 0),Re(this,Mu,e)}get center(){return M(this,Mu).center}get bearing(){return M(this,Mu).bearing}get pitch(){return M(this,Mu).pitch}get zoomLevel(){return M(this,Mu).zoomLevel}};Mu=new WeakMap,h(oee,"CameraTransform");var ywe=oee;R();var MM=class CM{constructor(e){Z(this,"id");Z(this,"__type",CM.__type);this.id=e}static is(e){return e.__type===CM.__type}};h(MM,"Shape"),ie(MM,"__type","Shape");var vwe=MM;R();R();R();var xwe=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				// Do not change these to fillRule or clipRule, since they need to be rendered as actual SVGs in labels, not React SVGs
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),_we=/<svg([^>]*)>/g;function see(i,e,t){let r=xwe.get(i);return r?r.replace(_we,`<svg$1 style="fill:${e}; width:${t}px; height:${t}px">`):""}h(see,"getStyledIcon");var bwe=h(i=>`
		<div class="pin-shadow" style="background: ${i}"></div>
		<svg width="${20*.9}px" height="${48*.9}px" viewBox="0 0 20 48">
			<path
				d="M1.37965 29.3246C1.5778 31.2167 2.27661 33.0694 3.83078 33.775C4.0998 37.1861 4.7451 40.2227 5.65918 42.4784C6.14556 43.6787 6.72883 44.71 7.41453 45.4578C8.10027 46.2056 8.97065 46.7527 9.99989 46.7527C11.0292 46.7527 11.8995 46.2055 12.585 45.4576C13.2706 44.7098 13.8536 43.6785 14.3398 42.4783C15.2536 40.2226 15.8988 37.186 16.1688 33.7752C17.7232 33.0697 18.422 31.2169 18.6201 29.3247C18.8386 27.2385 18.5165 24.6502 17.6475 22.0285L17.6473 22.0278C16.9657 19.9761 16.0319 18.1622 14.9848 16.7474C17.0884 15.1587 18.4471 12.5964 18.4471 9.7152C18.4471 4.93539 14.6967 1 9.99966 1C5.30272 1 1.54993 4.93527 1.54993 9.7152C1.54993 12.5961 2.90839 15.1583 5.01167 16.747C3.9635 18.1625 3.03185 19.977 2.3522 22.0286C1.48319 24.6503 1.16118 27.2385 1.37965 29.3246Z"
				fill={color}
				stroke="white"
				strokeWidth="2"
			/>
		</svg>
	`,"getDeparturePin"),wwe=h(i=>`
		<div class="pin-shadow" style="background: ${i}"></div>
		<svg width="36" height="42" viewBox="-2 -2 40 46">
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill="none"
				stroke="white"
				strokeWidth="4"
			/>
			<path
				d="M35.8372 5.86776C35.6765 7.92448 34.2625 10.158 32.0612 11.8292C30.0929 13.3235 25.8269 15.6292 19.3114 14.3438C13.6237 13.219 9.78333 15.5569 7.88708 21.2934L13.4303 39.7879C13.6151 40.4267 13.2536 41.0955 12.6189 41.2903C12.5064 41.3225 12.39 41.3385 12.2735 41.3385C11.7412 41.3385 11.2712 40.989 11.1166 40.4789L5.54093 21.88C5.47265 21.7474 5.43047 21.6028 5.41239 21.4542L1.07409 6.97696C0.975678 6.80825 0.921449 6.61744 0.913417 6.42263L0.053779 3.56251C-0.0406172 3.2552 -0.0104927 2.92379 0.142154 2.64058C0.29279 2.35738 0.549874 2.14649 0.857157 2.05411C1.16646 1.96172 1.49786 1.99587 1.77906 2.15052C2.06025 2.30317 2.26912 2.56226 2.35951 2.87155L2.51215 3.39375C3.55453 2.22081 4.87615 1.32902 6.35237 0.798742C10.1685 -0.631292 15.2377 -0.117113 19.5763 2.14846C22.2435 3.53834 29.0241 6.57524 34.2141 4.63904C34.5998 4.49845 35.0316 4.56272 35.361 4.81178C35.6884 5.06083 35.8673 5.45801 35.8372 5.86776Z"
				fill={color}
			/>
		</svg>
    `,"getDestinationPin"),lee="#722ED1",uee="#1890FF",E8=h(({type:i="departure",destinationColor:e=lee,departureColor:t=uee})=>`<div class="dropped-pin-wrapper">
			${i==="departure"?bwe(t):wwe(e)}
		</div>`,"DroppedPin"),Swe=h(i=>{switch(i){case"default":return 28;case"selection":return 28;case"navigation":return 32}},"getSize"),Mwe=h(({type:i="stairs",color:e="#722ED1",direction:t="up"})=>{let r=Swe("default"),n=r/2+2,a=t&&t!=="none";return`<div class="mappedin-connection-marker">
			<div class="connection-circle"
				role="button"
                style="background:${e}; width:${r}px; height:${r}px;"
			>
                ${see("connection-"+i+"-16x16","white",n)||""}
			</div>
			${a?`<div style="margin-left: -${r*.2}px;">
					<div class="bouncey">
						<div class="connection-circle"
							role="button"
							style="width: ${r}px; height: ${r}px;">
							<div class="${t==="up"?"":"arrow--down"}">
                                <svg viewBox="0 0 16 16" style="fill: white; width: ${n}px; height: ${n}px">
                                    <path
                                        fillRule="evenodd"
                                        clipRule="evenodd"
                                        d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
                                        stroke="none"
                                    />
                                </svg>
							</div>
						</div>
					</div>
				</div>`:""}
		</div>`},"ConnectionMarker");R();var Cwe=h(async i=>new Promise(e=>setTimeout(e,i)),"ms"),K1={createMarkers:{departure:!0,destination:!0,connection:!0},pathOptions:{color:"#40A9FF",nearRadius:.25,farRadius:.25*4,displayArrowsOnPath:!1},polygons:{departure:"#40A9FF"}},cl,pl,Dc,Mn,Cu,EM,hee,f0,cee=class{constructor(e){fe(this,EM),fe(this,cl,void 0),fe(this,pl,new Map),fe(this,Dc,void 0),fe(this,Mn,void 0),fe(this,Cu,K1),ie(this,"draw",async(t,r={})=>{var n,a,o;if(t.coordinates.length<2){Bt.warn("Directions must have at least 2 coordinates");return}M(this,cl)&&this.clear();let s={pathOptions:{...K1.pathOptions,...r.pathOptions},createMarkers:{...K1.createMarkers,...r.createMarkers},polygons:{...K1.polygons,...r.polygons}};Re(this,Cu,s),Re(this,cl,t);let l=t.coordinates[0],u=t.coordinates[t.coordinates.length-1],c=M(this,Mn).getMapData()[Object.keys(M(this,Mn).getMapData())[0]];if(l.floorId&&M(this,Mn).setFloor(c.getById("floor",l.floorId)),(n=M(this,Cu).createMarkers)!=null&&n.departure){let p=M(this,Mn).Markers.add(l,E8({type:"departure"}),{anchor:"top",rank:"always-visible"});M(this,pl).set(p,void 0)}if(await Cwe(500),!!M(this,cl)&&(Re(this,Dc,await M(this,Mn).Paths.add(t.coordinates,M(this,Cu).pathOptions)),!!M(this,cl))){if((a=M(this,Cu).createMarkers)!=null&&a.destination){let p=M(this,Mn).Markers.add(u,E8({type:"destination"}),{anchor:"top",rank:"always-visible"});M(this,pl).set(p,void 0)}(o=M(this,Cu).createMarkers)!=null&&o.connection&&(t.instructions.filter(p=>$t(this,EM,hee).call(this,p.action)).forEach(p=>{let d=M(this,Mn).Markers.add(p.coordinate,Mwe({type:p.action.connectionType,color:p.action.type==="ExitConnection"?uee:lee,direction:p.action.direction}),{interactive:!0,anchor:"top",rank:"always-visible"});M(this,pl).set(d,p)}),M(this,Mn).on("click",M(this,f0)))}}),fe(this,f0,h(t=>{if(t.markers.length>0){let r=M(this,pl).get(t.markers[0]);r!=null&&r.action.toFloor&&M(this,Mn).setFloor(r.action.toFloor)}},"#handleClick")),ie(this,"clear",()=>{M(this,cl)&&(M(this,pl).forEach((t,r)=>{M(this,Mn).Markers.remove(r)}),M(this,pl).clear(),M(this,Dc)&&(M(this,Mn).Paths.remove(M(this,Dc)),Re(this,Dc,void 0)),M(this,Mn).off("click",M(this,f0)),Re(this,cl,void 0))}),Re(this,Mn,e)}};cl=new WeakMap,pl=new WeakMap,Dc=new WeakMap,Mn=new WeakMap,Cu=new WeakMap,EM=new WeakSet,hee=h(function(i){return i!=null&&["TakeConnection","ExitConnection"].includes(i.type)},"#isVortexAction"),f0=new WeakMap,h(cee,"Navigation");var Ewe=cee;R();R();R();var Twe=new Map([["search-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M1 7C1 3.68629 3.68629 1 7 1C10.3137 1 13 3.68629 13 7C13 8.29583 12.5892 9.49572 11.8907 10.4765L15.4614 14.0472C15.6567 14.2425 15.6567 14.559 15.4614 14.7543L14.7543 15.4614C14.559 15.6567 14.2424 15.6567 14.0472 15.4614L10.4765 11.8907C9.49571 12.5892 8.29583 13 7 13C3.68629 13 1 10.3137 1 7ZM7 11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3C9.20914 3 11 4.79086 11 7C11 9.20914 9.20914 11 7 11Z"
				stroke="none"
			/>
		</svg>`],["close-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M12.5963 1.98959C12.7916 1.79433 13.1082 1.79433 13.3034 1.98959L14.0105 2.6967C14.2058 2.89196 14.2058 3.20855 14.0105 3.40381L3.40392 14.0104C3.20866 14.2057 2.89208 14.2057 2.69682 14.0104L1.98971 13.3033C1.79445 13.108 1.79445 12.7915 1.98971 12.5962L12.5963 1.98959Z"
				stroke="none"
			/>
			<path
				d="M1.98971 3.40381C1.79445 3.20855 1.79445 2.89196 1.98971 2.6967L2.69682 1.98959C2.89208 1.79433 3.20866 1.79433 3.40392 1.98959L14.0105 12.5962C14.2058 12.7915 14.2058 13.108 14.0105 13.3033L13.3034 14.0104C13.1082 14.2057 12.7916 14.2057 12.5963 14.0104L1.98971 3.40381Z"
				stroke="none"
			/>
		</svg>`],["empty-64x40",`<svg viewBox="0 0 64 40">
			<g>
				<g clipPath="url(#clip0_499_175492)">
					<path
						d="M32 39.7032C49.6731 39.7032 64 36.5925 64 32.7552C64 28.9179 49.6731 25.8071 32 25.8071C14.3269 25.8071 0 28.9179 0 32.7552C0 36.5925 14.3269 39.7032 32 39.7032Z"
						stroke="none"
						fill="#F5F5F5"
					/>
					<path
						d="M55 13.6653L44.854 2.24866C44.367 1.47048 43.656 1 42.907 1H21.093C20.344 1 19.633 1.47048 19.146 2.24767L9 13.6663V22.8367H55V13.6653Z"
						fill="none"
					/>
					<path
						d="M41.613 16.8128C41.613 15.2197 42.607 13.9046 43.84 13.9036H55V31.9059C55 34.0132 53.68 35.7402 52.05 35.7402H11.95C10.32 35.7402 9 34.0122 9 31.9059V13.9036H20.16C21.393 13.9036 22.387 15.2167 22.387 16.8098V16.8317C22.387 18.4248 23.392 19.7111 24.624 19.7111H39.376C40.608 19.7111 41.613 18.4128 41.613 16.8198V16.8128Z"
						fill="#FAFAFA"
					/>
				</g>
				<defs>
					<clipPath id="clip0_499_175492">
						<rect width="64" height="40" fill="white" />
					</clipPath>
				</defs>
			</g>
		</svg>`],["caret-12x12",`<svg viewBox="0 0 12 12">
			<path
				stroke="none"
				d="M8.38828 5.78337L3.92578 1.93493C3.75938 1.79196 3.51562 1.92087 3.51562 2.15173V9.84861C3.51562 10.0795 3.75938 10.2084 3.92578 10.0654L8.38828 6.21696C8.51602 6.10681 8.51602 5.89353 8.38828 5.78337Z"
			/>
		</svg>`],["plus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M7.5 1C7.22386 1 7 1.22386 7 1.5V7H1.5C1.22386 7 1 7.22386 1 7.5L1 8.5C1 8.77614 1.22386 9 1.5 9H7V14.5C7 14.7761 7.22386 15 7.5 15H8.5C8.77614 15 9 14.7761 9 14.5V9H14.5C14.7761 9 15 8.77614 15 8.5V7.5C15 7.22386 14.7761 7 14.5 7H9V1.5C9 1.22386 8.77614 1 8.5 1H7.5Z"
				stroke="none"
			/>
		</svg>`],["recenter-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M0 2.5C0 2.22386 0.223858 2 0.5 2H1.5C1.77614 2 2 2.22386 2 2.5V13.5C2 13.7761 1.77614 14 1.5 14H0.5C0.223858 14 0 13.7761 0 13.5V2.5Z" />
				<path
					fillRule="evenodd"
					clipRule="evenodd"
					d="M4.5 4C4.22386 4 4 4.22386 4 4.5V11.5C4 11.7761 4.22386 12 4.5 12H11.5C11.7761 12 12 11.7761 12 11.5V4.5C12 4.22386 11.7761 4 11.5 4H4.5ZM6 6V10H10V6H6Z"
				/>
				<path d="M14.5 2C14.2239 2 14 2.22386 14 2.5V13.5C14 13.7761 14.2239 14 14.5 14H15.5C15.7761 14 16 13.7761 16 13.5V2.5C16 2.22386 15.7761 2 15.5 2H14.5Z" />
			</g>
		</svg>`],["minus-16x16",`<svg viewBox="0 0 16 16">
			<path
				d="M1.5 9C1.22386 9 1 8.77614 1 8.5L1 7.5C1 7.22386 1.22386 7 1.5 7L14.5 7C14.7761 7 15 7.22386 15 7.5V8.5C15 8.77614 14.7761 9 14.5 9L1.5 9Z"
				stroke="none"
			/>
		</svg>`],["logo-horizontal-206x48",`<svg viewBox="0 0 206 48">
			<path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z" />
			<path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z" />
			<path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z" />
			<path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z" />
		</svg>`],["share-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M13 6C14.6569 6 16 4.65685 16 3C16 1.34315 14.6569 0 13 0C11.3431 0 10 1.34315 10 3C10 3.13463 10.0089 3.26719 10.0261 3.39712L6.82972 5.17286C6.10576 4.44825 5.10523 4 4 4C1.79086 4 0 5.79086 0 8C0 10.2091 1.79086 12 4 12C5.10523 12 6.10576 11.5518 6.82972 10.8271L10.0261 12.6029C10.0089 12.7328 10 12.8654 10 13C10 14.6569 11.3431 16 13 16C14.6569 16 16 14.6569 16 13C16 11.3431 14.6569 10 13 10C12.2011 10 11.4752 10.3123 10.9376 10.8214L7.84579 9.1037C7.94622 8.75313 8 8.38284 8 8C8 7.61716 7.94622 7.24687 7.84579 6.8963L10.9376 5.17864C11.4752 5.68775 12.2011 6 13 6ZM13 4C13.5523 4 14 3.55228 14 3C14 2.44772 13.5523 2 13 2C12.4477 2 12 2.44772 12 3C12 3.55228 12.4477 4 13 4ZM4 10C5.10457 10 6 9.10457 6 8C6 6.89543 5.10457 6 4 6C2.89543 6 2 6.89543 2 8C2 9.10457 2.89543 10 4 10ZM14 13C14 13.5523 13.5523 14 13 14C12.4477 14 12 13.5523 12 13C12 12.4477 12.4477 12 13 12C13.5523 12 14 12.4477 14 13Z"
				stroke="none"
			/>
		</svg>`],["checkmark-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M15.387 3.31662C15.6008 3.49148 15.6323 3.80649 15.4574 4.02021L6.77402 14.6332C6.58509 14.8642 6.30292 14.9986 6.00457 15C5.70622 15.0013 5.42285 14.8694 5.23184 14.6402L0.551937 9.02429C0.375155 8.81215 0.403817 8.49687 0.615956 8.32009L1.38418 7.67991C1.59632 7.50312 1.9116 7.53179 2.08838 7.74392L5.99299 12.4295L13.9095 2.75374C14.0844 2.54002 14.3994 2.50852 14.6131 2.68338L15.387 3.31662Z"
				stroke="none"
			/>
		</svg>`],["arrow-right-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.35355 1.64645C8.54881 1.45118 8.8654 1.45118 9.06066 1.64645L14.7071 7.29289C15.0976 7.68342 15.0976 8.31658 14.7071 8.70711L9.06066 14.3536C8.8654 14.5488 8.54882 14.5488 8.35355 14.3536L7.64645 13.6464C7.45118 13.4512 7.45118 13.1346 7.64645 12.9393L11.5858 9H0.5C0.223858 9 0 8.77614 0 8.5V7.5C0 7.22386 0.223858 7 0.5 7H11.5858L7.64645 3.06066C7.45118 2.8654 7.45118 2.54882 7.64645 2.35355L8.35355 1.64645Z"
				stroke="none"
			/>
		</svg>`],["arrow-up-16x16",`<svg viewBox="0 0 16 16">
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M8.00015 0.5C8.34685 0.5 8.67835 0.642318 8.91714 0.893677L15.6517 7.98267C15.8441 8.18525 15.8359 8.50548 15.6333 8.69793L14.533 9.7433C14.3304 9.93575 14.0101 9.92754 13.8177 9.72496L9.26497 4.93262V15.4249C9.26497 15.7043 9.03846 15.9308 8.75904 15.9308H7.24125C6.96184 15.9308 6.73532 15.7043 6.73532 15.4249V4.93262L2.1826 9.72496C1.99015 9.92754 1.66992 9.93575 1.46734 9.7433L0.366945 8.69793C0.164367 8.50548 0.156156 8.18525 0.348604 7.98267L7.08315 0.893677C7.32194 0.642318 7.65344 0.5 8.00015 0.5Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M1 11.5C1 11.2239 1.22386 11 1.5 11H6V13.5C6 13.7761 5.77614 14 5.5 14H1.5C1.22386 14 1 13.7761 1 13.5V11.5Z" />
				<path d="M4 8.5C4 8.22386 4.22386 8 4.5 8H9V10.5C9 10.7761 8.77614 11 8.5 11H4V8.5Z" />
				<path d="M7 5.5C7 5.22386 7.22386 5 7.5 5H12V7.5C12 7.77614 11.7761 8 11.5 8H7V5.5Z" />
				<path d="M10 2.5C10 2.22386 10.2239 2 10.5 2H14.5C14.7761 2 15 2.22386 15 2.5V4.5C15 4.77614 14.7761 5 14.5 5H10V2.5Z" />
			</g>
		</svg>`],["connection-stairs-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.25 12H2.5C2.225 12 2 11.7429 2 11.4286C2 11.1143 2.225 10.8571 2.5 10.8571H4.25V7.91429H6.5V4.94286H8.75V2H11.5C11.775 2 12 2.25714 12 2.57143C12 2.88571 11.775 3.14286 11.5 3.14286H9.75V6.08571H7.5V9.02857H5.25V12Z"
				stroke="none"
			/>
		</svg>`],["connection-stairs-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path d="M1.625 8.1875C1.625 8.01491 1.76491 7.875 1.9375 7.875H4.75V9.4375C4.75 9.61009 4.61009 9.75 4.4375 9.75H1.9375C1.76491 9.75 1.625 9.61009 1.625 9.4375V8.1875Z" />
			<path d="M3.5 6.3125C3.5 6.13991 3.63991 6 3.8125 6H6.625V7.5625C6.625 7.73509 6.48509 7.875 6.3125 7.875H3.5V6.3125Z" />
			<path d="M5.375 4.4375C5.375 4.26491 5.51491 4.125 5.6875 4.125H8.5V5.6875C8.5 5.86009 8.36009 6 8.1875 6H5.375V4.4375Z" />
			<path d="M7.25 2.5625C7.25 2.38991 7.38991 2.25 7.5625 2.25H10.0625C10.2351 2.25 10.375 2.38991 10.375 2.5625V3.8125C10.375 3.98509 10.2351 4.125 10.0625 4.125H7.25V2.5625Z" />
		</svg>`],["connection-escalator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3.63008 12H2C0.895431 12 0 12.8954 0 14C0 15.1046 0.89543 16 2 16H4.63008C4.86879 16 5.09962 15.9146 5.28087 15.7593L11.7191 10.2407C11.9004 10.0854 12.1312 10 12.3699 10H14C15.1046 10 16 9.10457 16 8C16 6.89543 15.1046 6 14 6H11.3699C11.1312 6 10.9004 6.08539 10.7191 6.24074L4.28087 11.7593C4.09962 11.9146 3.86879 12 3.63008 12Z" />
				<path d="M5 6C5 4.89543 5.89543 4 7 4C8.10457 4 9 4.89543 9 6L5 9.5V6Z" />
				<path d="M9 2C9 3.10457 8.10457 4 7 4C5.89543 4 5 3.10457 5 2C5 0.89543 5.89543 0 7 0C8.10457 0 9 0.89543 9 2Z" />
			</g>
		</svg>`],["connection-escalator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M5.26686 2.98522C5.26686 2.44335 5.71573 2 6.26436 2C6.81299 2 7.26187 2.44335 7.26187 2.98522C7.26187 3.5271 6.81299 3.97045 6.26436 3.97045C5.71573 3.97045 5.26686 3.50246 5.26686 2.98522Z"
				stroke="none"
			/>
			<path
				d="M7.26188 5.48588V5.25125C7.26188 4.85716 6.91275 4.53696 6.48881 4.53696H6.03993C5.61599 4.53696 5.26687 4.88179 5.26687 5.25125V7.66458L4.3192 8.6995H3.67082C2.74813 8.6995 2 9.43842 2 10.3498C2 11.2611 2.74813 12 3.67082 12H4.61845C5.36658 12 6.11471 11.6798 6.61347 11.1133L9.6808 7.76354H10.3292C11.2519 7.76354 12 7.02463 12 6.11329C12 5.20196 11.2519 4.46305 10.3292 4.46305H9.38155C8.60848 4.46305 7.88529 4.78324 7.38653 5.34975L7.26188 5.48588ZM4.61846 11.0148H3.67083C3.29677 11.0148 2.99751 10.7192 2.99751 10.3498C2.99751 9.9803 3.29677 9.68473 3.67083 9.68473H4.61846C4.71821 9.68473 4.81796 9.63547 4.86784 9.56158L8.13467 5.99015C8.45886 5.64532 8.90774 5.44828 9.38155 5.44828H10.3292C10.7032 5.44828 11.0025 5.74384 11.0025 6.1133C11.0025 6.48276 10.7032 6.77833 10.3292 6.77833H9.38155C9.2818 6.77833 9.18205 6.82759 9.13218 6.87685L5.86534 10.4729C5.54115 10.8177 5.09228 11.0148 4.61846 11.0148Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path d="M3 5.5C3 6.32843 2.32843 7 1.5 7C0.671573 7 0 6.32843 0 5.5C0 4.67157 0.671573 4 1.5 4C2.32843 4 3 4.67157 3 5.5Z" />
				<path d="M3 10.5C3 11.3284 2.32843 12 1.5 12C0.671573 12 0 11.3284 0 10.5C0 9.67157 0.671573 9 1.5 9C2.32843 9 3 9.67157 3 10.5Z" />
				<path d="M11 1H14C14.5523 1 15 1.44772 15 2V14C15 14.5523 14.5523 15 14 15H11V1Z" />
				<path d="M9 1H6C5.44772 1 5 1.44772 5 2V14C5 14.5523 5.44772 15 6 15H9V1Z" />
			</g>
		</svg>`],["connection-elevator-14x14",`<svg viewBox="0 0 14 14">
			<path
				d="M7.476 2H2.72693C1.77095 2 1 2.72464 1 3.62319V10.3768C1 11.2754 1.77095 12 2.72693 12H7.476C8.43198 12 9.20293 11.2754 9.20293 10.3768V3.62319C9.17209 2.72464 8.40114 2 7.476 2ZM7.476 3.15942C7.75354 3.15942 7.96941 3.36232 7.96941 3.62319V10.3768C7.96941 10.6377 7.75354 10.8406 7.476 10.8406H5.71824V3.15942H7.476ZM4.48472 3.15942V10.8406H2.72693C2.44939 10.8406 2.23352 10.6377 2.23352 10.3768V3.62319C2.23352 3.36232 2.44939 3.15942 2.72693 3.15942H4.48472Z"
				stroke="none"
			/>
			<path
				d="M12.4643 6.19064H10.6638C10.4456 6.19064 10.2546 6.06243 10.1728 5.88294C10.0909 5.70346 10.1455 5.47269 10.2819 5.31884L11.1821 4.47269C11.4004 4.26756 11.755 4.26756 11.946 4.47269L12.8462 5.31884C13.0099 5.47269 13.0371 5.67781 12.9553 5.88294C12.8735 6.08807 12.6825 6.19064 12.4643 6.19064Z"
				stroke="none"
			/>
			<path
				d="M11.564 9.65216C11.4276 9.65216 11.2912 9.60088 11.1821 9.49831L10.2819 8.65216C10.1182 8.49831 10.0909 8.29319 10.1728 8.08806C10.2546 7.90857 10.4456 7.78036 10.6638 7.78036H12.4643C12.6825 7.78036 12.8735 7.90857 12.9553 8.08806C13.0371 8.26754 12.9826 8.49831 12.8462 8.65216L11.9459 9.49831C11.8641 9.60088 11.7004 9.65216 11.564 9.65216Z"
				stroke="none"
			/>
		</svg>`],["connection-elevator-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<circle cx="1.9375" cy="4.4375" r="0.9375" />
			<circle cx="1.9375" cy="7.5625" r="0.9375" />
			<path
				fillRule="evenodd"
				clipRule="evenodd"
				d="M7.6 2H9.4C9.73137 2 10 2.26863 10 2.6V9.41328C10 9.74465 9.73137 10.0133 9.4 10.0133H7.6V2ZM6.4 2H4.6C4.26863 2 4 2.26863 4 2.6V9.41328C4 9.74465 4.26863 10.0133 4.6 10.0133H6.4V2Z"
			/>
		</svg>`],["new-tab-14x14",`<svg viewBox="0 0 14 14">
			<g stroke="none">
				<path d="M2.625 2.625H5.6875C5.92913 2.625 6.125 2.42912 6.125 2.1875V1.3125C6.125 1.07088 5.92913 0.875 5.6875 0.875H1.3125C1.07088 0.875 0.875 1.07088 0.875 1.3125V12.6875C0.875 12.9291 1.07088 13.125 1.3125 13.125H12.6875C12.9291 13.125 13.125 12.9291 13.125 12.6875V8.3125C13.125 8.07088 12.9291 7.875 12.6875 7.875H11.8125C11.5709 7.875 11.375 8.07088 11.375 8.3125V11.375H2.625V2.625Z" />
				<path d="M12.9063 0.875H8.40311C8.20822 0.875 8.11063 1.11062 8.24843 1.24843L9.88124 2.88124L5.8156 6.94688C5.64475 7.11774 5.64475 7.39475 5.8156 7.5656L6.43432 8.18432C6.60517 8.35517 6.88218 8.35517 7.05304 8.18432L11.1187 4.11868L12.7516 5.75157C12.8894 5.88938 13.125 5.79178 13.125 5.59689V1.09375C13.125 0.972938 13.0271 0.875 12.9063 0.875Z" />
			</g>
		</svg>`],["compress-16x16",`<svg viewBox="0 0 16 16">
			<g stroke="none">
				<path
					id="Vector"
					d="M4.67773 10.7154H0.713449C0.556306 10.7154 0.427734 10.844 0.427734 11.0011V11.8583C0.427734 12.0154 0.556306 12.144 0.713449 12.144H3.82059V15.2868C3.82059 15.444 3.94916 15.5725 4.10631 15.5725H4.96345C5.12059 15.5725 5.24916 15.444 5.24916 15.2868V11.2868C5.24916 10.9708 4.99381 10.7154 4.67773 10.7154ZM4.96345 0.429688H4.10631C3.94916 0.429688 3.82059 0.558259 3.82059 0.715402V3.85826H0.713449C0.556306 3.85826 0.427734 3.98683 0.427734 4.14397V5.00112C0.427734 5.15826 0.556306 5.28683 0.713449 5.28683H4.67773C4.99381 5.28683 5.24916 5.03147 5.24916 4.7154V0.715402C5.24916 0.558259 5.12059 0.429688 4.96345 0.429688ZM15.2849 10.7154H11.3206C11.0045 10.7154 10.7492 10.9708 10.7492 11.2868V15.2868C10.7492 15.444 10.8777 15.5725 11.0349 15.5725H11.892C12.0492 15.5725 12.1777 15.444 12.1777 15.2868V12.144H15.2849C15.442 12.144 15.5706 12.0154 15.5706 11.8583V11.0011C15.5706 10.844 15.442 10.7154 15.2849 10.7154ZM15.2849 3.85826H12.1777V0.715402C12.1777 0.558259 12.0492 0.429688 11.892 0.429688H11.0349C10.8777 0.429688 10.7492 0.558259 10.7492 0.715402V4.7154C10.7492 5.03147 11.0045 5.28683 11.3206 5.28683H15.2849C15.442 5.28683 15.5706 5.15826 15.5706 5.00112V4.14397C15.5706 3.98683 15.442 3.85826 15.2849 3.85826Z"
				/>
			</g>
		</svg>`],["washroom-14x14",`<svg viewBox="0 0 14 14" stroke="none">
			<path d="M4.55125 3.09062C4.55125 3.69326 4.07639 4.18176 3.49058 4.18176C2.90525 4.18176 2.43039 3.69326 2.43039 3.09062C2.43039 2.4885 2.90525 2 3.49058 2C4.07639 2 4.55125 2.4885 4.55125 3.09062Z" />
			<path d="M5.1193 5.48047C4.81653 4.83116 4.17252 4.41571 3.47822 4.41571C2.78392 4.41571 2.13986 4.83116 1.83714 5.48047L1.04175 7.22034C0.940664 7.441 1.02893 7.70073 1.24393 7.81791C1.47077 7.90871 1.72324 7.81791 1.82433 7.59725L2.49349 6.15554L2.21587 11.4407C2.20305 11.7263 2.41805 11.9734 2.69567 11.9993C2.97329 12.0124 3.21344 11.7913 3.23859 11.5057L3.4028 8.285H3.567L3.73121 11.5057C3.74403 11.7913 3.97086 11.9993 4.23616 11.9993H4.26131C4.53893 11.9861 4.75343 11.7395 4.74111 11.4407L4.46349 6.15554L5.13265 7.59725C5.20858 7.75298 5.35997 7.85697 5.52418 7.85697C5.5873 7.85697 5.65042 7.84379 5.71354 7.81792C5.92804 7.71393 6.0163 7.44153 5.91572 7.22035L5.1193 5.48047Z" />
			<path d="M12.9582 7.22034L12.1505 5.48047C11.8477 4.83116 11.2037 4.41571 10.5094 4.41571C9.81513 4.41571 9.17107 4.83116 8.86836 5.48047L8.06064 7.22034C7.95955 7.441 8.04782 7.70073 8.26282 7.81791C8.47732 7.9219 8.7298 7.8311 8.84371 7.60993L9.52519 6.12977L9.46207 7.2204L8.57842 8.92184C8.47733 9.11663 8.61638 9.36316 8.83089 9.36316H9.33584L9.22242 11.4668C9.2096 11.7397 9.41177 11.9862 9.68939 11.9994C9.95469 12.0126 10.1943 11.8046 10.2072 11.519L10.3581 9.33723H10.6737L10.7871 11.5058C10.7999 11.7787 11.0144 11.9862 11.2792 11.9862H11.3043C11.5696 11.973 11.7841 11.7396 11.7713 11.4535L11.6579 9.33718H12.1628C12.3773 9.33718 12.5287 9.09066 12.4153 8.89586L11.5317 7.19442L11.4685 6.1038L12.1757 7.5972C12.2516 7.75293 12.403 7.85692 12.5672 7.85692C12.6303 7.85692 12.6934 7.84373 12.7566 7.81786C12.9711 7.70068 13.0593 7.44102 12.9582 7.22034Z" />
			<path d="M11.5696 3.09062C11.5696 3.69326 11.0948 4.18176 10.5094 4.18176C9.92363 4.18176 9.44876 3.69326 9.44876 3.09062C9.44876 2.4885 9.92363 2 10.5094 2C11.0948 2 11.5696 2.4885 11.5696 3.09062Z" />
			<path d="M6.99996 2.00006C6.76031 2.00006 6.57095 2.19485 6.57095 2.44138V11.5575C6.57095 11.804 6.76031 11.9988 6.99996 11.9988C7.2396 11.9988 7.42896 11.804 7.42896 11.5575V2.44138C7.42896 2.19485 7.2396 2.00006 6.99996 2.00006Z" />
		</svg>`],["point-of-interest-12x12",`<svg viewBox="0 0 12 12" stroke="none">
			<path
				stroke="none"
				id="Subtract"
				fill-rule="evenodd"
				clip-rule="evenodd"
				d="M6.24724 10.7516C7.94597 9.0358 9.85962 6.89195 9.85962 4.85965C9.85962 2.72802 8.13159 1 5.99997 1C3.86834 1 2.14032 2.72802 2.14032 4.85965C2.14032 6.89195 4.05397 9.0358 5.7527 10.7516C5.88904 10.8893 6.1109 10.8893 6.24724 10.7516ZM5.99994 6.26317C6.77508 6.26317 7.40345 5.6348 7.40345 4.85967C7.40345 4.08453 6.77508 3.45616 5.99994 3.45616C5.22481 3.45616 4.59644 4.08453 4.59644 4.85967C4.59644 5.6348 5.22481 6.26317 5.99994 6.26317Z"
			/>
		</svg>`],["flag-20x20",`<svg viewBox="0 0 20 20" stroke="none">
			<path
				d="M16.9987 4.27111C16.936 5.06715 16.3836 5.93162 15.5238 6.57845C14.7549 7.15682 13.0885 8.04927 10.5434 7.55174C8.32167 7.1164 6.82156 8.02129 6.08085 10.2416L8.24615 17.3998C8.31833 17.6471 8.17711 17.9059 7.9292 17.9813C7.88527 17.9938 7.83976 18 7.79426 18C7.58634 18 7.40277 17.8647 7.34236 17.6673L5.1644 10.4686C5.13773 10.4173 5.12125 10.3613 5.11419 10.3038L3.41956 4.70042C3.38112 4.63512 3.35994 4.56127 3.3568 4.48587L3.02101 3.37886C2.98413 3.25992 2.9959 3.13165 3.05553 3.02203C3.11437 2.91242 3.21479 2.83079 3.33482 2.79504C3.45564 2.75928 3.5851 2.7725 3.69494 2.83235C3.80477 2.89144 3.88637 2.99172 3.92167 3.11143L3.9813 3.31355C4.38847 2.85956 4.90472 2.51439 5.48136 2.30915C6.97201 1.75566 8.95216 1.95467 10.6469 2.83156C11.6888 3.36951 14.3374 4.54493 16.3647 3.79553C16.5154 3.74111 16.684 3.76599 16.8127 3.86239C16.9406 3.95879 17.0105 4.11251 16.9987 4.27111Z"
				stroke="none"
			/>
		</svg>`],["link-16x16",`<svg viewBox="0 0 16 16" stroke="none">
			<path
				d="M9.10678 11.2433C9.07993 11.2167 9.04367 11.2018 9.00589 11.2018C8.9681 11.2018 8.93184 11.2167 8.90499 11.2433L6.82999 13.3183C5.86928 14.279 4.24785 14.3808 3.18714 13.3183C2.12464 12.2558 2.22642 10.6362 3.18714 9.67546L5.26214 7.60046C5.31749 7.5451 5.31749 7.45403 5.26214 7.39868L4.55142 6.68796C4.52457 6.66138 4.48832 6.64646 4.45053 6.64646C4.41274 6.64646 4.37649 6.66138 4.34964 6.68796L2.27464 8.76296C0.763923 10.2737 0.763923 12.7183 2.27464 14.2272C3.78535 15.7362 6.22999 15.738 7.73892 14.2272L9.81392 12.1522C9.86928 12.0969 9.86928 12.0058 9.81392 11.9505L9.10678 11.2433ZM13.7246 2.77903C12.2139 1.26832 9.76928 1.26832 8.26035 2.77903L6.18357 4.85403C6.15698 4.88088 6.14207 4.91714 6.14207 4.95493C6.14207 4.99271 6.15698 5.02897 6.18357 5.05582L6.89249 5.76475C6.94785 5.8201 7.03892 5.8201 7.09428 5.76475L9.16928 3.68975C10.13 2.72903 11.7514 2.62725 12.8121 3.68975C13.8746 4.75225 13.7729 6.37189 12.8121 7.3326L10.7371 9.4076C10.7106 9.43445 10.6956 9.47071 10.6956 9.5085C10.6956 9.54628 10.7106 9.58254 10.7371 9.60939L11.4479 10.3201C11.5032 10.3755 11.5943 10.3755 11.6496 10.3201L13.7246 8.2451C15.2336 6.73439 15.2336 4.28975 13.7246 2.77903ZM9.75142 6.00939C9.72457 5.9828 9.68832 5.96789 9.65053 5.96789C9.61275 5.96789 9.57649 5.9828 9.54964 6.00939L5.50499 10.0522C5.47841 10.0791 5.46349 10.1154 5.46349 10.1531C5.46349 10.1909 5.47841 10.2272 5.50499 10.254L6.21214 10.9612C6.26749 11.0165 6.35857 11.0165 6.41392 10.9612L10.4568 6.91832C10.5121 6.86296 10.5121 6.77189 10.4568 6.71653L9.75142 6.00939Z"
				stroke="none"
			/>
		</svg>`]]),Pwe=/<svg([^>]*)>/g;function pee(i,e,t){let r=Twe.get(i);return r?r.replace(Pwe,`<svg$1 xmlns="http://www.w3.org/2000/svg" style="fill:${e}; width:${t}px; height:${t}px">`):""}h(pee,"getStyledIcon");var kc,Nf,m0,TM,PM,T8,AM,P8,g0,Ib,IM,A8,dee=class{constructor(e,t){fe(this,m0),fe(this,PM),fe(this,AM),fe(this,g0),fe(this,IM),fe(this,kc,void 0),fe(this,Nf,void 0),ie(this,"colors",{default:"#3D5676",connection:"#128387",washroom:"#3161B4",point:"#AD468F"}),Re(this,kc,e),Re(this,Nf,t)}auto(){let e=M(this,Nf)[Object.keys(M(this,Nf))[0]];[...e.getByType("connection"),...e.getByType("point-of-interest"),...e.getByType("space")].forEach(t=>{t.__type==="connection"?t.coordinates.forEach(r=>{M(this,kc).Labels.add(r,t.name,$t(this,m0,TM).call(this,t))}):(t.__type==="space"&&t.name!==""&&M(this,kc).updateState(t,{interactive:!0,hoverColor:"#F0F0F0"}),M(this,kc).Labels.add(t,t.name,$t(this,m0,TM).call(this,t)))})}};kc=new WeakMap,Nf=new WeakMap,m0=new WeakSet,TM=h(function(i){let e=pee($t(this,PM,T8).call(this,i),"white",12);return{appearance:{text:{foregroundColor:$t(this,g0,Ib).call(this,i)},marker:{foregroundColor:{active:$t(this,g0,Ib).call(this,i)},icon:e,iconSize:12}},interactive:!0,rank:$t(this,IM,A8).call(this,i)}},"#generatLabelAppearance"),PM=new WeakSet,T8=h(function(i){return i.__type==="connection"?$t(this,AM,P8).call(this,i.type):i.name.includes("Washroom")?"washroom-14x14":i.__type==="point-of-interest"?"point-of-interest-12x12":""},"#getIconName"),AM=new WeakSet,P8=h(function(i){let e="";switch(i){case"elevator":e="connection-elevator-12x12";break;case"escalator":e="connection-escalator-12x12";break;case"stairs":e="connection-stairs-12x12";break}return e},"#attemptIconNameForConnection"),g0=new WeakSet,Ib=h(function(i){return i.__type==="connection"?this.colors.connection:i.__type==="point-of-interest"?this.colors.point:"name"in i&&i.name.includes("Washroom")?this.colors.washroom:this.colors.default},"#getLabelColor"),IM=new WeakSet,A8=h(function(i){return i.__type==="connection"?"high":(i.__type,"medium")},"#getDefaultLabelRank"),h(dee,"Labels");var Awe=dee,fee=class{constructor(e,t){Z(this,"Labels");Z(this,"auto",()=>{this.Labels.auto()});this.Labels=new Awe(e,t)}};h(fee,"DefaultTheme");var Iwe=fee;R();var Hi,mee=class{constructor(e){fe(this,Hi,void 0),ie(this,"setMinPitch",t=>{M(this,Hi).camera.setMinPitch(t)}),ie(this,"setMaxPitch",t=>{M(this,Hi).camera.setMaxPitch(t)}),ie(this,"setMinZoomLevel",t=>{M(this,Hi).camera.setMinZoomLevel(t)}),ie(this,"setMaxZoomLevel",t=>{M(this,Hi).camera.setMaxZoomLevel(t)}),Re(this,Hi,e)}setScreenOffsets(e){M(this,Hi).camera.setInsetPadding(e)}focusOn(e,t){var r;let n=[],a=Array.isArray(e)?e:[e];for(let o of a)if(N_.is(o)){let s;for(s of o.coordinates)n.push([s.longitude,s.latitude])}else if(z_.is(o)||gh.is(o)||yh.is(o)){let s=M(this,Hi).getBoundingArea(o.id);s&&n.push(...s)}else{let s=Qu(o);if(s){let l=0;s.floorId&&(l=((r=M(this,Hi).getState(s.floorId))==null?void 0:r.altitude)||0),n.push([s.longitude,s.latitude,l])}}return M(this,Hi).camera.focusOn(n,{pitch:t==null?void 0:t.pitch,bearing:t==null?void 0:t.bearing,padding:t==null?void 0:t.screenOffsets,maxZoomLevel:t==null?void 0:t.maxZoomLevel,minZoomLevel:t==null?void 0:t.minZoomLevel,duration:t==null?void 0:t.duration,easing:t==null?void 0:t.easing})}animateTo(e,t){var r;let{center:n,zoomLevel:a,bearing:o,pitch:s}=e,l=n??this.center,u=[l.longitude,l.latitude];return M(this,Hi).camera.animateTo({center:u,zoomLevel:a??this.zoomLevel,bearing:o??this.bearing,pitch:s??this.pitch,duration:(r=t==null?void 0:t.duration)!=null?r:600,easing:t==null?void 0:t.easing})}set(e){let{center:t=this.center,zoomLevel:r=this.zoomLevel,bearing:n=this.bearing,pitch:a=this.pitch}=e,o=[t.longitude,t.latitude];M(this,Hi).camera.setCenter(o),M(this,Hi).camera.setZoomLevel(r),M(this,Hi).camera.setBearing(n),M(this,Hi).camera.setPitch(a)}get center(){let e=M(this,Hi).camera.center;return new br(e[1],e[0],void 0)}get zoomLevel(){return M(this,Hi).camera.zoomLevel}get pitch(){return M(this,Hi).camera.pitch}get minPitch(){return M(this,Hi).camera.minPitch}get maxPitch(){return M(this,Hi).camera.maxPitch}get bearing(){let e=M(this,Hi).camera.bearing;return(e<0?e+360:e)%360}get minZoomLevel(){return M(this,Hi).camera.minZoomLevel}get maxZoomLevel(){return M(this,Hi).camera.maxZoomLevel}};Hi=new WeakMap,h(mee,"Camera");var Lwe=mee;R();R();R();R();R();R();R();R();function gee(i){let e=+this._x.call(null,i),t=+this._y.call(null,i);return QT(this.cover(e,t),e,t,i)}h(gee,"default");function QT(i,e,t,r){if(isNaN(e)||isNaN(t))return i;var n,a=i._root,o={data:r},s=i._x0,l=i._y0,u=i._x1,c=i._y1,p,d,m,g,_,y,x,w;if(!a)return i._root=o,i;for(;a.length;)if((_=e>=(p=(s+u)/2))?s=p:u=p,(y=t>=(d=(l+c)/2))?l=d:c=d,n=a,!(a=a[x=y<<1|_]))return n[x]=o,i;if(m=+i._x.call(null,a.data),g=+i._y.call(null,a.data),e===m&&t===g)return o.next=a,n?n[x]=o:i._root=o,i;do n=n?n[x]=new Array(4):i._root=new Array(4),(_=e>=(p=(s+u)/2))?s=p:u=p,(y=t>=(d=(l+c)/2))?l=d:c=d;while((x=y<<1|_)===(w=(g>=d)<<1|m>=p));return n[w]=a,n[x]=o,i}h(QT,"add");function yee(i){var e,t,r=i.length,n,a,o=new Array(r),s=new Array(r),l=1/0,u=1/0,c=-1/0,p=-1/0;for(t=0;t<r;++t)isNaN(n=+this._x.call(null,e=i[t]))||isNaN(a=+this._y.call(null,e))||(o[t]=n,s[t]=a,n<l&&(l=n),n>c&&(c=n),a<u&&(u=a),a>p&&(p=a));if(l>c||u>p)return this;for(this.cover(l,u).cover(c,p),t=0;t<r;++t)QT(this,o[t],s[t],i[t]);return this}h(yee,"addAll");R();function vee(i,e){if(isNaN(i=+i)||isNaN(e=+e))return this;var t=this._x0,r=this._y0,n=this._x1,a=this._y1;if(isNaN(t))n=(t=Math.floor(i))+1,a=(r=Math.floor(e))+1;else{for(var o=n-t||1,s=this._root,l,u;t>i||i>=n||r>e||e>=a;)switch(u=(e<r)<<1|i<t,l=new Array(4),l[u]=s,s=l,o*=2,u){case 0:n=t+o,a=r+o;break;case 1:t=n-o,a=r+o;break;case 2:n=t+o,r=a-o;break;case 3:t=n-o,r=a-o;break}this._root&&this._root.length&&(this._root=s)}return this._x0=t,this._y0=r,this._x1=n,this._y1=a,this}h(vee,"default");R();function xee(){var i=[];return this.visit(function(e){if(!e.length)do i.push(e.data);while(e=e.next)}),i}h(xee,"default");R();function _ee(i){return arguments.length?this.cover(+i[0][0],+i[0][1]).cover(+i[1][0],+i[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}h(_ee,"default");R();R();function pn(i,e,t,r,n){this.node=i,this.x0=e,this.y0=t,this.x1=r,this.y1=n}h(pn,"default");function bee(i,e,t){var r,n=this._x0,a=this._y0,o,s,l,u,c=this._x1,p=this._y1,d=[],m=this._root,g,_;for(m&&d.push(new pn(m,n,a,c,p)),t==null?t=1/0:(n=i-t,a=e-t,c=i+t,p=e+t,t*=t);g=d.pop();)if(!(!(m=g.node)||(o=g.x0)>c||(s=g.y0)>p||(l=g.x1)<n||(u=g.y1)<a))if(m.length){var y=(o+l)/2,x=(s+u)/2;d.push(new pn(m[3],y,x,l,u),new pn(m[2],o,x,y,u),new pn(m[1],y,s,l,x),new pn(m[0],o,s,y,x)),(_=(e>=x)<<1|i>=y)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-_],d[d.length-1-_]=g)}else{var w=i-+this._x.call(null,m.data),b=e-+this._y.call(null,m.data),C=w*w+b*b;if(C<t){var E=Math.sqrt(t=C);n=i-E,a=e-E,c=i+E,p=e+E,r=m.data}}return r}h(bee,"default");R();function wee(i){if(isNaN(c=+this._x.call(null,i))||isNaN(p=+this._y.call(null,i)))return this;var e,t=this._root,r,n,a,o=this._x0,s=this._y0,l=this._x1,u=this._y1,c,p,d,m,g,_,y,x;if(!t)return this;if(t.length)for(;;){if((g=c>=(d=(o+l)/2))?o=d:l=d,(_=p>=(m=(s+u)/2))?s=m:u=m,e=t,!(t=t[y=_<<1|g]))return this;if(!t.length)break;(e[y+1&3]||e[y+2&3]||e[y+3&3])&&(r=e,x=y)}for(;t.data!==i;)if(n=t,!(t=t.next))return this;return(a=t.next)&&delete t.next,n?(a?n.next=a:delete n.next,this):e?(a?e[y]=a:delete e[y],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[x]=t:this._root=t),this):(this._root=a,this)}h(wee,"default");function See(i){for(var e=0,t=i.length;e<t;++e)this.remove(i[e]);return this}h(See,"removeAll");R();function Mee(){return this._root}h(Mee,"default");R();function Cee(){var i=0;return this.visit(function(e){if(!e.length)do++i;while(e=e.next)}),i}h(Cee,"default");R();function Eee(i){var e=[],t,r=this._root,n,a,o,s,l;for(r&&e.push(new pn(r,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!i(r=t.node,a=t.x0,o=t.y0,s=t.x1,l=t.y1)&&r.length){var u=(a+s)/2,c=(o+l)/2;(n=r[3])&&e.push(new pn(n,u,c,s,l)),(n=r[2])&&e.push(new pn(n,a,c,u,l)),(n=r[1])&&e.push(new pn(n,u,o,s,c)),(n=r[0])&&e.push(new pn(n,a,o,u,c))}return this}h(Eee,"default");R();function Tee(i){var e=[],t=[],r;for(this._root&&e.push(new pn(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var n=r.node;if(n.length){var a,o=r.x0,s=r.y0,l=r.x1,u=r.y1,c=(o+l)/2,p=(s+u)/2;(a=n[0])&&e.push(new pn(a,o,s,c,p)),(a=n[1])&&e.push(new pn(a,c,s,l,p)),(a=n[2])&&e.push(new pn(a,o,p,c,u)),(a=n[3])&&e.push(new pn(a,c,p,l,u))}t.push(r)}for(;r=t.pop();)i(r.node,r.x0,r.y0,r.x1,r.y1);return this}h(Tee,"default");R();function Pee(i){return i[0]}h(Pee,"defaultX");function Aee(i){return arguments.length?(this._x=i,this):this._x}h(Aee,"default");R();function Iee(i){return i[1]}h(Iee,"defaultY");function Lee(i){return arguments.length?(this._y=i,this):this._y}h(Lee,"default");function eP(i,e,t){var r=new U_(e??Pee,t??Iee,NaN,NaN,NaN,NaN);return i==null?r:r.addAll(i)}h(eP,"quadtree");function U_(i,e,t,r,n,a){this._x=i,this._y=e,this._x0=t,this._y0=r,this._x1=n,this._y1=a,this._root=void 0}h(U_,"Quadtree");function LM(i){for(var e={data:i.data},t=e;i=i.next;)t=t.next={data:i.data};return e}h(LM,"leaf_copy");var Dn=eP.prototype=U_.prototype;Dn.copy=function(){var i=new U_(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,r;if(!e)return i;if(!e.length)return i._root=LM(e),i;for(t=[{source:e,target:i._root=new Array(4)}];e=t.pop();)for(var n=0;n<4;++n)(r=e.source[n])&&(r.length?t.push({source:r,target:e.target[n]=new Array(4)}):e.target[n]=LM(r));return i};Dn.add=gee;Dn.addAll=yee;Dn.cover=vee;Dn.data=xee;Dn.extent=_ee;Dn.find=bee;Dn.remove=wee;Dn.removeAll=See;Dn.root=Mee;Dn.size=Cee;Dn.visit=Eee;Dn.visitAfter=Tee;Dn.x=Aee;Dn.y=Lee;R();R();var Dee=class{constructor({origin:e,destination:t,distance:r=0,angle:n=0,pathWeight:a=0}){Z(this,"origin");Z(this,"destination");Z(this,"distance");Z(this,"angle");Z(this,"weight");this.origin=e,this.destination=t,this.distance=r,this.angle=n;let o=a||0;if(this.weight=o>=0?this.distance+o:0,isNaN(this.angle))throw new Error("nan angle")}};h(Dee,"Edge");var DM=Dee;R();R();R();function kee(i,e,t){if(t===void 0&&(t={}),!i)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=Zl(i),n=bQ(e),a=n.type,o=e.bbox,s=n.coordinates;if(o&&Ree(r,o)===!1)return!1;a==="Polygon"&&(s=[s]);for(var l=!1,u=0;u<s.length&&!l;u++)if(kM(r,s[u][0],t.ignoreBoundary)){for(var c=!1,p=1;p<s[u].length&&!c;)kM(r,s[u][p],!t.ignoreBoundary)&&(c=!0),p++;c||(l=!0)}return l}h(kee,"booleanPointInPolygon");function kM(i,e,t){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var n=0,a=e.length-1;n<e.length;a=n++){var o=e[n][0],s=e[n][1],l=e[a][0],u=e[a][1],c=i[1]*(o-l)+s*(l-i[0])+u*(i[0]-o)===0&&(o-i[0])*(l-i[0])<=0&&(s-i[1])*(u-i[1])<=0;if(c)return!t;var p=s>i[1]!=u>i[1]&&i[0]<(l-o)*(i[1]-s)/(u-s)+o;p&&(r=!r)}return r}h(kM,"inRing");function Ree(i,e){return e[0]<=i[0]&&e[1]<=i[1]&&e[2]>=i[0]&&e[3]>=i[1]}h(Ree,"inBBox");R();R();function eh([i,e],[t,r]){let n=e-r,a=i-t;return(Math.atan2(a,n)+Math.PI*3)%(Math.PI*2)}h(eh,"getAngle");R();var Dwe=63710088e-1;function Dp(i,e){let[t,r]=i.map(c=>c*Math.PI/180),[n,a]=e.map(c=>c*Math.PI/180),o=a-r,s=n-t,l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(r)*Math.cos(a)*Math.sin(s/2)*Math.sin(s/2),u=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return Dwe*u}h(Dp,"getDistance");R();R();function y0(i,e,t,r){let[n,a]=i,[o,s]=e,[l,u]=t,[c,p]=r;if(a===s&&n===o||u===p&&l===c)return null;let d=(c-l)*(s-a)-(p-u)*(o-n);if(d===0)return null;let m=((p-u)*(n-l)-(c-l)*(a-u))/d,g=((s-a)*(n-l)-(o-n)*(a-u))/d;if(m<0||m>1||g<0||g>1)return null;let _=a+m*(s-a);return[n+m*(o-n),_]}h(y0,"getLineIntersection");R();function RM(i,e,t,r){let n=Qm(i,t/1e3,r),a=Qm(e,t/1e3,r);return[n.geometry.coordinates,a.geometry.coordinates]}h(RM,"getOffsetLine");R();function FM(i){let e=i*(180/Math.PI);return e=e%360,e>180?e-=360:e<-180&&(e+=360),Object.is(e,-0)?0:e}h(FM,"radToDegNormalized");function Fee(i,e,t=[],r=0){let n=!0,a=i.geometry.coordinates,o=e.geometry.coordinates,s=FM(eh(a,o)-Math.PI/2),l=FM(eh(a,o)+Math.PI/2);return t.forEach(u=>{if(r>0){let c=RM(a,o,r,s),p=RM(a,o,r,l);if(y0(c[0],c[1],u[0],u[1])||y0(p[0],p[1],u[0],u[1])){n=!1;return}}else if(y0(a,o,u[0],u[1])){n=!1;return}}),n}h(Fee,"hasLineOfSight");var Rc,v0,OM,BM,Oee,zM,Bee,NM,zee,$M,Nee,UM,$ee,VM,Uee,jM,Vee=class{constructor({nodes:e,groupBy:t}){fe(this,v0),fe(this,BM),fe(this,zM),fe(this,NM),fe(this,$M),fe(this,UM),fe(this,VM),ie(this,"edges",{}),ie(this,"nodesById"),ie(this,"nodesByGroup",new Map),fe(this,Rc,void 0),fe(this,jM,h((n,a)=>{let o=0;for(let s of a)(!s[M(this,Rc)]||s[M(this,Rc)]===n.properties[M(this,Rc)])&&kee(n.geometry.coordinates,s.geometry.geometry)&&(o+=Math.max(0,s.cost));return o},"#getZonalCost")),Re(this,Rc,t);let{features:r}=e;this.nodesById=$t(this,BM,Oee).call(this,r),$t(this,zM,Bee).call(this),$t(this,NM,zee).call(this,r,t)}getShortestEuclideanDistance(e,t){return t.reduce((r,n)=>{let a=Dp(e.geometry.coordinates,n.geometry.coordinates);return Math.min(r,a)},Number.MAX_VALUE)}aStar({originIds:e,destinationNodeIds:t,excludedNodeIds:r,zones:n}){let a=$t(this,v0,OM).call(this,e),o=$t(this,v0,OM).call(this,t);if(a.length===0||o.length===0)return[];let{frontier:s,cameFrom:l,costSoFar:u}=$t(this,$M,Nee).call(this,a,o);for(;s.length>0;){let c=s.shift();if(!c)break;if($t(this,UM,$ee).call(this,c.origin,o))return $t(this,VM,Uee).call(this,l,c.origin.properties.id);for(let p of this.edges[c.origin.properties.id]){let d=u[c.origin.properties.id]+p.weight+M(this,jM).call(this,p.destination,n);if(!(d===1/0||r!=null&&r.has(p.destination.properties.id))&&(u[p.destination.properties.id]==null||d<u[p.destination.properties.id])){let m=d+this.getShortestEuclideanDistance(p.destination,o);u[p.destination.properties.id]=d,l[p.destination.properties.id]=p,s.push({origin:p.destination,priority:m})}}s.sort((p,d)=>p.priority-d.priority)}return[]}};Rc=new WeakMap,v0=new WeakSet,OM=h(function(i){return i.map(e=>this.nodesById[e]).filter(Boolean)},"#filterValidNodes"),BM=new WeakSet,Oee=h(function(i){return i.reduce((e,t)=>(e[t.properties.id]=t,e),{})},"#createNodesById"),zM=new WeakSet,Bee=h(function(){for(let i in this.nodesById)this.nodesById.hasOwnProperty(i)&&(this.nodesById[i].properties.neighbors=this.nodesById[i].properties.neighbors.filter(({id:e})=>!!this.nodesById[e]))},"#removeInvalidNeighbors"),NM=new WeakSet,zee=h(function(i,e){i.forEach(t=>{let r=e==="default"?e:t.properties[e];this.nodesByGroup.has(r)||this.nodesByGroup.set(r,[]),this.nodesByGroup.get(r).push(t),this.edges[t.properties.id]=t.properties.neighbors.map(({id:n,weight:a})=>{let o=this.nodesById[n],s=Dp(t.geometry.coordinates,o.geometry.coordinates),l=eh(t.geometry.coordinates,o.geometry.coordinates);return new DM({origin:t,destination:o,pathWeight:a,distance:s,angle:l})})})},"#initializeEdgesAndGroups"),$M=new WeakSet,Nee=h(function(i,e){let t=[],r={},n={};return i.forEach(a=>{let o=this.getShortestEuclideanDistance(a,e);t.push({origin:a,priority:o}),r[a.properties.id]=null,n[a.properties.id]=0}),t.sort((a,o)=>a.priority-o.priority),{frontier:t,cameFrom:r,costSoFar:n}},"#initializeSearch"),UM=new WeakSet,$ee=h(function(i,e){return e.some(t=>t.properties.id===i.properties.id)},"#isDestinationNode"),VM=new WeakSet,Uee=h(function(i,e){let t=[],r=i[e];for(;r;)t.push(r),r=i[r.origin.properties.id];return t.reverse()},"#reconstructPath"),jM=new WeakMap,h(Vee,"NavigationGraph");var kwe=Vee,Rwe=.4,jee=class{constructor({nodes:e,obstructions:t,groupBy:r="default"}){Z(this,"groupBy");Z(this,"graph");Z(this,"geometryEdgesByMapId",new Map);Z(this,"cache",{nodeTreesByGroup:new Map});Z(this,"findNearestNode",e=>{var t;let r=this.groupBy==="default"?this.groupBy:e.properties[this.groupBy];if(!this.cache.nodeTreesByGroup.has(r)){let n=(t=this.graph.nodesByGroup.get(r))!=null?t:[],a=eP();a.x(o=>o.geometry.coordinates[1]),a.y(o=>o.geometry.coordinates[0]),a.addAll(n),this.cache.nodeTreesByGroup.set(r,a)}return this.cache.nodeTreesByGroup.get(r).find(e.geometry.coordinates[1],e.geometry.coordinates[0])||null});Z(this,"generatePath",e=>{let{destination:t}=e[e.length-1],r={type:"FeatureCollection",features:[]};for(let a=0;a<e.length;a++){let{origin:o}=e[a],s={id:o.properties.id,angle:e[a].angle,distance:e[a].distance};this.groupBy!=="default"&&(s.groupBy=o.properties[this.groupBy]),r.features.push({type:"Feature",geometry:{type:"Point",coordinates:[o.geometry.coordinates[0],o.geometry.coordinates[1]]},properties:s})}let n={id:t.properties.id};return this.groupBy!=="default"&&(n.groupBy=t.properties[this.groupBy]),r.features.push({type:"Feature",geometry:{type:"Point",coordinates:[t.geometry.coordinates[0],t.geometry.coordinates[1]]},properties:n}),r});Z(this,"getDistance",(e,t)=>Dp(e,t));Z(this,"getAngle",(e,t)=>eh(e,t));this.groupBy=r,this.graph=new kwe({nodes:e,groupBy:this.groupBy}),t&&t.features.forEach(n=>{let a=n.geometry.coordinates.length===1?n.geometry.coordinates[0]:n.geometry.coordinates,o=this.groupBy==="default"?this.groupBy:n.properties[this.groupBy];this.geometryEdgesByMapId.has(o)||this.geometryEdgesByMapId.set(o,[]),a.forEach((s,l)=>{this.geometryEdgesByMapId.get(o).push([s,a[l+1]||a[0]])})})}getDirections({zones:e,originIds:t,destinationNodeIds:r,excludedNodeIds:n,simplify:a}){var o,s;let l=(o=a==null?void 0:a.enabled)!=null?o:!0,u=e??[],c=this.graph.aStar({originIds:t,destinationNodeIds:r,zones:u,excludedNodeIds:new Set(n)});return c.length===0?{type:"FeatureCollection",features:[]}:(l&&(c=this.simplifyAllSteps(c,(s=a==null?void 0:a.bufferRadius)!=null?s:Rwe)),this.generatePath(c))}simplifyAllSteps(e,t){var r,n;let a=[],o=[e[0]];for(let c=1;c<e.length;c++){if(this.groupBy!=="default"&&e[c].origin.properties[this.groupBy]!==e[c-1].origin.properties[this.groupBy]){let p=e[c-1].origin.properties[this.groupBy],d=(r=this.geometryEdgesByMapId.get(p))!=null?r:[];a.push(...this.simplifySteps(o,d,t)),o=[e[c]]}o.push(e[c])}let s=e[e.length-1],l=this.groupBy==="default"?this.groupBy:s.origin.properties[this.groupBy],u=(n=this.geometryEdgesByMapId.get(l))!=null?n:[];return a.push(...this.simplifySteps(o,u,t)),a}simplifySteps(e,t,r){if(e.length<3)return e;let n=[e[0]],a=1;for(let o=a+2;o<e.length;o++)if(!Fee(e[a].origin,e[o].origin,t,r)){let s=o-1;n.push(new DM({...e[a],destination:e[s].origin,distance:Dp(e[a].origin.geometry.coordinates,e[s].origin.geometry.coordinates),angle:eh(e[a].origin.geometry.coordinates,e[s].origin.geometry.coordinates)})),a=s}return n.push(new DM({...e[a],destination:e[e.length-1].origin,distance:Dp(e[a].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates),angle:eh(e[a].origin.geometry.coordinates,e[e.length-1].origin.geometry.coordinates)}),e[e.length-1]),n}};h(jee,"Navigator");var Fwe=jee;R();function kp(i){return[i.longitude,i.latitude]}h(kp,"convertCoordinateToPosition");function Hee(i){return new Map(i.map(e=>{let{properties:t}=e,{id:r}=t;return[r,e]}))}h(Hee,"getEntranceMap");var I8=h((i,e)=>{let t=Hee(e),r={type:"Feature",properties:{id:i[0].properties.id},geometry:{type:"MultiLineString",coordinates:[]}};for(let n of i){let a=[n.geometry.coordinates],o=(n.properties.entrances||[]).reduce((s,l)=>(t.has(l)&&s.push(t.get(l)),s),[]);o.length&&(a=$Q(n,o).map(s=>s.geometry.coordinates)),r.geometry.coordinates.push(...a)}return r},"cutEntrancesFromLineStrings");function Gee(i,e){let t={options:{}};if(!t.options)throw new Error("options should exist");return i.appearance&&(t.options.appearance=i.appearance),i.rank!=null&&(i.rank==="initial"?t.options.rank=e.initialRank||2:t.options.rank=i.rank),i.enabled!==void 0&&(t.enabled=i.enabled),i.interactive!==null&&(t.options.interactive=i.interactive),t}h(Gee,"translateLabelStateToGeojsonCore");function Wee(i,e){let t={options:{}};if(!t.options)throw new Error("options should exist");return i.rank!=null&&(i.rank==="initial"?t.options.rank=e.initialRank||2:t.options.rank=i.rank),i.enabled!==void 0&&(t.enabled=i.enabled),i.interactive!==null&&(t.options.interactive=i.interactive),t}h(Wee,"translateMarkerStateToGeojsonCore");function Xee(i,e){let t={};return e==null||(i.color&&(i.color==="initial"?t.color=e.initialColor:t.color=i.color),i.hoverColor&&(t.hoverColor=i.hoverColor),i.interactive!==void 0&&(t.interactive=i.interactive),i.visible!==void 0&&(t.visible=i.visible)),t}h(Xee,"translateSpaceStateToGeojsonCore");function qee(i,e){return((e-i+Math.PI)%(Math.PI*2)+Math.PI*2)%(Math.PI*2)-Math.PI}h(qee,"differenceBetweenAngles");function Zee(i,e){let t="Left";return i<=-Math.PI/4?t="Right":i<=-e?t="SlightRight":i<=e?t="Straight":i<=Math.PI/4?t="SlightLeft":t="Left",t}h(Zee,"getRelativeBearing");function Yee(i){let e={};for(let t in i){let r=i[t];if(r!=null){if(r.id=t,"polygons"in r)for(let n of r.polygons)e[n]=r;else if("lineStrings"in r)for(let n of r.lineStrings)e[n]=r;else if("points"in r)for(let n of r.points)e[n]=r}}return e}h(Yee,"extractStyleMap");function HM(i,e){return i.reduce((t,r)=>{let n=e[r.properties.id];return n==null||(t.has(n)||t.set(n,[]),t.get(n).push(r)),t},new Map)}h(HM,"groupGeometryByStyle");function $f(i,e={}){var t,r,n,a,o,s;let l={...i},u=(r=(t=e==null?void 0:e.style)==null?void 0:t.shading)!=null?r:e==null?void 0:e.shadingAndOutlines;if(u===!0?l.shading={start:.1,end:.15,intensity:.4}:typeof u=="object"&&(l.shading={start:u.start,end:u.end,intensity:u.intensity}),l.outline=(a=(n=e==null?void 0:e.style)==null?void 0:n.outlines)!=null?a:e==null?void 0:e.shadingAndOutlines,"lineStrings"in i){let c=(s=(o=e==null?void 0:e.style)==null?void 0:o.wallTopColor)!=null?s:e==null?void 0:e.wallTopColor;c!=null&&(l.topColor=c)}return l}h($f,"translateToCoreStyle");var L8=Math.PI*.1,On,Cs,oo,GM,Jee,x0,Lb,WM,D8,Kee=class{constructor(e,t){fe(this,GM),fe(this,x0),fe(this,WM),fe(this,On,{}),fe(this,Cs,void 0),fe(this,oo,void 0),Re(this,Cs,t),Re(this,oo,e.features),Re(this,Cs,t),Re(this,oo,e.features)}get coordinates(){return M(this,On).coordinates?M(this,On).coordinates:(M(this,On).coordinates=M(this,oo).map(e=>new br(e.geometry.coordinates[1],e.geometry.coordinates[0],e.properties.groupBy)),M(this,On).coordinates)}get distance(){return M(this,On).distance?M(this,On).distance:(M(this,On).distance=M(this,oo).reduce((e,t)=>e+(t.properties.distance||0),0),M(this,On).distance)}get instructions(){if(M(this,oo).length<2)return[];if(M(this,On).instructions)return M(this,On).instructions;let e=[],t=0;for(let r=0;r<M(this,oo).length;r++){let n=M(this,oo)[r],a=M(this,oo)[r-1],o=M(this,oo)[r+1],s=new br(n.geometry.coordinates[1],n.geometry.coordinates[0],n.properties.groupBy),l=$t(this,GM,Jee).call(this,{prevDirection:a,direction:n,nextDirection:o});t+=(a==null?void 0:a.properties.distance)||0;for(let u of l)u&&(e.push({action:u,distance:t,coordinate:s}),t=0)}return M(this,On).instructions=e,M(this,On).instructions}};On=new WeakMap,Cs=new WeakMap,oo=new WeakMap,GM=new WeakSet,Jee=h(function(i){let{prevDirection:e,direction:t,nextDirection:r}=i,n=e&&M(this,Cs).getById("floor",e.properties.groupBy),a=M(this,Cs).getById("floor",t.properties.groupBy),o=r&&M(this,Cs).getById("floor",r.properties.groupBy),s=[];if(e||s.push({type:"Departure"}),o&&a.id!==o.id){let l=M(this,Cs).getMVFFeatureByNodeId("connection",t.properties.id);s.push($t(this,x0,Lb).call(this,"TakeConnection",a,o,l==null?void 0:l.type))}else if(n&&n.id!==a.id){let l=M(this,Cs).getMVFFeatureByNodeId("connection",t.properties.id);s.push($t(this,x0,Lb).call(this,"ExitConnection",a,n,l==null?void 0:l.type))}else s.push($t(this,WM,D8).call(this,e,t));return r||s.push({type:"Arrival"}),s},"#getActions"),x0=new WeakSet,Lb=h(function(i,e,t,r){let n=e.elevation-t.elevation,a="none";return n>0?a="down":n<0&&(a="up"),{type:i,fromFloor:e,toFloor:t,direction:a,connectionType:r??"stairs"}},"#createConnectionAction"),WM=new WeakSet,D8=h(function(i,e){let t=i?-qee(i.properties.angle,e.properties.angle):0;return Math.abs(t)>=L8?{type:"Turn",bearing:Zee(t,L8),referencePosition:"At"}:null},"#createTurnAction"),h(Kee,"Directions");var Owe=Kee,Qee=class{constructor({nodes:e,obstructions:t,connections:r,groupBy:n}){Z(this,"navigator");Z(this,"connections");Z(this,"getDirections",(e,t,r,n)=>{let{accessible:a,smoothing:{enabled:o,radius:s}}=r,l=e.flatMap(m=>this.getNodesFromTarget(m,n)),u=t.flatMap(m=>this.getNodesFromTarget(m,n)),c=this.getExcludedNodeIds(a).filter(m=>!l.includes(m)&&!u.includes(m)),p=this.navigator.getDirections({zones:r.zones.map(m=>{var g;return{geometry:m.geometry,cost:m.cost,map:(g=m.floor)==null?void 0:g.id}}),originIds:l,destinationNodeIds:u,excludedNodeIds:c,simplify:{enabled:o,bufferRadius:s}});this.addCoordinateDirections(p,e,t);let d=new Owe(p,n);if(!(d.distance===0&&new Set([...l,...u]).size===l.length+u.length))return d});Z(this,"getExcludedNodeIds",e=>e?this.connections.reduce((t,r)=>r.accessible?t:t.concat(r.nodes),[]):[]);Z(this,"addCoordinateDirections",(e,[t],[r])=>{if(e.features.length){if(br.is(t)){let n=this.createDirectionFeature(t,this.navigator.getAngle([t.longitude,t.latitude],e.features[0].geometry.coordinates),this.navigator.getDistance([t.longitude,t.latitude],e.features[0].geometry.coordinates));e.features.splice(0,0,n)}if(br.is(r)){let n=this.createDirectionFeature(r,0,0),a=e.features[e.features.length-1];a.properties.distance=this.navigator.getDistance(a.geometry.coordinates,[r.longitude,r.latitude]),a.properties.angle=this.navigator.getAngle(a.geometry.coordinates,[r.longitude,r.latitude]),e.features.push(n)}}});Z(this,"getNodesFromTarget",(e,t)=>{if(br.is(e)){let r=this.navigator.findNearestNode(this.createCoordinateFeature(e));return r?[r.properties.id]:[]}else if($_.is(e)){let r=this.navigator.findNearestNode(this.createCoordinateFeature(e.coordinate));return r?[r.properties.id]:[]}else if(B_.is(e)){let r=this.navigator.findNearestNode(this.createCoordinateFeature(e.center));return r?[r.properties.id]:[]}else if(gh.is(e)){let r=t==null?void 0:t.getMVFFeatureById("space",e.id);return r==null?[]:r.properties.destinationNodes}else{if(N_.is(e))return e.coordinates.reduce((r,n)=>{let a=this.navigator.findNearestNode(this.createCoordinateFeature(n));return a&&r.push(a.properties.id),r},[]);if(yh.is(e)){let r=t==null?void 0:t.objectEntranceNodeIdsByObstructionId[e.id];return r??[]}else return[]}});Z(this,"createCoordinateFeature",e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:{map:e.floorId}}));Z(this,"createDirectionFeature",(e,t,r)=>({type:"Feature",geometry:{type:"Point",coordinates:[e.longitude,e.latitude]},properties:{groupBy:e.floorId,id:e.id,angle:t,distance:r}}));this.navigator=new Fwe({nodes:e,obstructions:this.createObstructionCollection(t),groupBy:n}),this.connections=r}createObstructionCollection(e){return{type:"FeatureCollection",features:Object.entries(e).reduce((t,[r,n])=>t.concat(n.features.map(a=>(a.properties.map=r,a))),[])}}};h(Qee,"DirectionsInternal");var Bwe=Qee;R();var Uf,ete=class{constructor({currentMapGetter:e}){fe(this,Uf,void 0),Re(this,Uf,e)}get currentMap(){return M(this,Uf).call(this)}async getCurrentSceneGLTF(e){let t=M(this,Uf).call(this);return t?t==null?void 0:t.Exporter.getCurrentSceneGLTF(e):(Bt.error("There is no map to export. Please load a map first."),new Blob)}};Uf=new WeakMap,h(ete,"Exporter");var zwe=ete;R();var vs,_0,tte=class{constructor({currentMapGetter:e}){fe(this,vs,new Map),fe(this,_0,void 0),Re(this,_0,e)}get currentMap(){return M(this,_0).call(this)}getById(e){return M(this,vs).get(e)}add(e,t,r){let n=Qu(e);if(!n)throw new Error("get coordinate failed");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=a.Labels.add(kp(n),t,{...r,floorId:n.floorId,rank:(r==null?void 0:r.rank)||"medium"}),s=new xM(o.id.toString(),t);return M(this,vs).set(s.id,{label:s,entityId:s.id}),s}all(){var e;let t=[];return(e=this.currentMap)==null||e.Labels.all({onCreate:(r,n)=>{let a=new xM(r.toString(),n);M(this,vs).set(a.id,{label:a,entityId:a.id}),t.push(a)}}),t}remove(e){var t;let r=M(this,vs).get(e.id);r&&((t=this.currentMap)==null||t.Labels.remove(r.entityId),M(this,vs).delete(e.id.toString()))}removeAll(){let e=[];return M(this,vs).forEach(({label:t})=>{this.remove(t),e.push(t),M(this,vs).delete(t.id.toString())}),e}};vs=new WeakMap,_0=new WeakMap,h(tte,"Labels");var Nwe=tte;R();R();var k8={altitude:0,height:1,color:"#ffffff",opacity:1,width:.15},ite=class{constructor(e,t,r,n,a,o){Z(this,"id");Z(this,"name");Z(this,"elevation");Z(this,"containerId");Z(this,"loaded",!1);Z(this,"styleMap",{});Z(this,"obstructions");Z(this,"entrances");Z(this,"spaces");Z(this,"renderer");Z(this,"options");Z(this,"layers",new Map);Z(this,"load",()=>{var e,t;if(this.loaded||this.obstructions==null&&this.spaces==null)return this;if(this.loaded=!0,this.spaces!=null&&this.spaces.features.length>0){let r=this.spaces.features.filter(s=>{var l;return s.geometry.type==="Polygon"&&((l=s.properties.kind)==null?void 0:l.toLowerCase())!=="void"}),n=HM(r,this.styleMap),a=this.renderer.addGroupContainer(`spaces-${this.id}`,{},this.id),o=0;for(let[s,l]of n){let u=this.renderer.addGeometryGroup(`Spaces-${this.id}-${o}`,{features:l},$f(s,this.options),a);o++;let c=u.id.toString();this.layers.set(s.id||c,u.id.toString())}}if(this.obstructions!=null&&this.obstructions.features.length>0){let r=this.obstructions.features.filter(d=>d.geometry.type==="Polygon"&&d.properties.kind==="object"),n=HM(r,this.styleMap),a=this.renderer.addGroupContainer(`objects-${this.id}`,{},this.id),o=0;for(let[d,m]of n){let g=this.renderer.addGeometryGroup(`Objects-${this.id}-${o}`,{features:m},$f(d,this.options),a);o++;let _=g.id.toString();this.layers.set(d.id||_,_)}let s=this.obstructions.features.filter(d=>d.geometry.type==="LineString"&&d.properties.kind==="Wall"&&d.properties.footprintComponent===!1),l=this.obstructions.features.filter(d=>d.geometry.type==="LineString"&&d.properties.kind==="Wall"&&d.properties.footprintComponent===!0),u=this.entrances,c=k8,p=k8;if(s!=null&&s.length>0){let d=this.styleMap[(e=s[0].properties)==null?void 0:e.id];d!=null&&(c={...d}),p=c;let m=this.renderer.addGeometryGroup(`Walls-${this.id}`,{features:[I8(s,(u==null?void 0:u.features)||[])]},$f(c,this.options),this.id),g=m.id.toString();this.layers.set(c.id||g,m.id.toString())}if(l!=null&&l.length>0){let d=this.styleMap[(t=l[0].properties)==null?void 0:t.id];d!=null&&(p={...d,id:hx});let m=this.renderer.addGeometryGroup(`ExteriorWalls-${this.id}`,{features:[I8(l,(u==null?void 0:u.features)||[])]},$f(p,this.options),this.id),g=m.id.toString();this.layers.set(p.id||g,m.id.toString())}}return this.renderer.render(),this});this.id=t.id,this.options=n;let s=r.addGroupContainer(this.id,{visible:!1,interactive:!0},e);this.containerId=s.id.toString(),this.name=t.externalId,this.elevation=t.elevation,a!=null&&o!=null&&(this.styleMap=o,this.spaces=a.space[this.id],this.entrances=a.entrance[this.id],this.obstructions=a.obstruction[this.id]),this.renderer=r}};h(ite,"FloorObject");var $we=ite,op=kt(Og());R();R();R();R();(function(){typeof globalThis!="object"&&(Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();R();R();R();var Uwe="#ffffff",Eu,rte=class{constructor(e={}){ie(this,"color",Uwe),ie(this,"topColor"),ie(this,"opacity",1),fe(this,Eu,void 0),ie(this,"outline",!0);var t,r;this.color=(t=e==null?void 0:e.color)!=null?t:this.color,this.topColor=e==null?void 0:e.topColor,this.opacity=(r=e==null?void 0:e.opacity)!=null?r:this.opacity,this.shading=e==null?void 0:e.shading,this.outline=(e==null?void 0:e.outline)!==void 0?!!e.outline:this.outline}get shading(){return M(this,Eu)}set shading(e){var t;if(!e){Re(this,Eu,void 0);return}Re(this,Eu,(t=M(this,Eu))!=null?t:{start:0,end:0,intensity:0}),Object.assign(M(this,Eu),e)}};Eu=new WeakMap,h(rte,"GeometryGroupStyleComponent");var XM=rte,nte=class extends or{constructor(t,r=new XM){super();Z(this,"visible",!0);Z(this,"type","geometry-group");Z(this,"components");Z(this,"userData",{entityId:"",entities3D:new Set,opacity:1,dirty:!0,outlineDirty:!0,shadingDirty:!0});this.components=[r],this.userData.entityId=t}setVisible(t){this.visible=t,this.dispatchEvent({type:"childremoved",child:this})}getOpacity(){return this.userData.opacity}setOpacity(t){this.userData.opacity=t}removeEntity(){this.dispatchEvent({type:"childremoved",child:this})}};h(nte,"GeometryGroupObject3D");var Us=nte;R();var ate=class extends or{};h(ate,"Geometry2DObject3D");var qM=ate,ote=class{constructor(e,t){Z(this,"id");Z(this,"positionDirty",!0);Z(this,"object3d",new qM);Z(this,"components");Z(this,"disposed",!1);Z(this,"worldPosition",new le);this.id=e.id||Ar(),this.components=[e],this.object3d=new qM,this.object3d.position.copy(t),this.object3d.userData.entityId=this.id,this.object3d.userData.type=this.type}get type(){return this.components[0].type}get parent(){return this.object3d.parent}get position(){return this.object3d.getWorldPosition(this.worldPosition),this.worldPosition}};h(ote,"Geometry2D");var ud=ote;R();var ste=class extends or{constructor(){super(...arguments);Z(this,"userData",{entityId:"",type:"geometry"})}};h(ste,"Geometry3DObject3D");var V_=ste,lte=class{constructor(e,t){Z(this,"id",Ar());Z(this,"components");this.components=[e,t]}get object3d(){return this.components[0].mesh}get parent(){var e;return(e=this.components[0].mesh)==null?void 0:e.parent}get type(){return this.components[0].type}};h(lte,"Geometry3D");var Xn=lte,ute=class ZM extends or{constructor(t){super();Z(this,"childrenIds",new Set);Z(this,"type","group-container");Z(this,"userData",{entityId:"",entities2D:new Set,dirty:!0});Z(this,"components",[]);this.userData.entityId=t}addEntity(t){t instanceof ZM?(this.childrenIds.add(t.userData.entityId),this.add(t)):t instanceof ud?(this.childrenIds.add(t.id),this.add(t.object3d),this.userData.entities2D.add(t.id)):t instanceof Us?(this.childrenIds.add(t.userData.entityId),this.add(t)):t instanceof Xn&&t.object3d&&(this.childrenIds.add(t.id),this.add(t.object3d)),this.dispatchEvent({type:"childadded",child:this})}removeEntity(t){t instanceof ZM?(this.childrenIds.delete(t.userData.entityId),this.remove(t)):t instanceof ud?(this.childrenIds.delete(t.id),this.userData.entities2D.delete(t.id),this.remove(t.object3d)):t instanceof Us?(this.childrenIds.delete(t.userData.entityId),this.remove(t)):t instanceof Xn&&t.object3d&&(this.childrenIds.delete(t.id),this.add(t.object3d)),this.dispatchEvent({type:"childremoved",child:this})}setVisible(t){this.visible=t,this.dispatchEvent({type:"childremoved",child:this})}setAltitude(t){this.position.z=t,this.dispatchEvent({type:"childremoved",child:this})}get altitude(){return this.position.z}};h(ute,"GroupContainerObject3D");var xa=ute;R();var hte=!1;function cte(){hte=!0}h(cte,"enableTestMode");var pte=class{constructor(e,t=2){Z(this,"backgroundAlpha",1);Z(this,"backgroundColor",new Rt);Z(this,"width",0);Z(this,"height",0);Z(this,"options",{});Z(this,"renderer");try{this.options=e;let r={canvas:e.canvas,alpha:e.alpha||!1,stencil:!1,antialias:typeof e.antialias=="boolean"?e.antialias:!0,outputColorSpace:Un,powerPreference:"high-performance",preserveDrawingBuffer:!0};hte?(this.renderer={setSize:()=>{},state:{reset:()=>{}},properties:{get:()=>{}},getSize:()=>({width:window.innerWidth,height:innerHeight}),getDrawingBufferSize:()=>({width:window.innerWidth,height:innerHeight}),getClearAlpha:()=>1,getClearColor:()=>new Rt,autoUpdate:!0,shadowMap:{autoUpdate:!0},getContext:()=>({getContextAttributes(){return{alpha:!0,antialias:!1,depth:!0,stencil:!1}}}),setRenderTarget:()=>{},setClearColor:()=>{},clear:()=>{},render:()=>{},domElement:document.createElement("canvas"),capabilities:{isWebGL2:!0}},this.renderer.domElement.style.width="1920px",Object.defineProperty(this.renderer.domElement,"clientWidth",{value:1920}),this.renderer.domElement.style.height="1080px",Object.defineProperty(this.renderer.domElement,"clientHeight",{value:1080})):this.renderer=t===2?new vY(r):new _Y(r),this.backgroundColor=new Rt,this.backgroundAlpha=1}catch(r){Bt.error(r),e.onWebGLRendererError&&e.onWebGLRendererError(r)}}destroy(){var e,t;this.renderer&&((t=(e=this.renderer).dispose)==null||t.call(e))}render(e,t){this.renderer&&(this.renderer.state.reset(),t.layers.enable(0),t.layers.enable(1),this.renderer.autoClear=!1,this.renderer.setRenderTarget(null),this.renderer.render(e,t),this.renderer.state.reset())}clear(){this.renderer&&(this.renderer.setClearColor(this.backgroundColor,this.backgroundAlpha),this.renderer.clear())}setBufferSize(e,t){dr.env.NODE_ENV==="test"||!this.renderer||(this.width=e,this.height=t,this.renderer.setSize(e,t,!1))}setBackgroundColor(e,t){this.backgroundColor=e,this.backgroundAlpha=t}domElement(){var e;return(e=this.renderer)==null?void 0:e.domElement}};h(pte,"Renderer");var Vwe=pte;R();R();var hd=63710088e-1,jwe=-85.051129,Hwe=85.051129,Db=1e4,R8={chain:"chain",cancel:"cancel"},F8=Math.PI*2,Q1=100,Gwe=1e4,O8=0,B8=22,z8=["change","pan-start","pan-end","rotate-start","rotate-end","zoom-start","zoom-end","multi-start","multi-end","multi-cancel","pedestal-start","pedestal-change","pedestal-end","user-pan-start","user-pedestal-start","user-rotate-start","user-dolly-start","user-zoom-start","user-tilt-start","user-pan-end","user-pedestal-end","user-rotate-end","user-dolly-end","user-zoom-end","user-tilt-end","position-updated","zoom-updated","tilt-updated","rotation-updated"];R();var dte="mappedin";R();function fte(i){let e=i.min,t=i.max,r=new le(e.x,e.y,e.z),n=new le(t.x,e.y,e.z),a=new le(e.x,t.y,e.z),o=new le(t.x,t.y,e.z);return[r,n,a,o]}h(fte,"getCornersOfBoundingBox");R();function sp(){return typeof window>"u"?1:Math.min(window.devicePixelRatio,2)}h(sp,"getPixelRatio");R();function Rp(i,e,t=!1){let r=null,n=0;return function(...a){n++,n===1&&t===!0&&i(...a);let o=h(()=>{(!t||n>1)&&i(...a),r=null,n=0},"later");clearTimeout(r),r=setTimeout(o,e)}}h(Rp,"debounce");R();var Wwe=(()=>{let i;return{getDeviceType(){if(i)return i;let{userAgent:e,platform:t,maxTouchPoints:r}=window.navigator,n=/(iphone|ipod|ipad)/i.test(e),a=t==="iPad"||t.indexOf("Mac")===0&&r>0&&!window.MSStream,o=/android/i.test(e);return i={isIpad:a,isMobile:o||n||a,isSafari12:/Version\/12.+Safari/.test(e),isFirefox:/Firefox/.test(e),isWindows:/windows/i.test(e)},i},_reset(){i=void 0}}})(),N8=Wwe.getDeviceType,mte=(()=>{let i,e,t;function r(){if(e!==void 0)return e;i||(i=document.createElement("canvas"));let a=i.getContext("webgl")||i.getContext("experimental-webgl");if(!a)return e;try{let o=N8().isFirefox?null:a.getExtension("WEBGL_debug_renderer_info");return e=o?a.getParameter(o.UNMASKED_RENDERER_WEBGL):a.getParameter(a.RENDERER),e}catch{let o=new Error("Failed getting device info");throw o.name="FailedGettingDeviceInfo",o}}h(r,"getInfo");function n(){var a,o;if(!N8().isWindows)return!1;if(t!==void 0)return t;let s=(o=(a=Xwe())==null?void 0:a.toLowerCase())!=null?o:"";return t=s.includes("intel")&&(s.includes("uhd")||s.includes("iris")),t}return h(n,"shouldDisableOffscreenCanvas"),{getInfo:r,shouldDisableOffscreenCanvas:n,_setCanvas(a){i=a,e=void 0,t=void 0}}})(),Xwe=mte.getInfo,qwe=mte.shouldDisableOffscreenCanvas;R();function tP(i,e,t,r){let n=i*(Math.PI/180),a=r/hd,o=i+a*180/Math.PI,s=t/hd/Math.cos(n),l=e+s*180/Math.PI;return{lat:o,lon:l}}h(tP,"cartesianToGeographic");function iP(i,e,t,r){let n=t*(Math.PI/180),a=r*(Math.PI/180),o=i*(Math.PI/180),s=e*(Math.PI/180),l=n-o,u=a-s,c=hd*u*Math.cos(o),p=hd*l;return{x:c,y:p}}h(iP,"geographicToCartesian");var gte=h((i,e=[])=>{var t;if(i.children&&i.visible)for(let r of i.children){if(r.visible)if((t=r.userData)!=null&&t.entities3D&&r.type==="geometry-group"){e.push(r.userData.entityId);for(let n of r.userData.entities3D.values())e.push(n)}else(r.type==="group-container"||r.type==="custom-geometry"||r instanceof V_)&&e.push(r.userData.entityId);gte(r,e)}return e},"extract3DEntitiesFromTree"),yte=h((i,e)=>{var t;if(i.children&&i.visible&&!((t=i.userData)!=null&&t.hidden))for(let r of i.children)r.visible&&r instanceof qM&&e.add(r.userData.entityId),yte(r,e);return e},"extractEntitiesFromTree");function rP(i,e){for(let t in e){if(e[t]==null){i[t]=void 0;continue}typeof e[t]=="object"?rP(i[t],e[t]):i[t]=e[t]}return i}h(rP,"mergeObjects");function nP(i,e,t,r){let n={translateX:i.x,translateY:i.y,translateZ:i.z,scale:i.meterInMercatorCoordinateUnits()},a=new Gt,o=new le(n.scale,-n.scale,n.scale),s=new Gt().makeTranslation(n.translateX,n.translateY,n.translateZ).scale(o);return{id:dte,type:"custom",renderingMode:"3d",render:(l,u)=>{if(a.fromArray(u),t.elevation>0){let c=Qr.fromLngLat(i.toLngLat(),t.elevation);s.makeTranslation(n.translateX,n.translateY,-c.z).scale(o)}e.projectionMatrix=a.multiply(s),r()}}}h(nP,"createCustomLayer");function vte(i){return fetch(i,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials"})})}h(vte,"fetchToken");async function xte(i){let e=await vte(i),{access_token:t}=await e.json();return{"x-mappedin-tiles-key":t}}h(xte,"getRequestHeaders");function _te(i,e=0){let t=3735928559^e,r=1103547991^e;for(let n=0,a;n<i.length;n++)a=i.charCodeAt(n),t=Math.imul(t^a,2654435761),r=Math.imul(r^a,1597334677);return t=Math.imul(t^t>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),r=Math.imul(r^r>>>16,2246822507)^Math.imul(t^t>>>13,3266489909),4294967296*(2097151&r)+(t>>>0)}h(_te,"cyrb53");var Zwe=h(i=>i,"linearEase");function Lh(i,e,t,r,n,a=Zwe){i=Math.max(e,Math.min(i,t));let o=(i-Math.min(e,t))/Math.abs(t-e),s=a(o);return r+s*(n-r)}h(Lh,"interpolate");function YM(i,e,t){let r=i*(Math.PI/180)/2,n=e/2;return t*Math.tan(r)/n}h(YM,"getProjectionScaleFactor");function Vf(i,e){let t;return typeof e=="string"||typeof e=="number"?(t=i.entity2DMap.get(e),t==null&&(t=i.entity3DMap.get(e))):typeof(e==null?void 0:e.id)=="string"||typeof(e==null?void 0:e.id)=="number"?(t=i.entity2DMap.get(e.id),t==null&&(t=i.entity3DMap.get(e.id))):t=e,t}h(Vf,"getGeometryByGeometryId");function bte(i){return new Wl(new ei(i[0][0],i[0][1]),new ei(i[1][0],i[1][1])).getCenter().toArray()}h(bte,"getBoundingBoxCenter");function wte(i){return Number.isFinite(i.min.x)&&Number.isFinite(i.min.y)&&Number.isFinite(i.max.x)&&Number.isFinite(i.max.y)&&(i instanceof V2e||Number.isFinite(i.min.z)&&Number.isFinite(i.max.z))}h(wte,"isFiniteBox");R();R();var Ywe=`"use strict";(()=>{function _(n,e){return e.x+e.w<n.x+n.w&&e.x>n.x&&e.y>n.y&&e.y+e.h<n.y+n.h}function A(n,e){let[t,o]=e;return t>=n.x&&t<=n.x+n.w&&o>=n.y&&o<=n.y+n.h}function j(n,e){let t=e.x,o=e.y,i=e.x+e.w,c=e.y+e.h,a=n.x,p=n.y,g=n.x+n.w,x=n.y+n.h;return t<g&&a<i&&o<x&&p<c}function u(n,e){for(let t=0;t<e.length;t++)n.push(e[t])}var I=4,r=class{x;y;w;h;userData;constructor(e,t,o,i,c){let a=typeof window>"u"?2:window.devicePixelRatio;this.userData=typeof c>"u"?null:c,this.x=e-I,this.y=t-I,this.w=o+I*Math.min(a,2),this.h=i+I*Math.min(a,2)}contains(e){return e===this?!1:_(this,e)}intersects(e){return j(this,e)}intersectsPoint(e){return A(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.5)",e.fillRect(this.x,this.y,this.w,this.h)}};var T=class n{topLeft;topRight;bottomLeft;bottomRight;divided=!1;boundary;capacity=16;objects=[];parent;constructor(e,t){this.parent=t,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:t,w:o,h:i}=this.boundary;this.topLeft=new n(new r(e,t,o/2,i/2),this),this.topRight=new n(new r(e+o/2,t,o/2,i/2),this),this.bottomLeft=new n(new r(e,t+i/2,o/2,i/2),this),this.bottomRight=new n(new r(e+o/2,t+i/2,o/2,i/2),this),this.divided=!0}queryRect(e){let t=[];if(this.boundary.intersects(e))t.push(...this.objects);else return[];return this.divided&&(u(t,this.topLeft.queryRect(e)),u(t,this.topRight.queryRect(e)),u(t,this.bottomLeft.queryRect(e)),u(t,this.bottomRight.queryRect(e))),t}queryPoint(e){let t=[];if(this.boundary.intersectsPoint(e))t.push(...this.objects);else return[];return this.divided&&(u(t,this.topLeft.queryPoint(e)),u(t,this.topRight.queryPoint(e)),u(t,this.bottomLeft.queryPoint(e)),u(t,this.bottomRight.queryPoint(e))),t}insert(e){return this.boundary.contains(e)?this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0):!1}drawObjects(e){this.objects.forEach(t=>t.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};var d=200,P=10;function q(n,e,t,o,i,c="-1"){let a=1/0,p=1/0,g=-1/0,x=-1/0,W=new r(-P,0,5,t),X=new r(-P,0,e,5),O=new r(e-5,0,e+P,t),K=new r(0,t-5,e,t+P),Q=new r(0,t-i,o,i),Y=[W,X,O,K],D=new r(-d,-d,e+d*2,t+d*2);for(let s of n)for(let b=0;b<s.bboxes.length;b++){let{boundingBox:k}=s.bboxes[b],[h,w,l,m]=k,[S,y,N,F]=[s.y-h,s.y+w,s.x-l,s.x+m],L=N,v=S,E=F-N,M=y-S;a=Math.min(a,L)-d,p=Math.min(p,v)-d,g=Math.max(g,L+E)+d,x=Math.max(x,v+M)+d,s.bboxes[b].boundingRect=new r(L,v,E,M)}let f={msgId:c,colliders:new Array(n.length),debug:[]},C=new T(new r(a,p,g-a,x-p)),R;for(let s=0;s<n.length;s++)if(R=n[s],f.colliders[s]=[-1,!1],R.enabled){let[b,k,h]=[1/0,-1,void 0];for(let{index:w,boundingRect:l}of R.bboxes){let m=[];if(m=C.queryRect(l).filter(y=>l.intersects(y)),R.shouldCollideWithScreenEdges&&Y.forEach(y=>{l.intersects(y)&&m.push(y)}),l.intersects(Q)){f.colliders[s]=[w,!0,l];break}if(m.length<=b&&(h=l,k=w,b=m.length),m.length===0){C.insert(l),f.colliders[s]=[w,!D.contains(l),l];break}}R.rank===5&&h!=null&&(C.insert(h),f.colliders[s]=[k,!D.contains(h),h])}else f.colliders[s]=[-1,!1];return f}function z(n){let e=n[0].map(t=>{let o=t[0].map((i,c)=>({index:c,boundingBox:[i[0],i[1],i[2],i[3]]}));return{enabled:t[1]===1,rank:t[2]===1?5:0,x:t[3],y:t[4],bboxes:o}});return{msgId:"-1",totalWidth:n[3],totalHeight:n[2],watermarkWidth:n[4],watermarkHeight:n[5],colliders:e,devicePixelRatio:n[1]}}self.onmessage=n=>{let e=z(n.data);self.postMessage(q(e.colliders,e.totalWidth,e.totalHeight,e.watermarkWidth,e.watermarkHeight,e.msgId))};})();
`;R();R();R();R();R();function Ste(i,e){return e.x+e.w<i.x+i.w&&e.x>i.x&&e.y>i.y&&e.y+e.h<i.y+i.h}h(Ste,"contains");R();function Mte(i,e){let[t,r]=e;return t>=i.x&&t<=i.x+i.w&&r>=i.y&&r<=i.y+i.h}h(Mte,"intersectPoint");R();function Cte(i,e){let t=e.x,r=e.y,n=e.x+e.w,a=e.y+e.h,o=i.x,s=i.y,l=i.x+i.w,u=i.y+i.h;return t<l&&o<n&&r<u&&s<a}h(Cte,"intersects");R();function xs(i,e){for(let t=0;t<e.length;t++)i.push(e[t])}h(xs,"appendItems");R();var ey=4,Ete=class{constructor(e,t,r,n,a){Z(this,"x");Z(this,"y");Z(this,"w");Z(this,"h");Z(this,"userData");let o=typeof window>"u"?2:window.devicePixelRatio;this.userData=typeof a>"u"?null:a,this.x=e-ey,this.y=t-ey,this.w=r+ey*Math.min(o,2),this.h=n+ey*Math.min(o,2)}contains(e){return e===this?!1:Ste(this,e)}intersects(e){return Cte(this,e)}intersectsPoint(e){return Mte(this,e)}draw(e){e.fillStyle="rgba(123,222,26, 0.5)",e.fillRect(this.x,this.y,this.w,this.h)}};h(Ete,"Rectangle");var za=Ete,Tte=class jf{constructor(e,t){Z(this,"topLeft");Z(this,"topRight");Z(this,"bottomLeft");Z(this,"bottomRight");Z(this,"divided",!1);Z(this,"boundary");Z(this,"capacity",16);Z(this,"objects",[]);Z(this,"parent");this.parent=t,this.boundary=e}getSize(){return this.divided?this.objects.length+this.topLeft.getSize()+this.topRight.getSize()+this.bottomLeft.getSize()+this.bottomRight.getSize():this.objects.length}subdivide(){let{x:e,y:t,w:r,h:n}=this.boundary;this.topLeft=new jf(new za(e,t,r/2,n/2),this),this.topRight=new jf(new za(e+r/2,t,r/2,n/2),this),this.bottomLeft=new jf(new za(e,t+n/2,r/2,n/2),this),this.bottomRight=new jf(new za(e+r/2,t+n/2,r/2,n/2),this),this.divided=!0}queryRect(e){let t=[];if(this.boundary.intersects(e))t.push(...this.objects);else return[];return this.divided&&(xs(t,this.topLeft.queryRect(e)),xs(t,this.topRight.queryRect(e)),xs(t,this.bottomLeft.queryRect(e)),xs(t,this.bottomRight.queryRect(e))),t}queryPoint(e){let t=[];if(this.boundary.intersectsPoint(e))t.push(...this.objects);else return[];return this.divided&&(xs(t,this.topLeft.queryPoint(e)),xs(t,this.topRight.queryPoint(e)),xs(t,this.bottomLeft.queryPoint(e)),xs(t,this.bottomRight.queryPoint(e))),t}insert(e){return this.boundary.contains(e)?this.objects.length<this.capacity?(this.objects.push(e),!0):(this.divided||this.subdivide(),(this.topLeft.insert(e)||this.topRight.insert(e)||this.bottomLeft.insert(e)||this.bottomRight.insert(e))===!1&&this.objects.push(e),!0):!1}drawObjects(e){this.objects.forEach(t=>t.draw(e)),this.divided&&(this.topLeft.drawObjects(e),this.topRight.drawObjects(e),this.bottomLeft.drawObjects(e),this.bottomRight.drawObjects(e))}draw(e){e.rect(this.boundary.x,this.boundary.y,this.boundary.w,this.boundary.h),this.divided&&(this.topLeft.draw(e),this.topRight.draw(e),this.bottomLeft.draw(e),this.bottomRight.draw(e)),e.strokeStyle="black",e.lineWidth=4,e.stroke()}};h(Tte,"QuadTree");var Hf=Tte;R();R();var Pte=["","","low","medium","high","always-visible"];function aP(i){return Math.min(5,Math.max(2,i))}h(aP,"clampTierNumber");function j_(i){if(typeof i=="number")return aP(i);let e=Pte.indexOf(i);return e===-1?3:e}h(j_,"convertCollisionRankingTierToNumber");function Gf(i){let e=aP(i);return Pte[e]}h(Gf,"convertNumberToCollisionRankingTier");function Ate(i,e,t){let r,n,a,o=null,s=0;t||(t={});let l=h(function(){s=t.leading===!1?0:Date.now(),o=null,a=i.apply(r,n),o||(r=n=null)},"later");return function(){let u=Date.now();!s&&t.leading===!1&&(s=u);let c=e-(u-s);return r=globalThis,n=arguments,c<=0||c>e?(o&&(clearTimeout(o),o=null),s=u,a=i.apply(r,n),o||(r=n=null)):!o&&t.trailing!==!1&&(o=setTimeout(l,c)),a}}h(Ate,"throttle");function Ite(i){return[i.bboxes.map(e=>[e.boundingBox[0],e.boundingBox[1],e.boundingBox[2],e.boundingBox[3]]),i.enabled?1:0,i.rank===5?1:0,i.x,i.y]}h(Ite,"packCollider");var du=!1,Jwe=150,Lte=class extends Zr{constructor(t,r,n=new Worker(URL.createObjectURL(new Blob([Ywe],{type:"text/javascript"})))){super();Z(this,"worker");Z(this,"debugContext");Z(this,"debugCanvas");Z(this,"dirty",!0);Z(this,"packedMessage",[[],0,0,0,0,0]);Z(this,"visibleCollidersQTree",new Hf(new za(0,0,0,0)));Z(this,"interactiveCollidersQTree",new Hf(new za(0,0,0,0)));Z(this,"coreState");Z(this,"postMessage");Z(this,"showCollisionBoxes",()=>{du=!0,this.debugCanvas.style.display="block"});Z(this,"hideCollisionBoxes",()=>{du=!1,this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugCanvas.style.display="none"});Z(this,"currentMsgId","");Z(this,"working",!1);Z(this,"_postMessage",()=>{this.worker.postMessage(this.packedMessage)});Z(this,"componentArray",[]);Z(this,"update",(t,r)=>{if(this.dirty){this.packedMessage=[[],0,0,0,0,0],this.componentArray=new Array(this.coreState.entity2DIds.size);let n=0,a;for(let o of this.coreState.entity2DIds){let s=this.coreState.entity2DMap.get(o);s&&(a=s.components[0],this.componentArray[n]=a),n++}this.resize(t,r),this.dirty=!1,this.componentArray.sort((o,s)=>s.rank-o.rank)}else this.componentArray.filter(n=>n.collisionDirty===!0).length>0&&this.componentArray.sort((n,a)=>a.rank-n.rank);for(let n=0;n<this.componentArray.length;n++)this.packedMessage&&(this.componentArray[n].collisionDirty||this.packedMessage[0][n]==null?(this.packedMessage[0][n]=Ite(this.componentArray[n].toJSON()),this.componentArray[n].collisionDirty=!1):(this.packedMessage[0][n][1]=this.componentArray[n].enabled?1:0,this.packedMessage[0][n][2]=this.componentArray[n].rank===5?1:0,this.packedMessage[0][n][3]=this.componentArray[n].projection.x,this.packedMessage[0][n][4]=this.componentArray[n].projection.y));this.working||this.postMessage()});Z(this,"resolve",t=>{if(this.working=!1,this.dirty||!t.data)return;let r=t.data.colliders,n=-1,a=!1,o,s,l;du&&(this.visibleCollidersQTree=new Hf(new za(0,0,this.debugCanvas.width,this.debugCanvas.height))),this.interactiveCollidersQTree=new Hf(new za(0,0,this.debugCanvas.width,this.debugCanvas.height));for(let u=0;u<this.componentArray.length;u++){let c=this.componentArray[u];r[u]==null||!c.enabled||([n,a,o]=r[u],n!==-1&&!a&&o!=null?(l=new za(o.x,o.y,o.w,o.h,{entityId:c.id}),du&&this.visibleCollidersQTree.insert(l),s=this.coreState.entity2DMap.get(c.id),(s==null?void 0:s.components[1])!=null&&this.interactiveCollidersQTree.insert(new za(o.x,o.y,o.w,o.h,{entityId:c.id})),c.visible===!1&&(c.visible=!0,"visibilityNeedsUpdate"in c&&(c.visibilityNeedsUpdate=!0)),n!==-1&&n!==c.activeStrategyIndex&&(c.activeBoundingBox=l,c.onStrategySelected(n))):(c.visible===!0&&(c.visible=!1,"visibilityNeedsUpdate"in c&&(c.visibilityNeedsUpdate=!0)),n!==-1&&n!==c.activeStrategyIndex&&c.onStrategySelected(n)))}du&&this.drawDebug(),this.publish("visibility-changed")});Z(this,"drawDebug",()=>{du&&this.visibleCollidersQTree&&(this.debugContext.clearRect(0,0,this.debugCanvas.width,this.debugCanvas.height),this.debugContext.beginPath(),this.visibleCollidersQTree.drawObjects(this.debugContext))});Z(this,"destroy",()=>{this.worker.terminate()});this.coreState=r,this.debugCanvas=t,this.debugContext=t.getContext("2d"),this.worker=n,this.worker.onmessage=a=>this.resolve(a),this.postMessage=Ate(this._postMessage,Jwe,!1),du?this.showCollisionBoxes():this.hideCollisionBoxes()}resize(t,r){this.packedMessage[5]=r,this.packedMessage[4]=t,this.packedMessage[3]=this.debugCanvas.width,this.packedMessage[2]=this.debugCanvas.height}};h(Lte,"CollisionSystem");var Kwe=Lte;R();R();R();R();var Dte=class{constructor(e){Z(this,"type");Z(this,"event");this.type=0,this.event=e}get timestamp(){return this.event.timeStamp}};h(Dte,"Tap");var Qwe=Dte,kte=class{constructor(){Z(this,"taps",[])}add(e){this.lastPointerDown&&e.timestamp-this.lastPointerDown.timestamp<50?this.lastPointerDown.type=1:this.taps.push(e)}get lastPointerDown(){return this.taps.length>=1?this.taps[this.taps.length-1]:void 0}get isSingleTapWithTwoFingers(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===1}get isSingleTapWithOneFinger(){var e;return this.isSingleTap&&((e=this.lastPointerDown)==null?void 0:e.type)===0}get isDoubleTapWithOneFinger(){var e,t;return this.isDoubleTap&&((e=this.taps[0])==null?void 0:e.type)===0&&((t=this.taps[1])==null?void 0:t.type)===0}get isSingleTap(){return this.taps.length===1}get isDoubleTap(){return this.taps.length===2}discardOutsideOfWaitWindow(e){this.taps=this.taps.filter(t=>e-t.timestamp<300)}flush(){this.taps=[]}get _taps(){return this.taps}destroy(){this.flush()}};h(kte,"TapsController");var e3e=kte;R();function Rte(i){let e=new Set;for(let t of i){let r=t.object;for(;r.parent&&!e.has(r.parent);)r=r.parent,r instanceof xa&&r.type==="group-container"&&r.visible&&r.components[1]&&e.add(r)}return Array.from(e)}h(Rte,"getUniqueIntersectedGroupContainers");function Fte(i,e){if(i==null||e==null)return i===e;if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0}h(Fte,"arraysEqual");var Wf,Ote=class extends Zr{constructor(e,t,r,n){super(),ie(this,"raycaster",new Fg),ie(this,"state",{hovered3DEntity:void 0,hovered2DEntity:void 0,hovered3DContainers:void 0,lastHover:void 0,containerOffset:[0,0],interaction:{mouseDownStart:void 0,distanceFromMouseDown:void 0,isPanning:!1}}),ie(this,"coreState"),ie(this,"camera"),ie(this,"cameraPlane"),ie(this,"_quadtree",new Hf(new za(0,0,0,0))),ie(this,"_container"),ie(this,"lastPointerEvent"),ie(this,"cursor","grab"),ie(this,"touchesCount",0),ie(this,"hasTouched",!1),fe(this,Wf,void 0),ie(this,"onPointerMoveRaf",s=>{this.lastPointerEvent=s,M(this,Wf)&&cancelAnimationFrame(M(this,Wf)),Re(this,Wf,requestAnimationFrame(()=>{this.onPointerMove(s)}))}),ie(this,"onPointerMove",s=>{s.preventDefault(),this.updateInteractionStateIfPanning(s),(s.pointerType!=="touch"||s.pointerType===void 0&&this.hasTouched)&&this.handleHover(s),this.handleCursor()}),ie(this,"tapsControl",new e3e),ie(this,"onPointerDown",s=>{s.target===this._container&&(this._container.addEventListener("pointerup",this.onPointerUp,!1),this._container.addEventListener("pointercancel",this.onPointerUp,!1),this.state.interaction.mouseDownStart={time:Date.now(),timestamp:s.timeStamp,clientX:s.clientX,clientY:s.clientY},this.lastPointerEvent=s,this.state.interaction.distanceFromMouseDown=0,this.handleCursor(),s.pointerType==="touch"&&(this.tapsControl.add(new Qwe(s)),this.touchesCount=Math.max(0,this.touchesCount+1)))}),ie(this,"clickTimeout"),ie(this,"onPointerUp",s=>{this.tapsControl.discardOutsideOfWaitWindow(s.timeStamp),this.lastPointerEvent=s,this.touchesCount=Math.max(0,this.touchesCount-1),this.touchesCount===0&&(this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)),this.updateInteractionStateIfPanning(s);let{mouseDownStart:l}=this.state.interaction;!l||this.state.interaction.distanceFromMouseDown==null||(Date.now()<l.time+300&&(this.tapsControl.isSingleTapWithTwoFingers||this.state.interaction.distanceFromMouseDown<=15)&&(s.pointerType==="touch"?this.tapsControl.isSingleTapWithTwoFingers?(this.publish("singletap-with-twofinger",s),this.flush()):this.tapsControl.isSingleTapWithOneFinger&&this.touchesCount===0?(this.clickTimeout&&clearTimeout(this.clickTimeout),this.clickTimeout=window.setTimeout(()=>{this.handleClick(s),this.flush()},300)):this.tapsControl.isDoubleTapWithOneFinger&&(this.publish("doubletap-with-onefinger",s),this.flush()):this.handleClick(s)),this.state.interaction.mouseDownStart=void 0,this.state.interaction.distanceFromMouseDown=void 0,this.state.interaction.isPanning=!1,this.handleCursor())}),ie(this,"dirty3D",!0),ie(this,"cachedHitBoxes",{entities:[],groups:[]}),ie(this,"ndcPoint",new Ne),ie(this,"debugPanel"),this.raycaster.layers.enableAll(),this.raycaster.layers.disable(1);let{top:a,left:o}=e.getBoundingClientRect();this.state.containerOffset=[a,o],this.camera=r,this._container=e,this.coreState=t,this.cameraPlane=n,this._container.addEventListener("pointerdown",this.onPointerDown,!1),this._container.addEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.classList.add("mappedin-interactive")}updateQuadtree(e){this._quadtree=e}setHovered3DEntityInteractionComponentDirty(){if(this.state.hovered3DEntity){let e=this.state.hovered3DEntity.components[2];e&&(e.dirty=!0)}}flush(){this.tapsControl.flush(),this.clickTimeout!=null&&(clearTimeout(this.clickTimeout),this.clickTimeout=void 0)}handleHover(e){let t=e||this.lastPointerEvent;if(this.state.interaction.mouseDownStart||!t)return;let{entity3D:r,entity2D:n,position:a,groupContainers:o}=this.intersect(t);(this.handle3DEntityHover(r)||this.handle2DEntityHover(n)||this.handle3DContainerHover(o))&&this.publish("hover",{entity2D:this.state.hovered2DEntity,entity3D:this.state.hovered3DEntity,position:a,groupContainers:o}),this.handleCursor()}handleCursor(){let e=!!(this.state.hovered3DEntity||this.state.hovered2DEntity),t=!!this.state.interaction.mouseDownStart,r=this.state.interaction.isPanning,n=Bte(e,r,t);this.cursor!==n&&(this.cursor=n,n==="pointer"?this._container.classList.add("mappedin-interaction-hover"):this._container.classList.remove("mappedin-interaction-hover"))}handle2DEntityHover(e){let t=this.state.hovered2DEntity!==e;return this.state.hovered2DEntity=e,t}handleClick(e){let t=this.intersect(e);this.publish("click",{entity2D:t.entity2D,entity3D:t.entity3D,position:t.position,groupContainers:t.groupContainers,pointerEvent:{button:e.button}})}get _hitBoxes(){if(this.dirty3D){this.cachedHitBoxes.entities=[],this.cachedHitBoxes.groups=[];let e;for(let t of this.coreState.threeDEntities)e=this.coreState.entity3DMap.get(t),((e==null?void 0:e.type)==="geometry"||(e==null?void 0:e.type)==="model")&&e.components[2]?e.components[0].mesh&&!this.cachedHitBoxes.entities.includes(e.components[0].mesh)&&this.cachedHitBoxes.entities.push(e.components[0].mesh):(e==null?void 0:e.type)==="group-container"&&e.components[1]&&!this.cachedHitBoxes.groups.includes(e)&&this.cachedHitBoxes.groups.push(e);return this.dirty3D=!1,this.cachedHitBoxes}return this.cachedHitBoxes}intersect(e){var t,r;let n=[e.offsetX,e.offsetY],a=this._quadtree.queryPoint(n),[o]=a.filter(_=>_.intersectsPoint(n)),s=this.state.containerOffset[0],l=this.state.containerOffset[1];this.ndcPoint.x=(e.clientX-l)/this._container.clientWidth*2-1,this.ndcPoint.y=-((e.clientY-s)/this._container.clientHeight)*2+1,this.raycaster.setFromCamera(this.ndcPoint,this.camera),this.raycaster.layers.enable(0);let[u]=this.getMouseRayIntersects(),c=this.raycaster.intersectObjects(this._hitBoxes.entities,!0).filter(_=>_.object.visible),[p]=c,d=(t=p==null?void 0:p.instanceId)!=null?t:p==null?void 0:p.batchId,m=this.raycaster.intersectObjects(this._hitBoxes.groups,!0).filter(_=>_.object.visible),g;return m!=null&&m.length>0&&(g=Rte(m)),{entity2D:((r=o==null?void 0:o.userData)==null?void 0:r.entityId)==="watermark"?{id:"watermark"}:this.coreState.entity2DMap.get(o==null?void 0:o.userData.entityId),entity3D:d!=null?this.coreState.entity3DMap.get(p==null?void 0:p.object.userData.entities[d]):this.coreState.entity3DMap.get(p==null?void 0:p.object.userData.entityId),position:u==null?void 0:u.point,groupContainers:g}}handle3DEntityHover(e){this.state.lastHover!==e&&(this.state.lastHover&&JM(this.state.lastHover,!1),e&&JM(e,!0));let t=this.state.hovered3DEntity!==e;return this.state.hovered3DEntity=e,this.state.lastHover=e,t}handle3DContainerHover(e){let t=!Fte(this.state.hovered3DContainers,e);return this.state.hovered3DContainers=e,t}updateInteractionStateIfPanning(e){this.state.interaction.mouseDownStart&&(this.state.interaction.distanceFromMouseDown=Math.sqrt(Math.pow(e.clientX-this.state.interaction.mouseDownStart.clientX,2)+Math.pow(e.clientY-this.state.interaction.mouseDownStart.clientY,2)),!this.state.interaction.isPanning&&this.state.interaction.distanceFromMouseDown>15&&(this.state.interaction.isPanning=!0))}getMouseRayIntersects(){return this.raycaster.intersectObjects([this.cameraPlane],!1)}destroy(){this._container.removeEventListener("pointerdown",this.onPointerDown,!1),this._container.removeEventListener("pointermove",this.onPointerMoveRaf,!1),this._container.removeEventListener("pointerup",this.onPointerUp,!1),this._container.removeEventListener("pointercancel",this.onPointerUp,!1)}enableDebug(){let e=document.createElement("div");e.style.position="absolute",e.style.top="0",e.style.right="0",e.style.backgroundColor="white",e.style.padding="10px",document.body.append(e),e.id="interaction-debug-panel",this.debugPanel=e,this.on("doubletap-with-onefinger",()=>{this.queueDebugMessage("doubletap-with-onefinger","#ffadad")}),this.on("singletap-with-twofinger",()=>{this.queueDebugMessage("singletap-with-twofinger","#ffd6a5")}),this.on("click",t=>{var r,n,a;this.queueDebugMessage(`CLICK 
3D: ${(r=t.entity3D)==null?void 0:r.id} 
2D: ${(n=t.entity2D)==null?void 0:n.id} 
Pos: ${(a=t.position)==null?void 0:a.toArray().join(", ")}`,"#fdffb6")}),this.on("hover",t=>{var r,n,a;this.queueDebugMessage(`HOVER 
3D: ${(r=t.entity3D)==null?void 0:r.id} 
2D: ${(n=t.entity2D)==null?void 0:n.id} 
Pos: ${(a=t.position)==null?void 0:a.toArray().join(", ")}`,"#caffbf")})}get _state(){return this.state}queueDebugMessage(e,t){var r;let n=document.createElement("pre");n.style.maxWidth="300px",n.style.transition="opacity 500ms cubic-bezier(0.4, 0, 0.2, 1)",n.style.backgroundColor=t,n.textContent=e,(r=this.debugPanel)==null||r.prepend(n),setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{n.remove()},500)},2500)}getCursor(){return this.cursor}};Wf=new WeakMap,h(Ote,"InteractionSystem");var t3e=Ote;function JM(i,e){let t=i.components[2];t&&(t.hover=e,t.dirty=!0)}h(JM,"updateHover");function Bte(i,e,t){return e?"grabbing":i?"pointer":t?"grabbing":"grab"}h(Bte,"processCursor");R();R();R();function eg(i){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eg(i)}h(eg,"_typeof");var i3e=/^\s+/,r3e=/\s+$/;function _t(i,e){if(i=i||"",e=e||{},i instanceof _t)return i;if(!(this instanceof _t))return new _t(i,e);var t=zte(i);this._originalInput=i,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}h(_t,"tinycolor");_t.prototype={isDark:h(function(){return this.getBrightness()<128},"isDark"),isLight:h(function(){return!this.isDark()},"isLight"),isValid:h(function(){return this._ok},"isValid"),getOriginalInput:h(function(){return this._originalInput},"getOriginalInput"),getFormat:h(function(){return this._format},"getFormat"),getAlpha:h(function(){return this._a},"getAlpha"),getBrightness:h(function(){var i=this.toRgb();return(i.r*299+i.g*587+i.b*114)/1e3},"getBrightness"),getLuminance:h(function(){var i=this.toRgb(),e,t,r,n,a,o;return e=i.r/255,t=i.g/255,r=i.b/255,e<=.03928?n=e/12.92:n=Math.pow((e+.055)/1.055,2.4),t<=.03928?a=t/12.92:a=Math.pow((t+.055)/1.055,2.4),r<=.03928?o=r/12.92:o=Math.pow((r+.055)/1.055,2.4),.2126*n+.7152*a+.0722*o},"getLuminance"),setAlpha:h(function(i){return this._a=oP(i),this._roundA=Math.round(100*this._a)/100,this},"setAlpha"),toHsv:h(function(){var i=QM(this._r,this._g,this._b);return{h:i.h*360,s:i.s,v:i.v,a:this._a}},"toHsv"),toHsvString:h(function(){var i=QM(this._r,this._g,this._b),e=Math.round(i.h*360),t=Math.round(i.s*100),r=Math.round(i.v*100);return this._a==1?"hsv("+e+", "+t+"%, "+r+"%)":"hsva("+e+", "+t+"%, "+r+"%, "+this._roundA+")"},"toHsvString"),toHsl:h(function(){var i=KM(this._r,this._g,this._b);return{h:i.h*360,s:i.s,l:i.l,a:this._a}},"toHsl"),toHslString:h(function(){var i=KM(this._r,this._g,this._b),e=Math.round(i.h*360),t=Math.round(i.s*100),r=Math.round(i.l*100);return this._a==1?"hsl("+e+", "+t+"%, "+r+"%)":"hsla("+e+", "+t+"%, "+r+"%, "+this._roundA+")"},"toHslString"),toHex:h(function(i){return eC(this._r,this._g,this._b,i)},"toHex"),toHexString:h(function(i){return"#"+this.toHex(i)},"toHexString"),toHex8:h(function(i){return Vte(this._r,this._g,this._b,this._a,i)},"toHex8"),toHex8String:h(function(i){return"#"+this.toHex8(i)},"toHex8String"),toRgb:h(function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},"toRgb"),toRgbString:h(function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},"toRgbString"),toPercentageRgb:h(function(){return{r:Math.round(Bi(this._r,255)*100)+"%",g:Math.round(Bi(this._g,255)*100)+"%",b:Math.round(Bi(this._b,255)*100)+"%",a:this._a}},"toPercentageRgb"),toPercentageRgbString:h(function(){return this._a==1?"rgb("+Math.round(Bi(this._r,255)*100)+"%, "+Math.round(Bi(this._g,255)*100)+"%, "+Math.round(Bi(this._b,255)*100)+"%)":"rgba("+Math.round(Bi(this._r,255)*100)+"%, "+Math.round(Bi(this._g,255)*100)+"%, "+Math.round(Bi(this._b,255)*100)+"%, "+this._roundA+")"},"toPercentageRgbString"),toName:h(function(){return this._a===0?"transparent":this._a<1?!1:n3e[eC(this._r,this._g,this._b,!0)]||!1},"toName"),toFilter:h(function(i){var e="#"+tC(this._r,this._g,this._b,this._a),t=e,r=this._gradientType?"GradientType = 1, ":"";if(i){var n=_t(i);t="#"+tC(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+e+",endColorstr="+t+")"},"toFilter"),toString:h(function(i){var e=!!i;i=i||this._format;var t=!1,r=this._a<1&&this._a>=0,n=!e&&r&&(i==="hex"||i==="hex6"||i==="hex3"||i==="hex4"||i==="hex8"||i==="name");return n?i==="name"&&this._a===0?this.toName():this.toRgbString():(i==="rgb"&&(t=this.toRgbString()),i==="prgb"&&(t=this.toPercentageRgbString()),(i==="hex"||i==="hex6")&&(t=this.toHexString()),i==="hex3"&&(t=this.toHexString(!0)),i==="hex4"&&(t=this.toHex8String(!0)),i==="hex8"&&(t=this.toHex8String()),i==="name"&&(t=this.toName()),i==="hsl"&&(t=this.toHslString()),i==="hsv"&&(t=this.toHsvString()),t||this.toHexString())},"toString"),clone:h(function(){return _t(this.toString())},"clone"),_applyModification:h(function(i,e){var t=i.apply(null,[this].concat([].slice.call(e)));return this._r=t._r,this._g=t._g,this._b=t._b,this.setAlpha(t._a),this},"_applyModification"),lighten:h(function(){return this._applyModification(Wte,arguments)},"lighten"),brighten:h(function(){return this._applyModification(Xte,arguments)},"brighten"),darken:h(function(){return this._applyModification(qte,arguments)},"darken"),desaturate:h(function(){return this._applyModification(jte,arguments)},"desaturate"),saturate:h(function(){return this._applyModification(Hte,arguments)},"saturate"),greyscale:h(function(){return this._applyModification(Gte,arguments)},"greyscale"),spin:h(function(){return this._applyModification(Zte,arguments)},"spin"),_applyCombination:h(function(i,e){return i.apply(null,[this].concat([].slice.call(e)))},"_applyCombination"),analogous:h(function(){return this._applyCombination(Kte,arguments)},"analogous"),complement:h(function(){return this._applyCombination(Yte,arguments)},"complement"),monochromatic:h(function(){return this._applyCombination(Qte,arguments)},"monochromatic"),splitcomplement:h(function(){return this._applyCombination(Jte,arguments)},"splitcomplement"),triad:h(function(){return this._applyCombination(iC,[3])},"triad"),tetrad:h(function(){return this._applyCombination(iC,[4])},"tetrad")};_t.fromRatio=function(i,e){if(eg(i)=="object"){var t={};for(var r in i)i.hasOwnProperty(r)&&(r==="a"?t[r]=i[r]:t[r]=lp(i[r]));i=t}return _t(i,e)};function zte(i){var e={r:0,g:0,b:0},t=1,r=null,n=null,a=null,o=!1,s=!1;return typeof i=="string"&&(i=rie(i)),eg(i)=="object"&&(Bo(i.r)&&Bo(i.g)&&Bo(i.b)?(e=Nte(i.r,i.g,i.b),o=!0,s=String(i.r).substr(-1)==="%"?"prgb":"rgb"):Bo(i.h)&&Bo(i.s)&&Bo(i.v)?(r=lp(i.s),n=lp(i.v),e=Ute(i.h,r,n),o=!0,s="hsv"):Bo(i.h)&&Bo(i.s)&&Bo(i.l)&&(r=lp(i.s),a=lp(i.l),e=$te(i.h,r,a),o=!0,s="hsl"),i.hasOwnProperty("a")&&(t=i.a)),t=oP(t),{ok:o,format:i.format||s,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}h(zte,"inputToRGB");function Nte(i,e,t){return{r:Bi(i,255)*255,g:Bi(e,255)*255,b:Bi(t,255)*255}}h(Nte,"rgbToRgb");function KM(i,e,t){i=Bi(i,255),e=Bi(e,255),t=Bi(t,255);var r=Math.max(i,e,t),n=Math.min(i,e,t),a,o,s=(r+n)/2;if(r==n)a=o=0;else{var l=r-n;switch(o=s>.5?l/(2-r-n):l/(r+n),r){case i:a=(e-t)/l+(e<t?6:0);break;case e:a=(t-i)/l+2;break;case t:a=(i-e)/l+4;break}a/=6}return{h:a,s:o,l:s}}h(KM,"rgbToHsl");function $te(i,e,t){var r,n,a;i=Bi(i,360),e=Bi(e,100),t=Bi(t,100);function o(u,c,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?u+(c-u)*6*p:p<1/2?c:p<2/3?u+(c-u)*(2/3-p)*6:u}if(h(o,"hue2rgb"),e===0)r=n=a=t;else{var s=t<.5?t*(1+e):t+e-t*e,l=2*t-s;r=o(l,s,i+1/3),n=o(l,s,i),a=o(l,s,i-1/3)}return{r:r*255,g:n*255,b:a*255}}h($te,"hslToRgb");function QM(i,e,t){i=Bi(i,255),e=Bi(e,255),t=Bi(t,255);var r=Math.max(i,e,t),n=Math.min(i,e,t),a,o,s=r,l=r-n;if(o=r===0?0:l/r,r==n)a=0;else{switch(r){case i:a=(e-t)/l+(e<t?6:0);break;case e:a=(t-i)/l+2;break;case t:a=(i-e)/l+4;break}a/=6}return{h:a,s:o,v:s}}h(QM,"rgbToHsv");function Ute(i,e,t){i=Bi(i,360)*6,e=Bi(e,100),t=Bi(t,100);var r=Math.floor(i),n=i-r,a=t*(1-e),o=t*(1-n*e),s=t*(1-(1-n)*e),l=r%6,u=[t,o,a,a,s,t][l],c=[s,t,t,o,a,a][l],p=[a,a,s,t,t,o][l];return{r:u*255,g:c*255,b:p*255}}h(Ute,"hsvToRgb");function eC(i,e,t,r){var n=[ja(Math.round(i).toString(16)),ja(Math.round(e).toString(16)),ja(Math.round(t).toString(16))];return r&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}h(eC,"rgbToHex");function Vte(i,e,t,r,n){var a=[ja(Math.round(i).toString(16)),ja(Math.round(e).toString(16)),ja(Math.round(t).toString(16)),ja(sP(r))];return n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}h(Vte,"rgbaToHex");function tC(i,e,t,r){var n=[ja(sP(r)),ja(Math.round(i).toString(16)),ja(Math.round(e).toString(16)),ja(Math.round(t).toString(16))];return n.join("")}h(tC,"rgbaToArgbHex");_t.equals=function(i,e){return!i||!e?!1:_t(i).toRgbString()==_t(e).toRgbString()};_t.random=function(){return _t.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function jte(i,e){e=e===0?0:e||10;var t=_t(i).toHsl();return t.s-=e/100,t.s=Bg(t.s),_t(t)}h(jte,"_desaturate");function Hte(i,e){e=e===0?0:e||10;var t=_t(i).toHsl();return t.s+=e/100,t.s=Bg(t.s),_t(t)}h(Hte,"_saturate");function Gte(i){return _t(i).desaturate(100)}h(Gte,"_greyscale");function Wte(i,e){e=e===0?0:e||10;var t=_t(i).toHsl();return t.l+=e/100,t.l=Bg(t.l),_t(t)}h(Wte,"_lighten");function Xte(i,e){e=e===0?0:e||10;var t=_t(i).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),_t(t)}h(Xte,"_brighten");function qte(i,e){e=e===0?0:e||10;var t=_t(i).toHsl();return t.l-=e/100,t.l=Bg(t.l),_t(t)}h(qte,"_darken");function Zte(i,e){var t=_t(i).toHsl(),r=(t.h+e)%360;return t.h=r<0?360+r:r,_t(t)}h(Zte,"_spin");function Yte(i){var e=_t(i).toHsl();return e.h=(e.h+180)%360,_t(e)}h(Yte,"_complement");function iC(i,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=_t(i).toHsl(),r=[_t(i)],n=360/e,a=1;a<e;a++)r.push(_t({h:(t.h+a*n)%360,s:t.s,l:t.l}));return r}h(iC,"polyad");function Jte(i){var e=_t(i).toHsl(),t=e.h;return[_t(i),_t({h:(t+72)%360,s:e.s,l:e.l}),_t({h:(t+216)%360,s:e.s,l:e.l})]}h(Jte,"_splitcomplement");function Kte(i,e,t){e=e||6,t=t||30;var r=_t(i).toHsl(),n=360/t,a=[_t(i)];for(r.h=(r.h-(n*e>>1)+720)%360;--e;)r.h=(r.h+n)%360,a.push(_t(r));return a}h(Kte,"_analogous");function Qte(i,e){e=e||6;for(var t=_t(i).toHsv(),r=t.h,n=t.s,a=t.v,o=[],s=1/e;e--;)o.push(_t({h:r,s:n,v:a})),a=(a+s)%1;return o}h(Qte,"_monochromatic");_t.mix=function(i,e,t){t=t===0?0:t||50;var r=_t(i).toRgb(),n=_t(e).toRgb(),a=t/100,o={r:(n.r-r.r)*a+r.r,g:(n.g-r.g)*a+r.g,b:(n.b-r.b)*a+r.b,a:(n.a-r.a)*a+r.a};return _t(o)};_t.readability=function(i,e){var t=_t(i),r=_t(e);return(Math.max(t.getLuminance(),r.getLuminance())+.05)/(Math.min(t.getLuminance(),r.getLuminance())+.05)};_t.isReadable=function(i,e,t){var r=_t.readability(i,e),n,a;switch(a=!1,n=nie(t),n.level+n.size){case"AAsmall":case"AAAlarge":a=r>=4.5;break;case"AAlarge":a=r>=3;break;case"AAAsmall":a=r>=7;break}return a};_t.mostReadable=function(i,e,t){var r=null,n=0,a,o,s,l;t=t||{},o=t.includeFallbackColors,s=t.level,l=t.size;for(var u=0;u<e.length;u++)a=_t.readability(i,e[u]),a>n&&(n=a,r=_t(e[u]));return _t.isReadable(i,r,{level:s,size:l})||!o?r:(t.includeFallbackColors=!1,_t.mostReadable(i,["#fff","#000"],t))};var rC=_t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},n3e=_t.hexNames=eie(rC);function eie(i){var e={};for(var t in i)i.hasOwnProperty(t)&&(e[i[t]]=t);return e}h(eie,"flip");function oP(i){return i=parseFloat(i),(isNaN(i)||i<0||i>1)&&(i=1),i}h(oP,"boundAlpha");function Bi(i,e){tie(i)&&(i="100%");var t=iie(i);return i=Math.min(e,Math.max(0,parseFloat(i))),t&&(i=parseInt(i*e,10)/100),Math.abs(i-e)<1e-6?1:i%e/parseFloat(e)}h(Bi,"bound01");function Bg(i){return Math.min(1,Math.max(0,i))}h(Bg,"clamp01");function Nn(i){return parseInt(i,16)}h(Nn,"parseIntFromHex");function tie(i){return typeof i=="string"&&i.indexOf(".")!=-1&&parseFloat(i)===1}h(tie,"isOnePointZero");function iie(i){return typeof i=="string"&&i.indexOf("%")!=-1}h(iie,"isPercentage");function ja(i){return i.length==1?"0"+i:""+i}h(ja,"pad2");function lp(i){return i<=1&&(i=i*100+"%"),i}h(lp,"convertToPercentage");function sP(i){return Math.round(parseFloat(i)*255).toString(16)}h(sP,"convertDecimalToHex");function nC(i){return Nn(i)/255}h(nC,"convertHexToDecimal");var so=function(){var i="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+i+")",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",n="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+n),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+n),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+n),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Bo(i){return!!so.CSS_UNIT.exec(i)}h(Bo,"isValidCSSUnit");function rie(i){i=i.replace(i3e,"").replace(r3e,"").toLowerCase();var e=!1;if(rC[i])i=rC[i],e=!0;else if(i=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=so.rgb.exec(i))?{r:t[1],g:t[2],b:t[3]}:(t=so.rgba.exec(i))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=so.hsl.exec(i))?{h:t[1],s:t[2],l:t[3]}:(t=so.hsla.exec(i))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=so.hsv.exec(i))?{h:t[1],s:t[2],v:t[3]}:(t=so.hsva.exec(i))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=so.hex8.exec(i))?{r:Nn(t[1]),g:Nn(t[2]),b:Nn(t[3]),a:nC(t[4]),format:e?"name":"hex8"}:(t=so.hex6.exec(i))?{r:Nn(t[1]),g:Nn(t[2]),b:Nn(t[3]),format:e?"name":"hex"}:(t=so.hex4.exec(i))?{r:Nn(t[1]+""+t[1]),g:Nn(t[2]+""+t[2]),b:Nn(t[3]+""+t[3]),a:nC(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=so.hex3.exec(i))?{r:Nn(t[1]+""+t[1]),g:Nn(t[2]+""+t[2]),b:Nn(t[3]+""+t[3]),format:e?"name":"hex"}:!1}h(rie,"stringInputToObject");function nie(i){var e,t;return i=i||{level:"AA",size:"small"},e=(i.level||"AA").toUpperCase(),t=(i.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}h(nie,"validateWCAG2Parms");var $8=kt(Bbe()),ic={margin:6,text:{numLines:2,lineHeight:1.2,size:11.5,maxWidth:150,foregroundColor:"white",backgroundColor:"#333"},marker:{size:5,foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}}},a3e={lightOnDark:{...ic,text:{...ic.text,foregroundColor:"white",backgroundColor:"#333"},marker:{...ic.marker,foregroundColor:{active:"white",inactive:void 0},backgroundColor:{active:"#333",inactive:void 0}}},darkOnLight:{...ic,text:{...ic.text,foregroundColor:"#333",backgroundColor:"white"},marker:{...ic.marker,foregroundColor:{active:"#333",inactive:void 0},backgroundColor:{active:"white",inactive:void 0}}}},o3e="LOW_PRIORITY",U8=4,s3e=6,l3e=20,u3e=2.5,h3e=2,c3e="cover",V8=.5,p3e=6.5,j8={heightAbovePolygon:0,appearance:a3e.darkOnLight},aC=class b0{constructor(e,t,r){Z(this,"lines",0);Z(this,"id");Z(this,"rank");Z(this,"type","label");Z(this,"initialRank");Z(this,"contextConfigured",!1);Z(this,"fillText");Z(this,"newStyle",{});Z(this,"opacity",0);Z(this,"visibilityNeedsUpdate",!0);Z(this,"activeStrategyIndex",-1);Z(this,"text");Z(this,"style",{top:0,left:0,textLabelVisible:!0,pinVisibility:1,textAlign:"left"});Z(this,"projection",new Ne);Z(this,"_cache",{});Z(this,"appearance");Z(this,"options");Z(this,"visible",!1);Z(this,"enabled",!0);Z(this,"activeBoundingBox",{x:0,y:0,w:0,h:0});Z(this,"dimensions",{width:0,height:0});Z(this,"currentStrategyIndex",-1);Z(this,"totalMarkerSize",0);Z(this,"dirty",!0);Z(this,"collisionDirty",!0);Z(this,"lastTextAlign");Z(this,"imageHash");Z(this,"markerSize",0);Z(this,"iconVisible",!1);Z(this,"zoomProportion",0);Z(this,"dp");Z(this,"onStrategySelected",e=>{if(this.currentStrategyIndex===e)return;let t=this.strategies[e];t&&t.onStrategySelected(this),this.currentStrategyIndex=e;let r=this.style;this.style=this.newStyle,this.newStyle=r,this.iconVisible||(this.opacity=0,this.visibilityNeedsUpdate=!0)});var n,a;if(this.id=(n=t.id)!=null?n:Ar(),this.options=(0,$8.default)({},t,j8),this.text=e,this.dp=(s=1)=>s*r.pixelRatio,typeof t.rank=="string")this.rank=j_(t.rank),this.initialRank=this.rank;else if(t.rank!=null&&t.rank>0)this.rank=t.rank,this.initialRank=t.rank;else{let s=Math.trunc(dr.env.NODE_ENV==="test"?b0.testId:b0.testId*10)/10;b0.testId+=.001,this.rank=s,this.initialRank=s}let o=(0,$8.default)({},this.options.appearance,j8.appearance);this.appearance={margin:o.margin,text:{lineHeight:o.text.lineHeight,numLines:o.text.numLines,size:o.text.size,maxWidth:o.text.maxWidth,foregroundColor:o.text.foregroundColor,backgroundColor:o.text.backgroundColor},marker:{foregroundColor:{active:o.marker.foregroundColor.active,inactive:o.marker.foregroundColor.inactive||_t(o.marker.foregroundColor.active).setAlpha(.5).toRgbString()},backgroundColor:{active:o.marker.backgroundColor.active,inactive:o.marker.backgroundColor.inactive||_t(o.marker.backgroundColor.active).setAlpha(.5).toRgbString()},icon:o.marker.icon,iconSize:o.marker.iconSize||l3e,iconPadding:(a=o.marker.iconPadding)!=null?a:h3e,iconFit:o.marker.iconFit||c3e,iconVisibilityThreshold:o.marker.iconVisibilityThreshold==null?V8:o.marker.iconVisibilityThreshold}},this.calculateMarkerSize()}setEntity(){}calculateMarkerSize(){let{iconVisibilityThreshold:e=V8}=this.appearance.marker,t=this.dp();this.zoomProportion<=e&&typeof this.appearance.marker.iconSize<"u"&&this.imageHash?(this.markerSize=this.dp(this.appearance.marker.iconSize),this.iconVisible=!0):(this.iconVisible=!1,this.markerSize=this.dp(p3e)),this.totalMarkerSize=Math.ceil((this.markerSize+u3e)/t)}get strategies(){let{width:e,height:t}=this.dimensions,{margin:r}=this.appearance;this.calculateMarkerSize();let n=Math.max(s3e,r),a=this.iconVisible?n/2:0,o=[{name:"RIGHT",getBoundingBox:()=>{let s=Math.max(this.totalMarkerSize,t);return[s/2+n,s/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+e+n]},onStrategySelected:()=>{this.newStyle.textAlign="left",this.newStyle.pinVisibility=1,this.newStyle.top=-t/2,this.newStyle.left=this.totalMarkerSize/2+U8,this.newStyle.textLabelVisible=!0}},{name:"LEFT",getBoundingBox:()=>{let s=Math.max(this.totalMarkerSize,t);return[s/2+n,s/2+n,this.totalMarkerSize/2+e+n,this.totalMarkerSize/2+n]},onStrategySelected:()=>{this.newStyle.textAlign="right",this.newStyle.pinVisibility=1,this.newStyle.top=-t/2,this.newStyle.left=-e-this.totalMarkerSize/2-U8,this.newStyle.textLabelVisible=!0}},{name:"TOP",getBoundingBox:()=>{let s=this.dp();return[t+this.totalMarkerSize/2/s+n,this.totalMarkerSize/2+n,e/2+n,e/2+n]},onStrategySelected:()=>{this.newStyle.pinVisibility=1,this.newStyle.textAlign="center",this.newStyle.textLabelVisible=!0,this.newStyle.top=-this.totalMarkerSize-t/2,this.newStyle.left=-e/2}},{name:o3e,getBoundingBox:()=>[this.totalMarkerSize/2+a,this.totalMarkerSize/2+a,this.totalMarkerSize/2+a,this.totalMarkerSize/2+a],onStrategySelected:()=>{this.newStyle.pinVisibility=.5,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0}}];return this.text===""?[{name:"ICON_ONLY",getBoundingBox:()=>[this.totalMarkerSize/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+n,this.totalMarkerSize/2+n],onStrategySelected:()=>{this.newStyle.pinVisibility=1,this.newStyle.textLabelVisible=!1,this.newStyle.top=0,this.newStyle.left=0}}]:o}updatePosition(){}disable(){this.visible=!1}toJSON(){return{x:this.projection.x,y:this.projection.y,enabled:this.enabled,id:this.id,rank:this.rank,bboxes:this.strategies.map((e,t)=>({index:t,boundingBox:e.getBoundingBox()})),shouldCollideWithScreenEdges:!1}}destroy(){}};h(aC,"LabelComponent"),ie(aC,"testId",0);var d3e=aC,Fp=d3e;R();R();function aie(i){return PQ(i)}h(aie,"getBoundingBoxFromFeature");var oie=class extends IT{constructor(){super(...arguments);Z(this,"userData",{entities:{}})}};h(oie,"EntityBatchedMesh");var sie=oie,w0,S0,Fc,lie=class{constructor(e){ie(this,"mesh"),ie(this,"focusMesh"),ie(this,"outline"),ie(this,"type","geometry"),ie(this,"instanceIndex",-1),ie(this,"geometry"),ie(this,"material"),ie(this,"feature"),ie(this,"focusable",!1),ie(this,"color",new Rt),ie(this,"topColor",new Rt),ie(this,"position",new le),fe(this,w0,0),fe(this,S0,1),fe(this,Fc,void 0),ie(this,"texturesVisible",!1),this.feature=e}get visible(){return this.mesh?this.mesh.getVisibleAt(this.instanceIndex):!1}set visible(e){this.mesh&&this.mesh.setVisibleAt(this.instanceIndex,e)}setOpacity(e){this.mesh&&(this.material&&(this.material.opacity=e,this.material.transparent=e<1),this.outline&&(e<.5?this.outline.visible=!1:this.outline.visible=!0),e===0?this.mesh.visible=!1:this.mesh.visible=!0)}setColor(e,t){this.color.set(e),this.topColor.set(t),this.material&&this.material.setColor(this.instanceIndex,this.color,this.topColor)}get altitude(){return M(this,w0)}set altitude(e){this.mesh&&(this.mesh.position.z=e,Re(this,w0,e))}get opacity(){return M(this,S0)}set opacity(e){this.material&&(this.material.opacity=e,this.material.transparent=e<1,this.outline&&(this.outline.visible=e>.5),this.material.needsUpdate=!0),Re(this,S0,e)}get texture(){var e,t;return(t=(e=this.material)==null?void 0:e.texture)==null?void 0:t.image.src}set texture(e){this.material&&(this.material.texture=e)}set topTexture(e){this.material&&(this.material.topTexture=e)}get topTexture(){var e,t;return(t=(e=this.material)==null?void 0:e.topTexture)==null?void 0:t.image.src}get featureBbox(){return M(this,Fc)?M(this,Fc):(Re(this,Fc,aie(this.feature)),M(this,Fc))}showTextures(){this.material&&(this.material.showTextures(this.instanceIndex),this.texturesVisible=!0)}hideTextures(){this.material&&(this.material.hideTextures(this.instanceIndex),this.texturesVisible=!1)}};w0=new WeakMap,S0=new WeakMap,Fc=new WeakMap,h(lie,"MeshComponent");var Ko=lie,uie=class extends Zr{constructor(){super();Z(this,"interpolators",new Map);Z(this,"update",t=>{for(let[r,n]of this.interpolators)r instanceof Ko?r.setOpacity(n(t)):r instanceof Fp?r.enabled=n(t):n(t)})}addEntity3D(t,r){let[n,a,o,s]=r[1];this.interpolators.set(t,l=>Lh(l,n,a,o,s))}addEntity2D(t,r){let[n,a,o]=r[1];this.interpolators.set(t,s=>s<n?a:o)}addAny(t,r){this.interpolators.set(t,r)}destroy(){this.interpolators.clear()}};h(uie,"ZoomInterpolationSystem");var f3e=uie;R();var oC=class M0{constructor(e,t={}){Z(this,"id");Z(this,"type","marker");Z(this,"rank",0);Z(this,"initialRank",0);Z(this,"options",{});Z(this,"projection",new Ne);Z(this,"enabled",!0);Z(this,"activeStrategyIndex",-1);Z(this,"strategyIndex",-1);Z(this,"activeBoundingBox",{x:0,y:0,w:0,h:0});Z(this,"dimensions",{width:0,height:0});Z(this,"containerEl");Z(this,"contentEl",null);Z(this,"contentHtml","");Z(this,"style",{top:"0px",left:"0px"});Z(this,"dirty",!1);Z(this,"collisionDirty",!0);Z(this,"visibilityNeedsUpdate",!0);Z(this,"visible",!1);Z(this,"animation",null);Z(this,"currentStrategyIndex",-1);Z(this,"onStrategySelected",(e,t=!1)=>{if(this.currentStrategyIndex===e||t)return;let{width:r,height:n}=this.dimensions,a=-n/2+"px",o=-r/2+"px";switch(this.style.top=a,this.style.left=o,this.options.anchor){case"top":{this.style.top=-n+"px";break}case"bottom":{this.style.top="0px";break}case"left":{this.style.left=-r+"px";break}case"right":{this.style.left="0px";break}default:this.style.top=a,this.style.left=o}this.containerEl.style.top=this.style.top,this.containerEl.style.left=this.style.left});if(this.id=(t==null?void 0:t.id)||Ar(),this.options=t,typeof t.rank=="string")this.rank=j_(t.rank);else if(t.rank!=null&&t.rank>0)this.rank=t.rank;else{let n=Math.trunc(dr.env.NODE_ENV==="test"?M0.testId:M0.testId*10)/10;M0.testId+=.001,this.rank=n}this.contentHtml=e,this.initialRank=this.rank;let r=document.createElement("div");r.style.opacity="0",r.innerHTML=`<div class="mappedin-marker">${this.contentHtml}</div>`,this.containerEl=r.querySelector(".mappedin-marker"),this.containerEl.setAttribute("data-marker-id",this.id.toString()),this.contentEl=this.containerEl?this.containerEl.firstElementChild:null}updateDimensions(e,t){if(e!=null&&t!=null)this.dimensions={width:e,height:t};else{let{width:r,height:n}=this.containerEl.getBoundingClientRect();this.dimensions={width:r,height:n}}Object.assign(this.containerEl,{width:this.dimensions.width+"px",height:this.dimensions.height+"px"})}get strategies(){let{width:e,height:t}=this.dimensions;return[{name:"center",getBoundingBox:()=>{let r=t/2,n=t/2,a=e/2,o=e/2;switch(this.options.anchor){case"top":{r=t,n=0;break}case"bottom":{r=0,n=t;break}case"left":{a=e,o=0;break}case"right":{a=0,o=e;break}}return[r,n,a,o]}}]}toJSON(){return{x:this.projection.x,y:this.projection.y,enabled:this.enabled,id:this.id,rank:this.rank,bboxes:this.strategies.map((e,t)=>({index:t,boundingBox:e.getBoundingBox()})),shouldCollideWithScreenEdges:!1}}destroy(){}};h(oC,"MarkerComponent"),ie(oC,"testId",0);var Op=oC;R();R();R();R();R();var hie=class{constructor(){Z(this,"hover",!1);Z(this,"dirty",!1)}};h(hie,"InteractionComponent");var kb=hie;function Da(i,e,t){if(e!==void 0){if(i.type==="model"||i.type==="path"||i.type==="marker"||i.type==="label"||i.type==="geometry"||i.type==="group-container")return e===!0?(i instanceof ud&&i.components[1]===void 0?(i.components[1]=new kb,i.components[1].dirty=!0):i instanceof Xn&&i.components[2]===void 0?(i.components[2]=new kb,i.components[2].dirty=!0):i instanceof xa&&i.components[1]===void 0&&(i.components[1]=new kb,i.components[1].dirty=!0),!0):(i instanceof ud?i.components[1]=void 0:i instanceof Xn?i.components[2]=void 0:i instanceof xa&&(i.components[1]=void 0),!0);if(i.type==="geometry-group"){let r;for(let n of i.userData.entities3D.values())r=t.entity3DMap.get(n),Da(r,e,t);return!0}}return!1}h(Da,"updateInteractivity");function cie(i,e,t){if(t!==void 0&&i.type==="geometry-group"&&i.components[0]!=null){let r,n,a=i.components[0];for(let o of i.userData.entities3D.values())r=e.entity3DMap.get(o),r&&(n=r.components[1],n.color===a.color&&(n.initialColor=t.color||a.color,n.color=t.color||a.color,n.dirty=!0),n.topColor===a.topColor&&(n.topColor=t.topColor||a.topColor,n.dirty=!0));return t.color!==void 0&&(i.components[0].color=t.color),t.topColor!==void 0&&(i.components[0].topColor=t.topColor),!0}return!1}h(cie,"updateGroupColor");function pie(i,e){if(e!==void 0&&i.type==="geometry-group"&&i.components[0]!=null){let t=i.components[0];return t.shading=t.shading||{},t.shading&&(e.start!==t.shading.start||e.end!==t.shading.end||e.intensity!==t.shading.intensity)&&(Object.assign(t.shading,e),i.userData.shadingDirty=!0),!0}return!1}h(pie,"updateGroupShading");function die(i,e){e!==void 0&&(i.type==="path"||i.type==="geometry")&&(e.initialColor!==void 0&&(i.components[1].initialColor=e.initialColor),e.color!==void 0&&(i.components[1].color=e.color),e.topColor!==void 0&&(i.components[1].topColor=e.topColor),i.components[1].dirty=!0)}h(die,"updateColor");function sC(i,e,t){e!==void 0&&(i.type==="label"||i.type==="marker"?(i.object3d.position.copy(t(e[1],e[0],e[2]||0)),i.positionDirty=!0):i.type==="custom-geometry"&&i.components[0].position.copy(t(e[1],e[0],e[2]||0)))}h(sC,"updatePosition");function lC(i,e){var t;return e!==void 0&&(i.type==="marker"||i.type==="label"||i.type==="custom-geometry")&&i.parent!==e&&i.parent instanceof xa?((t=i.parent)==null||t.removeEntity(i),e.addEntity(i),!0):!1}h(lC,"updateParent");function fie(i,e){e!==void 0&&(i.type==="marker"||i.type==="label")&&(i.components[0].enabled=e)}h(fie,"updateEnabled");function mie(i,e){if(e!==void 0&&i.type==="path"){let t=i.components[0];e.completeFraction!==void 0&&(t.completeFraction=e.completeFraction)}}h(mie,"updatePath");function gie(i,e){if(e!==void 0&&i.type==="marker"){let t=i.components[0];if(e.contentHTML!==void 0)return t.containerEl.innerHTML=e.contentHTML,!0}return!1}h(gie,"updateMarker");function yie(i,e){return e!==void 0&&(i.type==="marker"||i.type==="label")?(i.components[0].rank=j_(e),!0):!1}h(yie,"updateRank");function vie(i,e){var t,r,n;if(e!==void 0&&i.type==="label"){let a=i.components[0];e.text!==void 0&&(a.text=e.text,a.dirty=!0),((t=e.options)==null?void 0:t.appearance)!==void 0&&Object.keys((r=e.options)==null?void 0:r.appearance).length>0&&(rP(a.appearance,((n=e.options)==null?void 0:n.appearance)||{}),a.dirty=!0)}}h(vie,"updateLabel");function xie(i,e){e!==void 0&&i.type==="geometry"&&(i.components[1].hoverColor=e,i.components[1].dirty=!0)}h(xie,"updateHoverColor");function Oc(i,e){if(e!==void 0){if(i.type==="model"||i.type==="path"||i.type==="geometry"||i.type==="custom-geometry"){i.components[1].visible=e,i.components[1].dirty=!0;let t=i.parent;t instanceof Us&&(t.userData.outlineDirty=!0)}else(i.type==="group-container"||i.type==="geometry-group")&&i.setVisible(e);return!0}return!1}h(Oc,"updateVisibility");function _ie(i,e,t){if(t!==void 0&&i.type==="geometry-group"){i.setOpacity(t),i.components[0].opacity=t;for(let r of i.userData.entities3D.values()){let n=e.entity3DMap.get(r);((n==null?void 0:n.type)==="geometry"||(n==null?void 0:n.type)==="model")&&(n.components[1].opacity=t,n.components[1].dirty=!0)}}}h(_ie,"updateOpacity");function uC(i,e){e!==void 0&&(i.type==="model"||i.type==="path"||i.type==="geometry"||i.type==="custom-geometry"?(i.components[1].altitude=e,i.components[1].dirty=!0):i.type==="group-container"&&i.setAltitude(e))}h(uC,"updateAltitude");function hC(i,e){if(e!==void 0){if(i.type==="geometry-group"&&i.components[0]!=null)i.components[0].outline=e,i.userData.outlineDirty=!0;else if(i.type==="geometry"){i.components[1].outline=e,i.components[1].dirty=!0;let t=i.parent;t instanceof Us&&(t.userData.outlineDirty=!0)}return!0}return!1}h(hC,"updateOutline");var up,Es,cC,pC,bie,C0,dC,fC,wie,mC,Sie,E0,gC,T0,cx,yC,Mie=class{constructor(e){fe(this,pC),fe(this,fC),fe(this,mC),fe(this,up,null),fe(this,Es,void 0),ie(this,"getCurrentSceneGLTF",async t=>{let r={onlyVisible:!0,binary:!0,light:!0,scale:1,...t},n=await $t(this,pC,bie).call(this),a=M(this,cC).call(this,r),o=await n.parseAsync(a,{trs:!1,maxTextureSize:1/0,onlyVisible:r.onlyVisible,binary:r.binary,scale:r.scale}),s;if(o instanceof ArrayBuffer)s=new Blob([o],{type:"application/octet-stream"});else{let l=JSON.stringify(o,null,2);s=new Blob([l],{type:"text/plain"})}return s}),fe(this,cC,h(t=>{let{scale:r,light:n,onlyVisible:a}=t,o=new wY,s=new tn().setFromObject(M(this,Es).entityScene);if(M(this,C0).call(this,M(this,Es).entityScene,o,a),n){let l=new IK(16777215,.3*Math.PI);l.position.set(0,Math.max(s.max.x,s.max.y)*r*.5,s.max.y*r*4),l.lookAt(0,0,-1),l.target.position.set(0,0,-1),l.add(l.target),o.add(l)}return o},"#getExportedScene")),fe(this,C0,h((t,r,n)=>{t.material&&(t instanceof IT?$t(this,fC,wie).call(this,t).forEach(a=>r.add(a)):t instanceof P_&&r.add($t(this,mC,Sie).call(this,t))),t.children.forEach(a=>{(!n||a.visible)&&M(this,C0).call(this,a,r,n)})},"#processObject3D")),fe(this,dC,h((t,r,n)=>{let a=new ZJ({color:new Rt(t),metalness:0});return a.opacity=r,a.transparent=n,a},"#createStandardMaterial")),fe(this,E0,h(t=>{let{geometry:r,material:n,position:a,rotation:o,quaternion:s,scale:l}=t;if(!(r!=null&&r.isBufferGeometry))return t;let u=r.attributes.position,c=r.attributes.normal,p=r.attributes.uv;return M(this,gC).call(this,u,c),M(this,cx).call(this,a,l,o,s),p&&M(this,yC).call(this,p),n!=null&&n.map&&r.type==="PlaneGeometry"&&(t.side=Na),t},"#convertGeometry")),fe(this,gC,h((t,r)=>{let n=new le,a=new le;for(let o=0;o<t.count;o++)n.fromBufferAttribute(t,o),M(this,T0).call(this,n),t.setXYZ(o,n.x,n.y,n.z),r&&(a.fromBufferAttribute(r,o),M(this,T0).call(this,a),r.setXYZ(o,a.x,a.y,a.z))},"#convertAttributes")),fe(this,T0,h(t=>{let r=t.y;t.y=t.z,t.z=-r},"#convertVector")),fe(this,cx,h((t,r,n,a)=>{let o=t.y;t.y=t.z,t.z=-o;let s=r.y;if(r.y=r.z,r.z=s,n instanceof Xa)n.order="YXZ",n.set(n.x,n.y,n.z,n.order);else{let l=a.y;a.set(a.x,a.z,-l,a.w)}},"#convertObjectProperties")),fe(this,yC,h(t=>{for(let r=0;r<t.count;r++){let n=t.getX(r),a=t.getY(r);t.setXY(r,n,a)}},"#convertUVs")),Re(this,Es,e),M(this,Es).entityScene=e.entityScene,M(this,Es).entity3DMap=e.entity3DMap}destroy(){Re(this,up,null)}};up=new WeakMap,Es=new WeakMap,cC=new WeakMap,pC=new WeakSet,bie=h(async function(){if(!M(this,up)){let{GLTFExporter:i}=await lg(()=>import("./GLTFExporter-DJTLMZRS-ClvHyshM.js"),[]);Re(this,up,new i)}return M(this,up)},"#getGLTFExporter"),C0=new WeakMap,dC=new WeakMap,fC=new WeakSet,wie=h(function(i){var e,t;let r=[],n=((e=i.userData)!=null&&e.entities?Object.values((t=i.userData)==null?void 0:t.entities):[]).map(o=>M(this,Es).entity3DMap.get(o)),a=new Map;return n.forEach(o=>{var s;if(!o||!(o instanceof Xn))return;let l=o.components[1],u=o.components[2];if(!l.visible||l.opacity===0)return;let c=`${u!=null&&u.hover?l.hoverColor||M(this,Es).hoverColor:l.color}-${l.opacity}-${Number(l.visible)}`;a.has(c)||a.set(c,[]),(s=a.get(c))==null||s.push(o)}),a.forEach((o,s)=>{let[l,u,c]=s.split("-"),p=o.reduce((_,y)=>{let x=y.components[0];if(x.type==="custom-geometry")return _;let w=x==null?void 0:x.geometry;return w&&_.push(w),_},[]),d=M(this,dC).call(this,l,Number(u),i.material.transparent),m=Ed(p,!0),g=new Zi(m,d);g.position.copy(i.position),g.rotation.copy(i.rotation),g.scale.copy(i.scale),g.visible=!!c,M(this,cx).call(this,g.position,g.scale,g.rotation,g.quaternion),r.push(M(this,E0).call(this,g))}),r},"#processBatchedMesh"),mC=new WeakSet,Sie=h(function(i){let e=i.geometry.clone(),t=i.material,r=new wd({color:t.color,side:Na});r.opacity=t.opacity,r.transparent=t.transparent;let n=new P_(e,r);return n.position.copy(i.position),n.rotation.copy(i.rotation),n.scale.copy(i.scale),n.visible=i.visible,M(this,E0).call(this,n)},"#processLineSegments"),E0=new WeakMap,gC=new WeakMap,T0=new WeakMap,cx=new WeakMap,yC=new WeakMap,h(Mie,"ExporterSystem");var m3e=Mie;R();var H8="#ffffff",Cie=class{constructor(e={}){Z(this,"initialColor",H8);Z(this,"color",H8);Z(this,"topColor");Z(this,"topTexture");Z(this,"texture");Z(this,"hoverColor");Z(this,"dirty",!0);Z(this,"visible",!0);Z(this,"opacity",1);Z(this,"width",.1);Z(this,"height",.1);Z(this,"altitude",0);Z(this,"join","round");Z(this,"cap","round");Z(this,"outline",!0);this.color=(e==null?void 0:e.color)!==void 0?e.color:this.color,this.initialColor=this.color,this.width=(e==null?void 0:e.width)!==void 0?e.width:this.width,this.opacity=(e==null?void 0:e.opacity)!==void 0?e.opacity:this.opacity,this.visible=(e==null?void 0:e.visible)!==void 0?e.visible:this.visible,this.height=(e==null?void 0:e.height)!==void 0?e.height:this.height,this.altitude=(e==null?void 0:e.altitude)!==void 0?e.altitude:this.altitude,this.join=(e==null?void 0:e.join)!==void 0?e.join:this.join,this.cap=(e==null?void 0:e.cap)!==void 0?e.cap:this.cap,this.topColor=e==null?void 0:e.topColor,this.texture=e==null?void 0:e.texture,this.topTexture=e==null?void 0:e.topTexture,this.outline=(e==null?void 0:e.outline)!==void 0?!!e.outline:this.outline}};h(Cie,"StyleComponent");var px=Cie;R();R();R();R();var Eie={top:0,bottom:0,left:0,right:0};R();R();R();R();var Tie=class extends T_{constructor(t){let r=t,n=3,a=n*4;super(new Float32Array(t*a),n,t,Gn,ca);Z(this,"_width");Z(this,"_height");Z(this,"_propertiesLength");this._width=a,this._height=r,this._propertiesLength=n}setColor(t,r,n){let a=this.image.data,o=t*this._width;a[o]=r.r,a[o+1]=r.g,a[o+2]=r.b,a[o+3]=0,a[o+4]=n.r,a[o+5]=n.g,a[o+6]=n.b,a[o+7]=0,this.needsUpdate=!0}setTexture(t,r,n){let a=this.image.data,o=t*this._width;a[o+8]=r?1:0,a[o+9]=n?1:0,a[o+10]=0,a[o+11]=0,this.needsUpdate=!0}};h(Tie,"BatchedPropertiesTexture");var g3e=Tie,y3e=`#define LAMBERT
varying vec3 vViewPosition;
varying vec4 vPosition;
varying vec2 vUv;
varying vec4 finalPosition;
varying vec3 vWorldPosition;
varying vec3 worldNormal;
varying float vBatchId;

#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vBatchId = batchId + 0.5;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
	// vertex normal relative to world space
	worldNormal = normal;
	vUv = uv;
	// world position
	vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;
}`,v3e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
uniform float uGradientEnd;
uniform float uGradientIntensity;
uniform float uMinSideAlpha;
uniform float uMaxSideAlpha;
uniform float uGradientStart;
uniform highp sampler2D uPropertiesTexture;
uniform highp sampler2D uTopTexture;
uniform highp sampler2D uTexture;
varying float vBatchId;

varying vec2 vUv;
varying vec3 vWorldPosition;
varying vec3 worldNormal;

#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>

void main() {
	#include <clipping_planes_fragment>

	// get the normalized world normal of vertex fragment
	vec3 surfaceNormal = normalize(worldNormal);

	// get angle relative to Z up
	float angle = degrees(acos(abs(dot(surfaceNormal, vec3(0.0, 0.0, 1.0)))));

	int idx = int(vBatchId) * 1;
	vec3 diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(0, idx), 0).rgb);
	bool shouldShowTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).r == 1.0;

	if(shouldShowTexture) {
		diffuse = texture2D(uTexture, vUv).rgb;
	}

	// if this is a fragment facing upwards, use topColor
	if(angle == 0.0) {
		bool shouldShowTopTexture = texelFetch(uPropertiesTexture, ivec2(2, idx), 0).g == 1.0;

		if(shouldShowTopTexture) {
			diffuse = texture2D(uTopTexture, vUv).rgb;
		} else {
			diffuse = vec3(texelFetch(uPropertiesTexture, ivec2(1, idx), 0).rgb);
		}
	}

	vec4 diffuseColor = vec4(diffuse, opacity);

	// only for vertical surfaces
	if(angle > 89.0 && angle < 91.0) {

		// get the percentage of the z position from the ground, up
		float percentFromZeroZ = max((abs(vWorldPosition.z) - uGradientStart) / uGradientEnd, 0.0);

		// gradient based on percentage
		float alpha = smoothstep(uMinSideAlpha, uMaxSideAlpha, percentFromZeroZ);

		// mix the shadow color with the diffuse color based on the alpha and opacity
		diffuseColor = vec4(mix(diffuseColor.rgb, diffuseColor.rgb * (1.0 - uGradientIntensity), 1.0 - alpha), opacity);
	}

	ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}
`,x3e=-.05,_3e=1,Pie=class extends rx{constructor(t,r){super(t);Z(this,"propertiesTexture");Z(this,"uniforms",{uGradientIntensity:{value:0},uGradientEnd:{value:0},uGradientStart:{value:0},uTopTexture:{value:null},uTexture:{value:null}});Z(this,"showTextures",t=>{let r=!!this.uniforms.uTexture.value,n=!!this.uniforms.uTopTexture.value;(r||n)&&(this.propertiesTexture.setTexture(t,r,n),this.needsUpdate=!0)});this.propertiesTexture=new g3e(r),this.onBeforeCompile=n=>{let a=this.uniforms.uGradientIntensity,o=this.uniforms.uGradientEnd,s=this.uniforms.uGradientStart,l=this.uniforms.uTopTexture,u=this.uniforms.uTexture;this.uniforms=n.uniforms,n.vertexShader=y3e,n.fragmentShader=v3e,Object.assign(this.uniforms,{uGradientIntensity:a,uGradientEnd:o,uGradientStart:s,uMinSideAlpha:{value:x3e},uMaxSideAlpha:{value:_3e},uPropertiesTexture:{value:this.propertiesTexture},uTopTexture:l,uTexture:u})}}get texture(){return this.uniforms.uTexture.value}set texture(t){t.wrapS=_o,t.wrapT=_o,t.colorSpace=Un,this.uniforms.uTexture.value=t}get topTexture(){return this.uniforms.uTopTexture.value}set topTexture(t){t.wrapS=_o,t.wrapT=_o,t.colorSpace=Un,this.uniforms.uTopTexture.value=t}setGradientShading(t,r,n){this.uniforms.uGradientStart.value=t,this.uniforms.uGradientEnd.value=r,this.uniforms.uGradientIntensity.value=n}setColor(t,r,n){this.propertiesTexture.setColor(t,r,n)}hideTextures(t){let r=!!this.uniforms.uTexture.value,n=!!this.uniforms.uTopTexture.value;(r||n)&&(this.propertiesTexture.setTexture(t,!1,!1),this.needsUpdate=!0)}dispose(){super.dispose(),this.propertiesTexture.dispose()}};h(Pie,"BatchedStandardMaterial");var b3e=Pie;R();var w3e=80;function Aie(i,e){var t,r;let n=0;for(let u of i)n+=((r=(t=u.components[0])==null?void 0:t.geometry)==null?void 0:r.attributes.position.count)||0;let a=new Rt(e.color),o=new b3e({color:a,side:Na,opacity:e.opacity||1,transparent:e.opacity!==void 0?e.opacity<1:!1},i.length),s=new sie(i.length,n,0,o),l;for(let u of i)l=u.components[0],!(!(l instanceof Ko)||!l.geometry)&&(l.mesh=s,l.material=o,l.instanceIndex=s.addGeometry(l.geometry),s.userData.entities[l.instanceIndex]=u.id,o.setColor(l.instanceIndex,a,e.topColor?new Rt(e.topColor):a));return s.perObjectFrustumCulled=!0,s.matrixAutoUpdate=!1,s}h(Aie,"batchGeometries");function Iie(i,e){e.polygonOffset=!0,e.polygonOffsetFactor=1,e.polygonOffsetUnits=1;let t=new g2e(i,w3e),r=_t(e.color.getHexString()).darken(30).toRgbString(),n=new $Y({linewidth:2,color:r,transparent:!0}),a=new P_(t,n);return a.layers.set(1),a}h(Iie,"createOutlines");R();var S3e="gray",M3e=.1;function Lie(i,e,t){let{color:r=S3e,opacity:n=1,altitude:a=0,height:o=M3e}=t||{};Array.isArray(n)&&(n=1);let s={min:{x:1/0,y:1/0,z:a},max:{x:-1/0,y:-1/0,z:o+a},center:{x:0,y:0,z:(o+a)/2}},l=new Sd,u=i.geometry.coordinates[0].map(m=>{let g=e(m[1],m[0]);return s.min.x=Math.min(s.min.x,g.x),s.min.y=Math.min(s.min.y,g.y),s.max.x=Math.max(s.max.x,g.x),s.max.y=Math.max(s.max.y,g.y),g});l.moveTo(u[0].x,u[0].y),u.slice(1).forEach(m=>l.lineTo(m.x,m.y)),l.lineTo(u[0].x,u[0].y);let c=i.geometry.coordinates.slice(1);l.holes=c.map(m=>{let g=m.map(y=>e(y[1],y[0])),_=new nd;return _.moveTo(g[0].x,g[0].y),g.slice(1).forEach(y=>_.lineTo(y.x,y.y)),_.lineTo(g[0].x,g[0].y),_});let p={bevelEnabled:!1,depth:o},d=new Dg(l,p);return d.translate(0,0,a||0),d.userData={style:{color:r,opacity:n}},d}h(Lie,"renderPolygonGeometry");R();var C3e="gray",E3e=.1;function Die(i,e,t){let{color:r=C3e,opacity:n=1,altitude:a=0,height:o=E3e}=t||{};Array.isArray(n)&&(n=1);let s={min:{x:1/0,y:1/0,z:a},max:{x:-1/0,y:-1/0,z:o+a}},l={bevelEnabled:!1,depth:o},u=[];i.geometry.coordinates.forEach(p=>{let d=new Sd,m=p[0].map(y=>{let x=e(y[1],y[0]);return s.min.x=Math.min(s.min.x,x.x),s.min.y=Math.min(s.min.y,x.y),s.max.x=Math.max(s.max.x,x.x),s.max.y=Math.max(s.max.y,x.y),x});d.moveTo(m[0].x,m[0].y),m.slice(1).forEach(y=>d.lineTo(y.x,y.y)),d.lineTo(m[0].x,m[0].y);let g=p.slice(1);d.holes=g.map(y=>{let x=y.map(b=>e(b[1],b[0])),w=new nd;return w.moveTo(x[0].x,x[0].y),x.slice(1).forEach(b=>w.lineTo(b.x,b.y)),w.lineTo(x[0].x,x[0].y),w});let _=new Dg(d,l);u.push(_)});let c=Ed(u);return c.translate(0,0,a||0),c.userData={style:{color:r,opacity:n}},c}h(Die,"renderMultiPolygonGeometry");R();R();var kie=kt(zbe());function lP(i){this.name="JSClipperError",this.message=i,this.stack=new Error().stack}h(lP,"JSClipperError");lP.prototype=Error.prototype;kie.default.Error=function(i){throw new lP(i)};var ka=kie.default,T3e="gray",Rb=new ka.ClipperOffset,bn=100;function Rie(i,e,t){let{color:r=T3e,opacity:n=1,width:a=1,join:o="round",cap:s="round",height:l=.01,altitude:u=0}=t||{};Array.isArray(n)&&(n=0);let c=[];for(let _=0;_<i.geometry.coordinates.length-1;_++){let y=e(i.geometry.coordinates[_][1],i.geometry.coordinates[_][0]),x=e(i.geometry.coordinates[_+1][1],i.geometry.coordinates[_+1][0]);c.push([y,x])}Rb.AddPaths(c.map(_=>_.map(y=>({X:y.x*bn,Y:y.y*bn}))),o==="round"?ka.JoinType.jsRound:o==="miter"?ka.JoinType.jsMiter:ka.JoinType.jsSquare,s==="round"?ka.EndType.etOpenRound:s==="butt"?ka.EndType.etOpenButt:ka.EndType.etOpenSquare);let p=new ka.PolyTree;Rb.Execute(p,a/2*bn);let d=[],m={bevelEnabled:!1,depth:l};for(let _ of p.m_AllPolys){let y=new Sd;if(_.IsHole())continue;let x=_.m_polygon;y.moveTo(x[0].X/bn,x[0].Y/bn),x.slice(1).forEach(w=>y.lineTo(w.X/bn,w.Y/bn)),y.lineTo(x[0].X/bn,x[0].Y/bn),y.holes=_.m_Childs.map(w=>{let b=new nd,C=w.m_polygon;return b.moveTo(C[0].X/bn,C[0].Y/bn),C.slice(1).forEach(E=>b.lineTo(E.X/bn,E.Y/bn)),b.lineTo(C[0].X/bn,C[0].Y/bn),b}),d.push(new Dg(y,m))}let g=Ed(d);return g.translate(0,0,u||0),g.userData={style:{color:r,opacity:n}},Rb.Clear(),g}h(Rie,"renderLineStringGeometry");R();var wn=100,P3e=.22,A3e=.01;function Fie(i,e,t={}){let{width:r=P3e,height:n=A3e,color:a="gray",opacity:o=1,altitude:s=0}=t,l={min:{x:1/0,y:1/0,z:s},max:{x:-1/0,y:-1/0,z:s+n}},u={bevelEnabled:!1,depth:n},c=new ka.ClipperOffset,p=i.geometry.coordinates.map(_=>_.map(y=>e(y[1],y[0])));c.AddPaths(p.map(_=>_.map(y=>({X:y.x*wn,Y:y.y*wn}))),ka.JoinType.jsMiter,ka.EndType.etOpenRound);let d=new ka.PolyTree;c.Execute(d,r/2*wn);let m=[];for(let _ of d.m_AllPolys){let y=new Sd;if(_.IsHole())continue;l.min.x=Math.min(l.min.x,_.m_polygon[0].X),l.min.y=Math.min(l.min.y,_.m_polygon[0].Y),l.max.x=Math.max(l.max.x,_.m_polygon[0].X),l.max.y=Math.max(l.max.y,_.m_polygon[0].Y);let x=_.m_polygon;y.moveTo(x[0].X/wn,x[0].Y/wn),x.slice(1).forEach(w=>y.lineTo(w.X/wn,w.Y/wn)),y.lineTo(x[0].X/wn,x[0].Y/wn),y.holes=_.m_Childs.map(w=>{let b=new nd,C=w.m_polygon;return b.moveTo(C[0].X/wn,C[0].Y/wn),C.slice(1).forEach(E=>b.lineTo(E.X/wn,E.Y/wn)),b.lineTo(C[0].X/wn,C[0].Y/wn),b}),m.push(new Dg(y,u))}let g=Ed(m);return g.translate(0,0,s||0),g.userData={style:{color:a,opacity:o}},c.Clear(),g}h(Fie,"renderMultiLineStringGeometry");R();var P0,A0,Oie=class{constructor(e){ie(this,"mesh"),ie(this,"type","model"),ie(this,"outline"),ie(this,"geometry"),ie(this,"material"),ie(this,"feature"),ie(this,"instanceIndex",-1),ie(this,"visible",!0),ie(this,"color",new Rt),ie(this,"position",new le),fe(this,P0,0),fe(this,A0,1),this.feature=e}setOpacity(){}setColor(){}get altitude(){return M(this,P0)}set altitude(e){this.mesh&&(this.mesh.position.z=e,Re(this,P0,e))}get opacity(){return M(this,A0)}set opacity(e){var t,r;if(this.mesh){for(let n of this.mesh.children)if(n instanceof kY){((t=n.userData)==null?void 0:t.originalOpacity)===void 0&&(n.userData.originalOpacity=n.material.opacity);let a=Lh(e,0,(r=n.userData)==null?void 0:r.originalOpacity,0,1);n.material.opacity=a,n.material.transparent=a<1,n.material.needsUpdate=!0}}Re(this,A0,e)}};P0=new WeakMap,A0=new WeakMap,h(Oie,"ModelComponent");var I0=Oie;function Bie(i){let{color:e,opacity:t,topColor:r,texture:n,topTexture:a}=i;return`${e}${t}${r||""}${n||""}${a||""}`}h(Bie,"generateIndex");var I3e=1e4,zie=class extends Zr{constructor(t,r){super();Z(this,"state");Z(this,"convertTo3DMapPosition");Z(this,"loader");this.state=t,this.convertTo3DMapPosition=r}async getGLTFLoader(){if(this.loader)return;let{GLTFLoader:t}=await lg(()=>import("./GLTFLoader-EMLQBTUW-C3oGDI8X.js"),[]);this.loader=new t}createEntityFromFeature(t,r,n){let a=new Ko(r),o=new Xn(a,new px(n));return o.id=t,o}createModelFromFeature(t,r,n){let a=new I0(r),o=new Xn(a,new px(n));return o.id=t,o}populateEntityMesh(t,r){let n=t.components[0];n.geometry=r}async populateModelGroup(t,r,n){let a=new Gt,o=new Xa,s=new Th,l=new le,u=new V_;return this.loader||await this.getGLTFLoader(),this.loader.load(r,c=>{var p,d,m,g,_,y;c.scene.traverse(b=>{let C=b;if("isMesh"in C&&C.isMesh===!0){let E=new kY(C.geometry,C.material,t.size);E.userData={entities:{}},u.add(E),n.add(u)}});let x=0,w;for(let b of t.values()){w=this.state.entity3DMap.get(b);let C=w.components[0],E=w.components[0].feature;C.mesh=u,C.instanceIndex=x;let{x:T,y:L,z:D}=this.convertTo3DMapPosition(E.geometry.coordinates[1],E.geometry.coordinates[0],0);C.position.set(T,L,D),o.set(((p=E.properties.rotation)==null?void 0:p[0])||0,((d=E.properties.rotation)==null?void 0:d[1])||0,((m=E.properties.rotation)==null?void 0:m[2])||0),l.set(((g=E.properties.scale)==null?void 0:g[0])||1,((_=E.properties.scale)==null?void 0:_[1])||1,((y=E.properties.scale)==null?void 0:y[2])||1),s.setFromEuler(o),a.compose(C.position,s,l),u.children.forEach(B=>{let A=B;A.setMatrixAt(x,a),A.userData.entities[x]=w.id}),x++}this.publish("model-loaded")}),u}populateEntityGroup(t){let r,n,a,o;for(let s of t.values())o=this.state.entity3DMap.get(s),o.components[0]instanceof Ko&&(n=o.components[0].feature,a=o.components[1],n.geometry.type==="Polygon"?(r=Lie(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,r)):n.geometry.type==="MultiPolygon"?(r=Die(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,r)):n.geometry.type==="LineString"?(r=Rie(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,r)):n.geometry.type==="MultiLineString"&&(r=Fie(n,this.convertTo3DMapPosition,a),this.populateEntityMesh(o,r)));return t}optimize(t){if(t.visible&&(t instanceof Us||t instanceof xa)){for(let a of t.children)this.optimize(a);if(t instanceof xa||t.userData.dirty===!1)return;let r={};if(!t.userData.modelURL&&t.userData.dirty)try{this.populateEntityGroup(t.userData.entities3D)}catch(a){Bt.warn(a)}else t.userData.modelURL&&t.userData.dirty&&(this.populateModelGroup(t.userData.entities3D,t.userData.modelURL,t),t.userData.dirty=!1);let n=0;if(t.userData.dirty){let a=0,o;for(let s of t.userData.entities3D.values()){o=this.state.entity3DMap.get(s);let l=o.components[0],u=o.components[1];if(l instanceof Ko){a++,a>=I3e&&(a=0,n++);let c=Bie(u)+n;r[c]===void 0&&(r[c]={style:u,entities:[]}),r[c].entities.push(o)}else l.mesh&&l.mesh.parent!==t&&t.add(l.mesh)}for(let s in r){let l=Aie(r[s].entities,r[s].style);t.add(l),t.userData.outlineDirty=!0,t.userData.dirty=!1}}}}update(){this.optimize(this.state.entityScene)}};h(zie,"MeshCreationAndOptimizationSystem");var L3e=zie;R();var Nie=class{constructor(e,t){Z(this,"state");Z(this,"dirty",!0);Z(this,"domTree");this.state=e,this.domTree=t}update(){if(this.dirty){let e;for(let t of Array.from(this.domTree.children))if(e=this.state.entity2DMap.get(t.userData.entityId),e){let r=e.components[0];(!r.enabled||!r.visible||!this.state.entity2DIds.has(t.userData.entityId))&&this.domTree.removeChild(t)}else this.domTree.removeChild(t);for(let t of this.state.entity2DIds)if(e=this.state.entity2DMap.get(t),e){let r=e.components[0];r instanceof Op&&r.enabled&&r.containerEl&&!this.domTree.contains(r.containerEl)&&(r.containerEl.userData={entityId:e.id},this.domTree.appendChild(r.containerEl),r.updateDimensions())}this.dirty=!1}}};h(Nie,"DOMVisibilitySystem");var D3e=Nie;R();var $ie=class{constructor(e,t){Z(this,"state");Z(this,"project");this.state=e,this.project=t}update(){let e;for(let t of this.state.entity2DIds)e=this.state.entity2DMap.get(t),e&&this.project(e.components[0].projection,e.position)}};h($ie,"TwoDProjectionSystem");var k3e=$ie;R();R();var R3e=h(function(){let i,e;return t=>{if((!e||!e)&&(i=document.createElement("canvas"),i.width=500*t,i.height=500*t,i.style.width="500px",i.style.height="500px",e=i.getContext("2d")),!e)throw new Error("Could not get 2D context");return{measureCanvas:i,measureCanvasContext:e}}},"createMeasureCanvasContext")(),F3e=h(({text:i,size:e,maxWidth:t,pixelRatio:r,maxLines:n=2,lineHeight:a=1.2,options:o={strokeText:!0}})=>{let s=`bold ${e*r}px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif`,{measureCanvasContext:l}=R3e(r);l.font=s;let u=[],c=i.split(" "),p=0,d=0,m=0;for(;d<c.length;){let y=c[d];if(p===n&&p>0){u[p-1]+="...";break}if(u[p]==null&&(u[p]=y,d++),c.length===1){u[p]=y;break}if(c[d]==null)break;let{width:x}=l.measureText(u[p]+" "+c[d]);x<=t*r?(u[p]+=" "+c[d],d++):p++}u.forEach(y=>{let{width:x}=l.measureText(y);m=Math.max(x,m)});let g=e*r*a,_=u.length*g;return{maxWidth:m,maxHeight:_,lines:u.length,draw:(y,x,w)=>{u.length===1?(o.strokeText&&y.strokeText(u[0],x,w),y.fillText(u[0],x,w)):(o.strokeText&&(y.strokeText(u[0],x,w-g/2),y.strokeText(u[1],x,w+g/2)),y.fillText(u[0],x,w-g/2),y.fillText(u[1],x,w+g/2))}}},"shaveText"),O3e=4.5,B3e=2.5,z3e=2,N3e=5,tf=2.5,Uie=class{constructor(e,t){Z(this,"dirty",!1);Z(this,"state");Z(this,"colliderContext");Z(this,"colliderCanvas");Z(this,"pinCache",{});Z(this,"imagePromiseCache",{});Z(this,"imageDimensionsCache",{});Z(this,"textCache",{});Z(this,"update",(e,t,r)=>{let n=(e-t)/(r-t),a=this.state.pixelRatio;this.colliderContext.clearRect(0,0,this.colliderCanvas.width,this.colliderCanvas.height);let o,s,l,u,c,p;for(let d of this.state.entity2DIds)if(p=this.state.entity2DMap.get(d),p!=null&&p.components[0]instanceof Fp&&!p.disposed){if(c=p.components[0],s=c.appearance.marker.foregroundColor,l=c.appearance.marker.backgroundColor,u=c.markerSize,o=`${s.active}-${s.inactive}-${l.active}-${l.inactive}-${u}`,this.pinCache[o]||this.prepare(c,o,this.colliderContext),c.appearance.marker.icon&&!c.imageHash&&this.cacheImage(c),this.textCache[c.id]==null||c.dirty||this.dirty){c.dirty=!1,c.collisionDirty=!0,this.textCache[c.id]={};let{textDrawFn:m,width:g,height:_}=this.processText(c.text,c.appearance.text.size,c.appearance.text.maxWidth,c.appearance.text.numLines,c.appearance.text.lineHeight);["left","center","right"].forEach(x=>{this.textCache[c.id][x]=this.textToCanvas(m,c.appearance.text.size,x,g,_,c.appearance.text.foregroundColor,c.appearance.text.backgroundColor)}),c.dimensions={width:Math.ceil(g/a),height:Math.ceil(_/a)},c.currentStrategyIndex===-1&&(c.currentStrategyIndex=0);let y=c.strategies[c.currentStrategyIndex];if(y){y.onStrategySelected(c);let x=c.style;c.style=c.newStyle,c.newStyle=x}}c.visible&&c.enabled&&(c.zoomProportion=n,this.draw(c,o,this.colliderContext))}this.dirty=!1});Z(this,"processText",(e,t,r,n,a)=>{let o=this.state.pixelRatio,{draw:s,maxWidth:l,maxHeight:u}=F3e({text:e,size:t,pixelRatio:o,maxWidth:r,maxLines:n,lineHeight:a});return{textDrawFn:s,width:l+tf*o*2,height:u+tf*o*2}});Z(this,"textToCanvas",(e,t,r,n,a,o,s)=>{let l=this.state.pixelRatio,u,c=n,p=a;window.OffscreenCanvas!=null&&!qwe()?u=new OffscreenCanvas(c,p):(u=document.createElement("canvas"),u.width=c,u.height=p,u.style.width=c+"px",u.style.height=p+"px");let d=u.getContext("2d",{willReadFrequently:!0});if(!d)return;d.textAlign=r,d.font=`bold ${t*l}px 'InterUI-Regular', Helvetica Neue, Arial, sans-serif`,d.textBaseline="middle",d.lineJoin="miter",d.miterLimit=2,d.strokeStyle="white",d.lineWidth=tf*l,d.fillStyle=o,d.strokeStyle=s;let m=r==="left"?0:r==="center"?c/2:c-tf*l/2;return e(d,m,(p+tf*l/2)/2),u});Z(this,"cacheImage",e=>{if(!e.appearance.marker.icon)return;let t=_te(e.appearance.marker.icon);if(e.imageHash=t,!this.imagePromiseCache[t]){let r=["png","jpg","jpeg"],n=e.appearance.marker.icon.split("?")[0],a=r.some(s=>n.toLowerCase().endsWith(s)),o=new Image;a?o.src=e.appearance.marker.icon:o.src=`data:image/svg+xml;base64, ${btoa(e.appearance.marker.icon)}`,o.onload=()=>{this.imagePromiseCache[t]=o}}});Z(this,"createPinCanvas",(e,t,r,n)=>{let a,o=this.state.pixelRatio,s=e.totalMarkerSize*2*o;window.OffscreenCanvas!=null?a=new OffscreenCanvas(s,s):(a=document.createElement("canvas"),a.width=s,a.height=s,a.style.width=s/o+"px",a.style.height=s/o+"px");let l=a.getContext("2d");return l.shadowColor="rgba(0,0,0,0.3)",l.shadowOffsetY=z3e*o,l.shadowBlur=N3e*o,l.beginPath(),l.arc(s/2,s/2,t/2+B3e*o/2,0,2*Math.PI),l.fillStyle=r,l.fill(),l.beginPath(),l.arc(s/2,s/2,t/2,0,2*Math.PI),l.shadowColor="transparent",l.fillStyle=n,l.fill(),a});Z(this,"prepare",(e,t,r)=>{let n=this.state.pixelRatio;r.lineWidth=4*n;let a=this.createPinCanvas(e,e.markerSize,e.appearance.marker.backgroundColor.active,e.appearance.marker.foregroundColor.active),o=this.createPinCanvas(e,e.iconVisible?e.markerSize:O3e*n,e.appearance.marker.backgroundColor.inactive,e.appearance.marker.foregroundColor.inactive);this.pinCache[t]=[a,o]});this.state=e,this.colliderCanvas=t,this.colliderContext=t.getContext("2d")}draw(e,t,r){if(!e.visible)return;r.save(),r.globalAlpha=e.opacity;let n=this.state.pixelRatio,a=e.projection.x*n,o=e.projection.y*n,s=e.style.pinVisibility===1?this.pinCache[t][0]:this.pinCache[t][1];if(r.drawImage(s,a-e.totalMarkerSize*n,o-e.totalMarkerSize*n),e.appearance.marker.icon&&e.iconVisible&&e.imageHash&&e.appearance.marker.iconSize&&this.imagePromiseCache[e.imageHash]){let l=this.imagePromiseCache[e.imageHash],u=(e.appearance.marker.iconSize-e.appearance.marker.iconPadding)*n,{iconFit:c}=e.appearance.marker,p=u,d=u,m=`${e.imageHash}_${c}`;if(this.imageDimensionsCache[m])p=this.imageDimensionsCache[m].width,d=this.imageDimensionsCache[m].height;else{let g=l.width*n,_=l.height*n;if(c==="contain"){let y=Math.sqrt(g**2+_**2),x=u/y;p=g*x,d=_*x}if(c==="cover"){let y=u/g,x=u/_,w=Math.max(y,x);p=g*w,d=_*w}}r.save(),r.beginPath(),r.arc(a,o,u/2,0,2*Math.PI),r.closePath(),r.clip(),r.drawImage(l,a-p/2,o-d/2,p,d),r.restore()}e.style.textLabelVisible&&e.style.textAlign!=null&&e.style.left&&e.style.top&&r.drawImage(this.textCache[e.id][e.style.textAlign],a+e.style.left*n,o+e.style.top*n),r.restore()}};h(Uie,"TwoDDrawSystem");var $3e=Uie;R();R();var vC=class Xf{constructor(){Z(this,"loader");this.loader=new OT}static getInstance(){return Xf.instance||(Xf.instance=new Xf),Xf.instance}getLoader(){return this.loader}};h(vC,"TextureLoaderSingleton"),ie(vC,"instance");var U3e=vC,Vie=U3e.getInstance();function jie(i,e){let t=i.components[2],r=i.components[1];return t!=null&&t.hover?[r.hoverColor||e,r.hoverColor||e]:[r.color,r.topColor||r.color]}h(jie,"processColor");var L0,xC,Hie=class extends Zr{constructor(e){super(),fe(this,L0),ie(this,"state"),ie(this,"textureCache",new Map),this.state=e}setShading(e,t){e.material&&e.material.setGradientShading(t.start,t.end,t.intensity)}update(){var e,t,r;let n,a,o,s;for(let l of this.state.threeDEntities)if(s=this.state.entity3DMap.get(l),s instanceof Us&&s.type==="geometry-group"){if(s.userData.shadingDirty){a=s.components[0];let u=s.userData.entities3D.values().next().value,c=this.state.entity3DMap.get(u);c instanceof Xn&&(c.type==="geometry"||c.type==="custom-geometry")&&(n=c.components[0],s.userData.shadingDirty&&a.shading&&this.setShading(n,a.shading)),s.userData.shadingDirty=!1}}else if(s instanceof Xn&&(s.type==="geometry"||s.type==="custom-geometry")&&((e=s.components[1])!=null&&e.dirty||(t=s.components[2])!=null&&t.dirty)){n=s.components[0],a=s.components[1],o=s.components[2];let u=jie(s,this.state.hoverColor);n.setColor(u[0],u[1]),a.visible!==n.visible&&(n.visible=a.visible),a.altitude!==n.altitude&&(n.altitude=a.altitude),a.opacity!==n.opacity&&(n.opacity=a.opacity),a.dirty=!1,a.texture!==n.texture&&$t(this,L0,xC).call(this,a.texture,n,"texture"),a.topTexture!==n.topTexture&&$t(this,L0,xC).call(this,a.topTexture,n,"topTexture"),(n.texture||n.topTexture)&&(o!=null&&o.hover&&n.texturesVisible?n.hideTextures():n.texturesVisible||n.showTextures()),s.components[2]&&(s.components[2].dirty=!1)}else(s==null?void 0:s.type)==="model"&&(r=s.components[1])!=null&&r.dirty&&(n=s.components[0],a=s.components[1],a.opacity!==n.opacity&&(n.opacity=a.opacity),a.dirty=!1)}destroy(){this.textureCache.forEach(e=>{e.dispose()}),this.textureCache.clear()}};L0=new WeakSet,xC=h(function(i,e,t){if(!(!i||!e.showTextures)){if(this.textureCache.has(i)){t==="topTexture"?e.topTexture=this.textureCache.get(i):e.texture=this.textureCache.get(i),e.showTextures();return}Vie.getLoader().load(i,r=>{t==="topTexture"?e.topTexture=r:e.texture=r,this.textureCache.set(i,r),e.showTextures(),this.publish("texture-loaded")},void 0,()=>{Bt.error(`Failed to load texture: ${i}`)})}},"#loadTexture"),h(Hie,"DrawSystem");var V3e=Hie;R();var Gie=class extends Zr{constructor(t){super();Z(this,"state");Z(this,"animating",new Map);Z(this,"isAnimating",!1);Z(this,"startTime",-1);Z(this,"duration",500);Z(this,"update",()=>{this.animating.clear();let t,r;for(let n of this.state.entity2DIds)t=this.state.entity2DMap.get(n),t&&(r=t.components[0],r instanceof Fp&&r.visibilityNeedsUpdate&&(r.visible?this.animating.set(r,r.opacity):(r.opacity=0,r.visibilityNeedsUpdate=!1)));this.startTime=performance.now(),this.publish("animate:2d")});Z(this,"playAnimations");this.state=t,this.playAnimations=this._playAnimations}_playAnimations(){let t=performance.now();for(let[r,n]of this.animating.entries()){let a=(t-this.startTime)/this.duration;r.opacity=Lh(a,0,1,n,1),t-this.startTime>=this.duration&&(r.visible=!0,r.visibilityNeedsUpdate=!1,this.animating.delete(r))}this.publish("draw:2d"),this.animating.size>0&&this.publish("animate:2d")}};h(Gie,"TwoDVisibilitySystem");var j3e=Gie;R();var Wie=class extends Zr{constructor(t,r,n,a,o,s,l){super();Z(this,"state");Z(this,"renderer");Z(this,"mode");Z(this,"scene");Z(this,"cameraObject");Z(this,"viewCamera");Z(this,"systems");Z(this,"twoDdirty",!0);Z(this,"threeDdirty",!0);Z(this,"frameId",null);Z(this,"twoDFrameId",null);Z(this,"animationFrameId",null);Z(this,"nextFrame",null);Z(this,"update",(t=!1)=>{var r;if(((r=this.renderer)==null?void 0:r.renderer)!=null)if(t)this.commitRenderState(),this.paint();else{if(this.frameId)return;this.frameId=requestAnimationFrame(()=>{var n;((n=this.renderer)==null?void 0:n.renderer)!=null&&this.mode==="standalone"&&(this.commitRenderState(),this.paint())})}});Z(this,"animate2D",()=>{this.animationFrameId=requestAnimationFrame(()=>{this.animationFrameId=null,this.systems.twoDVisiblitySystem.playAnimations()})});Z(this,"drawEntities2D",()=>{this.twoDFrameId||(this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomAltitude(),this.systems.cameraSystem.getZoomScaledMin(),this.systems.cameraSystem.getZoomScaledMax())}))});Z(this,"updateEntities2D",()=>{this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),this.twoDFrameId=requestAnimationFrame(()=>{this.twoDFrameId=null,this.systems.watermarkSystem.insertIntoQuadTree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.interactionSystem.updateQuadtree(this.systems.collisionSystem.interactiveCollidersQTree),this.systems.twoDVisiblitySystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomAltitude(),this.systems.cameraSystem.getZoomScaledMin(),this.systems.cameraSystem.getZoomScaledMax()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting())})});Z(this,"commitRenderState",()=>{this.frameId=null,(this.mode==="outdoors-interleaved"||this.mode==="standalone")&&this.systems.cameraSystem.update(),this.scene.updateMatrixWorld(),this.state.shouldMeasureCanvas&&(this.state.shouldMeasureCanvas=!1,this.publish("measure-canvas")),this.twoDdirty&&(this.state.entity2DIds.clear(),yte(this.state.entityScene,this.state.entity2DIds),this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.dirty=!0,this.systems.domMutationSystem.dirty=!0,this.systems.panBoundsSystem.dirty=!0,this.twoDdirty=!1),this.threeDdirty&&(this.state.threeDEntities=[],gte(this.state.entityScene,this.state.threeDEntities),this.threeDdirty=!1,this.systems.interactionSystem.dirty3D=!0,this.systems.panBoundsSystem.dirty=!0,this.systems.outlineInterpolationSystem.geometries3DDirty=!0,this.systems.geometryInFocusSystem.focusablesDirty=!0),this.systems.meshOptimizationSystem.update(),this.systems.customGeometrySystem.update(),this.systems.panBoundsSystem.update(),this.systems.geometryInFocusSystem.update(),this.systems.stackSystem.update(),this.systems.drawSystem.update(),this.systems.outlineInterpolationSystem.update(this.systems.cameraSystem.getZoomLevel(),this.systems.cameraSystem.zoomDirty),this.systems.pathSystem.update(this.systems.cameraSystem.minZoomAltitude,this.systems.cameraSystem.maxZoomAltitude,this.systems.cameraSystem.getZoomAltitude()),this.systems.cameraSystem.postRender(),this.systems.domVisiblitySystem.update(),this.systems.domMutationSystem.update(),this.systems.twoDProjectionSystem.update(),this.systems.twoDDrawSystem.update(this.systems.cameraSystem.getZoomAltitude(),this.systems.cameraSystem.getZoomScaledMin(),this.systems.cameraSystem.getZoomScaledMax()),this.systems.domDrawSystem.update(this.systems.cameraSystem.isUserInteracting()),this.systems.watermarkSystem.update(),this.nextFrame=requestAnimationFrame(()=>{this.systems.collisionSystem.update(this.systems.watermarkSystem.width,this.systems.watermarkSystem.height)}),this.systems.cameraSystem.dirty=!1,this.systems.cameraSystem.zoomDirty=!1});this.renderer=t,this.state=r,this.mode=n,this.scene=a,this.cameraObject=o,this.viewCamera=s,this.systems=l,this.systems.collisionSystem.on("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.on("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.on("animate:2d",this.animate2D)}paint(){var t;(t=this.renderer)!=null&&t.renderer&&(this.mode==="standalone"?(this.renderer.clear(),this.renderer.render(this.scene,this.cameraObject)):this.renderer.render(this.scene,this.viewCamera))}destroy(){this.frameId&&cancelAnimationFrame(this.frameId),this.twoDFrameId&&cancelAnimationFrame(this.twoDFrameId),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.nextFrame&&cancelAnimationFrame(this.nextFrame),this.state.entity2DIds.clear(),this.state.threeDEntities=[],this.systems.domVisiblitySystem.dirty=!0,this.systems.collisionSystem.dirty=!0,this.update(),this.systems.collisionSystem.off("visibility-changed",this.updateEntities2D),this.systems.twoDVisiblitySystem.off("draw:2d",this.drawEntities2D),this.systems.twoDVisiblitySystem.off("animate:2d",this.animate2D)}};h(Wie,"RenderSystem");var H3e=Wie;R();var qf,D0,Xie=class{constructor(e,t){ie(this,"type","path"),ie(this,"mesh",new V_),ie(this,"material"),ie(this,"geometry"),ie(this,"outline"),ie(this,"feature"),ie(this,"options"),ie(this,"nearRadius",.2),ie(this,"farRadius",.4),ie(this,"color","#ff834c"),ie(this,"accentColor","blue"),fe(this,qf,1),ie(this,"altitudeAdjustment",1),ie(this,"displayArrowsOnPath",!1),ie(this,"animateArrowsOnPath",!1),ie(this,"dirty",!0),ie(this,"position",new le),fe(this,D0,0);var r,n,a,o,s,l;this.feature=e,this.options=t||{},this.color=(r=t==null?void 0:t.color)!=null?r:this.color,this.accentColor=(n=t==null?void 0:t.accentColor)!=null?n:this.accentColor,this.nearRadius=(a=t==null?void 0:t.nearRadius)!=null?a:this.nearRadius,this.farRadius=(o=t==null?void 0:t.farRadius)!=null?o:this.farRadius,this.displayArrowsOnPath=(s=t==null?void 0:t.displayArrowsOnPath)!=null?s:this.displayArrowsOnPath,this.animateArrowsOnPath=(l=t==null?void 0:t.animateArrowsOnPath)!=null?l:this.animateArrowsOnPath}setColor(){}setOpacity(){}set completeFraction(e){Re(this,qf,e),this.mesh&&this.mesh.children.forEach(t=>{t.material.uniforms.complete.value=M(this,qf),t.material.needsUpdate=!0})}get completeFraction(){return M(this,qf)}set visible(e){this.mesh&&(this.mesh.visible=e)}get visible(){return this.mesh?this.mesh.visible:!1}get altitude(){return M(this,D0)}set altitude(e){this.mesh&&(this.mesh.position.z=e,Re(this,D0,e))}set complete(e){this.material&&(this.material.uniforms.complete.value=e,this.material.needsUpdate=!0)}};qf=new WeakMap,D0=new WeakMap,h(Xie,"PathComponent");var G3e=Xie;R();var qie=class{constructor(e){Z(this,"rendererState");this.rendererState=e}update(){let e;for(let t of this.rendererState.threeDEntities)if(e=this.rendererState.entity3DMap.get(t),e instanceof xa&&e.components[0]){let r=e.components[0];if(r.dirty){for(let n of e.children)(n instanceof Us||n instanceof xa)&&(n.userData.entityId!==e.components[0].activeId?n.setVisible(!1):n.setVisible(!0));r.dirty=!1}}}};h(qie,"StackSystem");var W3e=qie;R();R();var ty=kt(Og());R();R();R();var X3e=h((i,e)=>(e-i+Math.PI)%(Math.PI*2)+Math.PI*2%(Math.PI*2)-Math.PI,"differenceBetweenAngles"),q3e=h((i,e)=>new Ne(i.clientX-e.offsetLeft,i.clientY-e.offsetTop),"getTouchPos"),G8=h((i,e)=>Math.atan2(e.y-i.y,e.x-i.x),"angle"),iy=h((i,e)=>Math.sqrt((e.y-i.y)**2+(e.x-i.x)**2),"distance"),W8=h((i,e)=>new Ne((i.x+e.x)/2,(i.y+e.y)/2),"average"),X8=h(i=>{let e=0,{wheelDelta:t,detail:r}=i;return t!==void 0?e=t:r!==void 0&&(e=-r),e},"getScrollDelta"),Zie=class{constructor(e,t){Z(this,"input1");Z(this,"input2");Z(this,"lastAngle");Z(this,"lastDistance");Z(this,"totalDistance");Z(this,"first");Z(this,"second");this.input1=e,this.input2=t,this.lastAngle=G8(e,t),this.lastDistance=iy(e,t),this.totalDistance=0,this.first=e,this.second=t}update(e,t){let r=iy(e,t);this.input1=e,this.input2=t;let n=G8(e,t);this.lastAngle=n,this.lastDistance=r,this.totalDistance+=(iy(this.first,e)+iy(this.second,t))/2,this.first=W8(this.first,e),this.second=W8(this.second,t)}};h(Zie,"InputSet");var Z3e=Zie;R();var Yie=class{constructor(e,t,r){Z(this,"touch");Z(this,"camera");Z(this,"cameraPlane");Z(this,"viewCoordinate");Z(this,"snapHolderMatrix");Z(this,"snapCamera");Z(this,"cameraPosition");Z(this,"raycaster");Z(this,"worldCoordinate");Z(this,"snapshotted",!1);this.touch=e,this.camera=t,this.cameraPlane=r,this.viewCoordinate={x:e.x,y:e.y},this.camera.updateMatrixWorld(),this.camera.updateMatrix(),this.snapHolderMatrix=this.camera.matrixWorld.clone(),this.snapCamera=this.camera.clone(),this.snapshotCameraState()}snapshotCameraState(){this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraPosition=this.camera.position.clone();let e=new Ne(this.viewCoordinate.x,this.viewCoordinate.y);this.raycaster=this.raycaster||new Fg,this.raycaster.setFromCamera(e,this.snapCamera);let t=this.raycaster.intersectObject(this.cameraPlane,!0);this.worldCoordinate=t&&t.length>0?t[0].point:null,this.snapshotted=!0}updateAnchorState(e,t){this.camera=e,this.snapCamera=e.clone(),this.snapHolderMatrix=e.matrixWorld.clone(),this.updateViewCoordinate(t),this.snapshotCameraState()}updateViewCoordinate(e){this.viewCoordinate={x:e.x,y:e.y}}reUnproject(){var e,t;let r=new Ne(this.viewCoordinate.x,this.viewCoordinate.y);(e=this.raycaster)==null||e.setFromCamera(r,this.snapCamera);let n=(t=this.raycaster)==null?void 0:t.intersectObject(this.cameraPlane,!0)[0];return n?n.point:void 0}};h(Yie,"TouchAnchor");var q8=Yie,Bc,_C,Jie=class extends Zr{constructor(e,t,r,n,a){super(),ie(this,"dirty",!1),ie(this,"zoomDirty",!1),ie(this,"zoomSpeed",5),ie(this,"rotateSpeed",100),ie(this,"enabled",!0),ie(this,"enableZoom",!0),ie(this,"enablePan",!0),ie(this,"enablePedestal",!1),ie(this,"maxPedestal",1/0),ie(this,"minPedestal",0),ie(this,"enableRotate",!0),ie(this,"minZoomAltitude",0),ie(this,"maxZoomAltitude",1/0),ie(this,"ignoreZoomLimits",!1),ie(this,"zoomFactor",1),ie(this,"panBounds",{min:new le(1/0,1/0),max:new le(-1/0,-1/0),center:new le(0,0,0),radius:1/0}),ie(this,"minTilt",0),ie(this,"maxTilt",1.2),ie(this,"MOUSE_BUTTONS",{ORBIT:V2.RIGHT,ZOOM:V2.MIDDLE,PAN:V2.LEFT}),ie(this,"camera"),ie(this,"scene"),ie(this,"renderer"),ie(this,"elevation"),ie(this,"orbit"),ie(this,"cameraPlane"),ie(this,"raycaster",new Fg),ie(this,"rendererState"),ie(this,"options"),ie(this,"state",-1),ie(this,"intersection"),ie(this,"viewState",null),ie(this,"tweens",new Set),ie(this,"clock",new D2e(!0)),ie(this,"coords",{mouse:new Ne,rotateStart:new Ne,rotateEnd:new Ne,rotateDelta:new Ne,panStart:new le,panCameraStart:new le,panEnd:new le,panDelta:new le,initialShiftPos:new Ne,initialPedestal:0,floorAnchor:new le}),ie(this,"touch",{origin:{offsetLeft:0,offsetTop:0},touches:[],anchor1:null,anchor2:null,inputs:null}),ie(this,"scrollTimer",null),ie(this,"lastWheelTime",0),ie(this,"resetZoom",!1),ie(this,"zoomStart"),ie(this,"pedestalScaleFactor",1),ie(this,"isUserZooming",!1),ie(this,"stayInsideBounds",!0),ie(this,"userInteracting",!1),ie(this,"raycastToFloor",o=>{this.raycaster.setFromCamera(o,this.camera);let s=this.raycaster.intersectObject(this.cameraPlane,!1)[0];return s?s.point:new le}),ie(this,"isUserInteracting",()=>this.userInteracting),ie(this,"getPosition",()=>new le(this.orbit.position.x,this.orbit.position.y,this.orbit.position.z)),ie(this,"getPedestal",()=>this.orbit.position.z),ie(this,"pan",(o,s)=>{isNaN(o)||isNaN(s)||(this.setPosition(this.orbit.position.x+o,this.orbit.position.y+s),this.publish("position-updated"))}),ie(this,"postRender",()=>{(this.state===2||this.state===6)&&(this.raycaster.setFromCamera(this.coords.mouse,this.camera),this.intersection=this.raycaster.intersectObject(this.cameraPlane,!1)[0],this.intersection&&(this.coords.panStart.set(this.intersection.point.x,this.intersection.point.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0))),this.state===3&&this.resetZoom&&(this.resetZoom=!1,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0)),this.state===7&&this.isAnimating()===!1&&(this.state=-1,this.publish("multi-end"))}),ie(this,"isAnimating",()=>ty.default.getAll().some(o=>o._mMapAnimation)),ie(this,"isCameraMoving",()=>this.state!==-1),ie(this,"setPosition",(o,s)=>{o===void 0||s===void 0||isNaN(o)||isNaN(s)||(this.state===-1&&this.publish("pan-start"),this.updateCameraPosition(o,s),this.publish("position-updated"),this.publish("change"),this.state===-1&&this.publish("pan-end"),this.dirty=!0)}),ie(this,"updateCameraPosition",(o,s)=>{let l=o-this.panBounds.center.x,u=s-this.panBounds.center.y,c=Math.sqrt(l*l+u*u);if(this.stayInsideBounds&&c>this.panBounds.radius){let p=Math.atan2(u,l),d={x:Math.cos(p)*this.panBounds.radius+this.panBounds.center.x,y:Math.sin(p)*this.panBounds.radius+this.panBounds.center.y};this.orbit.position.x=d.x,this.orbit.position.y=d.y}else this.orbit.position.x=o,this.orbit.position.y=s}),ie(this,"tilt",o=>{if(isNaN(o))return;this.state===-1&&this.publish("rotate-start");let s=this.stayInsideBounds?Math.max(Math.min(o+this.getTilt(),this.maxTilt),this.minTilt):o+this.getTilt();s!==this.elevation.rotation.x&&(this.elevation.rotation.x=s,this.publish("tilt-updated")),this.publish("change"),this.state===-1&&this.publish("rotate-end")}),ie(this,"zoomIn",(o,s,l)=>{let u=this.getZoomAltitude();this.animateCamera({zoom:u/1.5},o,s,l)}),ie(this,"zoomOut",(o,s,l)=>{let u=this.getZoomAltitude();this.animateCamera({zoom:u*1.5},o,s,l)}),ie(this,"getRotation",()=>this.orbit.rotation.z),ie(this,"cancelAnimation",()=>{let o=Array.from(this.tweens),s=o[o.length-1];s.state===7&&this.publish("multi-cancel",{zooming:!0,rotating:!0,tilting:!0}),this.completeTween(s)}),ie(this,"animateCamera",(o,s,l,u,c,p)=>{let d={mode:R8.cancel,...p},m={},g={},_=this.getPosition();if(o.position!=null&&(o.position.x!==void 0&&(m.x=_.x,g.x=o.position.x),o.position.y!==void 0&&(m.y=_.y,g.y=o.position.y),o.position.z!==void 0&&(m.z=_.z,g.z=o.position.z)),o.zoom!==void 0&&(m.zoom=this.stayInsideBounds?Math.min(Math.max(this.getZoomAltitude(),this.getZoomScaledMin()),this.getZoomScaledMax()):this.getZoomAltitude(),this.viewState==="multi_floor"||!this.stayInsideBounds?g.zoom=o.zoom:g.zoom=Math.min(Math.max(o.zoom,this.getZoomScaledMin()),this.getZoomScaledMax())),o.rotation!==void 0){let L=m.rotation=this.getRotation(),D=o.rotation%(2*Math.PI),B=D-L;if(Math.abs(B)>Math.PI){let A=B<0?1:-1;g.rotation=D+2*Math.PI*A}else g.rotation=D}o.tilt!==void 0&&(m.tilt=this.getTilt(),this.viewState==="multi_floor"||!this.stayInsideBounds?g.tilt=o.tilt:g.tilt=Math.max(Math.min(o.tilt,this.maxTilt),this.minTilt));let y=m.zoom!==g.zoom,x=m.rotation!==g.rotation,w=m.tilt!==g.tilt,b=new ty.default.Tween(m).to(g,dr.env.TESTING?0:s).onUpdate(L=>{this.setMulti({x:L.x,y:L.y,z:L.z},L.zoom,L.rotation,L.tilt)}).onComplete(()=>{this.completeTween(b),this.publish("multi-end",{zooming:y,rotating:x,tilting:w}),u&&u()}).onStart(()=>{this.state!==7&&(this.state=7,b.state=7,this.publish("multi-start",{zooming:y,rotating:x,tilting:w})),this.publish("change")}),C=Array.from(this.tweens),E=C[C.length-1],T=!1;return E!=null&&(d.mode===R8.chain?(T=!0,E.chain(b)):(this.completeTween(E),typeof c=="function"&&c(),E=null)),this.tweens.add(b),l?b.easing(l):b.easing(ty.default.Easing.Quadratic.In),!o.doNotAutoStart&&!T&&(b.start(),this.publish("change")),b._mMapAnimation=!0,b}),ie(this,"setMulti",(o,s,l,u,c=!0)=>{this.state===-1&&this.publish("multi-start");let p=!1;o!=null&&(o.x!==void 0&&!isNaN(o.x)&&o.y!==void 0&&!isNaN(o.y)&&(this.updateCameraPosition(o.x,o.y),p=!0),o.z!==void 0&&!isNaN(o.z)&&(this.setPedestal(o.z,!0),p=!0)),p&&this.publish("position-updated");let d={zooming:!1,tilting:!!s,rotating:!1};if(s!==void 0&&!isNaN(s)){let m=this.stayInsideBounds?Math.min(Math.max(s,this.getZoomScaledMin()),this.getZoomScaledMax()):s;m!==this.camera.position.z&&(d.zooming=!0,this.camera.position.z=m,this.publish("zoom-updated"),this.zoomDirty=!0,this.viewState==="multi_floor"?s>Db&&(this.camera.near=s-Db,this.camera.far=s+Db):(this.camera.near=s/Q1,this.camera.far=s*Q1),this.camera.updateProjectionMatrix())}if(l!==void 0&&!isNaN(l)&&l!==this.orbit.rotation.z&&(d.rotating=!0,this.orbit.rotation.z=l,this.publish("rotation-updated")),u!==void 0&&!isNaN(u)){let m=this.stayInsideBounds?Math.max(Math.min(u,this.maxTilt),this.minTilt):u;m!==this.elevation.rotation.x&&(d.tilting=!0,this.elevation.rotation.x=m,this.publish("tilt-updated"))}c&&this.publish("change"),this.state===-1&&this.publish("multi-end",d)}),ie(this,"getZoomScaledMin",()=>this.minZoomAltitude*this.zoomFactor),ie(this,"getZoomScaledMax",()=>{let o=this.minZoomAltitude*this.zoomFactor;return Math.max(this.maxZoomAltitude,o)}),ie(this,"setRotation",(o,s)=>{if(isNaN(o))return;this.state===-1&&!s&&this.publish("rotate-start");let l=o%F8;l!==this.orbit.rotation.z&&(this.orbit.rotation.z=l,s||this.publish("rotation-updated")),s||this.publish("change"),this.state===-1&&!s&&this.publish("rotate-end"),this.dirty=!0}),ie(this,"setZoomAltitude",o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let s=this.stayInsideBounds?Math.min(Math.max(o,this.getZoomScaledMin()),this.getZoomScaledMax()):o;s!==this.camera.position.z&&(this.camera.position.z=s,this.publish("zoom-updated"),this.zoomDirty=!0),this.camera.near=s/Q1,this.camera.far=s*Q1,this.camera.updateProjectionMatrix(),this.publish("change"),this.state===-1&&this.publish("zoom-end"),this.dirty=!0}),ie(this,"setZoomLevel",o=>{this.setZoomAltitude(this.convertZoomLevelToAltitude(o))}),ie(this,"getZoomAltitude",()=>this.camera.position.z),ie(this,"getZoomLevel",()=>this.convertAltitudeToZoomLevel(this.getZoomAltitude())),ie(this,"rotate",o=>{if(isNaN(o))return;this.state===-1&&this.publish("rotate-start");let s=(this.orbit.rotation.z+o)%F8;s!==this.orbit.rotation.z&&(this.orbit.rotation.z=s,this.publish("rotation-updated")),this.publish("change"),this.state===-1&&this.publish("rotate-end")}),ie(this,"setTilt",(o,s)=>{if(isNaN(o))return;this.state===-1&&!s&&this.publish("rotate-start");let l=this.stayInsideBounds?Math.max(Math.min(o,this.maxTilt),this.minTilt):o;l!==this.elevation.rotation.x&&(this.elevation.rotation.x=l,s||this.publish("tilt-updated")),s||this.publish("change"),this.state===-1&&!s&&this.publish("rotate-end"),this.dirty=!0}),ie(this,"getTilt",()=>this.elevation.rotation.x),ie(this,"setCameraPlaneElevation",o=>{this.cameraPlane.position.z=o}),ie(this,"zoom",o=>{if(isNaN(o))return;this.state===-1&&this.publish("zoom-start");let s=this.getZoomAltitude()-o;this.camera.position.z=this.stayInsideBounds?Math.min(Math.max(s,this.minZoomAltitude*this.zoomFactor),this.maxZoomAltitude*this.zoomFactor):s,this.publish("zoom-updated"),this.zoomDirty=!0,this.publish("change"),this.state===-1&&this.publish("zoom-end")}),ie(this,"getProjectionScaleFactor",(o,s,l)=>YM(o,s,l)),ie(this,"update",()=>{ty.default.update(),this.lastWheelTime>0&&this.state===3&&this.clock.getElapsedTime()-this.lastWheelTime>.2&&(this.lastWheelTime=0,this.state=-1,this.publish("zoom-end"),this.removeMouseMoveEventListeners())}),ie(this,"setPedestal",(o,s=!1)=>{typeof o=="number"&&!isNaN(o)&&(this.orbit.position.z=o,s&&(this.publishPedestalChangeEvent(o),this.publish("change")),this.dirty=!0)}),ie(this,"dispose",()=>{for(let o of z8)o.endsWith("start")?this.off(o,this.setUserInteracting):o.endsWith("end")&&this.off(o,this.unsetUserInteracting);this.removeEventListeners(),this.scene.remove(this.cameraPlane)}),ie(this,"createCameraPlane",()=>{let o=new Ag(1e10,1e10),s=new wd({color:0,visible:!1}),l=new Zi(o,s);return this.scene.add(l),l}),ie(this,"addEventListeners",()=>{let{domElement:o}=this.renderer;for(let s of z8)s.endsWith("start")?this.on(s,this.setUserInteracting):s.endsWith("end")&&this.on(s,this.unsetUserInteracting);o.addEventListener("contextmenu",this.onContextMenu,!1),o.addEventListener("mousedown",this.onMouseDown,!1),o.addEventListener("wheel",this.onMouseWheel,{passive:!1}),o.addEventListener("touchstart",this.onTouchStart,!1),o.addEventListener("touchend",this.onTouchEnd,!1),o.addEventListener("touchmove",this.onTouchMove,!1)}),ie(this,"addMouseEventListeners",()=>{this.addMouseMoveEventListeners(),window.addEventListener("mouseup",this.onMouseUp,!1),window.addEventListener("mouseout",this.onMouseUp,!1)}),ie(this,"addMouseMoveEventListeners",()=>{this.renderer.domElement.addEventListener("mousemove",this.onMouseMove,!1)}),ie(this,"removeMouseMoveEventListeners",()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1)}),ie(this,"removeEventListeners",()=>{let{domElement:o}=this.renderer;o.removeEventListener("contextmenu",this.onContextMenu,!1),o.removeEventListener("mousedown",this.onMouseDown,!1),o.removeEventListener("wheel",this.onMouseWheel,!1),o.removeEventListener("touchstart",this.onTouchStart,!1),o.removeEventListener("touchend",this.onTouchEnd,!1),o.removeEventListener("touchmove",this.onTouchMove,!1),o.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)}),ie(this,"removeMouseUpEventListeners",()=>{this.renderer.domElement.removeEventListener("mousemove",this.onMouseMove,!1),window.removeEventListener("mouseup",this.onMouseUp,!1),window.removeEventListener("mouseout",this.onMouseUp,!1)}),ie(this,"onContextMenu",o=>{o.preventDefault()}),ie(this,"onMouseUp",()=>{if(this.enabled!==!1){switch(this.removeMouseUpEventListeners(),this.state){case 2:this.publish("pan-end"),this.publish("user-pan-end");break;case 1:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}this.state=-1}}),ie(this,"onMouseMove",o=>{if(this.enabled!==!1)if(o.preventDefault(),this.mouseToScene(o),this.state===0){if(this.enableRotate===!1)return;this.handleMouseMoveRotate(o)}else if(this.state===2){if(this.enablePan===!1)return;this.handleMouseMovePan()}else this.state===3?(this.resetZoom=!0,this.state=-1):this.state===8&&this.handleMouseMovePedestal(o)}),ie(this,"onTouchStart",o=>{if(this.enabled!==!1){switch(this.updateTouchOrigin(),this.touchToScene(o),o.touches.length){case 1:this.enablePedestal?(this.handleTouchStartPedestal(o),this.state=9):this.enablePan&&(this.handleTouchStartPan(o),this.state=6);break;case 2:this.touch.inputs=new Z3e(this.touch.touches[0],this.touch.touches[1]);break;default:this.state=-1}this.state}}),ie(this,"onTouchMove",o=>{if(this.enabled!==!1)switch(this.touchToScene(o),o.touches.length){case 2:o.preventDefault(),o.stopPropagation();let s={...this.touch.inputs.first},l={...this.touch.inputs.second},u=new Ne(this.touch.touches[0].x,this.touch.touches[0].y),c=new Ne(this.touch.touches[1].x,this.touch.touches[1].y);if(this.touch.inputs.update(this.touch.touches[0],this.touch.touches[1]),this.enableRotate&&this.state===4)this.handleTouchMoveTilt(o);else if(this.state===5)this.handleTouchMoveDolly();else if(this.state!==5&&this.touch.inputs.totalDistance>.05){let p=s.y<u.y&&l.y<c.y,d=s.y>u.y&&l.y>c.y;this.enableRotate&&this.state!==4&&(d||p)?(this.handleTouchStartTilt(o),this.state=4):(this.handleTouchStartDolly(),this.state=5)}break;case 1:(this.enablePedestal||this.enablePan)&&(o.preventDefault(),o.stopPropagation()),this.enablePedestal&&this.state===9?this.handleTouchMovePedestal(o):this.enablePan&&this.state===6&&this.handleTouchMovePan(o);break;default:this.state=-1}}),ie(this,"onTouchEnd",o=>{if(this.enabled!==!1){switch(this.handleTouchEnd(),this.state){case 2:case 6:this.publish("user-pan-end");break;case 4:this.publish("pan-end"),this.publish("user-tilt-end");break;case 1:case 5:this.publish("zoom-end"),this.publish("user-dolly-end");break;case 0:this.publish("rotate-end"),this.publish("user-rotate-end");break;case 8:case 9:this.publish("pedestal-end"),this.publish("user-pedestal-end");break}o.touches.length?this.onTouchStart(o):this.state=-1}}),ie(this,"handleTouchMovePan",o=>{let s=Object.hasOwn(o,"x")?new Ne(o.x,o.y):this.touch.touches[0],l=this.raycastToFloor(s);this.coords.panEnd.set(l.x,l.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change")}),ie(this,"handleTouchStartDolly",()=>{let o=this.touch.touches[0].x-this.touch.touches[1].x,s=this.touch.touches[0].y-this.touch.touches[1].y;this.zoomStart=this.getZoomAltitude();let l=new Ne(this.touch.touches[0].x-o/2,this.touch.touches[0].y-s/2);this.coords.floorAnchor=this.raycastToFloor(l),this.orbit.updateMatrixWorld(),this.touch.anchor1=new q8(this.touch.touches[0],this.camera,this.cameraPlane),this.touch.anchor2=new q8(this.touch.touches[1],this.camera,this.cameraPlane),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-dolly-start"),this.publish("multi-start")}),ie(this,"handleMouseMovePan",()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panEnd.set(o.x,o.y,0),this.coords.panDelta.subVectors(this.coords.panEnd,this.coords.panStart),this.setPosition(this.coords.panCameraStart.x-this.coords.panDelta.x,this.coords.panCameraStart.y-this.coords.panDelta.y),this.publish("change")}),ie(this,"handleTouchStartTilt",o=>{this.coords.rotateStart.set(o.touches[1].clientX,o.touches[1].clientY),this.publish("user-tilt-start"),this.publish("rotate-start")}),ie(this,"handleTouchMovePedestal",o=>{this.handleMouseMovePedestal(o.touches[0])}),ie(this,"handleTouchMoveTilt",o=>{this.coords.rotateEnd.set(o.touches[1].clientX,o.touches[1].clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd)}),ie(this,"handleTouchMoveDolly",()=>{let o=this.touch.inputs.first,s=this.touch.inputs.second;this.touch.anchor1.viewCoordinate={x:o.x,y:o.y},this.touch.anchor2.viewCoordinate={x:s.x,y:s.y};let l=this.makeTransformFromTouchAnchors(this.touch.anchor1,this.touch.anchor2);l&&this.setCameraFromTransformMatrix(l),this.orbit.updateMatrixWorld(),this.touch.anchor1.updateAnchorState(this.camera,o),this.touch.anchor2.updateAnchorState(this.camera,s)}),ie(this,"handleTouchEnd",()=>{this.state===4||this.state===5?this.publish("multi-end"):this.state===6&&this.publish("pan-end")}),ie(this,"handleTouchStartPan",o=>{let s=Object.hasOwn(o,"x")?new Ne(o.x,o.y):this.touch.touches[0],l=this.raycastToFloor(s);this.coords.panStart.set(l.x,l.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("user-pan-start"),this.publish("pan-start")}),ie(this,"handleTouchStartPedestal",o=>{this.handleMouseDownPedestal(o.touches[0])}),ie(this,"onMouseDown",o=>{if(this.enabled!==!1){if(this.mouseToScene(o),o.preventDefault(),this.state===3&&this.publish("zoom-end"),o.button===this.MOUSE_BUTTONS.ORBIT){if(this.enableRotate===!1)return;this.handleMouseDownRotate(o),this.state=0}else o.button===this.MOUSE_BUTTONS.PAN&&(this.enablePan?(this.handleMouseDownPan(),this.state=2):this.enablePedestal&&(this.handleMouseDownPedestal(o),this.state=8));this.state!==-1&&this.addMouseEventListeners()}}),ie(this,"onMouseWheel",o=>{this.enabled===!1||this.enableZoom===!1||this.state!==-1&&this.state!==3||(o.preventDefault(),o.stopPropagation(),this.mouseToScene(o),this.canScrollZoom(o)&&(this.lastWheelTime=this.clock.getElapsedTime(),this.publishUserZoomEvent()),this.state!==3&&this.canScrollZoom(o)&&(this.addMouseMoveEventListeners(),this.state=3,this.zoomStart=this.getZoomAltitude(),this.coords.floorAnchor=this.raycastToFloor(this.coords.mouse),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("zoom-start")),this.scrollTimer!=null&&clearTimeout(this.scrollTimer),this.scrollTimer=setTimeout(()=>{this.publish("zoom-end")},50),this.handleMouseWheel(o))}),ie(this,"handleMouseWheel",o=>{if(this.publish("zoom-start"),!this.canScrollZoom(o)){this.lastWheelTime>0&&this.publish("zoom-end"),this.lastWheelTime=0,this.state=-1;return}let s=this.getZoomAltitude(),l=s-X8(o)*s/Gwe*this.zoomSpeed;this.setZoomAltitude(l);let u=l/this.zoomStart;this.coords.panDelta.subVectors(this.coords.floorAnchor,this.coords.panCameraStart).multiplyScalar(1-u),this.setPosition(this.coords.panCameraStart.x+this.coords.panDelta.x,this.coords.panCameraStart.y+this.coords.panDelta.y),this.publish("change")}),ie(this,"setCameraFromTransformMatrix",o=>{this.orbit.updateMatrixWorld();let s=new Xa;s.setFromRotationMatrix(o,"ZYX");let l=(o.elements[14]-this.cameraPlane.position.z)/Math.cos(s.x),u=s.z,c=new le(0,0,1);c.applyEuler(s),c.setLength(l);let p=new le;p.setFromMatrixPosition(o),p.sub(c),this.enablePan&&this.setPosition(p.x,p.y),this.enableZoom&&this.setZoomAltitude(l),this.enableRotate&&this.setRotation(u)}),ie(this,"makeTransformFromTouchAnchors",(o,s)=>{this.orbit.updateMatrixWorld(),this.camera.updateProjectionMatrix();let l=this.camera.projectionMatrix.clone(),u=o.worldCoordinate,c=s.worldCoordinate,p=o.reUnproject(),d=s.reUnproject();if(!p||!d||!u||!c)return null;let m=o.viewCoordinate,g=s.viewCoordinate,_=c.x-u.x,y=c.y-u.y,x=Math.atan2(y,_),w=d.x-p.x,b=d.y-p.y,C=Math.atan2(b,w),E=X3e(x,C),T=new Gt;T.makeRotationZ(-E);let L=T.clone();L.multiply(o.snapHolderMatrix);let D=h((Dt,ue,he)=>Dt.elements[(ue-1)*4+he-1],"m"),B=D(l,1,1)*D(L,1,1)-m.x*D(l,3,4)*D(L,3,1),A=D(l,1,1)*D(L,1,2)-m.x*D(l,3,4)*D(L,3,2),k=D(l,1,1)*D(L,1,3)-m.x*D(l,3,4)*D(L,3,3),$=u.x*B+u.y*A+u.z*k,z=D(l,2,2)*D(L,2,1)-m.y*D(l,3,4)*D(L,3,1),P=D(l,2,2)*D(L,2,2)-m.y*D(l,3,4)*D(L,3,2),U=D(l,2,2)*D(L,2,3)-m.y*D(l,3,4)*D(L,3,3),G=u.x*z+u.y*P+u.z*U,K=D(l,1,1)*D(L,1,1)-g.x*D(l,3,4)*D(L,3,1),O=D(l,1,1)*D(L,1,2)-g.x*D(l,3,4)*D(L,3,2),V=D(l,1,1)*D(L,1,3)-g.x*D(l,3,4)*D(L,3,3),j=c.x*K+c.y*O+c.z*V,q=D(l,2,2)*D(L,2,1)-g.y*D(l,3,4)*D(L,3,1),ee=D(l,2,2)*D(L,2,2)-g.y*D(l,3,4)*D(L,3,2),ae=D(l,2,2)*D(L,2,3)-g.y*D(l,3,4)*D(L,3,3),N=c.x*q+c.y*ee+c.z*ae,J=Math.abs(K-B),Y=Math.abs(O-A),oe=Math.abs(V-k),xe=Math.abs(K-z),ge=Math.abs(O-P),Te=Math.abs(V-U),me=Math.abs(q-B),Q=Math.abs(ee-A),Me=Math.abs(ae-k),ve=Math.abs(q-z),Ie=Math.abs(ee-P),ke=Math.abs(ae-U),we=Math.min(J+Y+oe,xe+ge+Te),Oe=Math.min(me+Q+Me,ve+Ie+ke);we<Oe&&(K=q,O=ee,V=ae,j=N);let Je=z*k-B*U,xt=P*k-A*U,ne=G*k-$*U,W=K*U-z*V,_e=O*U-P*V,Fe=j*U-G*V,Ue=(Fe*xt-ne*_e)/(W*xt-Je*_e),Be=(Fe*Je-ne*W)/(_e*Je-xt*W),bt=P*B-A*z,lt=U*B-k*z,Ge=G*B-$*z,We=O*z-P*K,St=V*z-U*K,Ze=((j*z-G*K)*bt-Ge*We)/(St*bt-lt*We),ni=L.clone();return ni.elements[12]=Ue,ni.elements[13]=Be,ni.elements[14]=Ze,Ze>0?ni:null}),ie(this,"updateTouchOrigin",()=>{let o=this.renderer.domElement;this.touch.origin.offsetLeft=o.getBoundingClientRect().left,this.touch.origin.offsetTop=o.getBoundingClientRect().top}),ie(this,"touchToScene",o=>{this.touch.touches=[];for(let s=0,l=o.touches.length;s<l;s++){let u=o.touches[s],c=q3e(u,this.touch.origin);this.touch.touches.push(new Ne(c.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,-(c.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1))}this.coords.mouse=this.touch.touches[0]}),ie(this,"canScrollZoom",o=>{let s=X8(o),l=this.getZoomAltitude();return!(s<0&&l===this.getZoomScaledMax()||s>0&&l===this.getZoomScaledMin())}),ie(this,"mouseToScene",o=>{let s=this.getMousePos(o);return this.coords.mouse.x=s.x/this.renderer.domElement.width*this.rendererState.pixelRatio*2-1,this.coords.mouse.y=-(s.y/this.renderer.domElement.height*this.rendererState.pixelRatio)*2+1,this.coords.mouse}),ie(this,"getMousePos",o=>({x:o.offsetX,y:o.offsetY})),ie(this,"handleMouseDownRotate",o=>{this.coords.rotateStart.set(o.clientX,o.clientY),this.publish("rotate-start"),this.publish("user-rotate-start")}),ie(this,"handleMouseDownPan",()=>{let o=this.raycastToFloor(this.coords.mouse);this.coords.panStart.set(o.x,o.y,0),this.coords.panCameraStart.set(this.orbit.position.x,this.orbit.position.y,0),this.publish("pan-start"),this.publish("user-pan-start")}),ie(this,"handleMouseDownPedestal",o=>{let s=new Ne(o.clientX,o.clientY);this.coords.initialShiftPos=s,this.coords.initialPedestal=this.getPedestal(),this.pedestalScaleFactor=YM(this.camera.fov,this.renderer.domElement.clientHeight,this.getZoomAltitude()),this.publish("pedestal-start"),this.publish("user-pedestal-start")}),ie(this,"handleMouseMovePedestal",o=>{let s={x:o.clientX,y:o.clientY},l=this.coords.initialPedestal+this.pedestalScaleFactor*(s.y-this.coords.initialShiftPos.y);this.stayInsideBounds&&(l<this.minPedestal?l=Math.max(l,this.minPedestal):l>this.maxPedestal&&(l=Math.min(l,this.maxPedestal))),l!==this.getPedestal()&&this.setPedestal(l,!0)}),ie(this,"handleMouseMoveRotate",o=>{this.coords.rotateEnd.set(o.clientX,o.clientY),this.coords.rotateDelta.subVectors(this.coords.rotateEnd,this.coords.rotateStart),this.rotate(-this.coords.rotateDelta.x/this.rotateSpeed),this.setTilt(this.getTilt()-this.coords.rotateDelta.y/this.rotateSpeed),this.coords.rotateStart.copy(this.coords.rotateEnd),this.publish("change")}),ie(this,"publishUserZoomDebounced",Rp(()=>{this.isUserZooming=!1,this.publish("user-zoom-end")},250)),ie(this,"publishUserZoomEvent",()=>{this.isUserZooming?this.publishUserZoomDebounced():(this.publish("user-zoom-start"),this.isUserZooming=!0,this.publishUserZoomDebounced())}),ie(this,"setUserInteracting",()=>{this.userInteracting=!0}),ie(this,"unsetUserInteracting",()=>{this.userInteracting=!1}),ie(this,"publishPedestalChangeEvent",o=>{this.publish("pedestal-change",{pedestal:o,scrolledToTop:this.scrolledToTop,scrolledToBottom:this.scrolledToBottom,scrollPercent:this.scrollPercent})}),ie(this,"convertAltitudeToZoomLevel",o=>{let[,s]=this.center,l=o*2*Math.tan(Oi.degToRad(this.camera.fov)/2)/this.options.canvasHeight,u=Math.cos(Oi.degToRad(s))*2*Math.PI*hd/l;return Oi.clamp(Math.log2(u/512),O8,B8)}),ie(this,"convertZoomLevelToAltitude",o=>{let[,s]=this.center,l=Oi.clamp(o,O8,B8),u=Math.pow(2,l),c=Oi.clamp(s,jwe,Hwe),p=u*512;return Math.cos(Oi.degToRad(c))*Math.PI*2*hd/p*this.options.canvasHeight/2/Math.tan(Oi.degToRad(this.camera.fov)/2)}),ie(this,"completeTween",o=>{o.isPlaying?o.stop():o.end(),this.tweens.delete(o)}),fe(this,Bc,{PIXELS:"pixels",PORTIONS:"portions"}),fe(this,_C,["top","bottom","left","right"]),ie(this,"getCameraFrameForPoints",(o,s,l,u,{canvasWidth:c,canvasHeight:p},d=this.minZoomAltitude,m=this.maxZoomAltitude)=>{Number.isFinite(l)&&(l=1),Number.isFinite(s)&&(s=1),d=Math.max(this.cameraPlane.position.z,d);let g={position:this.getPosition(),zoom:d};if(o==null||o.length===0)return g;u||(u={top:0,bottom:0,left:0,right:0,type:M(this,Bc).PIXELS});for(let we of M(this,_C))typeof u[we]!="number"&&(u[we]=0);if(u.type||(u.type=M(this,Bc).PIXELS),u.type===M(this,Bc).PORTIONS&&(u={top:u.top*p,bottom:u.bottom*p,left:u.left*c,right:u.right*c,type:M(this,Bc).PIXELS}),u.left+u.right>=c||u.top+u.bottom>=p)return g;this.orbit.updateMatrixWorld();let _=this.camera.matrixWorldInverse,y=this.camera.fov*(Math.PI/180)/2,x=y*l,w=Math.atan(Math.tan(y)*(c/p))*s;if(o.length===1){let we=o[0].clone();we.applyMatrix4(_);let Oe=d*Math.tan(w)*2,Je=d*Math.tan(x)*2,xt=(u.left-u.right)/2/c,ne=(u.top-u.bottom)/2/p,W=new le(-xt*Oe,ne*Je,0);return we.add(W),we.applyMatrix4(this.camera.matrixWorld),g.position.x=we.x,g.position.y=we.y,g.position.z=we.z,g.zoom=Math.max(g.zoom,g.position.z),g}let b=new le(1/0,1/0,1/0),C=new le(-1/0,-1/0,-1/0),E=new tn().setFromPoints(o),T;for(let we=0,Oe=o.length;we<Oe;we++)T=o[we].clone(),T.applyMatrix4(_),b.min(T),C.max(T);let L=C.x-b.x,D=C.y-b.y,B=c-u.left-u.right,A=p-u.top-u.bottom,k=(C.x+b.x)/2,$=(C.y+b.y)/2,z=L/B,P=D/A,U=d,G=m,K=U*Math.tan(w)*2,O=G*Math.tan(w)*2,V=K/c,j=O/c,q=Math.max(z,P);q=Oi.clamp(q,V,j);let ee=B*q,ae=A*q,N={min:{x:k-ee/2-u.left*q,y:$-ae/2-u.bottom*q},max:{x:k+ee/2+u.right*q,y:$+ae/2+u.top*q}},J=(N.min.x+N.max.x)/2,Y=(N.min.y+N.max.y)/2,oe=E.getCenter(new le),xe=Math.abs(J-N.min.x),ge=Math.abs(Y-N.min.y),Te=xe/Math.tan(w),me=ge/Math.tan(x),Q=new le;Q.set(J,Y,C.z+Math.max(Te,me)),Q.applyMatrix4(this.camera.matrixWorld);let Me=new le;Me.set(J,Y,C.z),Me.applyMatrix4(this.camera.matrixWorld);let ve=new le().subVectors(Me,Q),Ie=(oe.z-Q.z)/ve.z,ke=new le().copy(Q).add(ve.clone().multiplyScalar(Ie));return g.position=ke,Me.set(g.position.x,g.position.y,g.position.z),Q.sub(Me),g.zoom=Q.length(),g}),this.camera=e,this.renderer=r,this.rendererState=n,this.scene=t,this.options=a,this.elevation=e.parent,this.orbit=this.elevation.parent,this.cameraPlane=this.createCameraPlane(),this.zoomStart=e.position.z,a.mode!=="outdoors-overlay"&&this.addEventListeners()}get maxZoomLevel(){return this.convertAltitudeToZoomLevel(this.minZoomAltitude)}setMaxZoomLevel(e){this.minZoomAltitude=this.convertZoomLevelToAltitude(e)}get minZoomLevel(){return this.convertAltitudeToZoomLevel(this.maxZoomAltitude)}setMinZoomLevel(e){this.maxZoomAltitude=this.convertZoomLevelToAltitude(e)}get scrollPercent(){let e=this.minPedestal,t=this.maxPedestal,r=this.getPedestal();return r=Math.min(r,t),r=Math.max(r,e),(r-e)/(t-e)*100}get scrolledToBottom(){return this.minPedestal===0||Math.floor(this.getPedestal())<=this.minPedestal}get scrolledToTop(){return this.maxPedestal===0||Math.ceil(this.getPedestal())>=this.maxPedestal}get center(){var e,t,r,n;let a=this.getPosition(),{lat:o,lon:s}=tP((t=(e=this.rendererState.center)==null?void 0:e[1])!=null?t:0,(n=(r=this.rendererState.center)==null?void 0:r[0])!=null?n:0,a.x,a.y);return[s,o]}setCenter(e,t){var r,n,a,o;let{x:s,y:l}=iP((n=(r=this.rendererState.center)==null?void 0:r[1])!=null?n:0,(o=(a=this.rendererState.center)==null?void 0:a[0])!=null?o:0,t,e);this.setPosition(s,l)}focusOn(e,{insetsPadding:t},r={}){let n=r.curve,a=1,o=1,s=r.callback,l=r.cancelledCallback,u=r.minZoom!==void 0?r.minZoom:this.minZoomAltitude,c=r.maxZoom!==void 0?r.maxZoom:this.maxZoomAltitude,p=this.options.canvasWidth,d=this.options.canvasHeight,m;if(r.duration!==void 0?m=r.duration:dr.env.TESTING==="true"?m=0:m=200,t.top!==0||t.bottom!==0||t.left!==0||t.right!==0)if(r.tilt!==void 0&&r.tilt!==this.getTilt()||r.rotation!==void 0&&r.rotation!==this.getRotation())this.animateCamera({position:this.getPosition(),tilt:r.tilt,rotation:r.rotation},m,n,()=>{let g=r.padding||t,_=this.getCameraFrameForPoints(e,a,o,g,{canvasWidth:p,canvasHeight:d},u,c);this.animateCamera({position:_.position,tilt:this.getTilt(),rotation:this.getRotation(),zoom:_.zoom},m,n,s,l)});else{let g=r.padding||t,_=this.getCameraFrameForPoints(e,a,o,g,{canvasWidth:p,canvasHeight:d},u,c);this.animateCamera({position:_.position,tilt:this.getTilt(),rotation:this.getRotation(),zoom:_.zoom},m,n,s,l)}else{let g=r.padding||t,_=this.getCameraFrameForPoints(e,a,o,g,{canvasHeight:d,canvasWidth:p},u,c);this.animateCamera({position:_.position,tilt:r.tilt,rotation:r.rotation,zoom:_.zoom},m,n,s,l)}}resize(e,t){this.options.canvasWidth=e,this.options.canvasHeight=t}};Bc=new WeakMap,_C=new WeakMap,h(Jie,"CameraSystem");var Y3e=Jie;R();var J3e=300,Kie=class{constructor(e){Z(this,"state");this.state=e}update(e){var t;let r,n,a;for(let o of this.state.entity2DIds)r=this.state.entity2DMap.get(o),r&&(n=r.components[0],a=r.components[1],n instanceof Op&&n.containerEl!=null&&((n.visible===!0||((t=n.animation)==null?void 0:t.pending)===!0)&&(n.containerEl.style.transform=`translate3D(${n.projection.x}px, ${n.projection.y}px, ${n.projection.y}px)`),n.visible===!0?n.containerEl.style.pointerEvents=e||a!=null?"none":"auto":n.containerEl.style.pointerEvents="none",n.visibilityNeedsUpdate&&(n.animation&&n.animation.cancel(),n.animation=n.containerEl.animate([{opacity:n.visible?"1":"0"}],{duration:J3e,easing:"ease-in-out",fill:"forwards"}),n.visibilityNeedsUpdate=!1)))}};h(Kie,"DOMDrawSystem");var K3e=Kie;R();var Qie=class{constructor(){Z(this,"percentExpanded",0);Z(this,"activeId","");Z(this,"gap",20);Z(this,"dirty",!0)}};h(Qie,"StackComponent");var Q3e=Qie;R();var ere=class extends Zr{constructor(t,r){super();Z(this,"state");Z(this,"dirty",!0);Z(this,"domTree");Z(this,"observers",new Map);Z(this,"updateDimensions",t=>{t.forEach(r=>{let n=r.target,a=n.getAttribute("data-marker-id");if(a){let o=this.state.entity2DMap.get(a);if(o&&o.components[0]instanceof Op&&n.firstElementChild){let{width:s,height:l}=n.firstElementChild.getBoundingClientRect();o.components[0].updateDimensions(s,l)}}}),this.publish("dimensions-update")});this.state=t,this.domTree=r}setupObserver(){var t;if(this.observers){for(let n of this.observers.values())n.disconnect();this.observers.clear()}let r;for(let n of this.domTree.children){let a=n.getAttribute("data-marker-id");if(a!=null&&(r=this.state.entity2DMap.get(a),(t=r.components[0].options)!=null&&t.dynamicResize)){let o=new ResizeObserver(this.updateDimensions);o.observe(n),this.observers.set(n.userData.entityId,o)}}}update(){this.dirty&&(this.setupObserver(),this.dirty=!1)}destroy(){for(let t of this.observers.values())t.disconnect();this.observers.clear()}};h(ere,"DOMResizeSystem");var eSe=ere;R();var ry=kt(Og()),tSe=0,iSe=22,rSe=0,nSe=90;function dl(i,e,t,r){return(i<e||i>t)&&Bt.warn(r),Math.min(t,Math.max(e,i))}h(dl,"clampWithWarning");var Z8={linear:ry.default.Easing.Linear.None,"ease-in":ry.default.Easing.Quadratic.In,"ease-out":ry.default.Easing.Quadratic.Out,"ease-in-out":ry.default.Easing.Quadratic.InOut},Mt,fi,zc,k0,tre=class{constructor(e,t,r,n){fe(this,Mt,void 0),fe(this,fi,void 0),fe(this,zc,void 0),fe(this,k0,void 0),Re(this,Mt,e),Re(this,fi,t),Re(this,zc,r),Re(this,k0,n),M(this,fi).cameraSystem.on("pedestal-change",({pedestal:a})=>{M(this,Mt).map&&(M(this,Mt).map.transform.elevation=a,M(this,Mt).map.transform.minElevationForCurrentTile=a,M(this,Mt).map.triggerRepaint()),M(this,fi).cameraSystem.setCameraPlaneElevation(a),M(this,k0).position.z=a})}get center(){return M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map?M(this,Mt).map.getCenter().toArray():M(this,fi).cameraSystem.center}setCenter(e){var t;if(M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map){(t=M(this,Mt).map)==null||t.setCenter(e),M(this,fi).interactionSystem.handleHover();return}M(this,fi).cameraSystem.setCenter(e[0],e[1]),M(this,fi).interactionSystem.handleHover()}get zoomLevel(){var e;return M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map?(e=M(this,Mt).map)==null?void 0:e.getZoom():M(this,fi).cameraSystem.getZoomLevel()}setZoomLevel(e){var t;M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map&&((t=M(this,Mt).map)==null||t.setZoom(e)),M(this,fi).cameraSystem.setZoomLevel(dl(e,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits."))}get maxZoomLevel(){return M(this,fi).cameraSystem.maxZoomLevel}get minZoomLevel(){return M(this,fi).cameraSystem.minZoomLevel}setMinZoomLevel(e){var t;let r=Math.max(tSe,e);M(this,fi).cameraSystem.setMinZoomLevel(r),this.zoomLevel<r&&this.setZoomLevel(r),(t=M(this,Mt).map)==null||t.setMinZoom(r)}setMaxZoomLevel(e){var t;let r=Math.min(iSe,e);M(this,fi).cameraSystem.setMaxZoomLevel(r),this.zoomLevel>r&&this.setZoomLevel(r),(t=M(this,Mt).map)==null||t.setMaxZoom(r)}get maxPitch(){var e;return M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map?(e=M(this,Mt).map)==null?void 0:e.getMaxPitch():Oi.radToDeg(M(this,fi).cameraSystem.maxTilt)}get minPitch(){var e;return M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map?(e=M(this,Mt).map)==null?void 0:e.getMinPitch():Oi.radToDeg(M(this,fi).cameraSystem.minTilt)}setMinPitch(e){var t;let r=Math.max(rSe,e);(t=M(this,Mt).map)==null||t.setMinPitch(r),M(this,fi).cameraSystem.minTilt=Oi.degToRad(r)}setMaxPitch(e){var t;let r=Math.min(nSe,e);(t=M(this,Mt).map)==null||t.setMaxPitch(r),M(this,fi).cameraSystem.maxTilt=Oi.degToRad(r)}get bearing(){var e;return M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map?(e=M(this,Mt).map)==null?void 0:e.getBearing():Oi.radToDeg(M(this,fi).cameraSystem.getRotation())}setBearing(e){var t;if(M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map){(t=M(this,Mt).map)==null||t.setBearing(e);return}M(this,fi).cameraSystem.setRotation(Oi.degToRad(e))}get pitch(){var e;return M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map?(e=M(this,Mt).map)==null?void 0:e.getPitch():Oi.radToDeg(M(this,fi).cameraSystem.getTilt())}setPitch(e){var t;if(M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map){(t=M(this,Mt).map)==null||t.setPitch(e);return}M(this,fi).cameraSystem.setTilt(Oi.degToRad(dl(e,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")))}get elevation(){return M(this,fi).cameraSystem.getPedestal()}setElevation(e){M(this,fi).cameraSystem.setPedestal(e,!0)}get insetsPadding(){return M(this,zc).insetsPadding}setInsetPadding(e){M(this,zc).center&&(M(this,zc).insetsPadding=e?{...e}:Eie)}animateTo(e){var t;if(M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map)return(t=M(this,Mt).map)==null||t.flyTo({center:e.center,zoom:e.zoomLevel,bearing:e.bearing,pitch:e.pitch,duration:e.duration}),Promise.resolve();let r=e.center?M(this,Mt).convertTo3DMapPosition(e.center[1],e.center[0],0):void 0,n=e.zoomLevel!==void 0?M(this,fi).cameraSystem.convertZoomLevelToAltitude(dl(e.zoomLevel,this.minZoomLevel,this.maxZoomLevel,"zoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() and mapView.Camera.setMaxZoomLevel() to adjust limits.")):void 0,a=e.bearing!==void 0?Oi.degToRad(e.bearing):void 0,o=e.pitch!==void 0?Oi.degToRad(dl(e.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0;return new Promise(s=>{M(this,fi).cameraSystem.animateCamera({position:r,zoom:n,rotation:a,tilt:o},e.duration||0,Z8[e.easing||"ease-in-out"],()=>{M(this,fi).interactionSystem.handleHover(),s()},s)})}focusOn(e,t){var r,n;return M(this,Mt).mode==="outdoors-overlay"&&M(this,Mt).map?(e.length===1?(r=M(this,Mt).map)==null||r.flyTo({center:e[0],duration:(t==null?void 0:t.duration)||M(this,Mt).map.getBearing(),animate:!0,bearing:(t==null?void 0:t.bearing)||M(this,Mt).map.getBearing(),pitch:(t==null?void 0:t.pitch)||M(this,Mt).map.getPitch(),zoom:(t==null?void 0:t.maxZoomLevel)||M(this,Mt).map.getMaxZoom()}):(n=M(this,Mt).map)==null||n.fitBounds(e,{duration:t==null?void 0:t.duration,animate:!0,bearing:(t==null?void 0:t.bearing)||M(this,Mt).map.getBearing(),pitch:(t==null?void 0:t.pitch)||M(this,Mt).map.getPitch(),zoom:(t==null?void 0:t.maxZoomLevel)||M(this,Mt).map.getMaxZoom()}),M(this,fi).interactionSystem.handleHover(),Promise.resolve()):new Promise(a=>{M(this,fi).cameraSystem.focusOn(e.map(o=>M(this,Mt).convertTo3DMapPosition(o[1],o[0],o[2]||0)),{insetsPadding:(t==null?void 0:t.padding)||this.insetsPadding},{minZoom:(t==null?void 0:t.maxZoomLevel)===void 0?void 0:M(this,fi).cameraSystem.convertZoomLevelToAltitude(dl(t.maxZoomLevel,this.minZoomLevel,this.maxZoomLevel,"maxZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMaxZoomLevel() to adjust limits.")),maxZoom:(t==null?void 0:t.minZoomLevel)===void 0?void 0:M(this,fi).cameraSystem.convertZoomLevelToAltitude(dl(t.minZoomLevel,this.minZoomLevel,this.maxZoomLevel,"minZoomLevel was clamped to minZoomLevel/maxZoomLevel bounds. Use mapView.Camera.setMinZoomLevel() to adjust limits.")),padding:(t==null?void 0:t.padding)||{top:0,left:0,bottom:0,right:0},curve:Z8[(t==null?void 0:t.easing)||"ease-in-out"],rotation:t!=null&&t.bearing?Oi.degToRad(t.bearing):void 0,tilt:(t==null?void 0:t.pitch)!==void 0?Oi.degToRad(dl(t.pitch,this.minPitch,this.maxPitch,"pitch was clamped to minPitch/maxPitch bounds. Use mapView.Camera.setMinPitch() and mapView.Camera.setMaxPitch() to adjust limits.")):void 0,duration:t==null?void 0:t.duration,callback:()=>{M(this,fi).interactionSystem.handleHover(),a()},cancelledCallback:a})})}};Mt=new WeakMap,fi=new WeakMap,zc=new WeakMap,k0=new WeakMap,h(tre,"Camera");var aSe=tre;R();function bC(i){i&&(i.map&&(i.map.dispose(),i.map=void 0),i.dispose())}h(bC,"scrubMaterial");function fo(i){for(let e=i.children.length-1;e>=0;e--)fo(i.children[e]);"geometry"in i&&i.geometry&&i.geometry.dispose(),i.parent&&i.parent.remove(i),"material"in i&&Array.isArray(i.material)?i.material.forEach(function(e){bC(e)}):"material"in i&&typeof i.material<"u"&&bC(i.material)}h(fo,"destroyObject3D");R();var oSe=`uniform vec4 uSize;
varying vec2 vUv;
void main() {
  vUv = uv;
  // Scale the position by the size of the quad
  // and shift to top left corner for 0,0
	vec2 transformed = position.xy * uSize.xy - vec2(1.0, -1.0);
  // Apply width .x and height .y of image
  transformed += vec2(uSize.x, -uSize.y);
  // Apply left .w and top .z offset
  transformed += vec2(uSize.w, -uSize.z) * 2.0;
  gl_Position = vec4(transformed, 1.0, 1.0);
}`,sSe=`varying vec2 vUv;
uniform sampler2D uTexture;
uniform float uOpacity;
void main() {
  #ifndef debug
  vec4 texture = texture2D(uTexture, vUv);
  gl_FragColor = vec4(texture.rgb, texture.a * uOpacity);
  #else
  gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
  #endif
}`;R();var lSe=4.291666666666667,uSe=15,hSe=25,cSe=43/60;R();var Y8=["horizontal","icon"],pSe=new Map([[Y8[0],`<svg viewBox="0 0 206 48">
      <path d="M27.2678 14.2261H22.3187C21.0695 14.2261 20.4695 14.7801 20.4695 15.9852V31.142L10.3966 15.5591C9.69665 14.4784 9.2475 14.2773 7.8475 14.2261H2.97462C1.67462 14.2261 1.07631 14.7801 1.07631 15.9852V44.7665C1.07631 45.9716 1.67462 46.5256 2.97462 46.5256H7.92377C9.22207 46.5256 9.82207 45.9716 9.82207 44.7665V29.6847L19.9441 45.1926C20.695 46.3244 21.095 46.5256 22.4933 46.5256H27.2933C28.5916 46.5256 29.1916 45.9716 29.1916 44.7665V15.9852C29.1407 14.7801 28.5424 14.2261 27.2678 14.2261Z"/>
      <path d="M5.44915 10.9602C8.45863 10.9602 10.8983 8.50669 10.8983 5.48011C10.8983 2.45353 8.45863 0 5.44915 0C2.43967 0 0 2.45353 0 5.48011C0 8.50669 2.43967 10.9602 5.44915 10.9602Z"/>
      <path d="M61.7899 25.0449C63.2306 23.1903 65.078 22.2051 67.556 22.2051C72.0526 22.2051 74.7611 25.3347 74.7611 29.4511V39.2489C74.8187 39.7125 74.5306 39.9443 74.0695 39.9443H72.5136C72.0526 39.9443 71.7645 39.7125 71.8221 39.2489V29.5091C71.8221 27.1909 69.9187 25.2187 67.4984 25.2187C65.1339 25.2187 63.2323 27.1329 63.2323 29.2773V39.2489C63.2899 39.7125 63.0018 39.9443 62.5407 39.9443H60.9831C60.5221 39.9443 60.2916 39.7125 60.2916 39.2489V29.4511C60.2916 27.1329 58.3899 25.2187 56.0255 25.2187C53.7204 25.2187 51.7594 27.075 51.7594 29.2773V39.3068C51.817 39.7705 51.5289 40.0023 51.0102 40.0023H49.5119C49.0509 40.0023 48.7628 39.7705 48.7628 39.3068V23.25C48.7051 22.7864 48.9933 22.4966 49.5119 22.4966H50.9526C51.356 22.4966 51.5289 22.6704 51.5289 23.0182V24.2352C52.7407 22.9602 54.239 22.2648 56.0255 22.2648C58.4475 22.2068 60.3492 23.192 61.7899 25.0466V25.0449ZM77.1255 31.2477C77.1255 26.3216 81.1018 22.2051 86.1187 22.2051C88.539 22.2051 90.6136 23.1903 92.3441 25.1608V23.1903C92.3441 22.7267 92.5746 22.5528 93.0357 22.5528H94.4187C94.8797 22.5528 95.1102 22.7847 95.1102 23.3062V39.3648C95.1102 39.8284 94.8797 40.0602 94.4187 40.0602H93.0357C92.5746 40.0602 92.3441 39.8284 92.3441 39.4227V37.4523C90.6712 39.3648 88.5967 40.35 86.1746 40.35C81.1018 40.2341 77.1238 36.1773 77.1238 31.2477H77.1255ZM92.1136 31.2477C92.1136 27.8284 89.4611 25.2187 86.0594 25.2187C82.7746 25.2187 80.1221 27.8864 80.1221 31.2477C80.1221 34.6687 82.7746 37.2784 86.1187 37.2784C86.9062 37.2789 87.6861 37.1232 88.4138 36.8202C89.1414 36.5173 89.8026 36.0731 90.3593 35.513C90.9161 34.9528 91.3577 34.2878 91.6587 33.556C91.9597 32.8241 92.1143 32.0397 92.1136 31.2477ZM100.992 37.3943V46.3807C101.049 46.8443 100.761 47.1341 100.298 47.1341H98.7424C98.2814 47.1341 97.9933 46.9023 97.9933 46.3807V23.1903C97.9933 22.7267 98.2238 22.4369 98.7424 22.4369H100.183C100.646 22.379 100.934 22.6687 100.934 23.0744V24.9869C102.605 23.0744 104.68 22.1472 107.044 22.1472C112.002 22.1472 116.037 26.2619 116.037 31.1898C116.037 36.1176 112.059 40.2341 107.044 40.2341C104.622 40.2341 102.603 39.3068 100.992 37.3943ZM106.987 25.2187C103.7 25.2187 101.049 27.8864 101.049 31.2477C101.049 34.6687 103.7 37.2784 107.044 37.2784C110.446 37.2784 113.039 34.6108 113.039 31.2477C113.039 27.8864 110.388 25.2187 106.987 25.2187ZM121.11 37.3943V46.3807C121.168 46.8443 120.88 47.1341 120.419 47.1341H118.861C118.4 47.1341 118.112 46.9023 118.112 46.3807V23.1903C118.112 22.7267 118.342 22.4369 118.861 22.4369H120.302C120.764 22.379 121.053 22.6687 121.053 23.0744V24.9869C122.724 23.0744 124.798 22.1472 127.163 22.1472C132.12 22.1472 136.156 26.2619 136.156 31.1898C136.156 36.1176 132.178 40.2341 127.163 40.2341C124.742 40.2341 122.781 39.3068 121.11 37.3943ZM127.105 25.2187C123.819 25.2187 121.168 27.8864 121.168 31.2477C121.168 34.6687 123.819 37.2784 127.163 37.2784C130.564 37.2784 133.158 34.6108 133.158 31.2477C133.158 27.8864 130.507 25.2187 127.107 25.2187H127.105ZM153.97 32.3506H141.054C141.342 35.2483 143.995 37.4523 147.164 37.4523C148.893 37.4523 150.393 37.0466 151.719 36.0597C152.007 35.8858 152.295 35.7699 152.353 35.7699C152.583 35.7699 152.756 35.8858 152.929 36.1773L153.505 37.1625C153.622 37.3364 153.68 37.4523 153.68 37.5682C153.68 37.8 153.507 38.0318 153.103 38.3216C151.258 39.5966 149.183 40.292 146.992 40.292C141.688 40.292 137.883 36.3511 137.883 31.2477C137.883 26.204 141.803 22.2051 146.703 22.2051C151.546 22.2051 154.717 25.7983 154.717 31.0176C154.717 31.5972 154.717 32.3506 153.968 32.3506H153.97ZM141.056 30.0324H151.72C151.432 26.8432 149.473 24.929 146.648 24.929C145.241 24.8904 143.875 25.3995 142.833 26.3501C141.791 27.3007 141.154 28.6194 141.056 30.0307V30.0324ZM156.332 31.2477C156.332 26.3216 160.31 22.2051 165.326 22.2051C167.748 22.2051 169.707 23.1324 171.32 25.0449V16.2324C171.263 15.7687 171.551 15.479 172.012 15.479H173.57C174.031 15.479 174.319 15.7108 174.319 16.2324V39.3068C174.319 39.7705 174.088 40.0023 173.57 40.0023H172.129C171.666 40.0602 171.378 39.7705 171.378 39.3648V37.3943C169.649 39.3068 167.632 40.292 165.268 40.292C160.31 40.2341 156.332 36.1773 156.332 31.2477ZM171.264 31.2477C171.264 27.8284 168.612 25.2187 165.21 25.2187C161.924 25.2187 159.273 27.8864 159.273 31.2477C159.273 34.6687 161.924 37.2784 165.268 37.2784C166.057 37.2838 166.839 37.1316 167.569 36.8304C168.299 36.5292 168.962 36.0852 169.52 35.5241C170.077 34.963 170.519 34.296 170.818 33.5619C171.117 32.8277 171.268 32.0411 171.263 31.2477H171.264ZM177.72 19.0739C177.715 18.8594 177.754 18.646 177.833 18.4468C177.912 18.2476 178.031 18.0667 178.182 17.915C178.333 17.7633 178.512 17.6439 178.71 17.5642C178.909 17.4845 179.121 17.446 179.334 17.4511C179.546 17.4507 179.756 17.4923 179.952 17.5737C180.148 17.6551 180.326 17.7746 180.476 17.9254C180.626 18.0762 180.745 18.2553 180.826 18.4523C180.907 18.6494 180.948 18.8606 180.948 19.0739C180.953 19.2884 180.914 19.5017 180.835 19.7009C180.756 19.9001 180.637 20.081 180.486 20.2327C180.335 20.3845 180.156 20.5038 179.957 20.5835C179.759 20.6633 179.547 20.7017 179.334 20.6966C178.412 20.7545 177.72 20.0591 177.72 19.0739ZM177.836 39.2489V23.1903C177.836 22.7267 178.066 22.4369 178.527 22.4369H180.083C180.544 22.4369 180.832 22.6687 180.775 23.1903V39.2489C180.832 39.7125 180.544 39.9443 180.083 39.9443H178.527C178.066 39.9443 177.836 39.7125 177.836 39.2489ZM186.944 23.0165V24.1756C188.212 22.8426 189.71 22.2051 191.497 22.2051C195.937 22.2051 198.646 25.2767 198.646 29.3932V39.2489C198.703 39.7125 198.415 39.9443 197.954 39.9443H196.398C195.936 39.9443 195.705 39.7125 195.705 39.2489V29.4511C195.705 27.1329 193.803 25.2187 191.439 25.2187C189.134 25.2187 187.175 27.075 187.175 29.2773V39.3068C187.232 39.7705 186.944 40.0023 186.424 40.0023H184.868C184.407 40.0023 184.119 39.7705 184.119 39.3068V23.1903C184.061 22.7267 184.349 22.4949 184.868 22.4949H186.309C186.712 22.4949 186.944 22.6687 186.944 23.0165Z"/>
      <path d="M204 40C205.115 40 206 39.0857 206 38V37.9886C206 36.9029 205.126 36 204 36C202.885 36 202 36.9143 202 38V38.0114C202 39.0971 202.874 40 204 40ZM204 39.7829C202.989 39.7829 202.23 38.9829 202.23 38.0114V38C202.23 37.0286 203 36.2171 204 36.2171C205.011 36.2171 205.77 37.0171 205.77 37.9886V38C205.77 38.9714 205 39.7829 204 39.7829ZM203.218 38.9714H203.609V38.2743H204.034L204.517 38.9714H204.989L204.448 38.2057C204.724 38.1257 204.92 37.92 204.92 37.5886C204.92 37.1657 204.586 36.9486 204.138 36.9486H203.218V38.9714ZM203.609 37.9543V37.2914H204.103C204.368 37.2914 204.517 37.4057 204.517 37.6229C204.517 37.8171 204.368 37.9543 204.103 37.9543H203.609Z"/>
    </svg>`],[Y8[1],`<svg viewBox="0 0 43 60">
      <path d="M14.0291 7.06645C14.0291 10.9691 10.8885 14.1329 7.01453 14.1329C3.14051 14.1329 0 10.9691 0 7.06645C0 3.16376 3.14051 0 7.01453 0C10.8885 0 14.0291 3.16376 14.0291 7.06645Z"/>
      <path d="M28.7335 18.3468H35.1045C36.7455 18.3468 37.5178 19.0599 37.5821 20.6158V57.7309C37.5821 59.2868 36.8099 60 35.1367 60H28.9588C27.1569 60 26.642 59.7406 25.6767 58.282L12.6452 38.282V57.7309C12.6452 59.2868 11.8729 60 10.1997 60H3.82873C2.15554 60 1.3833 59.2868 1.3833 57.7309V20.6158C1.3833 19.0599 2.15554 18.3468 3.82873 18.3468H10.1032C11.9051 18.4116 12.4843 18.671 13.3852 20.0648L26.3524 40.162V20.6158C26.3524 19.0599 27.1247 18.3468 28.7335 18.3468Z"/>
      <path d="M41.5 60C42.3362 60 43 59.3143 43 58.5V58.4914C43 57.6771 42.3448 57 41.5 57C40.6638 57 40 57.6857 40 58.5V58.5086C40 59.3229 40.6552 60 41.5 60ZM41.5 59.8371C40.7414 59.8371 40.1724 59.2371 40.1724 58.5086V58.5C40.1724 57.7714 40.75 57.1629 41.5 57.1629C42.2586 57.1629 42.8276 57.7629 42.8276 58.4914V58.5C42.8276 59.2286 42.25 59.8371 41.5 59.8371ZM40.9138 59.2286H41.2069V58.7057H41.5259L41.8879 59.2286H42.2414L41.8362 58.6543C42.0431 58.5943 42.1897 58.44 42.1897 58.1914C42.1897 57.8743 41.9397 57.7114 41.6034 57.7114H40.9138V59.2286ZM41.2069 58.4657V57.9686H41.5776C41.7759 57.9686 41.8879 58.0543 41.8879 58.2171C41.8879 58.3629 41.7759 58.4657 41.5776 58.4657H41.2069Z"/>
    </svg>`]]),dSe=/<svg([^>]*)>/g;function ire(i,e,t,r){let n=pSe.get(i);return n?n.replace(dSe,`<svg$1 width="${t}" height="${r}" xmlns="http://www.w3.org/2000/svg" style="fill: ${e};">`):""}h(ire,"getLogoIcon");var J8=!1,rc={padding:16,scale:1,iconOnly:!1,position:"bottom-left",color:"dark",onClick:()=>{window!=null&&window.open("https://www.mappedin.com")}},un,Zf,R0,lo,Cn,Nc,zo,_s,uo,No,rre=class extends Zr{constructor(e,t,r,n,a){var o,s,l,u,c,p;super(),fe(this,un,void 0),fe(this,Zf,void 0),fe(this,R0,void 0),fe(this,lo,void 0),fe(this,Cn,void 0),fe(this,Nc,void 0),fe(this,zo,0),fe(this,_s,0),fe(this,uo,0),fe(this,No,0),ie(this,"dirty",!0),ie(this,"getPositionAlignedCanvasCoordinates",(d,m)=>({"top-left":{x:0,y:0},"top-right":{x:d,y:0},"bottom-left":{x:0,y:m},"bottom-right":{x:d,y:m},center:{x:d/2,y:m/2},top:{x:d/2,y:0},bottom:{x:d/2,y:m},left:{x:0,y:m/2},right:{x:d,y:m/2}})[M(this,un).position]),ie(this,"getPositionAlignedPadding",()=>{var d,m,g,_;let y=M(this,un).padding;if(typeof y=="number")return{"top-left":{x:y,y},"top-right":{x:-y,y},"bottom-left":{x:y,y:-y},"bottom-right":{x:-y,y:-y},center:{x:0,y:0},top:{x:0,y},bottom:{x:0,y:-y},left:{x:y,y:0},right:{x:-y,y:0}}[M(this,un).position];let x={top:(d=y.top)!=null?d:0,right:(m=y.right)!=null?m:0,bottom:(g=y.bottom)!=null?g:0,left:(_=y.left)!=null?_:0};return{x:x.left-x.right,y:x.top-x.bottom}}),Re(this,un,{position:(o=a==null?void 0:a.position)!=null?o:rc.position,padding:(s=a==null?void 0:a.padding)!=null?s:rc.padding,scale:(l=a==null?void 0:a.scale)!=null?l:rc.scale,iconOnly:(u=a==null?void 0:a.iconOnly)!=null?u:rc.iconOnly,color:(c=a==null?void 0:a.color)!=null?c:rc.color,onClick:(p=a==null?void 0:a.onClick)!=null?p:rc.onClick}),Re(this,R0,e),Re(this,Zf,n),Re(this,uo,t),Re(this,No,r)}get color(){return M(this,un).color==="light"?"white":"#293136"}get iconName(){return M(this,un).iconOnly?"icon":"horizontal"}get minWidth(){return M(this,un).iconOnly?uSe:75}get defaultWidth(){return M(this,un).iconOnly?hSe:150}get aspectRatio(){return M(this,un).iconOnly?cSe:lSe}get options(){return{...M(this,un)}}set options(e){let{onClick:t,...r}=e;typeof t=="function"&&Bt.warn("Setting the onClick option is currently unavailable."),Object.assign(M(this,un),r)}get icon(){return ire(this.iconName,this.color,M(this,zo)*M(this,Zf).pixelRatio,M(this,_s)*M(this,Zf).pixelRatio)}setSize(e,t){M(this,Cn)&&(M(this,Cn).uniforms.uSize.value.x=e,M(this,Cn).uniforms.uSize.value.y=t)}setXY(e,t){M(this,Cn)&&(M(this,Cn).uniforms.uSize.value.w=e,M(this,Cn).uniforms.uSize.value.z=t)}get width(){return M(this,zo)}get height(){return M(this,_s)}getPositionAlignedOffset(e,t){return{"top-left":{x:0,y:0},"top-right":{x:-e,y:0},"bottom-left":{x:0,y:-t},"bottom-right":{x:-e,y:-t},center:{x:-(e/2),y:-(t/2)},top:{x:-(e/2),y:0},bottom:{x:-(e/2),y:-t},left:{x:0,y:-(t/2)},right:{x:-e,y:-(t/2)}}[M(this,un).position]}clampWithWarning(e,t,r,n){return t>=r?(Bt.warn(`Watermark ${n} does not fit within given space.`),t):e<t||e>r?(Bt.warn(`Watermark ${n} must be between ${t} and ${r}.`),Oi.clamp(e,t,r)):e}show(){if(!M(this,Cn)){Bt.warn("Watermark material is not initialized.");return}M(this,Cn).visible=!0,this.resize(M(this,uo),M(this,No))}hide(){if(!M(this,Cn)){Bt.warn("Watermark material is not initialized.");return}M(this,Cn).visible=!1,Re(this,Nc,void 0)}insertIntoQuadTree(e){M(this,Nc)!=null&&typeof M(this,un).onClick=="function"&&e.insert(M(this,Nc))}render(){let e=this.clampWithWarning(this.defaultWidth*M(this,un).scale,this.minWidth,M(this,uo),"width");Re(this,zo,e),Re(this,_s,M(this,zo)/this.aspectRatio),Vie.getLoader().load(`data:image/svg+xml;base64,${btoa(this.icon)}`,t=>{if(Re(this,Cn,new Eo({uniforms:{uTexture:{value:t},uSize:{value:new Ai(0,0,0,0)},uOpacity:{value:.7}},vertexShader:oSe,fragmentShader:sSe,depthWrite:!1,depthTest:!1,defines:{debug:J8},wireframe:J8,transparent:!0,visible:!0})),M(this,lo))M(this,lo).material=M(this,Cn),M(this,lo).material.needsUpdate=!0;else{let r=new Ag(2,2,1,1);Re(this,lo,new Zi(r,M(this,Cn))),M(this,lo).position.set(0,0,-1),M(this,lo).frustumCulled=!1,M(this,lo).renderOrder=999;let n=new C_(1,1,1),a=new Zi(n,new wd({transparent:!0,opacity:0,depthTest:!1,depthWrite:!1}));a.layers.set(1),M(this,lo).add(a),M(this,R0).add(M(this,lo))}this.resize(M(this,uo),M(this,No)),this.publish("texture-loaded")})}resize(e,t){Re(this,uo,e),Re(this,No,t);let r=this.getPositionAlignedCanvasCoordinates(M(this,uo),M(this,No)),n=this.getPositionAlignedPadding(),a=this.getPositionAlignedOffset(M(this,zo),M(this,_s)),o=this.clampWithWarning(r.x+n.x+a.x,0,M(this,uo)-M(this,zo),"x"),s=this.clampWithWarning(r.y+n.y+a.y,0,M(this,No)-M(this,_s),"y");this.setSize(M(this,zo)/M(this,uo),M(this,_s)/M(this,No)),this.setXY(o/M(this,uo),s/M(this,No)),Re(this,Nc,new za(o,s,M(this,zo),M(this,_s),{entityId:"watermark"}))}update(){this.dirty&&(this.render(),this.dirty=!1)}};un=new WeakMap,Zf=new WeakMap,R0=new WeakMap,lo=new WeakMap,Cn=new WeakMap,Nc=new WeakMap,zo=new WeakMap,_s=new WeakMap,uo=new WeakMap,No=new WeakMap,h(rre,"WatermarkSystem");var fSe=rre;R();var Fb=100,nre=class{constructor(e,t){Z(this,"currentTotalBoundingBox");Z(this,"state");Z(this,"cameraSystem");Z(this,"dirty",!1);this.state=e,this.cameraSystem=t}update(){if(this.dirty){this.currentTotalBoundingBox==null&&(this.currentTotalBoundingBox=new tn,this.state.entityScene.children.length===0?this.currentTotalBoundingBox.setFromCenterAndSize(new le(0,0,0),new le(Fb*2,Fb*2,0)):(this.currentTotalBoundingBox.setFromObject(this.state.entityScene),this.currentTotalBoundingBox.expandByScalar(Fb))),this.currentTotalBoundingBox.expandByObject(this.state.entityScene);for(let e of this.state.entity2DMap.values())e.positionDirty===!0&&(this.currentTotalBoundingBox.expandByPoint(e.position),e.positionDirty=!1);this.cameraSystem.panBounds={center:this.currentTotalBoundingBox.getCenter(new le),min:this.currentTotalBoundingBox.min,max:this.currentTotalBoundingBox.max,radius:this.currentTotalBoundingBox.getBoundingSphere(new ea).radius},this.cameraSystem.dirty=!0,this.dirty=!1}}};h(nre,"PanBoundsSystem");var mSe=nre;R();var Ob="© Mappedin",gSe="https://info.mappedin.com/feedback",K8=["top-left","top-right","bottom-left","bottom-right"],ySe=640,vSe=h(()=>`<svg xmlns='http://www.w3.org/2000/svg' width='15' height='15' fill-rule='evenodd' viewBox='0 0 20 20'>
						<circle cx='10' cy='10' r='5.9' style='fill:rgba(255,255,255,1);'/>
						<path style='fill:rgba(0,0,0,0.7);' d='M4 10a6 6 0 1 0 12 0 6 6 0 1 0-12 0m5-3a1 1 0 1 0 2 0 1 1 0 1 0-2 0m0 3a1 1 0 1 1 2 0v3a1 1 0 1 1-2 0'/>
					</svg>`,"getAttributionButtonIcon"),Q8={position:"bottom-right"},are=class{constructor(e){Z(this,"controlContainerEl");Z(this,"controlPositions");Z(this,"compact");Z(this,"attribContainerEl");Z(this,"attribInnerEl");Z(this,"attribButtonEl");Z(this,"feedbackLinkEl");Z(this,"attribHTML",Ob);Z(this,"toggleAttribution",e=>{this.attribContainerEl!=null&&(e.preventDefault(),this.attribContainerEl.classList.contains("mappedin-compact")&&(this.attribContainerEl.classList.contains("mappedin-compact-show")?(this.attribContainerEl.removeAttribute("open"),this.attribContainerEl.classList.remove("mappedin-compact-show")):(this.attribContainerEl.classList.add("mappedin-compact-show"),this.attribContainerEl.setAttribute("open",""))))});this.controlContainerEl=document.createElement("div"),this.controlContainerEl.classList.add("mappedin-control-container"),e.appendChild(this.controlContainerEl),this.controlPositions=K8.reduce((t,r)=>{let n=document.createElement("div");return n.classList.add(`mappedin-ctrl-${r}`),this.controlContainerEl.appendChild(n),t[r]=n,t},{})}addAttributionControl(e=Q8){let t=K8.includes(e.position)?e.position:Q8.position;this.attribContainerEl=document.createElement("details"),this.attribContainerEl.classList.add("mappedin-ctrl-attrib",`mappedin-ctrl-attrib-${t}`),this.attribContainerEl.open=!0,this.attribContainerEl.tabIndex=0,this.attribContainerEl.ariaLabel="Attribution",this.controlPositions[t].appendChild(this.attribContainerEl),this.attribButtonEl=document.createElement("summary"),this.attribButtonEl.addEventListener("click",this.toggleAttribution),this.attribButtonEl.classList.add("mappedin-ctrl-attrib-button"),this.attribButtonEl.title="Toggle attribution",this.attribButtonEl.ariaLabel="Toggle attribution",this.attribButtonEl.tabIndex=0,this.attribButtonEl.innerHTML=vSe(),this.attribContainerEl.appendChild(this.attribButtonEl),this.attribInnerEl=document.createElement("div"),this.attribInnerEl.classList.add("mappedin-ctrl-attrib-inner"),this.attribInnerEl.innerHTML=Ob,this.attribContainerEl.appendChild(this.attribInnerEl),this.feedbackLinkEl=document.createElement("a"),this.feedbackLinkEl.href=gSe,this.feedbackLinkEl.target="_blank",this.feedbackLinkEl.rel="nofollow noopener noreferrer",this.feedbackLinkEl.textContent="Provide Feedback",this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner"),this.feedbackLinkEl.classList.add("mappedin-ctrl-attrib-inner-bold"),this.attribContainerEl.appendChild(this.feedbackLinkEl)}updateAttribution(e){if(!e.style||!this.attribInnerEl||!this.attribContainerEl)return;let t=[Ob],r=e.style.sourceCaches;for(let a in r){let o=r[a];if(o.used||o.usedForTerrain){let s=o.getSource();s.attribution&&t.indexOf(s.attribution)<0&&t.push(s.attribution)}}t=t.filter(a=>String(a).trim()),t.sort((a,o)=>a.length-o.length),t=t.filter((a,o)=>{for(let s=o+1;s<t.length;s++)if(t[s].indexOf(a)>=0)return!1;return!0});let n=t.join(" ");n!==this.attribHTML&&(this.attribHTML=n,t.length?(this.attribInnerEl.innerHTML=this.attribHTML,this.attribContainerEl.classList.remove("outdoor-attrib-empty")):this.attribContainerEl.classList.add("mappedin-attrib-empty"),this.resizeAttribution(e.getCanvasContainer().offsetWidth))}resizeAttribution(e){this.attribContainerEl&&(e<=ySe||this.compact?this.compact===!1?this.attribContainerEl.setAttribute("open",""):!this.attribContainerEl.classList.contains("mappedin-compact")&&!this.attribContainerEl.classList.contains("mappedin-attrib-empty")&&(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.add("mappedin-compact","mappedin-compact-show")):(this.attribContainerEl.setAttribute("open",""),this.attribContainerEl.classList.contains("mappedin-compact")&&this.attribContainerEl.classList.remove("mappedin-compact","mappedin-compact-show")))}destroyAttributionControl(){this.attribButtonEl&&this.attribButtonEl.removeEventListener("click",this.toggleAttribution),this.attribContainerEl&&(this.attribContainerEl.remove(),this.attribContainerEl=void 0,this.attribInnerEl=void 0,this.attribButtonEl=void 0)}resize(e){this.resizeAttribution(e)}updateData(e){this.updateAttribution(e)}destroy(){this.destroyAttributionControl(),this.controlContainerEl.remove(),this.compact=void 0}};h(are,"HTMLControlsSystem");var xSe=are;R();var F0,ore=class{constructor(e,t){ie(this,"mesh"),ie(this,"type","custom-geometry"),ie(this,"dirty",!0),ie(this,"feature"),ie(this,"builder"),ie(this,"outline"),ie(this,"color",new Rt),fe(this,F0,0),this.mesh=new V_,this.feature=e,this.builder=t}get visible(){return this.mesh.visible}set visible(e){this.mesh.visible=e}setOpacity(){}setColor(){}get position(){var e;return(e=this.mesh)==null?void 0:e.position}get altitude(){return M(this,F0)}set altitude(e){this.mesh&&(this.mesh.position.z=e,Re(this,F0,e))}};F0=new WeakMap,h(ore,"CustomGeometryComponent");var Bb=ore;R();var sre=class{constructor(e){Z(this,"state");this.state=e}update(){let e,t;for(let r of this.state.threeDEntities){let n=this.state.entity3DMap.get(r);(n==null?void 0:n.type)==="custom-geometry"&&(e=n.components[0],t=n.components[1],e.dirty&&t.visible!==!1&&(e.builder.setup(e.mesh),e.mesh.traverse(a=>{a.userData={entityId:r,type:"custom-geometry"}}),e.dirty=!1),t.visible!==!1&&e.builder.update(e.mesh))}}};h(sre,"CustomGeometrySystem");var _Se=sre;R();var lre=class{constructor(e){Z(this,"rendererState");Z(this,"dirty",!0);Z(this,"geometries3DDirty",!0);this.rendererState=e}update(e,t=!1){var r,n;let a=t&&e>=16&&e<=19,o;if(this.geometries3DDirty){for(let s of this.rendererState.threeDEntities)if(o=this.rendererState.entity3DMap.get(s),o&&o.type==="geometry-group"&&o.userData.modelURL===void 0&&o.userData.dirty===!1&&o.userData.outlineDirty===!0){let l=o.children[0];o.userData.outlineDirty=!1;let u=wC(o);if(u&&((r=o.parent)==null||r.remove(u),u.geometry.dispose()),!o.components[0].outline||!o.visible)continue;if(o.children.length>0){let c;if(l instanceof sie){let d=[],m,g,_,y;for(let x of o.userData.entities3D)y=this.rendererState.entity3DMap.get(x),y instanceof Xn&&(g=y.components[0],_=y.components[1],g instanceof Ko&&_.visible&&_.outline&&(m=g==null?void 0:g.geometry,m&&d.push(m)));if(d.length===0||(c=Ed(d),!c))continue}else c=l.geometry;let p=Iie(c,l.material);p.userData.outlineOfEntityId=o.userData.entityId;for(let d of o.userData.entities3D.values()){let m=this.rendererState.entity3DMap.get(d);(m==null?void 0:m.type)==="geometry"&&(m.components[0].outline=p)}(n=o.parent)==null||n.add(p)}this.dirty=!0}this.geometries3DDirty=!1}if((a||this.dirty)&&this.rendererState.threeDEntities.length>0){let s=Lh(e,16,19,0,1),l;for(let u of this.rendererState.threeDEntities)if(l=this.rendererState.entity3DMap.get(u),(l==null?void 0:l.type)==="geometry-group"&&l.components[0]!=null&&l.components[0].outline&&l.visible){let c=wC(l);if(c&&c.visible){let p=Array.isArray(c.material)?c.material:[c.material];for(let d of p)d.opacity=s}}}this.dirty=!1}};h(lre,"OutlineInterpolationSystem");var bSe=lre;function wC(i){var e;let t=(e=i.parent)==null?void 0:e.children.find(r=>r.userData.outlineOfEntityId===i.userData.entityId);return t instanceof P_?t:void 0}h(wC,"findOutline");R();var Tu,ure=class extends Zr{constructor(e,t){super(),ie(this,"cameraDirty",!0),ie(this,"focusablesDirty",!0),ie(this,"state"),ie(this,"camera"),ie(this,"debugEl",null),ie(this,"raycasters",[]),ie(this,"collisions",new Map),ie(this,"focusableEntities",new Set),fe(this,Tu,void 0),ie(this,"update",()=>{M(this,Tu)&&cancelAnimationFrame(M(this,Tu)),Re(this,Tu,requestAnimationFrame(()=>{this.updateRaf()}))}),this.state=e,this.camera=t,this.buildRaycasters()}resize(){this.buildRaycasters()}buildRaycasters(){this.debugEl&&this.debugEl.remove();let e=new Ne(this.state.canvasWidth/2,this.state.canvasHeight/2),t=new Ne(e.x/1.2,e.y/1.2),r=new Ne(e.x+(e.x-t.x),t.y),n=new Ne(t.x,e.y+(e.y-t.y)),a=new Ne(r.x,n.y);this.debugEl=document.createElement("div"),Object.assign(this.debugEl.style,{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",pointerEvents:"none"}),document.body.append(this.debugEl),this.raycasters=[e,t,r,n,a].map((o,s)=>{let l=o.x/this.state.canvasWidth*2-1,u=-(o.y/this.state.canvasHeight)*2+1,c=new Ne(l,u),p=new Fg;return p.setFromCamera(c,this.camera),[p,c,s===0?10:s<5?2:1]})}updateFocusableEntities(){this.focusableEntities.clear();let e,t;for(let r of this.state.threeDEntities)if(t=this.state.entity3DMap.get(r),t!=null&&(e=t.components[0],e instanceof Ko&&e.focusable&&e.geometry!=null)){if(e.focusMesh==null){let n=new Zi(e.geometry);n.userData={entityId:t.id},e.focusMesh=n}this.focusableEntities.add(e.focusMesh)}this.focusablesDirty=!1}updateRaf(){if(!this.cameraDirty)return;this.focusablesDirty&&this.updateFocusableEntities(),this.collisions.clear();for(let[n,a]of this.raycasters)n.setFromCamera(a,this.camera);let e=null,t,r=-1/0;for(let[n,a,o]of this.raycasters)n.intersectObjects(Array.from(this.focusableEntities.values())).forEach(s=>{if((s==null?void 0:s.object)!=null&&"isMesh"in s.object&&s!=null&&s.object.isMesh){t=s.object.userData.entityId,this.collisions.has(t)||this.collisions.set(t,0);let l=this.collisions.get(t)+o;this.collisions.set(t,l),l>r&&(e=t,r=l)}});this.publish("geometry-in-focus",e),this.cameraDirty=!1}destroy(){M(this,Tu)&&cancelAnimationFrame(M(this,Tu)),this.debugEl&&this.debugEl.remove(),this.collisions.clear(),this.focusableEntities.clear(),this.raycasters=[]}};Tu=new WeakMap,h(ure,"GeometryInFocusSystem");var wSe=ure;R();var hre=class{constructor(e){Z(this,"dirty",!0);Z(this,"map");Z(this,"stylesheetId","");Z(this,"userHiddenLayers",new Set);Z(this,"hiddenLayersInStyle",new Set);Z(this,"centerPoint");Z(this,"handleRender",async()=>{if(!this.map||!this.dirty||!this.hiddenLayersInStyle||this.hiddenLayersInStyle.size===0)return;let e=[],t=this.map.project(this.centerPoint),r=this.map.queryRenderedFeatures(t,{layers:Array.from(this.hiddenLayersInStyle)});for(var n of r)e.push(["!=",["id"],n.id]);e.length>0&&(this.hiddenLayersInStyle.forEach(a=>{this.map.setFilter(a,["all",...e])}),this.dirty=!1)});Z(this,"handleStyleChange",e=>{var t,r;if(this.map&&e&&e.dataType==="style"&&e.type==="styledata"&&this.userHiddenLayers.size>0){let n=(r=(t=e==null?void 0:e.style)==null?void 0:t.stylesheet)==null?void 0:r.id;(!n||n!==this.stylesheetId)&&(this.stylesheetId=n,this.filterStylesInMap(),this.dirty=!0)}});e&&(this.map=e,this.map.on("styledata",this.handleStyleChange),this.map.on("render",this.handleRender))}hideLayersUnderPoint(e,t){this.centerPoint=e;for(let r of t)this.userHiddenLayers.add(r);this.dirty=!0,this.filterStylesInMap(),this.handleRender()}filterStylesInMap(){if(this.hiddenLayersInStyle=new Set,this.map)for(let e of this.userHiddenLayers)this.map.getLayer(e)&&this.hiddenLayersInStyle.add(e)}destroy(){this.map&&(this.map.off("styledata",this.handleStyleChange),this.map.off("render",this.handleRender))}};h(hre,"OutdoorLayers");var SSe=hre;R();R();R();var eL=`attribute float pathDistance;
attribute vec3 pathNormal;
attribute vec3 pathTangent;

uniform vec2 uvScale;
uniform float vertexes;
uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform float nearZoom;
uniform float farZoom;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform vec2 cameraParameters;
uniform float flattenFactor;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping \`y = mx + b\` where
// \`m = (yMax - yMin) / (xMax - xMin)\`,
// \`b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin\`.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main() {
	fragPathDistance = pathDistance;

	// We can get an origin point for the cross-section of the path by
	// subtracting the surface normal times the radius, since the surface normal
	// points strictly away from the centre.
	vec3 origin = position - nearRadius * normal;

	// Inflate the path along its surface normal to increase its radius from
	// \`nearRadius\` to \`farRadius\` when the camera is at \`farZoom\`.
	vec3 adjustedPosition = position;
	zoomLevel = clampRemap(cameraParameters.x, nearZoom, farZoom, 0.0, 1.0);
	adjustedPosition += normal * (farRadius - nearRadius) * zoomLevel;

	// Determine how far the path extends "up" or "down" in the direction of the
	// path normal.
	float height = dot(adjustedPosition - origin, pathNormal);

	// Flatten the bottom half of the path entirely so that it's flat
	// against the floor. This makes the path look nicer when it's
	// semitransparent behind opaque geometry, so you don't see it
	// peeking through.
	float desiredHeight = max(height, 0.0);

	desiredHeight = desiredHeight * flattenFactor;

	float flattenMagnitude = height - desiredHeight;
	adjustedPosition = adjustedPosition - pathNormal * flattenMagnitude;

	// Transform the vertices into NDC.
	vec4 mvPosition = modelViewMatrix * vec4(adjustedPosition, 1.0);
	gl_Position = projectionMatrix * mvPosition;

	fragTexcoord = uv;

	// Compute a texture coordinate for mapping the arrow texture to the path.
	// We don't want to use the u-value that Three.js provides, because the
	// path may end up twisting arbitrarily -- but we want the arrow texture to
	// always be on the top of the path.
	vec3 bitangent = cross(normal, pathTangent);
	fragTopTextureU = -dot(bitangent, pathNormal) * 0.5 + 0.5;

	radius = mix(nearRadius, farRadius, zoomLevel);
}
`,tL=`#define ARROW_FADING_POINT 0.15

uniform float complete;
uniform float nearRadius;
uniform float farRadius;
uniform vec2 resolution;
uniform vec2 cameraParameters;
uniform vec3 color;
uniform float pathLength;
uniform bool showPulse;
uniform vec3 pulseColor;
uniform float pulse;
uniform float pulseLength;
uniform bool pathIsVertical;
uniform bool displayArrowsOnPath;
uniform float arrowAnimationTimer;
uniform float opacityMultiplier;
uniform sampler2D arrowTexture;

varying float zoomLevel;
varying float radius;
varying vec2 fragTexcoord;
varying float fragTopTextureU;
varying float fragPathDistance;

// How long the arrow should be, as a factor of \`pathRadius\`. Since we've
// mostly flattened the top of the path, values near 2.0 (the diameter)
// will probably look best.
const float arrowLength = 2.0;

// How much of a relative margin the arrow texture should have inside the
// area laid out for it. Useful to pull the arrow away from the edges of the
// path, which slope down.
const float arrowMargin = 0.1;

// How many arrow-lengths of space should be between arrows on a short path.
const float arrowSpacingOnShortPath = 6.0;

// How many arrow-lengths of space should be between arrows on a long path.
const float arrowSpacingOnLongPath = 7.5;

// How long a path must be to be considered "long", as a factor of
// the path radius.
const float longPathLength = 200.;

// How long a path must be to be considered "short", as a factor of the
// path radius.
const float shortPathLength = 75.;

// How much of the path's length the fade-in should comprise when going from
// zero opacity to full opacity.
const float completeLength = 0.1;

// Map the x value from the range [xMin, xMax] to the range [yMin, yMax] using
// linear interpolation/extrapolation.
//
// This performs a pure linear mapping \`y = mx + b\` where
// \`m = (yMax - yMin) / (xMax - xMin)\`,
// \`b = -xMin * (yMax - yMin) / (xMax - xMin) + yMin\`.
float remap(float x, float xMin, float xMax, float yMin, float yMax) {
	return (x - xMin) / (xMax - xMin) * (yMax - yMin) + yMin;
}

// Map the x value from [xMin, xMax] to the range [yMin, yMax] using linear
// interpolation, clamping result values outside [yMin, yMax].
float clampRemap(float x, float xMin, float xMax, float yMin, float yMax) {
	return clamp(remap(x, xMin, xMax, yMin, yMax), yMin, yMax);
}

void main(void) {
	// Compute the opacity of the path based on the distance from the current
	// fragment to the \`complete\` value as it varies from 0.0 to 1.0.
	// Fragments that are at the \`complete\` value or past it will be fully
	// transparent, while fragments that are at \`complete - completeLength\`
	// or before it will be fully opaque. However, we adjust the \`complete\`
	// value here so that it overshoots by one full \`completeLength\`, so that
	// the entire path will be opaque when the \`complete\` value is at 1.0.
	float completeLocation = complete * (1.0 + completeLength);
	float completeAmount = clampRemap(
		fragPathDistance,
		completeLocation - completeLength,
		completeLocation,
		0.0,
		1.0
	);
	float opacity = 1.0 - smoothstep(0.0, 1.0, completeAmount);

	// 2020/01/09 Terence Dickson
	// When we render the background and overlay for the mapbox outdoor context
	// behind everything else in single-buffer rendering, the fact that the path
	// writes to the depth buffer means that the background and overlay will not
	// be drawn behind the path even when the path is still fading in. The effect
	// is subtle and is only visible in single-buffer rendering so this quick fix
	// prevents writes to the depth buffer for zero opacity fragments, which gets
	// rid of the most visually-offensive ghosting.
	if (opacity <= 0.0) {
		discard;
	}

	// Push in the texture coordinates so that they ramp up
	// at \`arrowMargin\` instead of at zero; this remapping looks somewhat
	// like this:
	// 1 ^        ___
	//   |       /
	//   |      /
	//   |     /
	//   |    /
	//   |___/
	// 0 +---------->
	//   0   ^      1
	//       arrowMargin
	// Making the arrows narrower on the path.
	float u = fragTopTextureU;
	u = clamp(
		u * (1. / (1. - arrowMargin * 2.)) - (1. / (1. - arrowMargin * 2.) - 1.) / 2.,
		0.0,
		1.0
	);

	float arrowSpacing = clampRemap(
		pathLength,
		shortPathLength * radius,
		longPathLength * radius,
		arrowSpacingOnShortPath,
		arrowSpacingOnLongPath
	);

	// Reduce the spacing between arrows when the camera zooms out, as increasing
	// the path radius will increase the arrow size and thus be able to fit
	// fewer arrows on in total, and this secondary movement of the arrows
	// "zooming off" the end of the path is unpleasant
	float expandAmount = mix(1.0, farRadius / nearRadius, zoomLevel);
	float effectiveArrowSpacing =
		arrowSpacing * 1.0 / expandAmount +
		arrowMargin * 2.0;

	float effectiveArrowLength = arrowLength * radius * (1. - arrowMargin * 2.0);

	// Adjust the slope of the vertical texture coordinate so that it goes
	// from 0 to 1 along the length of the arrow plus the spacing between
	// arrows, and adjust its x-intercept so that one arrow moves to the
	// exact position of the next arrow as \`arrowAnimationTimer\` goes
	// from 0 to 1
	float v = (
		fragTexcoord.x * (pathLength / effectiveArrowLength)
		- arrowAnimationTimer * (1. + effectiveArrowSpacing)
	);

	// Compute a "looping sawtooth" wave for determining the vertical texture
	// coordinates of the arrow texture, roughly as follows:
	// 3 ^              /
	//   |          ___/
	// 2 |         /
	//   |     ___/
	// 1 |    /
	//   |___/
	// 0 +--------------->
	//   0   ^ ^
	//   ^   |_|
	//   |   effectiveArrowLength
	//   |___|
	//   effectiveArrowSpacing
	//
	// This is effectively equivalent to this sort of sawtooth wave:
	//   ^
	// 1 |    /    /    /
	//   |___/ ___/ ___/
	// 0 +--------------->
	//
	// Causing the image of the arrow to repeat, with dead space (the bottom
	// edge of the texture stretched out) between the arrows at the provided
	// spacing. The reason why the "looping" design is preferred is because
	// it takes advantage of WebGL's \`GL_REPEAT\` texture wrapping behaviour
	// to avoid the discontinuity that can end up causing visual artifacts.
	if (mod(v, (1. + effectiveArrowSpacing)) < 1.) {
		v = v - effectiveArrowSpacing * floor(v / (1. + effectiveArrowSpacing));
	} else {
		v = ceil(v / (1. + effectiveArrowSpacing));
	}

	// Use the r-component of the texture to determine whether the arrow covers
	// this fragment or not
	vec2 sampleTexcoord = vec2(u, v);
	float arrowAmount = 0.0;
	vec3 secondColor = pulseColor;

	if (displayArrowsOnPath) {
		arrowAmount = texture2D(arrowTexture, sampleTexcoord).r;
		float delta = 1.0 - abs(fragPathDistance * 2.0 - 1.0);
		secondColor = mix(color, pulseColor, 1.0 - smoothstep(ARROW_FADING_POINT, 0.0, delta));
	}

	if (showPulse) {
		// Add the pulse color to the path by determining how far the current fragment
		// is from \`pulse\`
		float pulseLocation = remap(
		pulse,
		0.0,
		1.0,
		-pulseLength,
		1.0 + pulseLength
		);
		float pulseDistance = smoothstep(
		0.0,
		pulseLength,
		abs(fragPathDistance - pulseLocation)
		);

		// Blend the pulse color to the path based on how close this fragment is to
		// the \`pulse\` value and whether it's covered by an arrow -- but if it's
		// covered by *both*, then we go back to using the regular path color
		// (making arrows look like "holes" when they're overlapping the pulse.)
		float pulseLevel = abs(1.0 - pulseDistance - arrowAmount);

		gl_FragColor = vec4(mix(color, secondColor, pulseLevel), opacity * opacityMultiplier);
	} else if (displayArrowsOnPath) {
		gl_FragColor = vec4(mix(color, pulseColor, arrowAmount), opacity * opacityMultiplier);
	} else {
		gl_FragColor = vec4(color, opacity * opacityMultiplier);
	}
	#include <colorspace_fragment>
}`,MSe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAQkHpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjarZpZciQ7rkT/uYpeAicQ5HI4mr0dvOX3ATOl0li3q3SVJkUqFMEBcHc4IuX2///fcf/hK7cSXRatpZXi+cott9h5U/3j63EMPt+fL1/h+fPdeff6NnJMHNPjD2U/7+qcl183aH6eH+/PO52PN7E+B3qZ+Tlgspkjb57X1edAKT7Oh+fvrj3v6/nNdp7ftd057abHnz78npVgLGG8FF3cKSTPz2oXJFaQWuocCz9D0mhnEu8Tx54k6dexc98F77vY+f48n96HwvnyvKB8iNHzfJCvY3cj9HZF4dfM7/6QZ4j+7deb2J2z6jn7sbueC5Eq7rmpl63cd1w4GCrd2wov5Vt4r/fVeFW2OMnYIpuD13ShhUi0T8hhhR5O2Pc4w2SJOe5IuGOMM6Z7rhL+FudNSrZXOFFJz3KpkqtJ1hKn4+tawp233flmqMy8AlfGwGCBOz693Fcn/+b1OtA5Bt0QfH2NFeuKFnCWYZmzn1xFQsJ5xlRufO/LvcGNf5PYRAblhrmywe7HY4gh4Re20s1z4jrx2fkHNYKu5wCEiLmFxYREBnwJSUIJXmPUEIhjJT+dlceU4yADQSSu4A65SamQnBptbu7RcK+NEh+nkRYSIZBGSQ0EIlk5C/jRXMFQlyTZiUgRlSpNekklFymlaDGN6po0q2hR1apNe001V6mlaq211d5iS0iYtNLUtdpa651JO0N37u5c0fuII408ZJSho442+gQ+M0+ZZeqss82+4koL+q+y1K262uo7bKC085Zdtu662+4HrJ108pFTjp562umvWXtm9X3WwofM/T5r4Zk1y1i+1+mvrHFa9WWIYHIiljMyFnMg42oZANDRcuZryDla5ixnvkVIIZGsBbHkrGAZI4N5hygnvObuV+Z+mzcn+Y/yFr/LnLPU/RuZc5a6Z+Y+5+2LrK1+K0q6CTIWWkx9OggbF+zaY+1Wk/766H46wF8ONFY+O8hBMEc7oc4Vdh+8JsE+PUSrVjr70Zz1+H56PH3o9sRR1ql5Ha8bUMQxpe89Tki8Sb0tE23cw3DcfEo+ugnj2G3WEmononVfoag71pVjR+EmAE53eT5tqYfEHl/7ThMusaI+St0jktFa9gKnreiQqCNpZ2mJdSkbaiK6DrovYR4/JhJfRsx5d5EVZnEIPetHnU5KynJPTSuCPuC0lOuXH7n1DNq7DpUtHbhM5lDA0c2bnDCJoOObMnyj+aPjPwx0yiDUxKKsg35VnRnBEVhonKwK5hOk5NttUrhr2+tMOXkPJb1RZ+iAelYjL2MuO3pGRQ78GdxwOOaTAcJZcewq7ilB1RJCSozUdSEdwVJVb6asiBsHH1Bqgbiv3Cmkkis6ktVnZGRRwMNJjUA3Ao2127YWdhAIblxF51hzMcZsVZc0r0dJo5Liqfn41Q+q193SGhhkMkgaLJRNnEpqBtyVvbcVffIk+LE9QPFBTMTQe0aWkMXMnx3dy5sfHreDE60Ql50E+SqRcmfK16L2p0Ol8JFATu3qASXy7SvmiGW2cdMBxsty44CvtLogfGlv7WkCSV0WId2270EaD5Ym40cs+SAwZuNjPSTywAvEfLmzQhtLDntfCnhl/fNmUNnzyA2g76Zn0SP+c+I6bCC0FONUQ4L50e95dif+DH/m9htQjBEhPPpOjYjmm2ChbfEMIUaYtAIxmWJHlilLU8ZRs9pCsHbDpFaRgZljz2QandjDIBPZDGTuoZW1KdlYh52ALzisKJRNWSQmLAWx8iv9mGttT15bBc2oxd57bZtVF98CYtK3UH22Yd/A7WaKa+ZjNTOXEzNhMJ5kmQOvfzsbxbZALJ2xwGBjX2HFQybhi7kpbA7DVpS3RxMJwFyHwGk5gs6a4lrRHVqhYT0QTJC9UZcC9Yrelkn6yXch68NKNtG7CiU3vf/zMZAYXPWdrR9XZ/ctMV1sJQ2wJEGxzaHs7LmmHIwnUwbwnNAapBY9xhE19DNJW3ua0dDk/AjwITacR0PqZxkbyJ+E5jYbxI84x1TBE+y90hwDCYZIM0tqAKPZfCzFrbH8kYCm3eqQkZ2+2GovcL8Suokyg8yyCJes6dcouSLiNSLb0ETJU+/N/WFsBBSOXBbm9Cwp4CzlOag7ro7R2vC19nSsCPmAjIEMiobFwaoVXhjTU2XMpgEsDH/L3Sx54OCTMUSXI/IIA2V4QcLQpwVz12pInI0bY56pIQ2BSGRLL+yLfZ7JkiimbK+aepsbwRStpokx5gCqe1hjdMAwcINbkk5jmedrNRAG5pUXPe0sZIoXy1h7lSDxApzheg24JeDNtDS1oBDBUC4iWZFilBPhZx0Kqx2lihpbG9q4sYidksCN4yRYhNM4nxfBbTi4E3AT6B3igbvs9Gv8ZkHsIfdlep+2HelEDbkJdNjqZQ90B7k6OIoFfkkPNoY+z0gzACa1f2qcBYxVJpT2QQgS19dKQlbC24S92xiEAFRKB5Uy1qrBgOtwIge55G0kRPfIytGx0tMOrGfrijB2FHOk/TKcMjDTMPeBo4FnXD5cQ8vtdgoAN0yuzZQHQI09wm/5vAB6RHyI9rYKiZ6YWC6rbaiLmDtoaToC1bViXQFNtgWsOfEEKCleC3GWPSfgQWRQWMgw/9FDgvOZrFAT3SmsA3DLbqlsSppQG5QeOjPXavUUkxF/qgLM05vW5o7UakuBqo2ZW8Nj0LB7imVJC9QSA+wd7RPztIUZ80xQZq0ROrc8CSVncWzkTA/RwmunldCPAQKjqVC7bhRuTIv0plbk7gOX4m5OAi2YesYZ0KBQRToG8iv9x8dgGtgECYRBeEU87OxoSc8epu+s7Mq/MN0VbBT19dii7ekO66UZwdAMtoAVQd13J5nwZe98OgGslmVqAGBkeLZNVNVlWpV18qihntXKnBZvrDIVgFpx4q5poLqREOVplMPSpTF2KvjBAzDpprkruXIaaUmUD4Xo2yrGWcYlixKIwRFjl0jPQhKznUXZAoSjlg9c/NwAI4p3Q/w5bCNfhUZS7bGfqesHqKAlyZZxZgNrhGevZXccaqBys4NEqB3Vqfptji9uUrhCL6yXFqxtm0hhLyYU3Tjd8I/HZaWD1oyVjnG5hhpCN5yHSf8BQUZlVNd00OP4M0TK+JSM7iqWi01SinFkCQXWxiZJLqqAHiEt3G3I2WYd46KU9pIJIOkoRQYCcEAAPguHo0Y4k8Hl6SW50MoW0uZU8jJOUghKo38Nl5ZSwsJNAUC2/lFZWkfMjrU8dFrTjHpJnUrLCILQIxINiYdQlDXaE/razQ4jjQluN5jW1Eh/S7yYvI5gigSjdLYU9TiFXAcHjISiLhQd9obb3OQmwY+YqVwiBMCkOGLXaK/ljBShh56c1g0uyIb2lBRKO7ZTAFncw5c5UGjGSy3CsI1Jt2mtruZkfhBZmbR+842Yu1eDiWEl0V6LZcGem6Ct+LW4Wy3oAjyNObazKBHomhJ3HMKEKHgiGksH+Ig1nTidfNMyA+oYHqVFaRGLiQreVLc9GvQgftKjW9cfUSKNYL80rqU7Um2rwqQJR1ai31Wq7vzKJEsFHDj0bAEMUKXgvfD5bWbaLPBTKz1Nk/Fg+GUZvUzFw80CLaKtPAACVAWrismh863FU4IJ0716SXBUNVb/SDMVvZgDt34CXoOq1JKvg0n08gPHTwXBNgD5W8pZZ8E9EVWcv1DZMB2NFysIwkqBSaH5QRmsAHdkHB+UANvLJvFpQKAahSmYTLEd2AFO+5rsqRRU6sVv5IP0wsSPLcWsbC1Y95mte71CUm6RJJWwkg6Q4k+xWMM0ByElJPQ6j2ED5hY42ALpZRytx9RlgQlJLijzhKi5eX5JBSIRGfo9o2xhd/0aWku8OS+4D9ZnovHDQMPaYo4qm2mlZbUnd7pR6oQj29Z2BqJ9n3LRT+MTLu3IR+ZP2TCPh3EDw8H1NHpoT7FibNYU8WHd9ESHcY12aDOQCUBddi4Ucp+4yuzz8ybcCCu1h8zvzXhDN4HYLq1R+U0xzUqg5QSA3iSBgdDouy55Ifx0DaeEhgezxBRGmoEJ6AJitVuzwtKPlUskHgU2F0LS7AFIwW5jPu0RUL7sp+fkNk0ee8P6uXYgl40WM+cdCOW21r13e0ivt0ff/mYcUfrQZWs2BiN6G+MDTGz1BKORmUTNQp9YGSHFxAeTkQrKd6FoVUogyytW25OLy3OpaO5oZCQp46aPzb5LnJiFEIwAKkmbYVYIjzVv3vj7rA6HignEeQAXTAHKDhoD7Uujh0QjtsB6fTP1NzO7T1Nzq4F1GnfHdXCG1Yxjwdtjf+PGRGTzEtEAUCz7KLfTdItLwCXuSOAzVjaZB6LvbUZhYGWmifSZlcMDnGHPd6gPeiK9erhpiw7ZP9ahTrMhFDa1J53m9ri2DloziqGETTcVSppCbTDDjExg6RrZ6cPEzB8XArEjQSB29odrUoLyoS/65RfM9fprGGjlHpbhGgbYD8MtmW1eFcAWX5dbcMHcl8sUI2k+H7GPW9VrArw3G+BefcCrCaAT/N53YLvP26Uy0kMFnDEZz0DJkmQqEOlL7SlKweYhH8gxpYeAYi0f9magqPbMYZuUI6007lSZQoyoGfYQHsNRzHXR3MMINTSMZpq1KD2A5MDJgtMLdRU6R4CEOJcKGiIJ7K6P/vAM6xpECHI8rRHsaEj6smkngAUjXTzrRoSI48ZpHOqgOY5OejKVdpnmiYUChQnVdIPa6ekGqRSRgEO119oDHOiIUQ5ciYVgaF1oG8Udo8WYtD+DEi8D/w8rAJE2k2PoyV0oMtpauxreaFjpujAvxFlwBhjuNqM9P0IfI5iD8Nh8y1kG4igjJkDNkOijnlLhItAd9lhRd670yNRTu95cR/Xuu0c5WO4DEFk5YQAPtLvU4TYPGRh4APPEDNiuuwR6SC21JoFbQBBMr+zJmT32QplNI6p16PbculN/pCX1wAyTWGTeJ774aln0gvQikw7TmkfsNbdQNs0adutYUDqNtGc0RqngUYdhUYuHSL1/eLrgvqDTC5neu++vufRkEgP9D2T64Kg/c4n+s7k3dDr3me8nOr0c72MRNmgF7D4WySPP0YAI/bI4eixwc7K13QiRiL85A8fnSsUj+mvTrsZtVUEQZ6sTpVafW8nYJZyaZS0U+0xIb6et9PhhtoObozQbjKAoDf6eiFgx1UUvpUYj1GweH0MNMrofhynfWn7+KYu7n5r83hN9aqm+6qjcH7dUlgvZVLV3xqq4fbP16qv+eofuTz43eomAqfS7GBAB9zEE31WJ37eVIPtdGN5A8nMYPvvLt8t2/V/6gM19G4g/hIL7UXf9JgbuLRZ+AoW//AzyMxTcWyz8BAruLRZ+AgX3r3y2+mT/PwfiN1DoVI+QT3CZDmvb8022JeYb6HiQPQpPPvboFB+i1MZdcqWZqthHmix6vttw0UAI1z8oEnGwVe++c7JamxslC+8xKJE41XJmug1npz+6CUAKyURd9gSxo+kWxvtZth848GBlws/0SKjYhmbZ9IiV+mcGBSdWHk8sqSr2zz5J7QME/0yD+z4Pe+JuGn1MV/vUyZwOHojWPlmPXgf9CuoeN9UAT+FGwaLg44v3dWe6QpvuL3Ln/p3k/2AgqNDcfwHgqUmIIqn+hwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAAsSAAALEgHS3X78AAAAB3RJTUUH4wYRESAMujenGAAAB9FJREFUeNrtnWlsFVUUx899fS1gUoKioEY+WBRUEohGkUhAKxgEjSgGoRGB4AJCNKAIJBJZJSiyGYMKKkIoLlEUKhUraxFkKUE2kU1aCrRgW2jpg9f29R2/sBTo67v3zL2zvfP73MzM+XU6mf+5504BGIZhGIZhGIZhGIZhGMZGGq3JvSmR62++BXHH7Ylbf9ouRMT99yVq/e0PICIiHumUmPV3PooXOf5EItafXoCXOdUn8ep/pgjrUDY40ervX4JXUTEiocoXL5/FawiNEwlU/6hzeB3hqQljQIwJYT3UzEkQA2JiGOslsiAhDIgZ1RiD6NIEMBD8NIKxyQr6vv7FtdgQa31uILg0ig2zsZmv4//yePUj7rjNv/U3yUEJ/r7Xr/XfvBmlOPKwT+vfhpIUdvdj/Wm7UZpTz/mv/g4HUYGyQb5r/+SjEhXD/VV/j5OoSGisj16LRe9iVCY8xTcGxIulSKBmtk8MiKHlSMIn8ViMqkQivojHgfcuIJ0VAc/XPzmMVljrcQOBmdVojY1NvVx/8mcRtEqeh+NxypJatM6+ezxb/7Io6uBwR4/e/1moicJunvz956A2ip/1Xv3Nt6JGSgd6rf47/0KtlHssHrfZi5rxVDwWDx5C7XgoHotHC9AANbO8YqBXERohMt8bv/8X/kNDRDM9cA+IgWVojhWuNxAYXo4mWePyeBwYHUKz5Lo6HidNvICmybvVxfXPqEbz7Gvr2vrn1KAdHH7IpX//8yNoD8dcGY+TM6NoF26MxzLTL26Mx0majtM4q5ed7yhNulVsd5WAxqset/mGS6/d5CIBLXI62/7I6ZKyzjUC0rIfsP+hE3zkxt9c8vy7tPnJbiKfuyP+Xdn8ZDeuiMei+zF0juWOGyBNv+iMxw4bEBkl6CzOxmPx6ll0mryWDtb/ViU6z17H4rEYG0I3cMiheByYFEZ34Ew8Dn5UjW7BiXisY/rFDfGYmgWCCwcngXto0q08z1YBSUsy3NWgb5Qe2WSjgJRlfdy2RJPcNXm9bQIarexpsP5VdxHjcbMcm2Q3/5P64i71U8k/ELuLNsVjcct2cnST+rGg+Jo4XmhLPBZ376GOfoOkAIB5NWTHxuu/nzj9ElkA8gLgA+pLlvF43IU4/VI9G1QEAHnIPjfVaP1PnqRdVngKqAkActDMa2Hw/u9zijjjNg5UBcBr1FbD3jbG6h9QSruk8ovfyFESABnUWSNT8VgMI06/lF7aBqomAJ4n3m+G4nHgbeJfZfHljcCKAqDHcWo87m2g/gnE53LhlS+lqQqATv9S4/FL2u//qcT2T34XoAuAdvuJBspf11z/LOKbyYG6q4bqAqDVTqKByjFa21/U6ZfdaWBNADTdTDQQnqSv/pRMYjrZevVLCUUAiF+JBqpnaqv/J2I+zb3mxZwkAMTPDq8ep1A3P/1y3ZOEJABgiaPxuOnvxLN/B7oEwELq/sPl1utvSdz8VPsl6BMAn1AbBKut1t96F+3ENXOFTgFiehXRwAZL8Vi0JW5+qppW7+HIAgDGnyca2G4hHouOh2knvTARdAuAkedsj8cinTj9Ujka9AuAV87YHI/F08TNT2eHgQkB0I/aIDhGmuIU/YnnKxkAZgTAU8SGHC0eDyJufiqKfTKrAqBrPtFAiXo8HlFBO1VBA7ebZQHQifhUVo7H4p2QgQeOdQHQbp8t8Tg4idj+2dPgwJIGAdBqhw3xmDz9EuelQ4cASP3DeDwOziW+ecdbldEiACDbcDxOWkBs/8QNHpoEAPXjLNFMmfpv+IZ4+PjRU5cAWGwwHqcQNz/J2NUmAMgjavHjMfEPTGpvvz4BQH1MrzMkoHoW2CsAppEaBFskemQUA+HJYLcAeJfQINgpNVuvbiA0FuwXAG8qNwh2S07WqxqQ/saPXgEwRDGu7W8te2Q1A6XSH0HWLAD6nVa5zoPS9asZKJb/DLZuAdDzhPx1Hu2gkobkDRQq/J8w7QJAfstevuI3+WQN1F39dkAAtP9H7jpPdFVtiMgZOKC0Z9aAAEiT+mrbScLQjIyBXWngtABokRf/kKefonRF4xvYqrjmYEQApG6Md8SyvrS+eDwDG5QbzUYExL3QMxnUlZGGD5wFbhEADQ7YVwyhr401YCD6LbhHACyK3SA4N9TK6mhMA5EvwE0CYF6sBkFopLXl8exYq9/gLgHwYf3x+PxoqwMC9RoIvw9uE1D/gH3VeOsjItnSq9/OCqhvwL5qAoABA5XU28qsAHjj2tW8mukABgzEXP12WgAMvrpBEPkYwICB2KvfjguAvnUH7GvnARgwUGRhEt24gLoD9tGvAAwYKLDyySzzAqDzpQH76CIAAwYOWtqNYoMAaH9xwP57AAMG9ljbj2SHALhjJyLijwAGDGyzuCPNFgGQuhlxpfw1yR94dfAxi5cmojI/lRyx+rtaX9XDhADr2CVABc//JycWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWAALYAEsgAWwABbAAlgAC2ABLIAFsAAWwAJYAAtgASyABbAAFsACWIDToH8FyJUWtVWAALedDoFhGIZhGIZhGIZhGIYxyf+YwEMsIhMo/AAAAABJRU5ErkJggg==",CSe=new OT;function cre(i,e){let{nearRadius:t,farRadius:r,color:n,accentColor:a,completeFraction:o}=e,s=0,l=1/0,u=e.displayArrowsOnPath,c=!0,p=u,d=t/2+.15,m=0;i[0].z+=d;for(let N=1;N<i.length;++N){i[N].z+=d;let J=i[N].x-i[N-1].x,Y=i[N].y-i[N-1].y,oe=i[N].z-i[N-1].z;m+=Math.sqrt(J*J+Y*Y+oe*oe)}let g=d-.1;i.push(i[i.length-1].clone().setZ(g)),i.unshift(i[0].clone().setZ(g));let _=new Ln;p&&(_=CSe.load(MSe),_.colorSpace=Un);let y=new Rt(n),x=new Rt(a),w={vertexes:{type:"f",value:1},resolution:{type:"v2",value:new Ne(1,1)},cameraParameters:{type:"v2",value:new Ne(s,0)},complete:{type:"f",value:0},color:{type:"c",value:y},pathLength:{type:"f",value:m},nearRadius:{type:"f",value:t},farRadius:{type:"f",value:r},nearZoom:{type:"f",value:s},farZoom:{type:"f",value:l},pulseColor:{type:"c",value:x},pulse:{type:"f",value:0},pulseLength:{type:"f",value:.075},pathIsVertical:{type:"b",value:!1},arrowAnimationTimer:{type:"f",value:0},arrowTexture:{type:"t",value:_},displayArrowsOnPath:{type:"b",value:u},flattenFactor:{type:"f",value:.05},showPulse:{type:"b",value:c},opacityMultiplier:{type:"f",value:1}},b=new QY(i);b.curveType="catmullrom",b.tension=0;let C=30,E=8,T=C*i.length,L=new x2e(b,T,t,E,!1),D=new Float32Array(L.attributes.position.count);for(let N=i.length;N<D.length;N++)D[N]=N;L.setAttribute("vertexIndex",new Ur(D,1));let B=new Float32Array(L.attributes.position.count),A=new Ur(B,1);for(let N=0;N<=T;N++)for(let J=0;J<=E;++J)A.setX(N*(E+1)+J,N/T);L.setAttribute("pathDistance",A);let k=new Float32Array(L.attributes.normal.count*3),$=new Ur(k,3);for(let N=0;N<T;N++){let J=L.tangents[N];for(let Y=0;Y<=E;++Y)$.setXYZ(N*(E+1)+Y,J.x,J.y,J.z)}L.setAttribute("pathTangent",$);let z=new Float32Array(L.attributes.normal.count*3),P=new Ur(z,3);for(let N=0;N<T;N++){let J=L.tangents[N];var U,G,K;U=-J.x*J.z,G=-J.y*J.z,K=1-J.z*J.z;let Y=Math.sqrt(U*U+G*G+K*K);Y===0&&(Y=1);let oe=U/Y,xe=G/Y,ge=K/Y;for(let Te=0;Te<=E;++Te)P.setXYZ(N*(E+1)+Te,oe,xe,ge)}L.setAttribute("pathNormal",P);let O=new Eo({uniforms:w,vertexShader:eL,fragmentShader:tL});O.transparent=!0,O.alphaTest=.5,w.resolution.value.x=1,w.resolution.value.y=1,w.vertexes.value=D.length,w.arrowTexture.value.wrapS=_o,w.arrowTexture.value.wrapT=_o,w.arrowTexture.value.anisotropy=16,w.complete.value=o;let V=new Zi(L,O),j=V.clone(),q={...w,opacityMultiplier:{type:"f",value:.25}};q.complete.value=1,j.material=new Eo({uniforms:q,vertexShader:eL,fragmentShader:tL}),j.material.transparent=!0,j.material.alphaTest=.5,j.material.depthWrite=!1,j.material.depthTest=!1,j.renderOrder=1,q.resolution.value.x=1,q.resolution.value.y=1,q.vertexes.value=D.length,q.arrowTexture.value.wrapS=_o,q.arrowTexture.value.wrapT=_o,q.arrowTexture.value.anisotropy=16,q.complete.value=o;let ee=e.mesh;ee.add(V),ee.add(j),L.computeBoundingBox();let ae=new le;return L.boundingBox.getCenter(ae),{mesh:ee,material:O,center:ae}}h(cre,"buildPath");var pre=class extends Zr{constructor(t,r){super();Z(this,"rendererState");Z(this,"convertTo3DMapPosition");this.rendererState=t,this.convertTo3DMapPosition=r}update(t,r,n){let a,o=!1;for(let s of this.rendererState.threeDEntities)if(a=this.rendererState.entity3DMap.get(s),a&&a.type==="path"&&a.components[0].type==="path"){let l=a.components[0];if(l.dirty){l.mesh.parent!=null&&l.mesh.children.forEach(m=>{fo(m)});let u=l.feature.features.map(m=>m.geometry.coordinates).map(m=>this.convertTo3DMapPosition(m[1],m[0],m[2]||0)),{mesh:c,material:p,center:d}=cre(u,l);l.mesh=c,l.material=p,l.dirty=!1,l.position=d}l.material&&(l.material.uniforms.nearZoom.value=t,l.material.uniforms.farZoom.value=r,l.material.uniforms.cameraParameters.value.x=n,l.displayArrowsOnPath&&l.animateArrowsOnPath&&(l.material.uniforms.arrowAnimationTimer.value=performance.now()/1e3,o=!0),l.material.needsUpdate=!0)}o&&this.publish("animate:path")}};h(pre,"PathSystem");var ESe=pre,iL=new Fg,dre=18,TSe=12,PSe=22,fre=0,mre=0,ASe=Oi.radToDeg(.698132),sa,Pr,O0,Yf,Pu,$c,Jf,B0,SC,Ve,Ci,Vo,hr,Ps,ho,ze,z0,vr,Qi,MC,gre,CC,yre,EC,vre,hp,N0,$0,Kf,TC,U0,V0,j0,Qf,La,co,H0,PC,Uc,G0,Bn,zn,xre=class extends Zr{constructor(e,t={}){var r,n,a,o,s,l,u,c,p,d;super(),fe(this,B0),fe(this,MC),fe(this,CC),fe(this,EC),fe(this,La),fe(this,H0),ie(this,"options"),ie(this,"container"),fe(this,sa,void 0),fe(this,Pr,void 0),fe(this,O0,void 0),fe(this,Yf,void 0),fe(this,Pu,void 0),fe(this,$c,void 0),fe(this,Jf,void 0),ie(this,"rendererDomElement"),fe(this,Ve,{entity3DMap:new Map,entity2DMap:new Map,entity2DIds:new Set,threeDEntities:[],entityScene:new xa("__scene"),hoverColor:"red",insetsPadding:Eie,shouldMeasureCanvas:!0,pixelRatio:sp(),canvasWidth:0,canvasHeight:0}),ie(this,"camera"),fe(this,Ci,void 0),fe(this,Vo,void 0),fe(this,hr,void 0),fe(this,Ps,void 0),fe(this,ho,void 0),fe(this,ze,{}),fe(this,z0,window.matchMedia("screen and (min-resolution: 2dppx)")),ie(this,"map"),fe(this,vr,h(()=>{M(this,ze).renderSystem.twoDdirty=!0},"#invalidate2DEntities")),fe(this,Qi,h(()=>{M(this,ze).renderSystem.threeDdirty=!0},"#invalidate3DEntities")),fe(this,hp,"standalone"),fe(this,N0,h(E=>Math.trunc(E*10)/10,"#round10")),fe(this,$0,h(()=>{M(this,ze).twoDDrawSystem.dirty=!0,$t(this,B0,SC).call(this,sp()),M(this,ze).watermarkSystem.dirty=!0,this.render()},"#handlePixelRatioChange")),fe(this,Kf,h(()=>{M(this,Ve).canvasWidth=this.rendererDomElement.clientWidth,M(this,Ve).canvasHeight=this.rendererDomElement.clientHeight,$t(this,B0,SC).call(this,sp()),M(this,Qf).call(this),$t(this,EC,vre).call(this),M(this,ze).cameraSystem.resize(this.canvasWidth,this.canvasHeight),M(this,ze).cameraSystem.dirty=!0,M(this,ze).watermarkSystem.resize(this.canvasWidth,this.canvasHeight),M(this,ze).htmlControlsSystem.resize(this.canvasWidth),M(this,ze).geometryInFocusSystem.resize(),this.render()},"#handleWindowResize")),fe(this,TC,h(()=>{this.renderSync()},"#renderFull")),fe(this,U0,new le),fe(this,V0,h((E,T)=>{let L=this.mode==="standalone"?M(this,Pr):this.viewCamera;if(M(this,Pr).position.z+this.camera.elevation>T.z){M(this,U0).copy(T);let D=M(this,U0).project(L),B=(D.x+1)/2*this.canvasWidth-0/2,A=(-D.y+1)/2*this.canvasHeight-0/2,k=M(this,N0).call(this,B),$=M(this,N0).call(this,A);E.x=k,E.y=$}else E.x=-1e3,E.y=-1e3},"#project")),fe(this,j0,h((E,T)=>{M(this,ho).setBufferSize(E,T),M(this,Pr).aspect=E/T,M(this,Pr).updateProjectionMatrix(),M(this,Pr).updateMatrixWorld(!0),M(this,Yf).x=E,M(this,Yf).y=T},"#setBufferSize")),fe(this,Qf,h(()=>{var E;let T=M(this,Ve).canvasWidth=this.rendererDomElement.clientWidth,L=M(this,Ve).canvasHeight=this.rendererDomElement.clientHeight,D=Math.floor(T*this.resolutionScale),B=Math.floor(L*this.resolutionScale);M(this,j0).call(this,D,B),(E=this.map)==null||E.resize(),M(this,Ve).shouldMeasureCanvas=!1},"#measureCanvas")),ie(this,"showCollisionBoxes",()=>{M(this,ze).collisionSystem.showCollisionBoxes(),this.render()}),ie(this,"hideCollisionBoxes",()=>{M(this,ze).collisionSystem.hideCollisionBoxes(),this.render()}),ie(this,"projectScreenXYToCoordinate",(E,T)=>{var L;let D=E/this.canvasWidth*2-1,B=-(T/this.canvasHeight)*2+1,A=new Ne(D,B);iL.setFromCamera(A,M(this,Pr).clone());let k=(L=iL.intersectObject(M(this,Pu),!1)[0])==null?void 0:L.point;return k!=null?this.convert3DMapPositionToCoordinate(k):void 0}),ie(this,"projectCoordinateToScreenXY",E=>{let T=this.convertTo3DMapPosition(E[1],E[0],E[2]||0),L=new Ne;return M(this,V0).call(this,L,T),{x:L.x,y:L.y}}),ie(this,"convert3DMapPositionToCoordinate",E=>{var T,L,D,B;let{lat:A,lon:k}=tP((L=(T=M(this,Ve).center)==null?void 0:T[1])!=null?L:0,(B=(D=M(this,Ve).center)==null?void 0:D[0])!=null?B:0,E.x,E.y);return[k,A]}),ie(this,"setBackgroundColor",(E,T)=>{M(this,ho).setBackgroundColor(E,T)}),ie(this,"hideOutdoorLayersUnderPoint",(E,T)=>{!this.map||(T==null?void 0:T.length)===0||(M(this,ze).outdoorLayersSystem.hideLayersUnderPoint(E,T),this.render())}),fe(this,Uc,new Pg),fe(this,G0,new Gt),ie(this,"render",()=>{M(this,ze).renderSystem!=null&&(this.map&&(this.mode==="outdoors-interleaved"||this.mode==="outdoors-overlay")?this.map.triggerRepaint():M(this,ze).renderSystem.update())}),ie(this,"renderSync",()=>{M(this,ze).renderSystem.update(!0)}),fe(this,Bn,Rp(()=>{this.publish("user-interaction-start",void 0)},0,!0)),fe(this,zn,Rp(()=>{this.publish("user-interaction-end",void 0)},0,!0)),ie(this,"on",(E,T)=>{super.on(E,T),["outdoor-view-loaded","outdoor-style-loaded"].includes(E)&&this.mode==="standalone"&&dr.env.NODE_ENV!=="test"&&(Bt.warn(`"${E}" was subscribed to but outdoor view is disabled. The event has been triggered immediately. Enable outdoor view or remove the listener.`),this.publish(E))}),ie(this,"off",(E,T)=>{super.off(E,T)}),ie(this,"getCursor",()=>M(this,ze).interactionSystem.getCursor()),ie(this,"destroy",()=>{M(this,ze).cameraSystem.off("user-dolly-start",M(this,Bn)),M(this,ze).cameraSystem.off("user-pan-start",M(this,Bn)),M(this,ze).cameraSystem.off("user-rotate-start",M(this,Bn)),M(this,ze).cameraSystem.off("user-zoom-start",M(this,Bn)),M(this,ze).cameraSystem.off("user-tilt-start",M(this,Bn)),M(this,ze).cameraSystem.off("user-pedestal-start",M(this,Bn)),M(this,ze).cameraSystem.off("user-dolly-end",M(this,zn)),M(this,ze).cameraSystem.off("user-pan-end",M(this,zn)),M(this,ze).cameraSystem.off("user-rotate-end",M(this,zn)),M(this,ze).cameraSystem.off("user-zoom-end",M(this,zn)),M(this,ze).cameraSystem.off("user-tilt-end",M(this,zn)),M(this,ze).cameraSystem.off("user-pedestal-end",M(this,zn)),M(this,ze).renderSystem.off("measure-canvas",M(this,Qf)),this.remove("__scene"),M(this,vr).call(this),M(this,Qi).call(this),this.renderSync(),M(this,ze).renderSystem.destroy(),M(this,ze).zoomInterpolationSystem.destroy(),M(this,ze).renderSystem.destroy(),M(this,ze).cameraSystem.off("change",this.render),M(this,ze).pathSystem.off("animate:path",this.render),M(this,ze).cameraSystem.dispose(),M(this,ze).exporterSystem.destroy(),M(this,ze).outdoorLayersSystem.destroy(),M(this,ze).drawSystem.destroy(),window.removeEventListener("resize",M(this,Kf),!1),M(this,z0).removeEventListener("change",M(this,$0)),M(this,$c)&&M(this,$c).disconnect(),this._subscribers={},M(this,ho).destroy(),M(this,sa).traverse(E=>{fo(E),"dispose"in E&&typeof E.dispose=="function"&&E.dispose()}),Re(this,sa,void 0),M(this,ze).htmlControlsSystem.destroy(),M(this,ze).collisionSystem.destroy(),M(this,ze).domMutationSystem.destroy(),M(this,ze).geometryInFocusSystem.destroy(),Re(this,ze,void 0),this.map&&(this.map.transform.getElevation=void 0,this.map.remove()),this.container.contains(this.rendererDomElement)&&this.container.removeChild(this.rendererDomElement),this.container.removeChild(M(this,Ps)),this.container.removeChild(M(this,Ci)),Re(this,ho,void 0)}),this.convertTo3DMapPosition=this.convertTo3DMapPosition.bind(this),(t.mode==="outdoors-interleaved"||t.mode==="outdoors-overlay")&&t.map&&(Re(this,hp,t.mode),this.map=t.map),M(this,Ve).entityScene.addEventListener("childadded",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),M(this,Ve).entityScene.addEventListener("childremoved",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),M(this,Ve).entity3DMap.set(M(this,Ve).entityScene.userData.entityId,M(this,Ve).entityScene),t.center&&(M(this,Ve).center=t.center?[...t.center]:[0,0]),this.options=t,this.container=e,$t(this,MC,gre).call(this),$t(this,CC,yre).call(this),M(this,ze).htmlControlsSystem=new xSe(this.container),M(this,hp)!=="outdoors-overlay"&&M(this,ze).htmlControlsSystem.addAttributionControl(this.options.attribution),window.MappedinDebug||(window.MappedinDebug={}),dr.env.NODE_ENV==="test"&&(window.MappedinDebug.mapViewCoreInstance=this),Re(this,ho,new Vwe({antialias:typeof t.antialias=="boolean"?t.antialias:!0,alpha:!1,canvas:this.mode!=="standalone"?(r=t.gl)==null?void 0:r.canvas:void 0,onWebGLContextCreationError:t.onWebGLContextCreationError,onWebGLContextLost:()=>{typeof t.onWebGLContextLost=="function"&&t.onWebGLContextLost()},onWebGLContextRestored:()=>{t.onWebGLContextRestored&&t.onWebGLContextRestored(),M(this,vr).call(this),M(this,Qi).call(this),this.render()},onWebGLRendererError:t.onWebGLRendererError,backgroundColor:t.backgroundColor||"#ffffff",backgroundAlpha:(n=t.backgroundAlpha)!=null?n:1})),Re(this,sa,new wY),M(this,sa).add(M(this,Ve).entityScene);let m=window.__THREE_DEVTOOLS__;dr.env.NODE_ENV==="dev"&&typeof m<"u"&&(m.dispatchEvent(new CustomEvent("observe",{detail:M(this,sa)})),m.dispatchEvent(new CustomEvent("observe",{detail:M(this,ho)}))),Re(this,Pr,new jn(ASe,this.aspect,50,1e5)),Re(this,O0,new PT),M(this,Pr).renderOrder=999;let g=new or;g.add(M(this,Pr)),Re(this,Jf,new or),M(this,Jf).add(g),M(this,sa).add(M(this,Jf)),M(this,Pr).updateProjectionMatrix(),M(this,Pr).updateMatrixWorld(!0),this.referenceMap={scale:1,latitude:0,longitude:0,getNorth:()=>0,georeference:[{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}},{target:{x:0,y:0}}]},this.rendererDomElement=M(this,ho).domElement(),Re(this,Yf,new Ne);let _=new Ag(1e6,1e6),y=new wd({color:0,visible:!1});Re(this,Pu,new Zi(_,y)),M(this,sa).add(M(this,Pu)),(a=t.gl)!=null&&a.canvas||e.appendChild(this.rendererDomElement),window.addEventListener("resize",M(this,Kf),!1),M(this,z0).addEventListener("change",M(this,$0)),typeof ResizeObserver=="function"&&((o=dr.env)==null?void 0:o.NODE_ENV)!=="test"&&(Re(this,$c,new ResizeObserver(Rp(()=>{M(this,Kf).call(this)},0))),(s=M(this,$c))==null||s.observe(e)),e.classList.add("mappedin-map"),this.rendererDomElement.style.width=(l=globalThis.MappedinDebug)!=null&&l.TEST_IOS?"1080px":"100%",this.rendererDomElement.style.height=(u=globalThis.MappedinDebug)!=null&&u.TEST_IOS?"1920px":"100%",dr.env.NODE_ENV==="test"&&this.rendererDomElement.setAttribute("data-testid","mappedin-canvas"),M(this,Ve).canvasWidth=this.rendererDomElement.clientWidth,M(this,Ve).canvasHeight=this.rendererDomElement.clientHeight,this.rendererDomElement.style.touchAction="manipulation";let x=this.canvasWidth,w=this.canvasHeight;M(this,ze).watermarkSystem=new fSe(M(this,Pr),x,w,M(this,Ve),t==null?void 0:t.watermark),M(this,ze).watermarkSystem.on("texture-loaded",this.render),M(this,Ve).shouldMeasureCanvas=!0,M(this,Ve).pixelRatio=this.resolutionScale,M(this,j0).call(this,Math.floor(x*this.resolutionScale),Math.floor(w*this.resolutionScale));let b=new IK(16777215,.3*Math.PI);b.position.set(-150,-150,350),M(this,sa).add(b);let C=new L2e(16777215,.741*Math.PI);M(this,sa).add(C),M(this,ze).cameraSystem=new Y3e(M(this,Pr),M(this,sa),M(this,ho).renderer,M(this,Ve),{mode:this.mode,canvasHeight:w,canvasWidth:x}),M(this,ze).cameraSystem.on("user-dolly-start",M(this,Bn)),M(this,ze).cameraSystem.on("user-pan-start",M(this,Bn)),M(this,ze).cameraSystem.on("user-rotate-start",M(this,Bn)),M(this,ze).cameraSystem.on("user-zoom-start",M(this,Bn)),M(this,ze).cameraSystem.on("user-tilt-start",M(this,Bn)),M(this,ze).cameraSystem.on("user-pedestal-start",M(this,Bn)),M(this,ze).cameraSystem.on("user-dolly-end",M(this,zn)),M(this,ze).cameraSystem.on("user-pan-end",M(this,zn)),M(this,ze).cameraSystem.on("user-rotate-end",M(this,zn)),M(this,ze).cameraSystem.on("user-zoom-end",M(this,zn)),M(this,ze).cameraSystem.on("user-tilt-end",M(this,zn)),M(this,ze).cameraSystem.on("user-pedestal-end",M(this,zn)),M(this,ze).cameraSystem.on("change",()=>{this.publish("camera-change",this.camera),M(this,ze).geometryInFocusSystem&&(M(this,ze).geometryInFocusSystem.cameraDirty=!0),this.render()}),M(this,ze).panBoundsSystem=new mSe(M(this,Ve),M(this,ze).cameraSystem),M(this,ze).pathSystem=new ESe(M(this,Ve),this.convertTo3DMapPosition),M(this,ze).pathSystem.on("animate:path",this.render),this.camera=new aSe(this,M(this,ze),M(this,Ve),M(this,Pu)),this.camera.setZoomLevel((c=t.zoomLevel)!=null?c:dre),this.camera.setBearing((p=t.bearing)!=null?p:mre),this.camera.setPitch((d=t.pitch)!=null?d:fre),this.camera.setMaxZoomLevel(PSe),this.camera.setMinZoomLevel(TSe),M(this,ze).domVisiblitySystem=new D3e(M(this,Ve),M(this,Ps)),M(this,ze).domMutationSystem=new eSe(M(this,Ve),M(this,Ps)),M(this,ze).domMutationSystem.on("dimensions-update",()=>{M(this,ze).collisionSystem.dirty=!0,this.render()}),M(this,ze).domDrawSystem=new K3e(M(this,Ve)),M(this,ze).collisionSystem=new Kwe(M(this,Vo),M(this,Ve)),M(this,ze).twoDDrawSystem=new $3e(M(this,Ve),M(this,hr)),M(this,ze).interactionSystem=new t3e(this.rendererDomElement,M(this,Ve),M(this,Pr),M(this,Pu)),M(this,ze).interactionSystem.on("hover",this.render),M(this,ze).interactionSystem.on("click",E=>{var T,L,D,B,A;if(((T=E.entity2D)==null?void 0:T.id)==="watermark"&&typeof M(this,ze).watermarkSystem.options.onClick=="function"){M(this,ze).watermarkSystem.options.onClick();return}this.publish("click",{coordinate:this.convert3DMapPositionToCoordinate(E.position),geometry:E.entity3D?[(L=E.entity3D)==null?void 0:L.id]:[],markers:((D=E.entity2D)==null?void 0:D.components[0])instanceof Op?[E.entity2D.id]:[],models:((B=E.entity3D)==null?void 0:B.components[0])instanceof I0?[E.entity3D.id]:[],labels:((A=E.entity2D)==null?void 0:A.components[0])instanceof Fp?[E.entity2D.id]:[],containers:Array.isArray(E.groupContainers)?E.groupContainers.map(k=>k.userData.entityId):[],pointerEvent:E.pointerEvent})}),M(this,ze).interactionSystem.on("hover",E=>{var T,L,D,B,A;E.position&&((T=E.entity2D)==null?void 0:T.id)!=="watermark"&&this.publish("hover",{coordinate:this.convert3DMapPositionToCoordinate(E.position),geometry:E.entity3D?[(L=E.entity3D)==null?void 0:L.id]:[],markers:((D=E.entity2D)==null?void 0:D.components[0])instanceof Op?[E.entity2D.id]:[],models:((B=E.entity3D)==null?void 0:B.components[0])instanceof I0?[E.entity3D.id]:[],labels:((A=E.entity2D)==null?void 0:A.components[0])instanceof Fp?[E.entity2D.id]:[],containers:Array.isArray(E.groupContainers)?E.groupContainers.map(k=>k.userData.entityId):[]})}),M(this,ze).geometryInFocusSystem=new wSe(M(this,Ve),M(this,Pr)),M(this,ze).geometryInFocusSystem.on("geometry-in-focus",E=>{this.publish("geometry-in-focus",E)}),M(this,ze).twoDVisiblitySystem=new j3e(M(this,Ve)),M(this,ze).drawSystem=new V3e(M(this,Ve)),M(this,ze).drawSystem.on("texture-loaded",this.render),M(this,ze).stackSystem=new W3e(M(this,Ve)),M(this,ze).twoDProjectionSystem=new k3e(M(this,Ve),M(this,V0)),M(this,ze).zoomInterpolationSystem=new f3e,M(this,ze).exporterSystem=new m3e(M(this,Ve)),M(this,ze).meshOptimizationSystem=new L3e(M(this,Ve),this.convertTo3DMapPosition),M(this,ze).meshOptimizationSystem.on("model-loaded",this.render),M(this,ze).customGeometrySystem=new _Se(M(this,Ve)),M(this,ze).outlineInterpolationSystem=new bSe(M(this,Ve)),M(this,ze).renderSystem=new H3e(M(this,ho),M(this,Ve),this.mode,M(this,sa),M(this,Pr),this.viewCamera,M(this,ze)),M(this,ze).renderSystem.on("measure-canvas",M(this,Qf)),M(this,ze).outdoorLayersSystem=new SSe(this.map),M(this,TC).call(this)}get viewCamera(){return M(this,O0)}get canvasWidth(){return M(this,Ve).canvasWidth}get canvasHeight(){return M(this,Ve).canvasHeight}get resolutionScale(){var e,t;return(t=(e=this.map)==null?void 0:e.getPixelRatio())!=null?t:sp()}get aspect(){return this.canvasWidth/this.canvasHeight}get mode(){return M(this,hp)}addGroupContainer(e,t,r){var n;if(!M(this,Ve).entity3DMap.has(e)&&!M(this,Ve).entity2DMap.has(e)){let a=new xa(e);a.addEventListener("childadded",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),a.addEventListener("childremoved",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),(t==null?void 0:t.visible)!==void 0&&(a.visible=t.visible),(t==null?void 0:t.altitude)!==void 0&&a.setAltitude(t.altitude),(t==null?void 0:t.interactive)!==void 0&&Da(a,t.interactive,M(this,Ve)),M(this,Ve).entity3DMap.set(e,a),(n=$t(this,La,co).call(this,r))==null||n.addEntity(a),M(this,Qi).call(this),this.render()}else Bt.error(`Group container with ID '${e}' already exists. The group container cannot be added.`);return{id:e,type:"group-container"}}addStackContainer(e,t,r){var n;if(M(this,Ve).entity3DMap.has(e))Bt.error(`Stack container with ID '${e}' already exists. The stack container cannot be added.`);else{let a=new xa(e);a.addEventListener("childadded",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),a.addEventListener("childremoved",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),a.components[0]=new Q3e,(t==null?void 0:t.visible)!==void 0&&(a.visible=t.visible),M(this,Ve).entity3DMap.set(e,a),(n=$t(this,La,co).call(this,r))==null||n.addEntity(a)}return{id:e,type:"stack-container"}}addCustomGeometry(e,t,r,n,a){var o;if(M(this,Ve).entity3DMap.has(e))Bt.error(`Custom geometry with ID '${e}' already exists. The custom geometry cannot be added.`);else{let s=new Bb(t,r),l=new Xn(s,new px(n));l.id=e,s.mesh.userData={entityId:e,type:"custom-geometry"},M(this,Ve).entity3DMap.set(l.id,l),(o=$t(this,La,co).call(this,a))==null||o.addEntity(l),this.render()}return{id:e,type:"custom-geometry"}}addGeometryGroup(e,t,r,n){var a,o;if(!M(this,Ve).entity3DMap.has(e)&&!M(this,Ve).entity2DMap.has(e)){let s=new Us(e,new XM(r));s.addEventListener("childadded",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),s.addEventListener("childremoved",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),s.userData.dirty=!0,M(this,Ve).entity3DMap.set(e,s);for(let l of t.features){if(!["Polygon","MultiPolygon","LineString","MultiLineString"].includes(l.geometry.type))continue;let u=l.id||l.properties.id||Ar(),c=M(this,ze).meshOptimizationSystem.createEntityFromFeature(u,l,r);M(this,Ve).entity3DMap.set(u,c),s.userData.entities3D.add(u)}s.setVisible((a=r==null?void 0:r.visible)!=null?a:!0),(o=$t(this,La,co).call(this,n))==null||o.addEntity(s),M(this,Qi).call(this),this.render()}else Bt.error(`Geometry group with ID '${e}' already exists. The geometry group cannot be added.`);return M(this,ze).outlineInterpolationSystem.dirty=!0,{id:e,type:"geometry-group"}}addModelGroup(e,t,r,n){var a;if(!M(this,Ve).entity3DMap.has(e)&&!M(this,Ve).entity2DMap.has(e)){let o=new Us(e,new XM(r));o.addEventListener("childadded",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),o.addEventListener("childremoved",()=>{M(this,Qi).call(this),M(this,vr).call(this)}),M(this,Ve).entity3DMap.set(e,o),o.userData.dirty=!0,o.userData.modelURL=r.url;for(let s of t.features){let l=s.id||s.properties.id||Ar(),u=M(this,ze).meshOptimizationSystem.createModelFromFeature(l,s,r);s.properties.interactive!==void 0&&Da(u,s.properties.interactive,M(this,Ve)),M(this,Ve).entity3DMap.set(l,u),o.userData.entities3D.add(l)}(a=$t(this,La,co).call(this,n))==null||a.addEntity(o),M(this,Qi).call(this),this.render()}else Bt.error(`Model group with ID '${e}' already exists. The model group cannot be added.`);return{id:e,type:"geometry-group"}}addMarker2D(e,t,r,n){var a;let o=r==null?void 0:r.id;if(o===void 0||!M(this,Ve).entity2DMap.has(o)&&!M(this,Ve).entity3DMap.has(o)){let s=$t(this,H0,PC).call(this,e,new Op(t,r));s.id=o||String(s.id),o=s.id,(r==null?void 0:r.interactive)!=null&&Da(s,r==null?void 0:r.interactive,M(this,Ve)),(a=$t(this,La,co).call(this,n))==null||a.addEntity(s),this.render()}else Bt.error(`Marker2D with ID '${o}' already exists. The marker cannot be added.`);return{id:o,type:"marker"}}addLabel2D(e,t,r,n){var a;let o=r==null?void 0:r.id;if(o===void 0||!M(this,Ve).entity2DMap.has(o)&&!M(this,Ve).entity3DMap.has(o)){let s=$t(this,H0,PC).call(this,e,new Fp(t,r||{},M(this,Ve)));s.id=o||String(s.id),o=s.id,(r==null?void 0:r.interactive)!=null&&Da(s,r==null?void 0:r.interactive,M(this,Ve)),(a=$t(this,La,co).call(this,n))==null||a.addEntity(s),M(this,vr).call(this),this.render()}else Bt.error(`Label2D with ID '${o}' already exists. The label cannot be added.`);return{id:o,type:"label"}}addPath(e,t={},r){var n;let a=new G3e(e,t),o=new Xn(a,new px);return o.id=(t==null?void 0:t.id)||Ar(),a.mesh.userData={entityId:o.id,type:"path"},M(this,Ve).entity3DMap.set(o.id,o),(t==null?void 0:t.interactive)!=null&&Da(o,t==null?void 0:t.interactive,M(this,Ve)),(n=$t(this,La,co).call(this,r))==null||n.addEntity(o),M(this,Qi).call(this),this.render(),{id:o.id,type:"path"}}updateWatermark(e){M(this,ze).watermarkSystem.options=e,M(this,ze).watermarkSystem.dirty=!0,this.render()}updateStackState(e,t){let r;(typeof e=="string"||typeof e=="number")&&(r=M(this,Ve).entity3DMap.get(e)),r!=null&&r.components[0]&&(typeof t.activeId<"u"&&(r.components[0].activeId=t.activeId),typeof t.expandedFactor<"u"&&(r.components[0].percentExpanded=t.expandedFactor),r.components[0].dirty=!0,this.render())}remove(e){var t;let r;if(typeof e=="string"||typeof e=="number"?(r=M(this,Ve).entity2DMap.get(e),r==null&&(r=M(this,Ve).entity3DMap.get(e))):typeof e.id=="string"||typeof e.id=="number"?(r=M(this,Ve).entity2DMap.get(e.id),r==null&&(r=M(this,Ve).entity3DMap.get(e.id))):r=e,r!=null){if(r.type==="custom-geometry")M(this,Ve).entity3DMap.delete(r.id),r.object3d&&fo(r.object3d);else if(r.type==="group-container"){M(this,Ve).entity3DMap.delete(r.userData.entityId);for(let n of r.childrenIds.values())this.remove(n),r.userData.entities2D.delete(n);fo(r)}else if(r.type==="geometry-group"){M(this,Ve).entity3DMap.delete(r.userData.entityId);for(let n of r.userData.entities3D.values())this.remove(n),r.userData.entities3D.delete(n);fo(r)}else if(r.type==="geometry"||r.type==="model"||r.type==="path"){let n=r.components[0];r.object3d&&(((t=r.parent)==null?void 0:t.type)==="geometry-group"&&r.parent.userData.entities3D.delete(r.id),fo(r.object3d)),n.outline&&fo(n.outline),"focusMesh"in n&&n.focusMesh!=null&&fo(n.focusMesh),M(this,Ve).entity3DMap.delete(r.id)}else(r.type==="marker"||r.type==="label")&&(r.object3d&&fo(r.object3d),r.type==="label"&&delete M(this,ze).twoDDrawSystem.textCache[r.id],M(this,Ve).entity2DMap.delete(r.id));M(this,Qi).call(this),M(this,vr).call(this),this.render()}}getScene(){return this.getState("__scene")}getCurrentSceneGLTF(e){return M(this,ze).exporterSystem.getCurrentSceneGLTF(e)}getBoundingArea(e){this.renderSync();let t=new tn;if(e==null)t.setFromObject(M(this,Ve).entityScene);else{let r=Vf(M(this,Ve),e);if((r==null?void 0:r.type)==="geometry"&&(r==null?void 0:r.object3d)!=null){let n=r.components[0],a=n instanceof Ko?n.geometry:void 0;n.mesh instanceof IT&&a?(a.computeBoundingBox(),a.boundingBox&&t.union(a.boundingBox)):t.setFromObject(r.object3d)}else((r==null?void 0:r.type)==="geometry-group"||(r==null?void 0:r.type)==="group-container")&&(r==null?void 0:r.userData.entityId)!=null&&t.setFromObject(r)}if(wte(t))return fte(t).map(this.convert3DMapPositionToCoordinate)}getState(e){var t;if(e==null)return{type:"map-view",hoverColor:M(this,Ve).hoverColor};let r=Vf(M(this,Ve),e);if((r==null?void 0:r.type)==="custom-geometry"){let n=r.components[0],a=r.components[1];return{id:r.id,type:"custom-geometry",visible:a.visible,altitude:a.altitude,parent:(t=r.parent)==null?void 0:t.userData.entityId,position:this.convert3DMapPositionToCoordinate(n.position)}}else if((r==null?void 0:r.type)==="geometry-group"){let n=[];for(let o of r.userData.entities3D.values()){let s=this.getState(o);((s==null?void 0:s.type)==="geometry"||(s==null?void 0:s.type)==="model")&&n.push(s)}let a=r.components[0];return{id:r.userData.entityId,type:"geometry-group",visible:r.visible,opacity:a.opacity,color:a.color,topColor:a.topColor,outline:a.outline,shading:a.shading,interactive:Array.from(r.userData.entities3D.values()).map(o=>M(this,Ve).entity3DMap.get(o)).every(o=>o&&o.components[2]!=null),children:Array.from(r.userData.entities3D.values()).map(o=>this.getState(o)).filter(Boolean)}}else{if((r==null?void 0:r.type)==="group-container")return{id:r.userData.entityId,type:"group-container",visible:r.visible,altitude:r.altitude,interactive:!!r.components[1],children:Array.from(r.childrenIds.values()).map(n=>this.getState(n)).filter(Boolean)};if((r==null?void 0:r.type)==="label"){let n=r.components[0],a=r.object3d.parent,o=a==null?void 0:a.userData.entityId;return{id:r.id,type:"label",text:n.text||"",parent:{id:o,type:a==null?void 0:a.type},position:this.convert3DMapPositionToCoordinate(r.position),enabled:n.enabled,initialRank:Gf(n.initialRank),options:{rank:Gf(n.rank),appearance:n.appearance,interactive:r.components[1]!=null}}}else if((r==null?void 0:r.type)==="marker"){let n=r.components[0],a=r.object3d.parent,o=a==null?void 0:a.userData.entityId;return{id:r.id,type:"marker",enabled:n.enabled,parent:{id:o,type:a==null?void 0:a.type},position:this.convert3DMapPositionToCoordinate(r.position),element:n.containerEl,initialRank:Gf(n.initialRank),options:{rank:Gf(n.rank),interactive:r.components[1]!=null||!1}}}else if((r==null?void 0:r.type)==="geometry"){let{color:n,hoverColor:a,initialColor:o,topColor:s}=r.components[1],l=r.components[0],u=r.components[1];return{id:r.id,type:"geometry",color:n,focusable:l.focusable,topColor:s,initialColor:o,hoverColor:a,visible:u.visible,outline:u.outline,position:this.convert3DMapPositionToCoordinate(l.position),interactive:r.components[2]!=null}}else if((r==null?void 0:r.type)==="model"){let n=r.components[0],a=r.components[2];return{id:r.id,type:"model",position:this.convert3DMapPositionToCoordinate(n.position),interactive:a!=null}}else if((r==null?void 0:r.type)==="path"){let n=r.components[0],a=r.components[2],o=r.components[1];return{id:r.id,type:"path",position:this.convert3DMapPositionToCoordinate(n.position),visible:o.visible,interactive:a!=null,completeFraction:n.completeFraction}}else return}}setState(e,t){var r,n,a;if(typeof e=="object"&&"hoverColor"in e&&t==null){M(this,Ve).hoverColor=(r=e.hoverColor)!=null?r:M(this,Ve).hoverColor;return}let o=Vf(M(this,Ve),e);if(o!=null){if(o.type==="custom-geometry"){let s=M(this,Ve).entity3DMap.get(o.id);if(s instanceof Xn&&s.components[0]instanceof Bb){let l=t;Oc(o,l.visible),uC(o,l.altitude),sC(o,l.position,this.convertTo3DMapPosition),lC(o,$t(this,La,co).call(this,l.parent,!1))}}else if(o.type==="model"||o.type==="path"){let s=t;Da(o,s.interactive,M(this,Ve))&&M(this,Qi).call(this),o.type==="path"&&(s=s,mie(o,s),Oc(o,s.visible))}else if(o.type==="group-container"){let s=t;Oc(o,s.visible)&&(M(this,ze).outlineInterpolationSystem.dirty=!0),Da(o,s.interactive,M(this,Ve))&&M(this,Qi).call(this),uC(o,s.altitude)}else if(o.type==="geometry-group"){let s=t;Oc(o,s.visible)&&(M(this,ze).outlineInterpolationSystem.dirty=!0),cie(o,M(this,Ve),s)&&(M(this,ze).outlineInterpolationSystem.dirty=!0),hC(o,s.outline)&&(M(this,ze).outlineInterpolationSystem.geometries3DDirty=!0),pie(o,s.shading),_ie(o,M(this,Ve),s.opacity),Da(o,s.interactive,M(this,Ve))&&(M(this,Qi).call(this),M(this,vr).call(this))}else if(o.type==="geometry"){if(o.components[0]instanceof Ko){let s=t;Oc(o,s.visible)&&(M(this,ze).outlineInterpolationSystem.geometries3DDirty=!0),hC(o,s.outline)&&(M(this,ze).outlineInterpolationSystem.geometries3DDirty=!0),s.focusable!=null&&(o.components[0].focusable=s.focusable,M(this,ze).geometryInFocusSystem.focusablesDirty=!0),die(o,s),xie(o,s.hoverColor),Da(o,s.interactive,M(this,Ve))}M(this,Qi).call(this)}else if(o.type==="label"||o.type==="marker"){let s=t;vie(o,t),gie(o,t)&&M(this,vr).call(this),yie(o,(n=s.options)==null?void 0:n.rank)&&M(this,vr).call(this),sC(o,s.position,this.convertTo3DMapPosition),lC(o,$t(this,La,co).call(this,s.parent,!1))&&(M(this,vr).call(this),M(this,ze).panBoundsSystem.dirty=!0),fie(o,s.enabled),Da(o,(a=s.options)==null?void 0:a.interactive,M(this,Ve))&&M(this,vr).call(this)}this.render()}}convertTo3DMapPosition(e,t,r=0,n){var a,o,s,l;if(Array.isArray(e))return this.convertTo3DMapPosition(e[1],e[0],0,typeof t=="function"?t:void 0);if(typeof t!="number")throw new Error("convertTo3DMapPosition failed: longitude must be a number");let{x:u,y:c}=iP((o=(a=M(this,Ve).center)==null?void 0:a[1])!=null?o:0,(l=(s=M(this,Ve).center)==null?void 0:s[0])!=null?l:0,e,t);return n?(n.set(u,c,r),n):new le(u,c,r)}getCenter(e){let t=Array.isArray(e)?e:this.getBoundingArea(e);return t?bte(t):void 0}isInView(e){let t=Vf(M(this,Ve),e);if(M(this,G0).identity().multiply(M(this,Pr).projectionMatrix).multiply(M(this,Pr).matrixWorldInverse),M(this,Uc).setFromProjectionMatrix(M(this,G0)),t instanceof ud)return M(this,Uc).containsPoint(t.position);if(t instanceof Xn){let r=t==null?void 0:t.components[0];if(r instanceof Bb||r instanceof I0)return M(this,Uc).containsPoint(this.convertTo3DMapPosition(r.feature.geometry.coordinates));if(r instanceof Ko){let n=new tn(this.convertTo3DMapPosition(r.featureBbox[1],r.featureBbox[0],0),this.convertTo3DMapPosition(r.featureBbox[3],r.featureBbox[2],0));return M(this,Uc).intersectsBox(n)}}return!1}getSystems(){return M(this,ze)}getInternalState(){return M(this,Ve)}};sa=new WeakMap,Pr=new WeakMap,O0=new WeakMap,Yf=new WeakMap,Pu=new WeakMap,$c=new WeakMap,Jf=new WeakMap,B0=new WeakSet,SC=h(function(i){var e;M(this,hp)!=="outdoors-overlay"&&((e=this.map)==null||e.setPixelRatio(i)),M(this,Ve).pixelRatio=this.resolutionScale},"#setResolutionScale"),Ve=new WeakMap,Ci=new WeakMap,Vo=new WeakMap,hr=new WeakMap,Ps=new WeakMap,ho=new WeakMap,ze=new WeakMap,z0=new WeakMap,vr=new WeakMap,Qi=new WeakMap,MC=new WeakSet,gre=h(function(){Re(this,Ci,document.createElement("div")),M(this,Ci).classList.add("mappedin__smart-collision-engine__container"),Re(this,Vo,document.createElement("canvas")),M(this,Vo).classList.add("mappedin__smart-collision-engine-debug__container"),this.container.appendChild(M(this,Ci)),Re(this,hr,document.createElement("canvas")),M(this,hr).classList.add("mappedin__smart-collision-engine__container"),M(this,hr).width=M(this,Ci).clientWidth*this.resolutionScale,M(this,hr).height=M(this,Ci).clientHeight*this.resolutionScale,M(this,hr).style.width=M(this,Ci).clientWidth+"px",M(this,hr).style.height=M(this,Ci).clientHeight+"px",M(this,Ci).appendChild(M(this,Vo)),M(this,Ci).appendChild(M(this,hr)),M(this,Vo).width=M(this,Ci).clientWidth,M(this,Vo).height=M(this,Ci).clientHeight,M(this,hr).width=M(this,Ci).clientWidth*this.resolutionScale,M(this,hr).height=M(this,Ci).clientHeight*this.resolutionScale,M(this,hr).style.width=M(this,Ci).clientWidth+"px",M(this,hr).style.height=M(this,Ci).clientHeight+"px"},"#renderEntity2DContainer"),CC=new WeakSet,yre=h(function(){Re(this,Ps,document.createElement("div")),M(this,Ps).classList.add("mappedin-2d-entities"),Object.assign(M(this,Ps).style,{position:"absolute",top:"0",left:"0",bottom:"0",right:"0",pointerEvents:"none","transform-style":"preserve-3d"}),this.container.appendChild(M(this,Ps))},"#renderEntityDOMContainer"),EC=new WeakSet,vre=h(function(){M(this,hr).width=M(this,Ci).clientWidth*this.resolutionScale,M(this,hr).height=M(this,Ci).clientHeight*this.resolutionScale,M(this,hr).style.width=M(this,Ci).clientWidth+"px",M(this,hr).style.height=M(this,Ci).clientHeight+"px",M(this,Vo).width=M(this,Ci).clientWidth,M(this,Vo).height=M(this,Ci).clientHeight,M(this,hr).width=M(this,Ci).clientWidth*this.resolutionScale,M(this,hr).height=M(this,Ci).clientHeight*this.resolutionScale,M(this,hr).style.width=M(this,Ci).clientWidth+"px",M(this,hr).style.height=M(this,Ci).clientHeight+"px",M(this,ze).collisionSystem.dirty=!0},"#resizeCollisionCanvas"),hp=new WeakMap,N0=new WeakMap,$0=new WeakMap,Kf=new WeakMap,TC=new WeakMap,U0=new WeakMap,V0=new WeakMap,j0=new WeakMap,Qf=new WeakMap,La=new WeakSet,co=h(function(i,e=!0){if(!i)return e?M(this,Ve).entityScene:void 0;if(typeof i=="string"||typeof i=="number"){let t=M(this,Ve).entity3DMap.get(i);return t instanceof xa?t:(Bt.warn("Parent is not a valid container, adding to scene"),e?M(this,Ve).entityScene:void 0)}else if(i.type==="group-container"){let t=M(this,Ve).entity3DMap.get(i.id);if(t instanceof xa)return t}return e?M(this,Ve).entityScene:void 0},"#getParentContainer"),H0=new WeakSet,PC=h(function(i,e,t){let r=new ud(e,this.convertTo3DMapPosition(i[1],i[0],i[2]||t||0));return M(this,Ve).entity2DMap.set(r.id,r),r},"#createEntity2D"),Uc=new WeakMap,G0=new WeakMap,Bn=new WeakMap,zn=new WeakMap,h(xre,"Core");var ISe=xre,AC=ISe;R();function LSe(i,e){_re(i,e)(i.getScene(),e),bre(i,e),e.addFolder("Export").add({export:async()=>{let t=await i.getCurrentSceneGLTF({binary:!0}),r=new Blob([t],{type:"application/octet-stream"});var n=document.createElement("a");document.body.appendChild(n),n.style.display="none";let a=window.URL.createObjectURL(r);n.href=a,n.download="scene.glb",n.click(),window.URL.revokeObjectURL(a)}},"export")}h(LSe,"mountSceneGraphVisualizer");function _re(i,e){let t=e;return h(function r(n,a){let o=a.addFolder(`${[n.type]} ${n.id.slice(0,16)}`);if(a.close(),n.type==="geometry"||n.type==="model"||n.type==="path"){let s={set visible(l){let u=i.getState(n.id);((u==null?void 0:u.type)==="geometry"||(u==null?void 0:u.type)==="path")&&i.setState(n,{visible:l})},get visible(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry"||(l==null?void 0:l.type)==="path"?l.visible:!1},set outline(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry"&&i.setState(n,{outline:l})},get outline(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry"?l.outline:!1},get color(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry"&&l.color?_t(l.color).toHexString():"#ffffff"},set color(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry"&&i.setState(u,{color:l})},set interactive(l){let u=i.getState(n.id);((u==null?void 0:u.type)==="geometry"||(u==null?void 0:u.type)==="model"||(u==null?void 0:u.type)==="path")&&(i.setState(n,{interactive:l}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},get interactive(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry"||(l==null?void 0:l.type)==="model"||(l==null?void 0:l.type)==="path"?l.interactive:!1},get completeFraction(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="path"?l.completeFraction:1},set completeFraction(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="path"&&i.setState(u,{completeFraction:l})},focus:()=>{}};o.add(s,"focus").onChange(()=>{let l=i.getState(n.id);(l==null?void 0:l.type)==="model"||(l==null?void 0:l.type)==="path"?i.camera.focusOn([l.position]):(l==null?void 0:l.type)==="geometry"&&i.camera.focusOn(i.getBoundingArea(l))}),o.add(s,"interactive"),n.type==="path"&&o.add(s,"completeFraction",0,1,.1),o.add(s,"visible"),n.type!=="model"&&(o.addColor(s,"color"),o.add(s,"outline"))}else if(n.type==="marker"){let s={get interactive(){var l;let u=i.getState(n.id);return(u==null?void 0:u.type)==="marker"?(l=u.options)==null?void 0:l.interactive:!1},set interactive(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="marker"&&(i.setState(u,{options:{interactive:l}}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},focus:()=>{}};o.add(s,"focus").onChange(()=>{let l=i.getState(n.id);(l==null?void 0:l.type)==="marker"&&i.camera.focusOn([l.position])}),o.add(s,"interactive")}else if(n.type==="label"){let s={get interactive(){var l;let u=i.getState(n.id);return(u==null?void 0:u.type)==="label"?(l=u.options)==null?void 0:l.interactive:!1},set interactive(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&(i.setState(u,{options:{interactive:l}}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},get text(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="label"?l.text:""},set text(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&i.setState(u,{text:l})},get"Text Color"(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="label"?(u=(l=c.options.appearance)==null?void 0:l.text)==null?void 0:u.foregroundColor:"#000000"},set"Text Color"(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&i.setState(n.id,{text:s.text,options:{appearance:{text:{foregroundColor:l}}}})},get"Text Size"(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="label"?(u=(l=c.options.appearance)==null?void 0:l.text)==null?void 0:u.size:10},set"Text Size"(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&i.setState(u,{text:s.text,options:{appearance:{text:{size:l}}}})},get"Icon Size"(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="label"?(u=(l=c.options.appearance)==null?void 0:l.marker)==null?void 0:u.iconSize:10},set"Icon Size"(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="label"&&i.setState(u,{text:s.text,options:{appearance:{marker:{iconSize:l}}}})},get"Active Foreground Color"(){var l,u,c;let p=i.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=(l=p.options.appearance)==null?void 0:l.marker)==null?void 0:u.foregroundColor)==null?void 0:c.active:"#000000"},set"Active Foreground Color"(l){var u,c;let p=i.getState(n.id);(p==null?void 0:p.type)==="label"&&i.setState(p,{text:s.text,options:{appearance:{marker:{foregroundColor:{...(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.foregroundColor,active:l}}}}})},get"Inactive Foreground Color"(){var l,u,c;let p=i.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=(l=p.options.appearance)==null?void 0:l.marker)==null?void 0:u.foregroundColor)==null?void 0:c.inactive:"#000000"},set"Inactive Foreground Color"(l){var u,c;let p=i.getState(n.id);(p==null?void 0:p.type)==="label"&&i.setState(p,{text:s.text,options:{appearance:{marker:{foregroundColor:{...(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.foregroundColor,inactive:l}}}}})},get"Active Background Color"(){var l,u,c;let p=i.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=(l=p.options.appearance)==null?void 0:l.marker)==null?void 0:u.backgroundColor)==null?void 0:c.active:"#000000"},set"Active Background Color"(l){var u,c;let p=i.getState(n.id);(p==null?void 0:p.type)==="label"&&i.setState(p,{text:s.text,options:{appearance:{marker:{backgroundColor:{...(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.backgroundColor,active:l}}}}})},get"Inactive Background Color"(){var l,u,c;let p=i.getState(n.id);return(p==null?void 0:p.type)==="label"?(c=(u=(l=p.options.appearance)==null?void 0:l.marker)==null?void 0:u.backgroundColor)==null?void 0:c.inactive:"#000000"},set"Inactive Background Color"(l){var u,c;let p=i.getState(n.id);(p==null?void 0:p.type)==="label"&&i.setState(p,{text:s.text,options:{appearance:{marker:{backgroundColor:{...(c=(u=p.options.appearance)==null?void 0:u.marker)==null?void 0:c.backgroundColor,inactive:l}}}}})},focus:()=>{}};o.add(s,"focus").onChange(()=>{let l=i.getState(n.id);(l==null?void 0:l.type)==="label"&&i.camera.focusOn([l.position])}),o.add(s,"interactive"),o.add(s,"text"),o.add(s,"Text Size",10,50),o.add(s,"Icon Size",10,50),o.addColor(s,"Text Color"),o.addColor(s,"Active Background Color"),o.addColor(s,"Inactive Background Color"),o.addColor(s,"Active Foreground Color"),o.addColor(s,"Inactive Foreground Color")}else if(n.type==="geometry-group"){let s={get opacity(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry-group"?l.opacity:1},set opacity(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(n,{opacity:l})},set visible(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(n,{visible:l})},get visible(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry-group"?l.visible:!1},set outline(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(n,{outline:l})},get outline(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry-group"?l.outline:!1},set interactive(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&(i.setState(n,{interactive:l}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},get interactive(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="geometry-group"?l.interactive:!1},get shadingStart(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="geometry-group"&&(u=(l=c.shading)==null?void 0:l.start)!=null?u:0},set shadingStart(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(u,{shading:{start:l}})},get shadingEnd(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="geometry-group"&&(u=(l=c.shading)==null?void 0:l.end)!=null?u:0},set shadingEnd(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(u,{shading:{end:l}})},get shadingIntensity(){var l,u;let c=i.getState(n.id);return(c==null?void 0:c.type)==="geometry-group"&&(u=(l=c.shading)==null?void 0:l.intensity)!=null?u:0},set shadingIntensity(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="geometry-group"&&i.setState(u,{shading:{intensity:l}})}};o.add(s,"visible"),o.add(s,"opacity",0,1,.1),o.add(s,"interactive"),o.add(s,"outline"),o.add(s,"shadingStart",0,1,.1),o.add(s,"shadingEnd",0,1,.1),o.add(s,"shadingIntensity",0,1,.1)}else if(n.type==="group-container"){let s={set visible(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="group-container"&&i.setState(n,{visible:l})},get visible(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="group-container"?l.visible:!1},set interactive(l){let u=i.getState(n.id);(u==null?void 0:u.type)==="group-container"&&(i.setState(u,{interactive:l}),t.controllersRecursive().forEach(c=>c.updateDisplay()))},get interactive(){let l=i.getState(n.id);return(l==null?void 0:l.type)==="group-container"?l.interactive:!1}};o.add(s,"visible"),o.add(s,"interactive")}if(o.close(),n.children)for(let s of n.children.values())r(s,o)},"parseChild")}h(_re,"createParseChild");function bre(i,e){let t=e.addFolder("Watermark"),r={padding:16,iconOnly:!1,position:"bottom-left",color:"dark",scale:1};t.add(r,"padding",0,100,1),t.add(r,"scale",.5,1.5,.1),t.add(r,"color",["dark","light"]),t.add(r,"position",["top-left","top-right","bottom-left","bottom-right","center","top","bottom","left","right"]),t.add(r,"iconOnly"),t.onChange(()=>{i.updateWatermark(r)})}h(bre,"createWatermarkChild");var rL="https://tiles-cdn.mappedin.com/styles/mappedin/style.json",DSe="https://auth.mappedin.com/oauth2/token";async function wre(i,e){var t,r,n,a,o;if((t=e==null?void 0:e.outdoorView)!=null&&t.enabled&&(r=e==null?void 0:e.outdoorView)!=null&&r.headers){let{Map:s,MercatorCoordinate:l}=await lg(()=>import("./outdoor-context-v4-DXPG5QBY-_dFUO1ph.js"),[]),u=e.outdoorView.headers;u==null&&(u=await xte(DSe));let c=e.center||[0,0],p=new s({container:i,style:e.outdoorView.style||rL,center:c,attributionControl:!1,zoom:(n=e.zoomLevel)!=null?n:dre,pitch:(a=e.pitch)!=null?a:fre,bearing:(o=e.bearing)!=null?o:mre,transformRequest:C=>{var E;return{url:C,headers:(E=e.outdoorView)==null?void 0:E.headers}},trackResize:!1,pixelRatio:sp(),antialias:typeof e.antialias=="boolean"?e.antialias:!0,boxZoom:!1,doubleClickZoom:!1,scrollZoom:!1,dragPan:!1,dragRotate:!1,keyboard:!1,touchZoomRotate:!1}),d=p.painter.context.gl,m=new AC(i,{center:c,zoomLevel:p.getZoom(),pitch:p.getPitch(),bearing:p.getBearing(),gl:d,map:p,mode:"outdoors-interleaved",watermark:e.watermark,attribution:e.attribution,antialias:e.antialias}),g={center:p.getCenter().toArray(),zoom:p.getZoom(),bearing:p.getBearing(),pitch:p.getPitch()};p.setMinZoom(m.camera.minZoomLevel),p.setMaxZoom(m.camera.maxZoomLevel),m.on("camera-change",C=>{g.center=C.center,g.zoom=C.zoomLevel,g.bearing=-C.bearing,g.pitch=C.pitch,p.jumpTo(g)});let _=l.fromLngLat(c,0),y=nP(_,m.viewCamera,m.camera,()=>{m.renderSync()});p.on("style.load",async()=>{p&&(p.addLayer(y),m.renderSync())});let x=!1,w=!1;p.on("idle",()=>{p&&(x||(m.publish("outdoor-view-loaded"),x=!0),w||(m.publish("outdoor-style-loaded"),w=!0))});let b=h(C=>{C&&(C.sourceDataType==="metadata"||C.sourceDataType==="visibility"||C.dataType==="style"||C.type==="terrain")&&m.getSystems().htmlControlsSystem.updateData(p)},"updateData");return p.on("styledata",C=>{p&&C&&C.dataType==="style"&&C.type==="styledata"&&(w=!1),b(C)}),p.on("sourcedata",b),p.on("terrain",b),p.on("error",C=>{var E;if(((E=C.error)==null?void 0:E.url)===rL){Bt.error(`Failed to load outdoor view style, possibly due to invalid token "${u["x-mappedin-tiles-key"]}"`);return}Bt.warn(C)}),m}else return new AC(i,e)}h(wre,"createRenderer");var ny=kt(Og()),ay=30,kSe=1e3,em,W0,Sre=class extends Zr{constructor(e,t){super(),this.api=e,this.core=t,fe(this,em,void 0),fe(this,W0,0),ie(this,"includedFloors",[]),ie(this,"expanded",!1),t.on("camera-change",r=>{var n;let a=Math.floor(r.elevation/ay),o=(n=this.includedFloors[a])==null?void 0:n.id;this.expanded&&o&&o!==this.api.currentFloorId&&(this.api.currentFloorId=this.includedFloors[a].id,this.api.publish("floor-change",{reason:"elevation-change",floorId:this.api.currentFloorId}))})}get percentExpanded(){return M(this,W0)}set percentExpanded(e){let t=Lh(e,0,1,0,ay);this.includedFloors.forEach((r,n)=>{this.core.setState(r.containerId,{visible:!0,altitude:t*n})}),Re(this,W0,e)}animateToCurrentFloor(){let e=this.includedFloors.indexOf(this.api.currentFloor)*ay;new ny.default.Tween({elevation:this.core.camera.elevation}).to({elevation:e},1e3).easing(ny.default.Easing.Quadratic.Out).onUpdate(({elevation:t})=>{this.core.camera.setElevation(t),this.core.render()}).onComplete(()=>{this.api.publish("floor-change",{reason:"",floorId:this.api.currentFloorId})}).start(),this.core.render()}expand(e){return this.includedFloors=this.api.floors.filter(t=>!(e!=null&&e.excludeFloorIds.includes(t.id))),this.includedFloors.length<=1?Promise.resolve():this.animate("expand")}collapse(){return this.expanded===!0?this.animate("collapse"):Promise.resolve()}animate(e){M(this,em)&&M(this,em).stop();let t=this.includedFloors.indexOf(this.api.currentFloor)*ay;return new Promise(r=>{Re(this,em,new ny.default.Tween({percentExpanded:this.percentExpanded}).to({percentExpanded:e==="expand"?1:"0"},kSe).easing(ny.default.Easing.Quadratic.Out).onUpdate(({percentExpanded:n})=>{this.core.camera.setElevation(t*n),this.percentExpanded=n,this.core.render()}).onComplete(()=>{this.expanded=e==="expand",this.includedFloors.forEach(n=>{this.core.setState(n.containerId,{visible:e==="collapse"?n.id===this.api.currentFloorId:!0})}),this.core.getSystems().cameraSystem.enablePedestal=e==="expand",this.core.getSystems().cameraSystem.enablePan=e==="collapse",r(),this.publish(e==="expand"?"expanded":"collapsed")}).onStart(()=>{this.includedFloors.forEach(n=>{this.core.setState(n.containerId,{visible:!0})})}).start()),this.core.render()})}};em=new WeakMap,W0=new WeakMap,h(Sre,"StackedMaps");var RSe=Sre,FSe={linear:op.default.Easing.Linear.None,"ease-in":op.default.Easing.Quadratic.In,"ease-out":op.default.Easing.Quadratic.Out,"ease-in-out":op.default.Easing.Quadratic.InOut},Mre=class extends Zr{constructor(t,r,n,a={},o){super();Z(this,"floors");Z(this,"currentFloorId","");Z(this,"id");Z(this,"renderer");Z(this,"mvf");Z(this,"styleMap");Z(this,"StackedMaps");Z(this,"animations",new Map);Z(this,"Models",{add:(t,r,n)=>{let{floorId:a,...o}=n,s=n!=null&&n.floorId?this.floors.find(u=>u.id===n.floorId):this.floors[0],l=this.renderer.addModelGroup(t,{type:"FeatureCollection",features:r.map(u=>{var c;return{type:"Feature",properties:{id:Ar(),rotation:(c=u.rotation)==null?void 0:c.map(p=>p*(Math.PI/180)),scale:u.scale,interactive:u.interactive},geometry:{type:"Point",coordinates:kp(u.target)}}})},{url:o.url},s.id);return this.renderer.getState(l).children},remove:(t,r)=>{this.renderer.remove(t),this.renderer.getState(r).children.length===0&&this.renderer.remove(r)}});Z(this,"Markers",{add:(t,r,n={})=>{let{floorId:a,...o}=n,s=n!=null&&n.floorId?this.floors.find(l=>l.id===n.floorId):this.floors[0];return this.renderer.addMarker2D(t,r,o,s.id)},remove:t=>{this.renderer.remove(t)},getContentEl:t=>{let r=this.renderer.getState(t);if((r==null?void 0:r.type)==="marker")return r.element},removeAll:()=>{},setPosition:(t,r,n)=>{let a=this.renderer.getState(t);if(!a){Bt.error(`Failed to retrieve state for Marker with id "${t}".`);return}if(a.type!=="marker"){Bt.error(`Geometry with id "${t}" is not of type "marker".`);return}this.renderer.setState(a,{position:r,parent:n??this.currentFloorId})},animateTo:(t,r,n,a)=>{let o=this.renderer.getState(t);if(!o)return Bt.error(`Failed to retrieve state for Marker with id "${t}".`),Promise.resolve();if(o.type!=="marker")return Bt.error(`Geometry with id "${t}" is not of type "marker".`),Promise.resolve();let s={duration:1e3,easing:"ease-in-out",...a};this.cancelAnimation(t);let l;new op.default.Tween({lon:o.position[0],lat:o.position[1]}).to({lon:r[0],lat:r[1]},s.duration).easing(FSe[s.easing]).onUpdate(({lon:c,lat:p})=>{this.Markers.setPosition(t,[c,p],n),this.renderer.render()}).onComplete(()=>{l()}).start();let u=new Promise(c=>{l=c});return this.renderer.render(),u}});Z(this,"Exporter",{getCurrentSceneGLTF:async t=>this.renderer.getCurrentSceneGLTF(t)});Z(this,"Shapes",{add:(t,r,n)=>{let a=n!=null&&n.floorId?this.floors.find(s=>s.id===(n==null?void 0:n.floorId)):this.floors[0],o=Ar();return this.renderer.addGeometryGroup(o,t,r,a.id),o},remove:t=>(this.renderer.remove(t.id),t.id)});Z(this,"Labels",{all:({onCreate:t})=>{let r=0;for(let n of Object.entries(this.mvf.space)){let[a,o]=n;o&&(o.features.forEach(s=>{var l,u;let c=(l=this.styleMap[s.properties.id])==null?void 0:l.showImage,p=(u=s.properties.details)==null?void 0:u.images,d;if(c&&p&&p.length>0&&(d={marker:{icon:p[0].url}}),s.properties.center&&s.properties.externalId!==""){let m=this.renderer.addLabel2D(s.properties.center,s.properties.externalId,{id:s.properties.id+"-label",appearance:d},a);t(m.id,s.properties.externalId)}}),r++)}},add:(t,r,n={})=>{let{floorId:a,...o}=n,s=n!=null&&n.floorId?this.floors.find(u=>u.id===(n==null?void 0:n.floorId)):this.floors[0],l=this.renderer.addLabel2D(t,r,o,s.containerId);if(!l)throw new Error("label creating failed");return l},remove:t=>{this.renderer.remove(t)},removeAll:()=>{}});Z(this,"Paths",{add:(t,r)=>new Promise(n=>{let a=[],o=t[0].floorId||"root",s=0;for(let u of t){let{floorId:c="root",latitude:p,longitude:d}=u;c!==o&&(s++,o=c),a[s]==null&&a.push({floorId:c,coordinates:[]}),a[s].coordinates.push([d,p])}let l=a.map(({floorId:u,coordinates:c})=>this.renderer.addPath({type:"FeatureCollection",features:c.map(p=>({type:"Feature",properties:{},geometry:{type:"Point",coordinates:p}}))},r,u));new op.default.Tween({fraction:0}).to({fraction:1},(r==null?void 0:r.drawDuration)||1e3).onUpdate(({fraction:u})=>{l.forEach(c=>{this.renderer.setState(c.id,{completeFraction:u})})}).onComplete(()=>{n(l)}).start()}),remove:t=>{t.forEach(r=>{this.renderer.remove(r)})}});this.renderer=o,this.id=t,this.renderer.addGroupContainer(t,{},"root"),this.StackedMaps=new RSe(this,this.renderer),this.mvf=r,this.styleMap=n,this.floors=this.mvf["map.geojson"].sort((s,l)=>s.elevation-l.elevation).map(s=>{var l,u;if(t!=="outdoors-container"&&((l=r.space[s.id])==null?void 0:l.features.length)===0&&((u=r.obstruction[s.id])==null?void 0:u.features.length)===0)return;let c=new $we(t,s,this.renderer,a,r,n);return c.load(),c}).filter(Boolean),this.setFloor(a.initialFloor?qQ(a.initialFloor):this.floors[0].id)}get currentFloor(){return this.floors.find(t=>t.id===this.currentFloorId)}setFloor(t,r){if(this.currentFloorId!==t){if(this.publish("floor-change-start",{floorId:t}),this.currentFloorId=t,this.StackedMaps.expanded)return this.StackedMaps.animateToCurrentFloor();this.floors.forEach(n=>{n.id===t?this.renderer.setState(n.containerId,{visible:!0}):this.renderer.setState(n.containerId,{visible:!1})}),this.publish("floor-change",{reason:r,floorId:this.currentFloor.id})}}cancelAnimation(t){let r=this.animations.get(t);r&&(r.tween.stop(),r.resolver(),this.animations.delete(t))}};h(Mre,"GeojsonApiMapObject");var nL=Mre;R();var $o,X0,Cre=class{constructor({currentMapGetter:e}){fe(this,$o,new Map),fe(this,X0,void 0),Re(this,X0,e)}get currentMap(){return M(this,X0).call(this)}getById(e){return M(this,$o).get(e)}add(e,t,r){let n=Qu(e);if(!n)throw new Error("get coordinate failed");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let{id:o}=a.Markers.add(kp(n),t,{...r,floorId:n.floorId,rank:(r==null?void 0:r.rank)||"medium",dynamicResize:(r==null?void 0:r.dynamicResize)||!1}),s=a.Markers.getContentEl(o.toString());if(!s)throw new Error("marker component should exist");let l=new nee(o.toString(),s);return M(this,$o).set(l.id,{marker:l,entityId:o.toString()}),l}remove(e){var t;let r=M(this,$o).get(e.id);r&&((t=this.currentMap)==null||t.Markers.remove(r.entityId),M(this,$o).delete(e.id.toString()))}removeAll(){let e=[];return M(this,$o).forEach(({marker:t})=>{this.remove(t),e.push(t),M(this,$o).delete(t.id.toString())}),e}setPosition(e,t){var r;let n=Qu(t);if(!n){Bt.error("Cannot determine coordinate from target.");return}let a=this.currentMap;if(!a){Bt.error("Cannot determine the current map.");return}let o=M(this,$o).get(e.id);if(!o){Bt.error(`Cannot find the Marker with id "${e.id}".`);return}a.Markers.setPosition(o.entityId,kp(n),(r=n.floorId)!=null?r:a.currentFloorId)}animateTo(e,t,r){var n;let a=Qu(t);if(!a)return Bt.error("Cannot determine coordinate from target."),Promise.resolve();let o=this.currentMap;if(!o)return Bt.error("Cannot determine the current map."),Promise.resolve();let s=M(this,$o).get(e.id);return s?o.Markers.animateTo(s.entityId,kp(a),(n=a.floorId)!=null?n:o.currentFloorId,r):(Bt.error(`Cannot find the Marker with id "${e.id}".`),Promise.resolve())}};$o=new WeakMap,X0=new WeakMap,h(Cre,"Markers");var OSe=Cre;R();var bs,q0,Ere=class{constructor({currentMapGetter:e}){fe(this,bs,new Map),fe(this,q0,void 0),Re(this,q0,e)}get currentMap(){return M(this,q0).call(this)}getById(e){return M(this,bs).get(e)}add(e,t){let r=Array.isArray(e)?e:[e],n=r.reduce((s,l)=>{var u;let c=Qu(l.target);return c?(s.has(c.floorId)||s.set(c.floorId,[]),(u=s.get(c.floorId))==null||u.push({...l,target:c}),s):(Bt.error("Cannot determine coordinate from options."),s)},new Map);if(!r.length)throw new Error("targets should not be empty when adding a model");let a=this.currentMap;if(!a)throw new Error("currentMap should exist");let o=[];return n.forEach((s,l)=>{let u=Ar();a.Models.add(u,s,{...t,floorId:l}).forEach(({id:c})=>{let p=new mwe(c.toString(),u);M(this,bs).set(p.id,{model:p,entityId:c.toString(),groupId:u}),o.push(p)})}),o}remove(e){var t;let r=M(this,bs).get(e.id);r&&((t=this.currentMap)==null||t.Models.remove(r.entityId,r.groupId),M(this,bs).delete(e.id.toString()))}removeAll(){let e=[];return M(this,bs).forEach(({model:t})=>{var r;let n=M(this,bs).get(t.id);n&&(e.push(t),(r=this.currentMap)==null||r.Models.remove(n.entityId,n.groupId),M(this,bs).delete(t.id.toString()))}),e}};bs=new WeakMap,q0=new WeakMap,h(Ere,"Models");var BSe=Ere;R();var fl,Z0,Tre=class{constructor({currentMapGetter:e}){fe(this,fl,new Map),fe(this,Z0,void 0),Re(this,Z0,e)}get currentMap(){return M(this,Z0).call(this)}getById(e){return M(this,fl).get(e)}async add(e,t){let r=this.currentMap;if(!r)throw new Error("currentMap should exist");let n=await r.Paths.add(e,t),a=new gwe(Ar());return M(this,fl).set(a.id,{path:a,entityIds:n.map(o=>o.id.toString())}),a}remove(e){var t;let r=M(this,fl).get(e.id);r&&((t=this.currentMap)==null||t.Paths.remove(r.entityIds),M(this,fl).delete(e.id.toString()))}removeAll(){let e=[];return M(this,fl).forEach(({path:t})=>{this.remove(t),e.push(t),M(this,fl).delete(t.id.toString())}),e}};fl=new WeakMap,Z0=new WeakMap,h(Tre,"Paths");var zSe=Tre;R();var zb=kt(Og());R();var NSe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAkklEQVRoge3awQ3AIAxD0VAMYf+F0yUixbL8JshXuLSwIqJCwDc9QBeZEOy9p2doAQDTM7TQ2cg5Z3qGFjpHS2YjDiGDe+/0DC0cwkYpJKdnaIFMkY1kymzEIVQcwsYhbPDem56hhc5GHELGIWwcwsYhbJS+2R1CxSFsdH5iO4SMr97Y6FxPqxytVVV+HcTEIWx+9mcIqHSOm9QAAAAASUVORK5CYII=";R();var $Se=h((i,e,t=0)=>{if(Math.abs(i)>=Math.PI)throw new Error("Sector angle too wide!");let r=t/Math.tan(i/2),n=t/Math.sin(i/2),a=n+e,o=10,s=new Sd;s.moveTo(n*Math.cos(i/2)-r,n*Math.sin(i/2));for(let l=0;l<o;l++)s.lineTo(a*Math.cos(i/2-i/o*l)-r,a*Math.sin(i/2-i/o*l));for(let l=0;l<o;l++)s.lineTo(t*Math.cos(Math.PI/-2+Math.PI/o*l),t*Math.sin(Math.PI/-2+Math.PI/o*l));return new Dg(s,{depth:.1,bevelEnabled:!1,UVGenerator:USe(e)})},"createSectorGeometry"),Nb=h((i,e,t)=>{let r=Math.sqrt(Math.pow(i,2)+Math.pow(e,2))/t;return r>1?r=1:r<0&&(r=0),new Ne(0,r)},"generateRadialUV"),USe=h(i=>({generateTopUV:(e,t,r,n,a)=>{let o=t[r*3],s=t[r*3+1],l=t[n*3],u=t[n*3+1],c=t[a*3],p=t[a*3+1];return[Nb(o,s,i),Nb(l,u,i),Nb(c,p,i)]},generateSideWallUV:()=>[new Ne(0,1),new Ne(0,1),new Ne(0,1),new Ne(0,1)]}),"radialUVGenerator"),IC="#2266ff",VSe=.7,jSe=.3;function Pre(){let i=new rx({color:IC,opacity:VSe,transparent:!0,depthTest:!1,depthWrite:!1}),e=$Se(Math.PI/6,lMe,sMe);new OT().load(NSe,r=>{i.alphaMap=r,i.needsUpdate=!0});let t=new Zi(e,i);return t.position.z=-.05,t.renderOrder=3,t}h(Pre,"createBearingCone");var HSe=h(()=>{let i=new f8(.5,.5,.05,32),e=new rx({transparent:!0,color:IC,opacity:jSe,depthTest:!1,depthWrite:!1}),t=new Zi(i,e);t.scale.set(0,0,.05),t.renderOrder=2;let r=new f8(aL,aL,.05,32),n=new rx({transparent:!0,color:IC,depthTest:!1,depthWrite:!1}),a=new Zi(r,n);return a.renderOrder=3,t.rotation.x=Math.PI/2,a.rotation.x=Math.PI/2,{baseMesh:t,middleMesh:a}},"createBlueDot");R();R();R();var GSe=h(function(){let i=globalThis.fetch;return{fetch(...e){if(!XQ(i))throw new Error("fetch is not available in your environment. Pass your own function into `setFetchFn` (node-fetch, etc)");return i==null?void 0:i(...e)},setFetch(e){i=e}}},"createFetchControl")(),WSe=GSe.fetch,Are=["websdk","web","webv2","kiosk-v2","mobile","iossdk","androidsdk","reactnativesdk"],XSe=Are[0],qSe="https://api-gateway.mappedin.com/track-analytics/a/",Vc,ml,Y0,LC,Ire=class{constructor(){fe(this,Y0),fe(this,Vc,Object.freeze({})),fe(this,ml,void 0),ie(this,"sendGetDirectionsEvent",Rp((e,t)=>this.sendAnalyticEvent("query-directions",{start:e,end:t,type:"location_to_location"}),2500)),Re(this,ml,$t(this,Y0,LC).call(this,M(this,Vc)))}init(e={}){this.reset(),this.updateStateWithOptions(e)}reset(){this.updateStateWithOptions({})}updateStateWithOptions(e={}){return Re(this,Vc,Object.freeze(Object.assign({},M(this,Vc),e))),Re(this,ml,$t(this,Y0,LC).call(this,e)),M(this,ml)}updateState(e){let t={...e};t.mapId&&(t.baseUrl=uP({...M(this,ml),mapId:t.mapId})),t.context&&(t.context=hP(t.context)),Object.assign(M(this,ml),t)}get authReady(){let{key:e,secret:t,accessToken:r}=this.getState();return!!(e&&t)||!!r}getState(){return M(this,ml)}getContext(){return this.getState().context||M(this,Vc).context}sendAnalyticEvent(e,t={}){let r=this.getState(),n={...t,g:r.geolocationMode};r.userPosition&&(n={...n,...r.userPosition});let a=kre(r.baseUrl,e,n);if(r.logEvents&&Bt.log("Analytics.track",a),!r.sendEvents)return Promise.resolve();let o={"mi-context":this.getContext(),"mi-session":r.mi_session,"mi-device":r.mi_uuid,"mappedin-sdk-version":r.version,"mappedin-platform-version":r.platformString};return r.accessToken?o.Authorization=`Bearer ${r.accessToken}`:r.noAuth||r.secret&&r.key&&(o["x-mappedin-key"]=btoa(r.key),o["x-mappedin-secret"]=btoa(r.secret)),WSe(a,{method:"GET",mode:"cors",headers:o})}capture(e,t){if(JSe.includes(e))return Bt.warn(`${e} event is sent internally.`),Promise.resolve();let r=YSe.includes(e)?e.slice(1):e;return this.sendAnalyticEvent(r,t)}sendGetMapDataEvent(e){return this.sendAnalyticEvent("load-mapdata",e)}sendWatchPositionDenied(){return this.sendAnalyticEvent("watch-position-denied")}sendMapViewLoadedEvent({firstRenderDuration:e,dimension:t}){return this.sendAnalyticEvent("load-mapview",{firstRenderDuration:e,url:window.location.href,width:t.width,height:t.height,devicePixelRatio:window.devicePixelRatio})}};Vc=new WeakMap,ml=new WeakMap,Y0=new WeakSet,LC=h(function(i){var e,t,r;return{baseUrl:uP(i),version:((e=dr==null?void 0:dr.env)==null?void 0:e.npm_package_version)||"v6",mi_uuid:Lre(),accessToken:i.accessToken,mapId:i.mapId,mi_session:Dre(),platformString:i.platformString||"",context:hP(i.context)||XSe,geolocationMode:!1,sendEvents:(t=i.sendEvents)!=null?t:!1,logEvents:(r=i.logEvents)!=null?r:!1,noAuth:i.noAuth||!1,key:i.key,secret:i.secret}},"#getStateWithOption"),h(Ire,"CustomerAnalytics");var ZSe=Ire;function uP(i){return`${qSe}${i.mapId}/`}h(uP,"getBaseUrl");function Lre(){return ree.getInstance().loadLocalData("deviceId")}h(Lre,"getDeviceID");function Dre(){return ree.getInstance().loadSessionData("id")}h(Dre,"getSessionID");function kre(i,e,t){let r=new URLSearchParams;for(let[n,a]of Object.entries(t))a!=null&&r.append(n,a);return i+e+"?"+r.toString()}h(kre,"buildUrl");function hP(i){return Are.find(e=>e===i)}h(hP,"getValidContext");var YSe=["$select-location","$select-category","$query-suggest","$query-search"],JSe=["load-mapview","load-mapdata","query-directions","watch-position-denied"],Qo=new ZSe,KSe={init(...i){return Qo.init(...i)},capture(...i){return Qo.capture(...i)},updateState(i){return Qo.updateState(i)}},QSe={enableHighAccuracy:!0},eMe=500,tMe=150,iMe=150,rMe=0,nMe=5,aMe=5,oMe=30,sMe=.4,lMe=1.25,aL=.35,Rre=class extends Zr{constructor(t,r){super();Z(this,"watcherId",null);Z(this,"geometry");Z(this,"currentGeolocation");Z(this,"positionAnimation");Z(this,"scaleAnimation");Z(this,"rotationAnimation");Z(this,"updateGeometryPerFrame",t=>{var r;let[n,a,o]=t.children,{accuracy:s,heading:l}=((r=this.currentGeolocation)==null?void 0:r.coords)||{};s!=null&&(this.scaleAnimation&&this.scaleAnimation.stop(),this.scaleAnimation=new zb.default.Tween({scale:n.scale.x}).to({scale:Lh(s,aMe,oMe,rMe,nMe)},tMe).onUpdate(({scale:u})=>{n.scale.set(u,1,u)}).start()),l!=null?(o.visible=!0,this.rotationAnimation&&this.rotationAnimation.stop(),this.rotationAnimation=new zb.default.Tween({rotation:n.scale.x}).to({rotation:Oi.degToRad(l)},iMe).onUpdate(({rotation:u})=>{o.rotation.z=u}).start()):o.visible=!1});Z(this,"onPositionUpdate",t=>{var r;if(this.currentGeolocation=t,Qo.updateState({userPosition:{bluedotTimestamp:Date.now(),latitude:t.coords.latitude,longitude:t.coords.longitude,floorLevel:t.coords.floorLevel,accuracy:t.coords.accuracy}}),this.geometry){let n=this.core.getState(this.geometry);n.visible===!1&&this.core.setState(this.geometry,{position:[t.coords.longitude,t.coords.latitude],visible:!0}),this.positionAnimation&&this.positionAnimation.stop(),n=this.core.getState(this.geometry);let a;if(t.coords.floorLevel!==void 0){let o=(r=this.geoJSONApi.currentMap)==null?void 0:r.floors[t.coords.floorLevel];a=o==null?void 0:o.id}this.positionAnimation=new zb.default.Tween(n.position).to([t.coords.longitude,t.coords.latitude],eMe).onUpdate(o=>{if(this.geometry){let s={position:o};if(a==null&&n.parent!=="outdoors-container")s.parent="outdoors-container";else if(a!=null&&n.parent!==a){let l=a??"outdoors-container";s.parent=l,this.publish("floor-change",{reason:"blue-dot-floor-change",floorId:l})}this.core.setState(this.geometry,s)}}).start(),this.core.render()}});Z(this,"onPositionError",t=>{switch(t.code){case t.PERMISSION_DENIED:Bt.error("Geolocation permission denied by the user.",t),Qo.sendWatchPositionDenied();break;case t.POSITION_UNAVAILABLE:Bt.error("Geolocation position unavailable.",t);break;case t.TIMEOUT:Bt.error("Geolocation request timed out.",t);break;default:Bt.error("An unknown geolocation error occurred.",t);break}this.disable()});this.core=t,this.geoJSONApi=r}enable(){this.watcherId&&navigator.geolocation.clearWatch(this.watcherId),this.geometry=this.core.addCustomGeometry("blue-dot",{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[-79.3935,43.6532]}},{setup:t=>{let{baseMesh:r,middleMesh:n}=HSe(),a=Pre();t.add(r),t.add(n),t.add(a)},update:this.updateGeometryPerFrame},{visible:!1},"outdoors-container"),this.watcherId=navigator.geolocation.watchPosition(this.onPositionUpdate,this.onPositionError,QSe)}disable(){this.watcherId&&navigator.geolocation.clearWatch(this.watcherId),this.geometry&&(this.core.remove(this.geometry.id),this.geometry=void 0),this.currentGeolocation=void 0}};h(Rre,"BlueDot");var uMe=Rre;R();var gl,J0,Fre=class{constructor({currentMapGetter:e}){fe(this,gl,new Map),fe(this,J0,void 0),Re(this,J0,e)}get currentMap(){return M(this,J0).call(this)}getById(e){return M(this,gl).get(e)}add(e,t,r){let n=this.currentMap;if(!n)throw new Error("currentMap should exist");let a=n.Shapes.add(e,t||{},{floorId:r==null?void 0:r.id}),o=new vwe(a);return M(this,gl).set(o.id,o),o}remove(e){var t;M(this,gl).get(e.id)&&((t=this.currentMap)==null||t.Shapes.remove(e),M(this,gl).delete(e.id.toString()))}removeAll(){let e=[];return M(this,gl).forEach(t=>{this.remove(t),e.push(t.id),M(this,gl).delete(t.id.toString())}),e}};gl=new WeakMap,J0=new WeakMap,h(Fre,"Shapes");var hMe=Fre;R();var K0,Ore=class{constructor({currentMapGetter:e}){fe(this,K0,void 0),Re(this,K0,e)}get currentMap(){return M(this,K0).call(this)}setFromStyleCollection(e){var t,r,n;for(let a in e)for(let o of((t=this.currentMap)==null?void 0:t.floors)||[])if(e[a]!=null){if(o.layers.has(a)&&"color"in e[a]){let s=o.layers.get(a);(r=this.currentMap)==null||r.renderer.setState(s,{color:e[a].color})}if(a===ZQ&&!(hx in e)){let s=o.layers.get(hx);s&&"color"in e[a]&&((n=this.currentMap)==null||n.renderer.setState(s,{color:e[a].color}))}}}};K0=new WeakMap,h(Ore,"Style");var cMe=Ore;R();var ws,Q0,Bre=class{constructor(e,t){fe(this,ws,void 0),fe(this,Q0,void 0),Re(this,ws,e),Re(this,Q0,t||[])}setStyle(e){var t,r;if(M(this,ws).map){(t=M(this,ws).map)==null||t.setStyle(e),(r=M(this,ws).map)==null||r.moveLayer(dte);for(let[n,a]of M(this,Q0)||[])M(this,ws).hideOutdoorLayersUnderPoint(n,a)}}get map(){return M(this,ws).map}get enabled(){return!!M(this,ws).map}};ws=new WeakMap,Q0=new WeakMap,h(Bre,"Outdoor");var pMe=Bre,oy=.05,zre=class{constructor(e,t){Z(this,"core");Z(this,"outdoors");Z(this,"mapObjects",[]);Z(this,"id");Z(this,"mapDataExternal",{});Z(this,"mapsByFloorId",{});Z(this,"mapData");Z(this,"currentMap");Z(this,"directions");Z(this,"hiddenOutdoorGeometries",[]);Z(this,"mapView");Z(this,"Camera");Z(this,"Labels");Z(this,"Markers");Z(this,"Models");Z(this,"Paths");Z(this,"Exporter");Z(this,"Navigation");Z(this,"Outdoor");Z(this,"BlueDot");Z(this,"Shapes");Z(this,"Style");Z(this,"update",()=>{this.core.render()});Z(this,"getDirections",(e,t,r)=>{if(!this.directions)throw new Error("You have to call .addMap() before you can get directions");let n=this.getMapDataInternal();if(!n)throw new Error("getDirections failed due to missing mapData");let{accessible:a=!1,smoothing:o=!0}=r||{},s=Array.isArray(e)?e:[e],l=Array.isArray(t)?t:[t];Qo.sendGetDirectionsEvent(s[0].id,l[0].id);let u=typeof o=="object"?o.enabled:o,c=typeof o=="object"?o.radius:void 0,p=(r==null?void 0:r.zones)||[],d={accessible:a,zones:p,smoothing:{enabled:u??!0,radius:c??.75}};return this.directions.getDirections(s,l,d,n)});this.core=e,this.mapView=t,this.Camera=new Lwe(this.core),this.id=this.core.addGroupContainer("root").id.toString(),this.outdoors=new nL("outdoors-container",{"map.geojson":[{id:"outdoors",externalId:"outdoors",elevation:0}],"styles.json":{},space:{},entrance:{},obstruction:{}},{},{},this.core),this.mapObjects.push(this.outdoors);let r=new ywe(this.Camera);this.core.on("camera-change",()=>{this.mapView.publish("camera-change",r)});let n=h(s=>l=>{var u,c,p;let d=[],m=[],g=[];l.labels.forEach(b=>{let C=this.Labels.getById(b.toString());C&&d.push(C.label)}),l.markers.forEach(b=>{let C=this.Markers.getById(b.toString());C&&m.push(C.marker)}),l.models.forEach(b=>{let C=this.Models.getById(b.toString());C&&g.push(C.model)});let _=l.geometry[0],y;_&&(y=(u=this.getMapDataInternal())==null?void 0:u.getById("space",_)),y||(y=(c=this.getMapDataInternal())==null?void 0:c.getById("object",_));let x=l.containers.reduce((b,C)=>{var E;let T=(E=this.getMapDataInternal())==null?void 0:E.getById("floor",C);return T&&z_.is(T)&&b.push(T),b},[]),w={coordinate:new br(l.coordinate[1],l.coordinate[0],(p=x==null?void 0:x[0])==null?void 0:p.id),spaces:y&&gh.is(y)?[y]:[],objects:y&&yh.is(y)?[y]:[],markers:m,labels:d,models:g,floors:x};"pointerEvent"in l&&(w.pointerEvent=l.pointerEvent),this.mapView.publish(s,w)},"createHandler");this.core.on("hover",n("hover")),this.core.on("click",n("click")),this.core.on("outdoor-view-loaded",()=>{this.mapView.publish("outdoor-view-loaded")}),this.core.on("outdoor-style-loaded",()=>{this.mapView.publish("outdoor-style-loaded")}),this.core.on("user-interaction-start",()=>{this.mapView.publish("user-interaction-start")}),this.core.on("user-interaction-end",()=>{this.mapView.publish("user-interaction-end")});let a=h(()=>this.currentMap,"currentMapGetter");this.Markers=new OSe({currentMapGetter:a}),this.Models=new BSe({currentMapGetter:a}),this.Labels=new Nwe({currentMapGetter:a}),this.Exporter=new zwe({currentMapGetter:a}),this.Paths=new zSe({currentMapGetter:a}),this.Navigation=new Ewe(t),this.BlueDot=new uMe(this.core,this),this.BlueDot.on("floor-change",s=>{this.setFloor(s.floorId,"blue-dot-floor-change")}),this.Outdoor=new pMe(this.core,this.hiddenOutdoorGeometries),this.Shapes=new hMe({currentMapGetter:a}),this.Style=new cMe({currentMapGetter:a});let o=new Iwe(t,this.mapDataExternal);this.auto=o.auto}updateState(e,t){var r;if(e==="walls"){(r=this.currentMap)==null||r.floors.forEach(a=>{var o,s;let l=a.layers.get(ZQ),u=a.layers.get(hx);l&&((o=this.core.getState(l))==null||o.children.forEach(c=>{this.core.setState(c.id,t)})),u&&((s=this.core.getState(u))==null||s.children.forEach(c=>{this.core.setState(c.id,t)}))});return}let n=typeof e=="string"?this.getMapDataObject(e):e;if(n){if(xM.is(n))return this.core.setState(n.id,Gee({...t,type:"label"},this.core.getState(n.id)));if(nee.is(n))return this.core.setState(n.id,Wee({...t,type:"marker"},this.core.getState(n.id)));(gh.is(n)||yh.is(n))&&this.core.setState(n.id,Xee({...t,type:"geometry"},this.core.getState(n.id)))}}getMapDataObject(e){var t;return(t=this.getMapDataInternal())==null?void 0:t.getMapDataById(e)}getMapDataInternal(){if(this.mapData)return VS.get(this.mapData)}getMapData(){return this.mapData}expand(e){var t;return(t=this.currentMap)==null?void 0:t.StackedMaps.expand({excludeFloorIds:(e==null?void 0:e.excludeFloors.map(r=>r.id))||[]})}collapse(){var e;return(e=this.currentMap)==null?void 0:e.StackedMaps.collapse()}addMap(e,t){return new Promise(r=>{var n,a,o;let s=VS.get(e);if(!s){Bt.error("error exists"),r(e);return}this.mapDataExternal[e.mapName]=e;let{mvf:l}=s,u=l["manifest.geojson"].features[0].geometry.coordinates;this.core.mode!=="outdoors-overlay"&&this.Camera.set({center:new br(u[1],u[0])});let c=Yee(l["styles.json"]||{}),p=l["manifest.geojson"].features[0].properties.name,d=new nL(`mapObject-${p}`,l,c,t,this.core),m=this.core.getBoundingArea(d.currentFloor.id),g=(a=(n=t==null?void 0:t.outdoorView)==null?void 0:n.layersHiddenByGeometry)!=null?a:[];if(g.length>0){let _=(o=this.core.getCenter(m))!=null?o:u;this.core.hideOutdoorLayersUnderPoint(_,g),this.hiddenOutdoorGeometries.push([_,g])}this.mapObjects.push(d),l["map.geojson"].forEach(_=>{this.mapsByFloorId[_.id]=d}),d.StackedMaps.on("expanded",()=>{this.mapView.publish("expanded")}),d.StackedMaps.on("collapsed",()=>{this.mapView.publish("collapsed")}),d.on("floor-change-start",()=>{this.mapView.publish("floor-change-start",{floor:this.currentFloor})}),d.on("floor-change",_=>{this.mapView.publish("floor-change",{reason:_.reason,floor:this.currentFloor})}),this.currentMap=d,this.mapData=e,this.directions=new Bwe({nodes:this.currentMap.mvf["node.geojson"],obstructions:this.currentMap.mvf.obstruction,connections:this.currentMap.mvf["connection.json"],groupBy:"map"}),(t==null?void 0:t.zoomLevel)!=null?(this.core.camera.setZoomLevel(t.zoomLevel),r(e)):this.core.mode!=="outdoors-overlay"?this.core.camera.focusOn(this.core.getBoundingArea(d.currentFloor.id),{duration:Qbe,padding:{top:oy*this.core.canvasHeight,left:oy*this.core.canvasWidth,right:oy*this.core.canvasWidth,bottom:oy*this.core.canvasHeight}}).then(()=>{r(e)}):r(e)})}setFloor(e,t){if(!this.currentMap)throw new Error("mappObject should exist atm");this.currentMap.setFloor(typeof e=="string"?e:e.id,t)}updateWatermark(e){this.core.updateWatermark(e)}get currentFloor(){var e,t;let r=(e=this.currentMap)==null?void 0:e.currentFloor.id;if(!r)throw new Error("Missing currentFloor object from GeoJsonApi");let n=(t=this.mapData)==null?void 0:t.getById("floor",r);if(!n)throw new Error("Missing currentFloor");return n}getState(e){var t;let r=typeof e=="string"?e:e.id,n=this.core.getState(r);if(n){if(n.type==="geometry")return{type:"geometry",interactive:n.interactive,hoverColor:n.hoverColor,color:n.color,visible:n.visible};if(n.type==="label"&&n.options.appearance&&n.options.rank!==void 0&&n.options.interactive!==void 0)return{type:"label",appearance:n.options.appearance,rank:n.options.rank,enabled:n.enabled,interactive:n.options.interactive};if(n.type==="marker"&&((t=n.options)==null?void 0:t.rank)!==void 0&&n.options.interactive!==void 0){let a=typeof n.parent=="object"?n.parent.id:n.parent;return{type:"marker",rank:n.options.rank,interactive:n.options.interactive,enabled:n.enabled,element:n.element,coordinate:new br(n.position[1],n.position[0],a.toString())}}else if(n.type==="model")return{type:"model"}}}setHoverColor(e){this.core.setState({hoverColor:e})}getHoverColor(){let e=this.core.getState();return(e==null?void 0:e.type)==="map-view"?e.hoverColor:void 0}createCoordinate(e,t,r){return new br(e,t,(r==null?void 0:r.id)||this.currentFloor.id)}createCoordinateFromScreenCoordinate(e,t,r){let n=this.core.projectScreenXYToCoordinate(e,t);return n?new br(n[1],n[0],(r==null?void 0:r.id)||this.currentFloor.id):void 0}isInView(e){return this.core.isInView(typeof e=="string"?e:e.id)}auto(){this.Labels.all()}get __core(){return this.core}destroy(){this.Navigation.clear(),this.BlueDot.disable(),this.Shapes.removeAll(),this.Paths.removeAll(),this.Models.removeAll(),this.Markers.removeAll(),this.Labels.removeAll(),this.core.destroy()}};h(zre,"GeoJsonApi");var dMe=zre,ev,di,Nre=class extends Zr{constructor(e){super(),fe(this,ev,{}),fe(this,di,void 0),ie(this,"Camera"),ie(this,"Labels"),ie(this,"Markers"),ie(this,"Models"),ie(this,"Paths"),ie(this,"Exporter"),ie(this,"Navigation"),ie(this,"BlueDot"),ie(this,"Style"),ie(this,"Shapes"),ie(this,"Outdoor"),ie(this,"update",()=>{M(this,di).core.render()}),ie(this,"getDirections",(r,n,a)=>M(this,di).getDirections(r,n,a)),ie(this,"on",(r,n)=>{super.on(r,n)}),ie(this,"off",(r,n)=>{super.off(r,n)});let t=new dMe(e,this);Re(this,di,t),this.Camera=M(this,di).Camera,Re(this,ev,M(this,di).mapDataExternal),this.Markers=M(this,di).Markers,this.Models=M(this,di).Models,this.Labels=M(this,di).Labels,this.Exporter=M(this,di).Exporter,this.Paths=M(this,di).Paths,this.Navigation=M(this,di).Navigation,this.BlueDot=M(this,di).BlueDot,this.Shapes=M(this,di).Shapes,this.Style=M(this,di).Style,this.auto=M(this,di).auto,this.Outdoor=M(this,di).Outdoor}updateState(e,t){return M(this,di).updateState(e,t)}getMapData(){return M(this,ev)}getDimensions(){return{width:this.__core.canvasWidth,height:this.__core.canvasHeight}}expand(e){return M(this,di).expand(e)}collapse(){return M(this,di).collapse()}addMap(e,t){return M(this,di).addMap(e,t)}setFloor(e){M(this,di).setFloor(e)}get currentFloor(){return M(this,di).currentFloor}updateWatermark(e){M(this,di).updateWatermark(e)}getState(e){return M(this,di).getState(e)}setHoverColor(e){M(this,di).setHoverColor(e)}getHoverColor(){return M(this,di).getHoverColor()}isInView(e){return M(this,di).isInView(e)}createCoordinate(e,t,r){return M(this,di).createCoordinate(e,t,r)}createCoordinateFromScreenCoordinate(e,t,r){return M(this,di).createCoordinateFromScreenCoordinate(e,t,r)}auto(){this.Labels.all()}get __core(){return M(this,di).core}destroy(){M(this,di).destroy()}async enableDebug(){let{Inspector:e}=await lg(()=>import("./inspector-QDN2FWBH-Ba-Pzgp4.js"),[]);await new e(this,M(this,di)).enable()}};ev=new WeakMap,di=new WeakMap,h(Nre,"MapView");var $re=Nre;R();var Ure=class extends Zr{constructor(t){super();Z(this,"gl");Z(this,"el",document.createElement("div"));Z(this,"core");Z(this,"origin");this.origin=t}onAdd(t){this.origin=this.origin||t.getCenter().toArray(),this.gl=t.painter.context.gl,this.core=new AC(t._container,{center:this.origin,zoomLevel:t.getZoom(),pitch:t.getPitch(),bearing:t.getBearing(),gl:this.gl,map:t,mode:"outdoors-overlay"}),this.core.camera.setMinZoomLevel(t.getMinZoom()),this.core.camera.setMaxZoomLevel(t.getMaxZoom()),this.core.camera.setMinPitch(t.getMinPitch()),this.core.camera.setMaxPitch(t.getMaxPitch()),t.on("error",a=>{Bt.warn(a)});let r=Qr.fromLngLat(this.origin,0),n=nP(r,this.core.viewCamera,this.core.camera,()=>{this.core.renderSync()});return t.on("style.load",async()=>{t.addLayer(n),this.core.camera.setMinZoomLevel(t.getMinZoom()),this.core.camera.setMaxZoomLevel(t.getMaxZoom()),this.core.camera.setMinPitch(t.getMinPitch()),this.core.camera.setMaxPitch(t.getMaxPitch())}),t.on("move",()=>{let[a,o]=t.getCenter().toArray();this.core.getSystems().cameraSystem.setCenter(a,o),this.core.getSystems().cameraSystem.setZoomLevel(t.getZoom()),this.core.getSystems().cameraSystem.setRotation(Oi.degToRad(-t.getBearing())),this.core.getSystems().cameraSystem.setTilt(Oi.degToRad(t.getPitch()))}),this.el}onRemove(){}};h(Ure,"MapLibreOverlay");var fMe=Ure,mMe=h(async(i,e)=>{let t;try{if(e){let{access_token:n}=await ZT(e);t=n}}catch(n){Bt.warn("Getting access token failed. Outdoor map disabled.",n)}let r=new KT(i,t);return new XT(r)},"hydrateMapDataFromMVF");function Vre(i,e,t){return fetch(i,{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({grant_type:"client_credentials",client_id:e,client_secret:t})})}h(Vre,"fetchOutdoorViewToken");var jre=h(async i=>{let e={emitAnalyticsEvents:!0,...i},t;if("accessToken"in e)t=e.accessToken;else if("key"in e&&"secret"in e){let l=await Vre("https://auth.mappedin.com/oauth2/token",e.key,e.secret),{access_token:u}=await l.json();t=u}else throw new Error("No outdoor view token provided and key and secret missing.");let r={...e,venue:e.mapId,clientId:e.key,clientSecret:e.secret,version:"1.0.0"},n=await fQ(r),a=await R_(n),o=k_(a);typeof i.onMVFParsed=="function"&&i.onMVFParsed(o);let s=new KT(o,t);return new XT(s)},"getMapDataEnterprise"),Hre=!1;function Gre(i){Hre=i}h(Gre,"setUseEnterpriseAPI");var Wre=h(async i=>{if(Hre)return jre(i);let e={emitAnalyticsEvents:!1,...i},t;if("accessToken"in e)t=e.accessToken;else{let{access_token:p}=await ZT(e);t=p}Qo.authReady||Qo.updateState({accessToken:t});let r=performance.now(),n=await mQ(e,t),a=performance.now(),o=await R_(n),s=k_(o),l=performance.now();typeof i.onMVFParsed=="function"&&i.onMVFParsed(s);let u=new KT(s,t),c=new XT(u);return Qo.sendGetMapDataEvent({parseDuration:(l-a).toFixed(2),downloadDuration:(a-r).toFixed(2),viewId:e.viewId}),c},"getMapData"),jc,tm,DC=class extends fMe{constructor(e,t,r){super(e),fe(this,jc,void 0),fe(this,tm,void 0),Re(this,jc,t),Re(this,tm,r)}onAdd(e){var t,r;super.onAdd(e);let n={...rM,...(t=M(this,tm))!=null?t:{},outdoorView:{token:M(this,jc).outdoorViewToken,...(r=M(this,tm))==null?void 0:r.outdoorView}},a=new $re(this.core);return a.addMap(M(this,jc),n).then(()=>{this.publish("loaded",{mapView:a,mapData:M(this,jc)})}),this.el}};jc=new WeakMap,tm=new WeakMap,h(DC,"MappedinMapLibreOverlay"),ie(DC,"instance");var $b=DC,gMe=h((i,e)=>{$b.instance!=null&&Bt.warn("Only a single map venue is supported at this time.");let t=new $b([i.mapCenter.longitude,i.mapCenter.latitude],i,e);return $b.instance=t,t},"createMapLibreOverlay"),Xre=h(async(i,e,t)=>{var r,n,a,o,s;let l=performance.now(),u=JQ(t,e);try{t&&YQ(t)}catch(d){if(d instanceof Error&&d.name==="MissingOutdoorViewToken")Bt.error("Enable outdoor view requires a token. Provide token in `options.outdoorView.token`");else throw d}let c=await wre(i,{center:[e.mapCenter.longitude,e.mapCenter.latitude],bearing:u.bearing,pitch:u.pitch,zoomLevel:u.zoomLevel,outdoorView:(r=u.outdoorView)!=null&&r.token?{headers:{"x-mappedin-tiles-key":(n=u.outdoorView)==null?void 0:n.token},style:(a=u.outdoorView)==null?void 0:a.style,enabled:!!((o=u.outdoorView)!=null&&o.enabled)}:void 0,watermark:u.watermark,attribution:u.attribution,antialias:typeof u.antialiasing=="boolean"?u.antialiasing:!!((s=u.antialiasing)!=null&&s.enabled)}),p=new $re(c);return await p.addMap(e,u),Qo.sendMapViewLoadedEvent({firstRenderDuration:(performance.now()-l).toFixed(2),dimension:p.getDimensions()}),p},"show3dMapGeojson"),qre=Xre;R();R();R();R();var Zre=class extends Error{constructor(e){super(`${e} must be used within a MapView component.`)}};h(Zre,"MapViewNullError");var Dh=Zre,Hs=$e.createContext({mapData:void 0,mapView:void 0});function yMe(){let{mapData:i,mapView:e}=$e.useContext(Hs);if(!i||!e)throw new Dh("useMap");return{mapData:i,mapView:e}}h(yMe,"useMap");R();function kh(i,e){$e.useEffect(()=>{e!=null&&typeof i=="function"&&i(e)},[i,e])}h(kh,"useOnLoad");h(i=>{let{mapView:e}=$e.useContext(Hs),t=$e.useRef(),[r,n]=$e.useState(null);return $e.useEffect(()=>{if(e==null)throw new Dh("Marker");return t.current=e.Markers.add(i.target,"",{...i.options,dynamicResize:!0}),n(t.current),()=>{e==null||t.current==null||e.Markers.remove(t.current)}},[e,i.target,i.options]),kh(i.onLoad,r),e==null||r==null?null:x9.createPortal(i.children,r.contentEl,r.id)},"Marker");R();function vMe(i){let{mapView:e}=$e.useContext(Hs),t=$e.useRef(),[r,n]=$e.useState(void 0);return $e.useEffect(()=>{if(e==null)throw new Dh("Label");return t.current=e.Labels.add(i.target,i.text,i.options),n(t.current),()=>{e==null||t.current==null||e.Labels.remove(t.current)}},[e,i.target,i.text,i.options]),kh(i.onLoad,r),null}h(vMe,"Label");R();function xMe(i,e){let{mapView:t}=$e.useContext(Hs),r=$e.useCallback(n=>e(n),[e]);$e.useEffect(()=>{if(t==null)throw new Dh("useEvent");return t.on(i,r),()=>{t!=null&&t.off(i,r)}},[t,i,e])}h(xMe,"useEvent");R();function _Me(i){let{mapView:e}=$e.useContext(Hs),t=$e.useRef(),[r,n]=$e.useState(void 0);return $e.useEffect(()=>{if(e==null)throw new Dh("Path");let a=!1,o=e.Paths.add(i.coordinate,i.options);return o.then(s=>{a?e.Paths.remove(s):(t.current=s,n(s))}),()=>{a=!0,t.current?e.Paths.remove(t.current):o.then(s=>{e.Paths.remove(s)})}},[e,i.coordinate,i.options]),kh(i.onLoad,r),null}h(_Me,"Path");R();var bMe={width:"100%",height:"100%",position:"relative"};function wMe(i){let{mapData:e,options:t,style:r,fallback:n,children:a,...o}=i,s=$e.useRef(!1),[l,u]=$e.useState(void 0),[c,p]=$e.useState(!0),d=$e.useRef(null),m=$e.useMemo(()=>t,[]),g=$e.useCallback(()=>{if(e&&d!=null&&d.current){if(l)return;qre(d.current,e,m).then(_=>{u(_)}).catch(_=>{Bt.error("Failed to render MapView",_)}).finally(()=>{p(!1)})}},[e,d.current,m]);return $e.useEffect(()=>{s.current||(s.current=!0,g())},[g]),kh(i.onLoad,l),rf.createElement(Hs.Provider,{value:{mapData:e,mapView:l}},rf.createElement("div",{"data-testid":"mappedin-map",ref:d,style:{...bMe,...r},...o}),c?rf.createElement(rf.Fragment,null,n):a)}h(wMe,"MapView");R();function SMe(i){let{mapView:e}=$e.useContext(Hs),[t,r]=$e.useState(!1),n=$e.useRef(Promise.resolve());return $e.useEffect(()=>{if(e==null)throw new Dh("Navigation");let a=!1,o=h(()=>a?Promise.resolve():e.Navigation.draw(i.directions,i.options).then(()=>{a||r(!0)}),"navigationOperation");return n.current=n.current.then(o),()=>{a=!0,n.current=n.current.then(()=>{e.Navigation.clear()})}},[e,i.directions,i.options]),$e.useEffect(()=>{t!==!1&&typeof i.onLoad=="function"&&i.onLoad()},[i.onLoad,t]),null}h(SMe,"Navigation");R();function MMe(i){let{mapView:e}=$e.useContext(Hs),t=$e.useRef(),[r,n]=$e.useState(void 0);return $e.useEffect(()=>{if(e==null)throw new Error("MapView not initialized");return t.current=e.Shapes.add(i.geometry,i.style,i.floor),n(t.current),()=>{e==null||t.current==null||e.Shapes.remove(t.current)}},[e,i.geometry,i.style,i.floor]),kh(i.onLoad,r),null}h(MMe,"Shape");R();function CMe(i){let{mapView:e}=$e.useContext(Hs),t=$e.useRef(),[r,n]=$e.useState(void 0);return $e.useEffect(()=>{if(e==null)throw new Dh("Model");return t.current=e.Models.add(i.models,i.options),n(t.current),()=>{if(!(e==null||t.current==null))for(let a of t.current)e.Models.remove(a)}},[e,i.models,i.options]),kh(i.onLoad,r),null}h(CMe,"Model");R();function EMe(i){let[e,t]=$e.useState(void 0),[r,n]=$e.useState(!0),[a,o]=$e.useState(void 0),s=$e.useRef(0),l=$e.useMemo(()=>i,[]),u=$e.useCallback(()=>{let c=++s.current;n(!0),o(void 0),Wre(l).then(p=>{s.current===c&&t(p)}).catch(p=>{s.current===c&&(Bt.error("Failed to fetch MapData",p),o(p))}).finally(()=>{s.current===c&&n(!1)})},[l]);return $e.useEffect(()=>{u()},[u]),{mapData:e,isLoading:r,error:a}}h(EMe,"useMapData");function TMe(){return At.jsxs(At.Fragment,{children:[At.jsxs(mse,{children:[At.jsx(nc,{path:"LooGuessr/",element:At.jsx(sD,{})}),At.jsx(nc,{path:"LooGuessr/photo",element:At.jsx(rue,{})}),At.jsx(nc,{path:"LooGuessr/login",element:At.jsx(lD,{})}),At.jsx(nc,{path:"LooGuessr/register",element:At.jsx(nue,{})}),At.jsx(nc,{path:"LooGuessr/profile"})]}),At.jsx(aue,{})]})}_9(document.getElementById("root")).render(At.jsx(vse,{children:At.jsx(TMe,{})}));export{Wv as $,IK as A,wd as B,u6e as C,tu as D,SAe as E,Gt as F,Ne as G,kY as H,Th as I,r8 as J,Xv as K,or as L,Zi as M,I_ as N,Gn as O,le as P,ZJ as Q,Xl as R,Ur as S,jn as T,o6e as U,Rt as V,BPe as W,Ln as X,Nu as Y,j2 as Z,OT as _,Un as a,Ide as a$,c2e as a0,iu as a1,$Y as a2,Sa as a3,$Pe as a4,j2e as a5,w0e as a6,_I as a7,P_ as a8,VY as a9,Ade as aA,kTe as aB,u1e as aC,Wm as aD,z1e as aE,ei as aF,Wl as aG,tye as aH,TTe as aI,Ba as aJ,m1 as aK,y1e as aL,B6 as aM,Qr as aN,ATe as aO,UTe as aP,Pde as aQ,$V as aR,FTe as aS,V1e as aT,D6 as aU,NTe as aV,O1e as aW,R1e as aX,D1e as aY,q1e as aZ,Cde as a_,KPe as aa,tAe as ab,$1 as ac,_q as ad,jPe as ae,zAe as af,o2e as ag,tn as ah,ea as ai,Ei as aj,zPe as ak,ax as al,nx as am,kg as an,VTe as ao,zE as ap,eye as aq,b1e as ar,Lde as as,Z1e as at,j1e as au,W1e as av,X1e as aw,s1e as ax,mn as ay,BTe as az,wY as b,Aue as b0,S4e as b1,Mde as b2,Co as b3,Eye as b4,wye as b5,Sye as b6,Mye as b7,Pye as b8,Iye as b9,Sde as ba,Iue as bb,Tye as bc,bye as bd,Cye as be,Aye as bf,br as bg,Qo as bh,KSe as bi,LSe as bj,vY as c,rAe as d,bl as e,Na as f,Kr as g,G6 as h,aAe as i,Wd as j,$n as k,vo as l,_o as m,cr as n,mS as o,Rg as p,R as q,h as r,yX as s,Eo as t,Ag as u,jAe as v,n6e as w,YAe as x,Oi as y,QAe as z};
